IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var Identite = require('ObjetIdentite.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreCommandeMobile = {
            SeDeconnecter: 0,
            Retour: 1,
            Valider: 2,
            Accueil: 3,
            MenuOnglets: 4
        };
        MethodesObjet.heritagePrototype(_ObjetEnteteMobile, Identite);

        function _ObjetEnteteMobile() {
            this.inheritedCreate(arguments);
            this.idTitre = this.Nom + '_Titre';
            this.idPageAccueil = this.Nom + '_Btn_Accueil';
            this.idMenuOnglets = this.Nom + '_Btn_MenuOnglets';
            this.idLienMenuOnglets = this.Nom + '_Lien_MenuOnglets';
            this.idValider = this.Nom + '_Btn_Valider';
            Invocateur.abonner(ObjetInvocateur.events.etatSaisie, this._setEtatSaisie.bind(this), this);
        }
        _ObjetEnteteMobile.prototype.ConstruireAffichage = function() {
            var lHTML = [];
            lHTML.push('<nav>', '<div class="nav-wrapper">', '<div>', '<div>', '<div tabIndex="0" role="heading" id="', this.idTitre, '" ie-node="getNodeTitre"></div>', '<div style="height:100%;"></div>', '</div>', '</div>', '<ul>', '<li id="' + this.idValider + '">', '<a role="button" onclick="' + this.Nom + '.surClickBouton(' + EGenreCommandeMobile.Valider + ')">', '<i class="material-icons icon_ok">' + GTraductions.getValeur('Commande.Validation.Actif') + '</i>', '</a>', '</li>', this.composeNotificationsApplicatives());
            if (!!this.idPanel) {
                var libelleBtnMenuOnglets = (this.nEstPasMobileAppariteurHP() && !!this.idPanel ? GTraductions.getValeur('accueil.menuPrincipal') : '');
                lHTML.push('<li id="', this.idMenuOnglets, '">', '<a id="' + this.idLienMenuOnglets + '" role="button" onclick="' + this.Nom + '.surClickBouton(' + EGenreCommandeMobile.MenuOnglets + ')">', '<i class="material-icons icon_reorder">' + (!!libelleBtnMenuOnglets ? libelleBtnMenuOnglets : '') + '</i></a></li>');
            }
            lHTML.push('</ul>', '</div>', '</nav>');
            return lHTML.join('');
        };
        _ObjetEnteteMobile.prototype.getControleur = function() {
            return {
                getNodeTitre: function() {
                    $(this.node).on('click', function() {
                        Invocateur.evenement(ObjetInvocateur.events.toucheDEBUG);
                    });
                }
            };
        };
        _ObjetEnteteMobile.prototype.nEstPasMobileAppariteurHP = function() {
            return true;
        };
        _ObjetEnteteMobile.prototype.SetParametres = function(aParam) {
            this.idPanel = aParam.idPanel;
        };
        _ObjetEnteteMobile.prototype.actualiserTitre = function() {};
        _ObjetEnteteMobile.prototype.focusTitre = function() {
            $('#' + this.idTitre.escapeJQ()).focus();
        };
        _ObjetEnteteMobile.prototype._setEtatSaisie = function(aVisible) {
            GHtml.setDisplay(this.idValider, aVisible);
        };
        _ObjetEnteteMobile.prototype.setBoutonAccueil = function(aBoolean) {
            GHtml.setDisplay(this.idPageAccueil, aBoolean && GEtatUtilisateur.avecPageAccueil() && !GApplication.acces.estConnexionDirect());
        };
        _ObjetEnteteMobile.prototype.surClickBouton = function(i) {
            if (GApplication.getCommunication().requeteEnCours()) {
                return;
            }
            this.callback.appel(i);
        };
        _ObjetEnteteMobile.prototype.composeNotificationsApplicatives = function() {
            return '';
        };
        module.exports = {
            EGenreCommandeMobile: EGenreCommandeMobile,
            _ObjetEnteteMobile: _ObjetEnteteMobile
        };
    },
    fn: "_objetentete.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var _ObjetEnteteMobile = require('_ObjetEntete.js')._ObjetEnteteMobile;
        var GHtml = require('GHtml.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetDonneesCentraleNotifications = require('ObjetDonneesCentraleNotifications.js');
        MethodesObjet.heritagePrototype(ObjetEnteteMobile, _ObjetEnteteMobile);

        function ObjetEnteteMobile() {
            this.inheritedCreate(arguments);
            this.traductions = {};
            this.traductions.accueil = GTraductions.getValeur('Commande.Accueil.Actif');
            this.traductions.hintAccueil = GTraductions.getValeur('mobile.hintAccueil');
            this.traductions.hintMenu = GTraductions.getValeur('mobile.hintMenu');
            this.traductions.hintValider = GTraductions.getValeur('mobile.hintValider');
            this.traductions.hintDeconnexion = GTraductions.getValeur('mobile.hintDeconnexion');
            Invocateur.abonner(ObjetDonneesCentraleNotifications.typeNotif.surModification, function(aDonnees) {
                $("#" + this.idLienMenuOnglets.escapeJQ()).find('.badge').remove();
                var lNb = aDonnees.nbNotifs + aDonnees.nbConversationEnCours;
                if (lNb > 0) {
                    $("#" + this.idLienMenuOnglets.escapeJQ()).append('<span class="new badge">' + (lNb > 999 ? '999+' : lNb) + '</span>');
                }
            }, this);
        }
        ObjetEnteteMobile.prototype.actualiserTitre = function() {
            var lTitre = {
                titre: '',
                sousTitre: '',
                avecImage: false
            };
            var lGenreOnglet = GEtatUtilisateur.getGenreOnglet(),
                lOnglet = GEtatUtilisateur.listeOnglets.GetElementParGenre(lGenreOnglet);
            if (!!lOnglet) {
                lTitre.titre = lOnglet.GetLibelle();
            }
            if (lGenreOnglet === EGenreOnglet.Accueil || MethodesTableau.existe(lGenreOnglet, GInterface.OngletsAvecRessourceParent) || MethodesTableau.existe(lGenreOnglet, GInterface.OngletsAvecRessourceEtablissement)) {
                lTitre.sousTitre = GEtatUtilisateur.getMembre().GetLibelle();
                var lLibelleClasse = '';
                if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.PrimParent, EGenreEspace.Mobile_PrimParent, EGenreEspace.PrimEleve, EGenreEspace.Mobile_PrimEleve, EGenreEspace.PrimAccompagnant, EGenreEspace.Mobile_PrimAccompagnant])) {
                    lLibelleClasse = GEtatUtilisateur.Identification.GetLibelleClasse();
                }
                lTitre.sousTitre += (lLibelleClasse ? ' (' + lLibelleClasse + ')' : '');
            }
            lTitre = (lTitre.sousTitre ? '<span class="Texte12' + '">' + lTitre.sousTitre + '</span><br />' : '') + lTitre.titre;
            GHtml.setHtml(this.idTitre, lTitre);
        };
        module.exports = ObjetEnteteMobile;
    },
    fn: "mobile/script/objetentete.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeEtatExecutionQCMPourRepondant = {
            EQR_EnCours: 0,
            EQR_Termine: 1,
            EQR_DureeMaxDepassee: 2,
            EQR_ARefaire: 3
        };
        module.exports.TypeEtatExecutionQCMPourRepondant = TypeEtatExecutionQCMPourRepondant;
    },
    fn: "typeetatexecutionqcmpourrepondant.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeNumerotation = {
            n123: 0,
            nABC: 1,
            NRoman: 2
        };
        module.exports.TypeNumerotation = TypeNumerotation;
    },
    fn: "typenumerotation.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var TypeNumerotation = require('TypeNumerotation.js').TypeNumerotation;
        var GTraductions = require('ObjetTraduction.js');
        var TUtilitaireDuree = require('UtilitaireDuree.js');

        function ObjetUtilitaireQCM() {
            this.couleurBonneReponse = 'green';
            this.couleurFausseReponse = 'red';
        }
        ObjetUtilitaireQCM.prototype.composeNumerotation = function(aTypeNum, aNum) {
            if (aTypeNum === TypeNumerotation.n123) {
                return aNum;
            } else if (aTypeNum === TypeNumerotation.nABC) {
                return this.aphabetize(aNum).toUpperCase();
            } else if (aTypeNum === TypeNumerotation.NRoman) {
                return this.romanize(aNum);
            }
        };
        ObjetUtilitaireQCM.prototype.aphabetize = function(aNum) {
            var lResult = '';
            while (aNum > 0) {
                aNum--;
                var lRemain = aNum % 26;
                lResult = String.fromCharCode(lRemain + 97) + lResult;
                aNum = (aNum - lRemain) / 26;
            }
            return lResult;
        };
        ObjetUtilitaireQCM.prototype.romanize = function(aNum) {
            var lLookup = {
                    M: 1000,
                    CM: 900,
                    D: 500,
                    CD: 400,
                    C: 100,
                    XC: 90,
                    L: 50,
                    XL: 40,
                    X: 10,
                    IX: 9,
                    V: 5,
                    IV: 4,
                    I: 1
                },
                lRoman = '',
                i;
            for (i in lLookup) {
                while (aNum >= lLookup[i]) {
                    lRoman += i;
                    aNum -= lLookup[i];
                }
            }
            return lRoman;
        };
        ObjetUtilitaireQCM.prototype.estCliquable = function(aExecutionQCM, aIgnorerTestCorrige) {
            return aExecutionQCM.fichierDispo && (GEtatUtilisateur.estEspacePourEleve() ? this.estJouable(aExecutionQCM) || (aIgnorerTestCorrige ? true : this.estCorrige(aExecutionQCM)) : (GEtatUtilisateur.estEspacePourProf() ? true : false));
        };
        ObjetUtilitaireQCM.prototype.estJouable = function(aExecutionQCM) {
            return aExecutionQCM.estEnPublication === true && ((aExecutionQCM.etatCloture !== TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee &&
                    aExecutionQCM.etatCloture !== TypeEtatExecutionQCMPourRepondant.EQR_Termine) ||
                aExecutionQCM.estRejouable);
        };
        ObjetUtilitaireQCM.prototype.estCorrige = function(aExecutionQCM) {
            return aExecutionQCM.publierCorrige === true;
        };
        ObjetUtilitaireQCM.prototype.getStrResumeModalites = function(aExec, aSansDuree) {
            var H = [];
            var lNbQuestions = aExec.nombreQuestionsSoumises > 0 ? aExec.nombreQuestionsSoumises : aExec.QCM.nbQuestionsTotal;
            H.push(GTraductions.getValeur('SaisieQCM.NbQuestions', [lNbQuestions]));
            if (aExec.dureeMaxQCM > 0 && aSansDuree !== true) {
                H.push(' - ', GTraductions.getValeur('SaisieQCM.DureeExec', [TUtilitaireDuree.dureeEnMin(aExec.dureeMaxQCM)]));
            }
            return H.join('');
        };
        module.exports = {
            ObjetUtilitaireQCM: ObjetUtilitaireQCM,
            UtilitaireQCM: null
        };
    },
    fn: "utilitaireqcm.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetUtilitaireQCM = require('UtilitaireQCM.js').ObjetUtilitaireQCM;
        MethodesObjet.heritagePrototype(ObjetUtilitaireQCM_Mobile, ObjetUtilitaireQCM);

        function ObjetUtilitaireQCM_Mobile() {
            this.inheritedCreate();
        }
        require('UtilitaireQCM.js').UtilitaireQCM = new ObjetUtilitaireQCM_Mobile();
        module.exports = {
            ObjetUtilitaireQCM_Mobile: ObjetUtilitaireQCM_Mobile,
            UtilitaireQCM: require('UtilitaireQCM.js').UtilitaireQCM
        };
    },
    fn: "utilitaireqcm_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var deferLoadingScript = require('deferLoadingScript.js');
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var UtilitaireTraitementImage = {
            browserAutoRotate: false,
            fileToDataUrlPromise: function(aFile) {
                return new Promise(function(aResolve, aReject) {
                    if (!aFile) {
                        aReject();
                    }
                    var lReader = new FileReader();
                    lReader.onloadend = function(e) {
                        if (e.target.readyState === FileReader.DONE) {
                            aResolve(e.target.result);
                        }
                    };
                    lReader.onerror = function() {
                        aReject();
                    };
                    lReader.onabort = function() {
                        aReject();
                    };
                    lReader.readAsDataURL(aFile);
                });
            },
            loadImageDataUrlPromise: function(aDataUrl, aImage) {
                return new Promise(function(aResolve, aReject) {
                    var lImg = aImage || new Image();
                    lImg.onload = function() {
                        aResolve(lImg);
                    };
                    lImg.onerror = function() {
                        aReject();
                    };
                    lImg.src = aDataUrl;
                });
            },
            fileToImgPromise: function(aFile, aImage) {
                return UtilitaireTraitementImage.fileToDataUrlPromise(aFile).then(function(aDataUrl) {
                    return UtilitaireTraitementImage.loadImageDataUrlPromise(aDataUrl, aImage);
                }).then(function(aImg) {
                    var lOrientation = -2;
                    return Promise.resolve().then(function() {
                        if (UtilitaireTraitementImage.avecOrientationPossible(aFile)) {
                            return UtilitaireTraitementImage.getOrientationPromise(aFile).then(function(aOrientation) {
                                lOrientation = aOrientation;
                            }, function() {});
                        }
                    }).then(function() {
                        return {
                            img: aImg,
                            orientation: lOrientation
                        };
                    });
                });
            },
            getOrientationPromise: function(file) {
                return new Promise(function(aResolve, aReject) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            var view = new DataView(e.target.result);
                            if (view.getUint16(0, false) != 0xFFD8) {
                                return aResolve(-2);
                            }
                            var length = view.byteLength,
                                offset = 2;
                            while (offset < length) {
                                if (view.getUint16(offset + 2, false) <= 8) {
                                    return aResolve(-1);
                                }
                                var marker = view.getUint16(offset, false);
                                offset += 2;
                                if (marker == 0xFFE1) {
                                    if (view.getUint32(offset += 2, false) != 0x45786966) {
                                        return aResolve(-1);
                                    }
                                    var little = view.getUint16(offset += 6, false) == 0x4949;
                                    offset += view.getUint32(offset + 4, little);
                                    var tags = view.getUint16(offset, little);
                                    offset += 2;
                                    for (var i = 0; i < tags; i++) {
                                        if (view.getUint16(offset + (i * 12), little) == 0x0112) {
                                            return aResolve(view.getUint16(offset + (i * 12) + 8, little));
                                        }
                                    }
                                } else if ((marker & 0xFF00) != 0xFF00) {
                                    break;
                                } else {
                                    offset += view.getUint16(offset, false);
                                }
                            }
                            return aResolve(-1);
                        } catch (e) {
                            aReject(e);
                        }
                    };
                    reader.onerror = function(e) {
                        aReject(e);
                    };
                    reader.readAsArrayBuffer(file);
                });
            },
            avecOrientationPossible: function(aFile) {
                return !!(aFile && aFile.type === 'image/jpeg') && !this.browserAutoRotate;
            },
            resizeEtOrientationImgToCanvas: function(aParams) {
                var lParams = Object.assign({
                    img: null,
                    width: 0,
                    height: 0,
                    widthResize: 0,
                    heightResize: 0,
                    orientation: -1
                }, aParams);
                var lWidth = lParams.widthResize || lParams.width;
                var lHeight = lParams.heightResize || lParams.height;
                var lCanvas = document.createElement('canvas');
                var lCtx = lCanvas.getContext('2d');
                lCanvas.width = lParams.width;
                lCanvas.height = lParams.height;
                lCtx.drawImage(lParams.img, 0, 0, lCanvas.width, lCanvas.height);
                var lCanvasResult = document.createElement('canvas');
                var lCtxDest = lCanvasResult.getContext('2d');
                lCanvasResult.width = lWidth;
                lCanvasResult.height = lHeight;
                if (lParams.orientation > 0) {
                    if (4 < lParams.orientation && lParams.orientation < 9) {
                        lCanvasResult.width = lHeight;
                        lCanvasResult.height = lWidth;
                    }
                    switch (lParams.orientation) {
                        case 2:
                            lCtxDest.transform(-1, 0, 0, 1, lWidth, 0);
                            break;
                        case 3:
                            lCtxDest.transform(-1, 0, 0, -1, lWidth, lHeight);
                            break;
                        case 4:
                            lCtxDest.transform(1, 0, 0, -1, 0, lHeight);
                            break;
                        case 5:
                            lCtxDest.transform(0, 1, 1, 0, 0, 0);
                            break;
                        case 6:
                            lCtxDest.transform(0, 1, -1, 0, lHeight, 0);
                            break;
                        case 7:
                            lCtxDest.transform(0, -1, -1, 0, lHeight, lWidth);
                            break;
                        case 8:
                            lCtxDest.transform(0, -1, 1, 0, 0, lWidth);
                            break;
                        default:
                            break;
                    }
                }
                lCtxDest.drawImage(lCanvas, 0, 0, lWidth, lHeight);
                return lCanvasResult;
            },
            resizeImgToCanvas: function(aImg, aMaxWidth, aMaxHeight, aOrientation) {
                var lWidthOriginal = aImg.width;
                var lHeightOriginal = aImg.height;
                var lMAX_WIDTH = aMaxWidth || 1500;
                var lMAX_HEIGHT = aMaxHeight || 1500;
                var lWidth = lWidthOriginal;
                var lHeight = lHeightOriginal;
                if (lWidth > lHeight) {
                    if (lWidth > lMAX_WIDTH) {
                        lHeight *= lMAX_WIDTH / lWidth;
                        lWidth = lMAX_WIDTH;
                    }
                } else {
                    if (lHeight > lMAX_HEIGHT) {
                        lWidth *= lMAX_HEIGHT / lHeight;
                        lHeight = lMAX_HEIGHT;
                    }
                }
                var lCanvasResult = null;
                var lAvecResize = lHeightOriginal !== lHeight || lWidthOriginal !== lWidth;
                if (lAvecResize) {
                    lCanvasResult = UtilitaireTraitementImage.resizeEtOrientationImgToCanvas({
                        img: aImg,
                        width: lWidthOriginal,
                        height: lHeightOriginal,
                        widthResize: lWidth,
                        heightResize: lHeight,
                        orientation: aOrientation
                    });
                }
                return {
                    avecResize: lAvecResize,
                    canvas: lCanvasResult,
                    img: aImg,
                    width: lWidth,
                    height: lHeight,
                    widthOriginal: lWidthOriginal,
                    heightOriginal: lHeightOriginal
                };
            },
            canvasToBlobPromise: function(aCanvas, aType, aName, aCompression) {
                return new Promise(function(aResolve) {
                    aCanvas.toBlob(function(aBlob) {
                        aBlob.name = aName;
                        aResolve(aBlob);
                    }, aType, aCompression);
                });
            },
            resizeFilePromise: function(aFile, aMaxWidth, aMaxHeight, aCompression) {
                return UtilitaireTraitementImage.fileToImgPromise(aFile).then(function(aParamsFileToPromise) {
                    var lResult = UtilitaireTraitementImage.resizeImgToCanvas(aParamsFileToPromise.img, aMaxWidth, aMaxHeight, aParamsFileToPromise.orientation);
                    if (lResult.avecResize && lResult.canvas) {
                        return UtilitaireTraitementImage.canvasToBlobPromise(lResult.canvas, aFile.type, aFile.name, aCompression).then(function(aBlob) {
                            lResult.file = aBlob;
                            return lResult;
                        });
                    }
                    lResult.file = aFile;
                    return lResult;
                }).catch(function(e) {
                    return null;
                });
            },
            avecResizePossible: function(aFile) {
                return !!(aFile && aFile.type && ['image/jpeg', 'image/jpg', 'image/png', 'image/bmp', 'image/webp'].indexOf(aFile.type) >= 0);
            },
            genererPdfPromise: function(aListeFichiers) {
                return Promise.resolve().then(function() {
                    return deferLoadingScript.loadPromise('jsPDF').catch(function() {
                        return Promise.reject({
                            erreurLib: true
                        });
                    });
                }).then(function() {
                    Invocateur.evenement(ObjetInvocateur.events.patience, true, {
                        delai: 100
                    });
                    var lPromises = [];
                    if (aListeFichiers) {
                        aListeFichiers.parcourir(function(aFichier) {
                            if (!aFichier.estResize && UtilitaireTraitementImage.avecOrientationPossible(aFichier.file)) {
                                lPromises.push(UtilitaireTraitementImage.fileToImgPromise(aFichier.file).then(function(aParamsFileToPromise) {
                                    if (aParamsFileToPromise.orientation >= 2) {
                                        var lCanvasResult = UtilitaireTraitementImage.resizeEtOrientationImgToCanvas({
                                            img: aParamsFileToPromise.img,
                                            width: aParamsFileToPromise.img.width,
                                            height: aParamsFileToPromise.img.height,
                                            orientation: aParamsFileToPromise.orientation
                                        });
                                        return UtilitaireTraitementImage.canvasToBlobPromise(lCanvasResult, aFichier.file.type, aFichier.file.name).then(function(aBlob) {
                                            aFichier.file = aBlob;
                                        });
                                    }
                                }).catch(function() {
                                    return Promise.reject({
                                        nom: aFichier.Libelle
                                    });
                                }));
                            }
                        });
                    }
                    return Promise.all(lPromises);
                }).then(function() {
                    return new Promise(function(aResolve, aReject) {
                        var lNbFichiers = aListeFichiers ? aListeFichiers.GetNbrElements() : 0;
                        if (aListeFichiers && lNbFichiers > 0) {
                            var lNb = 0;
                            var lFilesDataUrl = [];
                            aListeFichiers.parcourir(function(aFichier, aIndex) {
                                var lFichier = aFichier;
                                UtilitaireTraitementImage.fileToDataUrlPromise(lFichier.file).then(function(aIndex, aDataUrl) {
                                    lNb += 1;
                                    lFilesDataUrl[aIndex] = {
                                        dataUrl: aDataUrl,
                                        fichier: aFichier,
                                        type: lFichier.file.type
                                    };
                                    if (lNb >= lNbFichiers) {
                                        aResolve(lFilesDataUrl);
                                    }
                                }.bind(this, aIndex), function(aLibelle) {
                                    aReject({
                                        nom: aLibelle
                                    });
                                }.bind(this, lFichier.Libelle));
                            });
                        } else {
                            aResolve();
                        }
                    });
                }).then(function(aFilesDataUrl) {
                    if (aFilesDataUrl && aFilesDataUrl.length > 0) {
                        var lPDF = new jsPDF();
                        var lPromisesErreursJsPDF = [];
                        aFilesDataUrl.forEach(function(aFile) {
                            try {
                                aFile.imageProp = lPDF.getImageProperties(aFile.dataUrl);
                            } catch (e) {
                                lPromisesErreursJsPDF.push(new Promise(function(aResolve, aReject) {
                                    var lTypePDF = '';
                                    switch (aFile.type) {
                                        case 'image/jpeg':
                                            lTypePDF = 'JPEG';
                                            break;
                                        case 'image/png':
                                            lTypePDF = 'PNG';
                                            break;
                                        default:
                                            aReject({
                                                nom: aFile.fichier.Libelle
                                            });
                                            return;
                                    }
                                    UtilitaireTraitementImage.loadImageDataUrlPromise(aFile.dataUrl).then(function(aFile, aTypePDF, aImage) {
                                        aFile.imageProp = {
                                            width: aImage.width,
                                            height: aImage.height,
                                            fileType: aTypePDF
                                        };
                                        aResolve();
                                    }.bind(this, aFile, lTypePDF), function(aFile) {
                                        return Promise.reject({
                                            nom: aFile.fichier.Libelle
                                        });
                                    }.bind(this, aFile));
                                }));
                            }
                        });
                        return Promise.all(lPromisesErreursJsPDF).then(function() {
                            return aFilesDataUrl;
                        });
                    }
                }).then(function(aFilesDataUrl) {
                    if (aFilesDataUrl && aFilesDataUrl.length > 0) {
                        return new Promise(function(aResolve, aReject) {
                            var lPDF = new jsPDF();
                            aFilesDataUrl.every(function(aFile, aIndex) {
                                try {
                                    var lImageProp = aFile.imageProp;
                                    if (aIndex !== 0) {
                                        lPDF.addPage([lImageProp.width, lImageProp.height]);
                                    } else {
                                        lPDF = new jsPDF({
                                            format: [lImageProp.width, lImageProp.height],
                                            unit: 'px',
                                            orientation: lImageProp.width >= lImageProp.height ? 'l' : 'p',
                                            compress: true
                                        });
                                    }
                                    lPDF.addImage(aFile.dataUrl, lImageProp.fileType, 0, 0, lImageProp.width / lPDF.internal.scaleFactor, lImageProp.height / lPDF.internal.scaleFactor, NaN, 'SLOW');
                                    return true;
                                } catch (e) {
                                    aReject({
                                        nom: aFile.fichier.Libelle
                                    });
                                    return false;
                                }
                            });
                            var lFile = lPDF.output('blob');
                            lFile.name = 'file.pdf';
                            aResolve({
                                file: lFile
                            });
                        });
                    }
                }).finally(function() {
                    Invocateur.evenement(ObjetInvocateur.events.patience, false);
                });
            },
            getTabMIME_PDFImage: function() {
                return ['image/jpeg', 'image/jpg', 'image/png', 'image/bmp', 'image/gif'];
            }
        };

        function _browserAutoRotates_promise() {
            return new Promise(function(resolve, reject) {
                var image = new Image();
                image.onload = function() {
                    resolve(image.naturalWidth === 1);
                };
                image.onerror = reject;
                image.src = 'data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';
            });
        }
        _browserAutoRotates_promise().then(function(aVal) {
            UtilitaireTraitementImage.browserAutoRotate = !!aVal;
        });
        if (!HTMLCanvasElement.prototype.toBlob) {
            Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {
                value: function(callback, type, quality) {
                    var canvas = this;
                    setTimeout(function() {
                        var binStr = atob(canvas.toDataURL(type, quality).split(',')[1]),
                            len = binStr.length,
                            arr = new Uint8Array(len);
                        for (var i = 0; i < len; i++) {
                            arr[i] = binStr.charCodeAt(i);
                        }
                        callback(new Blob([arr], {
                            type: type || 'image/png'
                        }));
                    });
                }
            });
        }
        module.exports = UtilitaireTraitementImage;
    },
    fn: "utilitairetraitementimage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');
        var UtilitaireTraitementImage = require('UtilitaireTraitementImage.js');
        var uIdFichier = 0;
        var UtilitaireSelecFile = {
            C_MaxSize: 500 * 1024 * 1024,
            addFileDansListe: function(aFile, aListeFichiers, aGenrePJ) {
                var lElement = new ObjetElement('', null, aGenrePJ);
                lElement.SetEtat(EGenreEtat.Creation);
                lElement.Libelle = GChaine.ajouterEntites(GChaine.enleverChemin(aFile.name));
                lElement.nomOriginal = aFile.name;
                lElement.file = aFile;
                try {
                    if (aFile.lastModified) {
                        lElement.lastModified = aFile.lastModified;
                    }
                } catch (error) {}
                uIdFichier += 1;
                lElement.idFichier = 'selecfile_' + uIdFichier + '_' + Date.now();
                aListeFichiers.AddElement(lElement);
            },
            controleTailleFichiers: function(aListeFichiers, aMessagesErreur, aMaxSize) {
                var lListe = new ObjetListeElements();
                aListeFichiers.parcourir(function(aFichier) {
                    if (aMaxSize > 0 && aFichier.file.size > aMaxSize) {
                        var lVal = Math.floor(aMaxSize / 1024),
                            lUnite = 'Ko';
                        if (lVal > 1024 * 10 || (lVal > 1024 && Math.floor(lVal / 1024) === lVal / 1024)) {
                            lVal = Math.floor(lVal / 1024);
                            lUnite = 'Mo';
                        }
                        aMessagesErreur.push(GChaine.Format('%s (%s)', [
                            GTraductions.getValeur('inputFile.msgEchecTailleFichier', [lVal, lUnite]), aFichier.GetLibelle()
                        ]));
                    } else {
                        lListe.AddElement(aFichier);
                    }
                });
                return lListe;
            },
            genererPdfPromise: function(aListeFichiers, aMessagesErreur, aNomPDFaGenerer, aGenrePDF) {
                return UtilitaireTraitementImage.genererPdfPromise(aListeFichiers).then(function(aParamPDF) {
                    aListeFichiers.vider();
                    if (aParamPDF && aParamPDF.file) {
                        if (aNomPDFaGenerer) {
                            aParamPDF.file.name = aNomPDFaGenerer;
                        }
                        UtilitaireSelecFile.addFileDansListe(aParamPDF.file, aListeFichiers, aGenrePDF);
                    }
                }).catch(function(aParamsReject) {
                    aListeFichiers.vider();
                    if (aMessagesErreur.length > 0) {
                        aMessagesErreur.push('');
                    }
                    aMessagesErreur.push(GChaine.Format(GTraductions.getValeur('inputFile.echecImagePDF_S'), [(aParamsReject ? aParamsReject.nom : '') || '']));
                });
            }
        };
        module.exports = UtilitaireSelecFile;
    },
    fn: "utilitaireselecfile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('Produit/Css/IEHtml.SelecFile.css');
        var IEHtml = require('IEHtml.js');
        var GUID = require('GUID.js');
        var GLog = require('IELog.js');
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GTraductions = require('ObjetTraduction.js');
        var GestionnaireModale = require('GestionnaireModale.js');
        var UtilitaireTraitementImage = require('UtilitaireTraitementImage.js');
        var UtilitaireSelecFile = require('UtilitaireSelecFile.js');
        IEHtml.addAttribut('ie-selecfile', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
            var lModele = aOutils.getModel(aContexteCourant),
                lJInput = null,
                lDisabled = false,
                lExisteInput = false,
                lOptions = {};
            var lDesactiverClick_openFileManuel = false;
            var lTimeoutDrag;
            var lTimeoutDragSurvol;
            var lDureeTimeoutDrag = 10;
            var lDragEnCours = false;
            var lDragHoverEnCours = false;
            var lTimeoutDestroy = null;
            if (!lModele || !aContexteCourant.data.$modeleParsed) {
                return true;
            }
            var lJElement = $(aContexteCourant.node),
                lInfosOptions = aOutils.getAccesParametresModel('getOptionsSelecFile', aContexteCourant),
                lInfosAdd = aOutils.getAccesParametresModel('addFiles', aContexteCourant),
                lInfosGetDisabled = aOutils.getAccesParametresModel('getDisabled', aContexteCourant);
            if (!lInfosAdd.estFonction) {
                return true;
            }
            if (!lInfosOptions.estFonction) {
                return true;
            }
            var lOuvrirSelecteur = function() {
                if (!lDisabled && lExisteInput) {
                    if (lOptions.surOuvertureSelecteur) {
                        lOptions.surOuvertureSelecteur();
                    }
                    lJInput.click();
                }
            };

            function _surDrag(aParams) {
                clearTimeout(lTimeoutDrag);
                if (aParams.start && !lDisabled && lExisteInput && lOptions.acceptDragDrop) {
                    if (!lDragEnCours && !GestionnaireModale.estJElementBloque(lJElement)) {
                        lDragEnCours = true;
                        if (lOptions.classDrag) {
                            aContexteCourant.node.classList.add(lOptions.classDrag);
                        }
                        if (lOptions.eventSurDrag) {
                            lOptions.eventSurDrag({
                                surDrag: true
                            });
                        }
                    }
                } else if (lDragEnCours) {
                    lTimeoutDrag = setTimeout(function() {
                        lDragEnCours = false;
                        lDragHoverEnCours = false;
                        if (lOptions.classDrag) {
                            aContexteCourant.node.classList.remove(lOptions.classDrag);
                        }
                        if (lOptions.classDragHoverSelec) {
                            aContexteCourant.node.classList.remove(lOptions.classDragHoverSelec);
                        }
                        if (lOptions.eventSurDrag) {
                            lOptions.eventSurDrag({
                                surDrag: false
                            });
                        }
                    }, lDureeTimeoutDrag);
                }
                if (lOptions.bloquerDropHorsZoneDrop) {
                    aParams.avecSelecAbonne = true;
                }
            }

            function _createInput() {
                if (lExisteInput) {
                    return;
                }
                if (lTimeoutDestroy) {
                    clearTimeout(lTimeoutDestroy);
                }
                lTimeoutDestroy = null;
                lOptions = {
                    accept: '',
                    extensions: null,
                    maxSize: null,
                    multiple: false,
                    acceptDragDrop: true,
                    eventClick: true,
                    maxFiles: 0,
                    title: '',
                    getClass: function(aDisabled) {
                        return aDisabled || !lOptions.eventClick ? '' : 'AvecMain';
                    },
                    interrompreClick: false,
                    dragEnCoursVisible: true,
                    genrePJ: EGenreDocumentJoint.Fichier,
                    bloquerDropHorsZoneDrop: true,
                    classDrag: 'SelecFile_DragEnCours',
                    classDragHoverSelec: 'SelecFile_DragEnCours_survol',
                    eventSurDrag: null,
                    avecResizeImage: true,
                    tailleMaxImageResize: 1500,
                    compressionImage: 0.88,
                    genererPDFImages: false,
                    nomPDFaGenerer: '',
                    accept_genererPDFImages: UtilitaireTraitementImage.getTabMIME_PDFImage().join(', ')
                };
                if (lInfosOptions.estFonction) {
                    var lResultOptions = lInfosOptions.callback();
                    Object.assign(lOptions, lResultOptions);
                    if (!MethodesObjet.isNumber(lOptions.maxSize) || lOptions.maxSize < 0) {
                        lOptions.maxSize = 0;
                    }
                    if (lOptions.maxSize <= 0) {
                        lOptions.maxSize = 50 * 1024 * 1024;
                    }
                }
                if (!GHtml.getElement(uIdConteneurInputFile)) {
                    ZoneFenetre.ajouterFenetre(uIdConteneurInputFile, -1);
                }
                var lAccept = (lOptions.genererPDFImages ? lOptions.accept_genererPDFImages : '') || lOptions.accept;
                lJInput = $(aOutils.injectHTML({
                    element: GHtml.getElement(uIdConteneurInputFile),
                    html: '<input type="file" style="display:none;" ' + (lOptions.multiple ? ' multiple ' : '') + (lAccept ? ' accept="' + lAccept + '"' : '') + ' />',
                    ignorerScroll: true
                }));
                lExisteInput = true;
                lJInput.on({
                    'change': function(aEvent) {
                        _addFiles({
                            files: this.files,
                            event: aEvent,
                            nodeInput: this
                        });
                    }
                });
                if (lOptions.dragEnCoursVisible) {
                    uInvocateurSelecFile.abonner('drag', _surDrag);
                }
            }

            function _removeInput() {
                if (lTimeoutDestroy) {
                    clearTimeout(lTimeoutDestroy);
                }
                lTimeoutDestroy = null;
                if (lJInput) {
                    lJInput.remove();
                }
                uInvocateurSelecFile.desabonner('drag', _surDrag);
                clearTimeout(lTimeoutDrag);
                clearTimeout(lTimeoutDragSurvol);
                lDragEnCours = false;
                lDragHoverEnCours = false;
                if (lOptions.classDrag) {
                    aContexteCourant.node.classList.remove(lOptions.classDrag);
                }
                if (lOptions.classDragHoverSelec) {
                    aContexteCourant.node.classList.remove(lOptions.classDragHoverSelec);
                }
                if (lOptions.eventSurDrag) {
                    lOptions.eventSurDrag({
                        surDrag: false
                    });
                }
                if ($('#' + uIdConteneurInputFile).length > 0 && $('#' + uIdConteneurInputFile).children().length === 0) {
                    ZoneFenetre.enleverFenetre(uIdConteneurInputFile);
                }
                lJInput = null;
                lExisteInput = false;
            }
            aContexteCourant.getOpenSelecFile = function() {
                lDesactiverClick_openFileManuel = true;
                return lOuvrirSelecteur;
            };

            function _scaleImage(aParams, aFichier, aMessagesErreur) {
                return UtilitaireTraitementImage.resizeFilePromise(aFichier.file, lOptions.tailleMaxImageResize, lOptions.tailleMaxImageResize, lOptions.compressionImage).then(function(aParamsTraitement) {
                    if (aParamsTraitement && aParamsTraitement.avecResize && aParamsTraitement.file && aParamsTraitement.file.size < aFichier.file.size) {
                        var lAncienFichier = aFichier.file;
                        aFichier.file = aParamsTraitement.file;
                        aFichier.estResize = true;
                        aMessagesErreur.push(GChaine.Format(GTraductions.getValeur('inputFile.reductionTailleImage_SDDDDDD'), [
                            aFichier.Libelle, aParamsTraitement.widthOriginal, aParamsTraitement.heightOriginal, lAncienFichier.size / 1024, Math.round(aParamsTraitement.width), Math.round(aParamsTraitement.height), aFichier.file.size / 1024
                        ]));
                    }
                }).catch(function(e) {
                    return null;
                });
            }

            function _construireListeFichiers(aParams, aMessagesErreur) {
                var lNbMax = lOptions.maxFiles;
                if (!lOptions.multiple) {
                    lNbMax = 1;
                }
                [].slice.call(aParams.files).forEach(function(aFile, aIndex) {
                    var lFichierRefuse = lNbMax > 0 &&
                        MethodesObjet.isNumber(lNbMax) &&
                        aIndex >= lNbMax;
                    GLog.addLog('Fichier ' + (lFichierRefuse ? 'refusé (max atteint)' : 'ajouté') + ' : ' + aFile.name + ' - Taille : ' + Math.ceil(aFile.size / 1024) + 'ko');
                    if (lFichierRefuse) {
                        return;
                    }
                    if (aFile.size === 0) {
                        aMessagesErreur.push(GTraductions.getValeur('inputFile.msgDocJointVide', [aFile.name]));
                    } else if (lOptions.extensions &&
                        lOptions.extensions.length > 0 &&
                        $.inArray(aFile.name.replace(/(.*)\.([^./]+)$/, '$2').toLowerCase(), lOptions.extensions) === -1) {
                        aMessagesErreur.push(GTraductions.getValeur('inputFile.echecSelection', [lOptions.extensions.join(', ')]));
                    } else {
                        UtilitaireSelecFile.addFileDansListe(aFile, aParams.listeFichiers, lOptions.genrePJ);
                    }
                });
                if (aParams.listeFichiers) {
                    aParams.listeFichiers.setTri([ObjetTri.init('lastModified'), ObjetTri.init('Libelle')]);
                    aParams.listeFichiers.trier();
                }
            }

            function _addFiles(aParams) {
                if (lDisabled || !lExisteInput) {
                    return;
                }
                var lMessagesErreur = [];
                aParams.listeFichiers = new ObjetListeElements();
                _construireListeFichiers(aParams, lMessagesErreur);
                var lAvecBlocageInterface = false;
                Promise.resolve().then(function() {
                    if (aParams.listeFichiers.GetNbrElements() > 0) {
                        Invocateur.evenement(ObjetInvocateur.events.patience, true, {
                            delai: 500
                        });
                        lAvecBlocageInterface = true;
                    }
                }).then(function() {
                    var lPromises = [];
                    aParams.listeFichiers.parcourir(function(aFichier) {
                        if (lOptions.avecResizeImage && UtilitaireTraitementImage.avecResizePossible(aFichier.file)) {
                            lPromises.push(_scaleImage(aParams, aFichier, lMessagesErreur));
                        }
                    });
                    return Promise.all(lPromises);
                }).then(function() {
                    aParams.listeFichiers = UtilitaireSelecFile.controleTailleFichiers(aParams.listeFichiers, lMessagesErreur, lOptions.maxSize);
                }).then(function() {
                    if (lOptions.genererPDFImages && aParams.listeFichiers.GetNbrElements() > 0) {
                        return UtilitaireSelecFile.genererPdfPromise(aParams.listeFichiers, lMessagesErreur, lOptions.nomPDFaGenerer, lOptions.genrePJ).then(function() {
                            aParams.listeFichiers = UtilitaireSelecFile.controleTailleFichiers(aParams.listeFichiers, lMessagesErreur, lOptions.maxSize);
                        });
                    }
                }).finally(function() {
                    if (lAvecBlocageInterface) {
                        Invocateur.evenement(ObjetInvocateur.events.patience, false);
                    }
                }).then(function() {
                    if (lMessagesErreur.length > 0) {
                        return GApplication.getMessage().afficher({
                            message: lMessagesErreur.join('<br>')
                        });
                    }
                }).then(function() {
                    if (aParams.listeFichiers.GetNbrElements() > 0) {
                        aParams.eltFichier = aParams.listeFichiers.GetElement(0);
                        lInfosAdd.callback([aParams]);
                        aContexteCourant.controleur.$refresh();
                    }
                }).catch(function(e) {
                    GApplication.getMessage().afficher({
                        message: GTraductions.getValeur('inputFile.EchecAjoutFichier')
                    });
                }).then(function() {
                    _removeInput();
                    if (!lDisabled) {
                        _createInput();
                    }
                });
            }

            function _listenerClick(aEvent) {
                if (lDisabled || !lExisteInput || !lOptions.eventClick || lDesactiverClick_openFileManuel) {
                    return;
                }
                lOuvrirSelecteur();
                if (lOptions.interrompreClick) {
                    aEvent.stopImmediatePropagation();
                    aEvent.preventDefault();
                    return false;
                }
            }
            aContexteCourant.node.addEventListener('click', _listenerClick, true);
            lJElement.on({
                'destroyed': function() {
                    if (lJInput) {
                        lJInput.addClass('__destroyed__');
                    }
                    lTimeoutDestroy = setTimeout(function() {
                        _removeInput();
                    }, 100);
                    aContexteCourant.node.removeEventListener('click', _listenerClick, true);
                },
                'dragenter.selecfile dragover.selecfile': function(aEvent) {
                    if (!lOptions.acceptDragDrop || lDisabled || !lExisteInput || !_eventDragAvecFiles(aEvent)) {
                        return;
                    }
                    aEvent.originalEvent.__dropAccepted__ = true;
                    aEvent.preventDefault();
                    if (lOptions.dragEnCoursVisible) {
                        clearTimeout(lTimeoutDragSurvol);
                        if (lOptions.classDragHoverSelec && !lDragHoverEnCours) {
                            lDragHoverEnCours = true;
                            aContexteCourant.node.classList.add(lOptions.classDragHoverSelec);
                        }
                    }
                },
                'dragexit.selecfile dragleave.selecfile dragend.selecfile': function() {
                    clearTimeout(lTimeoutDrag);
                    clearTimeout(lTimeoutDragSurvol);
                    if (lOptions.classDragHoverSelec && lDragHoverEnCours) {
                        lTimeoutDragSurvol = setTimeout(function() {
                            lDragHoverEnCours = false;
                            aContexteCourant.node.classList.remove(lOptions.classDragHoverSelec);
                        }, lDureeTimeoutDrag);
                    }
                },
                'drop.selecfile': function(aEvent) {
                    uInvocateurSelecFile.evenement('drag', {
                        start: false
                    });
                    if (!lOptions.acceptDragDrop || lDisabled || !lExisteInput) {
                        return;
                    }
                    aEvent.stopPropagation();
                    aEvent.preventDefault();
                    var lDataTransfert = aEvent.originalEvent.dataTransfer;
                    if (lDataTransfert) {
                        var lFiles = Array.prototype.concat.apply([], lDataTransfert.files);
                        if (lFiles.length > 0) {
                            _addFiles({
                                files: lFiles,
                                event: aEvent,
                                nodeInput: lJInput.get(0)
                            });
                        }
                    }
                }
            });
            var lTitleOrigine = aContexteCourant.node.title;
            var lMAJDisabled = function(aDisabled) {
                if (aDisabled) {
                    _removeInput();
                } else {
                    _createInput();
                }
                if (aDisabled && lTitleOrigine && lOptions.title) {
                    GHtml.setTitle(aContexteCourant.node, lTitleOrigine || '');
                } else if (!aDisabled && lOptions.title) {
                    GHtml.setTitle(aContexteCourant.node, lOptions.title);
                }
                if (lOptions.getClass) {
                    lJElement.removeClass(lOptions.getClass(!aDisabled)).addClass(lOptions.getClass(aDisabled));
                }
            };
            if (lInfosGetDisabled.valide) {
                var lGetter = function() {
                    return !!lInfosGetDisabled.callback([lJElement.get(0), aContexteCourant.data]);
                };
                if (lInfosGetDisabled.estFonction || !lGetter() || lGetter() === true) {
                    lDisabled = !!lGetter();
                    aOutils.abonnerRefresh(function() {
                        var lNewDisabled = !!lGetter();
                        if (lNewDisabled !== lDisabled) {
                            lDisabled = lNewDisabled;
                            lMAJDisabled(lDisabled);
                        }
                    }, lJElement.get(0), aContexteCourant);
                } else {
                    GLog.addLog('echec getDisabled de ie-selecfile, propriété incorrecte du model "' + lModele + '"');
                }
            }
            lMAJDisabled(lDisabled);
            aOutils.addCommentaireDebug(aContexteCourant.node, 'ie-selecfile');
            return true;
        });

        function _eventDragAvecFiles(aEvent) {
            if (aEvent.originalEvent && aEvent.originalEvent.dataTransfer && aEvent.originalEvent.dataTransfer.items && aEvent.originalEvent.dataTransfer.items.length > 0) {
                var lAvecFile = false;
                try {
                    for (var i = 0; i < aEvent.originalEvent.dataTransfer.items.length; i++) {
                        var lData = aEvent.originalEvent.dataTransfer.items[i];
                        if (!lData || lData.kind !== 'string') {
                            lAvecFile = true;
                            break;
                        }
                    }
                } catch (e) {
                    lAvecFile = true;
                }
                return lAvecFile;
            }
            return true;
        }
        $(document).on({
            'dragenter.selecfile dragover.selecfile': function(aEvent) {
                var lParams = {
                    start: true,
                    avecSelecAbonne: false
                };
                if (_eventDragAvecFiles(aEvent)) {
                    uInvocateurSelecFile.evenement('drag', lParams);
                } else {
                    lParams.avecSelecAbonne = false;
                }
                if (lParams.avecSelecAbonne && !aEvent.originalEvent.__dropAccepted__) {
                    aEvent.originalEvent.dataTransfer.dropEffect = "none";
                    return false;
                }
            },
            'dragexit.selecfile dragleave.selecfile dragend.selecfile drop.selecfile': function() {
                uInvocateurSelecFile.evenement('drag', {
                    start: false
                });
            }
        });
        var uIdConteneurInputFile = GUID.getId(),
            uInvocateurSelecFile = new ObjetInvocateur();
        module.exports = IEHtml;
    },
    fn: "iehtml.selecfile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        MethodesObjet.heritagePrototype(_InterfacePopup, ObjetAbstraitInterface);

        function _InterfacePopup() {
            this.inheritedCreate(arguments);
            this.idPopupWrapper = this.Nom + '_popupWrapper';
            this.idPopup = this.Nom + '_popup';
            this.initPopup();
        }(function() {
            _InterfacePopup.prototype.initPopup = function() {
                this.popup = {
                    header: {
                        html: '',
                        controleur: null
                    },
                    content: {
                        html: '',
                        controleur: null
                    },
                    footer: {
                        html: '',
                        controleur: null
                    }
                };
            };
            _InterfacePopup.prototype.setPopupContent = function(aHtml, aParametresHtml) {
                this.popup.content = {
                    html: aHtml,
                    controleur: aParametresHtml
                };
            };
            _InterfacePopup.prototype.setPopupFooter = function(aContenu, aParametresHtml) {
                var lHtml = $.isArray(aContenu) ? aContenu.map(function(ele) {
                    return '<button class="modal-action waves-effect ' + (ele.stylePlat !== false ? 'btn-flat' : 'btn') + (!!ele.ferme ? ' modal-close' : '') + (!!ele.aGauche ? ' left' : '') + '"' + (ele.attrSuppl ? ' ' + ele.attrSuppl : '') + '>' + ele.libelle + '</button>';
                }).join('') : aContenu;
                this.popup.footer = {
                    html: lHtml,
                    controleur: aParametresHtml
                };
            };
            _InterfacePopup.prototype.setPopupHeader = function(aContenu, aParametresHtml) {
                this.popup.header = {
                    html: aContenu,
                    controleur: aParametresHtml
                };
            };
            _InterfacePopup.prototype.getPopupContent = function() {
                return this.popup.content;
            };
            _InterfacePopup.prototype.getPopupFooter = function() {
                return this.popup.footer;
            };
            _InterfacePopup.prototype.getPopupHeader = function() {
                return this.popup.header;
            };
            _InterfacePopup.prototype.popupIsOpen = function() {
                return $('#' + this.idPopup.escapeJQ()).is('.open');
            };
            _InterfacePopup.prototype.openPopup = function(aParam) {
                var lPopup = $('#' + this.idPopup.escapeJQ()),
                    lContent = lPopup.children('.modal-content'),
                    lHeader = lPopup.children('.modal-header'),
                    lFooter = lPopup.children('.modal-footer'),
                    lParam = {
                        noScroll: false,
                        noClose: false,
                        onOpen: undefined,
                        onClose: undefined
                    };
                Object.assign(lParam, aParam);
                var lInstanceModalePopUp = M.Modal.getInstance(lPopup);
                if (!lInstanceModalePopUp) {
                    M.Modal.init(lPopup, {
                        dismissible: !lParam.noClose,
                        preventScrolling: !!lParam.noScroll
                    });
                    lInstanceModalePopUp = M.Modal.getInstance(lPopup);
                }
                lInstanceModalePopUp.options.onOpenStart = $.isFunction(lParam.onOpen) ? lParam.onOpen : undefined;
                lInstanceModalePopUp.options.onCloseEnd = $.isFunction(lParam.onClose) ? lParam.onClose : undefined;
                lInstanceModalePopUp.options.dismissible = !lParam.noClose;
                lInstanceModalePopUp.options.preventScrolling = !!lParam.noScroll;
                lHeader.IEHtml(this.popup.header.html, this.popup.header.controleur);
                lContent.IEHtml(this.popup.content.html, this.popup.content.controleur);
                lFooter.IEHtml(this.popup.footer.html, this.popup.footer.controleur);
                if (lHeader.html()) {
                    lPopup.addClass('modal-fixed-header');
                    if (!lParam.noClose) {
                        $('#' + this.idPopup.escapeJQ() + ' > .modal-close').removeClass('ui-icon-delete-grey').addClass('ui-icon-delete-white').show();
                    } else {
                        $('#' + this.idPopup.escapeJQ() + ' > .modal-close').hide();
                    }
                    lHeader.show();
                } else {
                    lPopup.removeClass('modal-fixed-header');
                    if (!lParam.noClose) {
                        $('#' + this.idPopup.escapeJQ() + ' > .modal-close').show();
                    } else {
                        $('#' + this.idPopup.escapeJQ() + ' > .modal-close').hide();
                    }
                    lHeader.hide();
                }
                if (lFooter.html()) {
                    lPopup.addClass('modal-fixed-footer');
                    lFooter.show();
                } else {
                    lPopup.removeClass('modal-fixed-footer');
                    lFooter.hide();
                }
                lPopup.find('.collapsible').collapsible();
                lPopup.find('select').formSelect({
                    dropdownOptions: {
                        container: $('body').get(0)
                    }
                });
                lPopup.find('input[type="text"].withCaracterCounter, textarea.withCaracterCounter').characterCounter();
                if (lInstanceModalePopUp.isOpen) {
                    if ($.isFunction(lParam.onOpen)) {
                        lParam.onOpen();
                    }
                } else {
                    lInstanceModalePopUp.open();
                }
            };
            _InterfacePopup.prototype.closePopup = function() {
                var lPopup = $('#' + this.idPopup.escapeJQ());
                if (this.popupIsOpen()) {
                    lPopup.modal('close');
                }
                this.initPopup();
            };
            _InterfacePopup.prototype.getStructurePopup = function() {
                return '<div id="' + this.idPopupWrapper + '">' + this.getPopup() + '</div>';
            };
            _InterfacePopup.prototype.getPopup = function() {
                return (['<div id="' + this.idPopup + '" class="modal" style="height: 70%;">', '<div class="modal-close" style="display:none;"></div>', '<div class="modal-header" style="display:none;"></div>', '<div class="modal-content"></div>', '<div class="modal-footer" style="display:none;"></div>', '</div>']).join('');
            };
        })();
        module.exports = _InterfacePopup;
    },
    fn: "_interfacepopup.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreDirectionSlide = {
            Aucune: 0,
            Droite: 1,
            Gauche: 2
        };
        module.exports = EGenreDirectionSlide;
    },
    fn: "egenredirectionslide.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var Support = require('ObjetSupport.js');
        var EGenreDirectionSlide = require('EGenreDirectionSlide.js');
        MethodesObjet.heritagePrototype(ObjetIdentite_Mobile, Identite);

        function ObjetIdentite_Mobile() {
            this.inheritedCreate(arguments);
            this.avecSlide = false;
            this.enSlide = false;
            this.swipeTabActif = false;
        }
        ObjetIdentite_Mobile.prototype.Afficher = function(aHtml, aDirectionSlide) {
            var lElementActuel = $('#' + this.Nom.escapeJQ()),
                lElementAvecContenu = !!lElementActuel.html(),
                lClassSlide = '';
            if (!this.enSlide && this.avecSlide && $.isNumeric(aDirectionSlide) && aDirectionSlide !== EGenreDirectionSlide.Aucune && lElementAvecContenu) {
                var lNouveauContainer = lElementActuel.clone();
                lElementActuel.attr('id', '').css({
                    position: 'absolute',
                    width: '100%',
                    height: lElementActuel.height() + 'px'
                });
                if (aDirectionSlide === EGenreDirectionSlide.Droite) {
                    lClassSlide = 'slide-to-right';
                } else if (aDirectionSlide === EGenreDirectionSlide.Gauche) {
                    lClassSlide = 'slide-to-left';
                }
                lElementActuel.wrap('<div class="slide-wrapper"><div class="slide-container"></div></div>').after(lNouveauContainer.addClass(lClassSlide));
            }
            this.inherited('Afficher', aHtml);
            $('#' + this.Nom.escapeJQ()).find('.dropdown-trigger').dropdown();
            $('#' + this.Nom.escapeJQ()).find('.collapsible').collapsible();
            $('#' + this.Nom.escapeJQ()).find('select').formSelect();
            $('#' + this.Nom.escapeJQ()).find('textarea.withCaracterCounter').characterCounter();
            if (!this.enSlide && this.avecSlide && $.isNumeric(aDirectionSlide) && aDirectionSlide !== EGenreDirectionSlide.Aucune && lElementAvecContenu) {
                this.enSlide = true;
                lElementActuel.parent().one(Support.transitionEndEvent, (function() {
                    lNouveauContainer.siblings().remove();
                    lNouveauContainer.removeClass(lClassSlide);
                    lNouveauContainer.unwrap('.slide-container').unwrap('.slide-wrapper');
                    this.enSlide = false;
                }).bind(this)).addClass(lClassSlide);
            }
        };
        ObjetIdentite_Mobile.prototype.composeAucuneDonnee = function(aHtml) {
            return '<div style="width:1px;height:1px;"></div><div class="card card-nodata"><div class="card-content">' + aHtml + '</div></div>';
        };
        module.exports = ObjetIdentite_Mobile;
    },
    fn: "objetidentite_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        MethodesObjet.heritagePrototype(ObjetInterfacePage_Mobile, ObjetAbstraitInterface);

        function ObjetInterfacePage_Mobile() {
            this.inheritedCreate(arguments);
            this.GenreStructure = EStructureAffichage.Verticale;
            this.avecBandeau = true;
        }
        ObjetInterfacePage_Mobile.prototype.SetParametresGeneraux = function() {
            this.AvecCadre = false;
            this.IdentZoneAlClient = this.identPage;
        };
        ObjetInterfacePage_Mobile.prototype.setGenreAffichage = function(aGenreAffichage) {
            this.genreAffichage = aGenreAffichage;
        };
        ObjetInterfacePage_Mobile.prototype.afficherMessage = function(aMessage) {
            GHtml.setHtml(this.GetInstance(this.IdentZoneAlClient).GetNom(), this.composeAucuneDonnee(aMessage));
        };
        ObjetInterfacePage_Mobile.prototype.composeAucuneDonnee = ObjetIdentite_Mobile.prototype.composeAucuneDonnee;
        ObjetInterfacePage_Mobile.prototype.ConstruireStructureAffichageVerticale = function() {
            var H = [],
                I = 0,
                lInfo;
            if (this.AddSurZone.length) {
                H.push(this.ConstruireStructureAffichageBandeau());
            } else {
                $('#' + GInterface.idZoneSelection.escapeJQ()).html('').hide();
            }
            var lTabAffichages = [];
            for (I = 0; I < this.NombreGenreAffichage; I++) {
                if (!this.AppartientAZone(I) && !GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre) {
                    if (GApplication.getObjetGraphique(this.GenreAffichage[I])) {
                        lInfo = {
                            estZoneClient: this.IdentZoneAlClient === I,
                            indice: I
                        };
                    }
                    lTabAffichages.push(lInfo);
                }
            }
            for (I = 0; I < lTabAffichages.length; I++) {
                lInfo = lTabAffichages[I];
                H.push('<div ');
                if (lInfo.estZoneClient) {
                    this._infoPourResize = {
                        id: this.GetZoneId(lInfo.indice),
                        padding: 0
                    };
                }
                H.push('id="' + this.GetZoneId(lInfo.indice) + '">');
                H.push('</div>');
            }
            return H.join('');
        };
        ObjetInterfacePage_Mobile.prototype.ConstruireStructureAffichageBandeau = function() {
            var H = [],
                I = 0,
                lInfo;
            var lTabAffichages = [];
            for (I = 0; I < this.NombreGenreAffichage; I++) {
                if (this.AppartientAZone(I) && !GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre) {
                    lInfo = {
                        estZoneClient: this.IdentZoneAlClient === I,
                        indice: I
                    };
                    lTabAffichages.push(lInfo);
                }
            }
            for (I = 0; I < lTabAffichages.length; I++) {
                lInfo = lTabAffichages[I];
                H.push('<div ');
                if (lInfo.estZoneClient) {
                    this._infoPourResize = {
                        id: this.GetZoneId(lInfo.indice),
                        padding: 0
                    };
                }
                H.push('id="' + this.GetZoneId(lInfo.indice) + '">');
                H.push('</div>');
            }
            $('#' + GInterface.idZoneSelection.escapeJQ()).html(H.join('')).show();
        };
        module.exports = ObjetInterfacePage_Mobile;
    },
    fn: "interfacepage_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Callback = require('Callback.js');
        var MethodesObjet = require('MethodesObjet.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var IEHtml = require('IEHtml.js');
        var UtilitaireDeconnexion = require('UtilitaireDeconnexion.js');
        var GHtml = require('GHtml.js');

        function _ObjetAffichagePageMenuOnglets() {
            this.inheritedCreate(arguments);
            this.idTitreWrapper = this.Nom + '_titreWrapper';
            this.idTitre = this.Nom + '_titre';
            this.idPhoto = this.Nom + '_photo';
            this.idDerniereConnexion = this.Nom + '_derniereConnexion';
            this.idSeDeconnecter = this.Nom + '_Bouton_0';
            this.idDropDownContentRessources = this.Nom + '_dropdownContentRessources';
            this.listeOnglets = new ObjetListeElements();
            this.listeOngletsTraitee = new ObjetListeElements();
            this.listeRessources = new ObjetListeElements();
            this.avecListeRessources = false;
            this.GenreStructure = EStructureAffichage.Autre;
        }
        MethodesObjet.heritagePrototype(_ObjetAffichagePageMenuOnglets, ObjetInterfacePage_Mobile);
        _ObjetAffichagePageMenuOnglets.prototype.ConstruireInstances = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.SetParametres = function(aParam) {
            this.avecListeRessources = !!aParam.avecListeRessources;
            if (this.avecListeRessources) {
                this.traiterListeRessource();
            }
        };
        _ObjetAffichagePageMenuOnglets.prototype.getControleur = function(aInstance) {
            return {
                nodeChangRess: function(aIndex) {
                    $(this.node).on('click', function() {
                        aInstance.getInstanceDropdownRessources().close();
                        GInterface.changementRessource(aIndex);
                    });
                },
                surClicOnglet: function(aGenreOnglet) {
                    aInstance.evenementListeOnglets(aGenreOnglet);
                }
            };
        };
        _ObjetAffichagePageMenuOnglets.prototype.getInstanceDropdownRessources = function() {
            var $triggerRessources = $('#' + this.idTitreWrapper.escapeJQ());
            var lInstanceDropdownRessources = M.Dropdown.getInstance($triggerRessources);
            if (!lInstanceDropdownRessources) {
                M.Dropdown.init($triggerRessources, {
                    closeOnClick: false,
                    constrainWidth: false,
                    coverTrigger: false,
                    container: 'body'
                });
                lInstanceDropdownRessources = M.Dropdown.getInstance($triggerRessources);
            }
            return lInstanceDropdownRessources;
        };
        _ObjetAffichagePageMenuOnglets.prototype.afficherListeRessources = function() {
            if (this.listeRessources.GetNbrElements() > 1) {
                this.getInstanceDropdownRessources().open();
            }
        };
        _ObjetAffichagePageMenuOnglets.prototype.ConstruireStructureAffichageAutre = function() {
            var lEspaceIcone = this.getEspaceIcone();
            var lHtml = [];
            lHtml.push('<section class="global-menu-container ">');
            lHtml.push('<header class="user-container">', '<div class="user-container-profil">', '<div  id="', this.idTitreWrapper, '" class="membre-photo_container', (this.avecListeRessources ? ' has-list" onclick="' + this.Nom + '.afficherListeRessources()" data-target="' + this.idDropDownContentRessources + '"' : '"'), '>', '<div id="', this.idPhoto, '" class="membre-photo ', lEspaceIcone, '" role="presentation"></div>', '<span id="', this.idTitre, '" class="label-membre" role="heading" tabIndex="0"></span>', '</div>', '</div>', '<span id="', this.idDerniereConnexion, '" class="user-container-derniere-connexion"></span>', '</header>');
            if (this.avecListeRessources) {
                lHtml.push('<ul id="', this.idDropDownContentRessources, '" class="dropdown-content users-list" role="list" tabIndex="0">');
                this.listeRessources.parcourir(function(ele, index) {
                    lHtml.push('<li role="listitem" tabIndex="0">', '<a ', GHtml.composeAttr('ie-node', 'nodeChangRess', index), '>', ele.GetLibelle(), (ele.sousTitre ? ' (' + ele.sousTitre + ')' : ''), '</a></li>');
                });
                lHtml.push('</ul>');
            }
            lHtml.push('<div class="menu-container">', '<ul class="menu-liste collection collapsible" role="menubar">');
            lHtml.push(this.composeOngletMobileApp());
            if (!GApplication.estAppliMobile || GApplication.infoAppliMobile.avecExitApp) {
                lHtml.push(this.composeOngletDeconnection());
            }
            lHtml.push('</ul>', '</div>');
            lHtml.push('</section>', '<section class="btn-commands-container">', this.composeBoutonMenuSupp(), '</section>');
            return lHtml.join('');
        };

        function composeItemStatique(aLibelleItem, aOnClickMethodeString, aAvecFermetureAutomatiqueSideNav) {
            var lClasses = ['collection-item', 'with-action', 'collection-static-item'];
            (aLibelleItem === GTraductions.getValeur('connexion.SeDeconnecter')) ? lClasses.push('to-disconnect'): '';
            if (aAvecFermetureAutomatiqueSideNav) {
                lClasses.push('sidenav-close');
            }
            var result = [];
            result.push('<li onclick="', aOnClickMethodeString, '" class="', lClasses.join(' '), '" tabIndex="0" role="button">', '<span>', aLibelleItem, '</span>', '</li>');
            return result.join('');
        }
        _ObjetAffichagePageMenuOnglets.prototype.afficherListe = function() {
            var $ulParent = $('#' + this.Nom.escapeJQ()).find('ul.menu-liste.collapsible');
            $ulParent.find('li:not(.collection-static-item)').remove();
            IEHtml.injectHTMLParams({
                element: $ulParent.get(0),
                insererAvantLeNode: $ulParent.find('li').get(0),
                html: this.composeOnglets(),
                controleur: this.controleur
            });
            $ulParent.collapsible({
                onOpenEnd: function() {
                    this.$el.children('li.collapsible-item').children('span').attr('aria-expanded', 'false');
                    this.$el.children('li.collapsible-item.active').children('span').attr('aria-expanded', 'true');
                },
                onCloseEnd: function() {
                    this.$el.children('li.collapsible-item').children('span').attr('aria-expanded', 'false');
                    this.$el.children('li.collapsible-item.active').children('span').attr('aria-expanded', 'true');
                }
            });
        };
        _ObjetAffichagePageMenuOnglets.prototype.composeOnglets = function() {
            var lThis = this,
                lHtml = [];
            this.traiterListeOnglets();
            this.listeOngletsTraitee.parcourir(function(aEle) {
                if (aEle.Actif && aEle.Visible !== false) {
                    if (aEle.children && aEle.children.GetNbrElements() > 0) {
                        lHtml.push('<li class="is-collapse collapsible-item" role="menu" aria-label="', aEle.GetLibelle(), '">', '<span', (aEle.idNotif ? ' id="' + aEle.idNotif + '"' : ''), ' class="as-header collapsible-header" role="button" aria-expanded="false" tabIndex="0">', aEle.GetLibelle(), '</span>', '<div class="collapsible-body">', '<ul class="collection sub-liste" tabIndex="0">');
                        aEle.children.parcourir(function(aChild) {
                            lHtml.push(lThis.composeOnglet(aChild, 2));
                        });
                        lHtml.push('</ul>', '</div>', '</li>');
                    } else {
                        aEle.GetGenre() !== lThis.getGenreOngletAccueil() ? lHtml.push(lThis.composeOnglet(aEle, 1)) : '';
                    }
                }
            });
            return lHtml.join('');
        };
        _ObjetAffichagePageMenuOnglets.prototype.composeOnglet = function(aEle, aNiveau) {
            return (['<li', (aEle.idNotif ? ' id="' + aEle.idNotif + '"' : ''), ' class="collection-item with-action ', (aEle.imagePerso ? aEle.imagePerso + '"' : '"'), ' ie-event="click->surClicOnglet(\'', aEle.GetGenre(), '\')"', ' tabIndex="0" role="menuitem" aria-level="', (aNiveau || 1), '">', '<span>', aEle.GetLibelle(), '</span>', '</li>']).join('');
        };
        _ObjetAffichagePageMenuOnglets.prototype.focusTitre = function(aGenreOnglet) {
            $('#' + this.idTitre.escapeJQ()).focus();
        };
        _ObjetAffichagePageMenuOnglets.prototype.setOnglet = function(aGenreOnglet) {
            this.actualiserTitre(aGenreOnglet);
        };
        _ObjetAffichagePageMenuOnglets.prototype.evenementListeOnglets = function(aGenre) {
            this.callback.appel(aGenre, true, true);
        };
        _ObjetAffichagePageMenuOnglets.prototype.RecupererDonnees = function() {
            this.actionSurRecupererDonnees();
        };
        _ObjetAffichagePageMenuOnglets.prototype.traiterListeOnglets = function() {
            var lThis = this;
            lThis.listeOnglets.parcourir(function(aElePere) {
                if (!aElePere.onglet) {
                    var lElePere = MethodesObjet.dupliquer(aElePere);
                    lThis.listeOngletsTraitee.AddElement(lElePere);
                    lElePere.children = new ObjetListeElements();
                    lThis.listeOnglets.parcourir(function(aEleFils) {
                        if (aEleFils.onglet && aEleFils.onglet.GetGenre() === aElePere.GetGenre()) {
                            var lEleFils = MethodesObjet.dupliquer(aEleFils);
                            lElePere.children.AddElement(lEleFils);
                        }
                    });
                }
            });
        };
        _ObjetAffichagePageMenuOnglets.prototype.traiterListeRessource = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.actionSurRecupererDonnees = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.evenementSelectionRessource = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.actualiserTitre = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.actualiserPhoto = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.getEspaceIcone = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.getGenreOngletAccueil = function() {
            return false;
        };
        _ObjetAffichagePageMenuOnglets.prototype.composeOngletDeconnection = function() {
            return composeItemStatique(GTraductions.getValeur('connexion.SeDeconnecter'), this.Nom + '.seDeconnecter()', true);
        };
        _ObjetAffichagePageMenuOnglets.prototype.seDeconnecter = function() {
            if (GEtatUtilisateur.EtatSaisie) {
                this.callback.appel(GEtatUtilisateur.getGenreOnglet(), null, null, null, new Callback(this, this.actionSeDeconnecter));
            } else {
                this.actionSeDeconnecter();
            }
        };
        _ObjetAffichagePageMenuOnglets.prototype.actionSeDeconnecter = function() {
            if (GApplication.estAppliMobile) {
                UtilitaireDeconnexion.deconnexion().then(function() {
                    this.seDeconnecterAppliMobile();
                }.bind(this));
            } else {
                UtilitaireDeconnexion.deconnexion();
            }
        };
        _ObjetAffichagePageMenuOnglets.prototype.surClickAccueil = function() {
            this.evenementListeOnglets(this.getGenreOngletAccueil());
        };
        _ObjetAffichagePageMenuOnglets.prototype.seDeconnecterAppliMobile = function() {};
        _ObjetAffichagePageMenuOnglets.prototype.composeOngletMobileApp = function() {
            return '';
        };
        _ObjetAffichagePageMenuOnglets.prototype.composeBoutonMenuSupp = function() {
            return '';
        };
        module.exports = _ObjetAffichagePageMenuOnglets;
    },
    fn: "_interfacepagemenuonglets.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreMessage = {
            GM_Message: 0,
            GM_ContactVS: 1,
            GM_Conversation: 2,
            GM_Alerte: 3,
            GM_Buffer: 4
        };
        module.exports.TypeGenreMessage = TypeGenreMessage;
    },
    fn: "typegenremessage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeOrigineCreationModeleAlerte = {
            OCMA_Utilisateur: 0,
            OCMA_Pre_Incendie: 1,
            OCMA_Pre_Confinement: 2,
            OCMA_Pre_Inondation: 3,
            OCMA_Pre_Nucleaire: 4,
            OCMA_Pre_Defaut: 5,
            OCMA_Pre_Tsunami: 6
        };
        module.exports.TypeOrigineCreationModeleAlerte = TypeOrigineCreationModeleAlerte;
    },
    fn: "typeoriginecreationmodelealerte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('espace/css/ObjetFenetre_SplashAlerte.css');
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GStyle = require('GStyle.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetFenetre = require('ObjetFenetre.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeOrigineCreationModeleAlerte = require('TypeOrigineCreationModeleAlerte.js').TypeOrigineCreationModeleAlerte;

        function ObjetFenetre_SplashAlerte() {
            this.inheritedCreate(arguments);
            this.setOptionsFenetre({
                modale: true,
                fermerFenetreSurClicHorsFenetre: true,
                largeur: null,
                largeurMin: 450,
                hauteurBandeau: 25,
                couleurFond: 'white',
                listeBoutons: [GTraductions.getValeur('Fermer'), GTraductions.getValeur('SplashAlerte.OuvrirDiscussion')]
            });
        }
        MethodesObjet.heritagePrototype(ObjetFenetre_SplashAlerte, ObjetFenetre);
        ObjetFenetre_SplashAlerte.prototype.ComposeContenu = function() {
            var T = [];
            if (!this.message) {
                return '';
            }
            T.push('<div class="ofsa_contenu">', '<div>', '<div class="', this.optionsFenetre.classImageAlerte, '"></div>', (this.message.exercice ? '<div class="AlignementMilieu Texte12 PetitEspaceHaut Gras" style="' + GStyle.composeCouleurTexte(this.optionsFenetre.couleurFondBandeau) + '">' +
                GTraductions.getValeur('SplashAlerte.Exercice').toUpperCase() + '</div>' : ''), '</div>', '<div>', this.message.contenu, '</div>', '</div>');
            return T.join('');
        };

        function _strLanceePar() {
            return this.message ? GChaine.Format(GTraductions.getValeur('SplashAlerte.LanceeLeAPar'), [
                GDate.FormatDate(this.message.dateSplash, '%JJ/%MM'), GDate.FormatDate(this.message.dateSplash, '%hh%sh%mm'), this.message.emetteur
            ]) : '';
        }
        ObjetFenetre_SplashAlerte.prototype.ComposeBas = function() {
            return this.message ? '<div class="ofsa_lancerPar">' +
                _strLanceePar.call(this) + '</div>' : '';
        };
        ObjetFenetre_SplashAlerte.prototype.setMessage = function(aMessage, aTitre) {
            this.message = aMessage;
            var lClassImage = '',
                lCouleurTexteBandeau = 'white',
                lCouleurFondBandeau;
            switch (this.message.genreAlerte) {
                case TypeOrigineCreationModeleAlerte.OCMA_Pre_Incendie:
                    lClassImage = 'Image_AlerteIncendie';
                    lCouleurFondBandeau = '#ff4831';
                    break;
                case TypeOrigineCreationModeleAlerte.OCMA_Pre_Confinement:
                    lClassImage = 'Image_AlerteConfinement';
                    lCouleurFondBandeau = '#01a068';
                    break;
                case TypeOrigineCreationModeleAlerte.OCMA_Pre_Inondation:
                    lClassImage = 'Image_AlerteInondation';
                    lCouleurFondBandeau = '#214eb8';
                    break;
                case TypeOrigineCreationModeleAlerte.OCMA_Pre_Nucleaire:
                    lClassImage = 'Image_AlerteNucleaire';
                    lCouleurFondBandeau = '#ffd800';
                    lCouleurTexteBandeau = 'black';
                    break;
                case TypeOrigineCreationModeleAlerte.OCMA_Pre_Tsunami:
                    lClassImage = 'Image_AlerteTsunami';
                    lCouleurFondBandeau = '#1b8dcc';
                    break;
                case TypeOrigineCreationModeleAlerte.OCMA_Pre_Defaut:
                case TypeOrigineCreationModeleAlerte.OCMA_Utilisateur:
                    lClassImage = 'Image_AlerteDanger';
                    lCouleurFondBandeau = '#ff9231';
                    break;
                default:
                    ;
            }
            this.setOptionsFenetre({
                titre: aTitre.toUpperCase(),
                couleurFondBandeau: lCouleurFondBandeau,
                couleurTexteBandeau: lCouleurTexteBandeau,
                classImageAlerte: lClassImage
            });
        };
        module.exports = ObjetFenetre_SplashAlerte;
    },
    fn: "objetfenetre_splashalerte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var EGenreReponseSaisie = require('ObjetRequeteJSON.js').EGenreReponseSaisie;
        var Requetes = require('CollectionRequetes.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeGenreMessage = require('TypeGenreMessage.js').TypeGenreMessage;
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetFenetre_SplashAlerte = require('ObjetFenetre_SplashAlerte.js');
        var TypeOrigineCreationModeleAlerte = require('TypeOrigineCreationModeleAlerte.js').TypeOrigineCreationModeleAlerte;
        var GChaine = require('GChaine.js');
        Requetes.inscrire('SaisieContactVieScolaire', ObjetRequeteSaisie);
        var UtilitaireContactVieScolaire = function() {
            this.listeAlertePPMSEnCours = new ObjetListeElements();
            this.compteurFenetreAlertePPMS = 0;
        };
        var uFenetreAlerteSplash_Visible = false,
            uCacheListeModelesAlerte = null;
        UtilitaireContactVieScolaire.prototype.demarrerMessageInstantane = function() {
            Requetes('SaisieContactVieScolaire', {}).setOptions({
                messageDetail: ''
            }).lancerRequete({
                pourContactVS: false
            }).then(function(aReponse) {
                if (aReponse.genreReponse !== EGenreReponseSaisie.succes) {
                    return;
                }
                var lListeContacts = aReponse.JSONReponse.listeContacts;
                if (!lListeContacts || !aReponse.JSONRapportSaisie.listeDestinataires) {
                    return GApplication.getMessage().afficher({
                        titre: GTraductions.getValeur('ModeExclusif.UsageExclusif'),
                        message: GTraductions.getValeur('ModeExclusif.SaisieImpossibleConsultation')
                    });
                }
                this.afficher_destMessageInstantane({
                    listeContacts: lListeContacts,
                    listeDestinataires: aReponse.JSONRapportSaisie.listeDestinataires,
                    creerDiscussionContactVS: this.creerDiscussionVieScolaire.bind(this),
                    creerMessageInstantane: function(aListeConnectes, aListeNonConnectes) {
                        if (aListeConnectes.GetNbrElements() > 0) {
                            this.creerChat({
                                genreDiscussion: TypeGenreMessage.GM_Conversation,
                                listeContacts: lListeContacts,
                                listeDestinataires: new ObjetListeElements().add(aListeConnectes).add(aListeNonConnectes),
                                objet: GTraductions.getValeur('Messagerie.Conversation')
                            });
                        } else {
                            this.creerNouvelleDiscussion({
                                genreDiscussion: TypeGenreMessage.GM_Message,
                                listeContacts: lListeContacts,
                                listeDestinataires: aListeNonConnectes
                            });
                        }
                    }.bind(this)
                });
            }.bind(this), function() {});
        };
        UtilitaireContactVieScolaire.prototype.afficher_destMessageInstantane = function() {};
        UtilitaireContactVieScolaire.prototype.creerDiscussionVieScolaire = function() {
            Requetes('SaisieContactVieScolaire', {}).setOptions({
                messageDetail: ''
            }).lancerRequete({
                pourContactVS: true
            }).then(function(aReponse) {
                if (aReponse.genreReponse !== EGenreReponseSaisie.succes) {
                    return;
                }
                if (!aReponse.JSONRapportSaisie.listeDestinataires || aReponse.JSONRapportSaisie.listeDestinataires.GetNbrElements() === 0) {
                    GApplication.getMessage().afficher({
                        message: GTraductions.getValeur('Messagerie.AucunPersonnelConnecte')
                    });
                    return;
                }
                var lListeContacts = aReponse.JSONReponse.listeContacts;
                lListeContacts.trier();
                aReponse.JSONRapportSaisie.listeDestinataires.trier();
                var lListeSelectionnables = MethodesObjet.dupliquer(aReponse.JSONRapportSaisie.listeDestinataires);
                lListeContacts.parcourir(function(aRessource) {
                    var lRessourceTrouve = lListeSelectionnables.GetElementParElement(aRessource);
                    if (!lRessourceTrouve) {
                        aRessource.nonEditable = true;
                    }
                });
                this.creerChat({
                    genreDiscussion: TypeGenreMessage.GM_ContactVS,
                    estContactVS: true,
                    listeContacts: lListeContacts,
                    listeDestinataires: aReponse.JSONRapportSaisie.listeDestinataires,
                    listeSelectionnables: lListeSelectionnables,
                    objet: GTraductions.getValeur('Messagerie.ContacterVS')
                });
            }.bind(this), function() {});
        };
        UtilitaireContactVieScolaire.prototype.creerAlertePPMS = function() {
            Requetes('SaisieContactVieScolaire', {}).setOptions({
                messageDetail: ''
            }).lancerRequete({
                pourContactVS: false,
                avecListeModelesAlerte: !uCacheListeModelesAlerte
            }).then(function(aReponse) {
                if (aReponse.genreReponse !== EGenreReponseSaisie.succes) {
                    return;
                }
                if (!aReponse.JSONReponse.listeContacts || !aReponse.JSONRapportSaisie.listeDestinataires) {
                    GApplication.getMessage().afficher({
                        titre: GTraductions.getValeur('ModeExclusif.UsageExclusif'),
                        message: GTraductions.getValeur('ModeExclusif.SaisieImpossibleConsultation')
                    });
                    return;
                }
                if (aReponse.JSONReponse.listeModelesAlerte) {
                    uCacheListeModelesAlerte = aReponse.JSONReponse.listeModelesAlerte;
                }
                if (!uCacheListeModelesAlerte) {
                    return;
                }
                var lAlerte = {
                    estExercice: false,
                    modeleAlerte: uCacheListeModelesAlerte.GetElement(0),
                    listeModelesAlerte: uCacheListeModelesAlerte
                };
                var lListeContacts = aReponse.JSONReponse.listeContacts;
                var lHashParents = {};
                lListeContacts.parcourir(function(aElement) {
                    var lGenre = aElement.GetGenre();
                    if (!lHashParents[lGenre]) {
                        var lParent = new ObjetElement(lGenre === EGenreRessource.Personnel ? GTraductions.getValeur('Messagerie.Personnels') : GTraductions.getValeur('Messagerie.Profs'), 0, lGenre);
                        lHashParents[lGenre] = lParent;
                        lParent.estUnDeploiement = true;
                        lParent.estDeploye = true;
                    }
                    aElement.pere = lHashParents[lGenre];
                });
                for (var lKey in lHashParents) {
                    lListeContacts.AddElement(lHashParents[lKey]);
                }
                aReponse.JSONRapportSaisie.listeDestinataires.trier();
                this.creerChat({
                    genreDiscussion: TypeGenreMessage.GM_Alerte,
                    listeContacts: lListeContacts,
                    listeDestinataires: aReponse.JSONRapportSaisie.listeDestinataires,
                    alerte: lAlerte,
                    objet: GTraductions.getValeur('Messagerie.AlerteEnseignantsPersonnels')
                });
            }.bind(this), function() {});
        };
        UtilitaireContactVieScolaire.prototype._getTitreAlerteDeMessage = function(aMessage) {
            if (aMessage.genreAlerte === TypeOrigineCreationModeleAlerte.OCMA_Pre_Defaut) {
                return aMessage.libelleAlerte || GTraductions.getValeur('SplashAlerte.AlerteDefaut');
            }
            return GTraductions.getValeur('SplashAlerte.AlerteDefaut') + (aMessage.libelleAlerte ? ' ' + aMessage.libelleAlerte : '');
        };
        UtilitaireContactVieScolaire.prototype._getInfosChatMessage = function(aMessage) {
            var lResult = {
                titre: GTraductions.getValeur('Messagerie.ContacterVS'),
                contenuInitial: ''
            };
            if (aMessage.estAlerte) {
                lResult.titre = GChaine.Format(aMessage.perso ? GTraductions.getValeur('Messagerie.AlerteTypeeEnseignantsPersonnels') : GTraductions.getValeur('Messagerie.AlerteTypeeLanceePar'), [this._getTitreAlerteDeMessage(aMessage), aMessage.emetteur]);
            } else if (aMessage.emetteur && aMessage.GetGenre() === TypeGenreMessage.GM_ContactVS) {
                lResult.titre = GChaine.Format(GTraductions.getValeur('Messagerie.AppelDe'), [aMessage.emetteur]);
            } else if (aMessage.GetGenre() === TypeGenreMessage.GM_Conversation) {
                if (aMessage.contenu) {
                    lResult.titre = aMessage.contenu;
                } else if (aMessage.emetteur) {
                    lResult.titre = GChaine.Format('%s - %s', [GTraductions.getValeur('Messagerie.Conversation'), aMessage.emetteur]);
                }
            } else if (aMessage.objet) {
                lResult.titre = aMessage.objet + (aMessage.public ? ' - ' + aMessage.public : '');
            }
            if (!aMessage.estAlerte && aMessage.GetGenre() === TypeGenreMessage.GM_ContactVS && aMessage.listePossessionsMessages && aMessage.listePossessionsMessages.GetNbrElements() === 1) {
                lResult.contenuInitial = GTraductions.getValeur('Messagerie.DemandePriseEnCompte');
            }
            return lResult;
        };

        function _afficherChatVS(aListe, aOptions) {
            var lOptions = Object.assign({
                filtre: null,
                ignorerAlertePPMSSpalsh: false
            }, aOptions);
            if (!aListe) {
                return;
            }
            var lListePourFenetre = new ObjetListeElements();
            var lInstance = this;
            aListe.parcourir(function(aMessage) {
                if (aMessage.messageDejaTraite && !aMessage.estAlerte) {
                    return;
                }
                if (MethodesObjet.isFunction(lOptions.filtre) && lOptions.filtre(aMessage) === false) {
                    return;
                }
                if (aMessage.estAlerteSplash) {
                    aMessage.estAlerteSplash = false;
                    if (!uFenetreAlerteSplash_Visible &&
                        lOptions.ignorerAlertePPMSSpalsh !== true &&
                        lInstance.compteurFenetreAlertePPMS === 0) {
                        var lFenetre = ObjetFenetre.creerInstance(ObjetFenetre_SplashAlerte, {
                            pere: GInterface,
                            evenement: function(aNumeroBouton) {
                                if (aNumeroBouton === 1) {
                                    lInstance.afficherAlertePPMS();
                                }
                            },
                            initialiser: function(aInstance) {
                                aInstance.setMessage(aMessage, lInstance._getTitreAlerteDeMessage(aMessage));
                                aInstance.setOptionsFenetre({
                                    callbackFermer: function() {
                                        uFenetreAlerteSplash_Visible = null;
                                    }
                                });
                            }
                        });
                        lFenetre.Afficher();
                        uFenetreAlerteSplash_Visible = {
                            fermerSiEstAlerte: function(aMessageAlerteCloturee) {
                                if (_getIndiceMessageDansListe(aMessageAlerteCloturee, new ObjetListeElements().add(aMessage)) >= 0) {
                                    lFenetre.Fermer();
                                    return true;
                                }
                                return false;
                            }
                        };
                        return;
                    }
                }
                lListePourFenetre.AddElement(aMessage);
            });
            lListePourFenetre.setTri([ObjetTri.init('date')]).trier();
            this.creerChatDeListe(lListePourFenetre);
        }
        UtilitaireContactVieScolaire.prototype.afficherAlertePPMS = function() {
            _afficherChatVS.call(this, this.listeAlertePPMSEnCours, {
                ignorerAlertePPMSSpalsh: true,
                filtre: function(aMessage) {
                    if (aMessage.estFenetreAffichee) {
                        return false;
                    }
                }
            });
        };

        function _getIndiceMessageDansListe(aMessageModele, aListe) {
            var lIndice = -1;
            if (aMessageModele && aMessageModele.listePossessionsMessages && aMessageModele.listePossessionsMessages.GetNbrElements()) {
                aListe.parcourir(function(aMessage, aIndice) {
                    if (aMessage.listePossessionsMessages) {
                        aMessage.listePossessionsMessages.parcourir(function(aPossession) {
                            if (aMessageModele.listePossessionsMessages.GetElementParElement(aPossession)) {
                                lIndice = aIndice;
                                return false;
                            }
                        });
                    }
                    if (lIndice >= 0) {
                        return false;
                    }
                });
            }
            return lIndice;
        }
        UtilitaireContactVieScolaire.prototype.declarer = function() {
            var lInstance = this;
            Invocateur.abonner('notification_chatVS', function(aListe) {
                Invocateur.evenement('traiter_notifications_chatVS', aListe);
                _afficherChatVS.call(lInstance, aListe, {
                    filtre: function traiterMessage(aMessage) {
                        if (aMessage.estAlerte) {
                            var lIndice = _getIndiceMessageDansListe(aMessage, lInstance.listeAlertePPMSEnCours),
                                lMessageTrouve = lInstance.listeAlertePPMSEnCours.GetElement(lIndice);
                            if (lIndice >= 0 && lMessageTrouve) {
                                if (aMessage.cloture) {
                                    lInstance.listeAlertePPMSEnCours.remove(lIndice);
                                    if (uFenetreAlerteSplash_Visible) {
                                        uFenetreAlerteSplash_Visible.fermerSiEstAlerte(aMessage);
                                    }
                                } else {
                                    Object.assign(lMessageTrouve, aMessage);
                                    aMessage.estAlerteSplash = false;
                                }
                                if (lMessageTrouve.estFenetreAffichee) {
                                    return false;
                                }
                            } else if (!aMessage.cloture) {
                                lInstance.listeAlertePPMSEnCours.AddElement(aMessage);
                            }
                            if (!aMessage.estAlerteSplash &&
                                lInstance.compteurFenetreAlertePPMS === 0) {
                                return false;
                            }
                        }
                        switch (aMessage.GetGenre()) {
                            case TypeGenreMessage.GM_Message:
                                return false;
                        }
                        if (aMessage.perso) {
                            return false;
                        }
                        return true;
                    }
                });
            });
            lInstance.listeAlertePPMSEnCours = GApplication.donneesCentraleNotifications.listeNotifsChatVS || new ObjetListeElements();
            _afficherChatVS.call(lInstance, lInstance.listeAlertePPMSEnCours, {
                filtre: function(aMessage) {
                    if (!aMessage.estAlerteSplash) {
                        return false;
                    }
                    if (uFenetreAlerteSplash_Visible) {
                        return false;
                    }
                }
            });
        };
        module.exports = UtilitaireContactVieScolaire;
    },
    fn: "utilitairecontactviescolaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        function _Cache() {
            this._actif = true;
            this._donnees = [];
        }
        _Cache.prototype.setActif = function(aActif) {
            this._actif = aActif;
        };
        _Cache.prototype.getActif = function() {
            if (IE.optionsDebug && IE.optionsDebug.desactiver_Cache) {
                return false;
            }
            return this._actif;
        };
        _Cache.prototype.getCle = function(aTableauElements) {
            var lCle = '';
            for (var i = 0; i < aTableauElements.length; i++) {
                lCle += aTableauElements[i].getCle();
            }
            return lCle;
        };
        _Cache.prototype.vider = function(aCle) {
            if (aCle) {
                if (this.existeDonnee(aCle)) {
                    this.effacer(aCle);
                }
            } else {
                this._donnees = [];
            }
        };
        _Cache.prototype.effacer = function(aCle) {
            var x;
            var tmpArray = [];
            for (x in this._donnees) {
                if (x !== aCle) {
                    tmpArray[x] = this._donnees[x];
                }
            }
            this._donnees = tmpArray;
        };
        _Cache.prototype.existeDonnee = function(aCle) {
            if (IE.optionsDebug && IE.optionsDebug.desactiver_Cache) {
                return false;
            }
            if (!this.getActif()) {
                return false;
            }
            return (this._donnees[aCle] !== undefined);
        };
        _Cache.prototype.getDonnee = function(aCle) {
            return this._donnees[aCle];
        };
        _Cache.prototype.setDonnee = function(aCle, aObjetDonnee) {
            this._donnees[aCle] = aObjetDonnee;
        };
        module.exports = _Cache;
    },
    fn: "_cache.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var _Cache = require('_Cache.js');
        MethodesObjet.heritagePrototype(CachePN, _Cache);

        function CachePN() {
            this.inheritedCreate();
            this._init();
        }
        CachePN.prototype._init = function() {
            this.general = new _Cache();
            this.ficheScolaire = new _Cache();
            this.resultatsClasses = new _Cache();
            this.dossierVS = new _Cache();
            this.agenda = new _Cache();
            this.livretScolaire = new _Cache();
            this.creneauxLibres = new _Cache();
        };
        CachePN.prototype.reset = function() {
            this._init();
        };
        module.exports = new CachePN();
    },
    fn: "cache.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var TypeEnsembleNombre = require('TypeEnsembleNombre.js');
        var GCache = require('Cache.js');

        function ObjetRequeteListePublics() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('ListePublics', ObjetRequeteListePublics, ObjetRequeteConsultation);
        ObjetRequeteListePublics.prototype.lancerRequete = function(aParam) {
            this.genres = aParam.genres;
            this.sansFiltreSurEleve = aParam.sansFiltreSurEleve || false;
            this.entreResponsables = aParam.entreResponsables;
            this.JSON = {
                genres: new TypeEnsembleNombre().add(aParam.genres),
                sansFiltreSurEleve: this.sansFiltreSurEleve,
                avecFonctionPersonnel: aParam.avecFonctionPersonnel || false,
                avecFiltreDelegues: aParam.avecFiltreDelegues,
                classe: aParam.classe
            };
            if (GCache && GCache.general.existeDonnee(this._getCle())) {
                return new Promise(function(aResolve, aReject) {
                    this.reussitePromesse = aResolve;
                    this.echecPromesse = aReject;
                    this.callbackReussite.appel({
                        listePublic: GCache.general.getDonnee(this._getCle()),
                        genres: aParam.genres
                    });
                }.bind(this));
            } else {
                return this.appelAsynchrone();
            }
        };
        ObjetRequeteListePublics.prototype._getCle = function() {
            return 'listePublic' + '_' + this.genres.sort().join('_') + this.sansFiltreSurEleve + '_' + this.entreResponsables;
        };
        ObjetRequeteListePublics.prototype.actionApresRequete = function() {
            var lObjet = {
                genres: this.genres
            };
            if (GCache) {
                GCache.general.setDonnee(this._getCle(), this.JSONReponse.listePublics);
            }
            lObjet.listePublic = this.JSONReponse.listePublics;
            this.callbackReussite.appel(lObjet);
        };
        module.exports = ObjetRequeteListePublics;
    },
    fn: "objetrequetelistepublics.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteListeRessourcesPourCommunication() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('ListeRessourcesPourCommunication', ObjetRequeteListeRessourcesPourCommunication, ObjetRequeteConsultation);
        ObjetRequeteListeRessourcesPourCommunication.prototype.lancerRequete = function(aParametres) {
            $.extend(this.JSON, aParametres);
            return this.appelAsynchrone();
        };
        ObjetRequeteListeRessourcesPourCommunication.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequeteListeRessourcesPourCommunication;
    },
    fn: "objetrequetelisteressourcespourcommunication.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var TypeChampsJSON = require('Enumere_ChampsJSON.js');
        var TypeHttpVariable = require('TypeHttpVariable.js').TypeHttpVariable;

        function TypeChaineHtml(aChaineHtml) {
            this.chaineHtml = MethodesObjet.isString(aChaineHtml) ? aChaineHtml : '';
        }
        TypeChaineHtml.prototype.toJSON = function() {
            var lJSON = {};
            lJSON[TypeChampsJSON.type] = TypeHttpVariable.TypeHttpHtml;
            lJSON[TypeChampsJSON.valeur] = this.chaineHtml;
            return lJSON;
        };
        module.exports = TypeChaineHtml;
    },
    fn: "typechainehtml.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Invocateur = require('Invocateur.js').Invocateur;
        var Requetes = require('CollectionRequetes.js');
        var TypeChaineHtml = require('TypeChaineHtml.js');
        var TypeGenreMessage = require('TypeGenreMessage.js').TypeGenreMessage;

        function ObjetRequeteSaisieMessage() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieMessage', ObjetRequeteSaisieMessage, ObjetRequeteSaisie);

        function _serialiserlistePossessions(aListe) {
            aListe.setSerialisateurJSON({
                ignorerEtatsElements: true,
                nePasTrierPourValidation: true
            });
            this.JSON.listePossessionsMessages = aListe;
        }
        ObjetRequeteSaisieMessage.prototype.lancerRequete = function(aParam) {
            var lParam = {
                avecHtml: false
            };
            $.extend(lParam, aParam);
            this.JSON.commande = aParam.commande;
            switch (aParam.commande) {
                case 'viderCorbeille':
                    break;
                case 'signalement':
                case 'supprimerMessageGraphe':
                    this.JSON.message = aParam.message;
                    break;
                case 'purger':
                    this.JSON.listeMessagesPurge = aParam.listeMessagesPurge.setSerialisateurJSON({
                        ignorerEtatsElements: true
                    });
                    this.JSON.nbMaxMessages = aParam.nbMaxMessages;
                    break;
                case 'corbeille':
                    _serialiserlistePossessions.call(this, aParam.listePossessionsMessages);
                    break;
                case 'entrerSortirConversation':
                    this.JSON.possessionMessage = aParam.possessionMessage;
                    this.JSON.entrer = aParam.entrer;
                    break;
                case 'entrerSortirDiscussion':
                    this.JSON.possessionMessage = aParam.possessionMessage;
                    this.JSON.estSorti = aParam.estSorti;
                    break;
                case 'signalementSuppression':
                case 'suppression':
                case 'restauration':
                case 'pourLu':
                case 'archive':
                case 'pourOuvrirFermer':
                    this.JSON.lu = aParam.lu;
                    this.JSON.archiver = aParam.archiver;
                    this.JSON.ouvrir = aParam.ouvrir;
                    _serialiserlistePossessions.call(this, lParam.message.listePossessionsMessages);
                    break;
                default:
                    if (aParam.commande === 'brouillon') {
                        this.JSON.brouillon = lParam.brouillon;
                        if (lParam.brouillon && lParam.brouillon.ignorerPJ) {
                            this.JSON.ignorerPJBrouillon = true;
                        }
                        _serialiserTransferts(this.JSON, aParam);
                    } else if (aParam.commande === 'transfert') {
                        _serialiserTransferts(this.JSON, aParam);
                    } else {
                        this.JSON.bouton = lParam.bouton;
                        this.JSON.estCreationCarnetLiaison = lParam.estCreationCarnetLiaison;
                        this.JSON.genreDiscussion = lParam.genreDiscussion;
                        if (lParam.estCreationCarnetLiaison) {
                            this.JSON.eleveCarnetLiaison = lParam.eleveCarnetLiaison;
                        }
                        if (lParam.genreDiscussion === TypeGenreMessage.GM_Alerte) {
                            this.JSON.modeleAlerte = lParam.modeleAlerte;
                            this.JSON.estExercice = lParam.estExercice;
                        }
                        if (lParam.brouillon && lParam.brouillon.existeNumero()) {
                            this.JSON.brouillon = lParam.brouillon;
                            if (lParam.brouillon.ignorerPJ) {
                                this.JSON.ignorerPJBrouillon = true;
                            }
                        }
                    }
                    this.JSON.messagePourReponse = lParam.messagePourReponse;
                    this.JSON.objet = lParam.objet;
                    if (lParam.avecHtml) {
                        this.JSON.contenu = new TypeChaineHtml(lParam.contenu);
                    } else {
                        this.JSON.contenu = lParam.contenu;
                    }
                    this.JSON.listeDestinataires = lParam.listeDestinataires;
                    if (lParam.listeEtiquettes) {
                        this.JSON.listeEtiquettes = lParam.listeEtiquettes.setSerialisateurJSON({
                            ignorerEtatsElements: true
                        });
                    }
                    if (lParam.listeFichiers) {
                        this.JSON.listeFichiers = lParam.listeFichiers.setSerialisateurJSON({
                            methodeSerialisation: _surValidation_Fichier
                        });
                    }
            }
            Invocateur.evenement('requeteSaisieMessage', false, this.callbackReussite.pere);
            return this.appelAsynchrone();
        };
        ObjetRequeteSaisieMessage.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONRapportSaisie);
        };

        function _serialiserTransferts(aJSON, aParam) {
            aJSON.listeMessagesTransfert = aParam.listeMessagesTransfert;
            if (aJSON.listeMessagesTransfert) {
                aJSON.listeMessagesTransfert.setSerialisateurJSON({
                    ignorerEtatsElements: true,
                    nePasTrierPourValidation: true
                });
            }
        }

        function _surValidation_Fichier(aElement, aJSON) {
            var lIdFichier = aElement.idFichier !== undefined ? aElement.idFichier : (aElement.Fichier !== undefined ? aElement.Fichier.idFichier : null);
            if (lIdFichier !== null) {
                aJSON.idFichier = '' + lIdFichier;
            }
            aJSON.nomFichier = aElement.nomFichier;
            aJSON.url = aElement.url;
        }
        ObjetRequeteSaisieMessage.prototype.apresReponseRequete = function() {
            Invocateur.evenement('requeteSaisieMessage', true, this.callbackReussite.pere, this.JSONRapportSaisie);
        };
        module.exports = ObjetRequeteSaisieMessage;
    },
    fn: "objetrequetesaisiemessage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeOrigineCreationEtiquetteMessage = {
            OCEM_Utilisateur: 0,
            OCEM_Pre_Reception: 1,
            OCEM_Pre_Archive: 2,
            OCEM_Pre_Envoye: 3,
            OCEM_Pre_Brouillon: 4,
            OCEM_Pre_Poubelle: 5,
            OCEM_Pre_Signalement: 6,
            OCEM_Expl_Bleu: 7,
            OCEM_Expl_Vert: 8,
            OCEM_Expl_Rouge: 9,
            OCEM_Pre_CarnetLiaison: 10,
            OCEM_Pre_Alerte: 11,
            OCEM_Pre_ContactVS: 12,
            OCEM_Pre_Conversation: 13
        };
        module.exports.TypeOrigineCreationEtiquetteMessage = TypeOrigineCreationEtiquetteMessage;
        TypeOrigineCreationEtiquetteMessage.estEtiquettePerso = function(aGenreEtiquette) {
            return [TypeOrigineCreationEtiquetteMessage.OCEM_Utilisateur, TypeOrigineCreationEtiquetteMessage.OCEM_Expl_Bleu, TypeOrigineCreationEtiquetteMessage.OCEM_Expl_Vert, TypeOrigineCreationEtiquetteMessage.OCEM_Expl_Rouge].indexOf(aGenreEtiquette) >= 0;
        };
    },
    fn: "typeoriginecreationetiquettemessage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeCommandeMessagerie = {
            lu: 0,
            nonLu: 1,
            supprimer: 2,
            archiver: 3,
            desarchiver: 4,
            transferer: 5,
            signaler: 6,
            modifierCategories: 7,
            nouveau: 8,
            fermerDiscussion: 9,
            ouvrirDiscussion: 10,
            signalerSuppression: 11,
            corbeille: 12,
            restaurer: 13,
            plus: 14,
            purger: 15,
            discussionEnFenetre: 16,
            entrerSortirDiscussion: 17
        };
        module.exports.TypeCommandeMessagerie = TypeCommandeMessagerie;
    },
    fn: "typecommandemessagerie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeHttpReponseMessage = {
            rm_Envoi: 0,
            rm_EnvoiATous: 1,
            rm_Relance: 2,
            rm_EnvoiATousSaufParentEleve: 3,
            rm_ClotureAlerte: 4
        };
        module.exports.TypeHttpReponseMessage = TypeHttpReponseMessage;
    },
    fn: "typehttpreponsemessage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('produit/css/UtilitaireMessagerie.css');
        var GUID = require('GUID.js');
        var GChaine = require('GChaine.js');
        var GStyle = require('GStyle.js');
        var GHtml = require('GHtml.js');
        var GImage = require('ObjetImage.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeGenreMessage = require('TypeGenreMessage.js').TypeGenreMessage;
        var EGenreReponseSaisie = require('ObjetRequeteJSON.js').EGenreReponseSaisie;
        var EGenreEspace = require('Enumere_Espace.js');
        var TypeOrigineCreationEtiquetteMessage = require('TypeOrigineCreationEtiquetteMessage.js').TypeOrigineCreationEtiquetteMessage;
        var TypeCommandeMessagerie = require('TypeCommandeMessagerie.js').TypeCommandeMessagerie;
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreEvenementObjetSaisie = require('Enumere_EvenementObjetSaisie.js');
        var EGenreAction = require('Enumere_Action.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetFenetre_ListeCategoriesDiscussion = require('ObjetFenetre_ListeCategoriesDiscussion.js');
        var TypeHttpReponseMessage = require('TypeHttpReponseMessage.js').TypeHttpReponseMessage;
        var MethodesTableau = require('MethodesTableau.js');
        var Support = require('ObjetSupport.js');
        Requetes.inscrire('SaisiePublicMessage', ObjetRequeteSaisie);

        function TUtilitaireMessagerie() {}
        TUtilitaireMessagerie.palierNbMessages = 30;
        TUtilitaireMessagerie.getDiscussion = function(aParam) {
            var H = [],
                lMargeGauche, lMargeDroite, J, lCouleurBordure = aParam.couleurBordure ? aParam.couleurBordure : GCouleur.bordure;
            var lBaseId = GUID.getId() + '_';
            var lNbMessages = aParam.listeMessages.GetNbrElements();
            for (var I = 0; I < lNbMessages; I++) {
                var lMessage = aParam.listeMessages.GetElement(I);
                lMargeGauche = aParam.margesGauche ? aParam.margesGauche[(lMessage.emetteur ? 1 : 0) + (lMessage.estUnAparte ? 2 : 0)] : '0px;';
                lMargeDroite = aParam.margesDroite ? aParam.margesDroite[(lMessage.emetteur ? 1 : 0) + (lMessage.estUnAparte ? 2 : 0)] : '0px;';
                if (I > 0) {
                    H.push('<br/>');
                }
                var lCouleurFieldset;
                if (lMessage.brouillon) {
                    lCouleurFieldset = (aParam.couleurBrouillon ? aParam.couleurBrouillon : GCouleur.nonEditable.fond);
                } else {
                    if (lMessage.estUnAparte) {
                        lCouleurFieldset = (aParam.couleurFond ? aParam.couleurFond : GCouleur.nonEditable.fond);
                    } else {
                        lCouleurFieldset = '#FFFFFF';
                    }
                }
                H.push('<fieldset id="' + lBaseId + lMessage.GetNumero() + '" class="AvecSelectionTexte utilMess_visu_message', (aParam.getAttr ? ' AvecMain' : ''), '"', aParam.getAttr ? aParam.getAttr({
                    indice: I,
                    couleurBordure: lCouleurBordure,
                    id: lBaseId
                }) : '', ' style=" border: 1px solid ', (aParam.couleurBordure ? aParam.couleurBordure : GCouleur.bordure), '; margin-left: ', lMargeGauche, '; margin-right: ', lMargeDroite, ';', ' background-color: ', lCouleurFieldset, ';">');
                H.push('<legend>');
                H.push(this.getLibelleParticipants(lMessage, true, aParam.ieHint));
                H.push('</legend>');
                if (aParam.getCmdSupp) {
                    H.push(aParam.getCmdSupp({
                        indice: I,
                        id: lBaseId,
                        message: lMessage
                    }));
                }
                H.push('<div class="visu_contenu" id="', lBaseId + 'mess_' + I, '">');
                if (lMessage.messageSignale) {
                    H.push('<div class="visu_signale">' + lMessage.messageSignale + '</div>');
                }
                if (lMessage.estHTML) {
                    H.push(lMessage.contenu);
                } else {
                    H.push(GChaine.ToHTML(lMessage.contenu));
                }
                if (lMessage.estSignalantPourSuppr && aParam.getHtmlSignalantPourSupp) {
                    H.push(aParam.getHtmlSignalantPourSupp({
                        indice: I,
                        message: lMessage
                    }));
                }
                H.push('</div>');
                if (lMessage.listeDocumentsJoints && lMessage.listeDocumentsJoints.GetNbrElements() > 0) {
                    H.push(_construirePJs(lMessage));
                }
                if (lMessage.listeMessagesPourContexte) {
                    H.push('<hr/>');
                    for (J = 0; J < lMessage.listeMessagesPourContexte.GetNbrElements(); J++) {
                        var lMessagePourContexte = lMessage.listeMessagesPourContexte.GetElement(J);
                        lMargeGauche = aParam.margesGauche ? aParam.margesGauche[4] : '0px;';
                        lMargeDroite = aParam.margesDroite ? aParam.margesDroite[4] : '0px;';
                        H.push('<div style="margin-left: ', lMargeGauche, '; margin-right: ', lMargeDroite, '">');
                        H.push(this.getLibelleParticipants(lMessagePourContexte, true, aParam.ieHint));
                        H.push('<div style="margin-left: ', (lMessage.estMessageTransferant || lMessage.estSignalantPourSuppr) && !lMessagePourContexte.emetteur ? '0' : lMargeGauche, '; margin-right: ', lMargeDroite, '">');
                        H.push(lMessagePourContexte.contenu);
                        H.push('</div>');
                        if (lMessagePourContexte.listeDocumentsJoints && lMessagePourContexte.listeDocumentsJoints.GetNbrElements() > 0) {
                            H.push('<div style="margin-left: ', lMargeGauche, '; margin-right: ', lMargeDroite, '">');
                            H.push(_construirePJs(lMessagePourContexte));
                            H.push('</div>');
                        }
                        if (J < lMessage.listeMessagesPourContexte.GetNbrElements() - 1) {
                            H.push('<hr/>');
                        }
                        H.push('</div>');
                    }
                }
                var lLibelleSupplementaireDuMessage = null;
                if (!!lMessage.estCarnetLiaison && !!lMessage.avecDirecteur) {
                    lLibelleSupplementaireDuMessage = '<span class="Image_CocheVerte InlineBlock AlignementHaut"></span><span class="PetitEspaceGauche">' + GTraductions.getValeur('MessagerieCarnetLiaison.DirecteurAjoute') + '</span>';
                }
                if (!!lLibelleSupplementaireDuMessage) {
                    var lStyles = ['position: absolute;', 'right: 5px;', 'bottom: 0;', 'background-color: #FFF;', 'border: solid 1px #E4E4E4;', 'border-radius: 1em;', 'padding: 0 5px;', 'transform: translateY(50%);', 'height: 1.5em;', 'line-height: 1.5em;'];
                    H.push('<div style="', lStyles.join(''), '">', lLibelleSupplementaireDuMessage, '</div>');
                }
                H.push('</fieldset>');
            }
            if (aParam.getNodeAfficherSuivants && aParam.nbMessagesTotal > 0 && lNbMessages < aParam.nbMessagesTotal) {
                H.push('<div style="padding-top:5px;">');
                if (lNbMessages + TUtilitaireMessagerie.palierNbMessages < aParam.nbMessagesTotal) {
                    H.push('<div style="padding-top:5px; text-align:center;">', '<a tabindex="-1"', GHtml.composeAttr('ie-node', aParam.getNodeAfficherSuivants, [lNbMessages + TUtilitaireMessagerie.palierNbMessages]), ' class="LienAccueil AvecMain">', GChaine.Format(GTraductions.getValeur('Messagerie.AfficherMessagesSuivants_D'), [Math.min(TUtilitaireMessagerie.palierNbMessages, aParam.nbMessagesTotal - lNbMessages)]), '</a>', '</div>');
                }
                H.push('<div style="padding-top:5px; padding-bottom: 10px; text-align:center;">', '<a tabindex="-1"', GHtml.composeAttr('ie-node', aParam.getNodeAfficherSuivants, [-1]), 'style="amrgin-top:5px;" class="LienAccueil AvecMain">', GChaine.Format(GTraductions.getValeur('Messagerie.AfficherTousMessages_DD'), [aParam.nbMessagesTotal - lNbMessages, aParam.nbMessagesTotal]), '</a>', '</div>');
                H.push('</div>');
            }
            return H.join('');
        };
        TUtilitaireMessagerie.estMessageNonEditable = function(aMessage) {
            return !aMessage || aMessage.ferme || aMessage.estSorti || aMessage.estSignalantContenu || aMessage.estSignalantPourSuppr;
        };

        function _construirePJs(aMessage) {
            var H = [],
                J;
            for (J = 0; J < aMessage.listeDocumentsJoints.GetNbrElements(); J++) {
                var lDocumentJoint = aMessage.listeDocumentsJoints.GetElement(J);
                H.push('<div>');
                H.push(GChaine.composerUrlLienExterne({
                    documentJoint: lDocumentJoint,
                    genreRessource: EGenreRessource.DocJointEtablissement
                }));
                H.push('</div>');
            }
            return H.join('');
        }

        function _getLibelleBrouillonNonEnvoye(aDiscussion, aListeMessagerie, aMessageBrouillon) {
            var lMessageBrouillon = aMessageBrouillon;
            if (!lMessageBrouillon) {
                var lNumeroPossession = aDiscussion.listePossessionsMessages.GetNumero(0);
                aListeMessagerie.parcourir(function(aMessage) {
                    if (!aMessage.estUneDiscussion && aMessage.brouillon && aMessage.listePossessionsMessages && aMessage.listePossessionsMessages.GetNumero(0) === lNumeroPossession) {
                        lMessageBrouillon = aMessage;
                        return false;
                    }
                });
            }
            if (lMessageBrouillon && lMessageBrouillon.transferant) {
                return GTraductions.getValeur('Messagerie.BrouillonDiscussionTransfert');
            }
            return GTraductions.getValeur('Messagerie.BrouillonDiscussion');
        }
        TUtilitaireMessagerie.getLibelleBandeau = function(aDiscussion, aListeMessagerie) {
            var H = [];
            if (aDiscussion.estUneDiscussion) {
                if (aDiscussion.nbBrouillons === 1 && aDiscussion.nbBrouillons === aDiscussion.nombreMessages) {
                    H.push(_getLibelleBrouillonNonEnvoye(aDiscussion, aListeMessagerie));
                } else {
                    H.push(aDiscussion.objet);
                    H.push(' - ');
                    H.push(aDiscussion.public ? aDiscussion.public : GChaine.Format(GTraductions.getValeur('Messagerie.NParticipants'), [aDiscussion.nbPublic]));
                }
            } else {
                if (aDiscussion.brouillon && aDiscussion.pere.nbBrouillons === 1 && aDiscussion.pere.nbBrouillons === aDiscussion.pere.nombreMessages) {
                    H.push(_getLibelleBrouillonNonEnvoye(aDiscussion, aListeMessagerie, aDiscussion));
                } else {
                    H.push(aDiscussion.pere.objet);
                }
            }
            return H.join('');
        };
        TUtilitaireMessagerie.getLibelleObjetDiscussion = function(aDiscussion) {
            var H = [];
            if ((aDiscussion !== null) && (aDiscussion !== undefined)) {
                H.push((aDiscussion.profondeur ? '' : aDiscussion.objet + '&nbsp;') + '(' + aDiscussion.nombreMessages + ')');
            }
            return H.join('');
        };
        TUtilitaireMessagerie.getLibelleDiscussionAccessible = function(aDiscussion) {
            var H = [];
            if (aDiscussion) {
                H.push(TUtilitaireMessagerie.getLibelleObjetDiscussion(aDiscussion));
                H.push('&nbsp;-&nbsp;' + aDiscussion.libelleDate);
            }
            return H.join('');
        };
        TUtilitaireMessagerie.getDetailDiscussionAccessible = function(aDiscussion) {
            var H = [];
            if (aDiscussion) {
                if (aDiscussion.public) {
                    H.push('<div>', aDiscussion.public, '</div>');
                } else {}
                if (aDiscussion.documentsJoints) {
                    H.push('<div>', aDiscussion.documentsJoints, '</div>');
                }
            }
            return H.join('');
        };
        TUtilitaireMessagerie.getLibelleParticipants = function(aMessage, aPourVisuMessages, aIEHint) {
            var H = [];
            if (aMessage.estMessageTransferant) {
                H.push('<div>', aMessage.nbTransfert > 1 ? GChaine.Format(GTraductions.getValeur('Messagerie.NMessagestransferes'), [aMessage.nbTransfert]) : GTraductions.getValeur('Messagerie.1Messagetransfere'), '</div>');
            } else {
                H.push('<div style="display:flex; align-items:center; overflow:hidden;" ', (aMessage.lu && !aPourVisuMessages ? '' : ' class="Gras"'), '>');
                if (aPourVisuMessages && aMessage.brouillon) {
                    H.push('<div style="', GStyle.composeCouleurTexte('red'), '">[', GTraductions.getValeur('Messagerie.Brouillon'), ']</div>');
                    H.push('<div>&nbsp;' + aMessage.libelleDate + '</div>');
                } else {
                    if (aMessage.estCarnetLiaison) {
                        H.push('<div ie-ellipsis style="max-width:250px;">', aMessage.public_gauche, '</div>');
                    } else {
                        H.push(aMessage.public_gauche ? '<div' + (aMessage.hint_gauche && !IE.estMobile ? GHtml.composeAttr('ie-hint', GChaine.ToHTML(aMessage.hint_gauche)) : '') + (aPourVisuMessages ? ' ie-ellipsis style="max-width:250px;min-width:25px;"' : ' style="overflow:hidden; min-width:25px;" ie-ellipsis-fixe ') + '>' + aMessage.public_gauche + '</div>' : '<div' + (aIEHint && aMessage.nbPublic > 1 ? IE.estMobile ? GHtml.composeAttr('ie-event', 'ie-click->' + aIEHint, [aMessage.GetNumero(), true]) : GHtml.composeAttr('ie-hint', aIEHint, [aMessage.GetNumero(), true]) : '') + '>' + GImage.composeImage('Image_Messagerie_Groupe', 16, false) + '</div>');
                        H.push('<div style="margin-left: 5px; margin-right: 5px;">' + GImage.composeImage(aMessage.sens !== false ? 'Image_Messagerie_FlecheDroite' : 'Image_Messagerie_FlecheGauche', 21, false) + '</div>');
                        H.push(aMessage.public_droite ? '<div' + (aMessage.hint_droite && !IE.estMobile ? GHtml.composeAttr('ie-hint', GChaine.ToHTML(aMessage.hint_droite)) : '') + (aPourVisuMessages ? ' ie-ellipsis style="max-width:250px; min-width:25px;"' : ' style="overflow:hidden; min-width:25px;" ie-ellipsis-fixe ') + '>' + aMessage.public_droite + '</div>' : aMessage.brouillon ? '' : '<div' + (aIEHint && aMessage.nbPublic > 1 ? IE.estMobile ? GHtml.composeAttr('ie-event', 'ie-click->' + aIEHint, [aMessage.GetNumero(), false]) : GHtml.composeAttr('ie-hint', aIEHint, [aMessage.GetNumero(), false]) : '') + '>' + GImage.composeImage('Image_Messagerie_Groupe', 16, false) + '</div>');
                    }
                    if (aPourVisuMessages) {
                        H.push('<div class="Maigre" style="margin-left: 10px;">' + aMessage.libelleDate + '</div>');
                    }
                }
                if (aPourVisuMessages) {
                    H.push(TUtilitaireMessagerie.dessinListeEtiquettes(aMessage.listeEtiquettes, true));
                }
                H.push('</div>');
            }
            return H.join('');
        };
        TUtilitaireMessagerie.getListePublicMessage_promise = function(aInstance, aNumeroMessage, aEstPublicParticipant, aEstDestinatairesReponse) {
            var lParams = {
                message: new ObjetElement('', aNumeroMessage),
                estPublicParticipant: aEstPublicParticipant,
                estDestinatairesReponse: aEstDestinatairesReponse
            };
            return Requetes('SaisiePublicMessage', aInstance).setOptions({
                avecControleModeExclusif: false,
                messageDetail: ''
            }).lancerRequete(lParams).then(function(aReponse) {
                if (aReponse.genreReponse !== EGenreReponseSaisie.succes) {
                    return;
                }
                var lListeDest = aReponse.JSONReponse.listeDest;
                if (!lListeDest && aReponse.JSONRapportSaisie && aReponse.JSONRapportSaisie.listeDest) {
                    lListeDest = aReponse.JSONRapportSaisie.listeDest;
                    lListeDest.avecConnection = true;
                }
                if (lListeDest) {
                    lListeDest.setTri([ObjetTri.init('Genre'), ObjetTri.init('Position')]).trier();
                }
                return lListeDest;
            });
        };
        TUtilitaireMessagerie.getStrHintPublicMessage_promise = function(aInstance, aNumeroMessage, aEstPublicParticipant, aEstDestinatairesReponse, aNode) {
            var lKey = 'strHint' + !!aEstPublicParticipant;
            if (aNode) {
                var lData = $(aNode).data(lKey);
                if (lData) {
                    return lData;
                }
            }
            return TUtilitaireMessagerie.getListePublicMessage_promise(aInstance, aNumeroMessage, aEstPublicParticipant, aEstDestinatairesReponse).then(function(aListe) {
                var lStr = '&nbsp;';
                if (aListe) {
                    var lTab = [];
                    aListe.parcourir(function(aPublic) {
                        var lLibelleSupp = '';
                        if (aPublic.estSorti) {
                            lLibelleSupp += '&nbsp;<i class="icon_sortir_reintegrer_conversation" style="font-size:1.4rem;"></i>&nbsp;' + GTraductions.getValeur('Messagerie.Retire');
                        }
                        if (aListe.avecConnection) {
                            lTab.push(TUtilitaireMessagerie.contruirePublicConnecte(aPublic, lLibelleSupp));
                        } else {
                            lTab.push(aPublic.GetLibelle() + lLibelleSupp);
                        }
                    });
                    lStr = lTab.join(aListe.avecConnection ? '' : '<br>');
                }
                if (aNode) {
                    $(aNode).data(lKey, lStr);
                }
                return lStr;
            });
        };
        TUtilitaireMessagerie.getIndiceDiscussion = function(aListeMessagerie, aMessage) {
            if (aMessage && aMessage.listePossessionsMessages) {
                for (var I = 0; I < aMessage.listePossessionsMessages.GetNbrElements(); I++) {
                    var lPossessionMessage = aMessage.listePossessionsMessages.GetElement(I);
                    for (var J = 0; J < aListeMessagerie.GetNbrElements(); J++) {
                        var lDiscussion = aListeMessagerie.GetElement(J);
                        for (var K = 0; K < lDiscussion.listePossessionsMessages.GetNbrElements(); K++) {
                            if ((lPossessionMessage.GetNumero() === lDiscussion.listePossessionsMessages.GetNumero(K)) && (aMessage.estUneDiscussion === lDiscussion.estUneDiscussion) && ((aMessage.pere && lDiscussion.pere) || (!aMessage.pere && !lDiscussion.pere))) {
                                return J;
                            }
                        }
                    }
                }
            }
            return null;
        };
        TUtilitaireMessagerie.getIndicePere = function(aListeMessagerie, aMessage) {
            if (aMessage.indicePere >= 0) {
                return this.getIndicePere(aListeMessagerie, aListeMessagerie.GetElement(aMessage.indicePere));
            } else {
                return aMessage.indice;
            }
        };
        TUtilitaireMessagerie.estEgal = function(aMessage1, aMessage2) {
            if (aMessage1 && aMessage2) {
                if (aMessage1.estUneDiscussion && aMessage2.estUneDiscussion) {
                    return aMessage1.profondeur === aMessage2.profondeur && aMessage1.objet === aMessage2.objet && aMessage1.listePossessionsMessages.GetNbrElements() === aMessage2.listePossessionsMessages.GetNbrElements() && (aMessage1.listePossessionsMessages.GetNbrElements() === 0 || aMessage1.listePossessionsMessages.GetNumero(0) === aMessage2.listePossessionsMessages.GetNumero(0));
                } else if (!aMessage1.estUneDiscussion && !aMessage2.estUneDiscussion) {
                    return aMessage1.GetNumero() === aMessage2.GetNumero();
                }
            }
            return false;
        };
        TUtilitaireMessagerie.avecPossessionPartageeEntreMessages = function(aMessage1, aMessage2) {
            var lResult = false;
            if (aMessage1 && aMessage2 && aMessage1.listePossessionsMessages && aMessage2.listePossessionsMessages) {
                aMessage1.listePossessionsMessages.parcourir(function(aPossession) {
                    if (aMessage2.listePossessionsMessages.GetElementParElement(aPossession)) {
                        lResult = true;
                        return false;
                    }
                });
            }
            return lResult;
        };
        TUtilitaireMessagerie.dessinCouleurEtiquette = function(aEtiquette) {
            if (!aEtiquette.couleur) {
                return '';
            }
            return ['<div class="utilMess_etiquette" style="', GStyle.composeCouleur(aEtiquette.couleur, GCouleur.getCouleurCorrespondance(aEtiquette.couleur)), '"', ' title="', GChaine.toTitle(aEtiquette.GetLibelle()), '">', aEtiquette.abr || '', '</div>'].join('');
        };
        TUtilitaireMessagerie.dessinListeEtiquettes = function(aListeEtiquettes, aAvecEspaceGaucheDebut) {
            if (!aListeEtiquettes || !aListeEtiquettes.parcourir) {
                return '';
            }
            var H = [];
            aListeEtiquettes.parcourir(function(aEtiquette, aIndex) {
                var lHtml = TUtilitaireMessagerie.dessinCouleurEtiquette(aEtiquette);
                if (lHtml) {
                    H.push('<div class="InlineBlock AlignementMilieuVertical Maigre', (aAvecEspaceGaucheDebut && aIndex === 0 ? ' PetitEspaceGauche' : ''), (aIndex < aListeEtiquettes.GetNbrElements() - 1 ? ' PetitEspaceDroit' : ''), '">', lHtml, '</div>');
                }
            });
            return H.join('');
        };
        TUtilitaireMessagerie.estMessageVisuChat = function(aMessageVisu) {
            if (aMessageVisu) {
                if (aMessageVisu.estChat) {
                    return true;
                }
                switch (aMessageVisu.GetGenre()) {
                    case TypeGenreMessage.GM_ContactVS:
                    case TypeGenreMessage.GM_Conversation:
                    case TypeGenreMessage.GM_Alerte:
                        return true;
                }
            }
            return false;
        };
        TUtilitaireMessagerie.contruirePublicConnecte = function(aPublic, aLibelleSupp) {
            if (!aPublic) {
                return '';
            }
            var lEnCours = aPublic.enCours && aPublic.estConnecte;
            return ['<div class="utilMess_dest ', (lEnCours ? 'utilMess_enCours' : aPublic.estConnecte ? 'utilMess_connecte' : ''), '">', '<div class="utilMess_cadre"></div>', '<div class="utilMess_texte" ie-ellipsis>', aPublic.GetLibelle(), '<label>&nbsp;-&nbsp;', (lEnCours ? GTraductions.getValeur('Messagerie.EnClasse') : aPublic.estConnecte ? GTraductions.getValeur('Messagerie.Connectee') : GTraductions.getValeur('Messagerie.NonConnectee')), '</label>', aLibelleSupp || '', '</div>', '</div>'].join('');
        };
        TUtilitaireMessagerie.traiterListeEtiquette = function(aListeEtiquettes, aAvecCategories) {
            var lAvecDiscussionAvancee = GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee);
            var lAvecCategories = aAvecCategories !== false && lAvecDiscussionAvancee;
            var lLibelleEtiquetteToutes = GTraductions.getValeur('Messagerie.Toutes');
            if (GEtatUtilisateur.GenreEspace === EGenreEspace.PrimParent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent) {
                lLibelleEtiquetteToutes = GTraductions.getValeur('Messagerie.LesMiennes');
            }
            var lElement = new ObjetElement(lLibelleEtiquetteToutes, 1);
            lElement.toutes = true;
            aListeEtiquettes.AddElement(lElement);
            if (lAvecDiscussionAvancee) {
                lElement = new ObjetElement(GTraductions.getValeur('Messagerie.EnCours'), 2);
                lElement.enCours = true;
                aListeEtiquettes.insererElement(lElement, 1);
            }
            if (lAvecCategories) {
                lElement = new ObjetElement(GTraductions.getValeur('Messagerie.Titre.Categories'), 3);
                lElement.categories = true;
                aListeEtiquettes.AddElement(lElement);
            }
            aListeEtiquettes.parcourir(function(aEtiquette) {
                if (aEtiquette.couleur) {
                    aEtiquette.libelleHtml = '<div class="InlineBlock AlignementMilieuVertical PetitEspaceDroit">' +
                        TUtilitaireMessagerie.dessinCouleurEtiquette(aEtiquette) + '</div>' + '<div class="InlineBlock AlignementMilieuVertical">' + aEtiquette.GetLibelle() + '</div>';
                }
            });
            var lTriEtiquettes = [];
            if (GEtatUtilisateur.GenreEspace === EGenreEspace.PrimParent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent) {
                lTriEtiquettes.push(ObjetTri.init(function(D) {
                    return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison;
                }), ObjetTri.init(function(D) {
                    return !D.toutes;
                }));
            } else {
                lTriEtiquettes.push(ObjetTri.init(function(D) {
                    return !D.enCours;
                }), ObjetTri.init(function(D) {
                    return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Archive;
                }), ObjetTri.init(function(D) {
                    return !D.toutes;
                }), ObjetTri.init(function(D) {
                    return !D.categories;
                }), ObjetTri.init(function(D) {
                    return !TypeOrigineCreationEtiquetteMessage.estEtiquettePerso(D.GetGenre());
                }), ObjetTri.init(function(D) {
                    return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison;
                }));
            }
            lTriEtiquettes.push(ObjetTri.init(function(D) {
                return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Conversation;
            }), ObjetTri.init(function(D) {
                return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Alerte;
            }), ObjetTri.init(function(D) {
                return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_ContactVS;
            }), ObjetTri.init(function(D) {
                return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Brouillon;
            }), ObjetTri.init(function(D) {
                return D.GetGenre() !== TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle;
            }), ObjetTri.init('Libelle'));
            aListeEtiquettes.setTri(lTriEtiquettes).trier();
        };
        TUtilitaireMessagerie.contruireImageEtiquette = function(aEtiquette) {
            var lResult = {
                icone: '',
                avecCompteurNonLu: true
            };
            var lIconeName;
            if (aEtiquette.toutes) {
                lIconeName = 'Image_MenuDiscussionToutes';
                if (GEtatUtilisateur.GenreEspace === EGenreEspace.PrimParent) {
                    lIconeName = 'Image_MenuDiscussionLesMiennes';
                }
                lResult.icone = '<div class="' + lIconeName + '"></div>';
            } else if (aEtiquette.enCours) {
                lResult.icone = '<i class="icon_discussion_cours"></i>';
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Archive) {
                lResult.icone = '<i class="icon_archiver_discussion"></i>';
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Alerte) {
                lResult.icone = '<i class="icon_conversation_alerte"></i>';
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_ContactVS) {
                lResult.icone = '<i class="icon_conversation_contact_vie_sco"></i>';
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Conversation) {
                lResult.icone = '<i class="icon_conversation_cours"></i>';
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Brouillon) {
                lResult.icone = '<i class="icon_brouillon_discussion"></i>';
                lResult.avecCompteurNonLu = false;
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle) {
                lResult.icone = '<i class="icon_trash"></i>';
                lResult.avecCompteurNonLu = false;
            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison) {
                lIconeName = 'Image_MenuDiscussionCarnetLiaison';
                if (GEtatUtilisateur.GenreEspace === EGenreEspace.PrimParent) {
                    lIconeName = 'Image_MenuDiscussionCarnetLiaisonEnfant';
                }
                lResult.icone = '<div class="' + lIconeName + '"></div>';
            } else if (TypeOrigineCreationEtiquetteMessage.estEtiquettePerso(aEtiquette.GetGenre())) {
                lResult.icone = ['<div style="', GStyle.composeHeight(18), 'line-height: 18px; min-width:18px;', GStyle.composeCouleur(aEtiquette.couleur, GCouleur.getCouleurCorrespondance(aEtiquette.couleur)), '" class="AlignementMilieu">', aEtiquette.abr || '', '</div>'].join('');
            }
            return lResult;
        };
        TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette = function(aDiscussion, aEtiquette) {
            if (!aEtiquette) {
                return true;
            }
            if (aEtiquette.categories) {
                return false;
            }
            var lExclusions = [];
            var lAvecEtiquettes = [];
            var lEtiquetteFiltre = null;
            var lVisible = true;
            var lEstPrimParent = GEtatUtilisateur.GenreEspace === EGenreEspace.PrimParent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent;
            if (aEtiquette.toutes) {
                lExclusions = [TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle];
                if (lEstPrimParent) {
                    lExclusions.push(TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison);
                }
            } else if (aEtiquette.enCours) {
                lExclusions = [
                    TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle, TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Archive, TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Alerte, TypeOrigineCreationEtiquetteMessage.OCEM_Pre_ContactVS, TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Conversation
                ];
            } else if (TypeOrigineCreationEtiquetteMessage.estEtiquettePerso(aEtiquette.GetGenre())) {
                lExclusions = [TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle];
                lEtiquetteFiltre = aEtiquette;
            } else {
                switch (aEtiquette.GetGenre()) {
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison:
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Archive:
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Conversation:
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Alerte:
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_ContactVS:
                        lExclusions = [TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle];
                        lEtiquetteFiltre = aEtiquette;
                        break;
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Brouillon:
                        lAvecEtiquettes = [TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Brouillon];
                        lExclusions = [TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle];
                        break;
                    case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle:
                        lExclusions = [];
                        lAvecEtiquettes = [TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle];
                        break;
                    default:
                        ;
                }
            }
            lExclusions.forEach(function(aGenreExclu) {
                aDiscussion.listeEtiquettes.parcourir(function(D) {
                    if (D.GetGenre() === aGenreExclu) {
                        lVisible = false;
                        return false;
                    }
                });
            });
            if (lVisible && lEtiquetteFiltre) {
                lVisible = false;
                aDiscussion.listeEtiquettes.parcourir(function(D) {
                    if (lEtiquetteFiltre.GetNumero() === D.GetNumero()) {
                        lVisible = true;
                        return false;
                    }
                });
                if (lVisible && lEstPrimParent && lEtiquetteFiltre.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison) {
                    if (!!aDiscussion.contexte && !!lEtiquetteFiltre.contexte) {
                        lVisible = aDiscussion.contexte.GetNumero() === lEtiquetteFiltre.contexte.GetNumero();
                    }
                }
            }
            if (lVisible) {
                lAvecEtiquettes.forEach(function(aGenreEtiquette) {
                    lVisible = false;
                    aDiscussion.listeEtiquettes.parcourir(function(D) {
                        if (D.GetGenre() === aGenreEtiquette) {
                            lVisible = true;
                            return false;
                        }
                    });
                });
            }
            if (lVisible && aDiscussion.pere) {
                lVisible = TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette(aDiscussion.pere, aEtiquette);
            }
            return lVisible;
        };
        TUtilitaireMessagerie.getEtiquetteInitSelonMessage = function(aListeEtiquettes, aEtiquetteOriginal, aAvecSelecteurEtiquette, aMessageSelectionne) {
            var lEtiquette = aEtiquetteOriginal;
            if (!aListeEtiquettes) {
                return lEtiquette;
            }
            var lEtiquetteToutes = null;
            aListeEtiquettes.parcourir(function(D) {
                if (D.toutes) {
                    lEtiquetteToutes = D;
                    return false;
                }
            });
            if (!lEtiquette || !aListeEtiquettes.GetElementParNumero(lEtiquette.GetNumero())) {
                lEtiquette = lEtiquetteToutes;
                if (aAvecSelecteurEtiquette && GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee)) {
                    aListeEtiquettes.parcourir(function(D) {
                        if (D.enCours) {
                            lEtiquette = D;
                            return false;
                        }
                    });
                }
            }
            if (lEtiquette && aAvecSelecteurEtiquette && lEtiquette.enCours && aMessageSelectionne && lEtiquetteToutes && !TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette(aMessageSelectionne, lEtiquette)) {
                lEtiquette = lEtiquetteToutes;
            }
            if (lEtiquette && aAvecSelecteurEtiquette && aMessageSelectionne && !TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette(aMessageSelectionne, lEtiquette)) {
                aListeEtiquettes.parcourir(function(D) {
                    if (!D.enCours && !D.toutes && TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette(aMessageSelectionne, D)) {
                        lEtiquette = D;
                        return false;
                    }
                });
            }
            return lEtiquette;
        };
        TUtilitaireMessagerie.avecCommandeMessagerieDeGenre = function(aGenre, aMessage) {
            var lEnConsult = GApplication.droits.get(TypeDroits.estEnConsultation);
            var lDiscussionAvancee = GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee);
            switch (aGenre) {
                case TypeCommandeMessagerie.nouveau:
                    return !lEnConsult;
                case TypeCommandeMessagerie.lu:
                    return !lEnConsult && aMessage && !aMessage.lu;
                case TypeCommandeMessagerie.nonLu:
                    return !lEnConsult && aMessage && aMessage.lu;
                case TypeCommandeMessagerie.archiver:
                    return !lEnConsult && lDiscussionAvancee && aMessage && !aMessage.archive && !aMessage.poubelle && !aMessage.estNonPossede;
                case TypeCommandeMessagerie.desarchiver:
                    return !lEnConsult && lDiscussionAvancee && aMessage && aMessage.archive && !aMessage.poubelle && !aMessage.estNonPossede;
                case TypeCommandeMessagerie.signaler:
                case TypeCommandeMessagerie.signalerSuppression:
                    return !lEnConsult && lDiscussionAvancee && !aMessage.brouillon && !TUtilitaireMessagerie.estMessageNonEditable(aMessage) && !aMessage.estNonPossede;
                case TypeCommandeMessagerie.transferer:
                    return !lEnConsult && lDiscussionAvancee && aMessage && !TUtilitaireMessagerie.estMessageNonEditable(aMessage) && ((!aMessage.estUneDiscussion && !aMessage.brouillon) || (aMessage.estUneDiscussion && (aMessage.nbBrouillons || 0) < aMessage.nombreMessages));
                case TypeCommandeMessagerie.modifierCategories:
                    return !lEnConsult && lDiscussionAvancee && aMessage && !aMessage.estNonPossede && !!ObjetFenetre_ListeCategoriesDiscussion;
                case TypeCommandeMessagerie.corbeille:
                    return !lEnConsult && aMessage && aMessage.estUneDiscussion && aMessage.profondeur === 0 && !aMessage.poubelle && !aMessage.estNonPossede;
                case TypeCommandeMessagerie.purger:
                    return !lEnConsult && aMessage && aMessage.messagePurge;
                case TypeCommandeMessagerie.supprimer:
                    return !lEnConsult && aMessage && ((aMessage.estUneDiscussion && aMessage.poubelle) || aMessage.brouillon) && !aMessage.estNonPossede;
                case TypeCommandeMessagerie.restaurer:
                    return !lEnConsult && aMessage && aMessage.poubelle;
                case TypeCommandeMessagerie.fermerDiscussion:
                    return !lEnConsult && lDiscussionAvancee && aMessage && aMessage.fermable && !aMessage.estNonPossede && !aMessage.estSorti;
                case TypeCommandeMessagerie.ouvrirDiscussion:
                    return !lEnConsult && lDiscussionAvancee && aMessage && aMessage.ouvrable && !aMessage.estNonPossede && !aMessage.estSorti;
                case TypeCommandeMessagerie.discussionEnFenetre:
                    return !lEnConsult && aMessage && aMessage.messageFenetre && aMessage.dernierPossessionMessage;
                case TypeCommandeMessagerie.entrerSortirDiscussion:
                    return !lEnConsult && aMessage && aMessage.avecIODicussion && aMessage.dernierPossessionMessage;
                default:
                    ;
                    return false;
            }
        };
        TUtilitaireMessagerie.getCommandePurgerListeMessages_promise = function(aListeMessages, aPurgerSelection) {
            if (!aListeMessages || !aListeMessages.GetNbrElements || aListeMessages.GetNbrElements() === 0) {
                return Promise.resolve();
            }
            var lListeMessagesPurge = aListeMessages;
            var H = [];
            H.push('<b>', GTraductions.getValeur('Messagerie.ConfirmationRaccourcir_Titre'), '</b>', '<br>', '<br>', '<div class="listeMessagerie_messConfirm">', '<div class="Insecable">', GTraductions.getValeur('Messagerie.ConfirmationRaccourcir_SeulsLes'), '</div>', '<div><ie-combo ie-model="combo"></ie-combo></div>', '<div>', GTraductions.getValeur('Messagerie.ConfirmationRaccourcir_DerniersMessages'), '</div>', '</div>', aPurgerSelection ? GTraductions.getValeur('Messagerie.ConfirmationRaccourcir_DiscussionSel') : GTraductions.getValeur('Messagerie.ConfirmationRaccourcir_DiscussionToutes'), '<br><br>', GChaine.ToHTML(GTraductions.getValeur('Messagerie.ConfirmationRaccourcir_3')));
            var lChoix = [10, 20, 50, 100];
            var lIndiceSelection = 1;
            var lNbMaxMessages = lChoix[lIndiceSelection];
            var lListe = new ObjetListeElements();
            lChoix.forEach(function(aVal) {
                lListe.AddElement(new ObjetElement(aVal + '', aVal));
            });
            var lControleur = {
                combo: {
                    init: function(aCombo) {
                        aCombo.setOptions_ObjetSaisie({
                            longueur: 25
                        });
                        aCombo.SetDonnees(lListe, lIndiceSelection);
                    },
                    event: function(aParametres) {
                        if (aParametres.genreEvenement === EGenreEvenementObjetSaisie.selection && aParametres.element) {
                            lNbMaxMessages = aParametres.element.GetNumero();
                        }
                    }
                }
            };
            return GApplication.getMessage().afficher({
                type: EGenreBoiteMessage.Confirmation,
                message: H.join(''),
                controleur: lControleur,
                width: 430
            }).then(function(aAccepte) {
                if (aAccepte !== EGenreAction.Valider) {
                    return;
                }
                return {
                    commande: 'purger',
                    listeMessagesPurge: lListeMessagesPurge,
                    nbMaxMessages: lNbMaxMessages
                };
            }.bind(this));
        };
        TUtilitaireMessagerie.ouvrirFenetreListeCategoriesDiscussion = function(aListeMessages, aListeEtiquettes, aCallback) {
            var lAvecModif = false;
            ObjetFenetre.creerInstance(ObjetFenetre_ListeCategoriesDiscussion, {
                pere: this
            }, {
                surSaisieEtiquette: function() {
                    lAvecModif = true;
                },
                callbackFermer: function() {
                    if (lAvecModif) {
                        aCallback();
                    }
                }.bind(this)
            }).SetDonnees({
                listeEtiquettes: aListeEtiquettes,
                listeMessages: aListeMessages
            });
        };
        TUtilitaireMessagerie.getGenreReponse = function(aGenre, aAvecInclureParentsEleves) {
            return aGenre === TypeHttpReponseMessage.rm_EnvoiATousSaufParentEleve && aAvecInclureParentsEleves ? TypeHttpReponseMessage.rm_EnvoiATous : aGenre;
        };
        TUtilitaireMessagerie.estGenreDestinataireAutorise = function(aGenreRessource) {
            switch (aGenreRessource) {
                case EGenreRessource.Eleve:
                    return GApplication.droits.get(TypeDroits.communication.avecDiscussionEleves);
                case EGenreRessource.Responsable:
                    return GApplication.droits.get(TypeDroits.communication.avecDiscussionParents);
                case EGenreRessource.Enseignant:
                    return GApplication.droits.get(TypeDroits.communication.avecDiscussionProfesseurs);
                case EGenreRessource.Personnel:
                    return GApplication.droits.get(TypeDroits.communication.avecDiscussionPersonnels);
                default:
                    ;
            }
            return false;
        };
        TUtilitaireMessagerie.unMessageContientLeDirecteur = function(aListeMessages) {
            var result = false;
            if (!!aListeMessages) {
                aListeMessages.parcourir(function(D) {
                    if (D.avecDirecteur) {
                        result = true;
                        return false;
                    }
                });
            }
            return result;
        };
        TUtilitaireMessagerie.avecEditionHtmlMessage = function() {
            return GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee);
        };
        TUtilitaireMessagerie.avecEditeurTiny = function() {
            return GNavigateur.withContentEditable && Support.contentEditable && !IE.estMobile && TUtilitaireMessagerie.avecEditionHtmlMessage();
        };
        TUtilitaireMessagerie.avecAjoutPieceJointeMessage = function() {
            return Support.avecSupportFileUpload && !MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [
                EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Parent, EGenreEspace.Mobile_Parent, EGenreEspace.PrimParent, EGenreEspace.Mobile_PrimParent, EGenreEspace.PrimEleve, EGenreEspace.Mobile_PrimEleve
            ]);
        };
        TUtilitaireMessagerie.getListeDestCarnetLiaisonDEleve_PrimParent = function(aNumeroEleve) {
            var lEleve = GEtatUtilisateur.Identification.ListeRessources.GetElementParNumero(aNumeroEleve);
            if (!lEleve || !lEleve.destinatairesCarnetLiaison) {
                return new ObjetListeElements();
            }
            return lEleve.destinatairesCarnetLiaison;
        };
        module.exports = TUtilitaireMessagerie;
    },
    fn: "utilitairemessagerie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var Invocateur = require('Invocateur.js').Invocateur;

        function ObjetRequeteListeMessages() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('ListeMessages', ObjetRequeteListeMessages, ObjetRequeteConsultation);
        ObjetRequeteListeMessages.prototype.lancerRequete = function(aParametres) {
            var lParametres = $.extend({}, aParametres);
            $.extend(this.JSON, lParametres);
            this.JSON.marquerCommeLu = aParametres.marquerCommeLu;
            this.JSON.estNonPossede = lParametres.message.estNonPossede;
            lParametres.message.listePossessionsMessages.setSerialisateurJSON({
                ignorerEtatsElements: true,
                nePasTrierPourValidation: true,
                methodeSerialisation: function(aElement) {
                    if (aElement.ignorerSerialisation === true) {
                        return false;
                    }
                }
            });
            this.JSON.listePossessionsMessages = lParametres.message.listePossessionsMessages;
            if (lParametres.message.estUneDiscussion && lParametres.message.profondeur > 0) {
                this.JSON.estSousDiscussion = true;
            }
            return this.appelAsynchrone();
        };
        ObjetRequeteListeMessages.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse);
            if (this.JSONReponse.nbMarquerLu > 0) {
                Invocateur.evenement('modifier_notification_communication', EGenreOnglet.Messagerie, -this.JSONReponse.nbMarquerLu);
            }
        };
        module.exports = ObjetRequeteListeMessages;
    },
    fn: "objetrequetelistemessages.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('Produit/Css/ObjetMenuContextuel.css');
        var EGenreBordure = require('_ObjetStyle.js').EGenreBordure;
        var GLog = require('IELog.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GHtml = require('GHtml.js');
        var GPosition = require('GPosition.js');
        var GStyle = require('GStyle.js');
        var EGenreDirection = require('Enumere_Direction.js');
        var EEvent = require('Enumere_Event.js');
        require('IEHtml.SelecFile.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var Identite = require('ObjetIdentite.js');
        var GImage = require('ObjetImage.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreObjet = require('ObjetWAI.js').EGenreObjet;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var GestionnaireModale = require('GestionnaireModale.js');
        var GChaine = require('GChaine.js');
        var ToucheClavier = require('ToucheClavier.js');
        var EGenreLigneMenu = {
            Separateur: 0,
            Commande: 1,
            Deploiement: 2,
            Titre: 3
        };

        function ObjetMenuContextuel() {
            this.inheritedCreate(arguments);
            this.ListeLignes = new ObjetListeElements();
            this._callbacksAfficherLignes = [];
            this.IdNomMenuContextuel = this.Nom + '_MenuContextuel';
            this.IdPremierElement = this.IdNomMenuContextuel;
            this.IdPrecedent = '';
            this.couleurBarre = GCouleur.themeNeutre.legere;
            this.ajouterEvenementGlobal(EEvent.SurPreResize, this.Fermer);
            this.options = {
                largeurMin: null,
                largeurMaxLibelle: 400,
                largeurColonneGauche: 25,
                imageFormate: false,
                couleurFond: GCouleur.blanc,
                couleurBordureDroiteImage: GCouleur.bordure,
                heightLigne: 16,
                preventScrollSurRestaurationFocus: false
            };
        }
        MethodesObjet.heritagePrototype(ObjetMenuContextuel, Identite);
        ZoneFenetre.etendreEnFenetre(ObjetMenuContextuel, {
            zIndex: 1200
        });
        ObjetMenuContextuel.afficher = function(aParametres) {
            var lParametres = {
                pere: null,
                evenement: null,
                initCommandes: null,
                affichageSurInitCommandes: false,
                id: null,
                options: null
            };
            $.extend(lParametres, aParametres);
            if (!lParametres.pere) {
                return null;
            }
            if (!lParametres.initCommandes) {
                return null;
            }
            var lInstance = Identite.creerInstance(ObjetMenuContextuel, {
                pere: lParametres.pere,
                evenement: lParametres.evenement
            });
            lInstance.destructionSurFermeture = true;
            lInstance.setOptionsMenuContextuel(lParametres.options);
            ZoneFenetre.ajouterFenetre(lInstance.GetNom());
            $('#' + lInstance.GetNom().escapeJQ()).on('destroyed', function() {
                lInstance.free();
            });
            lParametres.initCommandes.call(lParametres.pere, lInstance);
            if (lInstance.ListeLignes.GetNbrElements() === 0) {
                return;
            }
            lInstance.surKeyUp = lParametres.surKeyUp;
            lInstance.surKeyPress = lParametres.surKeyPress;
            if (!lParametres.affichageSurInitCommandes) {
                lInstance.SetDonnees(lParametres.id);
            }
            return lInstance;
        };
        var c_delaiFermetureSousMenu = 300,
            c_delaiOuvertureSousMenu = 200;
        ObjetMenuContextuel.prototype.setOptionsMenuContextuel = function(aOptions) {
            $.extend(this.options, aOptions);
            return this;
        };
        ObjetMenuContextuel.prototype.add = function(aLibelle, aActif, aCallback, aExtend) {
            var lElement = this.AddCommande(0, aLibelle, aActif);
            lElement.setCallback(aCallback);
            if (aExtend) {
                $.extend(lElement, aExtend);
            }
            return this;
        };
        ObjetMenuContextuel.prototype.addTitre = function(aLibelle) {
            var lElement = new ObjetElement(aLibelle, null, EGenreLigneMenu.Titre);
            _addElement.call(this, lElement);
            return lElement;
        };
        ObjetMenuContextuel.prototype.addSousMenu = function(aLibelle, aInitialisationSousMenu, aParametres) {
            var lElement = new ObjetElement(aLibelle, null, EGenreLigneMenu.Deploiement);
            lElement._initSousMenu = aInitialisationSousMenu;
            lElement.parametresSousMenu = $.extend({
                callback: null,
                options: null
            }, aParametres);
            _addElement.call(this, lElement);
            return lElement;
        };
        ObjetMenuContextuel.prototype.AddCommande = function(ANumeroCommande, ALibelle, AActif, aData, aCallbackAfficher) {
            var LElement = new ObjetElement(ALibelle, ANumeroCommande, EGenreLigneMenu.Commande);
            LElement.actif = ((AActif !== null && AActif !== undefined) ? AActif : true);
            LElement.data = aData;
            LElement.callbackAfficher = aCallbackAfficher;
            LElement.callbackValidation = null;
            LElement.setCallback = function(aCallback) {
                this.callbackValidation = aCallback;
                return this;
            };
            _addElement.call(this, LElement);
            return LElement;
        };
        ObjetMenuContextuel.prototype.addSelecFile = function(aLibelle, aExtend, aActif) {
            if (!aExtend || !aExtend.getOptionsSelecFile || !aExtend.addFiles) {}
            return this.add(aLibelle, aActif !== false ? true : false, null, $.extend({
                estSelecFile: true
            }, aExtend));
        };
        ObjetMenuContextuel.prototype.AddSeparateur = function() {
            delete this._prochaineCommandeAvecSeparateur;
            if (this.ListeLignes.GetNbrElements() > 0) {
                this.ListeLignes.AddElement(new ObjetElement('', -1, EGenreLigneMenu.Separateur));
            }
        };
        ObjetMenuContextuel.prototype.getControleur = function(aInstance) {
            return {
                menuEventOut: function() {
                    var lNodesExclus = [];
                    var lCpt = 0;
                    var lSousMenu = aInstance._instanceSousMenu;
                    while (lSousMenu && lCpt < 20) {
                        lNodesExclus.push(GHtml.getElement(lSousMenu.Nom));
                        lSousMenu = lSousMenu._instanceSousMenu;
                        lCpt += 1;
                    }
                    lCpt = 0;
                    var lPereMenu = aInstance._pereMenu;
                    while (lPereMenu && lCpt < 20) {
                        lNodesExclus.push(GHtml.getElement(lPereMenu.Nom));
                        lPereMenu = lPereMenu._pereMenu;
                        lCpt += 1;
                    }
                    return {
                        nodesExclus: lNodesExclus,
                        callback: function() {
                            aInstance.Fermer();
                        }
                    };
                },
                nodeMenuContextuel: function() {
                    var lInstance = this.instance;
                    $(this.node).on({
                        'mouseout': function() {
                            if (lInstance.ligne) {
                                lInstance.selectionnerLigne(false, lInstance.ligne);
                            }
                        },
                        'keypress': function(aEvent) {
                            if (aInstance.surKeyPress && aInstance.surKeyPress(aEvent) === true) {
                                lInstance.Fermer(true);
                            }
                        },
                        'keyup': function(aEvent) {
                            var lEstToucheFleche = !!GNavigateur.IsToucheFleche && GNavigateur.IsToucheFleche();
                            var lEstToucheEchap = aEvent.which === ToucheClavier.Echap;
                            if (lEstToucheFleche || lEstToucheEchap) {
                                if (lEstToucheEchap) {
                                    lInstance.Fermer(true);
                                    lInstance.callback.appel();
                                }
                                if (lEstToucheFleche) {
                                    lInstance.NavigationClavier(this.id);
                                }
                                GNavigateur.StopperEvenement(aEvent.originalEvent);
                            } else if (aInstance.surKeyUp) {
                                if (aInstance.surKeyUp(aEvent) === true) {
                                    lInstance.Fermer(true);
                                }
                            }
                        }
                    });
                },
                getNodeWAI: function() {
                    $(this.node).on('focus', function() {
                        aInstance.FocusSurPremierElement();
                    });
                },
                getNodeLigne: function(aPositionLigne, aActif) {
                    var lElement = this.instance.ListeLignes.GetElement(aPositionLigne),
                        lInstance = this.instance;
                    var lMap = {
                        'mousedown': function(aEvent) {
                            if (lElement.GetGenre() === EGenreLigneMenu.Deploiement) {
                                aEvent.stopPropagation();
                                return false;
                            }
                        },
                        'touchstart': function(aEvent) {
                            lInstance.SurSelection(this.id, aActif, aPositionLigne);
                            if (_avecSousMenu.call(lInstance, lElement)) {
                                _ouvertureSousMenu.call(lInstance, lElement, false);
                                aEvent.stopPropagation();
                                return false;
                            }
                        },
                        'pointerdown': function(aEvent) {
                            if (_avecSousMenu.call(lInstance, lElement)) {
                                lInstance.SurSelection(this.id, aActif, aPositionLigne);
                                _ouvertureSousMenu.call(lInstance, lElement, false);
                                aEvent.stopPropagation();
                                return false;
                            }
                        },
                        'mouseenter': function() {
                            _ouvertureSousMenu.call(lInstance, lElement, true);
                        },
                        'mouseover': function() {
                            if (lInstance.estSousMenu) {
                                if (lInstance._timeoutFermetureSousMenu) {
                                    clearTimeout(lInstance._timeoutFermetureSousMenu);
                                }
                                lInstance._timeoutFermetureSousMenu = null;
                            }
                        },
                        'mouseleave': function() {
                            _stopperTimeoutsSousMenus(lInstance);
                            if (lInstance._instanceSousMenu) {
                                lInstance._instanceSousMenu._timeoutFermetureSousMenu = setTimeout(function() {
                                    lInstance._instanceSousMenu.Fermer();
                                    delete lInstance._instanceSousMenu;
                                }, c_delaiFermetureSousMenu);
                            }
                            if (lInstance.estSousMenu) {
                                lInstance._timeoutFermetureSousMenu = setTimeout(function() {
                                    var lRacineSousMenu = lInstance,
                                        i = 0;
                                    while (lRacineSousMenu._pereMenu && lRacineSousMenu._pereMenu.estSousMenu && i < 100) {
                                        lRacineSousMenu = lRacineSousMenu._pereMenu;
                                        i++;
                                    }
                                    lRacineSousMenu.Fermer();
                                }, c_delaiFermetureSousMenu);
                            }
                        }
                    };
                    if (aActif) {
                        $.extend(lMap, {
                            click: function() {
                                if (lElement.GetGenre() !== EGenreLigneMenu.Deploiement) {
                                    if (lElement.surValidationElement) {
                                        lElement.surValidationElement();
                                    } else {
                                        lInstance.SurValidation(aPositionLigne);
                                    }
                                }
                            },
                            keyup: function(aEvent) {
                                if (ToucheClavier.estEventRetourChariot(aEvent) || ToucheClavier.estEventEspace(aEvent)) {
                                    if (_avecSousMenu.call(lInstance, lElement) && !lInstance._instanceSousMenu) {
                                        _ouvertureSousMenu.call(lInstance, lElement, false);
                                    } else if (lElement.surValidationElement) {
                                        lElement.surValidationElement();
                                    } else {
                                        lInstance.SurValidation(aPositionLigne);
                                    }
                                }
                            }
                        });
                    }
                    $(this.node).on(lMap);
                },
                modelSelecFile: {
                    getOptionsSelecFile: function(aPositionLigne) {
                        var lElement = aInstance.ListeLignes.GetElement(aPositionLigne);
                        if (lElement) {
                            lElement.surValidationElement = this.getOpenSelecFile();
                            return Object.assign({
                                surOuvertureSelecteur: function() {
                                    _stopperTimeoutsSousMenus(aInstance);
                                    setTimeout(function() {
                                        _stopperTimeoutsSousMenus(aInstance);
                                    }, c_delaiFermetureSousMenu);
                                }
                            }, lElement.getOptionsSelecFile());
                        }
                    },
                    addFiles: function(aPositionLigne, aActif, aParams) {
                        var lElement = aInstance.ListeLignes.GetElement(aPositionLigne);
                        var lResult = lElement && aActif ? lElement.addFiles(aParams, lElement, aPositionLigne) : false;
                        aInstance.SurValidation(aPositionLigne);
                        return lResult;
                    },
                    getDisabled: function(aPositionLigne, aActif) {
                        return !aActif;
                    }
                }
            };
        };
        ObjetMenuContextuel.prototype.free = function() {
            if (!this.isDestroyed()) {
                this.inherited('free');
                this.Fermer();
            }
        };

        function _ouvertureSousMenu(aElement, aAvecDelai) {
            if (aElement && this._instanceSousMenu) {
                clearTimeout(this._instanceSousMenu._timeoutFermetureSousMenu);
                this._instanceSousMenu.Fermer();
                delete this._instanceSousMenu;
            }
            _stopperTimeoutsSousMenus(this);
            var lThis = this;
            if (_avecSousMenu.call(this, aElement)) {
                this._timeoutOuvertureSousMenu = setTimeout(function() {
                    _afficherSousMenu.call(lThis, aElement);
                }, aAvecDelai ? c_delaiOuvertureSousMenu : 0);
            }
        }

        function _stopperTimeoutsSousMenus(aInstance) {
            if (aInstance._timeoutFermetureSousMenu) {
                clearTimeout(aInstance._timeoutFermetureSousMenu);
            }
            if (aInstance._timeoutOuvertureSousMenu) {
                clearTimeout(aInstance._timeoutOuvertureSousMenu);
            }
            aInstance._timeoutFermetureSousMenu = null;
            aInstance._timeoutOuvertureSousMenu = null;
            if (aInstance._pereMenu) {
                _stopperTimeoutsSousMenus(aInstance._pereMenu);
            }
        }

        function _avecSousMenu(aElement) {
            return aElement && aElement.GetGenre() === EGenreLigneMenu.Deploiement && aElement._initSousMenu;
        }

        function _afficherSousMenu(aElementSousMenu) {
            var lThis = this;
            this._instanceSousMenu = ObjetMenuContextuel.afficher({
                pere: this,
                evenement: function(aLigne, aElement) {
                    if (MethodesObjet.isFunction(aElementSousMenu.parametresSousMenu.callback)) {
                        aElementSousMenu.parametresSousMenu.callback.call(this.Pere || this, aLigne, aElement);
                    } else {
                        lThis.callback.appel(aLigne, aElement);
                    }
                },
                initCommandes: aElementSousMenu._initSousMenu,
                affichageSurInitCommandes: true,
                options: aElementSousMenu.parametresSousMenu.options || this.options,
                surKeyUp: this.surKeyUp,
                surKeyPress: this.surKeyPress
            });
            if (this._instanceSousMenu) {
                this._instanceSousMenu._pereMenu = this;
                this._instanceSousMenu.estSousMenu = true;
                this._instanceSousMenu.Afficher(aElementSousMenu.id, true);
            }
        }
        ObjetMenuContextuel.prototype.ConstruireAffichage = function() {
            _calculerPremiereDerniereLigne.call(this);
            this._callbacksAfficherLignes = [];
            var lInfosMenu = {
                nbColonnesTexte: 1,
                nbColonnes: 1,
                avecDeploiement: false
            };
            this.ListeLignes.parcourir(function(D) {
                if (D.GetGenre() !== EGenreLigneMenu.Separateur) {
                    var lLibelle = D.GetLibelle();
                    if (Array.isArray(lLibelle)) {
                        lInfosMenu.nbColonnesTexte = Math.max(lInfosMenu.nbColonnesTexte, lLibelle.length);
                    }
                }
                if (D.GetGenre() === EGenreLigneMenu.Deploiement) {
                    lInfosMenu.avecDeploiement = true;
                }
            }.bind(this));
            lInfosMenu.nbColonnes = lInfosMenu.nbColonnesTexte + (lInfosMenu.avecDeploiement ? 1 : 0);
            var H = [];
            H.push('<span class="wai_hidden" tabindex="0" ie-node="getNodeWAI"></span>');
            H.push('<div id="' + this.IdNomMenuContextuel + '" ', GObjetWAI.composeRole(EGenreRole.Listbox), ' ie-node="nodeMenuContextuel"', ' ie-eventout="menuEventOut"', ' class="ObjetMenuContexutel" tabIndex="-1"', ' style="', GStyle.composeBoxShadow(), GStyle.composeCouleurFond(this.options.couleurFond), '">');
            H.push(GObjetWAI.composeSpan(EGenreObjet.MenuContextuel) + GObjetWAI.composeSpan(EGenreObjet.NavigationMenuContextuel));
            H.push('<table style="', (this.options.largeurMin ? 'width: ' + this.options.largeurMin + 'px; ' : ''), '"', ' border="0" cellspacing="0" cellpadding="0">');
            this.ListeLignes.parcourir(function(aLigne, aIndex) {
                if (aLigne && aLigne.Afficher !== false) {
                    H.push(_composeLigne.call(this, aLigne, aIndex, lInfosMenu));
                }
            }.bind(this));
            H.push('</table>');
            H.push('</div>');
            H.push('<span class="wai_hidden" tabindex="0" ie-node="getNodeWAI"></span>');
            return H.join('');
        };

        function _composeLigne(aLigne, aPositionLigne, aInfosMenu) {
            switch (aLigne.GetGenre()) {
                case EGenreLigneMenu.Separateur:
                    return _ComposeSeparateur.call(this, aInfosMenu);
                case EGenreLigneMenu.Commande:
                case EGenreLigneMenu.Deploiement:
                    return _ComposeTexte.call(this, aLigne, aPositionLigne, aInfosMenu);
                case EGenreLigneMenu.Titre:
                    return _composeTitre.call(this, aLigne, aInfosMenu);
            }
        }

        function _getIdCelluleTexte(aPositionLigne) {
            return this.Nom + '_' + aPositionLigne;
        }
        ObjetMenuContextuel.prototype.getIdCelluleTexteParCommande = function(aGenreCommande) {
            var lIndice = this.ListeLignes.GetIndiceParNumeroEtGenre(aGenreCommande, EGenreLigneMenu.Commande);
            return lIndice >= 0 ? _getIdCelluleTexte.call(this, lIndice) : false;
        };

        function _composeTitre(aLigne, aInfosMenu) {
            var H = [];
            H.push('<tr>');
            H.push('<td  colspan="' + (3 + aInfosMenu.nbColonnes) + '">', '<div class="AlignementMilieu Gras" style="padding: 3px; ', (this.options.heightLigne ? 'min-height:' + this.options.heightLigne + 'px; line-height:' + this.options.heightLigne + 'px;' : ''), '">', aLigne.GetLibelle(), '</div>', '</td>');
            H.push('</tr>');
            return H.join('');
        }

        function _ComposeSeparateur(aInfosMenu) {
            var H = [];
            H.push('<tr>');
            H.push('<td class="PetitEspaceGauche" style="', GStyle.composeWidth(this.options.largeurColonneGauche), GStyle.composeCouleurBordure(this.options.couleurBordureDroiteImage, 1, EGenreBordure.droite), '"></td>');
            H.push('</td>');
            H.push('<td><div style="', GStyle.composeWidth(2), '"></div></td>');
            H.push('</td>');
            H.push('<td style="padding:2px 0;" ', (aInfosMenu.nbColonnes > 1 ? 'colspan="' + aInfosMenu.nbColonnes + '"' : ''), '>', '<div style="', GStyle.composeCouleurBordure(GCouleur.bordure, 1, EGenreBordure.haut), '"></div></td>');
            H.push('</td>');
            H.push('</tr>');
            return H.join('');
        }

        function _ComposeTexte(aLigne, aPositionLigne, aInfosMenu) {
            var H = [];
            var lId = _getIdCelluleTexte.call(this, aPositionLigne),
                lEstDeploiement = aLigne.GetGenre() === EGenreLigneMenu.Deploiement,
                lLibelles = Array.isArray(aLigne.GetLibelle()) ? aLigne.GetLibelle() : [aLigne.GetLibelle()],
                lNbColonnes = Math.max(lLibelles.length, aInfosMenu.nbColonnesTexte),
                lNumeroColonne, lInfoLibelle;
            var lActif = aLigne.actif;
            if (lActif === null || lActif === undefined) {
                lActif = true;
            }
            lActif = !!lActif;
            if (aLigne.callbackAfficher) {
                this._callbacksAfficherLignes.push(function() {
                    aLigne.callbackAfficher.call(this.Pere || this, lId, lActif, aLigne);
                }.bind(this));
            }
            var lOnKeyNav = this.Nom + '.NavigationClavier (id); if (GNavigateur.IsToucheFleche ()) GNavigateur.StopperEvenement (event);';
            var lOnFocus = lActif === true ? this.Nom + '.selectionnerLigneParPosition (\'' + lId + '\', true , ' + aPositionLigne + ')' : '';
            var lOnBlur = lActif === true ? this.Nom + '.selectionnerLigneParPosition (\'' + lId + '\', false , ' + aPositionLigne + ')' : '';
            H.push('<tr id="' + lId + '" ', GHtml.composeAttr('ie-node', 'getNodeLigne', [aPositionLigne, lActif]), ' style="', GStyle.composeCouleurTexte(lActif ? GCouleur.noir : GCouleur.inactif.texte), '"', ' class="', (lActif ? ' active-color' : ' inactive-color'), '" ', aLigne.title ? ' title="' + GChaine.toTitle(aLigne.title) + '"' : '', aLigne.estSelecFile && lActif ? GHtml.composeAttr('ie-model', 'modelSelecFile', [aPositionLigne, lActif]) + ' ie-selecfile ' : '', ' onmousemove="' + this.Nom + '.SurSelection (id, ' + lActif + ', ' + aPositionLigne + ')">');
            H.push('<td id="' + lId + '_image" style="margin-right:2px;', GStyle.composeWidth(this.options.largeurColonneGauche), GStyle.composeCouleurBordure(this.options.couleurBordureDroiteImage, 1, EGenreBordure.droite), '"', ' class="AvecMain ">', (this.options.imageFormate || aLigne.composeImage === false ? '<div class="AlignementMilieu" style="min-width: ' + this.options.largeurColonneGauche + 'px;">' + (aLigne.image ? aLigne.image : '') + '</div>' : '<div class="mc-icon-contain" style="' + GStyle.composeWidth(this.options.largeurColonneGauche) + '">' + (aLigne.icon ? '<i class="' + aLigne.icon + '"></i>' : GImage.compose(aLigne.image, aLigne.largeurImage ? aLigne.largeurImage : 16)) + '</div>'), '</td>');
            H.push('<td><div style="', GStyle.composeWidth(2), '"></div></td>');
            for (lNumeroColonne = 0; lNumeroColonne < lNbColonnes; lNumeroColonne++) {
                lInfoLibelle = [];
                if (lNumeroColonne < lLibelles.length) {
                    lInfoLibelle = ['<div style="', (this.options.largeurMaxLibelle ? 'max-width: ' + this.options.largeurMaxLibelle + 'px;' : '') + '"' + (this.options.largeurMaxLibelle && !IE.estMobile ? ' ie-ellipsis' : '') + '>' +
                        lLibelles[lNumeroColonne] + '</div>'
                    ];
                }
                H.push('<td style="padding:3px ' + (lNumeroColonne === lNbColonnes - 1 ? 3 : 0) + 'px 3px ' + (lNumeroColonne === 0 ? 1 : 3) + 'px;', (this.options.heightLigne ? GStyle.composeHeight(this.options.heightLigne) : ''), '"', ' class="AvecMain AlignementMilieuVertical', (IE.estMobile ? '' : ' Insecable'), '">');
                if (lNumeroColonne === 0) {
                    lInfoLibelle.push(lActif === true ? '' : (GObjetWAI.composeSpan(' : ') + GObjetWAI.composeSpan(EGenreObjet.ItemDesactiver)));
                    H.push(this.ComposeElementNavigation(lId + '_', lInfoLibelle.join(''), EGenreRole.Listitem, lOnKeyNav, null, lOnFocus, lOnBlur));
                } else {
                    H.push(lInfoLibelle.join(''));
                }
                H.push('</td>');
            }
            if (aInfosMenu.avecDeploiement) {
                H.push('<td class="AvecMain" style="padding:3px 3px 3px 0;">');
                H.push(lEstDeploiement ? '<div id="' + lId + '_flechedroite" class="FlecheDroiteMenuContextuel" style="width:15px;"></div>' : '&nbsp;');
                H.push('</td>');
            }
            H.push('</tr>');
            if (this.IdPrecedent === '') {
                this.AjouterAuTableaux(this.IdPremierElement, lId + '_', null, EGenreDirection.SensNormal);
            } else {
                this.AjouterAuTableaux(this.IdPrecedent + '_', lId + '_', null, EGenreDirection.DeuxSenses);
            }
            this.IdPrecedent = lId;
            return H.join('');
        }
        ObjetMenuContextuel.prototype.RecupererDonnees = function() {
            GStyle.setDisplay(this.Nom, false);
        };
        ObjetMenuContextuel.prototype.SetParametres = function(aMinLargeur, aAfficherAbbreviation) {
            this.setOptionsMenuContextuel({
                largeurMin: aMinLargeur,
                largeurColonneGauche: aAfficherAbbreviation ? 30 : undefined,
                imageFormate: aAfficherAbbreviation ? true : undefined
            });
        };
        ObjetMenuContextuel.prototype.SetDonnees = function(aID, aListeElements, aGenre, aAfficher) {
            if (aAfficher !== false) {
                this.Afficher(aID);
            }
        };
        ObjetMenuContextuel.prototype.vider = function() {
            this.ListeLignes = new ObjetListeElements();
            delete this._prochaineCommandeAvecSeparateur;
            if (this.EstAffiche) {
                this.Fermer();
            }
        };

        function _addElement(aElement) {
            if (this._prochaineCommandeAvecSeparateur) {
                this.AddSeparateur();
            }
            this.ListeLignes.AddElement(aElement);
        }
        ObjetMenuContextuel.prototype.avecSeparateurSurSuivant = function(aAnnuler) {
            if (aAnnuler === true) {
                delete this._prochaineCommandeAvecSeparateur;
            } else {
                this._prochaineCommandeAvecSeparateur = true;
            }
            return this;
        };
        ObjetMenuContextuel.prototype.ActiverCommande = function(ANumeroCommande, AActiver) {
            var LElement = this.ListeLignes.GetElementParNumeroEtGenre(ANumeroCommande, EGenreLigneMenu.Commande);
            if (LElement) {
                LElement.actif = AActiver;
                GHtml.setHtml(this.Nom, this.ConstruireAffichage(), {
                    controleur: this.controleur
                });
            }
        };
        ObjetMenuContextuel.prototype.setLibelleCommande = function(ANumeroCommande, ALibelle) {
            var LElement = this.ListeLignes.GetElementParNumeroEtGenre(ANumeroCommande, EGenreLigneMenu.Commande);
            if (LElement) {
                LElement.Libelle = ALibelle;
                GHtml.setHtml(this.Nom, this.ConstruireAffichage(), {
                    controleur: this.controleur
                });
            }
        };
        ObjetMenuContextuel.prototype.AfficherCommande = function(aNumeroCommande, aAfficher) {
            _afficherLigne.call(this, aNumeroCommande, EGenreLigneMenu.Commande, aAfficher);
        };

        function _afficherLigne(aNumeroCommande, aGenreCommande, aAfficher) {
            var lElement = this.ListeLignes.GetElementParNumeroEtGenre(aNumeroCommande, aGenreCommande);
            lElement.Afficher = aAfficher;
            GHtml.setHtml(this.Nom, this.ConstruireAffichage(), {
                controleur: this.controleur
            });
        }
        ObjetMenuContextuel.prototype.Afficher = function(AId, aEstUnSousMenu) {
            if (!this.EstAffiche) {
                this.ligne = null;
                if (!this.ListeLignes || this.ListeLignes.GetNbrElements() === 0) {
                    GLog.addLog('ObjetMenuContextuel.prototype.Afficher : aucun élément à afficher');
                    return;
                }
                GHtml.setHtml(this.Nom, this.ConstruireAffichage(), {
                    controleur: this.controleur
                });
                GStyle.setDisplay(this.Nom, true);
                if (AId) {
                    if (MethodesObjet.isNumber(AId.x) && MethodesObjet.isNumber(AId.y)) {
                        GPosition.placer(this.Nom, AId.x, AId.y);
                    } else if (aEstUnSousMenu) {
                        GPosition.placerFiche(this.Nom, AId, null, {
                            x: 0,
                            y: -3
                        });
                    } else {
                        GPosition.placerFiche(this.Nom, AId);
                    }
                } else {
                    GPosition.placer(this.Nom, GNavigateur.SourisX + 5, GNavigateur.SourisY + 5);
                }
                this.EstAffiche = true;
                GestionnaireModale.abonnementPremierPlan(true, this.Nom);
                GestionnaireModale.enPremierPlan(this.Nom);
                GestionnaireModale.abonnementBlocageInterface(true, this.Nom);
                this._focusPrecedent = document.activeElement;
                this.FocusSurPremierElement();
                if (this._callbacksAfficherLignes) {
                    MethodesTableau.parcourir(this._callbacksAfficherLignes, function(aCallback) {
                        if (aCallback) {
                            aCallback();
                        }
                    });
                }
            }
        };
        ObjetMenuContextuel.prototype.Fermer = function(aToutFermer) {
            if (this.EstAffiche) {
                this.EstAffiche = false;
                _stopperTimeoutsSousMenus(this);
                if (this._instanceSousMenu) {
                    this._instanceSousMenu.Fermer();
                    delete this._instanceSousMenu;
                }
                try {
                    if (this._focusPrecedent && this._focusPrecedent.focus && $(this._focusPrecedent).length === 1) {
                        this._focusPrecedent.focus({
                            preventScroll: this.options.preventScrollSurRestaurationFocus
                        });
                        this._focusPrecedent = null;
                    }
                } catch (e) {}
                GStyle.setDisplay(this.Nom, false);
                this.effacer();
                this.ResetTableauxNavigation();
                this.IdPrecedent = '';
                GestionnaireModale.abonnementPremierPlan(false, this.Nom);
                GestionnaireModale.abonnementBlocageInterface(false, this.Nom);
                if (this.destructionSurFermeture) {
                    this.free();
                }
                if (aToutFermer && this._pereMenu) {
                    this._pereMenu.Fermer(true);
                }
            }
        };
        ObjetMenuContextuel.prototype.SurSelection = function(aId, aActif, aPositionLigne) {
            if (this.ligne) {
                this.selectionnerLigne(false, this.ligne);
            }
            this.ligne = this.ListeLignes.GetElement(aPositionLigne);
            this.ligne.id = aId;
            this.ligne.actif = aActif;
            this.selectionnerLigne(true, this.ligne);
        };
        ObjetMenuContextuel.prototype.selectionnerLigne = function(aSelectionner, aLigne) {
            if (!aLigne) {
                return;
            }
            GStyle.setCouleur(aLigne.id, aSelectionner ? GCouleur.selection.fond : this.options.couleurFond, aSelectionner ? (aLigne.actif ? GCouleur.selection.texte : GCouleur.inactif.texte) : (aLigne.actif ? GCouleur.noir : GCouleur.inactif.texte));
            GHtml.modifierClass(aLigne.id + '_flechedroite', aSelectionner ? 'FlecheDroiteMenuContextuel' : 'FlecheDroiteMenuContextuelSurvol', aSelectionner ? 'FlecheDroiteMenuContextuelSurvol' : 'FlecheDroiteMenuContextuel');
        };
        ObjetMenuContextuel.prototype.selectionnerLigneParPosition = function(aId, aSelectionner, aPosition) {
            var lLigne = this.ListeLignes.GetElement(aPosition);
            lLigne.id = aId;
            lLigne.actif = true;
            this.selectionnerLigne(aSelectionner, lLigne);
        };
        ObjetMenuContextuel.prototype.SurValidation = function(aPositionLigne) {
            this.ligne = this.ListeLignes.GetElement(aPositionLigne);
            this.ligne.id = _getIdCelluleTexte.call(this, aPositionLigne);
            if (this.ligne.GetGenre() !== EGenreLigneMenu.Deploiement) {
                this.Fermer(true);
                if (this.ligne && MethodesObjet.isFunction(this.ligne.callbackValidation)) {
                    this.ligne.callbackValidation.call(this.Pere || this, this.ligne);
                } else {
                    this.callback.appel(this.ligne);
                }
            }
        };

        function _calculerPremiereDerniereLigne() {
            var lLigne;
            delete this._premiereLigne;
            for (var I = 0; I < this.ListeLignes.GetNbrElements(); I++) {
                lLigne = this.ListeLignes.GetElement(I);
                if (lLigne && lLigne.Afficher !== false) {
                    this._derniereLigne = {
                        positionLigne: I,
                        positionElement: null
                    };
                    if (!this._premiereLigne) {
                        this._premiereLigne = {
                            positionLigne: I,
                            positionElement: null
                        };
                    }
                }
            }
        }
        module.exports = ObjetMenuContextuel;
    },
    fn: "objetmenucontextuel.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteListeDiffusion() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('ListeDiffusion', ObjetRequeteListeDiffusion, ObjetRequeteConsultation);
        ObjetRequeteListeDiffusion.prototype.lancerRequete = function() {
            return this.appelAsynchrone();
        };
        ObjetRequeteListeDiffusion.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequeteListeDiffusion;
    },
    fn: "objetrequetelistediffusion.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var GUID = require('GUID.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var GCache = require('Cache.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetRequeteListePublics = require('ObjetRequeteListePublics.js');
        var ObjetRequeteListeRessourcesPourCommunication = require('ObjetRequeteListeRessourcesPourCommunication.js');
        var ObjetRequeteSaisieMessage = require('ObjetRequeteSaisieMessage.js');
        var TypeHttpNotificationDonnes = require('TypeHttpNotificationDonnes.js').TypeHttpNotificationDonnes;
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');
        var TypeHttpReponseMessage = require('TypeHttpReponseMessage.js').TypeHttpReponseMessage;
        var Invocateur = require('Invocateur.js').Invocateur;
        var ObjetRequeteListeMessages = require('ObjetRequeteListeMessages.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var TypeThemeBouton = require('Type_ThemeBouton.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var ObjetMenuContextuel = require('ObjetMenuContextuel.js');
        var TypeGenreMessage = require('TypeGenreMessage.js').TypeGenreMessage;
        var ObjetRequeteListeDiffusion = require('ObjetRequeteListeDiffusion.js');
        var TypeCommandeMessagerie = require('TypeCommandeMessagerie.js').TypeCommandeMessagerie;
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreAction = require('Enumere_Action.js');
        var TypeOrigineCreationEtiquetteMessage = require('TypeOrigineCreationEtiquetteMessage.js').TypeOrigineCreationEtiquetteMessage;
        require('mobile/css/ObjetDiscussion_Mobile.css');

        function ObjetDiscussion_Mobile() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
            this.listePJ = new ObjetListeElements();
            this.idListeDestinataire = this.Nom + '_listeDest_';
            this.idMessageUnique = this.Nom + '_messageUnique_';
            this.idFiltreNom = this.Nom + '_FiltreNom';
            this.idConversation_Reponse = this.Nom + '_ConversReponse';
            this.idCheckboxDirecteur = this.Nom + '_cbDirecteur';
            this.genreRequete = {
                TousMembresCA: -1,
                ParentsDeLaClasse: -2,
                ParentsDelegues: -3,
                TousResponsablesDelegues: -4,
                TousResponsables: -5
            };
            var lDiscussionAvancee = GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee);
            this.setOptions({
                estSidePanel: false,
                estChat: false,
                genreDiscussion: TypeGenreMessage.GM_Message,
                callbackEnvoyer: null,
                callbackNavigation: null,
                callbackFermeture: null,
                callbackPopupListeDest: null,
                callbackBtnCreation: null,
                callbackSelectDiscussion: null,
                discussionAvancee: lDiscussionAvancee,
                avecPJ: TUtilitaireMessagerie.avecAjoutPieceJointeMessage(),
                avecHtml: TUtilitaireMessagerie.avecEditionHtmlMessage(),
                parametresSupplementaireSaisieDiscussion: null,
                genresDestinatairesAutorises: null,
                avecDestinatairesListeDiffusion: true,
                strSuperUtilisateurs: ''
            });
            this.avecInclureParentsEleves = false;
        }
        MethodesObjet.heritagePrototype(ObjetDiscussion_Mobile, ObjetIdentite_Mobile);
        ObjetDiscussion_Mobile.ids = {};
        ObjetDiscussion_Mobile.prototype.setDonnees = function(aDonnees) {
            this.donnees = Object.assign({
                message: null,
                listeBoutons: null,
                messagePourReponse: null,
                brouillon: null,
                creationDiscussion: false,
                alertePPMS: null,
                listeMessages: null,
                tableauDeBord: null,
                listeContacts: null,
                titre: null,
                nbPossessionsMessageListe: 0,
                estPrimParentSurEtiquetteCL: false
            }, aDonnees);
            _initGenresDest.call(this);
            if (!this.donnees.messagePourReponse) {
                this.donnees.messagePourReponse = new ObjetElement();
            }
            if (this.donnees.message) {
                this.donnees.message.lu = true;
            }
            if (this.donnees.creationDiscussion && (!this.donnees.listeBoutons || this.donnees.listeBoutons.GetNbrElements() === 0)) {
                this.donnees.listeBoutons = new ObjetListeElements().AddElement(new ObjetElement(GTraductions.getValeur('Messagerie.BtnEnvoyer')));
            }
            if (this.donnees.listeBoutons) {
                this.donnees.listeBoutons.setTri([ObjetTri.init('Genre', EGenreTriElement.Decroissant)]).trier();
            }
            _initNewMsg.call(this);
            this.listePJ = this.options.avecPJ && GEtatUtilisateur.listeDonnees ? GEtatUtilisateur.listeDonnees[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement] : null;
            this.afficher();
        };
        ObjetDiscussion_Mobile.prototype.afficher = function() {
            var lHtml = _composer.call(this);
            if (this.options.estSidePanel) {
                var lJFenetre = $('#' + this.GetNom().escapeJQ());
                if (!ObjetDiscussion_Mobile.ids[this.GetNom()] || lJFenetre.length === 0) {
                    Object.keys(ObjetDiscussion_Mobile.ids).forEach(function(aId) {
                        var lModale = M.Sidenav.getInstance($('#' + aId.escapeJQ()));
                        if (lModale && lModale.isOpen) {
                            lModale.close();
                        }
                    });
                    GHtml.addHtml(ZoneFenetre.getElementZoneFenetre(), '<div id="' + this.GetNom() + '" class="sidenav side-panel-complet"></div>');
                    lJFenetre = $('#' + this.GetNom().escapeJQ());
                    var lThis = this;
                    lJFenetre.on('destroyed', function() {
                        lThis.free();
                    });
                    M.Sidenav.init(lJFenetre, {
                        edge: 'right',
                        draggable: false,
                        onCloseEnd: function() {
                            _fermer.call(this);
                            this.free();
                        }.bind(this)
                    });
                }
                lJFenetre.IEHtml(lHtml, {
                    controleur: this.controleur
                });
                _getModale.call(this).open();
                ObjetDiscussion_Mobile.ids[this.GetNom()] = true;
            } else {
                $('#' + this.Nom.escapeJQ()).show();
                this.Afficher(lHtml);
            }
            $('#' + (this.Nom + '_conteneur').escapeJQ()).find('select').formSelect();
            if (this.options.estChat) {
                Invocateur.desabonner('traiter_notifications_chatVS', this);
                Invocateur.abonner('traiter_notifications_chatVS', _actualisationSurNotificationChat.bind(this), this);
            }
        };

        function _getModale() {
            return M.Sidenav.getInstance($('#' + this.GetNom().escapeJQ()));
        }
        ObjetDiscussion_Mobile.prototype.masquer = function() {
            if (this.options.estSidePanel) {
                var lModale = _getModale.call(this);
                if (lModale && lModale.isOpen) {
                    lModale.close();
                }
            } else {
                this.Afficher('');
                $('#' + this.Nom.escapeJQ()).hide();
                _fermer.call(this);
            }
        };

        function _fermer() {
            if (this.options.callbackFermeture) {
                this.options.callbackFermeture(this.donnees);
            }
            this.avecInclureParentsEleves = false;
        }
        ObjetDiscussion_Mobile.prototype.free = function() {
            if (this.isDestroyed()) {
                return;
            }
            this.inherited('free');
            delete ObjetDiscussion_Mobile.ids[this.GetNom()];
            if (this.options.estSidePanel) {
                var lModale = _getModale.call(this);
                if (lModale) {
                    lModale.destroy();
                }
                $('#' + this.Nom.escapeJQ()).remove();
            }
        };

        function _avecGenreDest(aInstance, aGenreRessource) {
            return TUtilitaireMessagerie.estGenreDestinataireAutorise(aGenreRessource) && (!aInstance.options.genresDestinatairesAutorises || !aInstance.options.genresDestinatairesAutorises.indexOf || aInstance.options.genresDestinatairesAutorises.indexOf(aGenreRessource) >= 0);
        }

        function _initGenresDest() {
            this.genresDest = new ObjetListeElements();
            if ((!this.options.estChat || (this.donnees.listeContacts && this.donnees.listeContacts.GetElementParGenre(EGenreRessource.Enseignant))) && _avecGenreDest(this, EGenreRessource.Enseignant)) {
                this.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('Professeurs'), null, EGenreRessource.Enseignant, null, true));
            }
            if ((!this.options.estChat || (this.donnees.listeContacts && this.donnees.listeContacts.GetElementParGenre(EGenreRessource.Personnel))) && _avecGenreDest(this, EGenreRessource.Personnel)) {
                this.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('Personnels'), null, EGenreRessource.Personnel, null, true));
            }
            if (this.options.discussionAvancee && !this.options.estChat) {
                if (_avecGenreDest(this, EGenreRessource.Eleve)) {
                    this.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('Eleves'), null, EGenreRessource.Eleve, null, GApplication.droits.get(TypeDroits.communication.avecDiscussionEleves)));
                }
                if (_avecGenreDest(this, EGenreRessource.Responsable)) {
                    this.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('Messagerie.Parents'), null, EGenreRessource.Responsable, null, GApplication.droits.get(TypeDroits.communication.avecDiscussionParents)));
                }
            }
            if (!this.options.estChat && this.options.estDiscussionResponsables && GParametres.ActivationMessagerieEntreParents && GEtatUtilisateur.Identification.ressource.avecDiscussionResponsables && _avecGenreDest(this, EGenreRessource.Responsable)) {
                var lEstDelegue = GEtatUtilisateur.Identification.ressource.estDelegue;
                var lInstance = this;
                if (lEstDelegue) {
                    GEtatUtilisateur.Identification.ressource.listeClassesDelegue.parcourir(function(D) {
                        lInstance.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.parentsDeLaClasse', [D.GetLibelle()]), D.GetNumero(), lInstance.genreRequete.ParentsDeLaClasse));
                    });
                    if (GEtatUtilisateur.Identification.ListeRessources.GetNbrElements() > 1) {
                        GEtatUtilisateur.Identification.ListeRessources.parcourir(function(D) {
                            lInstance.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.parentsDelegues', [D.Classe.GetLibelle()]), D.Classe.GetNumero(), lInstance.genreRequete.ParentsDelegues));
                        });
                    }
                    this.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.tousDelegues'), 0, this.genreRequete.TousResponsablesDelegues));
                } else {
                    GEtatUtilisateur.Identification.ListeRessources.parcourir(function(D) {
                        lInstance.genresDest.AddElement(new ObjetElement(GTraductions.getValeur('fenetreEnvoiEmail.parentsDelegues', [D.Classe.GetLibelle()]), D.Classe.GetNumero(), lInstance.genreRequete.ParentsDelegues));
                    });
                }
            }
        }

        function _initNewMsg() {
            this.newMsg = {
                avecHtml: this.options.avecHtml,
                objet: '',
                contenu: '',
                listePublic: [],
                genreDiscussion: this.options.genreDiscussion
            };
            if (this.donnees.tableauDeBord) {
                this.newMsg = MethodesObjet.dupliquer(this.donnees.message);
                this.newMsg.listeDestinataires = this.donnees.message.listeDestinataires ? this.donnees.message.listeDestinataires : new ObjetListeElements();
            } else if (this.donnees.brouillon) {
                this.newMsg = MethodesObjet.dupliquer(this.donnees.brouillon);
                this.newMsg.brouillon = this.donnees.brouillon;
                if (this.donnees.brouillon.contenu) {
                    this.newMsg.contenu = this.donnees.brouillon.contenu;
                }
                this.newMsg.commande = '';
                this.newMsg.listeDestinataires = this.donnees.destinataires && this.donnees.destinataires.listeDestinataires ? this.donnees.destinataires.listeDestinataires : new ObjetListeElements();
                if (this.donnees.brouillon.listeDestinataires) {
                    this.newMsg.listeDestinataires = this.donnees.brouillon.listeDestinataires;
                }
            } else {
                this.newMsg.listeDestinataires = this.donnees.destinataires && this.donnees.destinataires.listeDestinataires ? this.donnees.destinataires.listeDestinataires : new ObjetListeElements();
            }
            if (!this.newMsg.listeFichiers) {
                this.newMsg.listeFichiers = new ObjetListeElements();
            }
            if (!this.newMsg.listeDestinataires) {
                this.newMsg.listeDestinataires = new ObjetListeElements();
            }
            if (this.donnees.estPrimParentSurEtiquetteCL) {
                this.newMsg.estCreationCarnetLiaison = true;
                if (!this.donnees.listeDestinatairesCarnetLiaison) {
                    throw 'pas de liste destinataires';
                }
                if (!this.donnees.eleveCarnetLiaison) {
                    throw 'Il faut un eleve carnet de liaison';
                }
                this.newMsg.listeDestinataires = MethodesObjet.dupliquer(this.donnees.listeDestinatairesCarnetLiaison);
                this.newMsg.eleveCarnetLiaison = this.donnees.eleveCarnetLiaison;
            }
            this.newMsg.estChat = this.options.estChat;
            if (this.options.estChat && this.donnees.creationDiscussion && this.donnees.titre) {
                this.newMsg.objet = this.donnees.titre;
            }
            if (this.donnees.alertePPMS) {
                this.newMsg.genreDiscussion === TypeGenreMessage.GM_Alerte;
                if (this.donnees.alertePPMS.modeleAlerte && this.donnees.alertePPMS.modeleAlerte.contenu) {
                    this.newMsg.contenu = this.donnees.alertePPMS.modeleAlerte.contenu;
                }
                this.newMsg.modeleAlerte = this.donnees.alertePPMS.modeleAlerte;
                this.newMsg.estExercice = false;
            }
            this.newMsg.listeDestinataires.parcourir(function(aEle) {
                aEle.SetEtat(EGenreEtat.Modification);
            });
            this.newMsg.listePublic = this.newMsg.listeDestinataires ? this.newMsg.listeDestinataires.getTableauLibelles() : [];
        }
        ObjetDiscussion_Mobile.prototype.getControleur = function(aInstance) {
            return {
                btnFermer: {
                    event: function() {
                        aInstance.masquer();
                    }
                },
                nodeBtnActions: function(aAvecPublic, aAvecActions) {
                    $(this.node).on('click', function() {
                        _surBtnActions(aInstance, this, aAvecPublic, aAvecActions);
                    });
                },
                nodeBtnPrecSuiv: function(aPrec) {
                    $(this.node).on('click', function() {
                        aInstance.avecInclureParentsEleves = false;
                        aInstance.options.callbackNavigation(aPrec);
                    });
                },
                getNodeBtnCreation: function() {
                    $(this.node).on('click', function(aEvent) {
                        aInstance.options.callbackBtnCreation(aEvent);
                    });
                },
                getNodeModifDest: function(aGenre) {
                    $(this.node).on('click', function(aEvent) {
                        _popupDestinataires.call(aInstance, aEvent, aGenre);
                    });
                },
                getHtmlModifDest: function() {
                    var lHtml = [];
                    lHtml.push(GTraductions.getValeur('Messagerie.DestinatairesMsg') + ' ');
                    var lNbTRD = 0,
                        lNbCA = 0,
                        lNbTR = 0,
                        lNbDC = 0;
                    aInstance.newMsg.listeDestinataires.parcourir(function(aElt) {
                        switch (aElt.GetGenre()) {
                            case aInstance.genreRequete.TousResponsablesDelegues:
                                lNbTRD++;
                                break;
                            case aInstance.genreRequete.TousMembresCA:
                                lNbCA++;
                                break;
                            case aInstance.genreRequete.TousResponsables:
                                lNbTR++;
                                break;
                            case aInstance.genreRequete.ParentsDelegues:
                                lNbTRD++;
                                break;
                            case aInstance.genreRequete.ParentsDeLaClasse:
                                lNbDC++;
                                break;
                        }
                    });
                    if (lNbTRD > 0) {
                        lHtml.push('<div class="chip"', GHtml.composeAttr('ie-node', 'getNodeModifDest', [aInstance.genreRequete.TousResponsablesDelegues]), '">' + GTraductions.getValeur('fenetreEnvoiEmail.generique.parentsDelegues') + ' (' + lNbTRD + ')</div>');
                    }
                    if (lNbCA > 0) {
                        lHtml.push('<div class="chip"', GHtml.composeAttr('ie-node', 'getNodeModifDest', [aInstance.genreRequete.TousMembresCA]), '">' + GTraductions.getValeur('fenetreEnvoiEmail.generique.membresCA') + ' (' + lNbCA + ')</div>');
                    }
                    if (lNbTR > 0) {
                        lHtml.push('<div class="chip"', GHtml.composeAttr('ie-node', 'getNodeModifDest', [aInstance.genreRequete.TousResponsables]), '">' + GTraductions.getValeur('fenetreEnvoiEmail.generique.tousResponsables') + ' (' + lNbTR + ')</div>');
                    }
                    if (lNbDC > 0) {
                        lHtml.push('<div class="chip"', GHtml.composeAttr('ie-node', 'getNodeModifDest', [aInstance.genreRequete.ParentsDeLaClasse]), '">' + GTraductions.getValeur('fenetreEnvoiEmail.generique.parentsDeLaClasse') + ' (' + lNbDC + ')</div>');
                    }
                    if (aInstance.genresDest) {
                        aInstance.genresDest.parcourir(function(aEle) {
                            var lNb = aInstance.newMsg.listeDestinataires.getListeElements(function(aE) {
                                return (aE.GetGenre() === aEle.GetGenre()) && (aE.GetGenre() > 0);
                            }).GetNbrElements();
                            if (lNb > 0) {
                                lHtml.push('<div class="chip"', GHtml.composeAttr('ie-node', 'getNodeModifDest', [aEle.GetGenre()]), '">' + aEle.GetLibelle() + ' (' + lNb + ')</div>');
                            }
                        });
                    }
                    return lHtml.join('');
                },
                getNodeTousRess: function(aGenre) {
                    $(this.node).on('change', function() {
                        var lChecked = $(this).is(':checked');
                        $('#' + (aInstance.idListeDestinataire).escapeJQ()).find('li[ie-data-genreDest="' + aGenre + '"]:not(.hidden)').find('input').prop('checked', lChecked).trigger('change');
                    });
                },
                getNodeSelectDiscussion: function() {
                    $(this.node).on('change', function(aEvent) {
                        var lNouvelIndiceDiscussion = parseInt($(aEvent.target).val());
                        if (lNouvelIndiceDiscussion !== aInstance.donnees.tableauDeBord.indiceDiscussionSelectionnee) {
                            aInstance.avecInclureParentsEleves = false;
                            aInstance.options.callbackSelectDiscussion(lNouvelIndiceDiscussion);
                        }
                    });
                },
                getNodeSelectModeleAlerte: function() {
                    $(this.node).on('change', function(aEvent) {
                        var lIndice = parseInt($(aEvent.target).val());
                        var lModele = aInstance.donnees.alertePPMS.listeModelesAlerte.GetElement(lIndice);
                        if (lModele && lModele.GetNumero() !== aInstance.donnees.alertePPMS.modeleAlerte.GetNumero()) {
                            aInstance.newMsg.modeleAlerte = MethodesObjet.dupliquer(lModele);
                            GHtml.setHtml(aInstance.idConversation_Reponse, aInstance.newMsg.modeleAlerte.contenu);
                        }
                    });
                },
                cbExerciceAlerte: {
                    getValue: function() {
                        return aInstance.newMsg.estExercice;
                    },
                    setValue: function(aValue) {
                        aInstance.newMsg.estExercice = aValue;
                    }
                },
                getNodeInputSearchDest: function() {
                    $(this.node).on('keyup', function() {
                        _filtrerDest.call(aInstance, $(this).val());
                    });
                },
                getNodeGenreDest: function(aGenre, aNumero) {
                    $(this.node).on('click', function() {
                        _surGenreDest.call(aInstance, aGenre, aNumero);
                    });
                },
                tromboneSelecFile: {
                    getOptionsSelecFile: function() {
                        return {
                            maxSize: GApplication.droits.get(TypeDroits.tailleMaxDocJointEtablissement)
                        };
                    },
                    addFiles: function(aParams) {
                        if (MethodesTableau.existe(aParams.eltFichier.GetLibelle(), aInstance.listePJ.getTableauLibelles())) {
                            GApplication.getMessage().afficher({
                                message: GTraductions.getValeur('inputFile.msgEchecLibelleFichier')
                            });
                        } else {
                            aInstance.newMsg.listeFichiers.AddElement(aParams.eltFichier);
                            aInstance.listePJ.AddElement(aParams.eltFichier);
                        }
                    }
                },
                getHtmlPJ: function() {
                    if (!aInstance.options.avecPJ) {
                        return '';
                    }
                    return aInstance.newMsg.listeFichiers ? aInstance.newMsg.listeFichiers.getTableauLibelles().join(', ') : '';
                },
                inputObjet: {
                    getValue: function() {
                        return aInstance.newMsg.objet || '';
                    },
                    setValue: function(aValue) {
                        aInstance.newMsg.objet = aValue;
                    }
                },
                getNodeContentEditable: function() {
                    $(this.node).on({
                        focus: function() {
                            $(this).siblings('label').addClass('active');
                        },
                        blur: function() {
                            if (!this.innerHTML) {
                                $(this).siblings('label').removeClass('active');
                            }
                        },
                        'input change paste': function() {
                            var lJNodes = $(this).find('img');
                            if (lJNodes.length > 0) {
                                lJNodes.remove();
                                GApplication.getMessage().afficher({
                                    message: GTraductions.getValeur('CahierDeTexte.MessageSuppressionImage')
                                });
                            }
                        }
                    });
                    var lThis = this;
                    $(this).siblings('label').on('focus', function() {
                        lThis.focus();
                    });
                },
                buttonRepondre: {
                    event: function(aGenre) {
                        _surBoutonRepondre.call(aInstance, aGenre);
                    }
                },
                cbInclureParentEleve: {
                    getValue: function(aHorsLimiteParentsEleves) {
                        return aInstance.avecInclureParentsEleves && !aHorsLimiteParentsEleves;
                    },
                    setValue: function(aHorsLimiteParentsEleves, aValue) {
                        aInstance.avecInclureParentsEleves = aValue;
                    },
                    getDisabled: function(aHorsLimiteParentsEleves) {
                        return aHorsLimiteParentsEleves;
                    },
                    getNode: function(aHorsLimiteParentsEleves) {
                        if (aHorsLimiteParentsEleves) {
                            $(this.node).on('mousedown', function() {
                                GApplication.getMessage().afficher({
                                    message: GTraductions.getValeur('Messagerie.HintInclureParentsElevesDisabled')
                                });
                            });
                        }
                    }
                },
                getHtmlBtnRepondre: function() {
                    return _getHtmlBtnRepondre.call(aInstance);
                },
                getNodeAfficherSuivants: function(aNbMessagesVus) {
                    $(this.node).on('click', function() {
                        _requeteListeMessages.call(aInstance, {
                            message: aInstance.donnees.message,
                            marquerCommeLu: false,
                            nbMessagesVus: aNbMessagesVus
                        });
                    });
                },
                visuMessage: {
                    hint: function(aNumeroMessage, aParticipants) {
                        aInstance.options.callbackPopupListeDest(aNumeroMessage, aParticipants, false);
                    }
                },
                cbProfsCarnetL: {
                    getValue: function(aNumeroArticle) {
                        return aInstance.listeSelectionProfsCarnetLiaison.GetElementParNumero(aNumeroArticle);
                    },
                    setValue: function(aNumeroArticle, aValue) {
                        if (!aValue) {
                            if (aInstance.listeSelectionProfsCarnetLiaison.GetNbrElements() === 1) {
                                return;
                            }
                            var lIndice = aInstance.listeSelectionProfsCarnetLiaison.GetIndiceParNumeroEtGenre(aNumeroArticle);
                            if (lIndice >= 0) {
                                aInstance.listeSelectionProfsCarnetLiaison.remove(lIndice);
                            }
                        } else {
                            if (!aInstance.listeSelectionProfsCarnetLiaison.GetElementParNumero(aNumeroArticle)) {
                                aInstance.listeSelectionProfsCarnetLiaison.add(new ObjetElement('', aNumeroArticle));
                            }
                        }
                    }
                }
            };
        };

        function _addCommandeMenuContextuel(aInstance, aMessage, aMenu, aGenre) {
            function _add(aTrad, aFunc, aActif) {
                aMenu.add(aTrad, aActif === false ? false : true, aFunc);
            }

            function _saisie(aAction) {
                return new ObjetRequeteSaisieMessage(aInstance).lancerRequete(aAction).then(function() {
                    aInstance.masquer();
                });
            }
            if (TUtilitaireMessagerie.avecCommandeMessagerieDeGenre(aGenre, aMessage)) {
                switch (aGenre) {
                    case TypeCommandeMessagerie.archiver:
                    case TypeCommandeMessagerie.desarchiver:
                        _add(aGenre === TypeCommandeMessagerie.archiver ? GTraductions.getValeur('Messagerie.Archiver') : GTraductions.getValeur('Messagerie.Desarchiver'), function() {
                            _saisie({
                                commande: 'archive',
                                archiver: aGenre === TypeCommandeMessagerie.archiver,
                                message: aMessage
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.signaler:
                        _add(GTraductions.getValeur('Messagerie.Menu_SignalerLeMessage', [aInstance.options.strSuperUtilisateurs]), function() {
                            _saisie({
                                commande: 'signalement',
                                message: aMessage
                            });
                        }, !aMessage.estUneDiscussion);
                        break;
                    case TypeCommandeMessagerie.signalerSuppression:
                        _add(GTraductions.getValeur('Messagerie.Menu_SignalerPourSuppr', [aInstance.options.strSuperUtilisateurs]), function() {
                            _saisie({
                                commande: 'signalementSuppression',
                                message: aMessage
                            });
                        }, !!aMessage.estUneDiscussion);
                        break;
                    case TypeCommandeMessagerie.modifierCategories:
                        var lLibelle = aMessage.listeEtiquettes &&
                            aMessage.listeEtiquettes.getListeElements(function(D) {
                                return TypeOrigineCreationEtiquetteMessage.estEtiquettePerso(D.GetGenre());
                            }).GetNbrElements() > 0 ? GTraductions.getValeur('Messagerie.Menu.ModifierCategories') : GTraductions.getValeur('Messagerie.Menu.AjouterCategories');
                        _add(lLibelle, function() {
                            TUtilitaireMessagerie.ouvrirFenetreListeCategoriesDiscussion(new ObjetListeElements().add(aMessage), aInstance.options.listeEtiquettes, function() {
                                aInstance.masquer();
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.corbeille:
                        _add(GTraductions.getValeur('Messagerie.Menu.Supprimer'), function() {
                            return _saisie({
                                commande: 'corbeille',
                                listePossessionsMessages: aMessage.listePossessionsMessages
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.purger:
                        _add(GTraductions.getValeur('Messagerie.Menu_Purger'), function() {
                            var lListeMessagesPurge = new ObjetListeElements();
                            if (aMessage.messagePurge) {
                                lListeMessagesPurge.add(aMessage.messagePurge);
                            }
                            return TUtilitaireMessagerie.getCommandePurgerListeMessages_promise(lListeMessagesPurge, true).then(function(aCommandePurger) {
                                if (aCommandePurger) {
                                    return _saisie(aCommandePurger);
                                }
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.supprimer:
                        _add(aMessage.estUneDiscussion ? GTraductions.getValeur('Messagerie.Menu_SupprimerDefinitivement') : GTraductions.getValeur('Messagerie.HintSupprimerBrouillon'), function() {
                            return GApplication.getMessage().afficher({
                                type: EGenreBoiteMessage.Confirmation,
                                message: GTraductions.getValeur('Messagerie.ConfirmationSuppression')
                            }).then(function(aAccepte) {
                                if (aAccepte === EGenreAction.Valider) {
                                    return _saisie({
                                        commande: 'suppression',
                                        message: aMessage
                                    });
                                }
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.restaurer:
                        _add(GTraductions.getValeur('Messagerie.Menu_Restaurer'), function() {
                            return _saisie({
                                commande: 'restauration',
                                message: aMessage
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.lu:
                    case TypeCommandeMessagerie.nonLu:
                        _add(aGenre === TypeCommandeMessagerie.lu ? GTraductions.getValeur('Messagerie.Menu.Lu') : GTraductions.getValeur('Messagerie.Menu.NonLu'), function() {
                            return _saisie({
                                commande: 'pourLu',
                                lu: aGenre === TypeCommandeMessagerie.lu,
                                message: aMessage
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.fermerDiscussion:
                    case TypeCommandeMessagerie.ouvrirDiscussion:
                        var lOuvrir = aGenre === TypeCommandeMessagerie.ouvrirDiscussion;
                        _add(lOuvrir ? GTraductions.getValeur('Messagerie.Menu_OuvrirDiscussion') : GTraductions.getValeur('Messagerie.Menu_FermerDiscussion'), function() {
                            return GApplication.getMessage().afficher({
                                type: EGenreBoiteMessage.Confirmation,
                                message: lOuvrir ? GTraductions.getValeur('Messagerie.ConfirmationOuvertureDiscussion') : GTraductions.getValeur('Messagerie.ConfirmationFermetureDiscussion')
                            }).then(function(aGenreAction) {
                                if (aGenreAction === EGenreAction.Valider) {
                                    return _saisie({
                                        commande: 'pourOuvrirFermer',
                                        ouvrir: lOuvrir,
                                        message: aMessage
                                    });
                                }
                            });
                        });
                        break;
                    case TypeCommandeMessagerie.entrerSortirDiscussion:
                        _add(aMessage.estSorti ? GTraductions.getValeur('Messagerie.Menu_Entrer') : GTraductions.getValeur('Messagerie.Menu_Sortir'), function() {
                            return _saisie({
                                commande: 'entrerSortirDiscussion',
                                estSorti: aMessage.estSorti,
                                possessionMessage: aMessage.dernierPossessionMessage
                            });
                        });
                        break;
                    default:
                        ;
                }
            }
        }

        function _surBtnActions(aInstance, aNode, aAvecPublic, aAvecActions) {
            var lMessage = aInstance.donnees.message;
            ObjetMenuContextuel.afficher({
                pere: aInstance,
                id: aNode,
                initCommandes: function(aMenu) {
                    if (aAvecPublic) {
                        aMenu.add(GTraductions.getValeur('Messagerie.ListeDestinataires'), true, function() {
                            aInstance.options.callbackPopupListeDest(aInstance.donnees.messagePourReponse.GetNumero(), false, true);
                        }, {
                            composeImage: false,
                            image: '<i class="icon_group" style="font-size: 1.4rem;"></i>'
                        });
                        aMenu.avecSeparateurSurSuivant();
                    }
                    if (aAvecActions) {
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.lu);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.nonLu);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.archiver);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.desarchiver);
                        if (aInstance.options.listeEtiquettes && aInstance.options.listeMessagerie) {
                            _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.modifierCategories);
                        }
                        aMenu.avecSeparateurSurSuivant();
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.fermerDiscussion);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.ouvrirDiscussion);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.restaurer);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.corbeille);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.purger);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.supprimer);
                        _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.entrerSortirDiscussion);
                        if (aInstance.options.strSuperUtilisateurs) {
                            aMenu.avecSeparateurSurSuivant();
                            _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.signaler);
                            _addCommandeMenuContextuel(aInstance, lMessage, aMenu, TypeCommandeMessagerie.signalerSuppression);
                        }
                    }
                }
            });
        }

        function _actualisationSurNotificationChat(aListeDiscussions) {
            if (!aListeDiscussions) {
                return;
            }
            var lMessageActualisation = null;
            aListeDiscussions.parcourir(function(aMessage) {
                if (aMessage.listePossessionsMessages) {
                    if (!this.donnees.message && this._creationChatAvecSaisieMessage && aMessage.perso && aMessage.listePossessionsMessages.GetNbrElements() === 1) {
                        lMessageActualisation = aMessage;
                    } else if (this.donnees.message && this.donnees.message.listePossessionsMessages) {
                        aMessage.listePossessionsMessages.parcourir(function(aPossessionMessage) {
                            if (this.donnees.message.listePossessionsMessages.GetElementParElement(aPossessionMessage)) {
                                lMessageActualisation = aMessage;
                                return false;
                            }
                        }.bind(this));
                    }
                    if (lMessageActualisation) {
                        lMessageActualisation.messageDejaTraite = true;
                        return false;
                    }
                }
            }.bind(this));
            if (lMessageActualisation) {
                lMessageActualisation = MethodesObjet.dupliquer(lMessageActualisation);
                var lListeMessages = new ObjetListeElements();
                lListeMessages.AddElement(lMessageActualisation);
                _requeteListeMessages.call(this, {
                    titre: this.donnees.titre,
                    message: lMessageActualisation,
                    marquerCommeLu: true
                });
            }
        }

        function _requeteListeMessages(aParams) {
            var lNbMessagesVus = aParams.nbMessagesVus < 0 ? undefined : (aParams.nbMessagesVus || TUtilitaireMessagerie.palierNbMessages);
            if (this.donnees.message && aParams.marquerCommeLu) {
                this.donnees.message.lu = true;
            }
            new ObjetRequeteListeMessages(this).lancerRequete({
                message: aParams.message,
                marquerCommeLu: aParams.marquerCommeLu,
                nbMessagesVus: lNbMessagesVus
            }).then(function(aParam) {
                this.setDonnees({
                    titre: aParams.titre,
                    message: aParams.message,
                    messagePourReponse: aParam.messagePourReponse,
                    listeBoutons: aParam.listeBoutons,
                    listeMessages: aParam.listeMessages,
                    destinataires: aParam.destinataires,
                    nbPossessionsMessageListe: aParam.nbPossessionsMessage
                });
            }.bind(this));
        }

        function _surBoutonRepondre(aGenre) {
            var lGenre = TUtilitaireMessagerie.getGenreReponse(aGenre, this.avecInclureParentsEleves);
            var lContenuEscape = $("#" + this.idConversation_Reponse.escapeJQ()).text().trim();
            var lListeFichiers = this.newMsg.listeFichiers || new ObjetListeElements();
            var lControleContenuNonVide = lGenre !== TypeHttpReponseMessage.rm_ClotureAlerte;
            var lEstBrouillonCreationDiscussion = _estBrouillonCreationDiscussion.call(this);
            if (this.donnees.estPrimParentSurEtiquetteCL && this.listeSelectionProfsCarnetLiaison && this.listeSelectionProfsCarnetLiaison.GetNbrElements() > 0) {
                this.newMsg.listeDestinataires.removeFilter(function(D) {
                    if (D.GetGenre() === EGenreRessource.Enseignant && !this.listeSelectionProfsCarnetLiaison.GetElementParNumero(D.GetNumero())) {
                        return true;
                    }
                    return false;
                }.bind(this));
            }
            if (((this.donnees.creationDiscussion && !this.options.discussionAvancee) || (this.options.estChat && this.donnees.creationDiscussion) || lEstBrouillonCreationDiscussion) && (!this.newMsg.listeDestinataires || this.newMsg.listeDestinataires.GetNbrElements() === 0)) {
                return GApplication.getMessage().afficher({
                    message: GTraductions.getValeur('Messagerie.MsgAucuneSelection')
                });
            }
            if (lControleContenuNonVide && !lContenuEscape) {
                return GApplication.getMessage().afficher({
                    message: GTraductions.getValeur('Messagerie.MsgAucunContenu')
                });
            }
            if (this.options.estChat && !this.donnees.message) {
                this._creationChatAvecSaisieMessage = true;
            }
            if (!this.donnees.creationDiscussion) {
                this.newMsg.bouton = new ObjetElement('', 0, lGenre);
            }
            this.newMsg.avecHtml = this.options.avecHtml;
            this.newMsg.contenu = this.newMsg.avecHtml ? $("#" + this.idConversation_Reponse.escapeJQ()).html() : GChaine.nodeToText($("#" + this.idConversation_Reponse.escapeJQ()).get(0));
            this.newMsg.messagePourReponse = this.donnees.messagePourReponse;
            if (_avecCBDirecteur.call(this)) {
                if ($('#' + this.idCheckboxDirecteur.escapeJQ()).is(':checked')) {
                    var lElement = new ObjetElement('', 0, EGenreRessource.Personnel);
                    lElement.SetEtat(EGenreEtat.Modification);
                    this.newMsg.listeDestinataires.AddElement(lElement);
                }
            }
            if (this.donnees.creationDiscussion && this.options.parametresSupplementaireSaisieDiscussion) {
                Object.assign(this.newMsg, this.options.parametresSupplementaireSaisieDiscussion);
            }
            var lInstance = this;
            this.newMsg.listeDestinataires.parcourir(function(D) {
                if (_estDiscussionSpecifiqueResponsables(lInstance, D.GetGenre())) {
                    D.Genre = EGenreRessource.Responsable;
                }
            });
            new ObjetRequeteSaisieMessage(this).addUpload({
                listeFichiers: lListeFichiers
            }).lancerRequete(this.newMsg).then(function() {
                if (this.options.callbackEnvoyer) {
                    this.options.callbackEnvoyer({
                        creationDiscussion: this.donnees.creationDiscussion || lEstBrouillonCreationDiscussion,
                        message: this.newMsg
                    });
                }
            }.bind(this));
        }

        function _estDiscussionSpecifiqueResponsables(aInstance, aGenre) {
            return MethodesTableau.existe(aGenre, [aInstance.genreRequete.TousResponsablesDelegues, aInstance.genreRequete.TousMembresCA, aInstance.genreRequete.TousResponsables, aInstance.genreRequete.ParentsDelegues, aInstance.genreRequete.ParentsDeLaClasse]);
        }
        ObjetDiscussion_Mobile.prototype.pourTouteLaClasse = function(aNumClasse, aGenre) {
            var result = false;
            var lListeClasses = this.genresDest.GetElementParGenre(parseInt(aGenre));
            lListeClasses = lListeClasses ? lListeClasses.listeClasses : null;
            if (lListeClasses) {
                if (aNumClasse === '0') {
                    aNumClasse = 0;
                }
                var lClasse = lListeClasses.GetElementParNumero(aNumClasse);
                if (lClasse) {
                    var lListeEleves = lClasse.listeEleves;
                    if (lListeEleves) {
                        var lListeElevesPossibles = lListeEleves.getListeElements(function(aEle) {
                            return this.options.discussionAvancee ? !aEle.discussionInterdit : aEle.avecDiscussion;
                        }.bind(this));
                        if (lListeElevesPossibles) {
                            var lNumerosElevesPossibles = lListeElevesPossibles.getTableauNumeros();
                            var lTabNumDest = this.newMsg.listeDestinataires.getTableauNumeros();
                            result = MethodesTableau.inclus(lNumerosElevesPossibles, lTabNumDest);
                        }
                    }
                }
            }
            return result;
        };
        ObjetDiscussion_Mobile.prototype.surListeDiff = function() {
            if (!this.listesDiffusion && GCache && GCache.general.existeDonnee('listeDiffusion')) {
                this.listesDiffusion = GCache.general.getDonnee('listeDiffusion');
            }
            Promise.resolve().then(function() {
                if (!this.listesDiffusion) {
                    return new ObjetRequeteListeDiffusion(this).lancerRequete().then(function(aJSON) {
                        if (aJSON && aJSON.liste) {
                            this.listesDiffusion = aJSON.liste;
                            if (GCache) {
                                GCache.general.setDonnee('listeDiffusion', aJSON.liste);
                            }
                        }
                    }.bind(this));
                }
            }.bind(this)).then(function() {
                _apresRequeteListePublic.call(this, null, {
                    listePublic: this.listesDiffusion
                });
            }.bind(this));
        };
        ObjetDiscussion_Mobile.prototype.addClasse = function(aNumClasse, aElement) {
            var lChecked = $(aElement).is(':checked');
            $('#' + (this.idListeDestinataire).escapeJQ()).find('li[ie-data-numClass="' + aNumClasse + '"]:not(.hidden)').find('input').not(aElement).prop('checked', lChecked).trigger('change');
        };
        ObjetDiscussion_Mobile.prototype.addDest = function(aNum, aGenre, aAdd, aNumeroClasse, aRechercheParGenre) {
            var lUnSeulCorrespondant = false;
            var lDest = this.newMsg.listeDestinataires.GetElementParNumeroEtGenre(aNum, aGenre),
                lThis = this;
            if (lDest === undefined && aAdd) {
                var lNewDest = new ObjetElement(this.genresDest.GetElementParGenre(aGenre).listePublic.GetElementParNumero(aNum).GetLibelle(), aNum, aGenre);
                lNewDest.SetEtat(EGenreEtat.Modification);
                if (lUnSeulCorrespondant) {
                    var lInstance = this;
                    $('#' + this.idListeDestinataire.escapeJQ()).find('input').each(function(index, element) {
                        if (element.labels[0].innerText !== lNewDest.GetLibelle()) {
                            element.checked = false;
                        }
                    });
                    this.genresDest.GetElementParGenre(aGenre).listePublic.parcourir(function(aElement) {
                        var lIndice = lInstance.newMsg.listeDestinataires.getIndiceElementParFiltre(function(aElt) {
                            return aElt.GetNumero() === aElement.GetNumero();
                        });
                        if (lIndice >= 0) {
                            lInstance.newMsg.listeDestinataires.remove(lIndice);
                        }
                    });
                }
                this.newMsg.listeDestinataires.AddElement(lNewDest);
            } else if (!aAdd) {
                var lIndDest = this.newMsg.listeDestinataires.GetIndiceExisteParNumeroEtGenre(aNum, aGenre);
                this.newMsg.listeDestinataires.remove(lIndDest);
            }
            if (!aRechercheParGenre) {
                var lStrRecherche = 'li.collection-header';
                if (aNumeroClasse !== undefined) {
                    lStrRecherche += '[ie-data-numClass="' + aNumeroClasse + '"]:not(.hidden)';
                }
                $('#' + this.idListeDestinataire.escapeJQ()).find(lStrRecherche).find('input').prop('checked', function() {
                    return lThis.pourTouteLaClasse($(this).attr('ie-data-numClass'), $(this).attr('ie-data-genreDest'));
                });
            }
            this.newMsg.listePublic = this.newMsg.listeDestinataires.getTableauLibelles();
            this.$refreshSelf();
        };
        ObjetDiscussion_Mobile.prototype.addListe = function(aNum, aAdd) {
            var lListe = this.listesDiffusion.GetElementParNumero(aNum);
            for (var i = 0; i < lListe.listePublicIndividu.GetNbrElements(); i++) {
                var lIndiv = lListe.listePublicIndividu.GetElement(i);
                var lDest = this.newMsg.listeDestinataires.GetElementParNumeroEtGenre(lIndiv.GetNumero(), lIndiv.GetGenre()),
                    lThis = this;
                if (lDest === undefined && aAdd) {
                    var lNewDest = new ObjetElement(lIndiv.GetLibelle(), lIndiv.GetNumero(), lIndiv.GetGenre());
                    lNewDest.SetEtat(EGenreEtat.Modification);
                    this.newMsg.listeDestinataires.AddElement(lNewDest);
                } else if (!aAdd) {
                    var lIndDest = this.newMsg.listeDestinataires.GetIndiceExisteParNumeroEtGenre(lIndiv.GetNumero(), lIndiv.GetGenre());
                    this.newMsg.listeDestinataires.remove(lIndDest);
                }
            }
            $('#' + this.idListeDestinataire.escapeJQ()).find('li.collection-header').find('input').prop('checked', function() {
                return lThis.pourTouteLaClasse($(this).attr('ie-data-numClass'), $(this).attr('ie-data-genreDest'));
            });
            this.newMsg.listePublic = this.newMsg.listeDestinataires.getTableauLibelles();
            this.$refreshSelf();
        };

        function _apresRequeteListePublic(aGenre, aDonnees) {
            var lListeRessource = aDonnees.listePublic || aDonnees.listeRessourcesPourCommunication,
                lHtml = [],
                i, j, lRess, lDest, lVisible, lId;
            if (MethodesTableau.existe(aGenre, [EGenreRessource.Eleve])) {
                this.genresDest.GetElementParGenre(aGenre).listePublic = lListeRessource;
                this.genresDest.GetElementParGenre(aGenre).listeClasses = new ObjetListeElements();
                var lListeClasses = this.genresDest.GetElementParGenre(aGenre).listeClasses,
                    lClasse;
                this.genresDest.GetElementParGenre(aGenre).listePublic.setTri([ObjetTri.init('Position')]);
                this.genresDest.GetElementParGenre(aGenre).listePublic.trier();
                for (i = 0; i < lListeRessource.GetNbrElements(); i++) {
                    var lEle = lListeRessource.GetElement(i);
                    for (j = 0; j < lEle.classes.GetNbrElements(); j++) {
                        var lClasseEle = lEle.classes.GetElement(j);
                        lClasse = lListeClasses.GetElementParNumero(lClasseEle.GetNumero());
                        if (!lClasse) {
                            lClasse = MethodesObjet.dupliquer(lClasseEle);
                            lClasse.listeEleves = new ObjetListeElements();
                            lListeClasses.AddElement(lClasse);
                        }
                        lClasse.listeEleves.AddElement(lEle);
                    }
                }
                lListeClasses.setTri([ObjetTri.init('Libelle')]);
                lListeClasses.trier();
                for (i = 0; i < lListeClasses.GetNbrElements(); i++) {
                    lClasse = lListeClasses.GetElement(i);
                    var lTouteLaClasse = this.pourTouteLaClasse(lClasse.GetNumero(), aGenre);
                    lHtml.push('<li class="collection-header deploiement ui-icon-carat-r-grey" ie-data-numClass="', lClasse.GetNumero(), '" ie-data-genreDest="', aGenre, '">', '<label>', '<input type="checkbox" ', (lTouteLaClasse ? ' checked="checked"' : ''), ' onchange="', this.Nom, '.addClasse(\'', lClasse.GetNumero(), '\', this);" ie-data-numClass="', lClasse.GetNumero(), '" ie-data-genreDest="', aGenre, '" />', '<span>', lClasse.GetLibelle(), '</span>', '</label>', '<a class="ui-icon-carat-r-grey" style="position: absolute; right: 0.375em; top: 0.25em;z-index:10;"></a>', '</li>');
                    for (j = 0; j < lClasse.listeEleves.GetNbrElements(); j++) {
                        lRess = lClasse.listeEleves.GetElement(j);
                        lDest = this.newMsg.listeDestinataires.GetElementParNumeroEtGenre(lRess.GetNumero(), null, true);
                        lVisible = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Administrateur, EGenreEspace.Mobile_PrimProfesseur, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]) ? !lRess.discussionInterdit : lRess.avecDiscussion;
                        if (lVisible) {
                            lHtml.push('<li class="collection-item" ie-data-genreDest="', aGenre, '" ie-data-numClass="', lClasse.GetNumero(), '" style="display:none;">', '<label>', '<input type="checkbox"', (!!lDest ? ' checked="checked"' : ''), ' onchange="', this.Nom, '.addDest(\'', lRess.GetNumero(), '\', ', aGenre, ', this.checked, \'', lClasse.GetNumero(), '\');" />', '<span>', lRess.GetLibelle(), '</span>', '</label>', '</li>');
                        }
                    }
                }
            } else if (aGenre) {
                this.genresDest.GetElementParGenre(aGenre).listePublic = lListeRessource;
                this.genresDest.GetElementParGenre(aGenre).listePublic.setTri([ObjetTri.init('Position'), ObjetTri.init('Libelle')]);
                this.genresDest.GetElementParGenre(aGenre).listePublic.trier();
                for (i = 0; i < lListeRessource.GetNbrElements(); i++) {
                    lId = GUID.getId();
                    lRess = lListeRessource.GetElement(i);
                    lDest = this.newMsg.listeDestinataires.GetElementParNumeroEtGenre(lRess.GetNumero(), null, true);
                    lVisible = (!lRess.discussionInterdit && (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Administrateur, EGenreEspace.Mobile_PrimProfesseur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]) || lRess.avecDiscussion));
                    if (lVisible) {
                        if (aDonnees && aDonnees.surListeContacts && !lRess.existeNumero()) {
                            lHtml.push('<li class="collection-header deploiement ui-icon-carat-d-grey">', '<label>', '<input type="checkbox"', GHtml.composeAttr('ie-node', 'getNodeTousRess', aGenre), '/>', '<span>', lRess.GetLibelle(), '</span>', '</label>', '<a class="ui-icon-carat-d-grey" style="position: absolute; right: 0.375em; top: 0.25em;z-index:10;"></a>', '</li>');
                        } else {
                            var lLibelleItem = [lRess.GetLibelle() + (!!lRess.delegueDesClasses ? ' (' + lRess.delegueDesClasses + ')' : '')];
                            if (lRess.fonction && lRess.fonction.GetLibelle()) {
                                lLibelleItem.push(' (', lRess.fonction.GetLibelle(), ')');
                            }
                            if (lRess.estPrincipal) {
                                lLibelleItem.push(' - <span class="Gras">', GTraductions.getValeur('fenetreCommunication.profPrincipal'), '</span>');
                            }
                            if (lRess.estTuteur) {
                                lLibelleItem.push(' - <span class="Gras">', GTraductions.getValeur('fenetreCommunication.tuteur'), '</span>');
                            }
                            lHtml.push('<li class="collection-item" ie-data-genreDest="', aGenre, '">', '<label>', '<input id="', lId, '" type="checkbox" ', (!!lDest ? ' checked="checked"' : ''), ' onchange="', this.Nom, '.addDest(\'', lRess.GetNumero(), '\', ', aGenre, ', this.checked, null, true);" />', '<span>', lLibelleItem.join(''), '</span>', '</label>', '</li>');
                        }
                    }
                }
            } else {
                for (i = 0; i < lListeRessource.GetNbrElements(); i++) {
                    lId = GUID.getId();
                    lRess = lListeRessource.GetElement(i);
                    lDest = this.newMsg.listeDestinataires.GetElementParNumeroEtGenre(lRess.GetNumero(), null, true);
                    lHtml.push('<li class="collection-item" ie-data-genreDest="', aGenre, '">', '<label>', '<input id="', lId, '" type="checkbox" ', (!!lDest ? ' checked="checked"' : ''), ' onchange="', this.Nom, '.addListe(\'', lRess.GetNumero(), '\', this.checked);" />', '<span>', lRess.GetLibelle(), '</span>', '</label>', '</li>');
                }
            }
            $('#' + (this.idListeDestinataire).escapeJQ()).IEHtml(lHtml.join(''), {
                controleur: this.controleur
            });
            $('#' + this.idListeDestinataire.escapeJQ()).off('click').on('click', '.collection-header', {
                instance: this
            }, function(e) {
                if ($(e.target).is('label > input + span, input')) {
                    return;
                }
                var lLis = $(this).nextUntil('.collection-header'),
                    lIsCollapsed = !lLis.first().is(':visible');
                if (!lIsCollapsed) {
                    lLis.hide();
                    $(this).removeClass('ui-icon-carat-d-grey').addClass('ui-icon-carat-r-grey');
                } else {
                    lLis.show();
                    $(this).removeClass('ui-icon-carat-r-grey').addClass('ui-icon-carat-d-grey');
                }
                e.stopPropagation();
                return false;
            });
            $('#' + this.idFiltreNom.escapeJQ()).parent().show();
            GHtml.setDisplay(this.idMessageUnique, false);
        }

        function _surGenreDest(aGenre, aNumero) {
            if (this.donnees.listeContacts && (this.donnees.alertePPMS || this.options.estChat)) {
                var lListe = this.donnees.listeContacts.getListeElements(function(aElement) {
                    return aElement.GetGenre() === aGenre;
                });
                _apresRequeteListePublic.call(this, aGenre, {
                    listePublic: lListe,
                    surListeContacts: true
                });
            } else if (this.options.discussionAvancee) {
                var lEleGenre = this.genresDest.GetElementParGenre(aGenre);
                if (lEleGenre && lEleGenre.listePublic) {
                    _apresRequeteListePublic.call(this, aGenre, {
                        listePublic: lEleGenre.listePublic
                    });
                } else {
                    new ObjetRequeteListePublics(this, _apresRequeteListePublic.bind(this, aGenre)).lancerRequete({
                        genres: [aGenre],
                        sansFiltreSurEleve: GApplication.droits.get(TypeDroits.communication.toutesClasses)
                    });
                }
            } else {
                var lOnglet = null;
                var lFiltreElement = null;
                var lParamsSupplementaires = null;
                if (_estDiscussionSpecifiqueResponsables(this, aGenre)) {
                    var lGenreFiltreExact = (aGenre * -1);
                    if (aGenre === this.genreRequete.ParentsDelegues || aGenre === this.genreRequete.ParentsDeLaClasse) {
                        lParamsSupplementaires = {
                            classe: new ObjetElement('', aNumero, EGenreRessource.Classe)
                        };
                    }
                    lOnglet = new ObjetElement('', 0, EGenreRessource.Responsable);
                    lFiltreElement = new ObjetElement('', 0, lGenreFiltreExact);
                } else {
                    lOnglet = new ObjetElement('', 0, aGenre);
                    lFiltreElement = GEtatUtilisateur.getMembre();
                }
                var lParametresRequete = {
                    onglet: lOnglet,
                    filtreElement: lFiltreElement
                };
                if (!!lParamsSupplementaires) {
                    Object.assign(lParametresRequete, lParamsSupplementaires);
                }
                new ObjetRequeteListeRessourcesPourCommunication(this, _apresRequeteListePublic.bind(this, aGenre)).lancerRequete(lParametresRequete);
            }
        }

        function _filtrerDest(aText) {
            if (!!aText && aText.length > 0) {
                $('#' + this.idListeDestinataire.escapeJQ()).find('li').removeClass('hidden').filter(function() {
                    if (!$(this).hasClass('collection-item')) {
                        return false;
                    }
                    return !new RegExp(aText, "i").test($(this).text());
                }).addClass('hidden').end().filter('.collection-header').each(function() {
                    $(this).toggleClass('hidden', $(this).parent().find('li.collection-item[ie-data-numClass="' + $(this).children('input').attr('ie-data-numClass') + '"]:not(.hidden)').length === 0);
                });
            } else {
                $('#' + this.idListeDestinataire.escapeJQ()).find('li').removeClass('hidden');
            }
        }

        function _popupDestinataires(aEvent, aGenre) {
            aEvent.stopPropagation();
            var lHtml = [];
            lHtml.push('<div style="display:none; width: 80%; margin: 0 auto;" class="input-field">', '<i class="material-icons icon_search prefix small"></i>', '<input type="search" id="', this.idFiltreNom, '" ie-node="getNodeInputSearchDest">', '</div>', '<div id="', this.idMessageUnique, '" class="PetitEspaceGauche" style="display:none">', GTraductions.getValeur('fenetreEnvoiEmail.unSeulDestinataire'), '</div>', '<ul id="', this.idListeDestinataire, '" class="collection with-header" style="margin:0;">');
            for (var i = 0; i < this.genresDest.GetNbrElements(); i++) {
                var lRess = this.genresDest.GetElement(i);
                if (lRess.Actif && (aGenre === undefined || lRess.GetGenre() === aGenre)) {
                    lHtml.push('<li class="collection-header', (lRess.Actif ? ' with-action' : ''), '" id="', this.idListeDestinataire + lRess.GetGenre(), '"', (lRess.Actif ? ('ie-node=getNodeGenreDest(' + lRess.GetGenre() + ',\'' + lRess.GetNumero() + '\')') : ''), '>', lRess.GetLibelle(), '</li>');
                }
            }
            if (this.options.discussionAvancee && !this.options.estChat && this.options.avecDestinatairesListeDiffusion && !MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant])) {
                lHtml.push('<li class="collection-header with-action" id="', this.idListeDestinataire, 'listeDiff" onclick="' + this.Nom + '.surListeDiff()">', GTraductions.getValeur('actualites.public.chargerListeDiffusion'), '</li>');
            }
            lHtml.push('</ul>');
            GInterface.setPopupHeader('<h1 class="truncate">' + GTraductions.getValeur('Messagerie.ListeDestinataires') + '</h1>');
            GInterface.setPopupContent(lHtml.join(''), {
                controleur: this.controleur
            });
            GInterface.setPopupFooter([{
                libelle: GTraductions.getValeur('Valider'),
                ferme: true
            }]);
            GInterface.openPopup();
            if (aGenre !== undefined && $('#' + this.idListeDestinataire.escapeJQ() + aGenre).length === 1) {
                $('#' + this.idListeDestinataire.escapeJQ() + aGenre).trigger('click');
            }
        }

        function _composeSelectionDiscussion() {
            if (!this.donnees.tableauDeBord || !this.options.callbackSelectDiscussion) {
                return '';
            }
            var lIndiceDiscussionSelectionnee = this.donnees.tableauDeBord.indiceDiscussionSelectionnee;
            var lNombreDiscussions = (!!this.donnees.tableauDeBord.listeDiscussions ? this.donnees.tableauDeBord.listeDiscussions.GetNbrElements() : 0);
            var H = [];
            if (lIndiceDiscussionSelectionnee >= 0 && lNombreDiscussions >= 2) {
                var lNbDiscussionsNonLues = 0;
                var lOptions = [];
                if (!!this.donnees.tableauDeBord.listeDiscussions) {
                    this.donnees.tableauDeBord.listeDiscussions.parcourir(function(D, aIndex) {
                        var nbMessagesNonLus = 0;
                        if (!!D.nbNonLus && D.nbNonLus > 0) {
                            nbMessagesNonLus = D.nbNonLus;
                        }
                        var lEstSelected = (lIndiceDiscussionSelectionnee === aIndex);
                        lOptions.push('<option value="', aIndex, '"', (nbMessagesNonLus > 0 ? (' data-badge="' + nbMessagesNonLus + '"') : ''), (lEstSelected ? ' selected="selected"' : ''), '>', (D.objet || ''), '</option>');
                        if (nbMessagesNonLus > 0) {
                            lNbDiscussionsNonLues++;
                        }
                    });
                }
                var lStrNbNonLues;
                if (lNbDiscussionsNonLues > 0) {
                    lStrNbNonLues = '<span class="selectDiscussionNonLu">>' + GTraductions.getValeur(lNbDiscussionsNonLues === 1 ? 'Messagerie.NombreNonLue' : 'Messagerie.NombreNonLues', [lNbDiscussionsNonLues]) + '</span>';
                }
                H.push('<div class="selectDiscussion">', (lStrNbNonLues || ''), '<select ie-node="getNodeSelectDiscussion">', lOptions.join(''), '</select>', '</div>');
            }
            return H.join('');
        }

        function _composeSelectAlerte() {
            var H = [];
            H.push('<div class="odm_selectModeleAlerte"><div class="input-field">', '<select ie-node="getNodeSelectModeleAlerte">');
            this.donnees.alertePPMS.listeModelesAlerte.parcourir(function(aModele, aIndex) {
                H.push('<option value="', aIndex, '">', (aModele.GetLibelle() || ''), '</option>');
            });
            H.push('</select>', '<label class="">', GTraductions.getValeur('Messagerie.ModeleAlerte'), '</label>', '</div></div>');
            return H.join('');
        }

        function _composeStrListeDestinataires() {
            this.listeSelectionProfsCarnetLiaison = new ObjetListeElements();
            var H = [GTraductions.getValeur('Messagerie.DestinatairesMsg')];
            if (!!this.newMsg.listeDestinataires && this.newMsg.listeDestinataires.GetNbrElements() > 0) {
                var lListeChoixProfs = null;
                var lListeDestinatairesAAfficher = this.newMsg.listeDestinataires;
                if (this.donnees.estPrimParentSurEtiquetteCL) {
                    lListeChoixProfs = this.newMsg.listeDestinataires.getListeElements(function(D) {
                        return D.GetGenre() === EGenreRessource.Enseignant;
                    });
                    if (lListeChoixProfs.GetNbrElements() === 1) {
                        lListeChoixProfs = null;
                    } else {
                        this.listeSelectionProfsCarnetLiaison.add(lListeChoixProfs.GetElement(0));
                        lListeDestinatairesAAfficher = this.newMsg.listeDestinataires.getListeElements(function(D) {
                            return D.GetGenre() !== EGenreRessource.Enseignant;
                        });
                    }
                }
                if (lListeChoixProfs) {
                    lListeChoixProfs.parcourir(function(D) {
                        H.push('<ie-checkbox', GHtml.composeAttr('ie-model', 'cbProfsCarnetL', D.GetNumero()), ' ie-textright style="margin-left:1rem">', D.GetLibelle(), '</ie-checkbox>');
                    });
                    H.push('</br>&nbsp;&nbsp;&nbsp;&nbsp;');
                }
                H.push('&nbsp;');
                H.push(lListeDestinatairesAAfficher.getTableauLibelles().join(', '));
            }
            return H.join('');
        }

        function _estBrouillonCreationDiscussion() {
            return !!(this.newMsg && this.newMsg.brouillon && (!this.donnees.messagePourReponse || !this.donnees.messagePourReponse.existeNumero()));
        }

        function _getHtmlBtnRepondre() {
            var H = [];
            if (this.donnees.listeBoutons) {
                this.donnees.listeBoutons.parcourir(function(aBouton) {
                    if (aBouton.GetGenre() === TypeHttpReponseMessage.rm_EnvoiATousSaufParentEleve) {
                        if (aBouton.horsLimiteParentsEleves) {
                            this.avecInclureParentsEleve = false;
                        }
                        H.push('<div>', '<ie-checkbox', GHtml.composeAttr('ie-model', 'cbInclureParentEleve', !!aBouton.horsLimiteParentsEleves), GHtml.composeAttr('ie-node', 'getNode', !!aBouton.horsLimiteParentsEleves), 'ie-textleft>', GTraductions.getValeur('Messagerie.InclureParentsEleves'), '</ie-checkbox></div>');
                    }
                    H.push('<ie-bouton class="', TypeThemeBouton.primaire, '"', GHtml.composeAttr('ie-model', 'buttonRepondre', aBouton.GetGenre()), '>', aBouton.GetLibelle(), '</ie-bouton>');
                }.bind(this));
            }
            return H.join('');
        }

        function _composer() {
            var lMessageNonEditable = TUtilitaireMessagerie.estMessageNonEditable(this.donnees.messagePourReponse);
            var lCreationAlertePPMS = this.donnees.alertePPMS && this.options.estChat;
            var lEstNouvelleDiscussion = this.donnees.creationDiscussion || (this.donnees.brouillon && !this.donnees.messagePourReponse.existeNumero());
            var lAvecPublic = this.options.callbackPopupListeDest && this.donnees.messagePourReponse && this.donnees.messagePourReponse.existeNumero() && !this.donnees.creationDiscussion;
            var lAvecBtnActions = (!this.options.estSidePanel && !lEstNouvelleDiscussion && !this.options.estChat);
            var lEstMessageCarnetLiaison = this.donnees.messagePourReponse && this.donnees.messagePourReponse.estCarnetLiaison;
            var H = [];
            var lLibelle = '';
            if (this.donnees.titre) {
                lLibelle = this.donnees.titre;
            } else if (lEstNouvelleDiscussion) {
                lLibelle = GTraductions.getValeur('Messagerie.TitreFenetre');
            } else if (this.donnees.message && this.donnees.message.objet) {
                lLibelle = this.donnees.message.objet;
            }
            H.push('<div id="', this.Nom + '_conteneur" class="ObjetDiscussion_Mobile">');
            H.push('<div class="navheader', this.options.estSidePanel ? ' header-titre' : '', '">', '<ie-btnimage ie-model="btnFermer" class="icon_retour_mobile btnImageIcon"></ie-btnimage>', '<span class="odm_header_libelle">', lLibelle, '</span>', (this.options.callbackNavigation ? '<button class="btn-flat waves-effect waves-light btn-floating" ie-node="nodeBtnPrecSuiv(true)">' + '<i class="material-icons icon_angle_left"></i></button>' + '<button class="btn-flat waves-effect waves-light btn-floating" ie-node="nodeBtnPrecSuiv(false)"><i class="material-icons icon_angle_right"></i></button>' : ''), this.options.callbackBtnCreation ? '<span class="messagerieNouveauMessage btn-floating waves-effect waves-light" ie-node="getNodeBtnCreation">&nbsp;</span>' : '', lAvecBtnActions || lAvecPublic ? ['<div>', '<button class="btn-flat waves-effect waves-light btn-floating"', GHtml.composeAttr('ie-node', 'nodeBtnActions', [!!lAvecPublic, !!lAvecBtnActions]), '>' + '<i class="material-icons icon_ellipsis_vertical"></i></button>', '</div>'].join('') : '', '</div>');
            H.push('<div class="odm_contenu">');
            if (this.donnees.tableauDeBord) {
                H.push(_composeSelectionDiscussion.call(this));
            }
            if (this.options.estChat && this.donnees.message && this.donnees.message.estAlerte && this.donnees.message.exercice) {
                H.push('<span class="odm_exercice">', GTraductions.getValeur('Messagerie.AlerteEstUnExercice'), '</span>');
            }
            if (!(this.options.estChat && this.donnees.message && this.donnees.message.estAlerte && this.donnees.message.cloture)) {
                if (!lMessageNonEditable && !this.donnees.tableauDeBord && !this.donnees.estPrimParentSurEtiquetteCL && !lEstMessageCarnetLiaison && (!this.options.estChat || this.donnees.creationDiscussion) && (this.donnees.creationDiscussion || GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee)) && !TUtilitaireMessagerie.estMessageVisuChat(this.donnees.messagePourReponse)) {
                    H.push('<div style="margin:1em 0;border-bottom:1px solid #bababa;" ie-node="getNodeModifDest(undefined)" ie-html="getHtmlModifDest()"></div>');
                }
                if (this.donnees.tableauDeBord || this.donnees.estPrimParentSurEtiquetteCL) {
                    H.push('<div class="odm_dest_TableauDeBord">', _composeStrListeDestinataires.call(this), '</div>');
                }
                if (_avecCBDirecteur.call(this)) {
                    var lEstSelected = TUtilitaireMessagerie.unMessageContientLeDirecteur(this.donnees.tableauDeBord ? this.newMsg.listeMessages : this.donnees.listeMessages);
                    var lDiscussionEstNonPossedee = this.donnees.tableauDeBord ? this.newMsg.estNonPossede === true : false;
                    H.push('<div class="odm_TransmettreDir_TableauDeBord">', '<label>', '<input type="checkbox" id="', this.idCheckboxDirecteur, '"', (lEstSelected ? ' checked="checked"' : ''), ((lEstSelected || lDiscussionEstNonPossedee) ? ' disabled="disabled"' : ''), '/>', '<span>', GTraductions.getValeur('MessagerieCarnetLiaison.AjouterDirecteur'), '</span>', '</label>', '</div>');
                }
                if (lCreationAlertePPMS) {
                    H.push(_composeSelectAlerte.call(this));
                }
                if (!this.donnees.alertePPMS && !this.options.estChat && (this.donnees.tableauDeBord || this.donnees.creationDiscussion || _estBrouillonCreationDiscussion.call(this))) {
                    var lObjetEstEditable = !this.donnees.tableauDeBord || (this.donnees.tableauDeBord.indiceDiscussionSelectionnee === -1);
                    H.push('<div>', '<div class="input-field">', '<input ie-model="inputObjet" id="', this.Nom + '_inputObj', '" type="text" ', (!lObjetEstEditable ? ' disabled' : ''), '/>', '<label for="', this.Nom + '_inputObj', '"', (this.newMsg.objet ? ' class="active"' : ''), '>', GTraductions.getValeur('Messagerie.ObjetMsg'), '</label>', '</div>', '</div>');
                }
                if (this.donnees.creationDiscussion || (!lMessageNonEditable && this.donnees.listeBoutons && this.donnees.listeBoutons.GetNbrElements() > 0)) {
                    var lContenu = this.donnees.tableauDeBord || (this.donnees.alertePPMS && this.donnees.alertePPMS.modeleAlerte && this.newMsg.contenu) || (this.newMsg.brouillon && this.newMsg.contenu) ? this.newMsg.contenu || '' : '';
                    H.push('<div class="input-field">', '<div id="' + this.idConversation_Reponse + '" ie-node="getNodeContentEditable"  class="contenteditable_index" contenteditable="true">', lContenu, '</div>', '<label ', (lContenu ? ' class="active"' : ''), '>', GTraductions.getValeur('Messagerie.RedigerMessage'), '</label>', '</div>');
                }
                if (lCreationAlertePPMS) {
                    H.push('<div class="odm_cbExercice">', '<ie-switch ie-model="cbExerciceAlerte">', GTraductions.getValeur('Messagerie.IndiquerExercice'), '</ie-switch>', '</div>');
                }
                if (this.options.avecPJ && !this.donnees.alertePPMS && !this.options.estChat && !lMessageNonEditable && this.donnees.listeBoutons && this.donnees.listeBoutons.GetNbrElements() > 0 && !TUtilitaireMessagerie.estMessageVisuChat(this.donnees.messagePourReponse)) {
                    H.push('<div class="odm_pj">', '<div  ie-model="tromboneSelecFile" ie-selecfile>', '<div class="odm_pj_image"><i class="icon_paper_clip"></i></div>', '<span ie-html="getHtmlPJ"></span>', '</div>', '</div>');
                }
                if (!lMessageNonEditable && this.donnees.listeBoutons.GetNbrElements() === 0) {
                    H.push('<div>', this.options.discussionAvancee ? GTraductions.getValeur('Messagerie.DestinatairesNonAutorises') : GTraductions.getValeur('Messagerie.NonAutorisePourDestinataires'), '<br><br>', '</div>');
                }
                H.push('<div class="input-field odm_boutons" ie-html="getHtmlBtnRepondre"></div>', '<span style="clear: right;display: block;"></span>');
            }
            if (this.donnees.listeMessages && this.donnees.listeMessages.GetNbrElements()) {
                var lPourReponseMessageInfo = (this.donnees.messagePourReponse && !!this.donnees.messagePourReponse.messageInfo) ? this.donnees.messagePourReponse.messageInfo : null;
                H.push('<div class="odm_listemessages">', lPourReponseMessageInfo ? '<div style="color:red">' + GChaine.ToHTML(lPourReponseMessageInfo) + '</div>' : '', TUtilitaireMessagerie.getDiscussion({
                    listeMessages: this.donnees.listeMessages,
                    nbMessagesTotal: this.donnees.nbPossessionsMessageListe,
                    getNodeAfficherSuivants: 'getNodeAfficherSuivants',
                    margesGauche: ['1%', '5%', '7%', '10%', '2%'],
                    margesDroite: ['5%', '1%', '10%', '7%', '4%'],
                    couleurBordure: 'black',
                    couleurFond: '#FFFFFF',
                    ieHint: 'visuMessage.hint'
                }), '</div>');
            }
            H.push('</div>');
            if (lCreationAlertePPMS) {
                H.push('<span class="odm_messagefooter">', GTraductions.getValeur('Messagerie.InfosAlerte'), '</span>');
            }
            H.push('</div>');
            return H.join('');
        }

        function _avecCBDirecteur() {
            return GEtatUtilisateur.pourPrimaire() && ((this.donnees.creationDiscussion && !this.options.estChat) || (this.donnees.messagePourReponse && this.donnees.messagePourReponse.estCarnetLiaison && GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee)));
        }
        module.exports = ObjetDiscussion_Mobile;
    },
    fn: "objetdiscussion_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreCommandeMenu = {
            Creation: 'cmdMenu_creation',
            Edition: 'cmdMenu_edition',
            Suppression: 'cmdMenu_suppression'
        };
        module.exports = EGenreCommandeMenu;
    },
    fn: "enumere_commandemenu.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GStyle = require('GStyle.js');
        var EGenreCommandeMenu = require('Enumere_CommandeMenu.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetIndexsUnique = require('ObjetTri.js').ObjetIndexsUnique;
        var TypeNote = require('TypeNote.js');

        function ObjetDonneesListe(ADonnees) {
            this.Donnees = !ADonnees ? new ObjetListeElements() : ADonnees;
            this.ECouleurCellule = ObjetDonneesListe.ECouleurCellule;
            this.ETypeCellule = ObjetDonneesListe.ETypeCellule;
            this.EGenreCoche = ObjetDonneesListe.EGenreCoche;
            this.enImpression = false;
            this.__getIdsColonnes = null;
            this.__getParams = null;
            this.options = {
                avecSelection: true,
                avecEdition: true,
                avecSuppression: true,
                editionApresSelection: true,
                editionSurSelectionApresFinEdition: false,
                avecEvnt_Selection: false,
                avecEvnt_ModificationSelection: false,
                avecEvnt_SelectionClick: false,
                avecEvnt_SelectionDblClick: false,
                avecEvnt_Edition: false,
                avecEvnt_ApresEdition: false,
                avecEvnt_ApresEditionValidationSansModification: false,
                avecActualisation_ApresEdition: true,
                avecEvnt_Creation: false,
                avecEvnt_ApresCreation: false,
                avecEvnt_Suppression: false,
                avecEvnt_ApresSuppression: false,
                avecEvnt_KeyPressListe: false,
                avecTimeoutEvent_KeyPressListe: true,
                avecEvnt_KeyUpListe: false,
                avecVoileBleuHover: true,
                avecMultiSelection: false,
                selectionParCellule: false,
                avecMultiSelectionSurCtrl: true,
                avecMultiSelectionSurShift: true,
                avecMultiSelectionSurLigneFusion: true,
                avecRechercheSelectionMiroir: false,
                avecDeselectionSurNonSelectionnable: true,
                avecDeselectionMonoSelectionClick: false,
                avecDeselectionMonoSelectionClickCtrl: false,
                avecEtatSaisie: true,
                avecTri: true,
                avecContenuTronque: false,
                avecEllipsisContenuTronque: true,
                avecDeploiement: false,
                avecDeploiementSurColonne: true,
                avecImageSurColonneDeploiement: false,
                avecEventDeploiementSurCellule: true,
                avecInterruptionSuppression: false,
                avecTrimSurEdition: false,
                indentationCelluleEnfant: 12,
                hauteurMinCellule: ObjetDonneesListe.hauteurMinCellule,
                hauteurMinContenuCellule: 0,
                alignVCenter: false,
                avecLigneDraggable: false,
                avecLigneDroppable: false,
                dragNDropLigneInsertion: true,
                avecHtmlDetailsDraggableOver: true,
                getValeur: null,
                nonEditable: false
            };
        }
        ObjetDonneesListe.hauteurMinCellule = 21;
        ObjetDonneesListe.ECouleurCellule = {
            Blanc: 0,
            Gris: 1,
            Deploiement: 2,
            Fixe: 3,
            Total: 4
        };
        ObjetDonneesListe.ETypeCellule = {
            Texte: 0,
            ZoneTexte: 1,
            Html: 2,
            Date: 3,
            Note: 4,
            Coche: 5,
            CocheDeploiement: 6,
            Image: 7,
            DateCalendrier: 8,
            HeureMinute: 9
        };
        ObjetDonneesListe.EGenreCoche = {
            Verte: true,
            Grise: null,
            Aucune: false
        };
        ObjetDonneesListe.typeCelluleTotal = {
            defaut: 'defaut',
            fond: 'fond',
            editable: 'editable'
        };
        ObjetDonneesListe.TypeDirectionElementSurvolCellule = {
            haut: 'haut',
            bas: 'bas',
            gauche: 'gauche',
            droite: 'droite'
        };
        ObjetDonneesListe.prototype.setOptions = function(aOptions) {
            $.extend(this.options, aOptions);
            return this;
        };
        ObjetDonneesListe.prototype.getControleur = function(aDonneeListe, aListe) {
            return null;
        };
        ObjetDonneesListe.prototype.AvecSelection = function(I, D) {
            return this.options.avecSelection;
        };
        ObjetDonneesListe.prototype.avecDeselection = function(aLigne, aColonne, aElement) {
            return this.AvecMultiSelection() ? true : (this.options.avecDeselectionMonoSelectionClickCtrl || this.options.avecDeselectionMonoSelectionClick);
        };
        ObjetDonneesListe.prototype.selectionParCellule = function(aColonne, aArticle) {
            return this.options.selectionParCellule;
        };
        ObjetDonneesListe.prototype.AvecEdition = function(aColonne, aArticle, aParams) {
            return this.options.avecEdition;
        };
        ObjetDonneesListe.prototype.avecEditionApresSelection = function(aParams) {
            if (aParams.typeValeur === ObjetDonneesListe.ETypeCellule.Coche) {
                return false;
            }
            return this.options.editionApresSelection;
        };
        ObjetDonneesListe.prototype.getColonneTransfertEdition = function(aParams) {
            return null;
        };
        ObjetDonneesListe.prototype.AvecSuppression = function(aArticle, aListeSelection, aParams) {
            return this.options.avecSuppression;
        };
        ObjetDonneesListe.prototype.AvecEtatSaisie = function(aParamsCellule) {
            return this.options.avecEtatSaisie;
        };
        ObjetDonneesListe.prototype.AvecTri = function() {
            return this.options.avecTri;
        };
        ObjetDonneesListe.prototype.AvecMenuContextuel = function(aParams) {
            return aParams.article && aParams.ligne >= 0 ? this.AvecSelection(aParams.colonne, aParams.article) : false;
        };
        ObjetDonneesListe.prototype.avecContenuTronque = function(aParams) {
            return this.options.avecContenuTronque;
        };
        ObjetDonneesListe.prototype.AvecDeploiement = function() {
            return this.options.avecDeploiement;
        };
        ObjetDonneesListe.prototype.AvecDeploiementSurColonne = function(aParams) {
            return this.options.avecDeploiementSurColonne;
        };
        ObjetDonneesListe.prototype.avecImageSurColonneDeploiement = function(aParams) {
            return this.options.avecImageSurColonneDeploiement;
        };
        ObjetDonneesListe.prototype.avecEventDeploiementSurCellule = function(aParams) {
            return this.options.avecEventDeploiementSurCellule;
        };
        ObjetDonneesListe.prototype.getIndentationCelluleSelonParente = function(aParams) {
            if (!aParams) {
                return 0;
            }
            var lIndent = 0,
                lArticle = aParams.article;
            while (lArticle && lArticle.pere) {
                lIndent += this.options.indentationCelluleEnfant || 0;
                lArticle = lArticle.pere;
            }
            return lIndent;
        };
        ObjetDonneesListe.prototype.getIndentationCellule = function(aParams) {
            return 0;
        };
        ObjetDonneesListe.prototype.avecAlternanceCouleurLigne = function(aParamsCellule) {
            if (this.estUnDeploiement(aParamsCellule) || (aParamsCellule.celluleLignePrecedente && this.estUnDeploiement(aParamsCellule.celluleLignePrecedente))) {
                return 0;
            }
            return true;
        };
        ObjetDonneesListe.prototype.surDeploiement = function(I, J, D) {
            D.estDeploye = !D.estDeploye;
        };
        ObjetDonneesListe.prototype.AvecEvenement_Selection = function(I, D, aParams) {
            return this.options.avecEvnt_Selection;
        };
        ObjetDonneesListe.prototype.AvecEvenement_SelectionClick = function(I, D, aParams) {
            return this.options.avecEvnt_SelectionClick;
        };
        ObjetDonneesListe.prototype.AvecEvenement_SelectionDblClick = function(I, D, aParams) {
            return this.options.avecEvnt_SelectionDblClick;
        };
        ObjetDonneesListe.prototype.AvecEvenement_Creation = function(I) {
            return this.options.avecEvnt_Creation;
        };
        ObjetDonneesListe.prototype.AvecEvenement_Edition = function(I, D, aParams) {
            return this.options.avecEvnt_Edition;
        };
        ObjetDonneesListe.prototype.AvecEvenement_Suppression = function(D, aParams) {
            return this.options.avecEvnt_Suppression;
        };
        ObjetDonneesListe.prototype.AvecEvenement_Deploiement = function(I, D, aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.AvecEvenement_ApresCreation = function() {
            return this.options.avecEvnt_ApresCreation;
        };
        ObjetDonneesListe.prototype.AvecEvenement_ApresErreurCreation = function() {
            return false;
        };
        ObjetDonneesListe.prototype.AvecEvenement_ApresEdition = function(aLigne, aColonne, aDonnee, aParams) {
            return this.options.avecEvnt_ApresEdition;
        };
        ObjetDonneesListe.prototype.avecActualisation_ApresEdition = function(aLigne, aColonne) {
            return this.options.avecActualisation_ApresEdition;
        };
        ObjetDonneesListe.prototype.AvecEvenement_ApresSuppression = function() {
            return this.options.avecEvnt_ApresSuppression;
        };
        ObjetDonneesListe.prototype.avecInterruptionSuppression = function() {
            return this.options.avecInterruptionSuppression;
        };
        ObjetDonneesListe.prototype.SurSelectionLigne = function(J, D, aSelectionner) {};
        ObjetDonneesListe.prototype.SurSelection = function(I, D, aLigne, aSelectionner) {};
        ObjetDonneesListe.prototype.SurCreation = function(D, V, J) {};
        ObjetDonneesListe.prototype.avecCreationElementsDynamique = function(aListeValeurs, aLigneCreation) {
            return false;
        };
        ObjetDonneesListe.prototype.SurEdition = function(aParams, I, D, V) {};
        ObjetDonneesListe.prototype.SurSuppression = function(aArticle) {
            aArticle.SetEtat(EGenreEtat.Suppression);
        };
        ObjetDonneesListe.prototype.avecSelecFile = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.getOptionsSelecFile = function(aParams) {
            return null;
        };
        ObjetDonneesListe.prototype.evenementSurSelecFile = function(aParams, aParamsSelecFile) {};
        ObjetDonneesListe.prototype.avecLigneDraggable = function(aParams) {
            return this.options.avecLigneDraggable;
        };
        ObjetDonneesListe.prototype.getLibelleDraggable = function(aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.getHtmlDetailsDraggableOver = function(aParams, aDataDrag) {
            if (!this.options.avecHtmlDetailsDraggableOver) {
                return '';
            }
            return '<div class="draggable_details_Deplacer"></div><label>' + (this.options.dragNDropLigneInsertion ? GTraductions.getValeur('liste.ChangerRang') : GTraductions.getValeur('liste.EchangerRang')) + '</label>';
        };
        ObjetDonneesListe.prototype.avecLigneDroppable = function(aParams) {
            return this.options.avecLigneDroppable;
        };
        ObjetDonneesListe.prototype.autoriserDeplacementElementSurLigne = function(aParamsLigneDestination, aParamsSource) {
            return aParamsSource.instance && aParamsLigneDestination.instance && aParamsSource.instance.Nom === aParamsLigneDestination.instance.Nom && aParamsLigneDestination.article && aParamsSource.article && aParamsLigneDestination.ligne !== aParamsSource.ligne;
        };
        ObjetDonneesListe.prototype.surDeplacementElementSurLigne = function(aParamsLigneDestination, aParamsSource) {};
        ObjetDonneesListe.prototype.GetEtatSurEdition = function(aParams, aArticle) {
            return EGenreEtat.Modification;
        };
        ObjetDonneesListe.prototype.Edition_Confirmation = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.Suppression_Impossible = function(D, aListeSelections) {
            return false;
        };
        ObjetDonneesListe.prototype.Suppression_Confirmation = function(D, aListeSelections) {
            return true;
        };
        ObjetDonneesListe.prototype.getTri = function(aColonneDeTri, aGenreTri) {};
        ObjetDonneesListe.prototype.GetVisible = function(D) {
            return true;
        };
        ObjetDonneesListe.prototype.GetValeur = function(I, D, aParams) {
            if (MethodesObjet.isFunction(this.options.getValeur)) {
                return this.options.getValeur(aParams);
            }
            return D ? D.GetLibelle() : '';
        };
        ObjetDonneesListe.prototype.GetValeurParDefaut = function(aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.getValeurPourTri = function(aColonne, aArticle) {
            return this.GetValeur(aColonne, aArticle, this.__getParams(aColonne, -1, {
                surTri: true,
                article: aArticle
            }));
        };
        ObjetDonneesListe.prototype.GetValeurPourAffichage = function(aParams) {
            return this.GetValeur(aParams.colonne, aParams.article, aParams);
        };
        ObjetDonneesListe.prototype.getHintHtmlForce = function(aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.getHintForce = function(aParams, I, D) {
            return '';
        };
        ObjetDonneesListe.prototype.GetTypeValeur = function(aParams, I, D) {
            return this.ETypeCellule.Texte;
        };
        ObjetDonneesListe.prototype.GetTailleTexteMax = function(aParams) {
            return 0;
        };
        ObjetDonneesListe.prototype.avecTrimSurEdition = function(aParams) {
            return this.options.avecTrimSurEdition;
        };
        ObjetDonneesListe.prototype.autoriserChaineVideSurEdition = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.GetCouleurCellule = function(aParams, aColonne, aArticle, aCouleurCellule) {};
        ObjetDonneesListe.prototype.getCouleurCelluleSelection = function(aParams) {
            return GCouleur.selection;
        };
        ObjetDonneesListe.prototype.getClass = function(aParams, I, D) {
            return '';
        };
        ObjetDonneesListe.prototype.getClassCelluleConteneur = function(aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.getStyle = function(aParams, I, D) {
            return '';
        };
        ObjetDonneesListe.prototype.alignVCenter = function(aParams) {
            return this.options.alignVCenter;
        };
        ObjetDonneesListe.prototype.getPadding = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.getNiveauDeploiement = function(aParams) {
            return 1;
        };
        ObjetDonneesListe.prototype.getColonneDeFusion = function(aParamsCellule) {
            return null;
        };
        ObjetDonneesListe.prototype.fusionCelluleAvecColonnePrecedente = function(aParams, aColonne, aArticle) {
            return false;
        };
        ObjetDonneesListe.prototype.fusionCelluleAvecLignePrecedente = function(aParamsCellule) {
            return false;
        };
        ObjetDonneesListe.prototype.avecBordureDroite = function(aParams) {
            return true;
        };
        ObjetDonneesListe.prototype.avecBordureBas = function(aParamsLigne) {
            return true;
        };
        ObjetDonneesListe.prototype.avecBordureHaut = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.initialiserObjetGraphique = function(I, D, aInstance) {
            return null;
        };
        ObjetDonneesListe.prototype.setDonneesObjetGraphique = function(I, D, aInstance) {
            return null;
        };
        ObjetDonneesListe.prototype.AvecMultiSelection = function() {
            return this.options.avecMultiSelection;
        };
        ObjetDonneesListe.prototype.avecMultiSelectionSurCtrl = function() {
            return this.options.avecMultiSelectionSurCtrl;
        };
        ObjetDonneesListe.prototype.avecMultiSelectionSurShift = function() {
            return this.options.avecMultiSelectionSurShift;
        };
        ObjetDonneesListe.prototype.estSelectionCibleMiroirDeSelectionSource = function(aParamsCelluleSource, aParamsCelluleCible) {
            return !!aParamsCelluleSource.article.GetNumero() && aParamsCelluleSource.article.GetNumero() === aParamsCelluleCible.article.GetNumero();
        };
        ObjetDonneesListe.prototype.getListeLignesTotal = function() {
            return null;
        };
        ObjetDonneesListe.prototype.getContenuTotal = function(aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.getTypeCelluleTotal = function(aParams) {
            return ObjetDonneesListe.typeCelluleTotal.defaut;
        };
        ObjetDonneesListe.prototype.getStyleTotal = function(aParams) {
            switch (aParams.typeCellule) {
                case ObjetDonneesListe.typeCelluleTotal.defaut:
                    return GStyle.composeCouleurFond(GCouleur.liste.total.fond) + GStyle.composeCouleurTexte(GCouleur.liste.total.texte);
                case ObjetDonneesListe.typeCelluleTotal.fond:
                    return GStyle.composeCouleurTexte(GCouleur.liste.texte);
                case ObjetDonneesListe.typeCelluleTotal.editable:
                    return GStyle.composeCouleurFond(GCouleur.liste.editable.fond);
                default:
                    ;
            }
            return '';
        };
        ObjetDonneesListe.prototype.getClassTotal = function(aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.avecBordureTotalVisible = function(aParams) {
            return aParams.typeCellule !== ObjetDonneesListe.typeCelluleTotal.fond;
        };
        ObjetDonneesListe.prototype.getColonneDeFusionTotal = function(aParams) {
            return null;
        };
        ObjetDonneesListe.prototype.AvecEvenement_SelectionClickTotal = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.GetMessage_Doublon = function(aElement) {
            return aElement && aElement.GetLibelle() ? GTraductions.getValeur('liste.doublonNom', [aElement.GetLibelle()]) : GTraductions.getValeur('liste.doublon');
        };
        ObjetDonneesListe.prototype.GetMessage_Creation_Impossible = function(aErreur) {
            return GTraductions.getValeur('liste.creationImpossible');
        };
        ObjetDonneesListe.prototype.GetMessage_Edition_Impossible = function(I, D, aErreur) {
            return GTraductions.getValeur('liste.editionImpossible');
        };
        ObjetDonneesListe.prototype.GetMessage_Edition_Confirmation = function(I, D, aParams) {
            return '';
        };
        ObjetDonneesListe.prototype.GetMessage_Suppression_Impossible = function(D, aListeSelections) {
            return GTraductions.getValeur('liste.suppressionImpossible');
        };
        ObjetDonneesListe.prototype.GetMessage_Suppression_Confirmation = function(D, aListeSelections) {
            return GTraductions.getValeur('liste.suppressionSelection');
        };
        ObjetDonneesListe.prototype.GetMessage_TailleMaximaleSaisie = function(aParams) {
            return GTraductions.getValeur('liste.tailleMaxSaisie');
        };
        ObjetDonneesListe.prototype.editionRefusee = function(aParams) {
            var lMessageRefus = this.getMessage_EditionRefusee(aParams.ligne, aParams.colonne, aParams.article);
            if (lMessageRefus) {
                GApplication.getMessage().afficher({
                    titre: lMessageRefus.titre || '',
                    message: lMessageRefus.message || lMessageRefus
                });
                return true;
            }
            return false;
        };
        ObjetDonneesListe.prototype.getMessage_EditionRefusee = function(aLigne, aColonne, D) {
            return '';
        };
        ObjetDonneesListe.prototype.remplirMenuContextuel = function(aParametres) {
            if (!aParametres.menuContextuel) {
                return;
            }
            if (aParametres.surFondListe) {
                return;
            }
            var lAvecCommandeActive = false,
                lCommande;
            if (aParametres.avecCreation) {
                lCommande = aParametres.menuContextuel.AddCommande(EGenreCommandeMenu.Creation, GTraductions.getValeur('liste.creer'), !aParametres.nonEditable);
                if (lCommande.actif) {
                    lAvecCommandeActive = true;
                }
            }
            lCommande = aParametres.menuContextuel.AddCommande(EGenreCommandeMenu.Edition, GTraductions.getValeur('liste.modifier'), !aParametres.nonEditable && (!aParametres.listeSelection || aParametres.listeSelection.GetNbrElements() <= 1) && this.AvecEdition(aParametres.colonne, aParametres.article, aParametres));
            if (lCommande.actif) {
                lAvecCommandeActive = true;
            }
            lCommande = aParametres.menuContextuel.AddCommande(EGenreCommandeMenu.Suppression, GTraductions.getValeur('liste.supprimer'), !aParametres.nonEditable && aParametres && aParametres.avecSuppression && this._AvecSuppression(aParametres));
            if (lCommande.actif) {
                lAvecCommandeActive = true;
            }
            return lAvecCommandeActive;
        };
        ObjetDonneesListe.prototype.getListeSupprimables = function(aListeSelections, aParamsCellule) {
            var lListe = new ObjetListeElements();
            aListeSelections.parcourir(function(aElement) {
                if (this.AvecSuppression(aElement, null, aParamsCellule)) {
                    lListe.AddElement(aElement);
                }
            }, this);
            return lListe;
        };
        ObjetDonneesListe.prototype.initialisationObjetContextuel = function(aParametres) {
            if (!aParametres.menuContextuel) {
                return;
            }
            var lAvecCommandeActive = this.remplirMenuContextuel(aParametres);
            if (lAvecCommandeActive !== false) {
                aParametres.menuContextuel.SetDonnees(aParametres.id);
            }
        };
        ObjetDonneesListe.prototype.evenementMenuContextuel = function(aParametres) {
            return false;
        };
        ObjetDonneesListe.prototype.EnModification = function(I) {
            return true;
        };
        ObjetDonneesListe.prototype.getControleCaracteresInput = function(aParams) {
            return null;
        };
        ObjetDonneesListe.prototype._AvecSelection = function(I, J) {
            return this.AvecSelection(I, this.Donnees.GetElement(J));
        };
        ObjetDonneesListe.prototype._avecDeselection = function(aLigne, aColonne) {
            return this.avecDeselection(aLigne, aColonne, this.Donnees.GetElement(aLigne));
        };
        ObjetDonneesListe.prototype._AvecSuppression = function(aParams) {
            if (aParams.listeSelection && aParams.listeSelection.GetNbrElements() > 0) {
                var lAvecSuppression = false;
                aParams.listeSelection.parcourir(function(aElement) {
                    if (this.AvecSuppression(aElement, null, aParams)) {
                        lAvecSuppression = true;
                        return false;
                    }
                }, this);
                return lAvecSuppression;
            }
            return this.AvecSuppression(aParams.article, aParams.listeSelection, aParams);
        };
        ObjetDonneesListe.prototype._SurSelectionLigne = function(J, aSelectionner) {
            return this.SurSelectionLigne(J, this.Donnees.GetElement(J), aSelectionner);
        };
        ObjetDonneesListe.prototype._SurSelection = function(I, J, aSelectionner) {
            return this.SurSelection(I, this.Donnees.GetElement(J), I, aSelectionner);
        };
        ObjetDonneesListe.prototype._GetTailleTexteMax = function(aParams) {
            switch (this.GetTypeValeur(aParams, aParams.colonne, aParams.article)) {
                case this.ETypeCellule.Texte:
                case this.ETypeCellule.ZoneTexte:
                    return this.GetTailleTexteMax(aParams);
                default:
                    return 0;
            }
        };
        ObjetDonneesListe.prototype.estUnDeploiement = function(aParams) {
            return aParams && aParams.article && aParams.article.estUnDeploiement;
        };
        ObjetDonneesListe.prototype._estDeploye = function(J) {
            return this.Donnees.GetElement(J).estDeploye;
        };
        ObjetDonneesListe.prototype._initialiserObjetGraphique = function(I, J, aInstance) {
            return this.initialiserObjetGraphique(I, this.Donnees.GetElement(J), aInstance);
        };
        ObjetDonneesListe.prototype._setDonneesObjetGraphique = function(I, J, aInstance) {
            return this.setDonneesObjetGraphique(I, this.Donnees.GetElement(J), aInstance);
        };
        ObjetDonneesListe.prototype.GetIndice = function(ADonnee) {
            for (var J = 0; J < this.GetNbrLignes(); J++) {
                if (this.Donnees.GetElement(J) === ADonnee) {
                    return J;
                }
            }
            return -1;
        };
        ObjetDonneesListe.prototype.GetMessage = function() {
            return this.Message;
        };
        ObjetDonneesListe.prototype._GetValeur = function(aParams) {
            var LDonnee = aParams.ligne === null || aParams.ligne === undefined ? null : this.Donnees.GetElement(aParams.ligne);
            var LValeur = aParams.ligne === null || aParams.ligne === undefined ? this.GetValeurParDefaut(aParams) : this.GetValeur(aParams.colonne, LDonnee, aParams);
            switch (this.GetTypeValeur(aParams, aParams.colonne, LDonnee)) {
                case this.ETypeCellule.Texte:
                    return LValeur;
                case this.ETypeCellule.ZoneTexte:
                    return LValeur;
                case this.ETypeCellule.Html:
                    return LValeur;
                case this.ETypeCellule.Date:
                case this.ETypeCellule.DateCalendrier:
                    return this.getChaineDeDate(LValeur, aParams);
                case this.ETypeCellule.Coche:
                    return LValeur;
                case this.ETypeCellule.CocheDeploiement:
                    return '';
                case this.ETypeCellule.Image:
                    return LValeur;
                case this.ETypeCellule.HeureMinute:
                    if (MethodesObjet.isDate(LValeur)) {
                        return GDate.FormatDate(LValeur, '%hh%sh%mm');
                    };
                    return '';
                case this.ETypeCellule.Note:
                    var lOptionsNote = this.getOptionsNote(aParams);
                    if (!LValeur) {
                        return aParams.surEdition ? null : lOptionsNote && lOptionsNote.texteSiVide ? lOptionsNote.texteSiVide : '';
                    }
                    if (LValeur instanceof TypeNote) {
                        if (aParams.surEdition) {
                            return LValeur;
                        }
                        var lLibelle = lOptionsNote && !lOptionsNote.afficherAvecVirgule ? LValeur.getNoteSansDecimaleForcee() : LValeur.getNote();
                        if (lOptionsNote && lOptionsNote.avecParenthese) {
                            lLibelle = '(' + lLibelle + ')';
                        }
                        return lLibelle;
                    };
            }
            return LValeur;
        };
        ObjetDonneesListe.prototype._GetContenuAffichage = function(aParams) {
            var lContenu = {};
            lContenu.valeur = this._GetValeur(aParams);
            lContenu.title = '';
            if (!this.enImpression) {
                var lHintForce = this.getHintHtmlForce(aParams);
                if (lHintForce) {
                    lContenu.titleHtml = lHintForce;
                } else {
                    lHintForce = this.getHintForce(aParams, aParams.colonne, aParams.article);
                    if (lHintForce) {
                        lContenu.title = lHintForce;
                    }
                }
            }
            if (aParams.avecContenuTronque) {
                switch (aParams.typeValeur) {
                    case ObjetDonneesListe.ETypeCellule.Texte:
                    case ObjetDonneesListe.ETypeCellule.ZoneTexte: {
                        var lChaineAffichage = this.GetValeurPourAffichage(aParams);
                        lContenu.valeur = lChaineAffichage;
                        if (!this.enImpression && !lContenu.titleHtml && !lContenu.title) {
                            lContenu.attrOverflow = this.options.avecEllipsisContenuTronque ? 'ie-ellipsis' : 'ie-hintoverflow';
                        }
                    }
                }
            }
            lContenu.valeur = GChaine.AvecEspaceSiVide(lContenu.valeur + '');
            if (aParams.typeValeur !== ObjetDonneesListe.ETypeCellule.Html) {
                lContenu.valeur = lContenu.valeur.replace(/\r\n/g, '<br>').replace(/\n/g, '<br>');
            }
            return lContenu;
        };
        ObjetDonneesListe.prototype.getOptionsNote = function(aParams) {
            return {
                afficherAvecVirgule: true,
                hintSurErreur: false
            };
        };
        ObjetDonneesListe.prototype.getValeurPourParsing = function(aParams) {
            return this._GetValeur(aParams);
        };
        ObjetDonneesListe.prototype.getChaineDeDate = function(aDate, aParams) {
            return (MethodesObjet.isDate(aDate)) ? GDate.FormatDate(aDate, '%JJ/%MM/%AA') : '';
        };
        ObjetDonneesListe.prototype.SetValeur = function(aParams) {
            var LDonnee = this.Donnees.GetElement(aParams.ligne);
            switch (this.GetTypeValeur(aParams, aParams.colonne, LDonnee)) {
                case this.ETypeCellule.Texte:
                case this.ETypeCellule.ZoneTexte:
                case this.ETypeCellule.Html:
                    return aParams.valeur;
                case this.ETypeCellule.Date:
                case this.ETypeCellule.DateCalendrier:
                    if (aParams.valeur === null || aParams.valeur === undefined) {
                        return '';
                    }
                    var LValeur = aParams.valeur.split('/');
                    if (LValeur[2].length === 2) {
                        LValeur[2] = '20' + LValeur[2];
                    }
                    var LDate = new Date(LValeur[2], LValeur[1] - 1, LValeur[0]);
                    if (!isNaN(LDate) && (LValeur[0].charAt(0) === '0')) {
                        LValeur[0] = LValeur[0].charAt(1);
                    }
                    return isNaN(LDate) || !((LDate.getFullYear() === parseInt(LValeur[2])) && (LDate.getMonth() === parseInt(LValeur[1] - 1)) && (LDate.getDate() === parseInt(LValeur[0]))) ? null : LDate;
                case this.ETypeCellule.Coche:
                    var lValeur = this.GetValeur(aParams.colonne, LDonnee, aParams);
                    if (lValeur === this.EGenreCoche.Verte) {
                        return this.EGenreCoche.Aucune;
                    }
                    if (lValeur === this.EGenreCoche.Grise) {
                        return this.EGenreCoche.Verte;
                    }
                    if (lValeur === this.EGenreCoche.Aucune || lValeur === undefined) {
                        return this.EGenreCoche.Verte;
                    }
                    return this.EGenreCoche.Aucune;
                case this.ETypeCellule.HeureMinute:
                    var lHeureMinute = GDate.parseHeureMinute(aParams.valeur);
                    return lHeureMinute && lHeureMinute.ok ? lHeureMinute : null;
            }
            return aParams.valeur;
        };
        ObjetDonneesListe.prototype.GetMessage_Format = function(aParams) {
            switch (this.GetTypeValeur(aParams, aParams.colonne, aParams.article)) {
                case this.ETypeCellule.Date:
                case this.ETypeCellule.DateCalendrier:
                    return GTraductions.getValeur('liste.erreurDate');
                case this.ETypeCellule.HeureMinute:
                    var lBorneDebut = '0' + GTraductions.getValeur('date.separateurHeure') + '00',
                        lBorneFin = '24' + GTraductions.getValeur('date.separateurHeure') + '00';
                    return GChaine.Format(GTraductions.getValeur('liste.erreurHeureMinute'), [lBorneDebut, lBorneFin]);
            }
            return null;
        };
        ObjetDonneesListe.prototype.EstunDoublon = function(ADonnee) {
            if (this._indexsUnique && this._indexsUnique.existeIndex()) {
                var J, lNb, LDonnee;
                for (J = 0, lNb = this.GetNbrLignes(); J < lNb; J++) {
                    LDonnee = this.Donnees.GetElement(J);
                    if ((LDonnee !== ADonnee) && (LDonnee.Etat !== EGenreEtat.Suppression)) {
                        if (this._indexsUnique.estDoublon(ADonnee, LDonnee)) {
                            return true;
                        }
                    }
                }
            }
            return false;
        };
        ObjetDonneesListe.prototype._SurCreation = function(AListeValeurs, ALigneCreation, aParams) {
            function _creerElement() {
                var LDonnee = new ObjetElement();
                LDonnee.Numero = ObjetElement.getNumeroCreation();
                return LDonnee;
            }

            function _ajouterElement(aElement, aLigne) {
                if (!this.EstunDoublon(aElement)) {
                    aElement.SetEtat(EGenreEtat.Creation);
                    this.Donnees.AddElement(aElement);
                    this.trier();
                    aLigne = this.GetIndice(aElement);
                } else {
                    this.Message = this.GetMessage_Doublon(aElement);
                }
                return aLigne;
            }
            this.Message = null;
            var J = -1;
            var LErreur_Format = -1;
            var LListeValeurs = [],
                lParams;
            LListeValeurs[-1] = AListeValeurs[-1];
            LListeValeurs.data = AListeValeurs.data;
            for (var I = 0; I < AListeValeurs.length; I++) {
                if ((AListeValeurs[I] !== null && AListeValeurs[I] !== undefined)) {
                    lParams = Object.assign(aParams, {
                        colonne: I,
                        ligne: -1,
                        valeur: AListeValeurs[I]
                    });
                    LListeValeurs[I] = this.SetValeur(lParams);
                    if (LListeValeurs[I] === null || LListeValeurs[I] === undefined) {
                        LErreur_Format = I;
                    }
                }
            }
            if (LErreur_Format === -1) {
                var lAvecCreationDynamique = this.avecCreationElementsDynamique(LListeValeurs, ALigneCreation),
                    lDonneeCreation;
                if (lAvecCreationDynamique) {
                    lDonneeCreation = new ObjetListeElements();
                } else {
                    lDonneeCreation = _creerElement();
                }
                var LErreur = this.SurCreation(lDonneeCreation, LListeValeurs, ALigneCreation);
                if (LErreur === null || LErreur === undefined) {
                    if (lAvecCreationDynamique) {
                        if (lDonneeCreation.GetNbrElements() === 0) {
                            this.Message = this.GetMessage_Creation_Impossible(LErreur);
                        } else {
                            lDonneeCreation.parcourir(function(aElement) {
                                J = _ajouterElement.call(this, aElement, J);
                            }, this);
                        }
                    } else {
                        J = _ajouterElement.call(this, lDonneeCreation, J);
                    }
                } else {
                    this.Message = this.GetMessage_Creation_Impossible(LErreur);
                }
            } else {
                lParams = this.__getParams(LErreur_Format, J);
                this.Message = this.GetMessage_Format(Object.assign(aParams, lParams));
            }
            return J;
        };
        ObjetDonneesListe.prototype._SurEdition = function(aParams) {
            this.Message = null;
            var LValeur = this.SetValeur(aParams);
            if ((LValeur !== null && LValeur !== undefined)) {
                var LDonnee = this.Donnees.GetElement(aParams.ligne);
                var LValeurPrecedente = this.GetValeur(aParams.colonne, LDonnee, aParams);
                var LErreur = this.SurEdition(aParams, aParams.colonne, LDonnee, LValeur);
                if (LErreur === null || LErreur === undefined) {
                    if (!this.EstunDoublon(LDonnee)) {
                        if (this.EnModification(aParams.colonne)) {
                            LDonnee.SetEtat(this.GetEtatSurEdition(aParams, LDonnee));
                        }
                        this.trier();
                        aParams.ligne = this.GetIndice(LDonnee);
                    } else {
                        this.Message = this.GetMessage_Doublon(LDonnee);
                        aParams.valeur = LValeurPrecedente;
                        LDonnee = this.SurEdition(aParams, aParams.colonne, LDonnee, LValeurPrecedente);
                    }
                } else {
                    this.Message = this.GetMessage_Edition_Impossible(aParams.colonne, LDonnee, LErreur);
                    aParams.valeur = LValeurPrecedente;
                    this.SurEdition(aParams, aParams.colonne, LDonnee, LValeurPrecedente);
                }
            } else {
                this.Message = this.GetMessage_Format(aParams);
            }
            return aParams.ligne;
        };
        ObjetDonneesListe.prototype._Edition_Confirmation = function(aParams) {
            this.Message = null;
            if (this.Edition_Confirmation(aParams)) {
                this.Message = this.GetMessage_Edition_Confirmation(aParams.article, aParams);
                return true;
            }
        };
        ObjetDonneesListe.prototype._SurSuppression = function(J, aListeSuppressions) {
            if (aListeSuppressions && aListeSuppressions.parcourir) {
                aListeSuppressions.parcourir(function(aElement) {
                    this.SurSuppression(aElement);
                }.bind(this));
            } else {
                var LDonnee = this.Donnees.GetElement(J);
                this.SurSuppression(LDonnee);
            }
            this.trier();
            return -1;
        };
        ObjetDonneesListe.prototype._Suppression_Impossible = function(J, aListeSelections) {
            this.Message = null;
            var LDonnee = this.Donnees.GetElement(J);
            if (this.Suppression_Impossible(LDonnee, aListeSelections)) {
                this.Message = this.GetMessage_Suppression_Impossible(LDonnee, aListeSelections);
                return true;
            }
        };
        ObjetDonneesListe.prototype._Suppression_Confirmation = function(J, aListeSelections) {
            this.Message = null;
            var LDonnee = this.Donnees.GetElement(J);
            if (this.Suppression_Confirmation(LDonnee, aListeSelections)) {
                this.Message = this.GetMessage_Suppression_Confirmation(LDonnee, aListeSelections);
                return !!this.Message;
            }
        };

        function _estDonneesVisible(aDonnees) {
            if (!aDonnees) {
                return false;
            }
            if (aDonnees.pere && this.AvecDeploiement() && (aDonnees.pere.estDeploye === false || !_estDonneesVisible.call(this, aDonnees.pere))) {
                return false;
            }
            if (aDonnees.Etat === EGenreEtat.Suppression || !this.GetVisible(aDonnees)) {
                return false;
            }
            return true;
        }
        ObjetDonneesListe.prototype.estVisible = function(J) {
            return _estDonneesVisible.call(this, this.Donnees.GetElement(J));
        };
        ObjetDonneesListe.prototype.trier = function() {
            if (this.AvecTri() && this.Donnees) {
                var lColonne = this.triCourant ? this.triCourant.colonne.length === 1 ? this.triCourant.colonne[0] : this.triCourant.colonne : null,
                    lGenre = this.triCourant ? this.triCourant.genre.length === 1 ? this.triCourant.genre[0] : this.triCourant.genre : null,
                    lTri = this.getTri(lColonne, lGenre);
                if (lTri) {
                    this.Donnees.setTri(lTri);
                }
                this.Donnees.trier();
            }
        };
        ObjetDonneesListe.prototype.GetNbrLignes = function() {
            return this.Donnees ? this.Donnees.GetNbrElements() : 0;
        };
        ObjetDonneesListe.prototype.creerIndexUnique = function(aChamps) {
            if (!this._indexsUnique) {
                this._indexsUnique = new ObjetIndexsUnique();
            }
            this._indexsUnique.ajouterIndex(aChamps);
        };
        ObjetDonneesListe.prototype.getEtatCocheSelonFils = function(aElementPere, aParams) {
            var lEtat = ObjetDonneesListe.EGenreCoche.Aucune,
                lInit = false;
            this.Donnees.parcourir(function(aElement, aIndex) {
                if (((!aElementPere && !aElement.pere) || aElement.pere === aElementPere) && this.GetVisible(aElement)) {
                    var lParams = Object.assign({}, aParams, {
                        ligne: aIndex,
                        article: aElement
                    });
                    if (this.AvecEdition(lParams.colonne, lParams.article, lParams)) {
                        if (aElement.estUnDeploiement) {
                            var lEtatFils = this.getEtatCocheSelonFils(aElement, lParams);
                            if (lEtatFils === ObjetDonneesListe.EGenreCoche.Verte && lEtat === ObjetDonneesListe.EGenreCoche.Aucune) {
                                lEtat = lInit ? ObjetDonneesListe.EGenreCoche.Grise : ObjetDonneesListe.EGenreCoche.Verte;
                            } else if (lEtatFils === ObjetDonneesListe.EGenreCoche.Grise) {
                                lEtat = ObjetDonneesListe.EGenreCoche.Grise;
                            } else if (lEtatFils === ObjetDonneesListe.EGenreCoche.Aucune && lEtat === ObjetDonneesListe.EGenreCoche.Verte) {
                                lEtat = ObjetDonneesListe.EGenreCoche.Grise;
                            }
                        } else {
                            var lValeur = this._GetValeur(lParams);
                            if ((!lValeur || lValeur === ObjetDonneesListe.EGenreCoche.Aucune) && lEtat === ObjetDonneesListe.EGenreCoche.Verte) {
                                lEtat = ObjetDonneesListe.EGenreCoche.Grise;
                            }
                            if ((lValeur === true || lValeur === ObjetDonneesListe.EGenreCoche.Verte) && lEtat === ObjetDonneesListe.EGenreCoche.Aucune) {
                                lEtat = lInit ? ObjetDonneesListe.EGenreCoche.Grise : ObjetDonneesListe.EGenreCoche.Verte;
                            }
                        }
                        if (lEtat === ObjetDonneesListe.EGenreCoche.Grise) {
                            return false;
                        }
                        lInit = true;
                    }
                }
            }.bind(this));
            return lEtat;
        };
        ObjetDonneesListe.prototype.getTableauLignesModifieesCocheTitre = function(aColonne, aValeur) {
            var T = [],
                i, lNb = this.Donnees.GetNbrElements();
            for (i = 0; i < lNb; i++) {
                if (this.GetVisible(this.Donnees.GetElement(i))) {
                    T.push(i);
                }
            }
            return T;
        };
        ObjetDonneesListe.prototype.surEditionCocheTitre = function(aListeParamsCellule, aValeur) {
            if (!!aListeParamsCellule) {
                var lErreur;
                for (var i = 0; i < aListeParamsCellule.length; i++) {
                    lErreur = this.SurEdition(aListeParamsCellule[i], aListeParamsCellule[i].colonne, aListeParamsCellule[i].article, aValeur);
                    if (lErreur === null || lErreur === undefined) {
                        if (this.EnModification(aListeParamsCellule[i].colonne)) {
                            aListeParamsCellule[i].article.SetEtat(this.GetEtatSurEdition(aListeParamsCellule[i]));
                        }
                    }
                }
            }
            return null;
        };
        ObjetDonneesListe.prototype.rechercheTexte_forcerLignePrecSuivVisible = function(aParamsLigneVisible, aParamsLignePrecSuivCachee) {
            return false;
        };
        ObjetDonneesListe.prototype.getId = function(aNumeroColonne) {
            return this.__getIdsColonnes()[aNumeroColonne];
        };
        ObjetDonneesListe.prototype.getNumeroColonneDId = function(aId) {
            return this.__getIdsColonnes().indexOf(aId);
        };
        ObjetDonneesListe.prototype.avecVoileBleuHover = function(aParams) {
            return this.options.avecVoileBleuHover;
        };
        ObjetDonneesListe.prototype.estConcerneParVoileBleuHover = function(aParams, aParamsCelluleHover) {
            if (aParams.ligne < 0) {
                return false;
            }
            if (this.selectionParCellule(aParamsCelluleHover.colonne, aParamsCelluleHover.article)) {
                return aParamsCelluleHover.ligne === aParams.ligne && aParamsCelluleHover.colonne === aParams.colonne;
            }
            if (aParams.ligne >= 0 && aParams.ligne === aParamsCelluleHover.ligne) {
                return true;
            }
            if (this.options.avecMultiSelectionSurLigneFusion && aParams.ligne >= 0 && aParamsCelluleHover.ligne >= 0 && aParams.ligne !== aParamsCelluleHover.ligne) {
                var lFusionHover = this.lignesFusionParColonne[aParamsCelluleHover.colonne + '_' + aParamsCelluleHover.ligne];
                if (lFusionHover && lFusionHover.lignesCumuls && lFusionHover.lignesCumuls[aParams.ligne]) {
                    return true;
                }
                var lFusionCourant = this.lignesFusionParColonne[aParams.colonne + '_' + aParams.ligne];
                if (lFusionCourant && lFusionCourant.lignesCumuls && lFusionCourant.lignesCumuls[aParamsCelluleHover.ligne]) {
                    return true;
                }
            }
            return false;
        };
        ObjetDonneesListe.prototype.avecDessinHover = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.estConcerneParDessinHover = function(aParams, aParamsCelluleHover) {
            return false;
        };
        ObjetDonneesListe.prototype.construireHtmlHover = function(aParams) {
            if (!aParams.node) {
                return '';
            }
            var H = [];
            var lHeight = 22;
            var lWidthCorpsFleche = 10;
            var lWidthPointeFleche = 11;
            var lHeightCorpsFleche = 10;
            var lWidth = lWidthCorpsFleche + lWidthPointeFleche;
            var lCouleurBord = 'white';
            var lCouleur = GCouleur.selection.fond;
            var lStyle = '';
            switch (aParams.direction) {
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.droite:
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.gauche:
                    lStyle += 'top:' + Math.round(($(aParams.node).height() / 2 - lHeight / 2)) + 'px;';
                    break;
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.haut:
                    lStyle += 'top:0px;';
                    break;
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.bas:
                    lStyle += 'bottom:0px;';
                    break;
            }
            switch (aParams.direction) {
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.droite:
                    lStyle += 'left: -' + (lWidth + 1) + 'px;';
                    break;
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.gauche:
                    lStyle += 'right: -' + (lWidth + 1) + 'px;';
                    break;
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.haut:
                case ObjetDonneesListe.TypeDirectionElementSurvolCellule.bas:
                    lStyle += 'left:' + Math.round(($(aParams.node).width() / 2 - lWidth / 2)) + 'px;';
                    break;
            }
            H.push('<div class="' + aParams.classHover + ' dessinHoverListe_' + aParams.direction + '" style="', lStyle, '">');
            H.push('<svg xmlns="http://www.w3.org/2000/svg" width="', lWidth + 1, '" height="', lHeight + 1, '">', GChaine.Format('<line x1="0" y1="%0:s" x2="%1:s" y2="%0:s" stroke="%3:s" stroke-width="%2:s" />', [lHeight / 2, lWidthCorpsFleche, lHeightCorpsFleche, lCouleurBord]), GChaine.Format('<polygon points="%2:s 0, %3:s %1:s, %2:s %0:s" fill="%4:s" stroke-width="1" stroke="%5:s"/>', [lHeight, lHeight / 2, lWidthCorpsFleche, lWidth, lCouleur, lCouleurBord]), GChaine.Format('<line x1="1" y1="%0:s" x2="%1:s" y2="%0:s" stroke="%3:s" stroke-width="%2:s" />', [lHeight / 2, lWidthCorpsFleche + 1, lHeightCorpsFleche - 2, lCouleur]), '</svg>');
            H.push('</div>');
            if (aParams.direction === ObjetDonneesListe.TypeDirectionElementSurvolCellule.droite || aParams.direction === ObjetDonneesListe.TypeDirectionElementSurvolCellule.gauche) {
                H.push('<div class="' + aParams.classHover + ' dessinHoverListe_cadre"></div>');
            }
            return H.join('');
        };
        ObjetDonneesListe.prototype.estCelluleCopie = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.surCopier = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.surColler = function(aParams) {
            return false;
        };
        ObjetDonneesListe.prototype.getHauteurMinCellule = function(aParams) {
            return this.options.hauteurMinCellule;
        };
        ObjetDonneesListe.prototype.getHauteurMinContenuCellule = function(aParams) {
            return this.options.hauteurMinContenuCellule;
        };
        module.exports = ObjetDonneesListe;
    },
    fn: "objetdonneesliste.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeFusionTitreListe = {
            FusionGauche: 1,
            FusionHaute: 2
        };
        module.exports = TypeFusionTitreListe;
    },
    fn: "typefusiontitreliste.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreEvenementListe = {
            Selection: 0,
            ModificationSelection: 'ModificationSelection',
            Creation: 1,
            Edition: 2,
            Suppression: 3,
            Deploiement: 4,
            ApresCreation: 5,
            ApresEdition: 6,
            ApresSuppression: 7,
            SelectionClick: 8,
            ApresErreurCreation: 9,
            SelectionDblClick: 10,
            KeyPressListe: 11,
            KeyUpListe: 12,
            SelectionClickTotal: 13
        };
        module.exports = EGenreEvenementListe;
    },
    fn: "enumere_evenementliste.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var IEHtml = require('IEHtml.js');
        require('DeclarationJQueryUI.js');
        var GUID = require('GUID.js');
        var GPosition = require('GPosition.js');
        var GTraductions = require('ObjetTraduction.js');
        require('Produit/Css/IEHtml.DraggableDroppable.css');
        IEHtml.addAttribut('ie-draggable', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
            var lNom = aAttributValue,
                lInfos = aOutils.getAccesParametres(lNom, aContexteCourant);
            if (!lNom || !aContexteCourant.controleur || !lInfos.estFonction) {
                return true;
            }
            $(aContexteCourant.node).draggable(lInfos.callback());
            aOutils.addCommentaireDebug(aContexteCourant.node, 'ie-draggable="' + lNom + '"');
            return true;
        });
        IEHtml.addAttribut('ie-droppable', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
            var lNom = aAttributValue,
                lInfos = aOutils.getAccesParametres(lNom, aContexteCourant);
            if (!lNom || !aContexteCourant.controleur || !lInfos.estFonction) {
                return true;
            }
            $(aContexteCourant.node).droppable(lInfos.callback());
            aOutils.addCommentaireDebug(aContexteCourant.node, 'ie-droppable="' + lNom + '"');
            return true;
        });
        var uGUIDFantome = GUID.getId();
        IEHtml.addAttribut('ie-draggablefantome', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
            var lNom = aAttributValue,
                lInfos = aOutils.getAccesParametres(lNom, aContexteCourant);
            if (!lNom || !aContexteCourant.controleur || !lInfos.estFonction) {
                return true;
            }
            var lParams = lInfos.callback();
            var lIdData = 'data_' + uGUIDFantome;
            if (!lParams || !lParams.start || !lParams.stop || !lParams.drag) {
                return true;
            }
            var lContainment = 'document';
            if (lParams.containment !== null && lParams.containment !== undefined) {
                lContainment = lParams.containment;
            }
            var lOptions = {
                helper: function() {
                    return $('<div id="' + uGUIDFantome + '" class="drag-row FantomeDraggable"></div>');
                },
                appendTo: '#' + GApplication.getIdConteneur(),
                containment: lContainment,
                zIndex: 1000000,
                cursorAt: {
                    top: 10,
                    left: 15
                },
                scroll: true,
                distance: 5,
                start: function() {
                    var lJFantome = $('#' + uGUIDFantome.escapeJQ());
                    var lData = {
                        drag: true,
                        jDraggable: lJFantome,
                        droppableOverOut: function(aSurOver, aDroppable) {
                            if (aSurOver) {
                                lData.droppableCourant = aDroppable;
                            } else if (lData.droppableCourant === aDroppable) {
                                lData.droppableCourant = null;
                                lData.getHtmlDetailsDraggable = null;
                            }
                            lData.controleurDraggable.$refreshSelf();
                        },
                        libelle: ''
                    };
                    lJFantome.data(lIdData, lData);
                    lParams.start({
                        node: this,
                        idFantome: uGUIDFantome,
                        jFantome: lJFantome,
                        data: lData
                    });
                    var lControleur = {
                        getHtmlFantome: function() {
                            var lHtml = lData.libelle || '';
                            var lSupp = '';
                            if (lData.getHtmlDetailsDraggable) {
                                lSupp = lData.getHtmlDetailsDraggable(lData);
                            } else if (lData.horsZoneSuppression) {
                                lSupp = '<i class="icon_remove" style="font-size:15px; color:red;"></i><label>' + GTraductions.getValeur('liste.supprimer') + '</label>';
                            }
                            return lHtml + (lSupp ? '<div class="draggable_details">' + lSupp + '</div>' : '');
                        }
                    };
                    lData.controleurDraggable = lControleur;
                    lJFantome.IEHtml('<div ie-html="getHtmlFantome"></div>', {
                        controleur: lControleur
                    });
                    lData.controleurDraggable.$refreshSelf();
                },
                stop: function(aEvent) {
                    var lIdZone = lParams.getIdZone ? lParams.getIdZone() : null;
                    var lJFantome = $('#' + uGUIDFantome.escapeJQ());
                    var lData = lJFantome.data(lIdData);
                    lParams.stop({
                        node: this,
                        idFantome: uGUIDFantome,
                        jFantome: lJFantome,
                        horsZone: lIdZone ? !GPosition.positionDansZone({
                            x: aEvent.pageX,
                            y: aEvent.pageY
                        }, lIdZone) : false,
                        data: lData
                    });
                    lData.controleurDraggable.$refreshSelf();
                },
                drag: function(aEvent) {
                    var lJFantome = $('#' + uGUIDFantome.escapeJQ()).css({
                        height: 'auto',
                        width: 'auto'
                    });
                    var lIdZone = lParams.getIdZone ? lParams.getIdZone() : null;
                    var lData = lJFantome.data(lIdData);
                    lParams.drag({
                        node: this,
                        idFantome: uGUIDFantome,
                        jFantome: lJFantome,
                        horsZone: lIdZone ? !GPosition.positionDansZone({
                            x: aEvent.pageX,
                            y: aEvent.pageY
                        }, lIdZone) : false,
                        data: lData
                    });
                    lData.controleurDraggable.$refreshSelf();
                }
            };
            $(aContexteCourant.node).draggable(lOptions);
            aOutils.addCommentaireDebug(aContexteCourant.node, 'ie-draggablefantome="' + lNom + '"');
            return true;
        });
        module.exports = IEHtml;
    },
    fn: "iehtml.draggabledroppable.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('produit/css/ClavierVirtuel.css');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var EGenreOrientationAffichage = require('enumere_orientationaffichage.js');
        var GUID = require('GUID.js');
        var GHtml = require('_ObjetHtml.js').GHtml;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var ETypeToucheClavier = {
            texte: 'texte',
            image: 'image'
        };
        var EGenreCurseurClavier = {
            selection: 'selection',
            fin: 'fin'
        };
        MethodesObjet.heritagePrototype(Clavier, Identite);

        function Clavier() {
            this.inheritedCreate(arguments);
            this.paramParDefaut = {
                orientation: EGenreOrientationAffichage.Horizontal,
                contexte: {
                    avec: true,
                    couleurFond: GCouleur.themeNeutre.moyen1
                },
                paveSaisie: {
                    couleurFond: GCouleur.themeNeutre.claire
                },
                evntSurClose: null,
                evntSurCloseStart: null
            };
            this.param = this.paramParDefaut;
            this.ids = {
                panelClavier: GUID.getId(),
                panelContexte: GUID.getId(),
                panelVisu: GUID.getId(),
                msgErreur: GUID.getId(),
                modaleClavier: GUID.getId()
            };
            this.dimensions = {
                hauteurContexte: 60,
                largeurZoneVisu: 80
            };
            this.strSaisieCourante = '';
            this.strValeurInit = '';
            this.indiceEcran = 0;
            this.curseur = EGenreCurseurClavier.selection;
        }
        Clavier.idsEnCours = {};
        Clavier.prototype.estCurseurClavier = function(aGenreCurseurClavier) {
            return (this.curseur === aGenreCurseurClavier);
        };
        Clavier.prototype.setCurseurClavier = function(aGenreCurseurClavier) {
            this.curseur = aGenreCurseurClavier;
        };
        Clavier.prototype.setOptions = function(aParam) {
            this.param = $.extend({}, this.paramParDefaut, aParam);
            this.strValeurInit = aParam.valeurInit;
            this.strSaisieCourante = aParam.valeurInit;
            this.evntSurClose = aParam.evntSurClose;
        };
        Clavier.prototype.getValeurInit = function() {
            return this.strValeurInit;
        };
        Clavier.prototype.reIntialiserValeur = function() {
            this.setStrSaisieCourante(this.getValeurInit());
            this.actualiserVisuSaisie();
            this.setCurseurClavier(EGenreCurseurClavier.selection);
        };
        Clavier.prototype.definirTouches = function() {
            return [];
        };
        Clavier.prototype.definirGrille = function() {
            return {
                nbLignes: 0,
                nbColonnes: 0,
                cells: []
            };
        };
        Clavier.prototype.dessinerContexte = function() {
            return '';
        };
        Clavier.prototype.surEvntTouche = function() {};
        Clavier.prototype.estToucheDouble = function() {
            return false;
        };
        Clavier.prototype.definirClavier = function() {
            this.listeTouches = this.definirTouches();
            this.grille = this.definirGrille();
        };
        Clavier.prototype.getHtmlClavier = function() {
            var H = [];
            var lHauteurContexte = this.dimensions.hauteurContexte;
            H.push('<div class="clavierVirtuel SansSelectionTexte">');
            H.push('<div class="TexteRouge EspaceGauche EspaceDroit" style="height:10px; background-color:', this.param.contexte.couleurFond, ';" id="', this.ids.msgErreur, '"></div>');
            H.push('<div class="NoWrap Espace" style="height:', lHauteurContexte, 'px; background-color:', this.param.contexte.couleurFond, ';"  >');
            H.push('<div style="height:100%; width:calc(100% - ', this.dimensions.largeurZoneVisu, 'px);" class="InlineBlock AlignementBas NoWrap" id="', this.ids.panelContexte, '">');
            H.push(this.dessinerContexte());
            H.push('</div>');
            H.push('<div style="height:100%; width:', this.dimensions.largeurZoneVisu, 'px; border-bottom-color: ', GCouleur.themeCouleur.foncee, ';" class="zoneVisuSaisie InlineBlock AlignementBas AlignementDroit NoWrap" id="', this.ids.panelVisu, '">');
            H.push(this.dessinerVisuSaisie());
            H.push('</div>');
            H.push('</div>');
            H.push('<div style="height:calc(100% - ', lHauteurContexte, 'px)" id="', this.ids.panelClavier, '">');
            H.push(this.dessinerClavier());
            H.push('</div>');
            H.push('</div>');
            return H.join('');
        };
        Clavier.prototype.fermer = function() {
            delete Clavier.idsEnCours[this.ids.modaleClavier];
            var $clavier = $('#' + this.ids.modaleClavier.escapeJQ());
            $clavier.remove();
            if ((this.evntSurClose !== null) && (this.evntSurClose !== undefined)) {
                this.evntSurClose();
            }
        };
        Clavier.prototype.afficher = function() {
            var lHtml = '<div id="' + this.ids.modaleClavier + '" class="modal bottom-sheet" style="max-height:100%">' + this.getHtmlClavier() + '</div>';
            var lDivPere = GHtml.getElement(GApplication.getIdConteneur());
            GHtml.addHtml(lDivPere, lHtml, {
                instance: this
            });
            this.openModaleClavier();
        };
        Clavier.prototype.openModaleClavier = function() {
            var lIdsEnCours = Object.keys(Clavier.idsEnCours);
            lIdsEnCours.forEach(function(aId) {
                var lInstanceObjetModaleCombo = M.Modal.getInstance($("#" + aId.escapeJQ()));
                if (lInstanceObjetModaleCombo && lInstanceObjetModaleCombo.isOpen) {
                    lInstanceObjetModaleCombo.options.outDuration = 0;
                    lInstanceObjetModaleCombo.close();
                }
            });
            var $objetModaleCombo = $("#" + this.ids.modaleClavier.escapeJQ());
            var lInstanceObjetModaleCombo = M.Modal.getInstance($objetModaleCombo);
            if (!lInstanceObjetModaleCombo) {
                M.Modal.init($objetModaleCombo, {
                    onCloseStart: function() {
                        if (MethodesObjet.isFunction(this.param.evntSurCloseStart)) {
                            this.param.evntSurCloseStart();
                        }
                    }.bind(this),
                    onCloseEnd: function() {
                        this.fermer();
                    }.bind(this)
                });
                lInstanceObjetModaleCombo = M.Modal.getInstance($objetModaleCombo);
            }
            Clavier.idsEnCours[this.ids.modaleClavier] = true;
            if (lIdsEnCours.length > 0) {
                lInstanceObjetModaleCombo.options.inDuration = 0;
            }
            lInstanceObjetModaleCombo.open();
        };
        Clavier.prototype.closeModaleClavier = function() {
            var lInstanceModale = M.Modal.getInstance($("#" + this.ids.modaleClavier.escapeJQ()));
            if (lInstanceModale && lInstanceModale.isOpen) {
                lInstanceModale.close();
            }
        };

        function _getToucheDeCell(aParam) {
            var lLigne = this.grille.cells[aParam.ligne];
            var lCell = lLigne[aParam.col];
            var lTouche = lCell;
            if (lCell !== null && lCell !== undefined) {
                if ($.isArray(lCell)) {
                    lTouche = lCell[aParam.ecran];
                } else {
                    lTouche = lCell;
                }
            }
            return lTouche;
        }
        Clavier.prototype.dessinerClavier = function() {
            var H = [];
            var lMarge = 5;
            H.push('<div class="paveNum" style="display:flex; flex-direction:column; justify-content:space-around; height:100%; background-color:', this.param.paveSaisie.couleurFond, '; padding:', lMarge, 'px;">');
            for (var lLigne = 0, lNbr = this.grille.nbLignes; lLigne < lNbr; lLigne++) {
                H.push('<div class="ligneClavierVirtuel" style="display:flex; flex-direction:row; justify-content:space-around; height:calc(100% / ', this.grille.nbLignes, ');">');
                for (var lCol = 0, lNbr2 = this.grille.nbColonnes; lCol < lNbr2; lCol++) {
                    var lTouche = _getToucheDeCell.call(this, {
                        ligne: lLigne,
                        col: lCol,
                        ecran: this.indiceEcran
                    });
                    if (lTouche !== null && lTouche !== undefined) {
                        H.push(lTouche.dessinerTouche({
                            estToucheDouble: this.estToucheDouble(lTouche),
                            nbColonnes: this.grille.nbColonnes,
                            marge: lMarge
                        }));
                    } else {
                        if (lTouche === null) {
                            H.push('<div style="background-color:transparent; margin:', lMarge, 'px; width:calc(100% / ', this.grille.nbColonnes, ');">&nbsp;</div>');
                        }
                    }
                }
                H.push('</div>');
            }
            H.push('</div>');
            return H.join('');
        };
        Clavier.prototype.actualiserMsgErreur = function(aMsg) {
            GHtml.setHtml(this.ids.msgErreur, aMsg, {
                instance: this
            });
        };
        Clavier.prototype.actualiserClavier = function() {
            GHtml.setHtml(this.ids.panelClavier, this.dessinerClavier(), {
                instance: this
            });
        };
        Clavier.prototype.getStrSaisieCourante = function() {
            return this.strSaisieCourante;
        };
        Clavier.prototype.setStrSaisieCourante = function(aValeur) {
            this.strSaisieCourante = '' + aValeur;
        };
        Clavier.prototype.viderSaisieCourante = function() {
            this.setStrSaisieCourante('');
        };
        Clavier.prototype.concatSaisieCourante = function(aValeur) {
            this.setStrSaisieCourante(this.strSaisieCourante + aValeur);
        };
        Clavier.prototype.dessinerVisuSaisie = function() {
            var H = [];
            H.push('<div class="InlineBlock AlignementBas SansSelectionTexte">');
            H.push(this.getStrSaisieCourante());
            H.push('</div>');
            H.push('<div style="height:100%" class="InlineBlock AlignementBas">&nbsp;</div>');
            return H.join('');
        };
        Clavier.prototype.actualiserVisuSaisie = function() {
            GHtml.setHtml(this.ids.panelVisu, this.dessinerVisuSaisie(), {
                instance: this
            });
        };
        Clavier.prototype.getIndiceEcran = function() {
            return this.indiceEcran;
        };
        Clavier.prototype.nbEcrans = function() {
            return 1;
        };
        Clavier.prototype.getLibelleToucheBascule = function() {
            return (this.indiceEcran + 1) + '/' + this.nbEcrans();
        };
        Clavier.prototype.basculerIndiceEcran = function() {
            this.indiceEcran++;
            var lNbrEcrans = this.nbEcrans();
            this.indiceEcran = this.indiceEcran % lNbrEcrans;
        };
        Clavier.prototype.basculerEcran = function(aParam) {
            this.basculerIndiceEcran();
            aParam.toucheBascule.setContenuTouche(this.getLibelleToucheBascule());
            this.actualiserClavier();
        };
        MethodesObjet.heritagePrototype(ToucheClavierVirtuel, Identite);

        function ToucheClavierVirtuel() {
            this.inheritedCreate(arguments);
        }
        ToucheClavierVirtuel.prototype.setDonnees = function(aParam) {
            this.contenu = {
                type: aParam.type,
                valeur: aParam.valeur,
                hint: aParam.hint || ''
            };
            var lAff = aParam.affichage;
            this.affichage = lAff;
            this.id = aParam.id;
            this.genreTouche = aParam.genreTouche;
        };
        ToucheClavierVirtuel.prototype.getValeur = function() {
            return this.contenu.valeur;
        };
        ToucheClavierVirtuel.prototype.setValeur = function(aValeur) {
            this.contenu.valeur = aValeur;
        };
        ToucheClavierVirtuel.prototype.getType = function() {
            return this.contenu.type;
        };
        ToucheClavierVirtuel.prototype.getHint = function() {
            return this.contenu.hint;
        };
        ToucheClavierVirtuel.prototype.evntSurTouche = function() {
            if (window.navigator && window.navigator.vibrate) {
                window.navigator.vibrate(20);
            }
            this.callback.appel({
                touche: this
            });
        };
        ToucheClavierVirtuel.prototype.dessinerTouche = function(aParam) {
            var H = [];
            var lMarge = aParam.marge;
            var lWitdh = aParam.estToucheDouble ? 'calc(((100% / ' + aParam.nbColonnes + ') + ' + lMarge + 'px) * 2 )' : 'calc(100% / ' + aParam.nbColonnes + ')';
            H.push('<div onclick="', this.Nom, '.evntSurTouche()" class="waves-effect NoWrap z-depth-1 toucheClavierVirtuel SansSelectionTexte ', this.affichage.css, ' ligneClavierVirtuel" style="margin:', lMarge, 'px; width:', lWitdh, ';">');
            H.push('<div id="', this.id, '" style="width:100%;" class="InlineBlock AlignementMilieuVertical AlignementMilieu contenuToucheClavier">');
            H.push(this.dessinerContenu());
            H.push('</div>');
            H.push('<div class="InlineBlock AlignementMilieuVertical" style="height:100%; width:0px;">&nbsp;</div>');
            H.push('</div>');
            return H.join('');
        };
        ToucheClavierVirtuel.prototype.dessinerContenu = function() {
            var H = [];
            var lValeur = this.getValeur();
            if (this.getType() === ETypeToucheClavier.image) {
                var lLabelWai = this.getHint();
                H.push('<ie-btnimage class="InlineBlock btnImageIcon ', lValeur, '" ', GObjetWAI.composeAttribut({
                    genre: EGenreAttribut.label,
                    valeur: lLabelWai
                }), '></ie-btnimage>');
            } else {
                H.push(lValeur);
            }
            return H.join('');
        };
        ToucheClavierVirtuel.prototype.setContenuTouche = function(aValeurContenu) {
            this.setValeur(aValeurContenu);
            GHtml.setHtml(this.id, this.dessinerContenu());
        };
        module.exports = {
            Clavier: Clavier,
            ToucheClavierVirtuel: ToucheClavierVirtuel,
            ETypeToucheClavier: ETypeToucheClavier,
            EGenreCurseurClavier: EGenreCurseurClavier
        };
    },
    fn: "claviervirtuel.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GUID = require('GUID.js');
        var EGenreAnnotation = require('Enumere_Annotation.js');
        var TypeNote = require('TypeNote.js');
        var Clavier = require('ClavierVirtuel.js').Clavier;
        var ToucheClavierVirtuel = require('ClavierVirtuel.js').ToucheClavierVirtuel;
        var ETypeToucheClavier = require('ClavierVirtuel.js').ETypeToucheClavier;
        var EGenreCurseurClavier = require('ClavierVirtuel.js').EGenreCurseurClavier;
        var GTraductions = require('ObjetTraduction.js');
        MethodesObjet.heritagePrototype(Clavier_SaisieNote, Clavier);

        function Clavier_SaisieNote() {
            this.inheritedCreate(arguments);
            this.idTouche = {
                valider: GUID.getId(),
                supprimer: GUID.getId(),
                chiffre: GUID.getId(),
                separateurDecimal: GUID.getId(),
                signeMoins: GUID.getId(),
                annotation: GUID.getId(),
                basculeEcran: GUID.getId()
            };
            this.options = {
                avecAnnotations: false,
                avecSeparateurDecimal: false,
                avecSigneMoins: false,
                grille: {
                    nbLignes: 0
                },
                htmlContexte: ''
            };
            this.param.evntSurCloseStart = function() {
                if (!this._surValidationNote) {
                    this.callback.appel(null);
                }
            }.bind(this);
            var lListeAnnotationsCompletes = getTabAnnotations();
            this.listeAnnotations = [];
            for (var i = 0; i < lListeAnnotationsCompletes.length; i++) {
                if (TypeNote.estAnnotationPermise(lListeAnnotationsCompletes[i])) {
                    this.listeAnnotations.push(lListeAnnotationsCompletes[i]);
                }
            }
            this.erreurAffichee = false;
        }
        Clavier_SaisieNote.prototype.setOptions = function(aOptions) {
            this.inherited('setOptions', aOptions.clavier);
            this.options = $.extend(this.options, aOptions.metier);
            this.options.methodeValidationNote = aOptions.methodeValidationNote;
            this.options.grille = aOptions.grille;
            this.definirClavier();
        };
        Clavier_SaisieNote.EGenreTouche = {
            annotation: 'annotation',
            numerique: 'numerique',
            action: 'action'
        };
        Clavier_SaisieNote.EGenreTouche.getInfosAffichage = function(aGenreTouche) {
            switch (aGenreTouche) {
                case Clavier_SaisieNote.EGenreTouche.annotation:
                    return {
                        css: 'toucheAnnot'
                    };
                case Clavier_SaisieNote.EGenreTouche.numerique:
                    return {
                        css: 'toucheNum'
                    };
                case Clavier_SaisieNote.EGenreTouche.action:
                    return {
                        css: 'toucheAction'
                    };
            }
        };
        Clavier_SaisieNote.EGenreTouche.getType = function(aGenreTouche) {
            switch (aGenreTouche) {
                case Clavier_SaisieNote.EGenreTouche.action:
                    return ETypeToucheClavier.image;
                default:
                    return ETypeToucheClavier.texte;
            }
        };

        function _getIdToucheChiffre(aChiffre) {
            return this.idTouche.chiffre + '_' + aChiffre;
        }

        function _estIdToucheChiffre(aId) {
            return aId.startsWith(this.idTouche.chiffre + '_');
        }

        function _getIdToucheAnnotation(aGenreAnnotation) {
            return this.idTouche.annotation + '_' + aGenreAnnotation;
        }

        function _estIdToucheAnnotation(aId) {
            return aId.startsWith(this.idTouche.annotation + '_');
        }

        function _getToucheParId(aParam) {
            var i, lNbr;
            for (i = 0, lNbr = this.listeTouches.length; i < lNbr; i++) {
                var lTouche = this.listeTouches[i];
                if (lTouche.id === aParam.id) {
                    return lTouche;
                }
            }
            return null;
        }

        function _newTouche(aParam) {
            var lTouche = Identite.creerInstance(ToucheClavierVirtuel, {
                pere: this,
                evenement: this.surEvntTouche.bind(this)
            });
            lTouche.setDonnees({
                type: Clavier_SaisieNote.EGenreTouche.getType(aParam.genreTouche),
                affichage: Clavier_SaisieNote.EGenreTouche.getInfosAffichage(aParam.genreTouche),
                valeur: aParam.valeur,
                hint: aParam.hint,
                genreTouche: aParam.genreTouche,
                id: aParam.id
            });
            return lTouche;
        }

        function _newTouche_Annotation(aParam) {
            var lParam = {
                genreTouche: Clavier_SaisieNote.EGenreTouche.annotation
            };
            return _newTouche.call(this, $.extend({}, lParam, aParam));
        }

        function _newTouche_Numerique(aParam) {
            var lParam = {
                genreTouche: Clavier_SaisieNote.EGenreTouche.numerique
            };
            return _newTouche.call(this, $.extend({}, lParam, aParam));
        }

        function _newTouche_Action(aParam) {
            var lParam = {
                genreTouche: Clavier_SaisieNote.EGenreTouche.action
            };
            return _newTouche.call(this, $.extend({}, lParam, aParam));
        }

        function getTabAnnotations() {
            return [
                EGenreAnnotation.absent, EGenreAnnotation.dispense, EGenreAnnotation.nonNote, EGenreAnnotation.nonRendu, EGenreAnnotation.inapte, EGenreAnnotation.absentZero, EGenreAnnotation.nonRenduZero, EGenreAnnotation.felicitations
            ];
        }

        function _estStrToucheAnnotation(aStr) {
            if (this.options.avecAnnotations) {
                var i, lNbr;
                var lNote = new TypeNote();
                for (i = 0, lNbr = this.listeAnnotations.length; i < lNbr; i++) {
                    var lGenreAnnotation = this.listeAnnotations[i];
                    if (lNote.getChaineAnnotationDeGenre(lGenreAnnotation) === aStr) {
                        return true;
                    }
                }
            }
            return false;
        }
        Clavier_SaisieNote.prototype.nbEcrans = function() {
            return this.options.avecAnnotations ? Math.ceil(this.listeAnnotations.length / this.options.grille.nbLignes) : 1;
        };
        Clavier_SaisieNote.prototype.afficherErreurNoteInvalide = function(aMsg) {
            this.actualiserMsgErreur(aMsg);
            this.erreurAffichee = true;
            this.reIntialiserValeur();
        };
        Clavier_SaisieNote.prototype.dessinerContexte = function() {
            var H = [];
            H.push('<div class="InlineBlock AlignementMilieuVertical">');
            H.push(this.options.htmlContexte);
            H.push('</div>');
            H.push('<div style="height:100%" class="InlineBlock AlignementMilieuVertical">&nbsp;</div>');
            return H.join('');
        };
        Clavier_SaisieNote.prototype.definirTouches = function() {
            var lTabTouches = [];
            lTabTouches.push(_newTouche_Action.call(this, {
                id: this.idTouche.valider,
                valeur: 'icon_ok',
                hint: GTraductions.getValeur('Valider')
            }));
            lTabTouches.push(_newTouche_Action.call(this, {
                id: this.idTouche.supprimer,
                valeur: 'icon_delete_clavier_mobile',
                hint: GTraductions.getValeur('Supprimer')
            }));
            var i, lNbr;
            for (i = 0, lNbr = 10; i < lNbr; i++) {
                lTabTouches.push(_newTouche_Numerique.call(this, {
                    id: _getIdToucheChiffre.call(this, i),
                    valeur: i
                }));
            }
            if (this.options.avecSeparateurDecimal) {
                lTabTouches.push(_newTouche_Numerique.call(this, {
                    id: this.idTouche.separateurDecimal,
                    valeur: ','
                }));
            }
            if (this.options.avecSigneMoins) {
                lTabTouches.push(_newTouche_Numerique.call(this, {
                    id: this.idTouche.signeMoins,
                    valeur: '-'
                }));
            }
            if (this.options.avecAnnotations) {
                for (i = 0, lNbr = this.listeAnnotations.length; i < lNbr; i++) {
                    var lGenreAnnotation = this.listeAnnotations[i];
                    lTabTouches.push(_newTouche_Annotation.call(this, {
                        id: _getIdToucheAnnotation.call(this, lGenreAnnotation),
                        valeur: new TypeNote().getChaineAnnotationDeGenre(lGenreAnnotation)
                    }));
                }
            }
            if (this.nbEcrans() > 1) {
                lTabTouches.push(_newTouche_Annotation.call(this, {
                    id: this.idTouche.basculeEcran,
                    valeur: this.getLibelleToucheBascule()
                }));
            }
            return lTabTouches;
        };
        Clavier_SaisieNote.prototype.definirGrille = function() {
            var lGrille = {
                nbLignes: this.options.grille.nbLignes,
                nbColonnes: this.options.avecAnnotations ? 5 : 4,
                nbEcrans: this.nbEcrans(),
                cells: []
            };
            var i, lNbr;
            for (i = 0, lNbr = lGrille.nbLignes; i < lNbr; i++) {
                lGrille.cells[i] = [];
            }
            var lIndiceCol, lIndiceLigne, lTouche;
            if (this.options.avecAnnotations) {
                lIndiceCol = 0;
                lIndiceLigne = 0;
                var lIndiceEcran = this.getIndiceEcran();
                for (i = 0, lNbr = this.listeAnnotations.length; i < lNbr; i++) {
                    var lAnnotation = this.listeAnnotations[i];
                    if (lIndiceLigne >= lGrille.nbLignes) {
                        lIndiceLigne = 0;
                        lIndiceEcran++;
                    }
                    if (!$.isArray(lGrille.cells[lIndiceLigne][lIndiceCol])) {
                        lGrille.cells[lIndiceLigne][lIndiceCol] = [];
                    }
                    lTouche = _getToucheParId.call(this, {
                        id: _getIdToucheAnnotation.call(this, lAnnotation)
                    });
                    lGrille.cells[lIndiceLigne][lIndiceCol][lIndiceEcran] = lTouche;
                    lIndiceLigne++;
                }
                for (i = lIndiceLigne, lNbr = lGrille.nbLignes; i < lNbr; i++) {
                    if (!$.isArray(lGrille.cells[lIndiceLigne][lIndiceCol])) {
                        lGrille.cells[lIndiceLigne][lIndiceCol] = [];
                    }
                    lGrille.cells[lIndiceLigne][lIndiceCol][lIndiceEcran] = null;
                    lIndiceLigne++;
                }
            }
            var lChiffre = 0;
            lIndiceCol = this.options.avecAnnotations ? 2 : 1;
            lGrille.cells[3][lIndiceCol] = _getToucheParId.call(this, {
                id: _getIdToucheChiffre.call(this, lChiffre)
            });
            var lNbr2;
            var lDebCol = this.options.avecAnnotations ? 1 : 0;
            lChiffre = 1;
            for (lIndiceLigne = 0, lNbr = 3; lIndiceLigne < lNbr; lIndiceLigne++) {
                for (lIndiceCol = lDebCol, lNbr2 = 3 + lDebCol; lIndiceCol < lNbr2; lIndiceCol++) {
                    lTouche = _getToucheParId.call(this, {
                        id: _getIdToucheChiffre.call(this, lChiffre)
                    });
                    lGrille.cells[lIndiceLigne][lIndiceCol] = lTouche;
                    lChiffre++;
                }
            }
            lIndiceCol = this.options.avecAnnotations ? 4 : 3;
            lGrille.cells[0][lIndiceCol] = this.options.avecSigneMoins ? _getToucheParId.call(this, {
                id: this.idTouche.signeMoins
            }) : null;
            lGrille.cells[1][lIndiceCol] = this.options.avecSeparateurDecimal ? _getToucheParId.call(this, {
                id: this.idTouche.separateurDecimal
            }) : null;
            lGrille.cells[2][lIndiceCol] = _getToucheParId.call(this, {
                id: this.idTouche.supprimer
            });
            var lToucheValider = _getToucheParId.call(this, {
                id: this.idTouche.valider
            });
            lGrille.cells[3][lIndiceCol - 1] = lToucheValider;
            lGrille.cells[3][lIndiceCol] = undefined;
            lIndiceCol = this.options.avecAnnotations ? 1 : 0;
            lGrille.cells[3][lIndiceCol] = this.options.avecAnnotations ? _getToucheParId.call(this, {
                id: this.idTouche.basculeEcran
            }) : null;
            return lGrille;
        };
        Clavier_SaisieNote.prototype.surEvntTouche = function(aParam) {
            if (this.erreurAffichee) {
                this.actualiserMsgErreur('');
                this.erreurAffichee = false;
            }
            var lStrAvant = this.getStrSaisieCourante();
            var lGenreCurseur = EGenreCurseurClavier.fin;
            var lTouche = aParam.touche;
            switch (lTouche.id) {
                case this.idTouche.basculeEcran:
                    this.basculerEcran({
                        toucheBascule: lTouche
                    });
                    break;
                case this.idTouche.supprimer:
                    if (lStrAvant !== '') {
                        if (_estStrToucheAnnotation.call(this, lStrAvant) || this.estCurseurClavier(EGenreCurseurClavier.selection)) {
                            this.viderSaisieCourante();
                        } else {
                            this.setStrSaisieCourante(lStrAvant.substring(0, lStrAvant.length - 1));
                        }
                    }
                    break;
                case this.idTouche.valider:
                    if (this.options.avecSeparateurDecimal) {
                        var lToucheSep = _getToucheParId.call(this, {
                            id: this.idTouche.separateurDecimal
                        });
                        var lCharSep = lToucheSep.getValeur();
                        if (new RegExp(lCharSep + '$').test(lStrAvant)) {
                            this.concatSaisieCourante('0');
                        }
                    }
                    if ((this.options.avecSigneMoins) && (lStrAvant.length === 1)) {
                        var lToucheMoins = _getToucheParId.call(this, {
                            id: this.idTouche.signeMoins
                        });
                        if (lStrAvant === lToucheMoins.getValeur()) {
                            this.viderSaisieCourante();
                        }
                    }
                    var lResult = this.options.methodeValidationNote(this.getStrSaisieCourante(), {
                        min: this.options.min,
                        max: this.options.max,
                        sansNotePossible: this.options.sansNotePossible,
                        avecAnnotation: this.options.avecAnnotations,
                        avecVirgule: this.options.avecSeparateurDecimal
                    });
                    if (lResult.estValide) {
                        this._surValidationNote = true;
                        try {
                            this.callback.appel(lResult.note);
                            this.closeModaleClavier();
                        } finally {
                            this._surValidationNote = false;
                        }
                    } else {
                        this.afficherErreurNoteInvalide(lResult.message);
                        lGenreCurseur = EGenreCurseurClavier.selection;
                    }
                    break;
                case this.idTouche.separateurDecimal:
                    if (this.options.avecSeparateurDecimal) {
                        if ((lStrAvant === '') || this.estCurseurClavier(EGenreCurseurClavier.selection)) {
                            this.setStrSaisieCourante('0' + lTouche.getValeur());
                        } else {
                            if (!_estStrToucheAnnotation.call(this, lStrAvant)) {
                                var lExp = new RegExp('[0-9]$');
                                if ((lExp.test(lStrAvant)) && (lStrAvant.indexOf(lTouche.getValeur()) === -1)) {
                                    this.concatSaisieCourante(lTouche.getValeur());
                                }
                            }
                        }
                    } else {}
                    break;
                case this.idTouche.signeMoins:
                    if (this.options.avecSigneMoins) {
                        if ((lStrAvant === '') || this.estCurseurClavier(EGenreCurseurClavier.selection)) {
                            this.setStrSaisieCourante(lTouche.getValeur());
                        }
                    } else {}
                    break;
                default:
                    if (_estIdToucheChiffre.call(this, lTouche.id)) {
                        if ((lStrAvant !== '') && (_estStrToucheAnnotation.call(this, lStrAvant) || this.estCurseurClavier(EGenreCurseurClavier.selection))) {
                            this.setStrSaisieCourante('' + lTouche.getValeur());
                        } else {
                            this.concatSaisieCourante('' + lTouche.getValeur());
                        }
                    } else if (this.options.avecAnnotations && _estIdToucheAnnotation.call(this, lTouche.id)) {
                        this.setStrSaisieCourante(lTouche.getValeur());
                    }
            }
            this.setCurseurClavier(lGenreCurseur);
            var lStrApres = this.getStrSaisieCourante();
            if (lStrAvant !== lStrApres) {
                this.actualiserVisuSaisie();
            }
        };
        Clavier_SaisieNote.prototype.estToucheDouble = function(aTouche) {
            return (aTouche.id === this.idTouche.valider);
        };
        module.exports = {
            Clavier_SaisieNote: Clavier_SaisieNote
        };
    },
    fn: "clavier_saisienote.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var IEHtml = require('IEHtml.js');
        var GHtml = require('GHtml.js');
        var GTraductions = require('ObjetTraduction.js');
        var Identite = require('ObjetIdentite.js');
        var Clavier_SaisieNote = require('Clavier_SaisieNote.js').Clavier_SaisieNote;
        var TypeNote = require('TypeNote.js');
        IEHtml.addBalise('ie-inputnote', function(aContexteCourant, aOutils) {
            var lJInput, lRacine, lNomModele = aOutils.getModel(aContexteCourant),
                lOptions = {
                    avecVirgule: true,
                    afficherAvecVirgule: true,
                    avecAnnotation: true,
                    listeAnnotations: null,
                    sansNotePossible: true,
                    min: 0,
                    max: 100,
                    selectionSurFocus: true,
                    textAlign: 'right',
                    hintSurErreur: false,
                    titreMessageMinMax: '',
                    messageMinMax: GTraductions.getValeur('InputNote.MinMax'),
                    maxLength: 15,
                    avecSigneMoins: false,
                    htmlContexte: ''
                };
            lJInput = $('<div></div>');
            lRacine = lJInput.get(0);
            var lSetHtmlNote = function(aNote) {
                GHtml.setHtml(lRacine, (aNote ? aNote.getNote() : '') || '&nbsp;');
            };
            aOutils.copyAttributs(aContexteCourant.node, lRacine);
            aOutils.replaceNode(aContexteCourant.node, lRacine);
            aOutils.addCommentaireDebug(lRacine, 'ie-inputnote');
            if (lNomModele) {
                aOutils.surNodeEtNodeAfter(aContexteCourant);
                var lGetOptions = aOutils.getAccesParametresModel('getOptionsNote', aContexteCourant),
                    lGetNote = aOutils.getAccesParametresModel('getNote', aContexteCourant),
                    lSetNote = aOutils.getAccesParametresModel('setNote', aContexteCourant),
                    lGetDisabled = aOutils.getAccesParametresModel('getDisabled', aContexteCourant);
                if (lGetOptions.estFonction) {
                    Object.assign(lOptions, lGetOptions.callback());
                }
                if (lOptions.textAlign) {
                    $(lRacine).css('text-align', lOptions.textAlign);
                }
                $(lRacine).css('border-bottom', '2px solid ' + GCouleur.themeNeutre.claire);
                if (lGetNote.estFonction && lSetNote.estFonction) {
                    var lNote = lGetNote.callback();
                    lSetHtmlNote(lNote);
                    var lDisabled = false;
                    if (lGetDisabled.estFonction) {
                        lDisabled = !!lGetDisabled.callback();
                        if (lDisabled) {
                            $(lRacine).css('color', GCouleur.themeNeutre.moyen2);
                        }
                    }
                    lJInput.on({
                        'click': function() {
                            if (lDisabled) {
                                return;
                            }
                            $(lRacine).css('border-bottom', '2px solid ' + GCouleur.themeCouleur.foncee);
                            var lClavierSaisieNote = Identite.creerInstance(Clavier_SaisieNote, {
                                pere: this || {},
                                evenement: function(aValeurSaisie) {
                                    lSetNote.callback([aValeurSaisie]);
                                    var lNote = lGetNote.callback();
                                    lSetHtmlNote(lNote);
                                    $(lRacine).css('border-bottom', '2px solid ' + GCouleur.themeNeutre.claire);
                                    aContexteCourant.contexte.refresh();
                                }
                            });
                            var lNote = lGetNote.callback();
                            lClavierSaisieNote.setOptions({
                                clavier: {
                                    valeurInit: lNote.getNote()
                                },
                                metier: {
                                    avecAnnotations: lOptions.avecAnnotation,
                                    avecSeparateurDecimal: lOptions.avecVirgule,
                                    avecSigneMoins: lOptions.avecSigneMoins,
                                    sansNotePossible: lOptions.sansNotePossible,
                                    min: lOptions.min,
                                    max: lOptions.max,
                                    htmlContexte: lOptions.htmlContexte
                                },
                                grille: {
                                    nbLignes: 4
                                },
                                methodeValidationNote: TypeNote.validerNote
                            });
                            lClavierSaisieNote.afficher();
                        }.bind(aContexteCourant.instance)
                    });
                    aOutils.abonnerRefresh(function() {
                        var lNewNote = lGetNote.callback();
                        if ((lNewNote && !lNote) || (!lNewNote && lNote) || (lNewNote.egal && !lNewNote.egal(lNote))) {
                            lNote = lNewNote;
                            lSetHtmlNote(lNote);
                        }
                        if (lGetDisabled.estFonction) {
                            var lNewDisabled = !!lGetDisabled.callback();
                            if (lDisabled !== lNewDisabled) {
                                lDisabled = lNewDisabled;
                                $(lRacine).css('color', lDisabled ? GCouleur.themeNeutre.moyen2 : '');
                            }
                        }
                    }, lRacine, aContexteCourant);
                } else {}
            } else {}
        });
        module.exports = IEHtml;
    },
    fn: "iehtml.inputnote_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        if (IE.estMobile) {
            module.exports = require('IEHtml.InputNote_Mobile.js');
        } else {
            module.exports = require('IEHtml.InputNote_Espace.js');
        }
    },
    fn: "iehtml.inputnote.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreBordure = require('_ObjetStyle.js').EGenreBordure;
        var IEHtml = require('IEHtml.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        var Support = require('ObjetSupport.js');
        var GTraductions = require('ObjetTraduction.js');
        var GChaine = require('GChaine.js');
        IEHtml.addBalise('ie-textareamax', function(aContexteCourant, aOutils) {
            var lModele = aOutils.getModel(aContexteCourant),
                lMap = aOutils.getMapDeNode(aContexteCourant.node),
                llName, lContexteCourant, H, lMaxLength = 0,
                lAvecMaxLength = false,
                lOptions = {
                    height: 14,
                    pourcentageAvertissement: 0.9,
                    couleurFond: GCouleur.nonEditable.fond,
                    couleurBordure: GCouleur.bordure,
                    couleurTexte: GCouleur.themeNeutre.foncee,
                    couleurTexteAvertissement: 'red',
                    borduresZoneMax: EGenreBordure.haut,
                    longueurTexte: -1,
                    libelleMax_dd: '%d/%d',
                    getCompteur: null
                },
                lSpeechRecognizer = null,
                lInRecognition = false;
            var lFLogSpeech = function(aMsg) {
                var lMsg = aMsg;
                switch (aMsg) {
                    case 'no-speech':
                        lMsg = GTraductions.getValeur('SaisieVocale.NoSpeech');
                        break;
                    case 'aborted':
                        lMsg = GTraductions.getValeur('SaisieVocale.Aborted');
                        break;
                    case 'audio-capture':
                        lMsg = GTraductions.getValeur('SaisieVocale.AudioCapture');
                        break;
                    case 'network':
                        lMsg = GTraductions.getValeur('SaisieVocale.Network');
                        break;
                    case 'not-allowed':
                        lMsg = GTraductions.getValeur('SaisieVocale.NotAllowed');
                        break;
                    case 'service-not-allowed':
                        lMsg = GTraductions.getValeur('SaisieVocale.ServiceNotAllowed');
                        break;
                    case 'bad-grammar':
                        lMsg = GTraductions.getValeur('SaisieVocale.BadGrammar');
                        break;
                    case 'language-not-supported':
                        lMsg = GTraductions.getValeur('SaisieVocale.LanguageNotSupported');
                        break;
                    default:
                        lMsg = aMsg;
                }
                if (!!lMsg) {
                    lJSpeechReco.children('i').attr('class', 'icon_microphone_off').before('<div style="position:absolute;top:-15px;right:0;">' + lMsg + '</div>').prev().delay(3000).queue(function() {
                        $(this).remove();
                    });
                }
                lInRecognition = false;
                aContexteCourant.controleur.$refreshSelf();
            };
            if (!lModele) {}
            if (lModele && aContexteCourant.data.$modeleParsed) {
                var lInfosGetOptions = aOutils.getAccesParametresModel('getOptions', aContexteCourant);
                if (lInfosGetOptions && lInfosGetOptions.estFonction) {
                    Object.assign(lOptions, lInfosGetOptions.callback([lOptions]));
                }
            }
            if (lMap.maxlength || lMap['ie-compteurmax']) {
                lAvecMaxLength = true;
                lMaxLength = parseInt(lMap.maxlength || lMap['ie-compteurmax'], 10);
                if (lMap['ie-compteurmax']) {
                    aOutils.addCommentaireDebug(aContexteCourant.node, 'ie-compteurmax:"' + lMap['ie-compteurmax'] + '"');
                    aContexteCourant.node.removeAttribute('ie-compteurmax');
                    delete lMap['ie-compteurmax'];
                }
            }
            if (lAvecMaxLength) {
                var lCouleur = aContexteCourant.node.style.borderColor;
                if (lCouleur !== 'initial' &&
                    lCouleur !== '' &&
                    lCouleur !== '-moz-use-text-color' &&
                    lCouleur !== 'currentColor') {
                    lOptions.couleurBordure = lCouleur;
                }
            }
            if (!!Support.speechRecognition) {
                try {
                    lSpeechRecognizer = new Support.speechRecognition();
                    lSpeechRecognizer.interimResults = true;
                    lSpeechRecognizer.onresult = function(event) {
                        for (var i = event.resultIndex; i < event.results.length; i++) {
                            if (event.results[i].isFinal) {
                                lJTextArea.get(0).value += (lJTextArea.get(0).value !== '' ? ' ' : '') + event.results[i][0].transcript;
                                lInRecognition = false;
                                lJTextArea.trigger('change');
                                aContexteCourant.controleur.$refreshSelf();
                            }
                        }
                    };
                    lSpeechRecognizer.onerror = function(event) {
                        lFLogSpeech(event.error);
                        aContexteCourant.controleur.$refreshSelf();
                    };
                } catch (ex) {
                    lFLogSpeech(ex.error);
                    aContexteCourant.controleur.$refreshSelf();
                }
            }
            if (lAvecMaxLength || !!lSpeechRecognizer) {
                H = ['<div tabIndex="-1" class="textarea-wrapper">', '<div class="textarea-style" style="position:absolute; top:0; left:0; right:0; bottom:0; overflow:hidden;">', '<textarea style="border:0;" class=" Table BorderBox"></textarea>', '</div>', lAvecMaxLength ? '<div class="textarea-counter AlignementDroit BorderBox"' + ' style="display:none; padding-left:3px; padding-right:' + (lSpeechRecognizer ? '15' : '3') + 'px;' + 'position:absolute; left:0; right:0; bottom:0;' +
                    GStyle.composeCouleurFond(lOptions.couleurFond) +
                    GStyle.composeCouleurBordure(lOptions.couleurBordure, 1, lOptions.borduresZoneMax) +
                    GStyle.composeHeight(lOptions.height) + '">' + '<span></span>' + '</div>' : '', lSpeechRecognizer ? '<div class="textarea-counter AlignementDroit" style="padding-right:3px;position:absolute; left:0; right:0; bottom:0;"><i class="icon_microphone"></div>' : '', '</div>'
                ];
            } else {
                H = ['<textarea></textarea>'];
            }
            var lDivConteneur = GHtml.htmlToDOM(H.join(''));
            var lJConteneur = $(lDivConteneur),
                lJConteneurTextarea = null,
                lJTextArea = null,
                lJConteneurMax = null,
                lJLibelleMax = null,
                lJSpeechReco = null;
            if (lAvecMaxLength || lSpeechRecognizer) {
                lJConteneurTextarea = lJConteneur.children().first();
                lJTextArea = lJConteneurTextarea.children().first();
                if (lAvecMaxLength) {
                    lJConteneurMax = lJConteneur.children().eq(1);
                    lJLibelleMax = lJConteneurMax.children().first();
                }
                lJSpeechReco = lJConteneur.children().eq(lAvecMaxLength ? 2 : 1);
            } else {
                lJTextArea = lJConteneur;
            }
            for (llName in lMap) {
                try {
                    switch (llName) {
                        case 'id':
                        case 'readonly':
                        case 'disabled':
                        case 'maxlength':
                        case 'ie-trim':
                        case 'ie-textbrut':
                            lJTextArea.attr(llName, lMap[llName]);
                            break;
                        case 'ie-idcont':
                            if (lAvecMaxLength || lSpeechRecognizer) {
                                lJConteneur.attr('id', lMap[llName]);
                            }
                            break;
                        default:
                            if (llName.startsWith('aria-')) {
                                lJTextArea.attr(llName, lMap[llName]);
                            } else {
                                lJConteneur.attr(llName, lMap[llName]);
                            }
                    }
                } catch (e) {}
            }
            if (lAvecMaxLength || lSpeechRecognizer) {
                lJConteneur.css({
                    position: 'relative'
                });
                if (aContexteCourant.data.$modeleValue) {
                    lContexteCourant = Object.assign({}, aContexteCourant);
                    lContexteCourant.node = lJTextArea.get(0);
                    aOutils.gererInputText(lContexteCourant, '');
                }
                var lEstNonEditable = function() {
                    return lJTextArea.is(':disabled') || lJTextArea.prop('readonly');
                };
                var lTimeoutFocusOut;
                lJConteneur.on({
                    'focusin': function() {
                        clearTimeout(lTimeoutFocusOut);
                        if (lEstNonEditable()) {
                            return;
                        }
                        if (lJConteneurMax) {
                            lJConteneurMax.show();
                        }
                        lJConteneurTextarea.css('bottom', lOptions.height + 'px');
                        aContexteCourant.controleur.$refreshSelf();
                    },
                    'focus': function() {
                        lJTextArea.focus();
                    },
                    'focusout': function() {
                        if (lJConteneurMax) {
                            lJConteneurMax.hide();
                        }
                        lJConteneurTextarea.css('bottom', '0');
                        lTimeoutFocusOut = setTimeout(function() {
                            lJTextArea.trigger('focusout_TextareaMax');
                        }, 0);
                    }
                });
                lJSpeechReco.on({
                    'click': function() {
                        if (!lEstNonEditable()) {
                            if (!lInRecognition) {
                                try {
                                    lSpeechRecognizer.start();
                                    lInRecognition = true;
                                    lJSpeechReco.children('i').attr('class', 'icon_microphone');
                                } catch (ex) {
                                    lFLogSpeech(ex.error);
                                }
                            } else {
                                try {
                                    lSpeechRecognizer.stop();
                                    lInRecognition = false;
                                } catch (ex) {
                                    lFLogSpeech(ex.error);
                                }
                            }
                            aContexteCourant.controleur.$refreshSelf();
                        }
                    }
                });
                if (lJLibelleMax && lJLibelleMax.length === 1) {
                    aOutils.surInjectionHtml(aContexteCourant, function() {
                        aContexteCourant.controleur.$refreshSelf();
                    });
                    aOutils.abonnerRefresh(function() {
                        var lValue = lJTextArea.get(0).value || '';
                        var lLongueur = lOptions.getCompteur ? lOptions.getCompteur(lValue) : lValue.length;
                        if (lLongueur !== lOptions.longueurTexte) {
                            lOptions.longueurTexte = lLongueur;
                            lJLibelleMax.get(0).innerHTML = GChaine.Format(lOptions.libelleMax_dd, [lLongueur, lMaxLength]);
                            lJConteneurMax.css('color', lLongueur > lMaxLength * lOptions.pourcentageAvertissement ? lOptions.couleurTexteAvertissement : lOptions.couleurTexte);
                        }
                    }, lJLibelleMax.get(0), aContexteCourant);
                }
                if (!!lSpeechRecognizer) {
                    if (lEstNonEditable()) {
                        lJSpeechReco.hide();
                    }
                    aOutils.abonnerRefresh(function() {
                        if (!lEstNonEditable()) {
                            lJSpeechReco.show();
                            lJSpeechReco.children('i').css('color', lInRecognition ? 'red' : '');
                        } else {
                            lJSpeechReco.hide();
                        }
                    }, lJSpeechReco.get(0), aContexteCourant);
                }
            } else {
                lJTextArea.on('focusout', function() {
                    lJTextArea.trigger('focusout_TextareaMax');
                });
            }
            aOutils.replaceNode(aContexteCourant.node, lDivConteneur);
            aContexteCourant.node = lDivConteneur;
            aOutils.addCommentaireDebug(lDivConteneur, 'ie-textareamax');
            return {
                node: aContexteCourant.node,
                avecCompileFils: false
            };
        });
        module.exports = IEHtml;
    },
    fn: "iehtml.textareamax.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('DeclarationJQuery.js');
        var TypeFusionTitreListe = require('TypeFusionTitreListe.js');
        var IEHtml = require('IEHtml.js');
        var GPosition = require('GPosition.js');
        var GLog = require('IELog.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjectCouleurCellule = require('_ObjetCouleur.js').ObjectCouleurCellule;
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        var EGenreAction = require('Enumere_Action.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreEvenementListe = require('Enumere_EvenementListe.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        require('IEHtml.DraggableDroppable.js');
        require('IEHtml.InputNote.js');
        require('IEHtml.SelecFile.js');
        require('IEHtml.TextareaMax.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var ObjetDonneesListe = require('ObjetDonneesListe.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var Support = require('ObjetSupport.js');
        var GTraductions = require('ObjetTraduction.js');
        var ToucheClavier = require('ToucheClavier.js');
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;

        function _ObjetListe() {
            this.inheritedCreate(arguments);
            this._init();
        }
        MethodesObjet.heritagePrototype(_ObjetListe, Identite);
        _ObjetListe.typeBouton = {
            monter: 'monter',
            descendre: 'descendre',
            deployer: 'deployer',
            supprimer: 'supprimer',
            editer: 'editer',
            exportCSV: 'exportCSV',
            parametrer: 'parametrer',
            rechercher: 'rechercher'
        };
        _ObjetListe.initColonne = function(aPourcentage, aMinPx, aMaxPx) {
            return {
                valeur: aPourcentage,
                min: aMinPx,
                max: aMaxPx
            };
        };
        _ObjetListe.skin = {
            classique: 'classique',
            alternance: 'alternance'
        };
        _ObjetListe.prototype.resetOptions = function() {
            this._options = {
                colonnes: null,
                gestionModificationColonnes: null,
                listeTailles: [],
                listeTitres: null,
                hintTitres: null,
                colonnesCachees: null,
                colonnesCacheesImpression: null,
                zoneScrollH: null,
                avecLigneCreation: false,
                listeCreations: [],
                titreCreation: GTraductions.getValeur('liste.nouveau'),
                avecToutSelectionner: true,
                nonEditable: false,
                nonEditableSurModeExclusif: false,
                AvecSuppression: true,
                parsingSurColonne: -1,
                scrollHorizontal: false,
                avecScrollEnTactileV: false,
                avecScrollEnTactileH: false,
                colonnesTriables: false,
                numeroColonneTriDefaut: undefined,
                evenementSurTri: null,
                avecSelectionSurNavigationClavier: false,
                avecNavigationClavierFlechesEnEdition: false,
                getParametresSelectionnerCelluleSuivanteFinEdition: null,
                avecModeAccessible: false,
                boutons: [],
                tailleBoutons: 17,
                skin: _ObjetListe.skin.classique,
                avecListeNeutre: undefined,
                couleursListe: GCouleur.liste,
                avecReservationPlaceScrollHorizontal: false,
                tailleScrollV: null,
                tailleScrollH: null,
                hauteurAdapteContenu: false,
                getHauteurMaxAdapteListe: null,
                hauteurMaxAdapteContenu: null,
                avecLigneTotal: false,
                nbLignesMax: 200,
                colonnesSansBordureDroit: [],
                avecCadreSelection: true,
                paddingCelluleLR: 2,
                paddingCelluleTB: 1,
                hauteurCelluleTitreStandard: 20,
                widthTri: 14,
                heightTri: 8,
                avecRollover: true,
                transparenceRollover: 0.2,
                transparenceRolloverCellule: 0.4,
                hauteurZoneContenuListeMin: 20,
                largeurZoneContenuListeMin: 20,
                largeurImage: 18,
                borduresTitre_couleur: null,
                borduresTitre_top: 1,
                borduresTitre_bottom: 0,
                borduresTitre_left: 1,
                borduresTitre_right: 1,
                couleursTitre_getCouleurFond: function(aOptions) {
                    return aOptions.couleursListe.titre.getFond(false);
                },
                couleursTitre_getCouleurTexte: function(aOptions) {
                    return aOptions.couleursListe.titre.getTexte(false);
                },
                traitSeparationTitre_taille: 2,
                borduresContenu_couleur: null,
                borduresContenu_top: 1,
                borduresContenu_bottom: 1,
                borduresContenu_left: 1,
                borduresContenu_right: 1,
                borduresCellule_couleur: null,
                borduresCellule_horizontal: 1,
                borduresCellule_vertical: 1,
                alternanceCouleurLigneContenu: false,
                avecCouleurAlternanceParDefaut: false,
                couleurAlternance0: new ObjectCouleurCellule(GCouleur.blanc, GCouleur.noir, null),
                couleurAlternance1: new ObjectCouleurCellule(GCouleur.fond, GCouleur.noir, null),
                avecTraitSeparationDeploiementAlternance: false,
                avecSelectionLigneSurImpression: true,
                piedDeListe: null,
                maxLengthTextareaIgnore: 1000000,
                delaiSurEditionRecherche: 500
            };
            return this;
        };
        _ObjetListe.prototype.setOptionsListe = function(aOptions, aAvecActualisation) {
            return _setOptionsListe.call(this, aOptions, aAvecActualisation);
        };
        _ObjetListe.prototype.getDonneesListe = function() {
            return this.Donnees;
        };
        _ObjetListe.prototype.SetDonnees = function(ADonnees, aLigneSelectionne, aParams) {
            return _setDonnees.call(this, ADonnees, aLigneSelectionne, aParams);
        };
        _ObjetListe.prototype.Actualiser = function(aObjetOuConserverSelection, aSansTriDonnees) {
            var lParametres = {
                ignorerFocusListe: false,
                ignorerCalculTri: true
            };
            if (MethodesObjet.isObject(aObjetOuConserverSelection)) {
                Object.assign(lParametres, aObjetOuConserverSelection);
            } else {
                Object.assign(lParametres, {
                    conserverSelection: !!aObjetOuConserverSelection,
                    conserverFocusSelection: !!aObjetOuConserverSelection,
                    sansTriDonnees: aSansTriDonnees
                });
            }
            this._cache.calculsPreRenduAFaire = true;
            _actualiser.call(this, lParametres);
        };
        _ObjetListe.prototype.effacer = function(aMessage) {
            this._donneesRecus = false;
            GHtml.setHtml(this.Nom, aMessage || '&nbsp;', {
                ignorerScroll: true
            });
            return this;
        };
        _ObjetListe.prototype.SurSelection = function(aNumeroColonne, aNumeroLigne, aParams) {
            return _surSelection.call(this, aNumeroColonne, aNumeroLigne, aParams);
        };
        _ObjetListe.prototype.SelectionnerLigne = function(aParametres) {
            this._cache.lignesSelectionnees_prec = MethodesObjet.dupliquer(this._cache.lignesSelectionnees);
            _selectionner.call(this, Object.assign({
                colonne: -1,
                avecActualisationPage: true,
                avecEvenementModificationSelection: true
            }, aParametres));
        };
        _ObjetListe.prototype.selectionnerCellule = function(aParametres) {
            this._cache.lignesSelectionnees_prec = MethodesObjet.dupliquer(this._cache.lignesSelectionnees);
            _selectionner.call(this, Object.assign({
                avecActualisationPage: true,
                avecEvenementModificationSelection: true
            }, aParametres));
        };
        _ObjetListe.prototype.GetSelection = function() {
            if (_getListeElementsSelection.call(this).GetNbrElements() === 0) {
                return -1;
            }
            return this._cache.selectionCellule.ligne;
        };
        _ObjetListe.prototype.getSelectionCellule = function() {
            return Object.assign({}, this._cache.selectionCellule);
        };
        _ObjetListe.prototype.getElementSelection = function() {
            var lListe = _getListeElementsSelection.call(this);
            return lListe.GetNbrElements() > 0 ? lListe.GetElement(0) : null;
        };
        _ObjetListe.prototype.getListeElementsSelection = function() {
            return _getListeElementsSelection.call(this);
        };
        _ObjetListe.prototype.setListeElementsSelection = function(aListeElements, aParams) {
            return _setListeElementsSelection.call(this, aListeElements, aParams);
        };
        _ObjetListe.prototype.getTableauCellulesSelection = function() {
            var lSelections = [];
            _getCellulesSelection.call(this).forEach(function(aElement) {
                aElement.colonnes.forEach(function(aNumeroColonne, aIndex) {
                    lSelections.push({
                        article: aElement.article,
                        ligne: aElement.ligne,
                        colonne: aNumeroColonne,
                        idColonne: aElement.idsColonnes[aIndex],
                        declarationColonne: this._cache.declColonnesByIds[aElement.idsColonnes[aIndex]]
                    });
                }.bind(this));
            }.bind(this));
            return lSelections;
        };
        _ObjetListe.prototype.setTableauCellulesSelection = function(aListe, aParams) {
            return _setTableauCellulesSelection.call(this, aListe, aParams);
        };
        _ObjetListe.prototype.selectionnerCelluleSuivante = function(aParametres) {
            return _selectionnerCelluleSuivante.call(this, aParametres);
        };
        _ObjetListe.prototype.getArticleDeLigne = function(aLigne) {
            if (this.Donnees && this.Donnees.Donnees) {
                return this.Donnees.Donnees.GetElement(aLigne);
            }
            return null;
        };
        _ObjetListe.prototype.getListeArticles = function() {
            if (this.Donnees && this.Donnees.Donnees) {
                return this.Donnees.Donnees;
            }
            return new ObjetListeElements();
        };
        _ObjetListe.prototype.demarrerEditionSurCellule = function(aLigne, aColonne) {
            var lElement = GHtml.getElement(this.getIdCellule(aColonne, aLigne) + '_div');
            if (GHtml.elementExiste(lElement)) {
                GHtml.setFocus(lElement);
            }
            _SurEditionDeb.call(this, aColonne, aLigne);
            if (this._cache.timeout_ignorerScrollSortieEdition) {
                clearTimeout(this._cache.timeout_ignorerScrollSortieEdition);
                delete this._cache.timeout_ignorerScrollSortieEdition;
            }
            this._cache.timeout_ignorerScrollSortieEdition = setTimeout(function() {
                delete this._cache.timeout_ignorerScrollSortieEdition;
            }.bind(this), 100);
            return this;
        };
        _ObjetListe.prototype.ajouterElementCreation = function(aLibelle, aValeurCreation) {
            return _ajouterElementCreation.call(this, aLibelle, aValeurCreation);
        };
        _ObjetListe.prototype.annulerCreation = function() {
            _annulerCreation.call(this);
        };
        _ObjetListe.prototype.setCreationLigne = function(aCreationLigneBis) {
            return _setCreationLigne.call(this, aCreationLigneBis);
        };
        _ObjetListe.getTitreCreation = function(aTitre) {
            var T = [];
            T.push('<div class="Image_ListeCreation InlineBlock AlignementMilieuVertical PetitEspaceGauche"></div>');
            T.push('<div class="PetitEspaceGauche InlineBlock AlignementMilieuVertical" style="', GStyle.composeCouleurTexte(GCouleur.texteListeCreation), '">', aTitre, '</div>');
            return T.join('');
        };
        _ObjetListe.prototype.SurSuppression = function() {
            return _surSuppression.call(this);
        };
        _ObjetListe.prototype.getIdCellule = function(aColonne, aLigne, aCelluleInterne) {
            return this.Nom + '_' + aColonne + (aLigne === null || aLigne === undefined ? '' : '_' + aLigne) + (aCelluleInterne && !this.optionsInterne.versionMobile ? '_divP' : '');
        };
        _ObjetListe.prototype.getIdColonneDeNumeroColonne = function(aNumeroColonne) {
            return this._cache.colonnes.listeIds[aNumeroColonne] || '';
        };
        _ObjetListe.prototype.getNumeroColonneDIdColonne = function(aIdColonne) {
            var lNumero = this._cache.colonnes.listeIds.indexOf(aIdColonne);
            return lNumero >= 0 ? lNumero : -1;
        };
        _ObjetListe.prototype.getRechercheTexte = function() {
            return this._cache.rechercheTexte.saisie;
        };
        _ObjetListe.prototype.setRechercheTexte = function(aTexte) {
            this._cache.rechercheTexte.saisie = aTexte;
            clearTimeout(this._cache.rechercheTexte.timerSaisie);
            if (this._options.delaiSurEditionRecherche >= 0) {
                this._cache.rechercheTexte.timerSaisie = setTimeout(function() {
                    _filtreRechercheTexte.call(this);
                }.bind(this), this._options.delaiSurEditionRecherche);
            } else {
                _filtreRechercheTexte.call(this);
            }
            return this;
        };
        _ObjetListe.prototype.composeImpression = function() {
            return '';
        };
        _ObjetListe.prototype.construireCopieCSV = function() {};
        _ObjetListe.prototype.Reset = function() {
            return _setDonnees.call(this, new ObjetDonneesListe(new ObjetListeElements()));
        };
        _ObjetListe.prototype.resize = function() {};
        _ObjetListe.prototype.SurPreResize = function() {};
        _ObjetListe.prototype.SurPostResize = function() {};
        _ObjetListe.prototype.setColonneTri = function(aColonne, aGenre, aNumeroTri) {
            return _setColonneTri.call(this, aColonne, aGenre, aNumeroTri);
        };
        _ObjetListe.prototype.FocusSuivant = function(AId, AOrientation, ADirection) {
            return _focusSuivant.call(this, AId, AOrientation, ADirection);
        };
        _ObjetListe.prototype.free = function() {
            this.inherited('free', arguments);
            clearTimeout(this._cache.rechercheTexte.timerSaisie);
            clearTimeout(this._cache.timerKeyPress);
        };
        var _CONST_largeurMinColonne = 10;
        _ObjetListe.prototype._init = function() {
            this.IdEdition = this.Nom + '_Edition';
            this.idZone = this.Nom + '_Zone';
            this.IdZoneTexte = this.Nom + '_ZoneTexte';
            this.IdPremierElement = this.Nom + '_ObjetListe';
            this.idTotaux = this.Nom + '_totaux';
            this.idPiedDeListe = this.Nom + '_piedDeListe';
            this.ids = {
                zoneFils: this.Nom + '_zone_fils',
                titre: this.Nom + '_titreTout',
                contenu: this.Nom + '_contenuListe_',
                colonneDeTri: this.Nom + '_triCol_',
                curseurTri: this.Nom + '_curseurTri_',
                curseurTriSurvol: this.Nom + '_curseurTriSurvol_',
                survolTitre: this.Nom + '_survolTitre_',
                cocheTitre: this.Nom + '_cocheT_',
                cadreSelection: this.Nom + '_cadreSel_',
                rolloverTitre: this.Nom + '_rolloverTitre_',
                rolloverContenuLigne: this.Nom + '_rolloverContenuLigne_',
                rolloverContenuColonne: this.Nom + '_rolloverContenuColonne_',
                rolloverContenuCellule: this.Nom + '_rolloverContenuCellule_',
                dragInsertion: this.Nom + '_dragInsertion',
                surligneur_edition: this.Nom + '_surligneuredition'
            };
            this.resetOptions();
            this._cache = {
                taillesColonne: [],
                heightConteneur: 0,
                largeurPage: null,
                avecPourcentage: false,
                largeurTotalFixe: 0,
                infosZonesColonnes: [],
                listeCorrespondancesColonnes: [],
                declColonnesByIds: {},
                colonnes: {
                    listeIds: [],
                    listeTailles: []
                },
                pageCourante: 1,
                tableauColonnesCachees: [],
                nbColonnesCachees: 0,
                reserverPlaceScrollHorizontal: false,
                calculsPreRenduAFaire: true,
                calculsTailleColonnesAFaire: true,
                calculTriAFaire: true,
                listeNonInitialisee: true,
                lignesFusionParColonne: {},
                declarationsColonnes: [],
                colonnesTri: null,
                colonnesSansBordureDroit: [],
                boutons: null,
                rolloverVisible: false,
                survoleTitreTriVisible: false,
                lignesVisibles: [],
                lignesVisiblesSansRechercheTexte: [],
                couleursAlternanceParLigne: [],
                selectionCellule: {
                    ligne: -1,
                    colonne: -1
                },
                celluleClicNonShift: {
                    ligne: -1,
                    colonne: -1
                },
                lignesSelectionnees: [],
                lignesSelectionnees_prec: [],
                editionEnCours: false,
                editionEnCoursEvenement: false,
                creationEnCours: false,
                creationEnCoursEvenement: false,
                positionCreation: 0,
                listeValeursCreation: [],
                numeroColonneCreationEnCours: null,
                numeroLigneCreationDynamique: null,
                ouvrirSelecteurFileParLigne: {},
                positionsCelluleCadreSelection: {},
                keysControleurTitre: {},
                keysControleurDonneesListe: {},
                rechercheTexte: {
                    saisie: '',
                    textesParLigne: null,
                    lignesCachees: [],
                    timerSaisie: null
                },
                timerKeyPress: null
            };
            this.optionsInterne = {
                avecActualisationParZone: true,
                versionMobile: false
            };
            Invocateur.abonner(ObjetInvocateur.events.modeExclusif, function() {
                if (this._options.nonEditableSurModeExclusif) {
                    _actualiser.call(this, {
                        conserverSelection: true,
                        sansTriDonnees: true
                    });
                }
            }, this);
        };

        function _setOptionsListe(aOptions, aAvecActualisation) {
            if (aOptions && aOptions.skin) {
                _affecterOptionsSkin.call(this, aOptions.skin);
            }
            if (aOptions.colonnesCachees) {
                this._options.colonnesCachees = [];
            }
            $.extend(this._options, aOptions);
            if (aOptions && aOptions.colonnes) {
                this._cache.declarationsColonnes = [].concat(aOptions.colonnes);
                this._cache.colonnes.listeIds = [];
                this._options.listeTailles = [];
                this._cache.declColonnesByIds = {};
                var lControleIds = {},
                    lIndex = 0;
                MethodesTableau.parcourir(aOptions.colonnes, function(D, aIndex) {
                    if (!D) {
                        return;
                    }
                    if (D.id === undefined) {
                        D.id = aIndex.toString();
                    };
                    lControleIds[D.id] = true;
                    this._cache.colonnes.listeIds[lIndex] = D.id;
                    this._options.listeTailles[lIndex] = D.taille || 0;
                    this._cache.declColonnesByIds[D.id] = D;
                    lIndex += 1;
                }, this);
            }
            this._cache.colonnes.listeTailles = MethodesObjet.dupliquer(this._options.listeTailles);
            this._options.couleursListe = this._options.avecListeNeutre ? GCouleur.listeNeutre : GCouleur.liste;
            if (this._options.tailleScrollV > 0 && this.ScrollV) {
                this.ScrollV.Largeur = this._options.tailleScrollV;
            } else if (_avecBoutonsListe.call(this)) {
                this.ScrollV.Largeur = 11;
            }
            if (this._options.tailleScrollH > 0 && this.ScrollH) {
                this.ScrollH.Largeur = this._options.tailleScrollH;
            }
            this._cache.calculsPreRenduAFaire = true;
            this._cache.calculsTailleColonnesAFaire = true;
            if (aAvecActualisation === true) {
                _actualiser.call(this, {
                    conserverSelection: true,
                    sansTriDonnees: true
                });
            }
            return this;
        }

        function _affecterOptionsSkin(aSkin) {
            switch (aSkin) {
                case _ObjetListe.skin.classique:
                    break;
                case _ObjetListe.skin.alternance:
                    Object.assign(this._options, {
                        alternanceCouleurLigneContenu: true,
                        avecCouleurAlternanceParDefaut: true,
                        avecTraitSeparationDeploiementAlternance: true,
                        avecCadreSelection: true,
                        hauteurAdapteContenu: true,
                        nonEditable: true,
                        paddingCelluleLR: 3,
                        paddingCelluleTB: 2
                    });
                    break;
                default:
                    ;
            }
        }
        _ObjetListe.prototype.getControleur = function(aInstance) {
            var lControleur = {
                saisieTexte: {
                    getValue: function() {
                        return aInstance._valeurEnEdition;
                    },
                    setValue: function(aLigne, aColonne, aEnCreation, aEstNote, aEstTextareaMax, aIgnorerEventsNode, aValue) {
                        _setValueModel.call(aInstance, {
                            ligne: aLigne,
                            colonne: aColonne,
                            surCreation: aEnCreation,
                            node: this.node,
                            value: aValue
                        });
                    },
                    getNote: function() {
                        return aInstance._valeurEnEdition;
                    },
                    setNote: function(aLigne, aColonne, aEnCreation, aEstNote, aEstTextareaMax, aIgnorerEventsNode, aNote) {
                        if (aInstance.optionsInterne.versionMobile && aEstNote && aNote === null && aInstance._cache.finEditionCreation) {
                            aInstance._cache.finEditionCreation();
                            return;
                        }
                        _setValueModel.call(aInstance, {
                            ligne: aLigne,
                            colonne: aColonne,
                            surCreation: aEnCreation,
                            node: this.node,
                            value: aNote,
                            estNote: aEstNote
                        });
                        if (aInstance.optionsInterne.versionMobile && aEstNote && aInstance._cache.finEditionCreation) {
                            aInstance._cache.finEditionCreation();
                        }
                    },
                    getOptionsNote: function(aLigne, aColonne, aEnCreation) {
                        if (aInstance.Donnees) {
                            return aInstance.Donnees.getOptionsNote(_getParamsCellule.call(aInstance, aColonne, aLigne, {
                                surLigneCreation: aEnCreation
                            })) || null;
                        }
                    },
                    fromDisplay: function(aLigne, aColonne, aEnCreation, aEstNote, aEstTextareaMax, aIgnorerEventsNode, aValue) {
                        if (aEstNote) {
                            return aValue;
                        }
                        var lControle = aInstance.Donnees ? aInstance.Donnees.getControleCaracteresInput(_getParamsCellule.call(aInstance, aColonne, aLigne, {
                            surLigneCreation: aEnCreation
                        })) : null;
                        if (lControle && lControle.fromDisplay) {
                            aValue = lControle.fromDisplay(aColonne, aLigne, aValue);
                        }
                        return aValue;
                    },
                    toDisplay: function(aLigne, aColonne, aEnCreation, aEstNote, aEstTextareaMax, aIgnorerEventsNode, aValue) {
                        if (aEstNote) {
                            return aValue;
                        }
                        var lControle = aInstance.Donnees ? aInstance.Donnees.getControleCaracteresInput(_getParamsCellule.call(aInstance, aColonne, aLigne, {
                            surLigneCreation: aEnCreation
                        })) : null;
                        if (lControle && lControle.toDisplay) {
                            aValue = lControle.toDisplay(aColonne, aLigne, aValue);
                        }
                        return aValue;
                    },
                    node: function(aLigne, aColonne, aEnCreation, aEstNote, aEstTextareaMax, aIgnorerEventsNode) {
                        aInstance._cache.avecModificationSaisie = false;
                        var lForceSetNote = aEstNote && this.data.forceExitChange ? function() {
                            var lParamsExit = {};
                            this.data.forceExitChange(lParamsExit);
                            if (lParamsExit.resultValidation && !lParamsExit.resultValidation.estValide) {
                                if (aEnCreation) {
                                    _annulerCreation.call(aInstance);
                                } else {
                                    _surEditionFin.call(aInstance, aInstance._cache.selectionCellule.colonne, aInstance._cache.selectionCellule.ligne);
                                    if (lParamsExit.resultValidation.promiseMessageErreur) {
                                        var lPromise = lParamsExit.resultValidation.promiseMessageErreur.then(function() {
                                            aInstance.demarrerEditionSurCellule(aInstance._cache.selectionCellule.ligne, aInstance._cache.selectionCellule.colonne);
                                        });
                                        return {
                                            promiseMessageErreur: lPromise
                                        };
                                    }
                                }
                                return true;
                            }
                        }.bind(this) : null;
                        aInstance._cache.finEditionCreation = function() {
                            aInstance._cache.finEditionCreation = null;
                            if (aEstNote && lForceSetNote) {
                                var lResultSetNote = lForceSetNote();
                                if (lResultSetNote) {
                                    return lResultSetNote;
                                }
                            }
                            var lParams = _getParamsCellule.call(aInstance, aColonne, aLigne, {
                                surEdition: true
                            });
                            if (aEnCreation) {
                                _SurCreation.call(aInstance, aInstance._valeurEnEdition);
                            } else {
                                _SurEdition.call(aInstance, lParams, aInstance._valeurEnEdition, aInstance._cache.avecModificationSaisie);
                            }
                        };
                        aInstance._cache.finEditionCreation.estCreation = aEnCreation;
                        if (aIgnorerEventsNode) {
                            return;
                        }
                        $(this.node).on({
                            'keydown': function(aEvent) {
                                delete aInstance._cache._keyDownSansNavigationFleche;
                                if (_isToucheRetourChariot(aEvent) || aEvent.which === ToucheClavier.Echap || aEvent.which === ToucheClavier.Tab) {
                                    if (aEstNote && lForceSetNote && aEvent.which !== ToucheClavier.Echap) {
                                        lForceSetNote();
                                    }
                                    aEvent.stopPropagation();
                                    aEvent.preventDefault();
                                    return false;
                                }
                                if (aInstance._options.avecNavigationClavierFlechesEnEdition) {
                                    var lNodeName = this.nodeName.toLowerCase();
                                    if ((lNodeName === 'input' || lNodeName === 'textarea') && ((aEvent.which === ToucheClavier.FlecheGauche && !_estCurseurEnBorneDeSelection(this, true)) || (aEvent.which === ToucheClavier.FlecheDroite && !_estCurseurEnBorneDeSelection(this, false)))) {
                                        aInstance._cache._keyDownSansNavigationFleche = true;
                                    }
                                }
                            },
                            'keyup': function(aEvent) {
                                if (_isToucheRetourChariot(aEvent) || aEvent.which === ToucheClavier.Echap || aEvent.which === ToucheClavier.Tab) {
                                    if (aEvent.which === ToucheClavier.Echap) {
                                        if (aEnCreation) {
                                            _annulerCreation.call(aInstance);
                                        } else {
                                            _surEditionFin.call(aInstance, aInstance._cache.selectionCellule.colonne, aInstance._cache.selectionCellule.ligne);
                                        }
                                    } else {
                                        if (aEstNote && lForceSetNote) {
                                            if (lForceSetNote()) {
                                                return;
                                            }
                                        }
                                        var lParams = _getParamsCellule.call(aInstance, aColonne, aLigne, {
                                            surEdition: true
                                        });
                                        if (aEnCreation) {
                                            _SurCreation.call(aInstance, aInstance._valeurEnEdition);
                                        } else {
                                            _SurEdition.call(aInstance, lParams, aInstance._valeurEnEdition, aInstance._cache.avecModificationSaisie, aInstance.Donnees.options.avecEvnt_ApresEditionValidationSansModification);
                                        }
                                        if (aInstance._options.getParametresSelectionnerCelluleSuivanteFinEdition && MethodesObjet.isFunction(aInstance._options.getParametresSelectionnerCelluleSuivanteFinEdition)) {
                                            _selectionnerCelluleSuivante.call(aInstance, Object.assign(lParams, aInstance._options.getParametresSelectionnerCelluleSuivanteFinEdition(lParams)));
                                        }
                                    }
                                    aEvent.stopPropagation();
                                    return false;
                                }
                                if ([ToucheClavier.FlecheHaut, ToucheClavier.FlecheBas, ToucheClavier.FlecheGauche, ToucheClavier.FlecheDroite].indexOf(aEvent.which) >= 0) {
                                    if (aInstance._options.avecNavigationClavierFlechesEnEdition && !aInstance._cache._keyDownSansNavigationFleche) {
                                        _navigationFlechesClavier.call(aInstance, _getParamsCellule.call(aInstance, aColonne, aLigne, {
                                            surEdition: true,
                                            node: this,
                                            event: aEvent,
                                            avecCelluleEditable: true,
                                            avecSelection: true,
                                            entrerEdition: true
                                        }));
                                    }
                                    aEvent.stopPropagation();
                                }
                            },
                            'blur focusout': function() {
                                if (!aEstTextareaMax && aInstance._cache.finEditionCreation) {
                                    aInstance._cache.finEditionCreation();
                                }
                            },
                            'focusout_TextareaMax': function() {
                                if (aEstTextareaMax && aInstance._cache.finEditionCreation) {
                                    aInstance._cache.finEditionCreation();
                                }
                            }
                        });
                    }
                },
                modeleSelecFileCellule: {
                    getOptionsSelecFile: function(aLigne, aColonne, aSurCreation) {
                        var lParams = _getParamsCellule.call(aInstance, aColonne, aLigne, {
                            surCreation: aSurCreation
                        });
                        var lOptions = Object.assign({
                            classDrag: 'selecfile_classDrag',
                            classDragHoverSelec: 'selecfile_classDrag_survol'
                        }, aInstance.Donnees.getOptionsSelecFile(lParams));
                        if (lOptions.eventClick !== false && !aInstance.optionsInterne.versionMobile) {
                            aInstance._cache.ouvrirSelecteurFileParLigne[aLigne + '_' + aColonne] = this.getOpenSelecFile();
                        }
                        return lOptions;
                    },
                    addFiles: function(aLigne, aColonne, aSurCreation, aParamsFiles) {
                        var lParamsCellule = _getParamsCellule.call(aInstance, aColonne, aLigne, {
                            surCreation: aSurCreation
                        });
                        if (aSurCreation && aInstance.ListeCreations.length === 1) {
                            aParamsFiles.listeFichiers.parcourir(function(aFichier) {
                                aInstance.ajouterElementCreation(aFichier.Libelle, aFichier);
                            });
                            return true;
                        }
                        return aInstance.Donnees.evenementSurSelecFile(lParamsCellule, aParamsFiles);
                    }
                },
                nodeDeploiementLigne: function(aLigne, aColonne) {
                    $(this.node).on('mousedown', function(aEvent) {
                        aEvent.stopPropagation();
                        _SurDeploiement.call(aInstance, aEvent, aColonne, aLigne, true);
                    });
                },
                surClickCocheTitre: function(aColonne) {
                    _clickSurCocheTitre.call(aInstance, aColonne);
                },
                getTitleCocheTitre: function(aColonne) {
                    if (aInstance.Donnees) {
                        var lEtatCoche = aInstance.Donnees.getEtatCocheSelonFils(null, _getParamsCellule.call(aInstance, aColonne));
                        switch (lEtatCoche) {
                            case ObjetDonneesListe.EGenreCoche.Aucune:
                                return GTraductions.getValeur('liste.toutCocher');
                            case ObjetDonneesListe.EGenreCoche.Verte:
                                return GTraductions.getValeur('liste.toutDecocher');
                        }
                        return GTraductions.getValeur('liste.toutCocher');
                    }
                    return '';
                },
                getStyleCocheTitre: function(aColonne) {
                    if (aInstance.Donnees) {
                        var lEtatCoche = aInstance.Donnees.getEtatCocheSelonFils(null, _getParamsCellule.call(aInstance, aColonne));
                        return {
                            'background-position': lEtatCoche === ObjetDonneesListe.EGenreCoche.Aucune ? 0 : lEtatCoche === ObjetDonneesListe.EGenreCoche.Verte ? -16 : -32
                        };
                    }
                    return null;
                }
            };
            return {
                liste: lControleur
            };
        };

        function _clickSurCocheTitre(aColonne) {
            var lDonneesListe = this.Donnees;
            if (!lDonneesListe) {
                return;
            }
            if (_ObjetListe.protected._getNonEditable.call(this) || this._cache.editionEnCours) {
                return;
            }
            var lEtatCoche = lDonneesListe.getEtatCocheSelonFils(null, _getParamsCellule.call(this, aColonne)),
                lValeur = lEtatCoche !== ObjetDonneesListe.EGenreCoche.Verte,
                lLignes = lDonneesListe.getTableauLignesModifieesCocheTitre(aColonne, lValeur),
                lParams;
            var lListeParamsCellules = [];
            for (var i = 0; i < lLignes.length; i++) {
                lParams = _getParamsCellule.call(this, aColonne, lLignes[i]);
                if (lParams.article && lDonneesListe.AvecEdition(aColonne, lParams.article, lParams) && !lDonneesListe.editionRefusee(lParams)) {
                    lListeParamsCellules.push(lParams);
                }
            }
            var lPromise = lDonneesListe.surEditionCocheTitre(lListeParamsCellules, lValeur);
            Promise.resolve(lPromise).then(function() {
                _ObjetListe.protected._actualiser.call(this, {
                    conserverSelection: true,
                    zonesActualisation: {
                        contenu: true,
                        total: true
                    }
                });
                _ObjetListe.protected._SurApresEditionEvenement.call(this, _getParamsCellule.call(this, aColonne, -1, {
                    avecModification: true
                }));
            }.bind(this), function() {}).then(function() {
                _ObjetListe.protected._refreshSelf.call(this);
            }.bind(this));
        }

        function _getNonEditable() {
            return this._options.nonEditable || (this._options.nonEditableSurModeExclusif && GApplication.getModeExclusif());
        }

        function _isToucheRetourChariot(aEvent) {
            return aEvent && aEvent.which === ToucheClavier.RetourChariot && !aEvent.shiftKey && !aEvent.altKey && !aEvent.ctrlKey;
        }

        function _estCurseurEnBorneDeSelection(aElement, aDebut) {
            if (aElement) {
                if (document.selection) {
                    var LCurseurCourant = document.selection.createRange();
                    var LCurseurElement = aElement.createTextRange();
                    LCurseurElement.collapse(true);
                    return (LCurseurCourant.boundingWidth === 0) && (LCurseurCourant.boundingLeft === LCurseurElement.boundingLeft);
                }
                if (aElement.selectionStart !== null && aElement.selectionStart !== undefined && aElement.selectionStart === aElement.selectionEnd) {
                    return aDebut ? aElement.selectionStart === 0 : aElement.selectionStart === aElement.value.length;
                }
            }
            return false;
        }

        function _navigationFlechesClavier(aParams) {
            if (!GNavigateur.IsToucheFleche()) {
                return;
            }
            var lParam = Object.assign({
                ligne: this._cache.selectionCellule.ligne,
                colonne: this._cache.selectionCellule.colonne,
                orientationVerticale: false,
                sensInverse: false,
                avecSelection: this._options.avecSelectionSurNavigationClavier,
                entrerEdition: false
            }, aParams);
            if (GNavigateur.IsToucheFlecheGauche()) {
                lParam.sensInverse = true;
            } else if (GNavigateur.IsToucheFlecheHaut()) {
                lParam.sensInverse = true;
                lParam.orientationVerticale = true;
            } else if (GNavigateur.IsToucheFlecheBas()) {
                lParam.orientationVerticale = true;
            }
            if (lParam.entrerEdition) {
                _selectionnerCelluleSuivante.call(this, lParam);
            } else {
                _navigationCelluleSuivante.call(this, lParam);
            }
        }
        _ObjetListe.prototype.RecupererDonnees = function() {
            this._cache.listeNonInitialisee = true;
        };

        function _getLeftCurseurTri(aPositionColonne, aDerniereColonneDeBloc) {
            return aPositionColonne.left + Math.round(aPositionColonne.width / 2 - this._options.widthTri / 2) + (aDerniereColonneDeBloc ? 0 : 1);
        }

        function _positionnerCurseurTri(aInfosZonesColonnes, aNode, aNumeroTri) {
            var lNumeroColonne = this._triCourant.colonne[aNumeroTri],
                lPosition = aInfosZonesColonnes.gabaritColonnesTitre[lNumeroColonne],
                lDerniereColonne = lNumeroColonne === aInfosZonesColonnes.colonnesVisibles[aInfosZonesColonnes.colonnesVisibles.length - 1];
            if (!lPosition) {
                $(aNode).hide();
            } else {
                $(aNode).show().css('left', _getLeftCurseurTri.call(this, lPosition, lDerniereColonne) + 'px');
            }
        }

        function _avecBoutonsListe() {
            return this._cache.boutons && this._cache.boutons.length > 0;
        }
        _ObjetListe.prototype._ouvrirFenetreParametrageColonnes = function() {};
        _ObjetListe.prototype._preparerBoutons = function() {};
        _ObjetListe.prototype._getInfosZonesColonnes = function() {};

        function _initCacheLignes(aParamsActualiser) {
            this._cache.lignesFusionParColonne = {};
            if (this.Donnees) {
                this.Donnees.lignesFusionParColonne = this._cache.lignesFusionParColonne;
            }
            if (!aParamsActualiser || !aParamsActualiser.estFiltreRechercheTexte) {
                this._cache.rechercheTexte.textesParLigne = null;
                this._cache.rechercheTexte.lignesCachees = [];
            }
            this._cache.lignesVisibles = [];
            this._cache.lignesVisiblesSansRechercheTexte = [];
            if (this.ListeTailles && this.Donnees) {
                for (var J = 0, lNb = this.Donnees.GetNbrLignes(); J < lNb; J++) {
                    if (this.Donnees.estVisible(J)) {
                        this._cache.lignesVisiblesSansRechercheTexte.push(J);
                        this._cache.lignesVisibles.push(J);
                    }
                }
                this._cache.pageCourante = Math.min(this._cache.pageCourante, _getPageMax.call(this));
                if (aParamsActualiser && aParamsActualiser.estFiltreRechercheTexte) {
                    var lRange = _getLigneDebutEtFinPaginationCourante.call(this);
                    this._cache.lignesVisibles = [];
                    this._cache.lignesVisiblesSansRechercheTexte.forEach(function(aLigne, aIndex) {
                        if (aIndex < lRange.debut) {
                            this._cache.lignesVisibles.push(aLigne);
                        } else if (aIndex < lRange.fin && !this._cache.rechercheTexte.lignesCachees[aLigne]) {
                            this._cache.lignesVisibles.push(aLigne);
                        }
                    }.bind(this));
                }
            }
        }

        function _estLigneVisible(aListe, aNumeroLigne) {
            return !aListe._cache.rechercheTexte.lignesCachees[aNumeroLigne] && aListe.Donnees.estVisible(aNumeroLigne);
        }
        _ObjetListe.prototype._construireAffichage = function() {};
        _ObjetListe.prototype.ConstruireAffichage = function(aParamsActualiser) {
            this._cache.survoleTitreTriVisible = false;
            this._cache.ouvrirSelecteurFileParLigne = {};
            if (!GHtml.elementExiste(this.Nom)) {
                return '';
            }
            if (!this._cache.largeurPage && this._cache.avecPourcentage) {
                return '';
            }
            if (!this.ListeTailles || this.ListeTailles.length === 0) {
                return '';
            }
            if (this._options.avecListeNeutre === undefined) {
                this._options.avecListeNeutre = $('#' + this.Nom.escapeJQ()).parents('#' + ZoneFenetre.idZoneFenetre.escapeJQ()).length > 0;
                this._options.couleursListe = this._options.avecListeNeutre ? GCouleur.listeNeutre : GCouleur.liste;
            }
            _initCacheLignes.call(this, aParamsActualiser);
            return this._construireAffichage();
        };
        _ObjetListe.prototype._getDessinCurseurTri = function() {
            return '';
        };

        function _estSelectionParCellule(aLigne, aColonne) {
            if (aColonne < 0) {
                return false;
            }
            return !!this.Donnees && this.Donnees.selectionParCellule(aColonne, this.Donnees.Donnees.GetElement(aLigne));
        }

        function _getPageDeLigneVisible(aLigneVisible) {
            for (var i = 0; i < this._cache.lignesVisiblesSansRechercheTexte.length; i++) {
                if (aLigneVisible === this._cache.lignesVisiblesSansRechercheTexte[i]) {
                    return this._options.nbLignesMax > 0 && !this.optionsInterne.versionMobile ? Math.floor(i / this._options.nbLignesMax) + 1 : 1;
                }
            }
            return -1;
        }
        _ObjetListe.prototype._construireListeModeAccessible = function() {};

        function _getPageMax() {
            return this._options.nbLignesMax === 0 || this.optionsInterne.versionMobile ? 1 : Math.max(1, Math.ceil(this._cache.lignesVisiblesSansRechercheTexte.length / this._options.nbLignesMax));
        }

        function _calculerTitres() {
            function _completerCelluleVide(aLigne, aColonne) {
                return this.ListeTitres[aLigne - 1] && this.ListeTitres[aLigne - 1][aColonne] === TypeFusionTitreListe.FusionGauche ? TypeFusionTitreListe.FusionGauche : TypeFusionTitreListe.FusionHaute;
            }
            var lNbLignes, iLigne, iColonne, lNumeroColonne, lValeur, lHintTitres = [];
            if (this._options.colonnes &&
                this._cache.declarationsColonnes &&
                this._cache.declarationsColonnes.length > 0) {
                this.ListeTitres = null;
                lNbLignes = 0;
                for (iColonne = 0; iColonne < this._cache.declarationsColonnes.length; iColonne++) {
                    if (this._cache.declarationsColonnes[iColonne]) {
                        if (MethodesObjet.isArray(this._cache.declarationsColonnes[iColonne].titre)) {
                            lNbLignes = Math.max(lNbLignes, this._cache.declarationsColonnes[iColonne].titre.length);
                        } else if (this._cache.declarationsColonnes[iColonne].titre) {
                            lNbLignes = Math.max(lNbLignes, 1);
                        }
                        if (this._cache.declarationsColonnes[iColonne].sansBordureDroite) {
                            if (!this._options.colonnesSansBordureDroit) {
                                this._options.colonnesSansBordureDroit = [];
                            }
                            this._options.colonnesSansBordureDroit.push(this._cache.declarationsColonnes[iColonne].id);
                        }
                    }
                }
                if (lNbLignes > 0) {
                    this.ListeTitres = [];
                    lNumeroColonne = 0;
                    for (iColonne = 0; iColonne < this._cache.declarationsColonnes.length; iColonne++) {
                        if (this._cache.declarationsColonnes[iColonne]) {
                            for (iLigne = 0; iLigne < lNbLignes; iLigne++) {
                                if (!this.ListeTitres[iLigne]) {
                                    this.ListeTitres[iLigne] = [];
                                }
                                if (!lHintTitres[iLigne]) {
                                    lHintTitres[iLigne] = [];
                                }
                                if (MethodesObjet.isArray(this._cache.declarationsColonnes[iColonne].titre)) {
                                    lValeur = this._cache.declarationsColonnes[iColonne].titre[iLigne];
                                    if (lValeur !== undefined && lValeur !== null) {
                                        this.ListeTitres[iLigne][lNumeroColonne] = lValeur;
                                    } else {
                                        this.ListeTitres[iLigne][lNumeroColonne] = iLigne === 0 ? lNumeroColonne === 0 ? '' : TypeFusionTitreListe.FusionGauche : _completerCelluleVide.call(this, iLigne, lNumeroColonne);
                                    }
                                } else {
                                    lValeur = this._cache.declarationsColonnes[iColonne].titre;
                                    this.ListeTitres[iLigne][lNumeroColonne] = iLigne === 0 ? lValeur !== undefined && lValeur !== null ? lValeur : lNumeroColonne === 0 ? '' : TypeFusionTitreListe.FusionGauche : _completerCelluleVide.call(this, iLigne, lNumeroColonne);
                                }
                                if (MethodesObjet.isArray(this._cache.declarationsColonnes[iColonne].hint)) {
                                    if (this._cache.declarationsColonnes[iColonne].hint[iLigne]) {
                                        lHintTitres[iLigne][lNumeroColonne] = this._cache.declarationsColonnes[iColonne].hint[iLigne];
                                    }
                                } else if (this._cache.declarationsColonnes[iColonne].hint) {
                                    lHintTitres[iLigne][lNumeroColonne] = this._cache.declarationsColonnes[iColonne].hint;
                                }
                            }
                            lNumeroColonne += 1;
                        }
                    }
                }
            } else {
                if (this._options.listeTitres && (this._options.listeTitres.length > 0) && !MethodesObjet.isArray(this._options.listeTitres[0])) {
                    this.ListeTitres = [];
                    this.ListeTitres[0] = MethodesObjet.dupliquer(this._options.listeTitres);
                } else {
                    this.ListeTitres = MethodesObjet.dupliquer(this._options.listeTitres);
                }
                if (this._options.hintTitres && (this._options.hintTitres.length > 0) && !MethodesObjet.isArray(this._options.hintTitres[0])) {
                    lHintTitres[0] = this._options.hintTitres;
                } else {
                    lHintTitres = this._options.hintTitres;
                }
            }
            var lDescripteurSkin = {
                getCouleurFond: this._options.couleursTitre_getCouleurFond,
                getCouleurTexte: this._options.couleursTitre_getCouleurTexte,
                estCoche: false,
                largeurClasseCssImage: null
            };
            for (iLigne in this.ListeTitres) {
                for (iColonne in this.ListeTitres[iLigne]) {
                    var lDescripteur = this.ListeTitres[iLigne][iColonne],
                        lDescripteurModele = Object.assign({}, lDescripteurSkin);
                    if (!lDescripteur) {
                        lDescripteurModele.libelle = '';
                    } else if (MethodesObjet.isObject(lDescripteur)) {
                        Object.assign(lDescripteurModele, lDescripteur);
                        if (MethodesObjet.nomProprieteDeValeur(TypeFusionTitreListe, lDescripteur.libelle) !== '') {
                            lDescripteurModele.fusion = lDescripteur.libelle;
                        }
                        if (lDescripteurModele.couleurFond) {
                            lDescripteurModele.getCouleurFond = function() {
                                return this.couleurFond;
                            };
                        }
                        if (lDescripteurModele.couleurTexte) {
                            lDescripteurModele.getCouleurTexte = function() {
                                return this.couleurTexte;
                            };
                        }
                        if (lDescripteurModele.controleur && MethodesObjet.isObject(lDescripteurModele.controleur)) {
                            Object.keys(lDescripteurModele.controleur).forEach(function(aKey) {
                                if (!this._cache.keysControleurTitre[aKey]) {
                                    if (this.controleur[aKey] || this._cache.keysControleurDonneesListe[aKey]) {
                                        return;
                                    }
                                    this._cache.keysControleurTitre[aKey] = true;
                                }
                            }.bind(this));
                            $.extend(true, this.controleur, lDescripteurModele.controleur);
                        }
                    } else if (MethodesObjet.nomProprieteDeValeur(TypeFusionTitreListe, lDescripteur) !== '') {
                        lDescripteurModele.fusion = lDescripteur;
                    } else if ((lDescripteur.charAt(0) === '[') && (lDescripteur.charAt(lDescripteur.length - 1) === ']')) {
                        lDescripteurModele.classeCssImage = lDescripteur.substr(1, lDescripteur.length - 2);
                    } else if ((lDescripteur.charAt(0) === '{') && (lDescripteur.charAt(lDescripteur.length - 1) === '}')) {
                        lDescripteurModele.libelleHtml = lDescripteur.substr(1, lDescripteur.length - 2);
                    } else if (MethodesObjet.isString(lDescripteur)) {
                        lDescripteurModele.libelle = lDescripteur;
                    } else {
                        lDescripteurModele.libelle = '';
                        GLog.addLog('_ObjetListe.prototype.setOptionsListe : pas de descripteur de colonnes', null, GLog.genre.Avertissement);
                    }
                    if (!lDescripteurModele.title && lHintTitres && lHintTitres[iLigne] && lHintTitres[iLigne][iColonne]) {
                        lDescripteurModele.title = lHintTitres[iLigne][iColonne];
                    }
                    this.ListeTitres[iLigne][iColonne] = lDescripteurModele;
                }
            }
        }
        _ObjetListe.prototype._rechercheTextesContenuListe = function() {};

        function _rechercheTexte_getTexteLigne(aJSelec) {
            return aJSelec.find(':visible:not(.wai_hidden)').contents().filter(function() {
                return this.nodeType === 3;
            }).text();
        }

        function _filtreRechercheTexte(aParamsActualiser) {
            var lCache = this._cache;
            var lOldCache = lCache.rechercheTexte.lignesCachees;
            lCache.rechercheTexte.lignesCachees = [];
            var lRechercheVide = lCache.rechercheTexte.saisie === '';
            if (!lRechercheVide) {
                if (!lCache.rechercheTexte.textesParLigne) {
                    lCache.rechercheTexte.textesParLigne = [];
                    this._rechercheTextesContenuListe();
                }
                var lRecherche = lCache.rechercheTexte.saisie.replace(/\s\s/g, '').replace(/[-[\]/{}()*+?.\\^$|']/g, '\\$&');
                lRecherche = GChaine.normalize(lRecherche);
                var lTabRecherches = lRecherche.split(' ');
                var lIndexsLignesVisibles = [];
                lCache.rechercheTexte.textesParLigne.forEach(function(aInfosLigne, aIndex) {
                    var lLigneVisible = lTabRecherches.every(function(aRech) {
                        if (!new RegExp(aRech, 'i').test(aInfosLigne.texte)) {
                            lCache.rechercheTexte.lignesCachees[aInfosLigne.ligne] = true;
                            return false;
                        }
                        return true;
                    }.bind(this));
                    if (lLigneVisible) {
                        lIndexsLignesVisibles.push(aIndex);
                    }
                }.bind(this));
                lCache.rechercheTexte.lignesCachees.forEach(function(aCachee, aLigne) {
                    if (!aCachee) {
                        return;
                    }
                    var lIndice = lCache.lignesVisiblesSansRechercheTexte.indexOf(aLigne);
                    if (lIndice <= 0) {
                        return;
                    }
                    var lLignePrec = lCache.lignesVisiblesSansRechercheTexte[lIndice - 1];
                    lCache.infosZonesColonnes.forEach(function(aBloc) {
                        if (lCache.rechercheTexte.lignesCachees[aLigne]) {
                            aBloc.colonnesVisibles.forEach(function(aNumeroColonne) {
                                if (lCache.rechercheTexte.lignesCachees[aLigne] && !lCache.rechercheTexte.lignesCachees[lLignePrec] && this.Donnees.fusionCelluleAvecLignePrecedente(_getParamsCellule.call(this, aNumeroColonne, aLigne, {
                                        celluleLignePrecedente: _getParamsCellule.call(this, aNumeroColonne, lLignePrec)
                                    }))) {
                                    lCache.rechercheTexte.lignesCachees[aLigne] = undefined;
                                }
                            }.bind(this));
                        }
                    }.bind(this));
                }.bind(this));
                lIndexsLignesVisibles.forEach(function(aIndex) {
                    var lInfosLigneInitiale = lCache.rechercheTexte.textesParLigne[aIndex];
                    if (!lInfosLigneInitiale) {
                        return;
                    }
                    var lFuncBoucle = function(aInc) {
                        var lLigneVisible = lInfosLigneInitiale.ligne;
                        var lIndex = aIndex + (aInc ? 1 : -1);
                        while (lIndex >= 0 && lIndex < lCache.rechercheTexte.textesParLigne.length) {
                            var lInfosLigne = lCache.rechercheTexte.textesParLigne[lIndex];
                            if (!lInfosLigne || !lCache.rechercheTexte.lignesCachees[lInfosLigne.ligne]) {
                                break;
                            }
                            if (this.Donnees.rechercheTexte_forcerLignePrecSuivVisible(_getParamsCellule.call(this, -1, lLigneVisible), _getParamsCellule.call(this, -1, lInfosLigne.ligne))) {
                                lCache.rechercheTexte.lignesCachees[lInfosLigne.ligne] = undefined;
                                lLigneVisible = lInfosLigne.ligne;
                            } else {
                                break;
                            }
                            lIndex += aInc ? 1 : -1;
                        }
                    };
                    lFuncBoucle.call(this, false);
                    lFuncBoucle.call(this, true);
                }.bind(this));
            }
            if (!MethodesObjet.objetsIdentiques(lCache.rechercheTexte.lignesCachees, lOldCache)) {
                var lParams = Object.assign(aParamsActualiser || {}, {
                    conserverSelection: true,
                    selections: null,
                    zonesActualisation: {
                        contenu: true
                    },
                    estFiltreRechercheTexte: true,
                    avecActualisationPageSiConserverSelection: true,
                    conserverPositionScroll: false
                });
                _ObjetListe.protected._actualiser.call(this, lParams);
            }
        }

        function _calculerTailles() {
            this.ListeTailles = this._cache.colonnes.listeTailles || [];
            var lElement, i, lValeur;
            for (i = 0; i < this.ListeTailles.length; i++) {
                lElement = this.ListeTailles[i];
                if (lElement && lElement.search && lElement.search(/%/) >= 0) {
                    this.ListeTailles[i] = _ObjetListe.initColonne(parseInt(lElement, 10));
                } else if (lElement && lElement.endsWith && lElement.toLowerCase().endsWith('rem')) {
                    var lTailleRem = parseFloat(lElement.toLowerCase().replace('rem', ''));
                    lTailleRem = isNaN(lTailleRem) ? 0 : lTailleRem;
                    this.ListeTailles[i] = {
                        estREM: true,
                        valeurRem: lElement,
                        valeurPx: Math.max(0, GPosition.remToPixels(lTailleRem))
                    };
                } else if (lElement && !MethodesObjet.isObject(lElement)) {
                    lValeur = parseInt(lElement, 10);
                    this.ListeTailles[i] = Math.max(0, isNaN(lValeur) ? 0 : lValeur);
                }
            }
        }

        function _trierDonnees() {
            this.Donnees.triCourant = this._triCourant;
            this.Donnees.trier();
        }

        function _setDonnees(ADonnees, aLigneSelectionne, aParams) {
            this._donneesRecus = true;
            this.Donnees = ADonnees;
            var lControleurDonnees = this.Donnees ? this.Donnees.getControleur(this.Donnees, this) : null;
            if (lControleurDonnees) {
                Object.keys(lControleurDonnees).forEach(function(aKey) {
                    if (!this._cache.keysControleurDonneesListe[aKey]) {
                        if (this.controleur[aKey] || this._cache.keysControleurTitre[aKey]) {
                            return;
                        }
                        this._cache.keysControleurDonneesListe[aKey] = true;
                    }
                }.bind(this));
                $.extend(true, this.controleur, lControleurDonnees);
            }
            this._cache.listeNonInitialisee = false;
            this._cache.rechercheTexte.saisie = '';
            clearTimeout(this._cache.timerKeyPress);
            if (!aParams || !aParams.conserverPageCourante) {
                this._cache.pageCourante = 1;
            }
            this._cache.selectionCellule = {
                ligne: -1,
                colonne: -1
            };
            this._cache.celluleClicNonShift = {
                ligne: -1,
                colonne: -1
            };
            if (this.Donnees) {
                this._cache.lignesSelectionnees = new Array(this.Donnees.GetNbrLignes());
                this._cache.lignesSelectionnees_prec = [];
                if (this.ScrollV) {
                    this.ScrollV.pas = this.Donnees.getHauteurMinCellule(_getParamsCellule.call(this, -1, -1, {
                        pasScroll: true
                    })) || ObjetDonneesListe.hauteurMinCellule;
                }
            }
            _calculsPreRendu.call(this);
            if (this.Donnees) {
                if (_getNonEditable.call(this)) {
                    this.Donnees.setOptions({
                        nonEditable: true
                    });
                }
                this.Donnees.__getIdsColonnes = function() {
                    return this._cache.colonnes.listeIds;
                }.bind(this);
                this.Donnees.__getParams = _getParamsCellule.bind(this);
            }
            var lSelections = null;
            if (this.Donnees && this.Donnees.Donnees && aLigneSelectionne >= 0 && MethodesObjet.isNumber(aLigneSelectionne)) {
                this._cache.selectionCellule.ligne = aLigneSelectionne;
                _trierDonnees.call(this);
                lSelections = [{
                    article: this.Donnees.Donnees.GetElement(this._cache.selectionCellule.ligne)
                }];
            } else if (this.Donnees && this.Donnees.Donnees && aParams && aParams.listeElementsSelection && aParams.listeElementsSelection.GetNbrElements && aParams.listeElementsSelection.GetNbrElements() > 0) {
                lSelections = [];
                aParams.listeElementsSelection.parcourir(function(aElement) {
                    lSelections = [{
                        article: aElement
                    }];
                });
                aParams.listeElementsSelection = null;
                aParams.instancesIdentiquesSelections = false;
                _trierDonnees.call(this);
            }
            _actualiser.call(this, Object.assign({
                selections: lSelections,
                sansTriDonnees: !!lSelections,
                avecEvenementSelection: !!lSelections && lSelections.length > 0,
                avecScrollSelection: !!lSelections && lSelections.length > 0,
                conserverPositionScroll: false
            }, aParams));
            return this;
        }

        function _getLargeurPage() {
            var lJElement = $('#' + this.Nom.escapeJQ());
            if (lJElement.html() === '') {
                lJElement.html('&nbsp;');
            }
            return lJElement.width();
        }

        function _calculerColonnes() {
            this._cache.largeurPage = _getLargeurPage.call(this);
            this._cache.colonnesSansBordureDroit = [];
            if (this._options.colonnesSansBordureDroit) {
                MethodesTableau.parcourir(this._options.colonnesSansBordureDroit, function(aElement, aIndex) {
                    if (aElement === true || aElement === false) {
                        this._cache.colonnesSansBordureDroit[aIndex] = aElement;
                    } else if (MethodesObjet.isString(aElement)) {
                        this._cache.colonnesSansBordureDroit[_getNumeroColonneSelonNumeroOuId.call(this, aElement)] = true;
                    }
                }, this);
            }
            this._cache.taillesColonne = _calculerTaillesColonnes.call(this, this._cache);
            this._cache.calculsTailleColonnesAFaire = !this._cache.largeurPage;
        }

        function _getNumeroColonneSelonNumeroOuId(aColonne, aAccepteErreur) {
            var lNumeroColonne = aColonne;
            if (MethodesObjet.isString(aColonne) && this._cache.colonnes.listeIds) {
                lNumeroColonne = this._cache.colonnes.listeIds.indexOf(aColonne);
                if (lNumeroColonne < 0) {
                    lNumeroColonne = null;
                }
            }
            return lNumeroColonne;
        }

        function _calculerTri() {
            var lNombreTri = 0,
                lOptionsTriParDefaut = null,
                lNumerosColonnesTriDefaut = [],
                lGenreTriColonneTriDefaut = [],
                lGenreColonne, lNumeroColonne, lErreurTriCorrigee = false,
                i;

            function _chercherColonneTriValide(aNumeroColonne, aNumerosColonnesTriDefaut) {
                var lNumeroColonne = aNumeroColonne;
                if (!MethodesObjet.isNumber(lNumeroColonne)) {
                    lNumeroColonne = 0;
                    lErreurTriCorrigee = true;
                }
                while (lNumeroColonne >= 0 && (!_estColonneVisible.call(this, lNumeroColonne) ||
                        this._cache.colonnesTri[lNumeroColonne] !== true ||
                        MethodesTableau.existe(lNumeroColonne, aNumerosColonnesTriDefaut))) {
                    lNumeroColonne += -1;
                    lErreurTriCorrigee = true;
                }
                if (lNumeroColonne < 0) {
                    var lTrouve = false;
                    this._cache.infosZonesColonnes.forEach(function(aBloc) {
                        aBloc.colonnesVisibles.forEach(function(aNumeroColonne) {
                            if (!lTrouve &&
                                this._cache.colonnesTri[aNumeroColonne] === true &&
                                !MethodesTableau.existe(aNumeroColonne, aNumerosColonnesTriDefaut)) {
                                lTrouve = true;
                                lNumeroColonne = aNumeroColonne;
                                lErreurTriCorrigee = true;
                            }
                        }.bind(this));
                    }.bind(this));
                };
                return lNumeroColonne;
            }
            if (this._options.colonnesTriables === true) {
                this._cache.colonnesTri = [];
                for (i = 0; i < this.ListeTailles.length; i++) {
                    this._cache.colonnesTri[i] = true;
                }
            } else {
                this._cache.colonnesTri = [];
                if (this._options.colonnesTriables) {
                    this._cache.listeCorrespondancesColonnes.forEach(function(aNumeroColonneReelle, aNumeroColonneInitiale) {
                        if (this._options.colonnesTriables[aNumeroColonneInitiale] === true || this._options.colonnesTriables[aNumeroColonneInitiale] === false) {
                            if (aNumeroColonneReelle >= 0) {
                                this._cache.colonnesTri[aNumeroColonneReelle] = this._options.colonnesTriables[aNumeroColonneInitiale];
                            }
                        } else if (MethodesObjet.isString(this._options.colonnesTriables[aNumeroColonneInitiale])) {
                            lNumeroColonne = _getNumeroColonneSelonNumeroOuId.call(this, this._options.colonnesTriables[aNumeroColonneInitiale], true);
                            if (lNumeroColonne !== null) {
                                this._cache.colonnesTri[lNumeroColonne] = true;
                            }
                        }
                    }.bind(this));
                }
                if (this._cache.colonnesTri.length === 0) {
                    this._cache.colonnesTri = null;
                }
            }
            lOptionsTriParDefaut = this._options.numeroColonneTriDefaut;
            if (MethodesObjet.isFunction(lOptionsTriParDefaut)) {
                lOptionsTriParDefaut = lOptionsTriParDefaut();
            }
            if (this._cache.colonnesTri && this._cache.colonnesTri.length > 0) {
                if (MethodesObjet.isArray(lOptionsTriParDefaut) && lOptionsTriParDefaut.length > 0) {
                    lNumerosColonnesTriDefaut = [];
                    for (i = 0; i < lOptionsTriParDefaut.length; i++) {
                        lNumeroColonne = null;
                        if (MethodesObjet.isObject(lOptionsTriParDefaut[i])) {
                            if (lOptionsTriParDefaut[i].id) {
                                lNumeroColonne = _getNumeroColonneSelonNumeroOuId.call(this, lOptionsTriParDefaut[i].id, true);
                            }
                            if (lNumeroColonne === null) {
                                lNumeroColonne = lOptionsTriParDefaut[i].numero || 0;
                                lErreurTriCorrigee = true;
                            }
                            lNumeroColonne = lOptionsTriParDefaut[i].numero || 0;
                            lGenreColonne = lOptionsTriParDefaut[i].genre || EGenreTriElement.Croissant;
                        } else {
                            lNumeroColonne = _getNumeroColonneSelonNumeroOuId.call(this, lOptionsTriParDefaut[i], true) || 0;
                            lGenreColonne = EGenreTriElement.Croissant;
                        }
                        lNumeroColonne = _chercherColonneTriValide.call(this, lNumeroColonne, lNumerosColonnesTriDefaut);
                        if (lNumeroColonne >= 0) {
                            lNumerosColonnesTriDefaut.push(lNumeroColonne);
                            lGenreTriColonneTriDefaut.push(lGenreColonne);
                        }
                    }
                    lNombreTri = lNumerosColonnesTriDefaut.length;
                } else {
                    lNombreTri = 1;
                    lNumeroColonne = null;
                    if (MethodesObjet.isObject(lOptionsTriParDefaut)) {
                        if (lOptionsTriParDefaut.id) {
                            lNumeroColonne = _getNumeroColonneSelonNumeroOuId.call(this, lOptionsTriParDefaut.id, true) || 0;
                        }
                        if (lNumeroColonne === null) {
                            lNumeroColonne = lOptionsTriParDefaut.numero || 0;
                            lErreurTriCorrigee = true;
                        }
                        lGenreColonne = lOptionsTriParDefaut.genre || EGenreTriElement.Croissant;
                    } else {
                        lNumeroColonne = _getNumeroColonneSelonNumeroOuId.call(this, lOptionsTriParDefaut, true) || 0;
                        lGenreColonne = EGenreTriElement.Croissant;
                    }
                    lNumeroColonne = _chercherColonneTriValide.call(this, parseInt(lNumeroColonne || 0, 10), lNumerosColonnesTriDefaut);
                    lNumerosColonnesTriDefaut = [lNumeroColonne];
                    lGenreTriColonneTriDefaut = [lGenreColonne];
                }
            }
            this._triCourant = {
                colonne: [],
                genre: [],
                nombreTri: lNombreTri
            };
            for (i = 0; i < lNombreTri; i++) {
                this._triCourant.colonne[i] = lNumerosColonnesTriDefaut[i];
                this._triCourant.genre[i] = lGenreTriColonneTriDefaut[i];
            }
            if (lErreurTriCorrigee) {
                _setOptionEvenementSurTri.call(this);
            }
        }

        function _calculerParametresCreation() {
            function _ajouterColonne(aColonne) {
                var lNumeroColonne = _getNumeroColonneSelonNumeroOuId.call(this, aColonne);
                if (MethodesObjet.isNumber(lNumeroColonne)) {
                    if (this._cache.colonnes.listeTailles && (lNumeroColonne < 0 || lNumeroColonne >= this._cache.colonnes.listeTailles.length)) {
                        require('IELog.js').addLog('options.listeCreations [_calculerParametresCreation], la colonne numero ' + aColonne + ' n\'existe pas !');
                    }
                    this.ListeCreations.push(lNumeroColonne);
                }
            }
            this.ListeCreations = [];
            if (Array.isArray(this._options.listeCreations)) {
                MethodesTableau.parcourir(this._options.listeCreations, _ajouterColonne, this);
            } else {
                _ajouterColonne.call(this, this._options.listeCreations);
            }
        }

        function _avecLigneCreationTitre() {
            var lAvecLigneCreation = !_getNonEditable.call(this) && this._options.avecLigneCreation && !!this.Donnees;
            if (lAvecLigneCreation && this._cache.infosZonesColonnes.length > 1) {
                lAvecLigneCreation = false;
            }
            return lAvecLigneCreation;
        }

        function _getLargeurPartieScrollV() {
            return Math.max(this.ScrollV ? this.ScrollV.Largeur : 0, _avecBoutonsListe.call(this) ? (this._options.tailleBoutons + 1) : 0);
        }

        function _calculerTaillesColonnes(aCache, aPourImpression) {
            var lTaillesColonne = [];
            if (!this.ListeTailles) {
                return lTaillesColonne;
            }
            this.ListeTailles.forEach(function() {
                lTaillesColonne.push({
                    px: 0
                });
            });
            var i, lTailleRestante, lTaille, lTotalValeurs = 0,
                lColonnesPourcent = [],
                lElement, lNumeroColonne;
            aCache.avecPourcentage = false;
            aCache.largeurTotalFixe = 0;
            aCache.largeurTotalCalcule = 0;
            for (i = 0; i < this.ListeTailles.length; i++) {
                if (_estColonneVisible.call(this, i)) {
                    if (this.ListeTailles[i] && this.ListeTailles[i].valeur && !this.ListeTailles[i].estREM) {
                        aCache.avecPourcentage = true;
                        lTotalValeurs += this.ListeTailles[i].valeur;
                        lElement = {
                            indice: i,
                            valeur: this.ListeTailles[i].valeur,
                            min: Math.max(_CONST_largeurMinColonne, this.ListeTailles[i].min ? parseInt(this.ListeTailles[i].min, 10) : 0),
                            max: this.ListeTailles[i].max ? parseInt(this.ListeTailles[i].max, 10) : 0
                        };
                        lColonnesPourcent.push(lElement);
                        Object.assign(lTaillesColonne[i], lElement, {
                            estPourcent: true
                        });
                        aCache.largeurTotalFixe += lElement.min + 2 * this._options.paddingCelluleLR + 1;
                    } else if (this.ListeTailles[i] && this.ListeTailles[i].estREM) {
                        lTaillesColonne[i].px = this.ListeTailles[i].valeurPx;
                        Object.assign(lTaillesColonne[i], this.ListeTailles[i]);
                        aCache.largeurTotalFixe += this.ListeTailles[i].valeurPx + 2 * this._options.paddingCelluleLR + 1;
                    } else {
                        lTaillesColonne[i].px = this.ListeTailles[i];
                        aCache.largeurTotalFixe += this.ListeTailles[i] + 2 * this._options.paddingCelluleLR + 1;
                    }
                }
            }
            var lTotal = 0;
            lTaillesColonne.forEach(function(aCol) {
                if (aCol.estPourcent) {
                    aCol.pourcent = Math.floor(lTotalValeurs * 100 / aCol.valeur);
                    lTotal += aCol.pourcent;
                }
            });
            if (lTotal < 100) {
                lTaillesColonne.forEach(function(aCol) {
                    if (aCol.estPourcent) {
                        aCol.pourcent += 100 - lTotal;
                        return false;
                    }
                    return true;
                });
            }
            aCache.largeurTotalFixe = Math.max(0, aCache.largeurTotalFixe - 1);
            aCache.largeurTotalCalcule = aCache.largeurTotalFixe;
            if (!aCache.largeurPage) {
                return lTaillesColonne;
            }
            if (aCache.avecPourcentage) {
                lTailleRestante = aCache.largeurPage - (aPourImpression ? 0 : _getLargeurPartieScrollV.call(this)) - aCache.largeurTotalFixe - this._options.borduresContenu_left - this._options.borduresContenu_right;
                lTailleRestante = Math.max(0, lTailleRestante);
                var lAvecMax = true;
                while (lAvecMax) {
                    lAvecMax = false;
                    for (i in lColonnesPourcent) {
                        lElement = lColonnesPourcent[i];
                        if (!lElement) {
                            continue;
                        }
                        lTaille = lElement.min + Math.max(0, Math.round(lTailleRestante * lElement.valeur / lTotalValeurs));
                        if (lElement.max && lTaille > lElement.max) {
                            lTaillesColonne[lElement.indice].px = lTaille = lElement.max;
                            lTailleRestante -= lTaille - lElement.min;
                            lTotalValeurs -= lElement.valeur;
                            aCache.largeurTotalCalcule += lTaille - lElement.min;
                            lAvecMax = true;
                            delete lColonnesPourcent[i];
                            break;
                        }
                    }
                }
                for (i in lColonnesPourcent) {
                    lElement = lColonnesPourcent[i];
                    if (!lElement) {
                        continue;
                    }
                    lNumeroColonne = lElement.indice;
                    lTaillesColonne[lNumeroColonne].px = lElement.min +
                        Math.max(0, Math.round(lTailleRestante * lElement.valeur / lTotalValeurs));
                    lTailleRestante -= lTaillesColonne[lNumeroColonne].px - lElement.min;
                    lTotalValeurs -= lElement.valeur;
                    aCache.largeurTotalCalcule += lTaillesColonne[lNumeroColonne].px - lElement.min;
                }
            }
            aCache.largeurBlocFixe = 0;
            aCache.infosZonesColonnes.forEach(function(aInfos) {
                aInfos.largeurBloc = 0;
                aInfos.colonnesVisibles.forEach(function(aNumeroCol) {
                    var lTaille = lTaillesColonne[aNumeroCol].px + 2 * this._options.paddingCelluleLR + 1;
                    aInfos.largeurBloc += lTaille;
                    if (aInfos.estBlocFixe) {
                        aCache.largeurBlocFixe += lTaille;
                    }
                }.bind(this));
            }.bind(this));
            return lTaillesColonne;
        }
        _ObjetListe.prototype._gererModificationsColonnes = function() {
            this._cache.listeCorrespondancesColonnes = [];
        };

        function _calculsPreRendu(aIgnorerCalculTri) {
            var lAvecCalculPreRendu = this._cache.calculsPreRenduAFaire;
            if (lAvecCalculPreRendu) {
                this._cache.calculsPreRenduAFaire = false;
                this._gererModificationsColonnes();
                this._preparerBoutons();
                _calculerTailles.call(this);
                _calculColonnesCachees.call(this, this._cache);
                this._getInfosZonesColonnes(this._cache);
                _calculerTitres.call(this);
                _calculerParametresCreation.call(this);
                if (aIgnorerCalculTri !== true || this._cache.calculTriAFaire) {
                    this._cache.calculTriAFaire = false;
                    _calculerTri.call(this);
                }
            }
            if (this._cache.calculsTailleColonnesAFaire || lAvecCalculPreRendu) {
                _calculerColonnes.call(this);
            }
        }
        _ObjetListe.prototype._backupScroll = function() {
            return null;
        };
        _ObjetListe.prototype._setScroll = function() {};
        _ObjetListe.prototype._controleHeightLigne = function() {};

        function _actualiser(aParams) {
            var lParams = Object.assign({
                conserverSelection: false,
                conserverFocusSelection: false,
                ignorerFocusListe: true,
                sansTriDonnees: false,
                ignorerCalculTri: false,
                selections: null,
                instancesIdentiquesSelections: true,
                avecEvenementSelection: false,
                avecScrollSelection: false,
                avecSelectionSurLigneInvisible: false,
                conserverPositionScroll: true,
                avecActualisationPageSiConserverSelection: true,
                avecEvenementModificationSelection: true
            }, aParams);
            var lZonesActualisation = this.optionsInterne.avecActualisationParZone ? lParams.zonesActualisation : false;
            if (this._cache.creationEnCours) {
                lZonesActualisation = false;
            }
            this._cache.creationEnCours = false;
            this._cache.editionEnCours = false;
            this._cache.editionEnCoursEvenement = false;
            this._cache.positionCreation = 0;
            this._cache.listeValeursCreation = [];
            this._cache.finEditionCreation = null;
            clearTimeout(this._cache.rechercheTexte.timerSaisie);
            _nettoyerElementsEditionEnCours.call(this);
            if (!GHtml.elementExiste(this.Nom)) {
                return;
            }
            if (this._options.avecModeAccessible && GEtatUtilisateur.getModeAccessible()) {
                _calculsPreRendu.call(this, lParams.ignorerCalculTri);
                return this._construireListeModeAccessible();
            }
            var lSelections = null,
                lIdFocusARestaurer = '',
                lFocusSurListe;
            if (!lParams.ignorerFocusListe && GHtml.focusEstDansElement && GHtml.focusEstDansElement(this.Nom)) {
                lFocusSurListe = true;
                lIdFocusARestaurer = this.IdPremierElement;
            }
            var lSelectionsPrecedente = null;
            if (this.Donnees) {
                if (lParams.selections) {
                    lSelections = lParams.selections;
                } else if (lParams.conserverSelection) {
                    lSelections = _getCellulesSelection.call(this);
                } else {
                    if (lParams.avecEvenementModificationSelection) {
                        lSelectionsPrecedente = _getCellulesSelection.call(this, true);
                    }
                    this._cache.selectionCellule.ligne = -1;
                    this._cache.selectionCellule.colonne = -1;
                    this._cache.lignesSelectionnees = new Array(this.Donnees.GetNbrLignes());
                    this._cache.lignesSelectionnees_prec = [];
                }
                if (lParams.sansTriDonnees !== true) {
                    _trierDonnees.call(this);
                }
                if (lFocusSurListe &&
                    lParams.conserverFocusSelection &&
                    this._cache.selectionCellule.ligne >= 0 &&
                    this._cache.selectionCellule.colonne >= 0) {
                    lIdFocusARestaurer = this.getIdCellule(this._cache.selectionCellule.colonne, this._cache.selectionCellule.ligne) + '_div';
                }
            }
            var lBackupScroll = this._backupScroll(lParams);
            if (!lZonesActualisation) {
                GHtml.setHtml(this.Nom, '', {
                    ignorerScroll: true
                });
                this._cache.heightConteneur = GPosition.getClientRect(this.Nom, true).innerHeight;
                var lForcerNouveauTri = this.Donnees && this._cache.calculsPreRenduAFaire && lParams.ignorerCalculTri !== true && lParams.sansTriDonnees !== true;
                _calculsPreRendu.call(this, lParams.ignorerCalculTri);
                if (lForcerNouveauTri) {
                    _trierDonnees.call(this);
                }
            }
            var lAvecFiltreRecherche = !lParams.estFiltreRechercheTexte;
            if (lZonesActualisation) {
                this._actualiserZones(lZonesActualisation, lParams);
                lAvecFiltreRecherche = lAvecFiltreRecherche && lZonesActualisation.contenu;
            } else {
                var lCommentaireDebug = '';
                GHtml.setHtml(this.Nom, this.ConstruireAffichage(lParams), {
                    controleur: this.controleur,
                    ignorerScroll: true,
                    commentaireHtmlDebug: lCommentaireDebug
                });
                this._controleHeightLigne();
            }
            this._setScroll(lBackupScroll);
            if (lIdFocusARestaurer) {
                if (!GHtml.elementExiste(lIdFocusARestaurer)) {
                    lIdFocusARestaurer = this.IdPremierElement;
                }
                GHtml.setFocus(lIdFocusARestaurer);
            }
            if (Array.isArray(lSelections)) {
                _setCellulesSelection.call(this, lSelections, {
                    instancesIdentiques: lParams.instancesIdentiquesSelections,
                    avecEvenement: lParams.avecEvenementSelection,
                    avecScroll: lParams.avecScrollSelection,
                    avecSelectionSurLigneInvisible: lParams.avecSelectionSurLigneInvisible,
                    avecActualisationPage: lParams.avecActualisationPageSiConserverSelection,
                    avecEvenementModificationSelection: lParams.avecEvenementModificationSelection
                });
            } else if (lParams.avecEvenementModificationSelection && lSelectionsPrecedente && lSelectionsPrecedente.length > 0) {
                _surModificationSelectionEvenement.call(this, lSelectionsPrecedente);
            }
            if (this._options.piedDeListe &&
                this._options.piedDeListe.getContenu &&
                !lZonesActualisation) {
                GHtml.setHtml(this.idPiedDeListe, '<div style="' + GStyle.composeHeight(this._options.piedDeListe.height) +
                    GStyle.composeWidth(this._cache.largeurTotalCalcule + 1) + 'margin-top:5px;overflow:hidden;">' +
                    this._options.piedDeListe.getContenu() + '</div>', {
                        controleur: this._options.piedDeListe.controleur || this.controleur,
                        ignorerScroll: true
                    });
            }
            if (this._apresActualiser) {
                this._apresActualiser(lParams);
            }
            if (lAvecFiltreRecherche) {
                _filtreRechercheTexte.call(this, lParams);
            }
        }

        function _getHeightCellule(aParamsCellule, aPourHauteurContenu) {
            var lHeight = 0;
            if (aPourHauteurContenu) {
                lHeight = this.Donnees.getHauteurMinContenuCellule(aParamsCellule);
            }
            if (!lHeight) {
                lHeight = this.Donnees.getHauteurMinCellule(aParamsCellule) || ObjetDonneesListe.hauteurMinCellule;
            }
            return lHeight + (Support.bordureExterneTD ? 0 : -1);
        }
        _ObjetListe.prototype._setStyleCellule = function() {};

        function _afficherMessage(aParamsCellule) {
            var LMessage = this.Donnees.GetMessage();
            if (LMessage) {
                GApplication.getMessage().Afficher(EGenreBoiteMessage.Information, null, LMessage);
            } else if (this.Donnees.AvecEtatSaisie(aParamsCellule)) {
                this.SetEtatSaisie(true);
            }
        }

        function _SurCreationEvenement(I) {
            if (this.Donnees) {
                if (this.Donnees.AvecEvenement_Creation(I)) {
                    if (this.Pere && this.Evenement) {
                        var lResult = this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.Creation, I, null, {
                            listeValeursCreation: this._cache.listeValeursCreation
                        }), EGenreEvenementListe.Creation, I, null);
                        _refreshSelf.call(this);
                        return lResult;
                    }
                }
            }
        }

        function _setOptionEvenementSurTri() {
            if (this._options.evenementSurTri &&
                this._triCourant &&
                this._triCourant.colonne &&
                this._cache.colonnes.listeIds) {
                var lTabTri = [];
                for (var i = 0; i < this._triCourant.colonne.length; i++) {
                    lTabTri.push({
                        numero: this._triCourant.colonne[i],
                        id: this._cache.colonnes.listeIds[this._triCourant.colonne[i]],
                        genre: this._triCourant.genre[i]
                    });
                }
                this._options.evenementSurTri(lTabTri);
            }
        }

        function _setColonneTri(aColonne, aGenre, aNumeroTri) {
            var lNumeroTri = aNumeroTri || 0,
                lNumeroColonne = MethodesObjet.isString(aColonne) ? this.getNumeroColonneDIdColonne(aColonne) : aColonne,
                lNumeroAncienTri = this._triCourant.colonne.indexOf(lNumeroColonne);
            if (lNumeroAncienTri >= 0 && lNumeroAncienTri !== lNumeroTri) {
                this._triCourant.colonne[lNumeroAncienTri] = this._triCourant.colonne[lNumeroTri];
            }
            this._triCourant.genre[lNumeroTri] = (aGenre !== null && aGenre !== undefined) ? aGenre : EGenreTriElement.Croissant;
            this._triCourant.colonne[lNumeroTri] = lNumeroColonne;
            _setOptionEvenementSurTri.call(this);
            this._cache.infosZonesColonnes.forEach(function(aInfosZoneColonnes) {
                $('#' + this.ids.curseurTriSurvol.escapeJQ() + aInfosZoneColonnes.indiceBloc).hide();
                for (var lITri = 0; lITri < this._triCourant.nombreTri; lITri++) {
                    var lNode = GHtml.getElement(this.ids.curseurTri + aInfosZoneColonnes.indiceBloc + '_' + lITri);
                    if (lNode) {
                        _positionnerCurseurTri.call(this, aInfosZoneColonnes, lNode, lITri);
                        GHtml.setHtml(lNode, this._getDessinCurseurTri({
                            triCroissant: this._triCourant.genre[lITri] === EGenreTriElement.Croissant,
                            triPrincipal: lITri === 0
                        }), {
                            instance: this,
                            ignorerScroll: true
                        });
                    }
                }
            }.bind(this));
            return new Promise(function(aResolve) {
                setTimeout(aResolve, 0);
            }).then(function() {
                _actualiser.call(this, {
                    conserverSelection: true,
                    sansTriDonnees: false,
                    ignorerCalculTri: true,
                    zonesActualisation: {
                        contenu: true
                    }
                });
            }.bind(this));
        }

        function _extraireInfosId(aId) {
            if (!aId) {
                return false;
            }
            var lInfos = {};
            var lIds = aId.split('_');
            if (lIds[lIds.length - 1] === 'div') {
                lInfos.ligne = parseInt(lIds[lIds.length - 2], 10);
                lInfos.colonne = parseInt(lIds[lIds.length - 3], 10);
            } else {
                lInfos.ligne = parseInt(lIds[lIds.length - 1], 10);
                lInfos.colonne = parseInt(lIds[lIds.length - 2], 10);
            }
            return lInfos;
        }

        function _focusSuivant(AId, AOrientation, ADirection) {
            var LIdSuivant = this.getIdNavigationSuivant(AId, AOrientation, ADirection);
            if (LIdSuivant) {
                GHtml.setFocus(LIdSuivant);
                if (this._options.avecSelectionSurNavigationClavier) {
                    var lInfos = _extraireInfosId(LIdSuivant);
                    if (lInfos) {
                        this.selectionnerCellule({
                            ligne: lInfos.ligne,
                            colonne: lInfos.colonne,
                            deselectionnerTout: true,
                            selectionner: true,
                            avecEvenement: true
                        });
                    }
                }
            }
        }
        _ObjetListe.prototype._ouvrirMenuContextuel = function() {};

        function _SurSelectionEvenement(I, J, aSurClavier, aSurInteractionUtilisateur) {
            var lParams = _getParamsCellule.call(this, I, J);
            if (this.Donnees && (J > -1)) {
                if (this.Donnees.AvecEvenement_Selection(lParams.colonne, lParams.article, lParams)) {
                    if (this.Pere && this.Evenement) {
                        this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.Selection, I, J, {
                            surClavier: aSurClavier,
                            surInteractionUtilisateur: aSurInteractionUtilisateur === false ? false : true
                        }), EGenreEvenementListe.Selection, I, J);
                    }
                }
            }
            _refreshSelf.call(this);
            return true;
        }

        function _surModificationSelectionEvenement(aSelectionsAncienne, aSurInteractionUtilisateur) {
            if (!this.Donnees || !this.Donnees.options.avecEvnt_ModificationSelection) {
                return false;
            }
            var lSelectionCourante = _getCellulesSelection.call(this);
            if (aSelectionsAncienne && lSelectionCourante && aSelectionsAncienne.length === lSelectionCourante.length) {
                var lIdentique = lSelectionCourante.every(function(aSelection, aIndex) {
                    var lSelection = aSelectionsAncienne[aIndex];
                    return aSelection.ligne === lSelection.ligne && aSelection.article === lSelection.article && MethodesObjet.objetsIdentiques(aSelection.colonnes, lSelection.colonnes);
                });
                if (lIdentique) {
                    return false;
                }
            }
            if (this.Pere && this.Evenement) {
                this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.ModificationSelection, -1, -1, {
                    cellulesSelection: lSelectionCourante,
                    surInteractionUtilisateur: !!aSurInteractionUtilisateur
                }), EGenreEvenementListe.ModificationSelection, -1, -1);
                _refreshSelf.call(this);
                return true;
            }
            return false;
        }

        function _refreshSelf() {
            if (this.Pere && this.Pere.$refresh) {
                this.Pere.$refresh();
            } else {
                this.$refreshSelf();
            }
        }

        function _SurSuppressionEvenement(aParams) {
            var lResult = false;
            if (this.Donnees && (aParams.ligne > -1 || (aParams.listeSuppressions && aParams.listeSuppressions.GetNbrElements() > 0))) {
                if (this.Donnees.AvecEvenement_Suppression(aParams.article, aParams)) {
                    if (this.Pere && this.Evenement) {
                        lResult = true;
                        this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.Suppression, aParams.colonne, aParams.ligne, aParams), EGenreEvenementListe.Suppression, aParams.colonne, aParams.ligne);
                    }
                }
            }
            _refreshSelf.call(this);
            return lResult;
        }

        function _SurApresCreationEvenement(aLigne) {
            if (!this.Donnees) {
                return;
            }
            var lParams = _getParamsCallback.call(this, EGenreEvenementListe.ApresCreation, null, aLigne);
            if (this.Donnees.AvecEvenement_ApresCreation(lParams)) {
                if (this.Pere && this.Evenement) {
                    var lResult = this.Evenement.call(this.Pere, lParams, EGenreEvenementListe.ApresCreation, null, null);
                    _refreshSelf.call(this);
                    return lResult;
                }
            }
        }

        function _SurApresErreurCreationEvenement() {
            if (this.Donnees) {
                if (this.Donnees.AvecEvenement_ApresErreurCreation()) {
                    if (this.Pere && this.Evenement) {
                        var lResult = this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.ApresErreurCreation, null, null), EGenreEvenementListe.ApresErreurCreation, null, null);
                        _refreshSelf.call(this);
                        return lResult;
                    }
                }
            }
        }

        function _SurApresEditionEvenement(aParams) {
            if (this.Donnees) {
                if (this.Donnees.AvecEvenement_ApresEdition(aParams.ligne, aParams.colonne, aParams.article, aParams)) {
                    if (this.Pere && this.Evenement) {
                        this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.ApresEdition, aParams.colonne, aParams.ligne, {
                            avecModification: !!aParams.avecModification
                        }), EGenreEvenementListe.ApresEdition, aParams.colonne, aParams.ligne);
                    }
                }
            }
            _refreshSelf.call(this);
            return true;
        }

        function _SurApresSuppressionEvenement(aParams) {
            if (this.Donnees) {
                if (this.Donnees.AvecEvenement_ApresSuppression()) {
                    if (this.Pere && this.Evenement) {
                        this.Evenement.call(this.Pere, _getParamsCallback.call(this, EGenreEvenementListe.ApresSuppression, aParams.colonne, aParams.ligne, aParams), EGenreEvenementListe.ApresSuppression, aParams.colonne, aParams.ligne);
                    }
                }
            }
            _refreshSelf.call(this);
        }

        function _Entrer_Edition() {
            _nettoyerElementsEditionEnCours.call(this);
            this._setStyleCellule(this.IdCellule, null, null, false, true);
        }

        function _getHTMLControleTexte(aParams) {
            var lControle = this.Donnees.getControleCaracteresInput(aParams),
                lIEMask = '',
                lMaxLength = '';
            if (lControle && lControle.mask) {
                lIEMask = 'ie-mask="/[^' + lControle.mask + ']/i" ';
            }
            if (lControle && lControle.tailleMax > 0 && lControle.tailleMax < this._options.maxLengthTextareaIgnore) {
                lMaxLength = 'maxlength="' + lControle.tailleMax + '" ';
            }
            if (!lMaxLength && IEHtml.MAX_LENGTH_Default > 0 && this.Donnees._GetTailleTexteMax(aParams) > IEHtml.MAX_LENGTH_Default) {
                lMaxLength = 'maxlength="0" ';
            }
            return lIEMask + lMaxLength;
        }

        function _toString(aValeur) {
            return aValeur + '';
        }

        function _setValueModel(aParams) {
            var lParams = Object.assign({
                node: null,
                ligne: -1,
                colonne: -1,
                surCreation: false,
                value: '',
                estNote: false
            }, aParams);
            this._cache.avecModificationSaisie = true;
            if (this._fenetreInformationAffichee) {
                return;
            }
            if (lParams.surCreation) {
                if (this._messageEnCoursSurCreation) {
                    return;
                }
                if (!this._cache.creationEnCours) {
                    return;
                }
                lParams.colonne = this._cache.numeroColonneCreationEnCours;
                lParams.ligne = -1;
            } else {
                if (!this._cache.editionEnCours && !this.enEditionEvenement) {
                    return;
                }
            }
            if (lParams.estNote) {
                this._valeurEnEdition = lParams.value;
                return;
            }
            this._valeurEnEdition = _toString(lParams.value);
            var lParamsCellule = _getParamsCellule.call(this, lParams.colonne, lParams.ligne, {
                surEdition: true,
                surLigneCreation: lParams.surCreation,
                surInputSaisie: true
            });
            var lControle = GChaine.controleTailleTexte({
                chaine: this._valeurEnEdition,
                tailleTexteMax: this.Donnees._GetTailleTexteMax(lParamsCellule)
            });
            if (!lControle.controleOK) {
                this._valeurEnEdition = lControle.chaine;
                this._fenetreInformationAffichee = true;
                GApplication.getMessage().afficher({
                    type: EGenreBoiteMessage.Information,
                    message: this.Donnees.GetMessage_TailleMaximaleSaisie(lParams),
                    callback: function() {
                        this._fenetreInformationAffichee = false;
                        GHtml.setFocus(lParams.node);
                    }.bind(this)
                });
            }
        }

        function _Entrer_Texte(aColonne, aLigne, aSurLigneCreation, aTypeCellule, aIgnorerEventsNode) {
            var lParamsCellule = _getParamsCellule.call(this, aColonne, aLigne, {
                surEdition: true,
                surLigneCreation: aSurLigneCreation,
                surInputSaisie: true
            });
            var LValeur = this.Donnees._GetValeur(lParamsCellule),
                lClass = '',
                lEstNote = aTypeCellule === ObjetDonneesListe.ETypeCellule.Note;
            if (!lEstNote) {
                LValeur = _toString(LValeur);
            }
            this._celluleEditee_bak = GHtml.getHtml(this.IdCellule);
            this._valeurEnEdition = LValeur;
            try {
                lClass = this.Donnees.getClass(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article);
            } catch (e) {
                lClass = '';
            }
            var lHeight = _getHeightCellule.call(this, lParamsCellule),
                lBalise = lEstNote ? 'ie-inputnote' : 'input';
            var lMarginTop = 0;
            var H = [];
            if (this.optionsInterne.versionMobile) {
                H.push('<div>');
            } else {
                lMarginTop = Math.round((lHeight - GChaine.GetHauteurPolice(10)) / 2);
                H.push('<div style="height:' + $('#' + this.IdCellule.escapeJQ()).height() + 'px; width:100%; padding: 0px ', this._options.paddingCelluleLR, 'px; box-sizing: border-box;">');
            }
            H.push('<', lBalise, ' id="' + this.IdEdition + '"', ' class="Texte10 Liste_Input_Texte ' + (lClass || '') + '"', ' style="border: 0px; margin-top:' + lMarginTop + 'px"', GHtml.composeAttr('ie-model', 'liste.saisieTexte', [aLigne, aColonne, !!aSurLigneCreation, lEstNote, false, aIgnorerEventsNode]), (lEstNote ? '' : _getHTMLControleTexte.call(this, lParamsCellule)), (lEstNote ? ' autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"' : ''), (!aSurLigneCreation ? '' : ' size="1"'), '></', lBalise, '>', '</div>');
            GHtml.setHtml(this.IdCellule, H.join(''), {
                instance: this
            });
        }

        function _getInfosZoneColonneDeNumeroColonne(aNumeroColonne) {
            var lInfosZone = null;
            this._cache.infosZonesColonnes.every(function(aZone) {
                if (aNumeroColonne >= aZone.indiceColonneDebut && aNumeroColonne <= aZone.indiceColonneFin) {
                    lInfosZone = aZone;
                    return false;
                }
                return true;
            });
            return lInfosZone || this._cache.infosZonesColonnes[this._cache.infosZonesColonnes.length - 1];
        }

        function _afficher_marqueurEditionSurCellule(aColonne, aLigne) {
            var lJConteneur = $('#' + this.ids.zoneFils.escapeJQ());
            $('#' + this.ids.surligneur_edition.escapeJQ()).remove();
            var lFunc = function() {
                var lRectCellule = GPosition.getClientRect(this.getIdCellule(aColonne, aLigne));
                var lRectContenur = GPosition.getClientRect(this.ids.zoneFils);
                var lInfosZone = _getInfosZoneColonneDeNumeroColonne.call(this, aColonne);
                var lPremiereColonneBlocFixeDroite = lInfosZone.estBlocFixeDroite && aColonne === lInfosZone.indiceColonneDebut;
                var lPos = {
                    top: lRectCellule.top - lRectContenur.top - 2,
                    left: lRectCellule.left + (lPremiereColonneBlocFixeDroite ? 1 : 0) - lRectContenur.left - 2,
                    height: lRectCellule.height + (this.optionsInterne.versionMobile ? 0 : -1),
                    width: lRectCellule.width + (this.optionsInterne.versionMobile ? 0 : -1)
                };
                if (lPos.left + lPos.width > lRectContenur.width) {
                    lPos.width = Math.max(1, lPos.width - (lPos.left + lPos.width - lRectContenur.width + 2));
                }
                return lPos;
            }.bind(this);
            var lPos = lFunc();
            lJConteneur.IEHtmlAppend(['<div id="', this.ids.surligneur_edition, '" class="liste_surligneur_edition" style="', 'border-color:', this._options.avecListeNeutre ? GCouleur.themeNeutre.foncee : GCouleur.themeCouleur.foncee, ';', GStyle.composeWidth(lPos.width), GStyle.composeHeight(lPos.height), 'top:' + lPos.top + 'px;', 'left:' + lPos.left + 'px;', '">', '</div>'].join(''));
            $('#' + this.ids.surligneur_edition.escapeJQ()).data('positionnement', {
                func: function() {
                    var lPos = lFunc();
                    $('#' + this.ids.surligneur_edition.escapeJQ()).css({
                        left: lPos.left,
                        top: lPos.top
                    });
                }.bind(this)
            });
        }

        function _Entrer_ZoneTexte(aColonne, aLigne, aSurLigneCreation, aNumeroLigneCreation, aIgnorerEventsNode) {
            var lParamsCellule = _getParamsCellule.call(this, aColonne, aLigne, {
                surEdition: true,
                surLigneCreation: aSurLigneCreation,
                surInputSaisie: true,
                numeroLigneCreation: aNumeroLigneCreation
            });
            this._valeurEnEdition = this.Donnees._GetValeur(lParamsCellule);
            this._valeurEnEdition = _toString(this._valeurEnEdition);
            var lTailleMax = 0,
                lControle = this.Donnees.getControleCaracteresInput(lParamsCellule);
            if (lControle) {
                lTailleMax = lControle.tailleMax || 0;
            }
            if (lTailleMax === 0 || !MethodesObjet.isNumber(lControle.tailleMax)) {
                lTailleMax = this.Donnees._GetTailleTexteMax(lParamsCellule) || 0;
            }
            if (lTailleMax >= this._options.maxLengthTextareaIgnore || !MethodesObjet.isNumber(lTailleMax)) {
                lTailleMax = 0;
            }
            var T = [];
            var lNomBalise = lTailleMax > 0 ? 'ie-textareamax' : 'textarea';
            lNomBalise = 'ie-textareamax';
            T.push('<', lNomBalise, ' ' + GHtml.composeAttr('ie-model', 'liste.saisieTexte', [aLigne, aColonne, !!aSurLigneCreation, false, true, aIgnorerEventsNode]) + ' id="' + this.IdEdition + '" class="Texte10 Table BorderBox FondBlanc" ' + 'style="margin:0; ' + GStyle.composeCouleurBordure(this._options.couleursListe.editable.getBordure(false), 1) + '" ' + _getHTMLControleTexte.call(this, lParamsCellule) + (lTailleMax > 0 ? ' ie-compteurmax="' + lTailleMax + '"' : '') + '></', lNomBalise, '>');
            var lInfosZone = _getInfosZoneColonneDeNumeroColonne.call(this, aColonne),
                lPremiereColonneBlocFixeDroite = lInfosZone.estBlocFixeDroite && aColonne === lInfosZone.indiceColonneDebut,
                lEstLigneCreationTitre = aSurLigneCreation && !(aNumeroLigneCreation >= 0);
            var lOffset = $('#' + this.IdCellule.escapeJQ()).offset();
            var lJConteneur = $('#' + this.ids.zoneFils.escapeJQ());
            var lOffsetConteneur = lJConteneur.offset();
            var lHeightConteneur = lJConteneur.height();
            var lPositionnement = {
                width: GPosition.getWidth(this.IdCellule) + 1 + (lInfosZone.dernierBloc && aColonne === lInfosZone.indiceColonneFin ? 1 : 0) + (lPremiereColonneBlocFixeDroite ? -1 : 0),
                height: Math.max(Math.min(100, lHeightConteneur), GPosition.getHeight(this.IdCellule) + 1),
                left: lOffset.left - 1 + (lPremiereColonneBlocFixeDroite ? 1 : 0) - lOffsetConteneur.left,
                top: lOffset.top + (lEstLigneCreationTitre ? 0 : -1) - lOffsetConteneur.top
            };
            if (lOffset.top - lOffsetConteneur.top + lPositionnement.height >= lHeightConteneur) {
                lPositionnement.top = Math.max(0, lPositionnement.top - (lOffset.top - lOffsetConteneur.top + lPositionnement.height - lHeightConteneur));
            }
            lJConteneur.IEHtmlAppend(['<div id="' + this.IdZoneTexte + '" class="liste_saisie_textarea" style="', GStyle.composeWidth(lPositionnement.width), GStyle.composeHeight(lPositionnement.height), 'top:' + lPositionnement.top + 'px;', 'left:' + lPositionnement.left + 'px;', '">' + T.join('') + '</div>'].join(''), {
                controleur: this.controleur
            });
        }

        function _nettoyerElementsEditionEnCours() {
            $('#' + this.IdZoneTexte.escapeJQ()).remove();
            $('#' + this.ids.surligneur_edition.escapeJQ()).remove();
            if (this.fenetreDate) {
                this.fenetreDate.Fermer();
                delete this.fenetreDate;
            }
        }
        _ObjetListe.prototype._Entrer_DateCalendrier = function() {};

        function _surSelection(aNumeroColonne, aNumeroLigne, aParams) {
            if (this._cache.creationEnCours || this._cache.editionEnCours) {
                return false;
            }
            if (!this.Donnees) {
                return false;
            }
            var lParams = Object.assign({
                    avecFocus: true,
                    forcerMonoSelection: false,
                    ctrlKey: false,
                    shiftKey: false,
                    avecEvenementModificationSelection: true,
                    surInteractionUtilisateur: false
                }, aParams),
                lAvecActualisationPage = false;
            this._cache.lignesSelectionnees_prec = MethodesObjet.dupliquer(this._cache.lignesSelectionnees);
            var lSelections = lParams.avecEvenementModificationSelection ? _getCellulesSelection.call(this, true) : null;
            var iLigne, iColonne, lAvecMultiSelection = this.Donnees.AvecMultiSelection() && !lParams.forcerMonoSelection,
                lEstSelectionParCellule = _estSelectionParCellule.call(this, aNumeroLigne, aNumeroColonne),
                lMultiSelectionCtrl = lAvecMultiSelection && (!this.Donnees.avecMultiSelectionSurCtrl() || lParams.ctrlKey),
                lMultiSelectionShift = lAvecMultiSelection && (!this.Donnees.avecMultiSelectionSurShift() || lParams.shiftKey);
            if (!lMultiSelectionCtrl && !lMultiSelectionShift) {
                if (_etatSelectionCellule.call(this, {
                        ligne: aNumeroLigne,
                        colonne: aNumeroColonne,
                        cacheSelection: this._cache.lignesSelectionnees_prec
                    }) && this.Donnees._avecDeselection(aNumeroLigne, aNumeroColonne) && !lAvecMultiSelection && (lParams.ctrlKey || this.Donnees.options.avecDeselectionMonoSelectionClick)) {
                    _selectionner.call(this, {
                        deselectionnerTout: true,
                        selectionner: false,
                        avecEvenementModificationSelection: true
                    });
                    this._cache.selectionCellule.ligne = -1;
                    this._cache.selectionCellule.colonne = -1;
                    this.Donnees._SurSelection(aNumeroLigne, aNumeroColonne, false);
                    return;
                }
                if (aNumeroColonne === this._cache.selectionCellule.colonne &&
                    aNumeroLigne === this._cache.selectionCellule.ligne &&
                    !lAvecMultiSelection &&
                    _etatSelectionCellule.call(this, {
                        ligne: aNumeroLigne,
                        colonne: aNumeroColonne
                    })) {
                    return;
                }
                this._cache.selectionCellule.ligne = aNumeroLigne;
                this._cache.selectionCellule.colonne = aNumeroColonne;
                _selectionner.call(this, {
                    ligne: aNumeroLigne,
                    colonne: aNumeroColonne,
                    deselectionnerTout: true,
                    selectionner: true,
                    avecActualisationPage: true,
                    _avecVisuCadreSelection: false
                });
            } else if (lMultiSelectionShift) {
                if (!this._cache.celluleClicNonShift ||
                    this._cache.celluleClicNonShift.ligne < 0 ||
                    this._cache.celluleClicNonShift.colonne < 0) {
                    return;
                }
                var lMinLigne = Math.min(aNumeroLigne, this._cache.celluleClicNonShift.ligne),
                    lMaxLigne = Math.max(aNumeroLigne, this._cache.celluleClicNonShift.ligne);
                if (lEstSelectionParCellule) {
                    var lMinColonne = Math.min(aNumeroColonne, this._cache.celluleClicNonShift.colonne),
                        lMaxColonne = Math.max(aNumeroColonne, this._cache.celluleClicNonShift.colonne);
                    for (iLigne = 0; iLigne < this._cache.lignesSelectionnees.length; iLigne++) {
                        lAvecActualisationPage = iLigne === aNumeroLigne;
                        for (iColonne = 0; iColonne < this.ListeTailles.length; iColonne++) {
                            if (iColonne >= lMinColonne &&
                                iColonne <= lMaxColonne &&
                                iLigne >= lMinLigne &&
                                iLigne <= lMaxLigne &&
                                _estLigneVisible(this, iLigne)) {
                                if (!_etatSelectionCellule.call(this, {
                                        ligne: iLigne,
                                        colonne: iColonne
                                    })) {
                                    _selectionner.call(this, {
                                        ligne: iLigne,
                                        colonne: iColonne,
                                        selectionner: true,
                                        avecActualisationPage: lAvecActualisationPage,
                                        _avecVisuCadreSelection: false
                                    });
                                    lAvecActualisationPage = false;
                                }
                            } else if (_etatSelectionCellule.call(this, {
                                    ligne: iLigne,
                                    colonne: iColonne
                                }) &&
                                this.Donnees._avecDeselection(iLigne, iColonne)) {
                                _selectionner.call(this, {
                                    ligne: iLigne,
                                    colonne: iColonne,
                                    selectionner: false,
                                    _avecVisuCadreSelection: false
                                });
                            }
                        }
                    }
                } else {
                    for (iLigne = 0; iLigne < this._cache.lignesSelectionnees.length; iLigne++) {
                        lAvecActualisationPage = iLigne === aNumeroLigne;
                        if (iLigne >= lMinLigne &&
                            iLigne <= lMaxLigne &&
                            _estLigneVisible(this, iLigne)) {
                            _selectionner.call(this, {
                                ligne: iLigne,
                                selectionner: true,
                                avecActualisationPage: lAvecActualisationPage,
                                _avecVisuCadreSelection: false
                            });
                            lAvecActualisationPage = false;
                        } else if (_etatSelectionCellule.call(this, {
                                ligne: iLigne
                            }) &&
                            this.Donnees._avecDeselection(iLigne, aNumeroColonne)) {
                            _selectionner.call(this, {
                                ligne: iLigne,
                                selectionner: false,
                                _avecVisuCadreSelection: false
                            });
                        }
                    }
                }
            } else if (lMultiSelectionCtrl) {
                var lNumeroColonneTraite = lEstSelectionParCellule ? aNumeroColonne : -1;
                if (_etatSelectionCellule.call(this, {
                        ligne: aNumeroLigne,
                        colonne: lNumeroColonneTraite
                    })) {
                    _selectionner.call(this, {
                        ligne: aNumeroLigne,
                        colonne: aNumeroColonne,
                        selectionner: false,
                        _avecVisuCadreSelection: false
                    });
                    this._cache.selectionCellule.ligne = -1;
                    this._cache.selectionCellule.colonne = -1;
                } else {
                    _selectionner.call(this, {
                        ligne: aNumeroLigne,
                        colonne: aNumeroColonne,
                        selectionner: true,
                        avecActualisationPage: true,
                        _avecVisuCadreSelection: false
                    });
                    this._cache.selectionCellule.ligne = aNumeroLigne;
                    this._cache.selectionCellule.colonne = aNumeroColonne;
                }
            }
            if (this._options.avecCadreSelection) {
                _getTraitementsAffichageSelection.call(this).forEach(function(aTraitement, aIndex, aArray) {
                    _setCadreSelection.call(this, aTraitement, aIndex, aArray);
                }.bind(this));
            }
            this.Donnees._SurSelection(this._cache.selectionCellule.colonne, this._cache.selectionCellule.ligne, true);
            if (lParams.avecFocus) {
                GHtml.setFocus(this.getIdCellule((aNumeroColonne > -1 ? aNumeroColonne : 0), aNumeroLigne) + '_div');
            }
            if (lParams.avecEvenementModificationSelection) {
                _surModificationSelectionEvenement.call(this, lSelections, lParams.surInteractionUtilisateur);
            }
            return true;
        }

        function _getLigneDebutEtFinPaginationCourante() {
            if (this._options.nbLignesMax === 0 || this.optionsInterne.versionMobile) {
                return {
                    debut: 0,
                    fin: this._cache.lignesVisibles.length
                };
            }
            return {
                debut: (this._cache.pageCourante - 1) * this._options.nbLignesMax,
                fin: Math.min(this._cache.pageCourante * this._options.nbLignesMax, this._cache.lignesVisibles.length)
            };
        }

        function _celluleAvecBordureDroite(aListe, aEstDerniereColonne) {
            return !aEstDerniereColonne && aListe._options.borduresCellule_horizontal > 0;
        }

        function _getFusionColonnesCellule(aParametres) {
            var lFusion = {},
                lHash = {},
                lNumeroColonneFusionEnCoursPrec = null,
                lParamsCellule, lDerniereColonne, lNumeroColonneFusion, lNumeroColonneReferenceFusion = aParametres.colonnesVisibles[0],
                lTailles = aParametres.tailles || this._cache.taillesColonne;
            aParametres.colonnesVisibles.forEach(function(aNumeroColonne) {
                if (aParametres.total) {
                    lParamsCellule = aParametres.getParamsCellule(aNumeroColonne, {
                        colonnesVisibles: aParametres.colonnesVisibles
                    });
                } else {
                    lParamsCellule = _getParamsCellule.call(this, aNumeroColonne, aParametres.ligne, {
                        colonnesVisibles: aParametres.colonnesVisibles
                    });
                }
                if (aParametres.total) {
                    lNumeroColonneFusion = this.Donnees.getColonneDeFusionTotal(lParamsCellule);
                } else {
                    lNumeroColonneFusion = this.Donnees.getColonneDeFusion(lParamsCellule);
                }
                if (lNumeroColonneFusion === undefined || lNumeroColonneFusion === null) {
                    lNumeroColonneFusion = aNumeroColonne;
                } else if (MethodesObjet.isString(lNumeroColonneFusion)) {
                    lNumeroColonneFusion = this.getNumeroColonneDIdColonne(lNumeroColonneFusion);
                } else if (!MethodesObjet.isNumber(lNumeroColonneFusion)) {
                    lNumeroColonneFusion = aNumeroColonne;
                }
                if (lNumeroColonneFusion !== aNumeroColonne && !_ObjetListe.protected._estColonneVisible.call(this, lNumeroColonneFusion)) {
                    GLog.addLog('[_getFusionColonnesCellule] la colonne de fusion est invisible');
                    lNumeroColonneFusion = aNumeroColonne;
                }
                if (lNumeroColonneFusion !== aNumeroColonne && (lNumeroColonneFusion > aParametres.indiceColonneFin || lNumeroColonneFusion < aParametres.indiceColonneDebut)) {
                    GLog.addLog('[_getFusionColonnesCellule] la colonne de fusion est hors du bloc');
                    lNumeroColonneFusion = lNumeroColonneFusion > aParametres.indiceColonneFin ? aParametres.indiceColonneFin : aParametres.indiceColonneDebut;
                }
                if (lNumeroColonneFusionEnCoursPrec !== null && lNumeroColonneFusion < lNumeroColonneFusionEnCoursPrec) {
                    GLog.addLog('[_getFusionColonnesCellule] erreur getColonneDeFusion sur colonne ' + aNumeroColonne);
                    Object.keys(lHash).forEach(function(aCle) {
                        if (lHash[aCle] === lNumeroColonneFusionEnCoursPrec) {
                            lHash[aCle] = parseInt(aCle, 10);
                        }
                    });
                }
                if (lNumeroColonneFusion === aNumeroColonne &&
                    aNumeroColonne > 0 &&
                    !aParametres.total &&
                    this.Donnees.fusionCelluleAvecColonnePrecedente(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article)) {
                    lNumeroColonneFusion = lNumeroColonneReferenceFusion;
                } else {
                    lNumeroColonneReferenceFusion = aNumeroColonne;
                }
                lHash[aNumeroColonne] = lNumeroColonneFusion;
                lNumeroColonneFusionEnCoursPrec = lNumeroColonneFusion;
            }.bind(this));
            aParametres.colonnesVisibles.forEach(function(aNumeroColonne) {
                var lColPrimaire = lHash[aNumeroColonne];
                if (!lFusion[lColPrimaire]) {
                    lFusion[lColPrimaire] = {
                        nbCol: 0,
                        taille: parseInt(lTailles[lColPrimaire].px, 10),
                        debut: lColPrimaire,
                        fin: lColPrimaire
                    };
                }
                lFusion[lColPrimaire].nbCol += 1;
                if (lColPrimaire !== aNumeroColonne) {
                    lDerniereColonne = aParametres.indiceColonneFin === aNumeroColonne && aParametres.dernierBloc;
                    lFusion[lColPrimaire].taille += parseInt(lTailles[aNumeroColonne].px, 10) + 2 * this._options.paddingCelluleLR + (_celluleAvecBordureDroite(this, lDerniereColonne) ? 1 : 0);
                    lFusion[lColPrimaire].debut = Math.min(aNumeroColonne, lFusion[lColPrimaire].debut);
                    lFusion[lColPrimaire].fin = Math.max(aNumeroColonne, lFusion[lColPrimaire].fin);
                }
            }.bind(this));
            return lFusion;
        }

        function _setCadreSelection_interne(aParams, aArrayTraitements) {
            if (!aParams.selection && (!aParams.posCellulePrec || !aParams.posCellulePrec.selection)) {
                return;
            }
            var lFusionLigneIdentique = function(aColonne) {
                if (!this._cache.lignesFusionParColonne[aColonne + '_' + aParams.ligne] && !this._cache.lignesFusionParColonne[aParams.colonne + '_' + aParams.ligne]) {
                    return true;
                }
                if (this._cache.lignesFusionParColonne[lNumeroColonne + '_' + aParams.ligne] && this._cache.lignesFusionParColonne[aParams.colonne + '_' + aParams.ligne] && this._cache.lignesFusionParColonne[aParams.colonne + '_' + aParams.ligne].ligneOrigine === this._cache.lignesFusionParColonne[aParams.colonne + '_' + aParams.ligne].ligneOrigine) {
                    return true;
                }
                return false;
            };
            var lIdSelecCellule = this.ids.cadreSelection + '_sel_' + aParams.ligne + '_' + aParams.colonne;
            var lPositionCache = this._cache.positionsCelluleCadreSelection[aParams.ligne] ? this._cache.positionsCelluleCadreSelection[aParams.ligne][aParams.colonne] : null;
            if (aParams.selection) {
                if (!this._cache.positionsCelluleCadreSelection[aParams.ligne]) {
                    this._cache.positionsCelluleCadreSelection[aParams.ligne] = {};
                }
                if (!this._cache.positionsCelluleCadreSelection[aParams.ligne][aParams.colonne]) {
                    var lRangeLignes = _getLigneDebutEtFinPaginationCourante.call(this);
                    if (aParams.ligne < this._cache.lignesVisibles[lRangeLignes.debut] || (lRangeLignes.fin < this._cache.lignesVisibles.length && aParams.ligne > this._cache.lignesVisibles[lRangeLignes.fin])) {
                        return;
                    }
                    try {
                        var lIndexLigne = this._cache.lignesVisibles.indexOf(aParams.ligne);
                        var lParamsCellule = _getParamsCellule.call(this, aParams.colonne, aParams.ligne, {
                            celluleLignePrecedente: lIndexLigne > 0 ? _getParamsCellule.call(this, aParams.colonne, this._cache.lignesVisibles[lIndexLigne - 1]) : null,
                            celluleLigneSuivante: lIndexLigne >= 0 && lIndexLigne + 1 < this._cache.lignesVisibles.length ? _getParamsCellule.call(this, aParams.colonne, this._cache.lignesVisibles[lIndexLigne + 1]) : null
                        });
                    } catch (e) {
                        lParamsCellule = null;
                    }
                    var lModifHeight = 0;
                    var lNode = GHtml.getElement(aParams.idCellule + '_divP');
                    if (!lNode) {
                        lNode = GHtml.getElement(aParams.idCellule);
                        if (!lNode) {
                            return;
                        }
                    } else {
                        if (this.Donnees && this._options.borduresCellule_vertical > 0 && lParamsCellule && !this.Donnees.avecBordureBas(lParamsCellule)) {
                            lModifHeight += this._options.borduresCellule_vertical;
                        } else {
                            lNode = GHtml.getParent(lNode);
                            lModifHeight = GStyle.getFloatComputedValue(lNode, 'border-bottom-width');
                        }
                    }
                    var lRect = GPosition.getRect(lNode, true);
                    var lRectScroll = {
                        top: 0,
                        left: 0
                    };
                    var lConteneurSel = GHtml.getElement(this.ids.cadreSelection + aParams.bloc.indiceBloc);
                    if (lConteneurSel) {
                        lRectScroll = GPosition.getRect(lConteneurSel, true);
                    }
                    this._cache.positionsCelluleCadreSelection[aParams.ligne][aParams.colonne] = {
                        top: lRect.top - lRectScroll.top,
                        left: lRect.left - lRectScroll.left,
                        height: lRect.height - lModifHeight,
                        width: lRect.width
                    };
                    lPositionCache = this._cache.positionsCelluleCadreSelection[aParams.ligne][aParams.colonne];
                }
            }
            if (lPositionCache) {
                lPositionCache.selection = !!aParams.selection;
            }
            if (aParams.selection) {
                var lBloc;
                var lFusions = _getFusionColonnesCellule.call(this, {
                    colonnesVisibles: aParams.bloc.colonnesVisibles,
                    ligne: aParams.ligne,
                    indiceColonneDebut: aParams.bloc.indiceColonneDebut,
                    indiceColonneFin: aParams.bloc.indiceColonneFin,
                    dernierBloc: aParams.bloc.dernierBloc || (!aParams.bloc.dernierBloc && !aParams.bloc.estBlocFixe)
                });
                var lIndiceCol = aParams.bloc.colonnesVisibles.indexOf(lFusions[aParams.colonne].debut);
                var lNumeroColonne = aParams.bloc.colonnesVisibles[lIndiceCol - 1];
                if (lIndiceCol === 0) {
                    lBloc = this._cache.infosZonesColonnes[aParams.bloc.indiceBloc - 1];
                    if (lBloc) {
                        lNumeroColonne = lBloc.colonnesVisibles[lBloc.colonnesVisibles.length - 1];
                    }
                }
                lPositionCache.selColPrec = (aParams.bloc.indiceBloc > 0 || aParams.colonne > aParams.bloc.colonnesVisibles[0]) && lFusionLigneIdentique.call(this, lNumeroColonne) && _ObjetListe.protected._etatSelectionCellule.call(this, {
                    ligne: aParams.ligne,
                    colonne: lNumeroColonne
                }) && this.Donnees._AvecSelection(lNumeroColonne, aParams.ligne);
                lIndiceCol = aParams.bloc.colonnesVisibles.indexOf(lFusions[aParams.colonne].fin);
                lNumeroColonne = aParams.bloc.colonnesVisibles[lIndiceCol + 1];
                if (lIndiceCol >= aParams.bloc.colonnesVisibles.length - 1) {
                    lBloc = this._cache.infosZonesColonnes[aParams.bloc.indiceBloc + 1];
                    if (lBloc) {
                        lNumeroColonne = lBloc.colonnesVisibles[0];
                    }
                }
                lPositionCache.selColSuivante = (!aParams.bloc.dernierBloc || aParams.colonne < aParams.bloc.colonnesVisibles[aParams.bloc.colonnesVisibles.length - 1]) && lFusionLigneIdentique.call(this, lNumeroColonne) && _ObjetListe.protected._etatSelectionCellule.call(this, {
                    ligne: aParams.ligne,
                    colonne: lNumeroColonne
                }) && this.Donnees._AvecSelection(lNumeroColonne, aParams.ligne);
                if (aParams.posCellulePrec && aParams.posCellulePrec.selection && aParams.posCellulePrec.selColPrec === lPositionCache.selColPrec && aParams.posCellulePrec.selColSuivante === lPositionCache.selColSuivante) {
                    return;
                }
                if (aParams.posCellulePrec && aParams.posCellulePrec.selection) {
                    $('#' + lIdSelecCellule.escapeJQ()).remove();
                }
                var lStyle = GStyle.composeWidth(lPositionCache.width + (lPositionCache.selColPrec ? 1 : 0) + (lPositionCache.selColSuivante ? 1 : 0)) + 'left:' + ((lPositionCache.selColPrec ? -1 : 0)) + 'px;';
                var lId = this.ids.cadreSelection + aParams.bloc.indiceBloc;
                aArrayTraitements.cacheHTML[lId] = (aArrayTraitements.cacheHTML[lId] || '') + ['<div class="liste_ligneSelection" id="', lIdSelecCellule, '" style="top:' + lPositionCache.top + 'px;' + 'left:' + lPositionCache.left + 'px;">', !lPositionCache.selColPrec ? '<div class="liste_ligneSelection_g" style="' + GStyle.composeHeight(lPositionCache.height) + '"></div>' : '', '<div class="liste_ligneSelection_h" style="', lStyle, '"></div>', !lPositionCache.selColSuivante ? '<div class="liste_ligneSelection_d" style="left:' + (lPositionCache.width - 2) + 'px;' + GStyle.composeHeight(lPositionCache.height) + '"></div>' : '', '<div class="liste_ligneSelection_b" style="top:', (lPositionCache.height - 2), 'px;', lStyle, '"></div>', '</div>'].join('');
            } else {
                if (aParams.posCellulePrec && aParams.posCellulePrec.selection) {
                    $('#' + lIdSelecCellule.escapeJQ()).remove();
                }
            }
        }

        function _setCadreSelection(aParams, aIndexTraitement, aArrayTraitements) {
            if (aIndexTraitement === 0) {
                aArrayTraitements.cacheHTML = {};
            }
            _setCadreSelection_interne.call(this, aParams, aArrayTraitements);
            if (aIndexTraitement >= aArrayTraitements.length - 1) {
                Object.keys(aArrayTraitements.cacheHTML).forEach(function(aKey) {
                    var lElementBloc = GHtml.getElement(aKey);
                    if (lElementBloc) {
                        lElementBloc.innerHTML += aArrayTraitements.cacheHTML[aKey];
                    }
                });
            }
        }

        function _etatSelectionCellule(aParametres, aSelectionne) {
            var lParametres = Object.assign({
                ligne: -1,
                colonne: -1,
                cacheSelection: this._cache.lignesSelectionnees
            }, aParametres);
            if (arguments.length > 1) {
                if (aSelectionne) {
                    if (lParametres.colonne >= 0 && !this.Donnees._AvecSelection(lParametres.colonne, lParametres.ligne)) {
                        return;
                    }
                    if (!lParametres.cacheSelection[lParametres.ligne]) {
                        lParametres.cacheSelection[lParametres.ligne] = [];
                    }
                    if (lParametres.colonne < 0) {
                        for (var i = 0; i < this.ListeTailles.length; i++) {
                            lParametres.cacheSelection[lParametres.ligne][i] = true;
                        }
                    } else {
                        lParametres.cacheSelection[lParametres.ligne][lParametres.colonne] = aSelectionne;
                    }
                } else {
                    if (!lParametres.cacheSelection[lParametres.ligne]) {
                        return;
                    }
                    if (lParametres.colonne < 0) {
                        delete lParametres.cacheSelection[lParametres.ligne];
                        return;
                    }
                    lParametres.cacheSelection[lParametres.ligne][lParametres.colonne] = false;
                    if (lParametres.cacheSelection[lParametres.ligne].every(function(aColonne) {
                            return aColonne !== true;
                        })) {
                        delete lParametres.cacheSelection[lParametres.ligne];
                    }
                }
            } else {
                if (!lParametres.cacheSelection[lParametres.ligne]) {
                    return false;
                }
                if (lParametres.colonne < 0) {
                    return !!lParametres.cacheSelection[lParametres.ligne];
                }
                return !!lParametres.cacheSelection[lParametres.ligne][lParametres.colonne];
            }
        }

        function _getTraitementsAffichageSelection() {
            var lTraitements = [];
            this._cache.infosZonesColonnes.forEach(function(aInfosZoneColonnes) {
                this._cache.lignesVisibles.forEach(function(aLigne) {
                    if (this.Donnees.Donnees.GetElement(aLigne)) {
                        aInfosZoneColonnes.colonnesVisibles.forEach(function(aNumeroColonne) {
                            var lPosCellule = this._cache.positionsCelluleCadreSelection[aLigne] && this._cache.positionsCelluleCadreSelection[aLigne][aNumeroColonne] ? this._cache.positionsCelluleCadreSelection[aLigne][aNumeroColonne] : null;
                            var lTraitement = {
                                bloc: aInfosZoneColonnes,
                                ligne: aLigne,
                                colonne: aNumeroColonne,
                                idCellule: this.getIdCellule(aNumeroColonne, aLigne),
                                selection: !!_etatSelectionCellule.call(this, {
                                    ligne: aLigne,
                                    colonne: aNumeroColonne
                                }) && !!this.Donnees._AvecSelection(aNumeroColonne, aLigne),
                                posCellulePrec: Object.assign({}, lPosCellule)
                            };
                            lTraitements.push(lTraitement);
                        }.bind(this));
                    }
                }.bind(this));
            }.bind(this));
            return lTraitements;
        }
        _ObjetListe.prototype._scrollSurSelection = function() {};

        function _selectionner(aParametres) {
            if (!this.Donnees) {
                return;
            }
            var lParametres = Object.assign({
                ligne: -1,
                colonne: -1,
                selectionner: true,
                avecScroll: false,
                avecEvenement: false,
                deselectionnerTout: false,
                avecFocusCellule: false,
                avecActualisationPage: false,
                _avecVisuCadreSelection: true,
                avecEvenementModificationSelection: false
            }, aParametres);
            var lLigne, lColonne, lNumeroColonne = lParametres.colonne,
                lTrouverLignePourScroll = false,
                lEstSelectionParCellule = _estSelectionParCellule.call(this, lParametres.ligne, lNumeroColonne),
                lAvecMultiSelection = this.Donnees.AvecMultiSelection(),
                lCelluleAvecSelection = this.Donnees._AvecSelection(lParametres.colonne, lParametres.ligne);
            if (lParametres.selectionner &&
                lEstSelectionParCellule &&
                !lCelluleAvecSelection) {
                return;
            }
            if (!lEstSelectionParCellule) {
                lNumeroColonne = -1;
            }
            if (lParametres.selectionner &&
                lParametres.ligne > -1 &&
                !lAvecMultiSelection &&
                !lParametres._surMultiSelectionMiroir) {
                if (lParametres.deselectionnerTout === false) {
                    lParametres.deselectionnerTout = true;
                } else if (lParametres.deselectionnerTout &&
                    !lCelluleAvecSelection &&
                    !this.Donnees.options.avecDeselectionSurNonSelectionnable) {
                    lParametres.deselectionnerTout = false;
                }
            }
            var lSelectionsPrecedente = lParametres.avecEvenementModificationSelection ? _getCellulesSelection.call(this, true) : null;
            var lAvecSuiteSelection = true;
            if (lParametres.deselectionnerTout) {
                var lAvecDeselectionCellule = false;
                for (lLigne = 0; lLigne < this._cache.lignesSelectionnees.length; lLigne++) {
                    if (lEstSelectionParCellule) {
                        for (lColonne = 0; lColonne < this.ListeTailles.length; lColonne++) {
                            if (_etatSelectionCellule.call(this, {
                                    ligne: lLigne,
                                    colonne: lColonne
                                })) {
                                if (lLigne !== lParametres.ligne || lColonne !== lNumeroColonne) {
                                    lAvecDeselectionCellule = true;
                                }
                                _selectionner.call(this, {
                                    ligne: lLigne,
                                    colonne: lColonne,
                                    selectionner: false,
                                    _avecVisuCadreSelection: false
                                });
                            }
                        }
                    } else {
                        if (_etatSelectionCellule.call(this, {
                                ligne: lLigne
                            })) {
                            if (lLigne !== lParametres.ligne) {
                                lAvecDeselectionCellule = true;
                            }
                            _selectionner.call(this, {
                                ligne: lLigne,
                                selectionner: false,
                                _avecVisuCadreSelection: false
                            });
                        }
                    }
                }
                if (lAvecDeselectionCellule && lAvecMultiSelection) {
                    this._cache.lignesSelectionnees_prec = [];
                }
            }
            if (lParametres.ligne > -1) {
                var lOldlignesSelection = MethodesObjet.dupliquer(this._cache.lignesSelectionnees);
                if (!lParametres.selectionner && lNumeroColonne === -1) {
                    _etatSelectionCellule.call(this, {
                        ligne: lParametres.ligne,
                        colonne: lNumeroColonne
                    }, lParametres.selectionner);
                }
                this._cache.infosZonesColonnes.forEach(function(aInfosZoneColonnes) {
                    this.Donnees.Donnees.parcourir(function(aElementLigne, aLigne) {
                        if (aElementLigne) {
                            var lEstLigneVisible = _estLigneVisible(this, aLigne);
                            aInfosZoneColonnes.colonnesVisibles.forEach(function(aNumeroColonne) {
                                if (!_estColonneVisible.call(this, aNumeroColonne) || !this.Donnees._AvecSelection(aNumeroColonne, aLigne)) {
                                    return;
                                }
                                if (lParametres.selectionner && lParametres.ligne === aLigne && !lEstLigneVisible) {
                                    require('IELog.js').addLog('MMh ? selection de ligne invisible ? voir fv');
                                    return;
                                }
                                if (lParametres.ligne === aLigne && (lNumeroColonne === -1 || lNumeroColonne === aNumeroColonne)) {
                                    _etatSelectionCellule.call(this, {
                                        ligne: lParametres.ligne,
                                        colonne: aNumeroColonne
                                    }, lParametres.selectionner);
                                } else if (!lEstSelectionParCellule && this.Donnees.options.avecMultiSelectionSurLigneFusion && lParametres.ligne !== aLigne && lParametres.colonne >= 0) {
                                    var lAvecModif = false;
                                    var lFusionCellule;
                                    lFusionCellule = this._cache.lignesFusionParColonne[lParametres.colonne + '_' + lParametres.ligne];
                                    if (lFusionCellule && lFusionCellule.lignesCumuls && lFusionCellule.lignesCumuls[aLigne]) {
                                        lAvecModif = true;
                                    }
                                    if (!lAvecModif) {
                                        lFusionCellule = this._cache.lignesFusionParColonne[aNumeroColonne + '_' + aLigne];
                                        if (lFusionCellule && lFusionCellule.lignesCumuls && lFusionCellule.lignesCumuls[lParametres.ligne]) {
                                            lAvecModif = true;
                                        }
                                    }
                                    if (lAvecModif) {
                                        _etatSelectionCellule.call(this, {
                                            ligne: aLigne,
                                            colonne: aNumeroColonne
                                        }, lParametres.selectionner);
                                    }
                                }
                            }.bind(this));
                        }
                    }.bind(this));
                }.bind(this));
                if (lParametres.selectionner && !lParametres._surMultiSelectionMiroir) {
                    this._cache.selectionCellule.ligne = lParametres.ligne;
                    this._cache.selectionCellule.colonne = lParametres.colonne;
                }
                if (lNumeroColonne < 0 && !lParametres._surMultiSelectionMiroir) {
                    this.Donnees._SurSelectionLigne(lParametres.ligne, lParametres.selectionner);
                }
                var lPageTrouvee = _getPageDeLigneVisible.call(this, lParametres.ligne);
                if (lPageTrouvee >= 0 && lPageTrouvee !== this._cache.pageCourante) {
                    if (lParametres.avecActualisationPage) {
                        this._cache.pageCourante = lPageTrouvee;
                        _actualiser.call(this, {
                            sansTriDonnees: true,
                            conserverSelection: true,
                            conserverFocusSelection: true,
                            ignorerFocusListe: false,
                            zonesActualisation: {
                                contenu: true,
                                total: true
                            }
                        });
                    } else {
                        lAvecSuiteSelection = false;
                    }
                }
            }
            if (!lEstSelectionParCellule && lParametres.ligne >= 0 && !lParametres._surMultiSelectionMiroir && this.Donnees.options.avecRechercheSelectionMiroir) {
                var lParamsCellule = _getParamsCellule.call(this, lParametres.colonne, lParametres.ligne, {
                    selectionner: lParametres.selectionner
                });
                if (lParamsCellule.article) {
                    this.Donnees.Donnees.parcourir(function(aElement, aLigne) {
                        if (aLigne !== lParametres.ligne && aElement) {
                            var lParamsCelluleCible = _getParamsCellule.call(this, lParametres.colonne, aLigne, {
                                estLigneVisible: _estLigneVisible(this, aLigne)
                            });
                            if (this.Donnees.estSelectionCibleMiroirDeSelectionSource(lParamsCellule, lParamsCelluleCible)) {
                                _selectionner.call(this, {
                                    ligne: aLigne,
                                    colonne: -1,
                                    selectionner: lParametres.selectionner,
                                    _avecVisuCadreSelection: lParametres._avecVisuCadreSelection,
                                    _surMultiSelectionMiroir: true
                                });
                            }
                        }
                    }.bind(this));
                }
            }
            if (lAvecSuiteSelection) {
                var lTraitements = _getTraitementsAffichageSelection.call(this);
                if (this._options.avecCadreSelection && lParametres._avecVisuCadreSelection) {
                    lTraitements.forEach(function(aTraitement, aIndex, aArray) {
                        _setCadreSelection.call(this, aTraitement, aIndex, aArray);
                    }.bind(this));
                }
                if (lParametres.ligne > -1) {
                    var lLignePourScroll = Number.MAX_VALUE;
                    var lColonnePourScroll = 0;
                    lTraitements.forEach(function(aTraitement) {
                        var lOldSelec = lOldlignesSelection[aTraitement.ligne] ? !!lOldlignesSelection[aTraitement.ligne][aTraitement.colonne] : false;
                        if (lOldSelec !== aTraitement.selection) {
                            if (!this._options.avecCadreSelection) {
                                var lElement = GHtml.getElement(aTraitement.idCellule);
                                if (!lElement) {
                                    return;
                                }
                                this._setStyleCellule(lElement, aTraitement.colonne, aTraitement.ligne, aTraitement.selection);
                            }
                            if (lParametres.selectionner && lParametres.avecScroll && aTraitement.ligne < lLignePourScroll) {
                                lLignePourScroll = aTraitement.ligne;
                                lColonnePourScroll = aTraitement.colonne;
                                lTrouverLignePourScroll = true;
                            }
                        }
                    }.bind(this));
                    if (lParametres.avecFocusCellule && lParametres.colonne >= 0) {
                        GHtml.setFocus(this.getIdCellule(lParametres.colonne, lParametres.ligne) + '_div', true, 0);
                    }
                    if (lParametres.selectionner && lParametres.avecScroll && lTrouverLignePourScroll) {
                        this._scrollSurSelection(lColonnePourScroll, lLignePourScroll);
                    }
                }
                if (lParametres.avecEvenement && lParametres.selectionner) {
                    _SurSelectionEvenement.call(this, -1, lParametres.ligne, false, false);
                }
            }
            if (lParametres.avecEvenementModificationSelection) {
                _surModificationSelectionEvenement.call(this, lSelectionsPrecedente);
            }
            _refreshSelf.call(this);
        }

        function _estCellulePrecedemmentSelectionnee(aColonne, aLigne) {
            if (!this._cache.lignesSelectionnees_prec) {
                return false;
            }
            if (_ObjetListe.protected._etatSelectionCellule.call(this, {
                    ligne: aLigne,
                    colonne: aColonne,
                    cacheSelection: this._cache.lignesSelectionnees_prec
                })) {
                return true;
            }
            var lInfosFusion = this._cache.lignesFusionParColonne[aColonne + '_' + aLigne],
                lLigne;
            if (lInfosFusion && lInfosFusion.lignesCumuls) {
                for (lLigne in lInfosFusion.lignesCumuls) {
                    if (_ObjetListe.protected._etatSelectionCellule.call(this, {
                            ligne: lLigne,
                            colonne: aColonne,
                            cacheSelection: this._cache.lignesSelectionnees_prec
                        })) {
                        return true;
                    }
                }
            }
            return false;
        }

        function _avecEditionApresSelection(aParamsCellule) {
            var lParamsCellule = aParamsCellule;
            var lNumeroColonne = lParamsCellule.colonne;
            if (lNumeroColonne && MethodesObjet.isString(lNumeroColonne)) {
                lNumeroColonne = this.getNumeroColonneDIdColonne(lNumeroColonne);
            }
            if (lNumeroColonne < 0 || !MethodesObjet.isNumber(lNumeroColonne)) {
                lParamsCellule = _getParamsCellule.call(this, lNumeroColonne, lParamsCellule.ligne, {
                    surEdition: true
                });
            }
            lParamsCellule.typeValeur = this.Donnees.GetTypeValeur(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article);
            return this.Donnees.avecEditionApresSelection(lParamsCellule);
        }

        function _editionDebSurSelection(aColonne, aLigne, aEvent) {
            if (this._cache.creationEnCours || this._cache.editionEnCours) {
                return;
            }
            var lParams = _getParamsCellule.call(this, aColonne, aLigne, {
                surEdition: true
            });
            if (this.Donnees && (aLigne > -1)) {
                if (this.Donnees.AvecEvenement_SelectionClick(aColonne, lParams.article, lParams)) {
                    if (this.Pere && this.Evenement) {
                        var lResult = this.callback.appel(_getParamsCallback.call(this, EGenreEvenementListe.SelectionClick, aColonne, aLigne), EGenreEvenementListe.SelectionClick, aColonne, aLigne);
                        _refreshSelf.call(this);
                        if (lResult) {
                            return;
                        }
                    }
                }
            }
            if (aEvent && (aEvent.type === 'click' || aEvent.type === 'mouseup') && (aEvent.ctrlKey === true || aEvent.shiftKey === true)) {
                return;
            }
            if (!_avecEditionApresSelection.call(this, lParams) || !this.Donnees._AvecSelection(aColonne, aLigne) || _estCellulePrecedemmentSelectionnee.call(this, aColonne, aLigne) || this.Donnees.avecSelecFile(lParams)) {
                _SurEditionDeb.call(this, aColonne, aLigne);
            }
        }

        function _ajouterElementCreation(aLibelle, aValeurCreation) {
            if (aLibelle) {
                if (_getNonEditable.call(this)) {
                    return;
                }
                if (!this._cache.creationEnCours) {
                    this._cache.creationEnCours = true;
                    this._cache.creationEnCoursEvenement = false;
                }
                this._cache.listeValeursCreation[-1] = aValeurCreation;
                if (this._cache.positionCreation === 0) {
                    this._cache.numeroColonneCreationEnCours = this.ListeCreations[this._cache.positionCreation++];
                }
                _SurCreation.call(this, aLibelle);
            } else {
                _annulerCreation.call(this);
            }
            return this;
        }

        function _surLigneCreationUnique(aSurClick, aLigne, aSurToucheEdition) {
            var lParams = _getParamsCellule.call(this, -1, aLigne, {
                    surCreation: true
                }),
                lAvecInputFile = this.Donnees && this.Donnees.avecSelecFile(lParams);
            if (lAvecInputFile && this._cache.ouvrirSelecteurFileParLigne[aLigne + '_-1']) {
                this._cache.ouvrirSelecteurFileParLigne[aLigne + '_-1']();
                return;
            }
            if (!aSurClick && !aSurToucheEdition) {
                return;
            }
            var LId = _getIdCreation.call(this, -1, aLigne);
            GHtml.setDisplay(LId + '_Creation', false);
            GHtml.setDisplay(LId + '_Creation_Edit', true);
            _SurCreationDeb.call(this, false, {
                numeroLigneCreation: aLigne
            });
        }

        function _SurCreationDeb(ASuivant, aParams) {
            var lParamsCreation = Object.assign({
                origine: null,
                numeroLigneCreation: -1,
                idCellule: null,
                ignorerEventsNode: false
            }, aParams);
            if (_getNonEditable.call(this) || !this.Donnees) {
                return;
            }
            if (this._cache.positionCreation === 0) {
                this._cache.listeValeursCreation = [];
            }
            var lInterrompreCreation = false;
            if (!this._cache.creationEnCours || ASuivant) {
                this._cache.numeroColonneCreationEnCours = this.ListeCreations[this._cache.positionCreation++];
                var lParams = _getParamsCellule.call(this, this._cache.numeroColonneCreationEnCours, -1, {
                    surLigneCreation: true,
                    surEdition: true
                });
                this._cache.creationEnCoursEvenement = _SurCreationEvenement.call(this, lParams.colonne);
                if (this._cache.creationEnCoursEvenement === EGenreEvenementListe.Creation) {
                    lInterrompreCreation = true;
                } else if (lParamsCreation.origine !== 'menucontextuel' && this._cache.positionCreation === 1 && this.Donnees.AvecMenuContextuel(lParams)) {
                    this._cache.positionCreation = 0;
                    this._ouvrirMenuContextuel(lParams);
                    lInterrompreCreation = true;
                }
                if (lInterrompreCreation) {
                    var LId = _getIdCreation.call(this, -1, lParams.ligne);
                    GHtml.setDisplay(LId + '_Creation_Edit', false);
                    GHtml.setDisplay(LId + '_Creation', true);
                    return;
                }
                _surSelection.call(this, -1, -1, {
                    avecFocus: false
                });
                this._cache.creationEnCours = true;
                this.IdCellule = lParamsCreation.idCellule || _getIdCreation.call(this, _colonneCreationUniqueEnErreur.call(this) ? 0 : this._cache.numeroColonneCreationEnCours, this._cache.numeroLigneCreationDynamique === null || this._cache.numeroLigneCreationDynamique === undefined ? -1 : this._cache.numeroLigneCreationDynamique);
                _Entrer_Edition.call(this);
                var lType = this.Donnees.GetTypeValeur(lParams, lParams.colonne, lParams.article);
                switch (lType) {
                    case this.Donnees.ETypeCellule.ZoneTexte:
                        _Entrer_ZoneTexte.call(this, lParams.colonne, undefined, true, lParamsCreation.numeroLigneCreation, lParamsCreation.ignorerEventsNode);
                        break;
                    default:
                        _Entrer_Texte.call(this, lParams.colonne, undefined, true, lType, lParamsCreation.ignorerEventsNode);
                        break;
                }
                if (!this._cache.creationEnCoursEvenement) {
                    GHtml.setFocusEdit(this.IdEdition);
                    GHtml.setSelectionEdit(this.IdEdition);
                }
            }
        }

        function _annulerCreation() {
            _SurCreationFin.call(this, -1, true);
        }

        function _SurCreationFin(ASelectionLigne, aAnnuler) {
            if (this._cache.creationEnCours) {
                _refreshSelf.call(this);
                this._celluleEditee_bak = null;
                this._cache.creationEnCours = false;
                this._cache.creationEnCoursEvenement = false;
                this._cache.finEditionCreation = null;
                this._cache.positionCreation = 0;
                this._cache.listeValeursCreation = [];
                this._cache.numeroColonneCreationEnCours = null;
                this._cache.numeroLigneCreationDynamique = null;
                this._cache.rechercheTexte.saisie = '';
                _actualiser.call(this);
                _surSelection.call(this, -1, ASelectionLigne, {
                    avecFocus: false
                });
                _SurSelectionEvenement.call(this, -1, ASelectionLigne);
                GHtml.setFocus(this.Nom + '_recupnavigation');
                if (aAnnuler && ASelectionLigne === -1) {
                    GHtml.setFocus(this.IdPremierElement);
                } else {
                    GHtml.setFocus(this.getIdCellule(0, ASelectionLigne) + '_div');
                }
                if (ASelectionLigne >= 0) {
                    _SurApresCreationEvenement.call(this, ASelectionLigne);
                } else {
                    _SurApresErreurCreationEvenement.call(this);
                }
                _refreshSelf.call(this);
            }
        }

        function _SurCreation(aValeur) {
            if (this._fenetreInformationAffichee) {
                return;
            }
            if (this._messageEnCoursSurCreation) {
                return;
            }
            if (!this._cache.creationEnCours) {
                return;
            }
            delete this._valeurEnEdition;
            var lColonne = this._cache.numeroColonneCreationEnCours,
                lLigne = -1,
                lValeur = aValeur;
            var lParams = _getParamsCellule.call(this, lColonne, lLigne, {
                surEdition: true,
                surCreation: true
            });
            if (MethodesObjet.isString(lValeur) && this.Donnees.avecTrimSurEdition(lParams)) {
                lValeur = lValeur.trim();
            }
            if (lValeur !== null && lValeur !== undefined && (lValeur !== '' || this.Donnees.autoriserChaineVideSurEdition(lParams))) {
                this._cache.listeValeursCreation[lColonne] = lValeur;
                if (this.ListeCreations[this._cache.positionCreation] === null || this.ListeCreations[this._cache.positionCreation] === undefined) {
                    lParams = _getParamsCellule.call(this, -1, -1, {
                        surEdition: true,
                        surCreation: true
                    });
                    lLigne = this.Donnees._SurCreation(this._cache.listeValeursCreation, this._cache.numeroLigneCreationDynamique === null || this._cache.numeroLigneCreationDynamique === undefined ? -1 : this._cache.numeroLigneCreationDynamique, lParams);
                    this._messageEnCoursSurCreation = true;
                    try {
                        _afficherMessage.call(this, lParams);
                    } finally {
                        delete this._messageEnCoursSurCreation;
                    }
                } else {
                    this._cache.creationEnCours = false;
                    this._setStyleCellule(this.IdCellule, lColonne, lLigne, false, true);
                    if (MethodesObjet.isString(lValeur)) {
                        GHtml.setHtml(this.IdCellule, lValeur);
                    }
                    _SurCreationDeb.call(this, true);
                    return;
                }
            }
            _SurCreationFin.call(this, lLigne);
        }

        function _setCreationLigne(aCreationLigneBis) {
            if (aCreationLigneBis < 0 || !MethodesObjet.isNumber(aCreationLigneBis)) {
                return;
            }
            this._cache.numeroLigneCreationDynamique = aCreationLigneBis;
            _actualiser.call(this);
            _surLigneCreationUnique.call(this, true, this._cache.numeroLigneCreationDynamique);
            _SurCreationDeb.call(this);
        }

        function _getParamsCellule(aNumeroColonne, aNumeroLigne, aParamsSupp) {
            var lParams = {
                ligne: aNumeroLigne,
                colonne: aNumeroColonne,
                article: null,
                idColonne: null,
                declarationColonne: {},
                instance: this
            };
            if (lParams.ligne >= 0 && this.Donnees && MethodesObjet.isNumber(lParams.ligne)) {
                lParams.article = this.getArticleDeLigne(lParams.ligne);
            }
            if (lParams.colonne >= 0 && this.Donnees && MethodesObjet.isNumber(lParams.colonne)) {
                lParams.idColonne = this.Donnees.getId(lParams.colonne);
                lParams.declarationColonne = this._cache.declColonnesByIds[lParams.idColonne];
            }
            if (aParamsSupp) {
                Object.assign(lParams, aParamsSupp);
            }
            return lParams;
        }

        function _getParamsCallback(aGenre, I, J, aParamsSupp) {
            return Object.assign({
                genreEvenement: aGenre,
                surClavier: false
            }, _getParamsCellule.call(this, I, J, aParamsSupp));
        }

        function _surEditionDebutApresConfirmation(aParams) {
            var lIdCellule = this.getIdCellule(aParams.colonne, aParams.ligne);
            if (this._cache.ouvrirSelecteurFileParLigne[aParams.ligne + '_' + aParams.colonne] && this.Donnees.avecSelecFile(aParams)) {
                this._cache.ouvrirSelecteurFileParLigne[aParams.ligne + '_' + aParams.colonne]();
            } else if (this.Donnees.AvecEvenement_Edition(aParams.colonne, aParams.article, aParams)) {
                this._cache.editionEnCoursEvenement = true;
                _afficher_marqueurEditionSurCellule.call(this, aParams.colonne, aParams.ligne);
                var lIdCelluleFocus = lIdCellule + '_div';
                GHtml.setFocus(lIdCelluleFocus, true);
                var lthis = this;
                $('#' + lIdCelluleFocus.escapeJQ()).one('focusout', function() {
                    $('#' + lIdCelluleFocus.escapeJQ()).one('focusin', function() {
                        if (lthis._cache.editionEnCoursEvenement) {
                            lthis._cache.editionEnCoursEvenement = false;
                            _nettoyerElementsEditionEnCours.call(lthis);
                        }
                    });
                });
                var lParamsCallback = _getParamsCallback.call(this, EGenreEvenementListe.Edition, aParams.colonne, aParams.ligne);
                lParamsCallback.actualisationApresEdition = function(aIgnorerActualisation) {
                    if (this.isDestroyed()) {
                        return;
                    }
                    _finaliserEdition.call(this, {
                        ligne: aParams.ligne,
                        colonne: aParams.colonne,
                        ignorerActualisation: aIgnorerActualisation
                    });
                }.bind(this);
                lParamsCallback.ouvrirMenuContextuel = function(aParamsPerso) {
                    this._ouvrirMenuContextuel(Object.assign({
                        id: this.getIdCellule(aParams.colonne, aParams.ligne)
                    }, aParams, aParamsPerso));
                }.bind(this);
                this.Evenement.call(this.Pere, lParamsCallback, EGenreEvenementListe.Edition, aParams.colonne, aParams.ligne);
                _refreshSelf.call(this);
            } else {
                this._cache.editionEnCours = true;
                for (var iLigne = 0; iLigne < this._cache.lignesSelectionnees.length; iLigne++) {
                    if (iLigne !== aParams.ligne && this._cache.lignesSelectionnees[iLigne]) {
                        this.SelectionnerLigne({
                            ligne: iLigne,
                            selectionner: false,
                            avecEvenementModificationSelection: false
                        });
                    }
                }
                this._celluleEditee_bak = null;
                this.IdCellule = lIdCellule;
                _Entrer_Edition.call(this);
                _afficher_marqueurEditionSurCellule.call(this, aParams.colonne, aParams.ligne);
                var lTypeValeur = this.Donnees.GetTypeValeur(aParams, aParams.colonne, aParams.article);
                switch (lTypeValeur) {
                    case this.Donnees.ETypeCellule.ZoneTexte:
                        _Entrer_ZoneTexte.call(this, aParams.colonne, aParams.ligne, false);
                        break;
                    case this.Donnees.ETypeCellule.Image:
                    case this.Donnees.ETypeCellule.Coche:
                        _SurEdition.call(this, aParams, 'coche', true);
                        break;
                    case this.Donnees.ETypeCellule.DateCalendrier:
                        this._Entrer_DateCalendrier(aParams);
                        break;
                    default:
                        _Entrer_Texte.call(this, aParams.colonne, aParams.ligne, false, lTypeValeur);
                        break;
                }
                if (!MethodesTableau.existe(lTypeValeur, [this.Donnees.ETypeCellule.Coche, this.Donnees.ETypeCellule.Image, this.Donnees.ETypeCellule.DateCalendrier])) {
                    var lElement = GHtml.getElement(this.IdEdition);
                    if (lElement) {
                        GHtml.setFocus(lElement);
                        if (lElement.select) {
                            lElement.select();
                        }
                        if (this.optionsInterne.versionMobile && lTypeValeur === this.Donnees.ETypeCellule.Note && lElement.click) {
                            lElement.click();
                        }
                    }
                }
            }
        }

        function _SurEditionDeb(aColonne, aLigne) {
            if (_getNonEditable.call(this)) {
                return;
            }
            var lParams = _getParamsCellule.call(this, aColonne, aLigne, {
                surEdition: true
            });
            var lNumeroColonne = this.Donnees.getColonneTransfertEdition(lParams);
            if (lNumeroColonne && MethodesObjet.isString(lNumeroColonne)) {
                lNumeroColonne = this.getNumeroColonneDIdColonne(lNumeroColonne);
            }
            if (lNumeroColonne >= 0 && MethodesObjet.isNumber(lNumeroColonne)) {
                lParams = _getParamsCellule.call(this, lNumeroColonne, aLigne, {
                    surEdition: true
                });
            }
            if (lParams.article &&
                !this._cache.editionEnCours && (this.Donnees.AvecEdition(lParams.colonne, lParams.article, lParams) ||
                    this.Donnees.AvecEvenement_Edition(lParams.colonne, lParams.article, lParams) ||
                    this.Donnees.avecSelecFile(lParams))) {
                _nettoyerElementsEditionEnCours.call(this);
                if (this.Donnees.editionRefusee(lParams)) {
                    return;
                }
                if (this.Donnees._Edition_Confirmation(lParams)) {
                    GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Confirmation,
                        message: this.Donnees.GetMessage(),
                        callback: function(AAccepte) {
                            if (AAccepte === EGenreAction.Valider) {
                                _surEditionDebutApresConfirmation.call(this, lParams);
                            }
                        }.bind(this)
                    });
                } else {
                    _surEditionDebutApresConfirmation.call(this, lParams);
                }
            }
        }

        function _SurEdition(aParams, aValeur, aAvecModification, aForcerEvenement) {
            if (this._fenetreInformationAffichee) {
                return;
            }
            var lLigne = aParams.ligne;
            if (this._cache.editionEnCours || this._cache.editionEnCoursEvenement) {
                delete this._valeurEnEdition;
                delete this._cache.avecModificationSaisie;
                if (!aAvecModification) {
                    _surEditionFin.call(this, aParams.colonne, aParams.ligne, aForcerEvenement);
                    return;
                }
                var lValeur = aValeur;
                if (MethodesObjet.isString(lValeur) && this.Donnees.avecTrimSurEdition(aParams)) {
                    lValeur = lValeur.trim();
                }
                if (((lValeur !== null && lValeur !== undefined) || this.Donnees.GetTypeValeur(aParams, aParams.colonne, aParams.article) === this.Donnees.ETypeCellule.DateCalendrier) && (lValeur !== '' || this.Donnees.autoriserChaineVideSurEdition(aParams))) {
                    aParams.valeur = lValeur;
                    lLigne = this.Donnees._SurEdition(aParams);
                    if (!this._messageEnCoursDAffichage) {
                        this._messageEnCoursDAffichage = true;
                        _afficherMessage.call(this, aParams);
                        delete this._messageEnCoursDAffichage;
                    }
                }
                _surEditionFin.call(this, aParams.colonne, lLigne, true, true);
            }
        }

        function _finaliserEdition(aParametres) {
            var lParametres = Object.assign({
                ligne: -1,
                colonne: -1,
                avecEvenement: false,
                avecModification: false,
                ignorerActualisation: false
            }, aParametres);
            this._cache.editionEnCours = false;
            this._cache.editionEnCoursEvenement = false;
            this._cache.finEditionCreation = null;
            if (this._cache.timeout_ignorerScrollSortieEdition) {
                clearTimeout(this._cache.timeout_ignorerScrollSortieEdition);
                delete this._cache.timeout_ignorerScrollSortieEdition;
            }
            _nettoyerElementsEditionEnCours.call(this);
            if (lParametres.ignorerActualisation !== true) {
                if (!this.Donnees || this.Donnees.avecActualisation_ApresEdition(lParametres.ligne, lParametres.colonne)) {
                    _actualiser.call(this, {
                        conserverSelection: false,
                        zonesActualisation: {
                            contenu: true,
                            total: true
                        },
                        avecEvenementModificationSelection: false
                    });
                    _surSelection.call(this, lParametres.colonne, lParametres.ligne, {
                        avecFocus: false
                    });
                } else {
                    if (this._celluleEditee_bak) {
                        GHtml.setHtml(this.IdCellule, this._celluleEditee_bak, {
                            controleur: this.controleur
                        });
                        this.SelectionnerLigne({
                            ligne: lParametres.ligne
                        });
                    }
                }
                delete this._celluleEditee_bak;
                if (lParametres.ligne >= 0 && lParametres.colonne >= 0) {
                    var lElement = GHtml.getElement(this.getIdCellule(lParametres.colonne, lParametres.ligne) + '_div');
                    if (GHtml.elementExiste(lElement) && lElement.focus) {
                        try {
                            lElement.focus({
                                preventScroll: true
                            });
                        } catch (e) {}
                    }
                } else {
                    GHtml.setFocus(this.IdPremierElement, true);
                }
            }
            _refreshSelf.call(this);
            if (lParametres.colonne >= 0 && lParametres.avecEvenement) {
                _SurApresEditionEvenement.call(this, _getParamsCellule.call(this, lParametres.colonne, lParametres.ligne, {
                    avecModification: !!lParametres.avecModification
                }));
            }
        }

        function _surEditionFin(aColonne, aLigne, aAvecEvenement, aAvecModification) {
            _finaliserEdition.call(this, {
                ligne: aLigne,
                colonne: aColonne,
                avecEvenement: aAvecEvenement,
                avecModification: aAvecModification,
                ignorerActualisation: !this._cache.editionEnCours && !this._cache.editionEnCoursEvenement
            });
        }

        function _surSuppression() {
            var lListeSelections = _getListeElementsSelection.call(this);
            if (this._options.AvecSuppression && !_getNonEditable.call(this) && (this._cache.selectionCellule.ligne > -1 || (lListeSelections && lListeSelections.GetNbrElements() > 0))) {
                var lParamsCellule = _getParamsCellule.call(this, this._cache.selectionCellule.colonne, this._cache.selectionCellule.ligne, {
                    surSuppression: true
                });
                if (this.Donnees._Suppression_Impossible(this._cache.selectionCellule.ligne, lListeSelections)) {
                    _afficherMessage.call(this, lParamsCellule);
                } else if (this.Donnees._Suppression_Confirmation(this._cache.selectionCellule.ligne, lListeSelections)) {
                    GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Confirmation,
                        message: this.Donnees.GetMessage()
                    }).then(function(aGenreAction) {
                        _SurSuppressionApresConfirmation.call(this, lListeSelections, lParamsCellule, aGenreAction);
                    }.bind(this));
                } else {
                    _SurSuppressionApresConfirmation.call(this, lListeSelections, lParamsCellule, EGenreAction.Valider);
                }
                this.EnSuppression = false;
            }
        }

        function _SurSuppressionApresConfirmation(aListeSelections, aParamsCellule, AAccepte) {
            if (AAccepte === EGenreAction.Valider) {
                Object.assign(aParamsCellule, {
                    listeSelections: aListeSelections,
                    listeSuppressions: new ObjetListeElements()
                });
                if (aListeSelections) {
                    aParamsCellule.listeSuppressions = this.Donnees.getListeSupprimables(aListeSelections, aParamsCellule);
                }
                var lAvecEvenement = _SurSuppressionEvenement.call(this, aParamsCellule);
                if (lAvecEvenement && this.Donnees.avecInterruptionSuppression()) {
                    this._cache.selectionCellule.ligne = -1;
                } else {
                    this._cache.selectionCellule.ligne = this.Donnees._SurSuppression(aParamsCellule.ligne, aParamsCellule.listeSuppressions);
                    _actualiser.call(this);
                    if (this.Donnees.AvecEtatSaisie(aParamsCellule)) {
                        this.SetEtatSaisie(true);
                    }
                }
                _SurApresSuppressionEvenement.call(this, aParamsCellule);
            }
            GHtml.setFocus(this.IdPremierElement, true, 0);
        }

        function _getIdCreation(I, J) {
            return this.Nom + '_Creation_' + I + (J === null || J === undefined ? '' : '_' + J);
        }
        _ObjetListe.prototype._testUnitaire_GetIdCreation = function(I, J) {
            return _getIdCreation.call(this, I, J);
        };

        function _getListeElementsSelection() {
            var lSelections = new ObjetListeElements();
            if (this._cache.lignesSelectionnees) {
                for (var i = 0; i < this._cache.lignesSelectionnees.length; i++) {
                    if (this._cache.lignesSelectionnees[i]) {
                        var lElement = this.getArticleDeLigne(i);
                        if (lElement) {
                            lSelections.AddElement(lElement);
                        }
                    }
                }
            }
            return lSelections;
        }

        function _getCellulesSelection(aAvecLignesInvisible) {
            var lSelections = [];
            if (this._cache.lignesSelectionnees && this.Donnees) {
                this._cache.lignesSelectionnees.forEach(function(aSelectionLigne, aLigne) {
                    if (!aAvecLignesInvisible && !_estLigneVisible(this, aLigne)) {
                        return;
                    }
                    var lLigne = null,
                        lAvecSelectionParCelluleSurLigne = false;
                    if (aSelectionLigne && aSelectionLigne.forEach) {
                        aSelectionLigne.forEach(function(aSelectionne, aColonne) {
                            if (aSelectionne &&
                                _estColonneVisible.call(this, aColonne) &&
                                this.Donnees._AvecSelection(aColonne, aLigne)) {
                                if (!lLigne) {
                                    lLigne = {
                                        ligne: aLigne,
                                        article: this.getArticleDeLigne(aLigne),
                                        hashColonnesSelecParCellule: {},
                                        colonnes: [],
                                        idsColonnes: []
                                    };
                                }
                                lLigne.hashColonnesSelecParCellule[aColonne] = true;
                                lLigne.colonnes.push(aColonne);
                                lLigne.idsColonnes.push(this.getIdColonneDeNumeroColonne(aColonne));
                                if (!lAvecSelectionParCelluleSurLigne && _estSelectionParCellule.call(this, aLigne, aColonne)) {
                                    lAvecSelectionParCelluleSurLigne = true;
                                }
                            }
                        }, this);
                    } else if (aSelectionLigne) {}
                    if (lLigne) {
                        if (!lAvecSelectionParCelluleSurLigne) {
                            delete lLigne.hashColonnesSelecParCellule;
                        }
                        lSelections.push(lLigne);
                    }
                }, this);
            }
            return lSelections;
        }

        function _setCellulesSelection(aListe, aParams) {
            var lAvecActualisationPage;

            function _gererSelection(aParams, aElementTrouve, aNumeroLigne, aNumeroColonne, aEtatSelec) {
                if (!aElementTrouve && aEtatSelec) {
                    if (!aParams.ajoutSelection) {
                        _selectionner.call(this, {
                            ligne: aNumeroLigne,
                            colonne: aNumeroColonne,
                            selectionner: false,
                            avecEvenement: aParams.avecEvenement,
                            _avecVisuCadreSelection: false
                        });
                    }
                } else if (aElementTrouve) {
                    var lEstSelection = aEtatSelec;
                    if (!lEstSelection) {
                        _selectionner.call(this, {
                            ligne: aNumeroLigne,
                            colonne: aNumeroColonne,
                            selectionner: true,
                            avecActualisationPage: lAvecActualisationPage,
                            avecScroll: aParams.avecScroll,
                            deselectionnerTout: aParams.ignorerControleMultiSelection === true ? null : false,
                            avecEvenement: aParams.avecEvenement && !lEstSelection,
                            _avecVisuCadreSelection: false
                        });
                    }
                    lAvecActualisationPage = false;
                }
            }

            function _trouveIdentique(aElement) {
                if (aElement && aElement.article && aElement.article === lElement) {
                    lElementTrouve = true;
                    lHashColonnesSelectionnees = aElement.hashColonnesSelecParCellule;
                    return false;
                }
                return true;
            }

            function _trouveNumeroGenre(aElement) {
                if (aElement && aElement.article && aElement.article.egalParNumeroEtGenre(lElement.GetNumero(), lElement.GetGenre())) {
                    lElementTrouve = aElement;
                    lHashColonnesSelectionnees = aElement.hashColonnesSelecParCellule;
                    return false;
                }
                return true;
            }

            function _trouverAvecRecherche(aElement) {
                if (lFuncRecherche(lElement, aElement.article) === true) {
                    lElementTrouve = true;
                    lHashColonnesSelectionnees = aElement.hashColonnesSelecParCellule;
                    return false;
                }
                return true;
            }
            if (!aListe || !Array.isArray(aListe)) {
                aListe = [];
            }
            var iColonne, lElement, lElementTrouve, lHashColonnesSelectionnees, lParams = Object.assign({
                    instancesIdentiques: false,
                    avecScroll: false,
                    avecEvenement: false,
                    avecEvenementModificationSelection: true,
                    ajoutSelection: false,
                    funcRecherche: null,
                    avecSelectionSurLigneInvisible: false,
                    avecActualisationPage: true
                }, aParams),
                lFuncRecherche = lParams.funcRecherche && MethodesObjet.isFunction(lParams.funcRecherche) ? lParams.funcRecherche : null;
            lAvecActualisationPage = lParams.avecActualisationPage;
            var lSelectionsPrecedente = lParams.avecEvenementModificationSelection ? _getCellulesSelection.call(this, true) : null;
            var lFuncs = [];
            for (var lNumeroLigne = this.Donnees.GetNbrLignes() - 1; lNumeroLigne >= 0; lNumeroLigne--) {
                lElement = this.getArticleDeLigne(lNumeroLigne);
                lElementTrouve = false;
                lHashColonnesSelectionnees = null;
                if (lElement && aListe.length > 0 && (lParams.avecSelectionSurLigneInvisible || _estLigneVisible(this, lNumeroLigne))) {
                    if (lFuncRecherche) {
                        aListe.every(_trouverAvecRecherche);
                    } else if (lParams.instancesIdentiques) {
                        aListe.every(_trouveIdentique);
                    } else {
                        aListe.every(_trouveNumeroGenre);
                    }
                }
                var lEtatSelec;
                var lColonnes = [];
                if (lHashColonnesSelectionnees) {
                    lEtatSelec = [];
                    for (iColonne = 0; iColonne < this.ListeTailles.length; iColonne++) {
                        if (_estColonneVisible.call(this, iColonne)) {
                            lColonnes.push(iColonne);
                            lEtatSelec.push(_etatSelectionCellule.call(this, {
                                ligne: lNumeroLigne,
                                colonne: iColonne
                            }));
                        }
                    }
                } else {
                    lEtatSelec = _etatSelectionCellule.call(this, {
                        ligne: lNumeroLigne,
                        colonne: -1
                    });
                }
                lFuncs.push({
                    hashColonnesSelectionnees: lHashColonnesSelectionnees,
                    elementTrouve: lElementTrouve,
                    numeroLigne: lNumeroLigne,
                    colonnes: lColonnes,
                    etatSelec: lEtatSelec
                });
            }
            lFuncs.forEach(function(aParam) {
                if (aParam.hashColonnesSelectionnees) {
                    aParam.colonnes.forEach(function(aColonne) {
                        _gererSelection.call(this, lParams, aParam.elementTrouve && aParam.hashColonnesSelectionnees[aColonne], aParam.numeroLigne, aColonne, aParam.etatSelec[aColonne]);
                    }.bind(this));
                } else {
                    _gererSelection.call(this, lParams, aParam.elementTrouve, aParam.numeroLigne, -1, aParam.etatSelec);
                }
            }.bind(this));
            if (this._options.avecCadreSelection) {
                _getTraitementsAffichageSelection.call(this).forEach(function(aTraitement, aIndex, aArray) {
                    _setCadreSelection.call(this, aTraitement, aIndex, aArray);
                }.bind(this));
            }
            if (lParams.avecEvenementModificationSelection) {
                _surModificationSelectionEvenement.call(this, lSelectionsPrecedente);
            }
            return this;
        }

        function _setTableauCellulesSelection(aListe, aParams) {
            if (!aListe || !Array.isArray(aListe)) {
                aListe = [];
            }
            this._cache.lignesSelectionnees_prec = MethodesObjet.dupliquer(this._cache.lignesSelectionnees);

            function _trouveIdentique(aCherche, aElement, aIndex) {
                if (aElement && aCherche && aElement.article && aElement.article === aCherche) {
                    lIndexTrouve = aIndex;
                    return false;
                }
                return true;
            }
            var lListe = [],
                lIndexTrouve = -1;
            if (aListe && Array.isArray(aListe)) {
                aListe.forEach(function(aElement) {
                    var lLigne = null;
                    if (!aElement.article) {
                        return;
                    }
                    lIndexTrouve = -1;
                    if (!lListe.every(_trouveIdentique.bind(this, aElement.article)) && lIndexTrouve >= 0) {
                        lLigne = lListe[lIndexTrouve];
                    }
                    if (!lLigne) {
                        lLigne = {
                            article: aElement.article
                        };
                    }
                    var lNumeroColonne = -1;
                    if (aElement.idColonne) {
                        lNumeroColonne = this.getNumeroColonneDIdColonne(aElement.idColonne);
                    }
                    if (lNumeroColonne < 0 && aElement.colonne >= 0) {
                        lNumeroColonne = aElement.colonne;
                    }
                    if (lNumeroColonne >= 0) {
                        if (!lLigne.hashColonnesSelecParCellule) {
                            lLigne.hashColonnesSelecParCellule = {};
                        }
                        lLigne.hashColonnesSelecParCellule[lNumeroColonne] = true;
                    }
                    lListe.push(lLigne);
                }.bind(this));
            }
            return _setCellulesSelection.call(this, lListe, aParams);
        }

        function _setListeElementsSelection(aListeElements, aParams) {
            this._cache.lignesSelectionnees_prec = MethodesObjet.dupliquer(this._cache.lignesSelectionnees);
            if (!aListeElements || !aListeElements.GetElementParElement) {
                aListeElements = new ObjetListeElements();
            }
            var lListe = [];
            aListeElements.parcourir(function(D) {
                lListe.push({
                    article: D
                });
            });
            return _setCellulesSelection.call(this, lListe, aParams);
        }

        function _navigationCelluleSuivante(aParametres) {
            if (!this.Donnees) {
                return false;
            }
            if (this._cache.finEditionCreation) {
                var lResultFinEdition = this._cache.finEditionCreation();
                if (lResultFinEdition && lResultFinEdition.promiseMessageErreur) {
                    return;
                }
            }
            var lParametres = Object.assign({
                ligne: this._cache.selectionCellule.ligne,
                colonne: this._cache.selectionCellule.colonne,
                orientationVerticale: false,
                sensInverse: false,
                avecSelection: false,
                avecCelluleEditable: false,
                avecFocusCellule: true
            }, aParametres);
            var lLigne = lParametres.ligne,
                lColonne = lParametres.colonne,
                lNbLignes = this.Donnees.Donnees.GetNbrElements(),
                lNbColonnes = this.ListeTailles.length,
                lElement = null;
            if (lLigne < 0 || lColonne < 0) {
                lLigne = 0;
                lColonne = -1;
                lParametres.orientationVerticale = false;
                lParametres.sensInverse = false;
            }
            while (!lElement) {
                if (lParametres.orientationVerticale) {
                    lLigne += lParametres.sensInverse ? -1 : 1;
                    if (lLigne >= lNbLignes || lLigne < 0) {
                        lLigne = lParametres.sensInverse ? lNbLignes - 1 : 0;
                        lColonne += lParametres.sensInverse ? -1 : 1;
                    }
                } else {
                    lColonne += lParametres.sensInverse ? -1 : 1;
                    if (lColonne >= lNbColonnes || lColonne < 0) {
                        lColonne = lParametres.sensInverse ? lNbColonnes - 1 : 0;
                        lLigne += lParametres.sensInverse ? -1 : 1;
                    }
                }
                if (lLigne >= lNbLignes || lColonne >= lNbColonnes || lLigne < 0 || lColonne < 0 || isNaN(lLigne) || isNaN(lColonne)) {
                    break;
                }
                var lParamsCellule = _getParamsCellule.call(this, lColonne, lLigne);
                if (_estColonneVisible.call(this, lColonne) &&
                    _estLigneVisible(this, lLigne) && (!lParametres.avecSelection || this.Donnees._AvecSelection(lColonne, lLigne)) && (!lParametres.avecCelluleEditable || (!_getNonEditable.call(this) && (this.Donnees.AvecEdition(lParamsCellule.colonne, lParamsCellule.article, lParamsCellule) || this.Donnees.AvecEvenement_Edition(lParamsCellule.colonne, lParamsCellule.article, lParamsCellule))))) {
                    lElement = GHtml.getElement(this.getIdCellule(lColonne, lLigne) + '_div');
                }
            }
            if (lElement) {
                if (lParametres.avecSelection) {
                    var lAvecFocusCellule = lParametres.avecFocusCellule && [ObjetDonneesListe.ETypeCellule.ZoneTexte, ObjetDonneesListe.ETypeCellule.Note].indexOf(this.Donnees.GetTypeValeur(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article)) < 0;
                    this.selectionnerCellule({
                        ligne: lLigne,
                        colonne: lColonne,
                        deselectionnerTout: true,
                        avecFocusCellule: lAvecFocusCellule,
                        avecEvenement: true
                    });
                } else {
                    GHtml.setFocus(lElement);
                }
                this._cache.selectionCellule = {
                    ligne: lLigne,
                    colonne: lColonne
                };
                return true;
            }
            return false;
        }

        function _selectionnerCelluleSuivante(aParametres) {
            var lParametres = Object.assign({
                ligne: this._cache.selectionCellule.ligne,
                colonne: this._cache.selectionCellule.colonne,
                orientationVerticale: false,
                sensInverse: false,
                avecSelection: true,
                avecCelluleEditable: false,
                entrerEdition: false
            }, aParametres);
            if (lParametres.ligne < 0 ||
                lParametres.colonne < 0 ||
                !this.Donnees) {
                return this;
            }
            if (lParametres.entrerEdition) {
                lParametres.avecCelluleEditable = true;
            }
            if (_navigationCelluleSuivante.call(this, lParametres) && lParametres.entrerEdition && (lParametres.entrerEdition === true || (MethodesObjet.isFunction(lParametres.entrerEdition) && lParametres.entrerEdition(_getParamsCellule.call(this, this._cache.selectionCellule.colonne, this._cache.selectionCellule.ligne))))) {
                this.demarrerEditionSurCellule(this._cache.selectionCellule.ligne, this._cache.selectionCellule.colonne);
            }
            return this;
        }

        function _estColonneVisible(aNumeroColonne, aCache) {
            return aNumeroColonne >= 0 &&
                this.ListeTailles &&
                aNumeroColonne < this.ListeTailles.length && (aCache || this._cache).tableauColonnesCachees[aNumeroColonne] !== true;
        }

        function _calculColonnesCachees(aCache) {
            var lColonnesCachees = [],
                lTabColonnes = this._options.colonnesCachees;
            if (this.Donnees && this.Donnees.enImpression && this._options.colonnesCacheesImpression) {
                lTabColonnes = this._options.colonnesCacheesImpression;
            }
            if (!MethodesObjet.isArray(lTabColonnes) && isFinite(lTabColonnes)) {
                lColonnesCachees.push(lTabColonnes);
            } else if (MethodesObjet.isArray(lTabColonnes)) {
                lColonnesCachees = lColonnesCachees.concat(lTabColonnes);
            }
            lColonnesCachees.sort();
            aCache.nbColonnesCachees = 0;
            aCache.tableauColonnesCachees = [];
            aCache.tableauColonnesCacheesOriginal = [];
            if (this.ListeTailles && this.ListeTailles.forEach) {
                this.ListeTailles.forEach(function(aTaille, aIndex) {
                    var lNonTrouve = lColonnesCachees.indexOf(aIndex) === -1;
                    if (lNonTrouve && this._cache.colonnes.listeIds) {
                        var lIdCol = this._cache.colonnes.listeIds[aIndex];
                        if (lIdCol) {
                            lNonTrouve = lColonnesCachees.indexOf(lIdCol) === -1;
                        }
                    }
                    var lIndexOriginal = aIndex;
                    if (aCache.listeCorrespondancesColonnes && lIdCol) {
                        lIndexOriginal = aCache.listeCorrespondancesColonnes.indexOf(aIndex);
                    }
                    if (lNonTrouve) {
                        aCache.tableauColonnesCachees[aIndex] = false;
                        aCache.tableauColonnesCacheesOriginal[lIndexOriginal] = false;
                    } else {
                        aCache.tableauColonnesCachees[aIndex] = true;
                        aCache.tableauColonnesCacheesOriginal[lIndexOriginal] = true;
                        aCache.nbColonnesCachees++;
                    }
                }.bind(this));
            }
        }

        function _colonneCreationUniqueEnErreur() {
            return this.ListeCreations.length === 1 && (this.ListeCreations[0] < 0 || this.ListeCreations[0] >= this.ListeTailles.length);
        }

        function _deploiementSurCellule(aParams) {
            var lTypeValeur = this.Donnees.GetTypeValeur(aParams, aParams.colonne, aParams.article);
            return this.Donnees.AvecDeploiement() && this.Donnees.AvecDeploiementSurColonne(aParams) && this.Donnees.estUnDeploiement(aParams) && (lTypeValeur !== ObjetDonneesListe.ETypeCellule.Coche);
        }

        function _SurDeploiement(aEvent, aColonne, aLigne, aDeploiementSurImage) {
            if (this._cache.creationEnCours || this._cache.editionEnCours) {
                return;
            }
            if (aEvent.type !== 'keyup' && aEvent.which === 2) {
                return;
            }
            var lParams = _getParamsCellule.call(this, aColonne, aLigne, {
                surDeploiement: true
            });
            if (!aDeploiementSurImage && !this.Donnees.avecEventDeploiementSurCellule(lParams)) {
                return;
            }
            if (_ObjetListe.protected._deploiementSurCellule.call(this, lParams)) {
                this.Donnees.surDeploiement(aColonne, aLigne, lParams.article);
                _ObjetListe.protected._actualiser.call(this, {
                    sansTriDonnees: true,
                    conserverSelection: true,
                    conserverFocusSelection: true,
                    ignorerFocusListe: false
                });
                if (this.Donnees.AvecEvenement_Deploiement(lParams.colonne, lParams.article, lParams)) {
                    this.Evenement.call(this.Pere, _ObjetListe.protected._getParamsCallback.call(this, EGenreEvenementListe.Deploiement, aColonne, aLigne), EGenreEvenementListe.Deploiement, aColonne, aLigne);
                    _ObjetListe.protected._refreshSelf.call(this);
                }
                return true;
            }
        }

        function _avecSuppressionSelectionCourante(aNumeroLigne, aNumeroColonne) {
            var lListe = _getListeElementsSelection.call(this),
                lParams = _getParamsCellule.call(this, aNumeroColonne, aNumeroLigne, {
                    listeSelection: lListe,
                    surSuppression: true
                });
            return this._options.AvecSuppression && !_getNonEditable.call(this) && !this._cache.editionEnCours && lListe.GetNbrElements() > 0 && this.Donnees._AvecSuppression(lParams);
        }
        _ObjetListe.prototype.getIdCelluleTotal = function(aColonne, aLigne) {
            return this.Nom + 'CelluleTotal_' + aColonne + '_' + aLigne;
        };

        function _surClickCelluleTotal(event) {
            var lInfos = _extraireInfosId(this.id);
            var lInstance = event.data.instance;
            if (!lInfos) {
                return;
            }
            var lListeLignesTotal = lInstance.Donnees ? lInstance.Donnees.getListeLignesTotal() : null;
            var lParams = _getParamsCellule.call(lInstance, lInfos.colonne, -1, {
                surTotal: true
            });
            lParams.ligne = lInfos.ligne;
            if (!!lListeLignesTotal) {
                lParams.article = lListeLignesTotal.GetElement(lInfos.ligne);
            }
            if (lInstance.Donnees && lInstance.Donnees.AvecEvenement_SelectionClickTotal(lParams)) {
                if (lInstance.Pere && lInstance.Evenement) {
                    var lParamsCallback = _getParamsCallback.call(lInstance, EGenreEvenementListe.SelectionClickTotal, lParams.colonne, lParams.ligne);
                    lInstance.callback.appel(lParamsCallback, EGenreEvenementListe.SelectionClickTotal, lParams.colonne, lParams.ligne);
                }
            }
        }
        _ObjetListe.protected = {
            _getParamsCellule: _getParamsCellule,
            _getParamsCallback: _getParamsCallback,
            _etatSelectionCellule: _etatSelectionCellule,
            _getTraitementsAffichageSelection: _getTraitementsAffichageSelection,
            _refreshSelf: _refreshSelf,
            _surSuppression: _surSuppression,
            _positionnerCurseurTri: _positionnerCurseurTri,
            _surLigneCreationUnique: _surLigneCreationUnique,
            _getPageMax: _getPageMax,
            _avecBoutonsListe: _avecBoutonsListe,
            _actualiser: _actualiser,
            _SurApresEditionEvenement: _SurApresEditionEvenement,
            _getLargeurPartieScrollV: _getLargeurPartieScrollV,
            _estColonneVisible: _estColonneVisible,
            _initCacheLignes: _initCacheLignes,
            _getIdCreation: _getIdCreation,
            _getHeightCellule: _getHeightCellule,
            _calculColonnesCachees: _calculColonnesCachees,
            _calculerTaillesColonnes: _calculerTaillesColonnes,
            _extraireInfosId: _extraireInfosId,
            _annulerCreation: _annulerCreation,
            _finaliserEdition: _finaliserEdition,
            _nettoyerElementsEditionEnCours: _nettoyerElementsEditionEnCours,
            _getLeftCurseurTri: _getLeftCurseurTri,
            _getListeElementsSelection: _getListeElementsSelection,
            _estSelectionParCellule: _estSelectionParCellule,
            _surSelection: _surSelection,
            _SurSelectionEvenement: _SurSelectionEvenement,
            _SurCreationDeb: _SurCreationDeb,
            _SurCreation: _SurCreation,
            _SurCreationFin: _SurCreationFin,
            _editionDebSurSelection: _editionDebSurSelection,
            _SurEdition: _SurEdition,
            _SurEditionDeb: _SurEditionDeb,
            _surEditionFin: _surEditionFin,
            _navigationCelluleSuivante: _navigationCelluleSuivante,
            _navigationFlechesClavier: _navigationFlechesClavier,
            _getFusionColonnesCellule: _getFusionColonnesCellule,
            _getLigneDebutEtFinPaginationCourante: _getLigneDebutEtFinPaginationCourante,
            _celluleAvecBordureDroite: _celluleAvecBordureDroite,
            _setCadreSelection: _setCadreSelection,
            _colonneCreationUniqueEnErreur: _colonneCreationUniqueEnErreur,
            _estLigneVisible: _estLigneVisible,
            _getNonEditable: _getNonEditable,
            _filtreRechercheTexte: _filtreRechercheTexte,
            _rechercheTexte_getTexteLigne: _rechercheTexte_getTexteLigne,
            _deploiementSurCellule: _deploiementSurCellule,
            _SurDeploiement: _SurDeploiement,
            _avecLigneCreationTitre: _avecLigneCreationTitre,
            _avecSuppressionSelectionCourante: _avecSuppressionSelectionCourante,
            _surClickCelluleTotal: _surClickCelluleTotal,
            _isToucheRetourChariot: _isToucheRetourChariot
        };
        module.exports = _ObjetListe;
    },
    fn: "_objetliste.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('Mobile/Css/ObjetListe_Mobile.css');
        var MethodesObjet = require('MethodesObjet.js');
        var _ObjetListe = require('_ObjetListe.js');
        var GHtml = require('GHtml.js');
        var ObjetDonneesListe = require('ObjetDonneesListe.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var Invocateur = require('Invocateur.js').Invocateur;
        var GLog = require('IELog.js');

        function ObjetListe_Mobile() {
            this.inheritedCreate(arguments);
            Object.assign(this.optionsInterne, {
                avecActualisationParZone: false,
                versionMobile: true
            });
            this.ids.zoneFils = this.idZone;
            this.IdPremierElement = this.idZone;
            Invocateur.abonner('fenetre_mobile_finOuverture', function(aFenetre) {
                var lPere = this.Pere;
                var lCpt = 0;
                while (lPere && lCpt < 1000) {
                    if (lPere === aFenetre) {
                        this.Actualiser(true);
                        return;
                    }
                    lPere = lPere.Pere;
                    lCpt += 1;
                }
            }, this);
        }
        MethodesObjet.heritagePrototype(ObjetListe_Mobile, _ObjetListe);
        ObjetListe_Mobile.initColonne = _ObjetListe.initColonne;
        ObjetListe_Mobile.getTitreCreation = _ObjetListe.getTitreCreation;
        ObjetListe_Mobile.typeBouton = _ObjetListe.typeBouton;
        ObjetListe_Mobile.prototype.resetOptions = function() {
            this.inherited('resetOptions');
            Object.assign(this._options, {
                nonEditable: true,
                avecCelluleEditableTriangle: true,
                avecCocheCheckBox: true,
                paddingCelluleLR: 0,
                paddingCelluleTB: 0,
                nbLignesMax: 0
            });
            return this;
        };
        ObjetListe_Mobile.prototype.getControleur = function(aInstance) {
            return {
                liste: {
                    nodeTdCellule: function(aLigne, aColonne) {
                        $(this.node).on({
                            mousedown: function(aEvent) {
                                if (aInstance._cache.finEditionCreation) {
                                    aInstance._cache.finEditionCreation();
                                    return;
                                }
                                if (aInstance._cache.editionEnCoursEvenement) {
                                    aInstance._cache.editionEnCoursEvenement = false;
                                    _ObjetListe.protected._nettoyerElementsEditionEnCours.call(aInstance);
                                }
                                var lSansSelection = !_ObjetListe.protected._surSelection.call(aInstance, aColonne, aLigne, {
                                    ctrlKey: aEvent.ctrlKey,
                                    shiftKey: aEvent.shiftKey,
                                    surInteractionUtilisateur: true
                                });
                                if (!lSansSelection) {
                                    _ObjetListe.protected._SurSelectionEvenement.call(aInstance, aColonne, aLigne);
                                }
                                if (_ObjetListe.protected._SurDeploiement.call(aInstance, aEvent, aColonne, aLigne)) {
                                    aEvent.preventDefault();
                                }
                            },
                            click: function(aEvent) {
                                _ObjetListe.protected._editionDebSurSelection.call(aInstance, aColonne, aLigne, aEvent);
                            }
                        });
                    },
                    nodeCelluleTotal: function() {
                        var lEventMapCelluleTd = {
                            click: _ObjetListe.protected._surClickCelluleTotal
                        };
                        var lData = {
                            instance: aInstance
                        };
                        $(this.node).on(lEventMapCelluleTd, lData);
                    },
                    nodeCreation: function() {
                        $(this.node).eventValidation(function() {
                            _surBtnCreation.call(aInstance);
                        });
                    },
                    celluleCoche: {
                        getValue: function(aNumeroLigne, aNumeroColonne, aValeur) {
                            return aValeur === true || aValeur === ObjetDonneesListe.EGenreCoche.Verte;
                        },
                        getIndeterminate: function(aNumeroLigne, aNumeroColonne, aValeur) {
                            return aValeur === ObjetDonneesListe.EGenreCoche.Grise;
                        },
                        setValue: function() {},
                        getDisabled: function(aNumeroLigne, aNumeroColonne) {
                            if (_ObjetListe.protected._getNonEditable.call(aInstance)) {
                                return true;
                            }
                            var lParamsCellule = _ObjetListe.protected._getParamsCellule.call(aInstance, aNumeroColonne, aNumeroLigne);
                            return !aInstance.Donnees.AvecEdition(lParamsCellule.colonne, lParamsCellule.article, lParamsCellule);
                        }
                    },
                    boutonListe: {
                        attr: function(aIndex) {
                            var lBouton = aInstance._cache.boutons[aIndex];
                            if (lBouton.getDisabled) {
                                return {
                                    disabled: lBouton.getDisabled({
                                        bouton: lBouton,
                                        node: this.node,
                                        liste: aInstance
                                    })
                                };
                            }
                        },
                        node: function(aIndex) {
                            var lBouton = aInstance._cache.boutons[aIndex];
                            if (lBouton.event) {
                                $(this.node).eventValidation(function(aEvent) {
                                    var lParams = {
                                        bouton: lBouton,
                                        event: aEvent,
                                        liste: aInstance,
                                        node: this,
                                        avecFocus: true
                                    };
                                    lBouton.event(lParams);
                                });
                            }
                        }
                    }
                }
            };
        };

        function _surBtnCreation() {
            var lSurValidation = false;
            var lFenetre = ObjetFenetre.creerInstance(ObjetFenetre, {
                pere: this,
                initialiser: function(aInstance) {
                    aInstance.setOptionsFenetre({
                        hauteurEcran_mobile: false,
                        listeBoutons: [GTraductions.getValeur('Fermer'), {
                            estValider: true,
                            libelle: GTraductions.getValeur('Valider')
                        }],
                        titre: this._options.titreCreation,
                        empilerFenetre: false,
                        surValiderAvantFermer: function(aParams) {
                            if (aParams.bouton && aParams.bouton.estValider) {
                                lSurValidation = true;
                            }
                        }.bind(this)
                    });
                }
            });
            this.IdCellule = this.Nom + '_saisieFenetre_mobile';
            lFenetre.controleur.getNodeCreation = function() {
                $(this.node).on('keyup', function(aEvent) {
                    if (_ObjetListe.protected._isToucheRetourChariot(aEvent)) {
                        lSurValidation = true;
                        lFenetre.Fermer();
                    }
                });
            };
            lFenetre.Afficher('<div id="' + this.IdCellule + '" ie-node="getNodeCreation"></div>').then(function() {
                if (lSurValidation) {
                    if (this._cache.finEditionCreation) {
                        this._cache.finEditionCreation();
                    }
                } else {
                    _ObjetListe.protected._annulerCreation.call(this);
                }
            }.bind(this));
            _ObjetListe.protected._SurCreationDeb.call(this, false, {
                idCellule: this.IdCellule,
                ignorerEventsNode: true
            });
        }

        function _construireTitre() {
            var H = [];
            if (!this.ListeTitres) {
                return '';
            }
            this.ListeTitres.forEach(function(aTitre) {
                H.push('<tr class="collection-header">');
                aTitre.forEach(function(aLigne, aIndice) {
                    var lDescripteurTitre = aLigne;
                    H.push('<td>', lDescripteurTitre.libelleHtml ? lDescripteurTitre.libelleHtml : lDescripteurTitre.estCoche ? '<div style="position:relative; left: 1px; width:16px; overflow:hidden;">' + '<div ie-event="click->liste.surClickCocheTitre(' + aIndice + ')" id="' + (this.ids.cocheTitre + aIndice) + '" class="Image_CochePourTitre" ie-style="liste.getStyleCocheTitre(' + aIndice + ')"></div></div>' : lDescripteurTitre.libelle || '', '</td>');
                }.bind(this));
                H.push('</tr>');
            }.bind(this));
            return H.join('');
        }

        function _getClassCouleurCellule(aParamsCellule) {
            var lClassAction = this._options.avecCelluleEditableTriangle && this.Donnees.avecBordureDroite(aParamsCellule) ? 'with-action' : 'with-action-simple';
            var lClass = '';
            if (!_ObjetListe.protected._getNonEditable.call(this) && (this.Donnees.AvecEdition(aParamsCellule.colonne, aParamsCellule.article, aParamsCellule) || this.Donnees.AvecEvenement_Edition(aParamsCellule.colonne, aParamsCellule.article, aParamsCellule))) {
                lClass = lClassAction;
            }
            var LCouleurCellule = this.Donnees.GetCouleurCellule(aParamsCellule, aParamsCellule.colonne, aParamsCellule.article);
            if ((LCouleurCellule !== null && LCouleurCellule !== undefined)) {
                switch (LCouleurCellule) {
                    case ObjetDonneesListe.ECouleurCellule.Blanc:
                        return lClassAction;
                    case ObjetDonneesListe.ECouleurCellule.Gris:
                        return '';
                    default:
                        return lClass;
                }
            } else {
                return lClass;
            }
        }

        function _composeCoche(aParams) {
            var lValeur = this.Donnees._GetValeur(aParams);
            if (this._options.avecCocheCheckBox) {
                return ['<div class="liste_cellule_cb">', '<ie-checkbox', GHtml.composeAttr('ie-model', 'liste.celluleCoche', [aParams.ligne, aParams.colonne, lValeur]), '></ie-checkbox>', '</div>'].join('');
            }
            if (lValeur === true || lValeur === ObjetDonneesListe.EGenreCoche.Verte) {
                return '<div class="Image_CocheVerte" style="width:18px; margin:0 auto;">&nbsp;</div>';
            }
            if (lValeur === ObjetDonneesListe.EGenreCoche.Grise) {
                return '<div class="Image_CocheGrise" style="width:18px; margin:0 auto;">&nbsp;</div>';
            }
            return '';
        }

        function _composeDeploiement(aParamsCellule) {
            return ['<i class="', (this.Donnees._estDeploye(aParamsCellule.ligne) ? 'icon_fleche_num_bas' : 'icon_fleche_num'), '"></i>'].join('');
        }

        function _construireContenu() {
            var H = [];
            this._cache.positionsCelluleCadreSelection = {};
            this._cache.lignesVisibles.forEach(function(aNumeroLigne) {
                H.push('<tr class="collection-item">');
                this._cache.infosZonesColonnes[0].colonnesVisibles.forEach(function(aNumeroColonne) {
                    var lParamsCellule = _ObjetListe.protected._getParamsCellule.call(this, aNumeroColonne, aNumeroLigne);
                    var lTypeValeur = this.Donnees.GetTypeValeur(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article);
                    var lTaille = this._cache.taillesColonne[aNumeroColonne];
                    Object.assign(lParamsCellule, {
                        k: 0,
                        surEdition: false,
                        typeValeur: lTypeValeur,
                        taille: lTaille.px
                    });
                    var lContenuAffichage = {
                        valeur: ''
                    };
                    var lAvecDeploiementCellule = false;
                    switch (lTypeValeur) {
                        case ObjetDonneesListe.ETypeCellule.Coche:
                            lContenuAffichage = {
                                valeur: _composeCoche.call(this, lParamsCellule)
                            };
                            break;
                        case ObjetDonneesListe.ETypeCellule.CocheDeploiement:
                            if (this.Donnees.estUnDeploiement(lParamsCellule)) {
                                lContenuAffichage.valeur = _composeDeploiement.call(this, lParamsCellule);
                            }
                            break;
                        case ObjetDonneesListe.ETypeCellule.Image:
                            ;
                            break;
                        default:
                            lContenuAffichage = this.Donnees._GetContenuAffichage(lParamsCellule);
                            if (_ObjetListe.protected._deploiementSurCellule.call(this, lParamsCellule) && this.Donnees.avecImageSurColonneDeploiement(lParamsCellule)) {
                                lAvecDeploiementCellule = true;
                                var lAvecEvent = !this.Donnees.avecEventDeploiementSurCellule(lParamsCellule);
                                lContenuAffichage.valeur = ['<div', (lAvecEvent ? GHtml.composeAttr('ie-node', 'liste.nodeDeploiementLigne', [lParamsCellule.ligne, lParamsCellule.colonne]) : ''), '>', _composeDeploiement.call(this, lParamsCellule), '</div>', lContenuAffichage.valeur].join('');
                            }
                    }
                    var lClasses = [
                        _getClassCouleurCellule.call(this, lParamsCellule) || '', this.Donnees.getClassCelluleConteneur(lParamsCellule) || ''
                    ];
                    if (!this.Donnees.avecBordureDroite(lParamsCellule)) {
                        lClasses.push('liste_sansBordureD');
                    }
                    var lClass = lClasses.join(' ').trim();
                    var lId = this.getIdCellule(aNumeroColonne, aNumeroLigne);
                    var lStyleDIV = '';
                    if (!lTaille.estPourcent && !lTaille.valeurRem) {
                        lStyleDIV = 'width:' + lTaille.px + 'px;';
                    }
                    var lIndentation = this.Donnees.getIndentationCellule(lParamsCellule) || 0;
                    if (lIndentation > 0) {
                        lStyleDIV += 'padding-left:' + lIndentation + 'px;';
                    }
                    lStyleDIV += this.Donnees.getStyle(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article) || '';
                    var lClassesDIV = ['liste_cellule_div', this.Donnees.getClass(lParamsCellule, lParamsCellule.colonne, lParamsCellule.article) || ''];
                    if (lAvecDeploiementCellule) {
                        lClassesDIV.push('liste_cellule_div_depl');
                    }
                    H.push('<td id="', lId, '"', GHtml.composeAttr('ie-node', 'liste.nodeTdCellule', [aNumeroLigne, aNumeroColonne]), (lClass ? 'class="' + lClass + '"' : ''), '>');
                    H.push('<div id="', lId + '_div', '" class="', lClassesDIV.join(' ').trim(), '"', (lStyleDIV ? ' style="' + lStyleDIV + '"' : ''), '>', lContenuAffichage.valeur, '</div>');
                    H.push('</td>');
                }.bind(this));
                H.push('</tr>');
            }.bind(this));
            return H.join('');
        }

        function _construireTotal() {
            var lListeTotal = this.Donnees ? this.Donnees.getListeLignesTotal() : null;
            if (!this._options.avecLigneTotal && (!lListeTotal || lListeTotal.GetNbrElements() === 0)) {
                return '';
            }
            var H = [];
            var lLignes = (this.Donnees ? this.Donnees.getListeLignesTotal() : null) || new ObjetListeElements().AddElement(null);
            var lInfosColonnes = this._cache.infosZonesColonnes[0];
            lLignes.parcourir(function(aArticle, aIndexLigne) {
                var lFusions = null;
                if (this.Donnees) {
                    lFusions = _ObjetListe.protected._getFusionColonnesCellule.call(this, {
                        total: true,
                        getParamsCellule: function(aNumeroColonne) {
                            return _ObjetListe.protected._getParamsCellule.call(this, aNumeroColonne, -1, {
                                surTotal: true,
                                ligne: aIndexLigne,
                                article: aArticle
                            });
                        }.bind(this),
                        colonnesVisibles: lInfosColonnes.colonnesVisibles,
                        indiceColonneDebut: lInfosColonnes.indiceColonneDebut,
                        indiceColonneFin: lInfosColonnes.indiceColonneFin,
                        dernierBloc: true
                    });
                }
                H.push('<tr class="collection-item liste_ligne_total">');
                lInfosColonnes.colonnesVisibles.forEach(function(aNumeroColonne) {
                    if (lFusions && (!lFusions[aNumeroColonne] || !lFusions[aNumeroColonne].nbCol)) {
                        return;
                    }
                    var lParams = _ObjetListe.protected._getParamsCellule.call(this, aNumeroColonne, -1, {
                        surTotal: true
                    });
                    if (aArticle) {
                        lParams.ligne = aIndexLigne;
                        lParams.article = aArticle;
                    }
                    var lContenu = '';
                    var lTabAttrTD = [];
                    var lClassTD = '';
                    if (this.Donnees) {
                        lParams.typeCellule = this.Donnees.getTypeCelluleTotal(lParams);
                        var lAvecBordureTotalVisible = this.Donnees.avecBordureTotalVisible(lParams);
                        if (lFusions[aNumeroColonne] && lFusions[aNumeroColonne].nbCol > 1) {
                            lTabAttrTD.push('colspan="' + lFusions[aNumeroColonne].nbCol + '"');
                        }
                        var lStyle = this.Donnees.getStyleTotal(lParams);
                        if (lStyle) {
                            lTabAttrTD.push('style="' + lStyle + '"');
                        }
                        lClassTD = this.Donnees.getClassTotal(lParams) || '';
                        if (!lAvecBordureTotalVisible) {
                            lClassTD += ' liste_sansBordureD';
                        }
                        lContenu = this.Donnees.getContenuTotal(lParams);
                    }
                    var lIdCellule = this.getIdCelluleTotal(lParams.colonne, lParams.ligne);
                    H.push('<td id="', lIdCellule, '" ie-node="liste.nodeCelluleTotal" class="liste_cellule_total' + (lClassTD ? ' ' + lClassTD : '') + '" ', lTabAttrTD.join(' ').trim(), '>', '<div class="liste_cellule_div">', lContenu, '</div>', '</td>');
                }.bind(this));
                H.push('</tr>');
            }.bind(this));
            return H.join('');
        }

        function _construireColonnes() {
            var H = [];
            H.push('<colgroup>');
            this._cache.infosZonesColonnes[0].colonnesVisibles.forEach(function(aNumeroColonne) {
                var lTaille = this._cache.taillesColonne[aNumeroColonne];
                var lStyle = '';
                if (lTaille.estPourcent) {
                    lStyle = 'width:' + lTaille.pourcent + '%;';
                } else if (lTaille.valeurRem) {
                    lStyle = 'width:' + lTaille.valeurRem + ';';
                } else {
                    lStyle = 'width:' + (lTaille.px + 8) + 'px;';
                }
                H.push('<col style="', lStyle, '">');
            }.bind(this));
            H.push('</colgroup>');
            return H.join('');
        }

        function _contruireBouton(aIcon, aLibelle, aAttrs) {
            return ['<button class="btn-flat"', aAttrs, '>', '<div>', '<div><i class="', aIcon, '"></i></div>', '<div>', aLibelle, '</div>', '</div>', '</button>'].join('');
        }

        function _construireBoutons() {
            var H = [];
            var lHtmlBoutons = [];
            var lAvecCreation = _ObjetListe.protected._avecLigneCreationTitre.call(this);
            if (lAvecCreation) {
                var lParams = _ObjetListe.protected._getParamsCellule.call(this, -1, -1, {
                    surCreation: true
                });
                var lAvecInputFile = this.Donnees.avecSelecFile(lParams);
                var lAttr = lAvecInputFile ? GHtml.composeAttr('ie-model', 'liste.modeleSelecFileCellule', [-1, -1, true]) + ' ie-selecfile ' : GHtml.composeAttr('ie-node', 'liste.nodeCreation');
                lHtmlBoutons.push(_contruireBouton.call(this, 'icon_plus', this._options.titreCreation, lAttr));
            }
            this._cache.boutons = [];
            if (this._options.boutons && this._options.boutons.forEach) {
                this._options.boutons.forEach(function(aBouton, aIndex) {
                    if (!aBouton) {
                        return;
                    }
                    var lBouton = {
                        event: null,
                        getDisabled: null,
                        getSelection: null,
                        class: ''
                    };
                    switch (aBouton.genre) {
                        case _ObjetListe.typeBouton.supprimer:
                            if (this._cache.lignesVisibles.length === 0) {
                                return;
                            }
                            lBouton.class = 'icon_trash';
                            lBouton.title = GTraductions.getValeur('liste.supprimer');
                            lBouton.getDisabled = function(aParam) {
                                return !_ObjetListe.protected._avecSuppressionSelectionCourante.call(aParam.liste, aParam.liste._cache.selectionCellule.ligne, aParam.liste._cache.selectionCellule.colonne);
                            };
                            lBouton.event = function(aParam) {
                                _ObjetListe.protected._surSuppression.call(aParam.liste);
                            };
                            break;
                        default:
                            GLog.addLog('ObjetListe_Mobile > _construireBoutons : genre bouton pas géré (dev en cours)');
                            return;
                    }
                    this._cache.boutons.push(lBouton);
                    lHtmlBoutons.push(_contruireBouton.call(this, lBouton.class, lBouton.title, GHtml.composeAttr('ie-attr', 'liste.boutonListe.attr', aIndex) + GHtml.composeAttr('ie-node', 'liste.boutonListe.node', aIndex)));
                }.bind(this));
            }
            if (lHtmlBoutons.length > 0) {
                H.push('<section class="liste_boutons">', lHtmlBoutons.join(''), '</section>');
            }
            return H.join('');
        }
        ObjetListe_Mobile.prototype._construireAffichage = function() {
            var H = [];
            H.push('<div class="ObjetListe" id="', this.idZone, '" tabindex="0">', '<div id="', this.ids.cadreSelection + '0', '" class="liste_conteneurCadreSelection"></div>', '<table class="collection with-header">', _construireColonnes.call(this), _construireTitre.call(this), _construireContenu.call(this), _construireTotal.call(this), '</table>', _construireBoutons.call(this), '</div>', '</div>');
            return H.join('');
        };
        ObjetListe_Mobile.prototype._getInfosZonesColonnes = function(aCache) {
            aCache.infosZonesColonnes = [];
            aCache.avecScrollHorizontal = false;
            aCache.avecScrollHMultiZonePrevu = false;
            if (!this.ListeTailles) {
                return;
            }
            var lInfos = {
                dernierBloc: true,
                indiceColonneDebut: 0,
                indiceColonneFin: this.ListeTailles.length - 1,
                indiceBloc: aCache.infosZonesColonnes.length,
                estBlocFixe: false,
                gabaritColonnesTitre: [],
                colonnesVisibles: [],
                largeurBloc: 0
            };
            for (var lColonne = lInfos.indiceColonneDebut; lColonne <= lInfos.indiceColonneFin; lColonne++) {
                if (!aCache.tableauColonnesCachees[lColonne]) {
                    lInfos.colonnesVisibles.push(lColonne);
                }
            }
            if (lInfos.colonnesVisibles.length > 0) {
                lInfos.indiceColonneDebut = lInfos.colonnesVisibles[0];
                lInfos.indiceColonneFin = lInfos.colonnesVisibles[lInfos.colonnesVisibles.length - 1];
                if (aCache.infosZonesColonnes.length > 0) {
                    aCache.infosZonesColonnes[aCache.infosZonesColonnes.length - 1].dernierBloc = false;
                }
                aCache.infosZonesColonnes.push(lInfos);
            }
        };
        ObjetListe_Mobile.prototype._rechercheTextesContenuListe = function() {
            var lCache = this._cache;
            var lJSelecLignes = $('#' + this.Nom.escapeJQ() + ' table.collection.with-header > tbody > tr.collection-item:not(.liste_ligne_total)');
            this._cache.lignesVisibles.forEach(function(aNumeroLigne) {
                var lInfos = {
                    ligne: lCache.lignesVisibles[aNumeroLigne],
                    texte: ''
                };
                lCache.rechercheTexte.textesParLigne.push(lInfos);
                lInfos.texte = GChaine.normalize(_ObjetListe.protected._rechercheTexte_getTexteLigne(lJSelecLignes.eq(aNumeroLigne)));
            }.bind(this));
        };
        ObjetListe_Mobile.prototype._backupScroll = function() {
            var lBackupScroll = null;
            var lElement = GHtml.getElement(this.Nom);
            while (lElement && !lBackupScroll && GHtml.estElement(lElement)) {
                if (lElement.scrollTop > 0) {
                    lBackupScroll = {
                        element: lElement,
                        scrollTop: lElement.scrollTop
                    };
                    break;
                }
                lElement = GHtml.getParent(lElement);
            }
            return lBackupScroll;
        };
        ObjetListe_Mobile.prototype._setScroll = function(aBackupScroll) {
            if (aBackupScroll && aBackupScroll.element) {
                aBackupScroll.element.scrollTop = aBackupScroll.scrollTop;
            }
        };
        module.exports = ObjetListe_Mobile;
    },
    fn: "objetliste_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        if (IE.estMobile) {
            module.exports = require('ObjetListe_Mobile.js');
        } else {
            module.exports = require('ObjetListe_Espace.js');
        }
    },
    fn: "objetliste.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('produit/css/InterfaceDestMessageInstantane.css');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetDonneesListe = require('ObjetDonneesListe.js');
        var ObjetInterface = require('ObjetInterface.js');
        var ObjetListe = require('ObjetListe.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');

        function InterfaceDestMessageInstantane() {
            this.inheritedCreate(arguments);
            this.GenreStructure = EStructureAffichage.Autre;
            this.params = {};
        }
        MethodesObjet.heritagePrototype(InterfaceDestMessageInstantane, ObjetInterface);
        InterfaceDestMessageInstantane.prototype.getControleur = function(aInstance) {
            return {
                btnContact: {
                    event: function() {
                        if (aInstance.params.fermer) {
                            aInstance.params.fermer();
                        }
                        aInstance.params.creerDiscussionContactVS();
                    }
                },
                rechercheTexte: {
                    getValue: function() {
                        var lListe = _getListe(aInstance);
                        return lListe ? lListe.getRechercheTexte() : '';
                    },
                    setValue: function(aValue) {
                        _getListe(aInstance).setRechercheTexte(aValue);
                    }
                },
                btnRechercheTexte: {
                    event: function() {
                        _getListe(aInstance).setRechercheTexte('');
                    },
                    avecBtn: function() {
                        return _getListe(aInstance).getRechercheTexte() !== '';
                    }
                }
            };
        };
        InterfaceDestMessageInstantane.prototype.ConstruireInstances = function() {
            this.identListe = this.Add(ObjetListe, null, function(aListe) {
                aListe.setOptionsListe({
                    colonnes: [{
                        id: DonneesListe_DestMessageInstantane.colonnes.coche,
                        taille: '1.8rem'
                    }, {
                        id: DonneesListe_DestMessageInstantane.colonnes.nom,
                        taille: '100%'
                    }],
                    hauteurAdapteContenu: true,
                    hauteurMaxAdapteContenu: 400,
                    nonEditable: false
                });
            });
        };
        InterfaceDestMessageInstantane.prototype.setDonnees = function(aParams) {
            this.params = Object.assign({
                fermer: null,
                creerDiscussionContactVS: null,
                creerMessageInstantane: null
            }, aParams);
            this.listeContacts = aParams.listeContacts;
            aParams.listeDestinataires.parcourir(function(aDest) {
                var lResult = this.listeContacts.GetElementParElement(aDest);
                lResult.estConnecte = true;
            }.bind(this));
            this.GetInstance(this.identListe).SetDonnees(new DonneesListe_DestMessageInstantane(this.listeContacts));
        };
        InterfaceDestMessageInstantane.prototype.ConstruireStructureAffichageAutre = function() {
            var T = [];
            T.push('<div class="InterfaceDestMessageInstantane">');
            if (GApplication.droits.get(TypeDroits.communication.avecContactVS)) {
                T.push('<ie-bouton ie-model="btnContact" class="dmi_btnContact">', '<i class="icon_contact_vs"></i>', GTraductions.getValeur('Messagerie.ContacterVS'), '</ie-bouton>');
            }
            T.push('<div class="dmi_zone_input">', '<div class="as-input dmi_recherche">', '<input type="text" ie-trim ie-textbrut ie-model="rechercheTexte" class="browser-default" placeholder="', GTraductions.getValeur('Messagerie.RechercherProfPerso'), '" />', '<ie-btnimage class="icon_remove btnImageIcon" ie-model="btnRechercheTexte" ie-if="avecBtn" title="', GTraductions.getValeur('liste.supprimer'), '"></ie-btnimage>', '</div>', '<i class="icon_search"></i>', '</div>');
            T.push('<div id="' + this.GetNomInstance(this.identListe) + '"></div>');
            T.push('</div>');
            return T.join('');
        };

        function _getListe(aInstance) {
            return aInstance.GetInstance(aInstance.identListe);
        }

        function _getListeSelections(aFenetre) {
            if (!aFenetre || !aFenetre.listeContacts) {
                return new ObjetListeElements();
            }
            return aFenetre.listeContacts.getListeElements(function(aElement) {
                return aElement.coche;
            });
        }
        InterfaceDestMessageInstantane.prototype.getListeSelectionsUtils = function() {
            return _getListeSelections(this);
        };
        InterfaceDestMessageInstantane.prototype.lancerConversation = function() {
            var lSelections = this.getListeSelectionsUtils();
            if (lSelections.GetNbrElements() > 0) {
                var lListeConnecte = lSelections.getListeElements(function(D) {
                    return D.estConnecte;
                });
                var lListeNonConnecte = lSelections.getListeElements(function(D) {
                    return !D.estConnecte;
                });
                this.params.creerMessageInstantane(lListeConnecte, lListeNonConnecte);
            }
        };

        function DonneesListe_DestMessageInstantane(aDonnees) {
            this.inheritedCreate(aDonnees);
            this.setOptions({
                avecSuppression: false,
                avecSelection: false,
                avecEtatSaisie: false
            });
        }
        MethodesObjet.heritagePrototype(DonneesListe_DestMessageInstantane, ObjetDonneesListe);
        DonneesListe_DestMessageInstantane.colonnes = {
            coche: 'coche',
            nom: 'nom'
        };
        DonneesListe_DestMessageInstantane.prototype.GetValeur = function(I, D, aParams) {
            switch (aParams.idColonne) {
                case DonneesListe_DestMessageInstantane.colonnes.coche:
                    return aParams.article.coche;
                case DonneesListe_DestMessageInstantane.colonnes.nom:
                    return TUtilitaireMessagerie.contruirePublicConnecte(aParams.article);
                default:
                    ;
            }
        };
        DonneesListe_DestMessageInstantane.prototype.GetTypeValeur = function(aParams) {
            switch (aParams.idColonne) {
                case DonneesListe_DestMessageInstantane.colonnes.coche:
                    return ObjetDonneesListe.ETypeCellule.Coche;
                default:
                    return ObjetDonneesListe.ETypeCellule.Html;
            }
        };
        DonneesListe_DestMessageInstantane.prototype.AvecEdition = function(I, D, aParams) {
            return aParams.idColonne === DonneesListe_DestMessageInstantane.colonnes.coche;
        };
        DonneesListe_DestMessageInstantane.prototype.SurEdition = function(aParams, I, D, V) {
            switch (aParams.idColonne) {
                case DonneesListe_DestMessageInstantane.colonnes.coche:
                    aParams.article.coche = V;
                    break;
                default:
                    ;
            }
        };
        DonneesListe_DestMessageInstantane.prototype.getColonneTransfertEdition = function() {
            return DonneesListe_DestMessageInstantane.colonnes.coche;
        };
        DonneesListe_DestMessageInstantane.prototype.getTri = function() {
            return [
                ObjetTri.init(function(D) {
                    return !D.estConnecte;
                }), ObjetTri.init(function(D) {
                    return !!(D.enCours && D.estConnecte);
                }), ObjetTri.init('Libelle')
            ];
        };
        DonneesListe_DestMessageInstantane.prototype.GetCouleurCellule = function() {
            return ObjetDonneesListe.ECouleurCellule.Blanc;
        };
        DonneesListe_DestMessageInstantane.prototype.avecBordureDroite = function(aParams) {
            if (IE.estMobile) {
                return aParams.idColonne !== DonneesListe_DestMessageInstantane.colonnes.coche;
            }
            return true;
        };
        module.exports = InterfaceDestMessageInstantane;
    },
    fn: "interfacedestmessageinstantane.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var EGenreAction = require('Enumere_Action.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetRequeteSaisieMessage = require('ObjetRequeteSaisieMessage.js');

        function TUtilitaireSaisieMessagerie() {}
        TUtilitaireSaisieMessagerie.controleNbDestinatairesResponEleve = function(aMessage) {
            return Promise.resolve().then(function() {
                if (aMessage.commande !== 'brouillon' &&
                    aMessage.listeDestinataires &&
                    aMessage.avecControleNbDest !== false) {
                    var lNbEleves = aMessage.listeDestinataires.getListeElements(function(D) {
                            return D.GetGenre() === EGenreRessource.Eleve;
                        }).GetNbrElements(),
                        lNbResponsables = aMessage.listeDestinataires.getListeElements(function(D) {
                            return D.GetGenre() === EGenreRessource.Responsable;
                        }).GetNbrElements();
                    if (lNbEleves + lNbResponsables > 100) {
                        return GApplication.getMessage().afficher({
                            type: EGenreBoiteMessage.Confirmation,
                            message: !aMessage.message && (!aMessage.messagePourReponse || !aMessage.messagePourReponse.existeNumero()) ? GTraductions.getValeur('Messagerie.ConfirmationDestinatairesParentsElevesNouvelle', [lNbEleves, lNbResponsables]) : GTraductions.getValeur('Messagerie.ConfirmationDestinatairesParentsElevesAjout', [lNbEleves, lNbResponsables])
                        }).then(function(aGenreAction) {
                            if (aGenreAction === EGenreAction.NePasValider) {
                                return Promise.reject('refus');
                            }
                        }.bind(this));
                    }
                }
            });
        };

        function _controleUtilisateurDansDestinataires(aMessage) {
            return Promise.resolve().then(function() {
                return TUtilitaireSaisieMessagerie.controleNbDestinatairesResponEleve(aMessage);
            }).then(function() {
                if (aMessage.commande !== 'brouillon' &&
                    aMessage.listeDestinataires &&
                    aMessage.listeDestinataires.GetNbrElements() >= 1 &&
                    aMessage.listeDestinataires.GetElementParElement(GEtatUtilisateur.getUtilisateur())) {
                    return GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Confirmation,
                        message: GTraductions.getValeur('Messagerie.ConfirmationAuteurDansDestinataires')
                    }).then(function(aGenreAction) {
                        if (aGenreAction === EGenreAction.NePasValider) {
                            aMessage.listeDestinataires.remove(aMessage.listeDestinataires.GetIndiceParElement(GEtatUtilisateur.getUtilisateur()));
                        }
                    }.bind(this));
                }
            });
        }
        TUtilitaireSaisieMessagerie.lancerRequeteMessage = function(aInstance, aMessage) {
            if (!aInstance) {
                return Promise.reject(true);
            }
            return _controleUtilisateurDansDestinataires(aMessage).then(function() {
                var lListeFichiers = aMessage.listeFichiers || new ObjetListeElements();
                if (!lListeFichiers && aMessage.brouillon && aMessage.brouillon.listeFichiers) {
                    lListeFichiers = aMessage.brouillon.listeFichiers;
                }
                aMessage.avecHtml = GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee);
                if (aMessage.avecHtml && aMessage.contenu && !aInstance.avecEditeurRiche) {
                    aMessage.contenu = GChaine.ToHTML(aMessage.contenu);
                }
                if (aInstance._initBrouillon) {
                    aInstance._initBrouillon();
                } else {
                    aInstance.brouillon = TUtilitaireSaisieMessagerie.getBrouillonDefaut();
                }
                return new ObjetRequeteSaisieMessage(aInstance).addUpload({
                    listeFichiers: lListeFichiers,
                    listeDJCloud: lListeFichiers
                }).lancerRequete(aMessage);
            }).catch(function(aErreur) {
                if (aErreur && aErreur === 'refus') {
                    return true;
                }
                return true;
            });
        };

        function _avecSauvegardeBrouillonAutorise() {
            return !GApplication.droits.get(TypeDroits.estEnConsultation) && GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee);
        }
        TUtilitaireSaisieMessagerie.saisieSortirConversation = function(aInstance, aMessage, aPossessionMessage) {
            var lPossessionMessage = aPossessionMessage;
            if (!lPossessionMessage && aMessage && aMessage.listePossessionsMessages) {
                lPossessionMessage = aMessage.listePossessionsMessages.GetElement(aMessage.listePossessionsMessages.GetNbrElements() - 1);
            };
            if (lPossessionMessage) {
                return new ObjetRequeteSaisieMessage(aInstance).lancerRequete({
                    commande: 'entrerSortirConversation',
                    entrer: false,
                    possessionMessage: lPossessionMessage
                });
            }
            return Promise.reject();
        };
        TUtilitaireSaisieMessagerie.sauvegarderCreationBrouillonParFenetre = function(aParamFenetre, aListeMessagesTransfert) {
            if (_avecSauvegardeBrouillonAutorise.call(this) && ((aParamFenetre.destinataires && aParamFenetre.destinataires.GetNbrElements() > 0) || aParamFenetre.contenu || (!aListeMessagesTransfert && aParamFenetre.objet) || (aParamFenetre.listeFichiers && aParamFenetre.listeFichiers.GetNbrElements() > 0))) {
                var lInstance = this;
                return GApplication.getMessage().afficher({
                    type: EGenreBoiteMessage.Confirmation,
                    message: GTraductions.getValeur('Messagerie.ConfirmationEnregistrerBrouillon')
                }).then(function(aAccepte) {
                    if (aAccepte === EGenreAction.Valider) {
                        return TUtilitaireSaisieMessagerie.lancerRequeteMessage(lInstance, {
                            commande: 'brouillon',
                            brouillon: null,
                            messagePourReponse: null,
                            objet: aParamFenetre.objet,
                            contenu: aParamFenetre.contenu,
                            listeDestinataires: aParamFenetre.destinataires,
                            listeMessagesTransfert: aListeMessagesTransfert,
                            PJ: aParamFenetre.PJ,
                            listeFichiers: aParamFenetre.listeFichiers
                        });
                    }
                });
            } else {
                return Promise.resolve();
            }
        };
        TUtilitaireSaisieMessagerie.creerFenetreDiscussion = function(aInstance, aDonnees, aClasseFenetreMessage, aOptions) {
            var lDonnees = Object.assign({
                genresRessources: [],
                message: {
                    objet: '',
                    contenu: '',
                    placeholder: ''
                },
                avecIndicationDiscussionInterdit: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.Etablissement, EGenreEspace.Administrateur, EGenreEspace.Accompagnant])
            }, aDonnees);
            var lOptions = Object.assign({
                avecSauvegardeBrouillon: true,
                avecChoixDestinataires: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.Etablissement, EGenreEspace.Administrateur, EGenreEspace.PrimProfesseur, EGenreEspace.Accompagnant, EGenreEspace.PrimAccompagnant]),
                listeEtiquettes: null,
                estCreationCarnetLiaison: false,
                eleveCarnetLiaison: null
            }, aOptions);
            var lFenetre = ObjetFenetre.creerInstance(aClasseFenetreMessage, {
                pere: aInstance,
                evenement: function(aNumeroBouton, aParam) {
                    Promise.resolve().then(function() {
                        if (aNumeroBouton === 1) {
                            var lParametres = {
                                objet: aParam.objet,
                                contenu: aParam.contenu,
                                listeDestinataires: aParam.destinataires,
                                PJ: aParam.PJ,
                                listeFichiers: aParam.listeFichiers,
                                avecControleNbDest: aParam.avecControleNbDest,
                                listeEtiquettes: lOptions.listeEtiquettes,
                                estCreationCarnetLiaison: lOptions.estCreationCarnetLiaison,
                                eleveCarnetLiaison: lOptions.eleveCarnetLiaison
                            };
                            return TUtilitaireSaisieMessagerie.lancerRequeteMessage(this, lParametres);
                        } else {
                            if (lOptions.avecSauvegardeBrouillon) {
                                return TUtilitaireSaisieMessagerie.sauvegarderCreationBrouillonParFenetre.call(this, aParam);
                            }
                        }
                    }.bind(this));
                }
            }, {
                avecChoixDestinataires: lOptions.avecChoixDestinataires
            });
            if (lOptions.titreFenetre) {
                lFenetre.setOptionsFenetre({
                    titre: lOptions.titreFenetre
                });
            }
            lFenetre.SetDonnees(lDonnees);
        };
        TUtilitaireSaisieMessagerie.getBrouillonDefaut = function() {
            var lBrouillon = new ObjetElement();
            lBrouillon.contenu = '';
            lBrouillon.objet = '';
            lBrouillon.listeFichiers = new ObjetListeElements();
            return lBrouillon;
        };
        module.exports = TUtilitaireSaisieMessagerie;
    },
    fn: "utilitairesaisiemessagerie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('Produit/Css/ObjetConversationEnCours.css');
        var MethodesObjet = require('MethodesObjet.js');
        var GTraductions = require('ObjetTraduction.js');
        var TUtilitaireSaisieMessagerie = require('UtilitaireSaisieMessagerie.js');
        var Identite = require('ObjetIdentite.js');
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');

        function ObjetConversationEnCours() {
            this.inheritedCreate(arguments);
            this.setOptions({
                message: null,
                surFermer: null,
                surMessage: null,
                surQuitter: null
            });
        }
        MethodesObjet.heritagePrototype(ObjetConversationEnCours, Identite);
        ObjetConversationEnCours.prototype.getControleur = function(aInstance) {
            return {
                btnFerme: {
                    event: function(aEvent) {
                        aEvent.stopPropagation();
                        aInstance.options.surFermer();
                    }
                },
                getNodeConteneur: function() {
                    $(this.node).eventValidation(function() {
                        if (aInstance.options.surMessage) {
                            aInstance.options.surMessage();
                        }
                    });
                },
                getNodeQuitter: function() {
                    $(this.node).eventValidation(function(aEvent) {
                        aEvent.stopPropagation();
                        TUtilitaireSaisieMessagerie.saisieSortirConversation(aInstance, aInstance.options.message);
                        if (aInstance.options.surQuitter) {
                            aInstance.options.surQuitter();
                        }
                    });
                }
            };
        };
        ObjetConversationEnCours.prototype.ConstruireAffichage = function() {
            var lMessage = this.options.message;
            if (!lMessage || $('#' + this.Nom.escapeJQ()).length === 0) {
                return '';
            }
            var H = [];
            $('#' + this.Nom.escapeJQ()).addClass('ObjetConversationEnCours');
            H.push('<ie-btnimage ie-model="btnFerme" class="btnImageIcon icon_remove"></ie-btnimage>');
            H.push('<div class="cec_conteneur" ie-node="getNodeConteneur">');
            H.push('<div class="cec_titre">', lMessage.libelleDate, '&nbsp;-&nbsp;', TUtilitaireMessagerie.getLibelleParticipants(lMessage, false), '</div>');
            if (lMessage.contenu) {
                H.push('<div>', lMessage.contenu, '</div>');
            }
            H.push('<div class="cec_lignefin">');
            if (lMessage.nbNonLus > 0) {
                H.push('<label>', lMessage.nbNonLus < 2 ? GTraductions.getValeur('Messagerie.UnNouveauMessage') : GTraductions.getValeur('Messagerie.NNouveauxMessages', [lMessage.nbNonLus]), '</label>');
            }
            H.push('<a ie-node="getNodeQuitter" class="AvecMain">', GTraductions.getValeur('Messagerie.QuitterModeInstantane'), '</a>');
            H.push('</div>');
            H.push('</div>');
            return H.join('');
        };
        module.exports = ObjetConversationEnCours;
    },
    fn: "objetconversationencours.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('mobile/css/InterfaceWrapperDestMessageInstantane_Mobile.css');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterface = require('ObjetInterface.js');
        var GTraductions = require('ObjetTraduction.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var InterfaceDestMessageInstantane = require('InterfaceDestMessageInstantane.js');
        var ObjetConversationEnCours = require('ObjetConversationEnCours.js');

        function InterfaceWrapperDestMessageInstantane_Mobile() {
            this.inheritedCreate(arguments);
            this.GenreStructure = EStructureAffichage.Autre;
        }
        MethodesObjet.heritagePrototype(InterfaceWrapperDestMessageInstantane_Mobile, ObjetInterface);
        InterfaceWrapperDestMessageInstantane_Mobile.prototype.getControleur = function(aInstance) {
            return {
                btnFermer: {
                    event: function() {
                        aInstance.options.closeSideNav();
                    }
                },
                compteur: {
                    afficher: function() {
                        return aInstance.options.getListeConversations().GetNbrElements() > 0;
                    },
                    texte: function() {
                        return aInstance.options.getListeConversations().GetNbrElements();
                    }
                },
                afficherAucuneConvers: function() {
                    return aInstance.options.getListeConversations().GetNbrElements() === 0;
                },
                btnConvers: {
                    getDisabled: function() {
                        return aInstance.GetInstance(aInstance.identAff).getListeSelectionsUtils().GetNbrElements() === 0;
                    },
                    event: function() {
                        aInstance.options.closeSideNav();
                        aInstance.GetInstance(aInstance.identAff).lancerConversation();
                    }
                },
                getRepeatMessages: function() {
                    return [].concat(aInstance.options.getListeConversations().GetListeElements());
                },
                identiteConvers: function(aRepeatMessage) {
                    var lMessage = aRepeatMessage.element;
                    return {
                        class: ObjetConversationEnCours,
                        pere: aInstance,
                        init: function(aInstanceConvers) {
                            aInstanceConvers.setOptions({
                                message: lMessage,
                                surFermer: function() {
                                    _suppressionMessage(aInstance, lMessage);
                                },
                                surMessage: function() {
                                    if (aInstance.options.surMessage) {
                                        aInstance.options.surMessage(lMessage);
                                    }
                                    _suppressionMessage(aInstance, lMessage);
                                    aInstance.options.closeSideNav();
                                },
                                surQuitter: function() {
                                    _suppressionMessage(aInstance, lMessage);
                                }
                            });
                        }
                    };
                }
            };
        };

        function _suppressionMessage(aInstance, aMessage) {
            aInstance.options.surSuppressionConversationEnCours(aMessage);
            aInstance.$refreshSelf();
        }
        InterfaceWrapperDestMessageInstantane_Mobile.prototype.ConstruireInstances = function() {
            this.identAff = this.Add(InterfaceDestMessageInstantane);
        };
        InterfaceWrapperDestMessageInstantane_Mobile.prototype.setDonnees = function(aParams) {
            this.GetInstance(this.identAff).setDonnees(Object.assign({
                fermer: function() {
                    this.options.closeSideNav();
                }.bind(this)
            }, aParams));
        };
        InterfaceWrapperDestMessageInstantane_Mobile.prototype.ConstruireStructureAffichageAutre = function() {
            var T = [];
            T.push('<div class="InterfaceWrapperDestMessageInstantane_Mobile">');
            T.push('<header class="header-titre">', '<ie-btnimage ie-model="btnFermer" class="icon_retour_mobile btnImageIcon"></ie-btnimage>', '<div>', GTraductions.getValeur('Messagerie.EnvoiMessageInstantane').toUpperCase(), '</div>', '</header>');
            T.push('<div class="wdmi_contenu">');
            T.push('<div class="wdmi_titre_conversations">', '<div>', GTraductions.getValeur('Messagerie.ConversationInstantaneesEnCours'), '</div>', '<div class="wdmi_compteur" ie-texte="compteur.texte" ie-if="compteur.afficher"></div>', '</div>');
            T.push('<label class="wdmi_titre_aucuneConvers" ie-if="afficherAucuneConvers">', GTraductions.getValeur('Messagerie.AucuneConversation'), '</label>');
            T.push('<ul class="wdmi_conversations">');
            T.push('<li ie-repeat="messageConvers in getRepeatMessages" ie-identite="identiteConvers(messageConvers)"></li>');
            T.push('</ul>');
            T.push('<div class="wdmi_liste">');
            T.push('<div id="' + this.GetNomInstance(this.identAff) + '"></div>');
            T.push('<div class="wdmi_cont_btnConvers">');
            T.push('<ie-bouton ie-model="btnConvers" class="themeBoutonPrimaire">', GTraductions.getValeur('Messagerie.LancerConversation'), '</ie-bouton>');
            T.push('</div>');
            T.push('</div>');
            T.push('</div>');
            T.push('</div>');
            return T.join('');
        };
        module.exports = InterfaceWrapperDestMessageInstantane_Mobile;
    },
    fn: "interfacewrapperdestmessageinstantane_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var Identite = require('ObjetIdentite.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var GHtml = require('GHtml.js');
        module.exports = {
            createComplet: function(aClassIdentite, aParametres) {
                var lParametres = Object.assign({
                    start: null,
                    onOpenEnd: null
                }, aParametres);
                var lInstance = Identite.creerInstance(aClassIdentite, lParametres);
                var lCloseSideNav = function() {
                    if (lInstance) {
                        M.Sidenav.getInstance($('#' + lInstance.GetNom().escapeJQ())).close();
                    }
                };
                lInstance.setOptions({
                    closeSideNav: lCloseSideNav
                });
                GHtml.addHtml(ZoneFenetre.getElementZoneFenetre(), '<div id="' + lInstance.GetNom() + '" class="sidenav side-panel-complet"></div>');
                var lJFenetre = $('#' + lInstance.GetNom().escapeJQ());
                lJFenetre.on('destroyed', function() {
                    if (lInstance) {
                        lInstance.free();
                    }
                    lInstance = null;
                });
                Invocateur.abonner(ObjetInvocateur.events.fermerFenetres, function() {
                    lCloseSideNav();
                }, lInstance);
                M.Sidenav.init(lJFenetre, {
                    edge: 'right',
                    draggable: false,
                    onOpenEnd: function() {
                        if (lParametres.onOpenEnd) {
                            lParametres.onOpenEnd(lInstance);
                        }
                    },
                    onCloseEnd: function() {
                        lJFenetre.remove();
                        if (lInstance) {
                            lInstance.free();
                        }
                        lInstance = null;
                    }.bind(this)
                });
                lInstance.Initialiser();
                if (lParametres.start) {
                    lParametres.start(lInstance);
                }
                M.Sidenav.getInstance($('#' + lInstance.GetNom().escapeJQ())).open();
                return {
                    getInstance: function() {
                        return lInstance;
                    },
                    fermer: lCloseSideNav
                };
            }
        };
    },
    fn: "utilitairesidenav.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var ObjetIdentite = require('ObjetIdentite.js');
        var UtilitaireContactVieScolaire = require('UtilitaireContactVieScolaire.js');
        var ObjetDiscussion_Mobile = require('ObjetDiscussion_Mobile.js');
        var ObjetRequeteListeMessages = require('ObjetRequeteListeMessages.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var Invocateur = require('Invocateur.js').Invocateur;
        var InterfaceWrapperDestMessageInstantane_Mobile = require('InterfaceWrapperDestMessageInstantane_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var TypeGenreMessage = require('TypeGenreMessage.js').TypeGenreMessage;
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');
        var UtilitaireSideNav = require('UtilitaireSideNav.js');

        function UtilitaireContactVieScolaire_Mobile() {
            this.inheritedCreate(arguments);
            this.listeConversationsEnCours = new ObjetListeElements();
        }
        MethodesObjet.heritagePrototype(UtilitaireContactVieScolaire_Mobile, UtilitaireContactVieScolaire);
        UtilitaireContactVieScolaire_Mobile.prototype.creerChat = function(aParams) {
            var lInstance = ObjetIdentite.creerInstance(ObjetDiscussion_Mobile, {
                pere: this
            });
            lInstance.setOptions({
                estSidePanel: true,
                estChat: true,
                genreDiscussion: aParams.genreDiscussion,
                callbackFermeture: function() {
                    lInstance.free();
                }
            }).setDonnees({
                titre: aParams.objet,
                creationDiscussion: true,
                alertePPMS: aParams.alerte,
                destinataires: {
                    listeDestinataires: aParams.listeDestinataires
                },
                listeContacts: aParams.listeContacts
            });
        };
        UtilitaireContactVieScolaire_Mobile.prototype.creerNouvelleDiscussion = function(aParams) {
            var lInstance = ObjetIdentite.creerInstance(ObjetDiscussion_Mobile, {
                pere: this
            });
            lInstance.setOptions({
                estSidePanel: true,
                genreDiscussion: aParams.genreDiscussion,
                genresDestinatairesAutorises: [EGenreRessource.Personnel, EGenreRessource.Enseignant],
                avecDestinatairesListeDiffusion: false,
                callbackEnvoyer: function() {
                    lInstance.masquer();
                    Invocateur.evenement('actualiserListeDiscussion_mobile');
                }.bind(this),
                callbackFermeture: function() {
                    lInstance.free();
                }
            }).setDonnees({
                titre: aParams.objet,
                creationDiscussion: true,
                destinataires: {
                    listeDestinataires: aParams.listeDestinataires
                },
                listeContacts: aParams.listeContacts
            });
        };

        function _creerFenetreChatMultiple(aIndiceCourant, aListe, aInstance) {
            var lMessage = aListe.GetElement(aIndiceCourant);
            new ObjetRequeteListeMessages(this).lancerRequete({
                message: lMessage,
                marquerCommeLu: true
            }).then(function(aParam) {
                if (lMessage.estAlerte) {
                    this.compteurFenetreAlertePPMS += 1;
                }
                var lInfosMessage = this._getInfosChatMessage(lMessage);
                var lNbMessages = aListe.GetNbrElements();
                var lTitre = lNbMessages < 2 ? lInfosMessage.titre : GChaine.Format('(%s/%s) %s', [aIndiceCourant + 1, lNbMessages, lInfosMessage.titre]);
                aInstance.setOptions({
                    estSidePanel: true,
                    estChat: true,
                    callbackNavigation: lNbMessages > 1 ? function(aPrec) {
                        aIndiceCourant += aPrec ? -1 : 1;
                        if (aIndiceCourant < 0) {
                            aIndiceCourant = lNbMessages - 1;
                        } else if (aIndiceCourant >= lNbMessages) {
                            aIndiceCourant = 0;
                        }
                        if (lMessage.estAlerte) {
                            this.compteurFenetreAlertePPMS = Math.max(0, this.compteurFenetreAlertePPMS - 1);
                        }
                        _creerFenetreChatMultiple.call(this, aIndiceCourant, aListe, aInstance);
                    }.bind(this) : null,
                    callbackFermeture: function() {
                        if (lMessage.estAlerte) {
                            this.compteurFenetreAlertePPMS = Math.max(0, this.compteurFenetreAlertePPMS - 1);
                        }
                        aInstance.free();
                    }.bind(this)
                }).setDonnees(Object.assign({
                    titre: lTitre,
                    message: lMessage,
                    contenuInitial: lInfosMessage.contenuInitial
                }, aParam));
            }.bind(this));
        }
        UtilitaireContactVieScolaire_Mobile.prototype.creerChatDeListe = function(aListe) {
            if (!aListe || aListe.GetNbrElements() === 0) {
                return;
            }
            var lListeChats = new ObjetListeElements();
            var lNbConversations = this.listeConversationsEnCours.GetNbrElements();
            aListe.parcourir(function(aMessage) {
                if (aMessage.GetGenre() === TypeGenreMessage.GM_Conversation) {
                    var lTrouve = false;
                    this.listeConversationsEnCours.parcourir(function(aMessageEnCours, aIndex) {
                        if (TUtilitaireMessagerie.avecPossessionPartageeEntreMessages(aMessageEnCours, aMessage)) {
                            lTrouve = true;
                            this.listeConversationsEnCours.AddElement(aMessage, aIndex);
                            return false;
                        }
                    }.bind(this));
                    if (!lTrouve) {
                        this.listeConversationsEnCours.add(aMessage);
                    }
                } else {
                    lListeChats.add(aMessage);
                }
            }.bind(this));
            if (lNbConversations !== this.listeConversationsEnCours.GetNbrElements()) {
                Invocateur.evenement('modifier_nb_conversationEnCours', this.listeConversationsEnCours.GetNbrElements());
            }
            if (lListeChats.GetNbrElements() > 0) {
                _initFenetreChatMultiple.call(this, lListeChats);
            }
        };

        function _initFenetreChatMultiple(aListe) {
            var lIndiceChatCourant = 0;
            var lInstance = ObjetIdentite.creerInstance(ObjetDiscussion_Mobile, {
                pere: this
            });
            _creerFenetreChatMultiple.call(this, lIndiceChatCourant, aListe, lInstance);
        }
        UtilitaireContactVieScolaire_Mobile.prototype.afficher_destMessageInstantane = function(aParams) {
            if (this.sideNavConversation) {
                this.sideNavConversation.fermer();
                delete this.sideNavConversation;
            }
            this.sideNavConversation = UtilitaireSideNav.createComplet(InterfaceWrapperDestMessageInstantane_Mobile, {
                pere: this,
                options: {
                    getListeConversations: function() {
                        return this.listeConversationsEnCours;
                    }.bind(this),
                    surMessage: function(aMessage) {
                        _initFenetreChatMultiple.call(this, new ObjetListeElements().add(aMessage));
                    }.bind(this),
                    surSuppressionConversationEnCours: function(aMessageCherche) {
                        var lTrouve = false;
                        this.listeConversationsEnCours.parcourir(function(aMessage, aIndice) {
                            if (TUtilitaireMessagerie.avecPossessionPartageeEntreMessages(aMessageCherche, aMessage)) {
                                this.listeConversationsEnCours.remove(aIndice);
                                lTrouve = true;
                                return false;
                            }
                        }.bind(this));
                        if (lTrouve) {
                            Invocateur.evenement('modifier_nb_conversationEnCours', this.listeConversationsEnCours.GetNbrElements());
                        }
                    }.bind(this)
                },
                start: function(aInstance) {
                    aInstance.setDonnees(aParams);
                }
            });
        };
        module.exports = new UtilitaireContactVieScolaire_Mobile();
    },
    fn: "utilitairecontactviescolaire_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeNotification = {
            nOrpheline: 0,
            nUnique: 1,
            nCompteur: 2,
            nRouleau: 3
        };
        module.exports.TypeNotification = TypeNotification;
        var TypeActionBoutonNotif = {
            abnLu: 0,
            abnFermer: 1,
            abnLien: 2,
            abnNoAction: 3
        };
        module.exports.TypeActionBoutonNotif = TypeActionBoutonNotif;
        var TypeModaliteAffichage = {
            affZone: 0,
            affHistorique: 1,
            affModale: 2,
            affPopup: 3
        };
        module.exports.TypeModaliteAffichage = TypeModaliteAffichage;
    },
    fn: "typecentralenotifications.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('script/css/ObjetCentraleNotifications.css');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var Invocateur = require('Invocateur.js').Invocateur;
        var ToucheClavier = require('ToucheClavier.js');
        var GTraductions = require('ObjetTraduction.js');
        var GHtml = require('GHtml.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var TypeCentraleNotifications = require('TypeCentraleNotifications.js');
        var TypeNotification = TypeCentraleNotifications.TypeNotification;
        var TypeActionBoutonNotif = TypeCentraleNotifications.TypeActionBoutonNotif;
        var TypeModaliteAffichage = TypeCentraleNotifications.TypeModaliteAffichage;
        var EEvent = require('Enumere_Event.js');
        var ObjetDonneesCentraleNotifications = require('ObjetDonneesCentraleNotifications.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreTriElement = require('Enumere_TriElement.js');
        Requetes.inscrire('CentraleNotifications', ObjetRequeteConsultation);

        function ObjetCentraleNotifications() {
            this.inheritedCreate(arguments);
            this.idContenu = this.Nom + '_contenu';
            this.ajouterEvenementGlobal(EEvent.SurPostResize, function() {
                if (this.apiScroll) {
                    this.apiScroll.surResize();
                }
            });
            Invocateur.abonner(ObjetDonneesCentraleNotifications.typeNotif.surModification, function(aParams) {
                if (!aParams.masquerNbNotifs) {
                    _requete(this);
                }
            }, this);
            this.donneesCentraleNotifications = GApplication.donneesCentraleNotifications;
            this.setOptions({
                actionneur: null,
                estMobile: false,
                timerOuverture: null
            });
        }
        MethodesObjet.heritagePrototype(ObjetCentraleNotifications, Identite);
        ObjetCentraleNotifications.prototype.free = function() {
            this.inherited('free');
            $('#' + this.Nom.escapeJQ()).remove();
        };
        ObjetCentraleNotifications.prototype.RecupererDonnees = function() {
            _requete(this, true);
        };
        ObjetCentraleNotifications.prototype.getControleur = function(aInstance) {
            return {
                getNodeRacine: function() {
                    $(this.node).on({
                        'keyup': function(aEvent) {
                            if (aEvent.which === ToucheClavier.Echap) {
                                aInstance.fermer();
                            }
                        }
                    });
                },
                btnFermer: {
                    event: function() {
                        aInstance.fermer();
                    }
                },
                avecCompteurGeneral: function() {
                    return aInstance.donneesCentraleNotifications.nbNotifs > 0;
                },
                getHtmlNbNotifs: function() {
                    return aInstance.donneesCentraleNotifications.nbNotifs > 99 ? '99+' : aInstance.donneesCentraleNotifications.nbNotifs;
                },
                getScroll: function(aApi) {
                    aInstance.apiScroll = aApi;
                    aInstance.apiScroll.reserverPlaceScrollVisible = true;
                },
                btnSectionLu: {
                    event: function(aIndexSection) {
                        var lSection = aInstance.donnees.liste.GetElement(aIndexSection);
                        if (lSection) {
                            _afficherSectionLue(aInstance, lSection, aIndexSection);
                        }
                    }
                },
                getNodeNotif: function(aIndexSection, aIndexNotif) {
                    var lNotif = _getNotifDIndexs(aInstance, aIndexSection, aIndexNotif);
                    if (lNotif) {
                        $(this.node).eventValidation(function() {
                            _navigation(aInstance, lNotif);
                        });
                    }
                },
                btnNotifLu: {
                    event: function(aIndexSection, aIndexNotif) {
                        var lNotif = _getNotifDIndexs(aInstance, aIndexSection, aIndexNotif);
                        if (lNotif && lNotif.onBtnClick) {
                            _notificationMarquerLu(aInstance, lNotif);
                        }
                    }
                },
                afficherAucuneNotif: function() {
                    return aInstance.donneesCentraleNotifications.nbNotifs === 0;
                },
                afficherPapillion: function() {
                    return aInstance.donneesCentraleNotifications.nbNotifs > 0;
                }
            };
        };

        function _navigation(aInstance, aNotification) {
            Promise.resolve().then(function() {
                if (aNotification.onNotifClick) {
                    return _notificationSaisieClick(aInstance, aNotification);
                }
            }).then(function() {
                aInstance.options.actionneur.actionNotification(aNotification);
                if (aNotification.action === TypeActionBoutonNotif.abnLien) {
                    aInstance.fermer();
                } else if (aNotification.onNotifClick) {
                    _actualiser(aInstance);
                }
            });
        }

        function _notificationMarquerLu(aInstance, aNotification) {
            return _notificationSaisie(aInstance, aNotification, {
                onBtnClick: true
            }).then(function() {
                _actualiser(aInstance);
            });
        }

        function _notificationSaisieClick(aInstance, aNotification) {
            return _notificationSaisie(aInstance, aNotification, {
                onNotifClick: true
            });
        }

        function _notificationSaisie(aInstance, aNotification, aParams) {
            var lParams = Object.assign(aParams, {
                estSaisie: true,
                idNotif: aNotification.id
            });
            return Requetes('CentraleNotifications', aInstance).lancerRequete(lParams).then(function(aDonnees) {
                if (aDonnees.ok) {
                    if (lParams.onBtnClick && aNotification.action === TypeActionBoutonNotif.abnLu) {
                        aNotification.modalites.add(TypeModaliteAffichage.affHistorique);
                    }
                    Invocateur.evenement(ObjetDonneesCentraleNotifications.typeNotif.masquerNbNotifs, 1);
                }
            });
        }

        function _getNotifDIndexs(aInstance, aIndexSection, aIndexNotif) {
            var lSection = aInstance.donnees.liste.GetElement(aIndexSection);
            if (lSection) {
                return lSection.liste.GetElement(aIndexNotif);
            }
        }
        ObjetCentraleNotifications.prototype.fermer = function() {
            $('#' + this.Nom.escapeJQ() + ' .cn_scroll').addClass('cn_scroll_inactif');
            this.callback.appel();
        };

        function _requete(aInstance, aSurDemarrage) {
            if (aInstance._requeteEnCours) {
                return;
            }
            aInstance._requeteEnCours = true;
            var lDemarrageAnimation = aSurDemarrage && aInstance.options.timerOuverture > 0;
            var lPromises = [
                Requetes('CentraleNotifications', aInstance).lancerRequete().then(function(aDonnees) {
                    aInstance.donnees = aDonnees;
                    if (aInstance.donnees && aInstance.donnees.liste) {
                        aInstance.donnees.liste.parcourir(function(aSection) {
                            if (aSection.avecTri && aSection.liste) {
                                aSection.liste.setTri([
                                    ObjetTri.init('type'), ObjetTri.init('date', EGenreTriElement.Decroissant), ObjetTri.init('id')
                                ]).trier();
                            }
                        });
                    }
                    if (!aInstance._estDetruite) {
                        _actualiser(aInstance, aSurDemarrage);
                        $('#' + aInstance.Nom.escapeJQ() + ' .ObjetCentraleNotifications>header').focus();
                    }
                })
            ];
            if (lDemarrageAnimation) {
                lPromises.push(new Promise(function(aResolve) {
                    setTimeout(function() {
                        aResolve();
                    }, aInstance.options.timerOuverture);
                }));
            }
            Promise.all(lPromises).then(function() {
                $('#' + aInstance.Nom.escapeJQ() + ' .cn_scroll').removeClass('cn_scroll_inactif');
            }).finally(function() {
                aInstance._requeteEnCours = false;
            });
        }

        function _contruireEtiquetteArticle(aNotification) {
            var H = [];
            switch (aNotification.type) {
                case TypeNotification.nCompteur:
                    H.push('<div>' + aNotification.compteur + '</div>');
                    break;
                default:
                    var lJour = '';
                    var lEllipsis = false;
                    var lDateCourante = new Date();
                    if (GDate.estJourEgal(lDateCourante, aNotification.date)) {
                        lJour = '<i class="icon_calendrier_aujourdhui"></i>';
                    } else if (GDate.estJourEgal(GDate.GetJourSuivant(lDateCourante, -1), aNotification.date)) {
                        lJour = GTraductions.getValeur('Hier');
                        lEllipsis = true;
                    } else {
                        lJour = GDate.FormatDate(aNotification.date, '%JJ/%MM');
                    }
                    H.push('<div class="cn_etiquette_jour"', (lEllipsis ? ' ie-ellipsis' : ''), '>', lJour, '</div>', '<div class="cn_etiquette_sep"></div>', '<div>', GDate.FormatDate(aNotification.date, '%hh%sh%mm'), '</div>');
            }
            return H.join('');
        }

        function _afficherSectionLue(aInstance, aSection) {
            aSection._afficherhistorique = !aSection._afficherhistorique;
            _actualiser(aInstance);
        }

        function _contruireDateLue(aNotification) {
            return ['<div class="sc_datePied">', '<i class="icon_eye_open,"></i>', GTraductions.getValeur('CentraleNotifications.HistoNotifLueLe', [GDate.FormatDate(aNotification.dateLue, '%JJ/%MM/%AAAA')]), '</div>'].join('');
        }

        function _contruireDateExpiration(aNotification) {
            return ['<div class="sc_datePied">', '<i class="icon_time"></i>', GTraductions.getValeur('CentraleNotifications.HistoNotifSuppr', [GDate.FormatDate(aNotification.dateExpiration, '%JJ/%MM/%AAAA')]), '</div>'].join('');
        }

        function _construireListeNotifications(aInstance, aSection, aIndexSection, aAfficherHistorique) {
            var H = [];
            aSection.liste.parcourir(function(aNotification, aIndexNotif) {
                var lEstHistorique = aNotification.modalites.contains(TypeModaliteAffichage.affHistorique);
                if ((aAfficherHistorique && !lEstHistorique) || (!aAfficherHistorique && lEstHistorique)) {
                    return;
                }
                var lBoutonCoin = '';
                var lAvecActionArticle = false;
                switch (aNotification.action) {
                    case TypeActionBoutonNotif.abnLien:
                        lBoutonCoin = '<i class="sc_btnCoin icon_affichage_widget"></i>';
                        lAvecActionArticle = true;
                        break;
                    case TypeActionBoutonNotif.abnLu:
                        if (!aAfficherHistorique) {
                            lBoutonCoin = ['<ie-btnimage class="sc_btnCoin btnImageIcon icon_eye_close"', ' title="', GTraductions.getValeur('CentraleNotifications.MarquerLu'), '"', GHtml.composeAttr('ie-model', 'btnNotifLu', [aIndexSection, aIndexNotif]), '></ie-btnimage>'].join('');
                        }
                        break;
                }
                var lClasses = [];
                if (lAvecActionArticle) {
                    lClasses.push('sc_article_action', 'waves-effect');
                }
                if (aAfficherHistorique) {
                    lClasses.push('sc_article_histo');
                }
                H.push('<article tabindex="0"', (lClasses.length > 0 ? ' class="' + lClasses.join(' ') + '"' : ''), (lAvecActionArticle ? GHtml.composeAttr('ie-node', 'getNodeNotif', [aIndexSection, aIndexNotif, aNotification.id]) : ''), '>', lBoutonCoin, '<div class="sc_article_gauche">', _contruireEtiquetteArticle(aNotification), '</div>', '<div class="sc_article_contenu">', aNotification.titre ? '<div class="sc_article_contenu_titre' + (lBoutonCoin ? ' sc_article_contenu_titre_avecBtn' : '') + '">' + GChaine.ToHTML(aNotification.titre) + '</div>' : '', '<div>', GChaine.ToHTML(aNotification.message), '</div>', aNotification.dateLue ? _contruireDateLue(aNotification) : '', aNotification.dateExpiration && lEstHistorique ? _contruireDateExpiration(aNotification) : '', '</div>', '</article>');
            });
            return H.join('');
        }

        function _actualiser(aInstance, aSurDemarrage) {
            var H = [];
            var lScrollTop = 0;
            if (!aSurDemarrage) {
                var lElement = $('#' + aInstance.idContenu.escapeJQ() + ' .cn_scroll').get(0);
                if (lElement && lElement.scrollTop > 0) {
                    lScrollTop = lElement.scrollTop;
                }
            }
            H.push('<div class="cn_scroll', aSurDemarrage ? ' cn_scroll_inactif' : '', '">');
            H.push('<div class="cb_contenu_scroll">');
            aInstance.donnees.liste.parcourir(function(aSection, aIndexSection) {
                var lNbLus = 0;
                var lNbNonLus = 0;
                aSection.liste.parcourir(function(aNotification) {
                    if (aNotification.modalites.contains(TypeModaliteAffichage.affHistorique)) {
                        lNbLus += aNotification.compteur;
                    } else if (aNotification.modalites.contains(TypeModaliteAffichage.affZone)) {
                        lNbNonLus += aNotification.compteur;
                    }
                });
                if (lNbLus + lNbNonLus === 0) {
                    return;
                }
                H.push('<section class="cn_section cn_section_', aSection.ident, '">', '<header>', '<div class="cn_section_titre">', '<i></i>', '<label>', aSection.GetLibelle(), '</label>', lNbNonLus > 0 ? '<div class="cn_section_lu">' + lNbNonLus + '</div>' : '', '</div>', lNbLus > 0 ? ['<div class="cn_section_btnLu">', '<ie-btnimage class="icon_eye_open btnImageIcon"', GHtml.composeAttr('title', GTraductions.getValeur('CentraleNotifications.HistoSectionTitre', [aSection.GetLibelle()])), GHtml.composeAttr('ie-model', 'btnSectionLu', aIndexSection), '></ie-btnimage>', '<label>' + lNbLus + '</label>', '</div>'].join('') : '', '</header>');
                H.push(_construireListeNotifications(aInstance, aSection, aIndexSection));
                if (aSection._afficherhistorique) {
                    H.push(_construireListeNotifications(aInstance, aSection, aIndexSection, true));
                }
                H.push('</section>');
            });
            H.push('</div>');
            H.push('</div>');
            GHtml.setHtml(aInstance.idContenu, H.join(''), {
                instance: aInstance
            });
            if (lScrollTop > 0) {
                lElement = $('#' + aInstance.idContenu.escapeJQ() + ' .cn_scroll').get(0);
                if (lElement) {
                    lElement.scrollTop = lScrollTop;
                }
            }
        }
        ObjetCentraleNotifications.prototype.ConstruireAffichage = function() {
            var H = [];
            H.push('<div ie-node="getNodeRacine" class="ObjetCentraleNotifications">', '<header tabindex="0">');
            if (this.options.estMobile) {
                H.push('<div class="cn_flechegauche">', '<ie-btnimage ie-model="btnFermer" class="icon_retour_mobile btnImageIcon"></ie-btnimage>', '</div>');
            }
            H.push('<div class="cn_titre_notif">', GTraductions.getValeur('CentraleNotifications.TitreNotifications'), '</div>', '<div class="cn_compteurTotal" ie-if="avecCompteurGeneral"><div><label ie-html="getHtmlNbNotifs"></label></div></div>');
            if (!this.options.estMobile) {
                H.push('<div class="cn_fermeture">', '<ie-btnimage ie-model="btnFermer" class="icon_fermeture_widget btnImageIcon" title="', GTraductions.getValeur('Fermer'), '"></ie-btnimage>', '</div>');
            }
            H.push('</header>', '<i ie-if="afficherPapillion" class="icon_papillon_notif"></i>', '<div ie-if="afficherAucuneNotif" class="cn_imgAucuneNouvelleNotif">', '<div></div>', GTraductions.getValeur('CentraleNotifications.AucuneNotification'), '</div>', '<div class="cn_liste_notifs" id="', this.idContenu, '">', '</div>', '</div>');
            return H.join('');
        };
        module.exports = ObjetCentraleNotifications;
    },
    fn: "objetcentralenotifications.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetCentraleNotifications = require('ObjetCentraleNotifications.js');
        var UtilitaireSideNav = require('UtilitaireSideNav.js');

        function ObjetWrapperCentraleNotifications_Mobile(aDonnees) {
            this.donnees = aDonnees;
            this.options = {
                actionneur: null
            };
        }
        ObjetWrapperCentraleNotifications_Mobile.prototype.ouvrir = function() {
            if (!this.instanceNotif) {
                this.instanceNotif = UtilitaireSideNav.createComplet(ObjetCentraleNotifications, {
                    pere: this,
                    evenement: function() {
                        this.instanceNotif.fermer();
                        this.instanceNotif = null;
                    },
                    options: {
                        actionneur: this.donnees.actionneur,
                        estMobile: true
                    }
                });
            } else {
                this.instanceNotif.fermer();
                this.instanceNotif = null;
            }
        };
        module.exports = ObjetWrapperCentraleNotifications_Mobile;
    },
    fn: "objetwrappercentralenotifications_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreOnglet = require('Enumere_Onglet.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var ObjetListeElements = require('ObjetListeElements.js');
        var C_IdDiscussions = 'Discussions';
        var C_IdCasiers = 'Casiers';
        var C_IdInformations = 'Informations';

        function ActionneurCentraleNotificationsSco() {}
        ActionneurCentraleNotificationsSco.prototype.actionNotification = function(aNotification) {
            var lOnglet = null;
            if (Array.isArray(aNotification.navOnglets) && aNotification.navOnglets.length > 0) {
                aNotification.navOnglets.every(function(aOnglet) {
                    if (_estOngletVisible(aOnglet)) {
                        lOnglet = aOnglet;
                        return false;
                    }
                    return true;
                });
            }
            if (aNotification.detailMessage && aNotification.detailPossession) {
                GEtatUtilisateur.message = MethodesObjet.dupliquer(aNotification.detailMessage);
                GEtatUtilisateur.message.listePossessionsMessages = new ObjetListeElements().AddElement(aNotification.detailPossession);
                GEtatUtilisateur.message.estUneDiscussion = true;
                GEtatUtilisateur.message.__marquerLu__ = true;
            }
            if (aNotification.estDetailActu) {
                GEtatUtilisateur.jeton_OngletInformation_dateNotification = aNotification.date;
            }
            if (!MethodesObjet.isNumber(lOnglet)) {
                switch (aNotification.id) {
                    case C_IdDiscussions:
                        lOnglet = EGenreOnglet.Messagerie;
                        break;
                    case C_IdCasiers:
                        lOnglet = EGenreOnglet.Casier_MonCasier;
                        break;
                    case C_IdInformations:
                        lOnglet = EGenreOnglet.Informations;
                        break;
                    default:
                        ;
                }
            }
            if (_estOngletVisible(lOnglet)) {
                Invocateur.evenement(ObjetInvocateur.events.navigationOnglet, lOnglet);
            } else {}
        };
        var _estOngletVisible = function(aOnglet) {
            if (aOnglet === EGenreOnglet.Accueil) {
                var lOngletAccueil = GEtatUtilisateur.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil);
                if (lOngletAccueil && lOngletAccueil.Actif) {
                    return true;
                }
                return false;
            }
            return GEtatUtilisateur.ongletEstVisible(aOnglet);
        };
        module.exports = ActionneurCentraleNotificationsSco;
    },
    fn: "actionneurcentralenotificationssco.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var GChaine = require('GChaine.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var ObjetElement = require('ObjetElement.js');

        function ObjetMoteurFicheEtablissement() {
            this.estSurMobile = GEtatUtilisateur.estEspaceMobile();
        }
        ObjetMoteurFicheEtablissement.prototype.composeInformations = function(aParam) {
            var H = [];
            var lEtablissement = aParam;
            if (lEtablissement.Logo) {
                H.push('<div  class="logo EspaceBas">', '<img src="data:image/png;base64,', lEtablissement.Logo, '" alt="" onerror="$(this).remove();" />', '</div>');
            }
            if (lEtablissement.Coordonnees.Adresse1 || lEtablissement.Coordonnees.Adresse2) {
                H.push('<div class="adresse">');
                H.push('<i class="icon_map_marker EspaceDroit"></i>');
                H.push('<div>');
                if (lEtablissement.Coordonnees.Adresse1) {
                    H.push('<div>', lEtablissement.Coordonnees.Adresse1, '</div>');
                }
                if (lEtablissement.Coordonnees.Adresse2) {
                    H.push('<div>', lEtablissement.Coordonnees.Adresse2, '</div>');
                }
                H.push('<div>');
                if (lEtablissement.Coordonnees.CodePostal && !lEtablissement.Coordonnees.LibellePostal) {
                    H.push('<span class="EspaceDroit">', lEtablissement.Coordonnees.CodePostal, '</span>');
                }
                if (lEtablissement.Coordonnees.LibellePostal) {
                    H.push('<span class="EspaceDroit">', lEtablissement.Coordonnees.LibellePostal, '</span>');
                }
                if (lEtablissement.Coordonnees.LibelleVille) {
                    H.push('<span>', lEtablissement.Coordonnees.LibelleVille, '</span>');
                }
                H.push('</div>');
                if (lEtablissement.Coordonnees.Province) {
                    H.push('<div>', lEtablissement.Coordonnees.Province, '</div>');
                }
                if (lEtablissement.Coordonnees.Pays) {
                    H.push('<div>', lEtablissement.Coordonnees.Pays, '</div>');
                }
                H.push('</div></div>');
            }
            H.push('<div>');
            if (lEtablissement.Coordonnees.NumPersonnalise1 && lEtablissement.Coordonnees.NumPersonnalise1.Numero) {
                H.push('<div class="telephone EspaceHaut">', '<i class="icon_phone EspaceDroit"></i> ', '<div>', (lEtablissement.Coordonnees.NumPersonnalise1.NomPersonnalise ? lEtablissement.Coordonnees.NumPersonnalise1.NomPersonnalise + ' : ' : ''), '<div>', _getTelephoneAvecEspaces.call(this, lEtablissement.Coordonnees.NumPersonnalise1.Numero), '</div></div></div>');
            }
            if (lEtablissement.Coordonnees.NumPersonnalise2 && lEtablissement.Coordonnees.NumPersonnalise2.Numero) {
                H.push('<div class="telephone EspaceHaut">', '<i class="icon_phone EspaceDroit"></i> ', '<div>', (lEtablissement.Coordonnees.NumPersonnalise2.NomPersonnalise ? lEtablissement.Coordonnees.NumPersonnalise2.NomPersonnalise + ' : ' : ''), '<div>', _getTelephoneAvecEspaces.call(this, lEtablissement.Coordonnees.NumPersonnalise2.Numero), '</div></div></div>');
            }
            if (lEtablissement.Coordonnees.NumPersonnalise3 && lEtablissement.Coordonnees.NumPersonnalise3.Numero) {
                H.push('<div class="telephone EspaceHaut">', '<i class="icon_phone EspaceDroit"></i> ', '<div>', (lEtablissement.Coordonnees.NumPersonnalise3.NomPersonnalise ? lEtablissement.Coordonnees.NumPersonnalise3.NomPersonnalise + ' : ' : ''), '<div>', _getTelephoneAvecEspaces.call(this, lEtablissement.Coordonnees.NumPersonnalise3.Numero), '</div></div></div>');
            }
            H.push('</div>');
            H.push('<div>');
            if (lEtablissement.Coordonnees.SiteInternet) {
                H.push('<div class="EspaceHaut telephone">', '<i class="icon_curseur_souris EspaceDroit"></i> ', '<a class="LienAcceuil AvecMain" target="_blank" href="', GChaine.verifierURLHttp(lEtablissement.Coordonnees.SiteInternet), '">', lEtablissement.Coordonnees.SiteInternet, '</a>', '</div>');
            }
            if (lEtablissement.Coordonnees.EMailPersonnalise1 && lEtablissement.Coordonnees.EMailPersonnalise1.Mail) {
                H.push('<div class="EspaceHaut telephone">', '<i class="icon_envelope EspaceDroit"></i>', '<div>', (lEtablissement.Coordonnees.EMailPersonnalise1.NomPersonnalise ? lEtablissement.Coordonnees.EMailPersonnalise1.NomPersonnalise + ' : ' : ''), '<div>', _composeEmail.call(this, lEtablissement.Coordonnees.EMailPersonnalise1.Mail), '</div></div></div>');
            }
            if (lEtablissement.Coordonnees.EMailPersonnalise2 && lEtablissement.Coordonnees.EMailPersonnalise2.Mail) {
                H.push('<div class="EspaceHaut telephone">', '<i class="icon_envelope EspaceDroit"></i>', '<div>', (lEtablissement.Coordonnees.EMailPersonnalise2.NomPersonnalise ? lEtablissement.Coordonnees.EMailPersonnalise2.NomPersonnalise + ' : ' : ''), '<div>', _composeEmail.call(this, lEtablissement.Coordonnees.EMailPersonnalise2.Mail), '</div></div></div>');
            }
            H.push('</div>');
            if (lEtablissement.avecFichierRI) {
                var lFichier = new ObjetElement(lEtablissement.LibelleFichierRI, lEtablissement.GetNumero(), EGenreDocumentJoint.Fichier);
                H.push('<div class="GrandEspaceHaut">', '<i class="icon_doc_telech EspaceDroit"></i> ', GChaine.composerUrlLienExterne({
                    documentJoint: lFichier,
                    libelleEcran: GTraductions.getValeur('FicheEtablissement.ReglementInterieur'),
                    class: 'LienAccueil AvecMain',
                    sansImgFormat: true
                }), '</div>');
            }
            return H.join('');
        };

        function _composeEmail(aParam) {
            if (this.estSurMobile) {
                return '<a href="mailto:' + aParam + '" target="_blank">' + aParam + '</a>';
            } else {
                return GChaine.composerEmail(aParam);
            }
        }

        function _getTelephoneAvecEspaces(aNumeroTelephone) {
            if (!aNumeroTelephone || !aNumeroTelephone.length) {
                return '';
            }
            var lResult = '';
            var lCompteur = 0;
            for (var i = aNumeroTelephone.length - 1; i >= 0; i--) {
                if ((lCompteur % 2) === 0) {
                    lResult = ' ' + lResult;
                }
                lResult = aNumeroTelephone.charAt(i) + lResult;
                lCompteur++;
            }
            lResult = lResult.trim();
            if (this.estSurMobile) {
                return '<a href="tel:' + aNumeroTelephone + '" target="_self">' + lResult + '</a>';
            } else {
                return lResult;
            }
        }
        module.exports = ObjetMoteurFicheEtablissement;
    },
    fn: "objetmoteurficheetablissement.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('Produit/Css/general/Fiche-Etablissement.css');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetMoteurFicheEtablissement = require('ObjetMoteurFicheEtablissement.js');
        var GTraductions = require('ObjetTraduction.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var MethodesTableau = require('MethodesTableau.js');
        MethodesObjet.heritagePrototype(ObjetPanelFicheEtablissement_Mobile, ObjetIdentite_Mobile);

        function ObjetPanelFicheEtablissement_Mobile() {
            this.inheritedCreate(arguments);
            this.moteurEtablissement = new ObjetMoteurFicheEtablissement();
        }
        ObjetPanelFicheEtablissement_Mobile.prototype.getControleur = function(aInstance) {
            return {
                btnFermer: {
                    event: function() {
                        aInstance.options.closeSideNav();
                    }
                },
                surSelection: function(I) {
                    $(this.node).on('click', function() {
                        aInstance.indiceEtablissementAffiche = I;
                        _afficherPage.call(aInstance);
                    });
                }
            };
        };
        ObjetPanelFicheEtablissement_Mobile.prototype.SetDonnees = function(aParams) {
            var lListeEtab = new ObjetListeElements();
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_PrimAccompagnant])) {
                lListeEtab.add(aParams.listeInformationsEtablissements.GetElementParNumero(GEtatUtilisateur.getMembre().Etablissement.GetNumero()));
            } else {
                lListeEtab = aParams.listeInformationsEtablissements;
            }
            this.listeEtablissements = new ObjetListeElements();
            if (lListeEtab) {
                for (var i = 0, lNbr = lListeEtab.GetNbrElements(); i < lNbr; i++) {
                    if (lListeEtab.GetElement(i).avecInformations) {
                        this.listeEtablissements.add(lListeEtab.GetElement(i));
                    }
                }
            }
            this.indiceEtablissementAffiche = 0;
            _afficherPage.call(this);
        };

        function _afficherPage() {
            var H = [];
            var lClass, lEtablissement, i;
            if (this.listeEtablissements) {
                var lNbrEtablissement = this.listeEtablissements.GetNbrElements();
                H.push('<div class="navheader header-titre">', '<ie-btnimage ie-model="btnFermer" class="icon_retour_mobile btnImageIcon"', GObjetWAI.composeAttribut({
                    genre: EGenreAttribut.label,
                    valeur: GTraductions.getValeur('Fermer')
                }), '></ie-btnimage>', '<div class="Gras">', GTraductions.getValeur('FicheEtablissement.ContacterEtablissement'), '</div>', '</div>');
                H.push('<div>');
                H.push('<div class="fiche-etablissement onglet">');
                for (i = 0; i < lNbrEtablissement; i++) {
                    lClass = this.indiceEtablissementAffiche === i ? 'selectionne' : '';
                    H.push('<div class="' + lClass + ' Espace Gras AvecMain" ie-node="surSelection(' + i + ')">', this.listeEtablissements.GetElement(i).GetLibelle() ? this.listeEtablissements.GetElement(i).GetLibelle() : GTraductions.getValeur('FicheEtablissement.Etablissement'), '</div>');
                }
                H.push('</div>');
                lEtablissement = this.listeEtablissements.GetElement(this.indiceEtablissementAffiche);
                H.push('<div class="fiche-etablissement informations GrandEspaceHaut GrandEspaceGauche">');
                H.push(this.moteurEtablissement.composeInformations(lEtablissement));
                H.push('</div>');
                H.push('</div>');
            }
            this.Afficher(H.join(''));
            $('.materialboxed').materialbox();
        }
        module.exports = ObjetPanelFicheEtablissement_Mobile;
    },
    fn: "objetpanelficheetablissement_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var _ObjetAffichagePageMenuOnglets = require('_InterfacePageMenuOnglets.js');
        var GChaine = require('GChaine.js');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var UtilitaireContactVieScolaire_Mobile = require('UtilitaireContactVieScolaire_Mobile.js');
        var ObjetWrapperCentraleNotifications_Mobile = require('ObjetWrapperCentraleNotifications_Mobile.js');
        var ActionneurCentraleNotificationsSco = require('ActionneurCentraleNotificationsSco.js');
        var ObjetDonneesCentraleNotifications = require('ObjetDonneesCentraleNotifications.js');
        var ObjetPanelFicheEtablissement_Mobile = require('ObjetPanelFicheEtablissement_Mobile.js');
        var UtilitaireSideNav = require('UtilitaireSideNav.js');
        var GDate = require('ObjetDate.js').GDate;
        var Identite = require('ObjetIdentite.js');
        var ObjetDiscussion_Mobile = require('ObjetDiscussion_Mobile.js');
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');

        function ObjetAffichagePageMenuOnglets() {
            this.inheritedCreate(arguments);
            this.idNotifInfo = this.Nom + '_NotifInfo';
            this.idNotifComm = this.Nom + '_NotifComm';
            this._cacheNbNotificationsOnglets = {};
            Invocateur.abonner(ObjetDonneesCentraleNotifications.typeNotif.surModification, function(aDonnees) {
                _actualiserBadge.call(this, aDonnees);
            }, this);
            Invocateur.abonner('changementRessource', this.changementRessource.bind(this), this);
            Invocateur.abonner('desactiverAccueil', this.masquerBoutonAccueil.bind(this), this);
            this.logoDepartementImage = GParametres.logoDepartementImage;
            this.logoDepartementLien = GParametres.logoDepartementLien;
            this.donneesCentraleNotifications = GApplication.donneesCentraleNotifications;
            this.wrapperNotifs = new ObjetWrapperCentraleNotifications_Mobile({
                pere: this,
                actionneur: new ActionneurCentraleNotificationsSco()
            });
        }
        MethodesObjet.heritagePrototype(ObjetAffichagePageMenuOnglets, _ObjetAffichagePageMenuOnglets);
        ObjetAffichagePageMenuOnglets.prototype.getControleur = function(aInstance) {
            return {
                btnAlertesPPMSEnCours: {
                    event: function() {
                        GInterface.fermerMenuOnglet();
                        UtilitaireContactVieScolaire_Mobile.afficherAlertePPMS();
                    },
                    getHtml: function() {
                        return _composeBadge(UtilitaireContactVieScolaire_Mobile.listeAlertePPMSEnCours.GetNbrElements(), GTraductions.getValeur('Messagerie.AlerteEnseignantsPersonnels'));
                    },
                    afficher: function() {
                        return UtilitaireContactVieScolaire_Mobile.listeAlertePPMSEnCours && UtilitaireContactVieScolaire_Mobile.listeAlertePPMSEnCours.GetNbrElements() > 0;
                    }
                },
                btnNotifications: {
                    event: function() {
                        GInterface.fermerMenuOnglet();
                        aInstance.wrapperNotifs.ouvrir();
                    },
                    getHtmlBtnNotif: function() {
                        return _composeBadge(aInstance.donneesCentraleNotifications.nbNotifs, GTraductions.getValeur('Messagerie.AlerteEnseignantsPersonnels'));
                    }
                },
                btnAlertesPPMSCreation: {
                    event: function() {
                        GInterface.fermerMenuOnglet();
                        UtilitaireContactVieScolaire_Mobile.creerAlertePPMS();
                    },
                    afficher: function() {
                        return GApplication.droits.get(TypeDroits.communication.lancerAlertesPPMS);
                    }
                },
                btnMessageInstant: {
                    event: function() {
                        GInterface.fermerMenuOnglet();
                        UtilitaireContactVieScolaire_Mobile.demarrerMessageInstantane();
                    },
                    getHtmlBtnMessageInstant: function() {
                        return _composeBadge(aInstance.donneesCentraleNotifications.nbConversationEnCours, GTraductions.getValeur('Messagerie.EnvoiMessageInstantane'));
                    },
                    afficher: function() {
                        return GApplication.droits.get(TypeDroits.communication.avecMessageInstantane);
                    }
                },
                btnMessageCarnet: {
                    event: function() {
                        GInterface.fermerMenuOnglet();
                        var lEleve = GEtatUtilisateur.getMembre();
                        var lListeDestinataires = TUtilitaireMessagerie.getListeDestCarnetLiaisonDEleve_PrimParent(lEleve.GetNumero());
                        var lMessage = {
                            listeDestinataires: lListeDestinataires,
                            estCreationCarnetLiaison: true
                        };
                        var lAffDiscussion = Identite.creerInstance(ObjetDiscussion_Mobile, {
                            pere: this
                        });
                        lAffDiscussion.setOptions({
                            estSidePanel: true,
                            estChat: false,
                            avecPJ: false,
                            callbackEnvoyer: function() {
                                lAffDiscussion.masquer();
                            }
                        }).setDonnees({
                            message: MethodesObjet.dupliquer(lMessage),
                            creationDiscussion: true,
                            estPrimParentSurEtiquetteCL: true,
                            listeDestinatairesCarnetLiaison: lListeDestinataires,
                            eleveCarnetLiaison: lEleve,
                            titre: GTraductions.getValeur('MessagerieCarnetLiaison.TitreFenetreNouveauPourLEleve', [lEleve.GetLibelle()])
                        });
                    }
                },
                nodeClosePanel: function() {
                    $(this.node).on('click', function() {
                        GInterface.fermerMenuOnglet();
                    });
                },
                nodeSeDeconnecter: function() {
                    $(this.node).on('click', function() {
                        aInstance.seDeconnecter();
                    });
                },
                nodeFicheEtablissement: function() {
                    $(this.node).on('click', function() {
                        GInterface.fermerMenuOnglet();
                        _ouvrirFicheEtablissement(aInstance);
                    });
                },
                nodeStopCovid: function() {
                    $(this.node).on('click', function() {
                        window.open(GParametres.urlStopCovid);
                    });
                }
            };
        };

        function _ouvrirFicheEtablissement(aInstance) {
            UtilitaireSideNav.createComplet(ObjetPanelFicheEtablissement_Mobile, {
                pere: aInstance,
                start: function(aInstanceFiche) {
                    aInstanceFiche.SetDonnees({
                        listeInformationsEtablissements: GEtatUtilisateur.listeInformationsEtablissements
                    });
                }
            });
        }

        function _composeBadge(aNb, aWAI) {
            return ['<span class="WAI_hidden">', aWAI, '</span>', aNb > 0 ? ['<span class="as-tag">', aNb > 99 ? '99+' : aNb, '</span>'].join('') : ''].join('');
        }
        ObjetAffichagePageMenuOnglets.prototype.traiterListeRessource = function() {
            this.listeRessources = GInterface.getListeRessources();
            if (this.listeRessources.GetNbrElements() > 1) {
                for (var i = 0; i < this.listeRessources.GetNbrElements(); i++) {
                    this.listeRessources.GetElement(i).sousTitre = this.listeRessources.GetElement(i).Classe.GetLibelle();
                }
            }
        };
        ObjetAffichagePageMenuOnglets.prototype.actionSurRecupererDonnees = function() {
            var i;
            this.listeOnglets = new ObjetListeElements();
            this.listeOngletsTraitee = new ObjetListeElements();
            if (GEtatUtilisateur.listeOnglets.GetNbrElements() > 0) {
                for (i = 0; i < GEtatUtilisateur.listeOnglets.GetNbrElements(); i++) {
                    var lElement = GEtatUtilisateur.listeOnglets.GetElement(i);
                    if (lElement.Actif) {
                        this.listeOnglets.AddElement(lElement);
                        if (lElement.GetLibelle().search(/<br\s?\/?>/gi) > -1) {
                            lElement.SetLibelle(lElement.GetLibelle().replace(/<br\s?\/?>/gi, ' '));
                        }
                        lElement.sousTitre = '';
                        lElement.imagePosition = "left";
                        switch (lElement.GetGenre()) {
                            case EGenreOnglet.EmploiDuTemps:
                                lElement.imagePerso = "icon_calendar";
                                break;
                            case EGenreOnglet.EmploiDuTempsClasse:
                                lElement.imagePerso = "icon_calendar";
                                break;
                            case EGenreOnglet.CDT_TAF:
                                lElement.imagePerso = "icon_taf";
                                break;
                            case EGenreOnglet.CDT_Contenu:
                                lElement.imagePerso = "icon_contenu_cours";
                                break;
                            case EGenreOnglet.ManuelsNumeriques:
                                lElement.imagePerso = "icon_book";
                                break;
                            case EGenreOnglet.ReleveDeCompetences:
                            case EGenreOnglet.Bulletins:
                            case EGenreOnglet.BulletinCompetences:
                            case EGenreOnglet.BulletinAnneesPrec_Note:
                            case EGenreOnglet.BulletinAnneesPrec_Competence:
                                lElement.imagePerso = "icon_bulletin";
                                break;
                            case EGenreOnglet.EquipePedagogique:
                                lElement.imagePerso = "icon_personnes";
                                break;
                            case EGenreOnglet.Releve:
                                lElement.imagePerso = "icon_releve_notes";
                                break;
                            case EGenreOnglet.Menus:
                                lElement.imagePerso = "icon_food";
                                break;
                            case EGenreOnglet.SaisieAbsences_AppelEtSuivi:
                                lElement.imagePerso = "icon_feuille_appel";
                                break;
                            case EGenreOnglet.GeneralVieEtablissement:
                                break;
                            case EGenreOnglet.Informations:
                                lElement.imagePerso = "icon_infos_sondages";
                                lElement.idNotif = this.idNotifInfo;
                                break;
                            case EGenreOnglet.Messagerie:
                                lElement.imagePerso = "icon_comments";
                                lElement.idNotif = this.idNotifComm;
                                break;
                            case EGenreOnglet.Incidents:
                                lElement.imagePerso = "icon_bolt";
                                break;
                            case EGenreOnglet.ListeEleves:
                                lElement.imagePerso = "icon_uniF2BC";
                                break;
                            case EGenreOnglet.Agenda:
                                lElement.imagePerso = "icon_calendar_empty";
                                break;
                            case EGenreOnglet.Rencontre:
                                lElement.imagePerso = "icon_uniF2B5";
                                break;
                            case EGenreOnglet.DernieresNotes:
                                lElement.imagePerso = "icon_notes_etoile";
                                break;
                            case EGenreOnglet.DernieresEvaluations:
                                lElement.imagePerso = "icon_dernieres_evals";
                                break;
                            case EGenreOnglet.VieScolaire_Recapitulatif:
                                lElement.imagePerso = "icon_vs";
                                break;
                            case EGenreOnglet.TableauDeBord:
                                lElement.imagePerso = 'icon_th_large';
                                break;
                            case EGenreOnglet.SaisieNotes:
                                lElement.imagePerso = 'icon_releve_notes';
                                break;
                            case EGenreOnglet.SaisieCahierDeTextes:
                                lElement.imagePerso = 'icon_saisie_cahier_texte';
                                break;
                            case EGenreOnglet.InfosPerso:
                                lElement.imagePerso = 'icon_th_large';
                                break;
                            case EGenreOnglet.ParametresUtilisateur:
                                lElement.imagePerso = 'icon_th_large';
                                break;
                            case EGenreOnglet.CompteEleve:
                                lElement.imagePerso = 'icon_th_large';
                                break;
                            case EGenreOnglet.DocumentsATelecharger:
                                lElement.imagePerso = 'icon_th_large';
                                break;
                            case EGenreOnglet.SaisieOrientation:
                                lElement.imagePerso = 'icon_th_large';
                                break;
                            default:
                        }
                    }
                }
                this.afficherListe();
                this.actualiserPhoto();
            }
        };
        ObjetAffichagePageMenuOnglets.prototype.evenementSelectionRessource = function(aGenreEvenement, aElement) {
            GEtatUtilisateur.SetNumeroEleve(aElement.GetNumero());
            this.actionSurRecupererDonnees();
            this.evenementListeOnglets(GEtatUtilisateur.getGenreOnglet());
        };
        ObjetAffichagePageMenuOnglets.prototype.actualiserTitre = function() {
            var lLibelleClasse = GEtatUtilisateur.Identification.GetLibelleClasse();
            var lTitre = GEtatUtilisateur.getMembre().GetLibelle() + ' ' + (lLibelleClasse ? '' + '(' + lLibelleClasse + ')' : '');
            GHtml.setHtml(this.idTitre, lTitre);
            if (GEtatUtilisateur.derniereConnexion) {
                var lDerniereConnexion = GTraductions.getValeur('accueil.PrecedenteConnection', [
                    GDate.FormatDate(GEtatUtilisateur.derniereConnexion, '%JJJ %JJ %MMM'), GDate.FormatDate(GEtatUtilisateur.derniereConnexion, '%hh%sh%mm')
                ]);
                GHtml.setHtml(this.idDerniereConnexion, lDerniereConnexion);
            }
        };
        ObjetAffichagePageMenuOnglets.prototype.actualiserPhoto = function() {
            var lMembre = GEtatUtilisateur.getMembre();
            if (lMembre && lMembre.avecPhoto) {
                GHtml.setHtml(this.idPhoto, '<img src="' + GChaine.composerUrlLienExterne({
                    libelle: 'photo.jpg',
                    documentJoint: lMembre,
                    brut: true
                }) + '" style="width:100%;" onerror="$(this).remove();"  alt="' + lMembre.GetLibelle() + '"/>');
            } else {
                GHtml.setHtml(this.idPhoto, '');
            }
        };
        ObjetAffichagePageMenuOnglets.prototype.getEspaceIcone = function() {
            var lEspaceIcone = '';
            switch (GApplication.acces.genreEspace) {
                case EGenreEspace.Mobile_Eleve:
                    lEspaceIcone = 'photoEspaceEtudiant';
                    break;
                case EGenreEspace.Mobile_Professeur:
                    lEspaceIcone = 'photoEspaceEnseignant';
                    break;
                case EGenreEspace.Mobile_PrimProfesseur:
                    lEspaceIcone = 'photoEspaceEnseignant';
                    break;
                case EGenreEspace.Mobile_Parent:
                    lEspaceIcone = 'photoEspaceParent';
                    break;
                case EGenreEspace.Mobile_PrimParent:
                    lEspaceIcone = 'photoEspaceParent';
                    break;
                case EGenreEspace.Mobile_Etablissement:
                    lEspaceIcone = 'photoEspaceVS';
                    break;
                case EGenreEspace.Mobile_Administrateur:
                    lEspaceIcone = 'photoEspaceDirection';
                    break;
                case EGenreEspace.Mobile_Accompagnant:
                    lEspaceIcone = 'photoEspaceVS';
                    break;
                case EGenreEspace.Mobile_PrimAccompagnant:
                    lEspaceIcone = 'photoEspaceVS';
                    break;
            }
            return lEspaceIcone;
        };
        ObjetAffichagePageMenuOnglets.prototype.getGenreOngletAccueil = function() {
            return EGenreOnglet.Accueil;
        };
        ObjetAffichagePageMenuOnglets.prototype.masquerBoutonAccueil = function() {
            this.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil).Visible = false;
            this.afficherListe();
        };
        ObjetAffichagePageMenuOnglets.prototype.changementRessource = function() {
            this.evenementListeOnglets(false);
        };

        function _actualiserBadge(aDonnees) {
            [EGenreOnglet.Messagerie, EGenreOnglet.Informations].forEach(function(aGenreOnglet) {
                var lSelecteur = '';
                switch (aGenreOnglet) {
                    case EGenreOnglet.Messagerie:
                        lSelecteur = "#" + this.idNotifComm.escapeJQ();
                        break;
                    case EGenreOnglet.Informations:
                        lSelecteur = "#" + this.idNotifInfo.escapeJQ();
                        break;
                    default:
                        ;
                        return;
                }
                var lNombre = aDonnees.compteurNotifsParOnglet ? aDonnees.compteurNotifsParOnglet[aGenreOnglet].nb || 0 : 0;
                $(lSelecteur).find('.as-tag').remove();
                if (lNombre > 0) {
                    $(lSelecteur).append('<span class="as-tag">' + (lNombre > 999 ? '999+' : lNombre) + '</span>');
                }
            }.bind(this));
        }
        ObjetAffichagePageMenuOnglets.prototype.composeOngletDeconnection = function() {
            return '';
        };
        ObjetAffichagePageMenuOnglets.prototype.seDeconnecterAppliMobile = function() {};
        ObjetAffichagePageMenuOnglets.prototype.composeOngletMobileApp = function() {
            return '';
        };
        ObjetAffichagePageMenuOnglets.prototype.composeBoutonMenuSupp = function() {
            var H = [];
            H.push('<div class="home-action-conteneur">', '<div class="toggler-btn" ie-node="nodeClosePanel" role="button" tabIndex="0" aria-label="', GTraductions.getValeur('accueil.menuPrincipal'), '">', '<i class="icon_reorder"><span class="WAI_hidden">', GTraductions.getValeur('accueil.menuPrincipal'), '</span></i></div>');
            if (GEtatUtilisateur.avecPageAccueil()) {
                H.push('<div ie-event="click->surClicOnglet(', 7, ')" class="toggler-btn" role="button" tabIndex="0"  aria-label="', GTraductions.getValeur('Commande.Accueil.Actif'), '"><i class="icon_home">', '<span class="WAI_hidden">', GTraductions.getValeur('Commande.Accueil.Actif'), '</span></i>', '</div>');
            }
            H.push('</div>');
            H.push('<div class="notifs-conteneur">');
            H.push('<hr />');
            if (GApplication.droits.get(TypeDroits.communication.estDestinataireChat)) {
                H.push('<ie-btnimage class="icon_alerte_ppms btnImageIcon badged-btn" ie-model="btnAlertesPPMSEnCours" ie-html="getHtml" ie-if="afficher"></ie-btnimage>');
            }
            H.push('<ie-btnimage class="icon_papillon_notif btnImageIcon badged-btn" ie-model="btnNotifications" ie-html="getHtmlBtnNotif" aria-label="', GTraductions.getValeur('CentraleNotifications.TitreNotifications'), '"></ie-btnimage>');
            var lAvecSep = false;
            if (GApplication.droits.get(TypeDroits.communication.estDestinataireChat)) {
                H.push('<hr />');
                lAvecSep = true;
                H.push('<ie-btnimage class="icon_conversation_cours btnImageIcon badged-btn" ie-model="btnMessageInstant" ie-if="afficher" ie-html="getHtmlBtnMessageInstant"></ie-btnimage>');
                H.push('<ie-btnimage class="icon_alerte_ppms btnImageIcon badged-btn" ie-model="btnAlertesPPMSCreation"  ie-if="afficher">', '<span class="WAI_hidden">', GTraductions.getValeur('Messagerie.AlerteEnseignantsPersonnels'), '</span>', '</ie-btnimage>');
            }
            if (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent && GEtatUtilisateur.Identification.ListeRessources && GEtatUtilisateur.Identification.ListeRessources.GetNbrElements() > 0) {
                if (!lAvecSep) {
                    H.push('<hr />');
                    lAvecSep = true;
                }
                H.push('<ie-btnimage class="icon_nouvelle_discussion btnImageIcon badged-btn" ie-model="btnMessageCarnet"></ie-btnimage>');
            }
            if (GEtatUtilisateur.avecFicheEtablissement()) {
                if (!lAvecSep) {
                    H.push('<hr />');
                    lAvecSep = true;
                }
                H.push('<ie-btnimage class="icon_uniF2C3 btnImageIcon badged-btn" ie-node="nodeFicheEtablissement" ie-hint="', GTraductions.getValeur('FicheEtablissement.ContacterEtablissement'), '" aria-label="', GTraductions.getValeur('FicheEtablissement.ContacterEtablissement'), '">', '<span class="WAI_hidden">', GTraductions.getValeur('FicheEtablissement.ContacterEtablissement'), '</span>', '</ie-btnimage>');
            }
            H.push('</div>');
            if (GParametres.urlStopCovid) {
                H.push('<ie-btnimage class="btnImageIcon Image_StopCovid" ie-node="nodeStopCovid"></ie-btnimage>');
            }
            H.push('<div class="cta-mobile-conteneur">');
            H.push('<hr />');
            if (!GApplication.estAppliMobile || GApplication.infoAppliMobile.avecExitApp) {
                H.push('<ie-btnimage class="icon_off btnImageIcon badged-btn" ie-node="nodeSeDeconnecter" ie-hint="', GTraductions.getValeur('connexion.SeDeconnecter'), '" aria-label="', GTraductions.getValeur('connexion.SeDeconnecter'), '">', '<span class="WAI_hidden">', GTraductions.getValeur('connexion.SeDeconnecter'), '</span>', '</ie-btnimage>');
            }
            H.push('</div>');
            return H.join('');
        };
        module.exports = ObjetAffichagePageMenuOnglets;
    },
    fn: "interfacepagemenuonglets.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GUID = require('GUID.js');
        var Invocateur = require('Invocateur.js').Invocateur;
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var _InterfacePopup = require('_InterfacePopup.js');
        var EGenreAction = require('Enumere_Action.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var FenetreModale_Patience = require('FenetreModale_Patience.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var Support = require('ObjetSupport.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetEnteteMobile = require('ObjetEntete.js');
        var ControleSaisieEvenement = require('ControleSaisieEvenement.js');
        MethodesObjet.heritagePrototype(_ObjetInterfaceMobile, _InterfacePopup);

        function _ObjetInterfaceMobile() {
            this.inheritedCreate(arguments);
            this.largeur = '100%';
            this.hauteur = '100%';
            this.idZoneSelection = this.Nom + '_zoneSelection';
            this.idZonePrincipale = this.Nom + '_zonePrincipale';
            this.idPanel = this.Nom + '_panel';
            if (Support.supportEventOnPopState) {
                $(window).off('popstate').on('popstate', {
                    instance: this
                }, _surPopState);
            }
            Invocateur.abonner('OuvrirFenetreLienPDF', this._surOuvrirLienPDF.bind(this));
            Invocateur.abonner(ObjetInvocateur.events.fermerFenetres, function() {
                $(document).find('.modal:not(.fermerFenetreEventInterne)').each(function() {
                    var lInstance = M.Modal.getInstance(this);
                    if (lInstance && lInstance.isOpen) {
                        lInstance.close();
                    }
                });
                var lInstancePanel = M.Sidenav.getInstance($('#' + this.idPanel.escapeJQ()));
                if (lInstancePanel && lInstancePanel.isOpen) {
                    lInstancePanel.close();
                }
            }, this);
            Invocateur.abonner(ObjetInvocateur.events.navigationOnglet, function(aOnglet, aParams) {
                var lParams = Object.assign({
                    fermerMenu: false,
                    ajouterHistorique: true,
                    genreAffichage: undefined
                }, aParams);
                this.evenementSurOnglet(aOnglet, lParams.fermerMenu, lParams.ajouterHistorique, lParams.genreAffichage);
            }, this);
        }
        _ObjetInterfaceMobile.prototype.DetruireInstances = function() {
            $(window).off('popstate');
        };

        function _surPopState(event) {
            var lEtat = event.originalEvent.state,
                lInstance = event.data.instance;
            if (!lEtat || lEtat.onglet === undefined || lEtat.numeroSession !== GApplication.getCommunication().NumeroDeSession) {
                event.stopImmediatePropagation();
                if (!GApplication.estAppliMobile) {
                    setTimeout(function() {
                        GApplication.getMessage().afficher({
                            type: EGenreBoiteMessage.Confirmation,
                            message: GTraductions.getValeur('mobile.confirmDeco'),
                            callback: _evenementPrecedentSuivantDeconnexion
                        });
                    }, 10);
                } else {
                    event.preventDefault();
                }
            } else {
                if (lInstance._surForward) {
                    delete lInstance._surForward;
                    return;
                }
                ControleSaisieEvenement(function() {
                    lInstance.evenementSurOnglet(lEtat.onglet, null, false, lEtat.genreAffichage);
                });
            }
        }

        function _evenementPrecedentSuivantDeconnexion(aAccepte) {
            if (aAccepte === EGenreAction.Valider) {
                window.location.reload();
            } else {
                this._surForward = true;
                window.history.forward();
            }
        }
        _ObjetInterfaceMobile.prototype.SetParametresGeneraux = function() {
            this.AvecCadre = false;
        };
        _ObjetInterfaceMobile.prototype._construireInstances = function(aParam) {
            this.fenetreModalePatience = new FenetreModale_Patience();
            this.identPageMobile = this.Add(ObjetInterfacePage_Mobile);
            if (!aParam || !aParam.sansMenuOnglet) {
                this.idMenuOnglets = this.Add(require('InterfacePageMenuOnglets.js'), this.evenementSurOnglet, this.initMenuOnglet);
            }
            this.identEnteteMobile = this.Add(ObjetEnteteMobile, this.evenementEnteteMobile, this.initEntete);
            this.IdentBandeauPied = this.AjouterBandeauPied();
        };
        _ObjetInterfaceMobile.prototype.initMenuOnglet = function(aInstance) {
            aInstance.SetParametres({
                avecListeRessources: this.avecChangementRessource()
            });
        };
        _ObjetInterfaceMobile.prototype.changementRessource = function() {};
        _ObjetInterfaceMobile.prototype.avecChangementRessource = function() {};
        _ObjetInterfaceMobile.prototype.getListeRessources = function() {};
        _ObjetInterfaceMobile.prototype.AjouterBandeauPied = function() {
            return null;
        };
        _ObjetInterfaceMobile.prototype.ConstruireStructureAffichage = function() {
            var lZones = [];
            lZones.push(this.fenetreModalePatience.composerConteneur());
            if (this.idMenuOnglets !== undefined) {
                lZones.push('<div id="', this.GetInstance(this.idMenuOnglets).GetNom(), '" class=" sidenav aside-nav-right"></div>');
            }
            var lAfficherFooter = ((!!GNavigateur.isIOS && GNavigateur.versionIOS > '10.3') || (!!GNavigateur.isAndroid && GNavigateur.versionAndroid >= '6.0') || (!GNavigateur.isAndroid && !GNavigateur.isIOS));
            lZones.push('<div id="', this.GetInstance(this.identEnteteMobile).GetNom(), '" class="navbar-fixed "></div>', '<div class="content-mobile-wrapper">', '<div id="', this.idZoneSelection, '" style="display:none;" class="objetInterfaceMobile_zoneSelection"></div>', '<div id="', this.idZonePrincipale, '" role="main" class="objetInterfaceMobile_zonePrincipale dotty">', '<div id="', this.GetInstance(this.identPageMobile).GetNom(), '" class="objetInterfaceMobile_identPage"></div>', '<div id="', this.idPanel, '" class="sidenav side-panel"></div>', '</div>', this.IdentBandeauPied >= 0 && lAfficherFooter ? '<div class="footer-mobile" id="' + this.GetInstance(this.IdentBandeauPied).GetNom() + '" ></div>' : '', this.getStructurePopup());
            lZones.push('</div>');
            return lZones.join('');
        };
        _ObjetInterfaceMobile.prototype.RecupererDonnees = function() {
            this.actionSurRecupererDonnees();
        };
        _ObjetInterfaceMobile.prototype.getEtatSaisie = function() {
            return GEtatUtilisateur.EtatSaisie;
        };
        _ObjetInterfaceMobile.prototype.getGenreOnglet = function() {};
        _ObjetInterfaceMobile.prototype.getGenreOngletAccueil = function() {};
        _ObjetInterfaceMobile.prototype.CreerPage = function(aGenreOnglet) {
            var lConstructeur = this._getConstructeurOnglet(aGenreOnglet);
            var lObjetPageMobile = this.ConstruireObjetGraphique(lConstructeur, this.identPageMobile, this.evenementPageMobile);
            return lObjetPageMobile;
        };
        _ObjetInterfaceMobile.prototype._ajouterHistorique = function(aOnglet, aGenreAffichage) {
            if (!!aOnglet && Support.supportEventOnPopState) {
                try {
                    window.history.pushState({
                        onglet: aOnglet,
                        genreAffichage: aGenreAffichage,
                        numeroSession: GApplication.getCommunication().NumeroDeSession
                    }, '');
                } catch (e) {}
            }
        };
        _ObjetInterfaceMobile.prototype.evenementPageMobile = function() {};
        _ObjetInterfaceMobile.prototype.evenementEnteteMobile = function() {};
        _ObjetInterfaceMobile.prototype.getPageCourante = function() {
            return this.GetInstance(this.identPageMobile);
        };
        _ObjetInterfaceMobile.prototype.traiterEvenementConfirmationSortie = function() {
            if (this.genreOngletSuivant) {
                this.SetEtatSaisie(false);
                this.evenementSurOnglet(this.genreOngletSuivant, true, true, this.genreAffichageSuivant);
                this.genreOngletSuivant = null;
                this.genreAffichageSuivant = null;
            }
        };
        _ObjetInterfaceMobile.prototype.initEntete = function(aInstance) {
            if (this.idMenuOnglets !== undefined) {
                aInstance.SetParametres({
                    idPanel: this.GetInstance(this.idMenuOnglets).GetNom()
                });
            }
        };

        function _getInstanceSideNavPanel(aParametresSideNav) {
            var $panel = $('#' + this.idPanel.escapeJQ());
            var lInstancePanel = M.Sidenav.getInstance($panel);
            if (!lInstancePanel) {
                M.Sidenav.init($panel, Object.assign({
                    edge: 'right',
                    draggable: false
                }, aParametresSideNav));
                lInstancePanel = M.Sidenav.getInstance($panel);
            }
            return lInstancePanel;
        }
        _ObjetInterfaceMobile.prototype.openPanel = function(aHtml, aParametresHtml, aParametresSideNav) {
            var lSideNav = _getInstanceSideNavPanel.call(this, aParametresSideNav);
            var lParamsSideNav = Object.assign({
                inDuration: 250,
                outDuration: 200,
                onOpenStart: null,
                onOpenEnd: null,
                onCloseStart: null,
                onCloseEnd: null
            }, aParametresSideNav || {});
            if (lSideNav.isOpen) {
                lParamsSideNav.inDuration = 0;
                lSideNav.options.outDuration = 0;
                lSideNav.close();
            }
            var $panel = $('#' + this.idPanel.escapeJQ());
            $panel.IEHtml(aHtml, aParametresHtml);
            $panel.find('select').formSelect();
            $panel.find('textarea.withCaracterCounter').characterCounter();
            $panel.find('.collapsible').collapsible();
            Object.assign(lSideNav.options, lParamsSideNav);
            lSideNav.open();
        };
        _ObjetInterfaceMobile.prototype.closePanel = function() {
            _getInstanceSideNavPanel.call(this).close();
        };
        _ObjetInterfaceMobile.prototype.isPanelOpened = function() {
            return _getInstanceSideNavPanel.call(this).isOpen;
        };
        _ObjetInterfaceMobile.prototype.updatePanelContent = function(aHtml, aParametres) {
            var $panel = $('#' + this.idPanel.escapeJQ());
            $panel.IEHtml(aHtml, aParametres);
            $panel.find('select').formSelect();
            $panel.find('textarea').characterCounter();
            $panel.find('.collapsible').collapsible();
        };
        _ObjetInterfaceMobile.prototype.evenementSurOnglet = function(aGenreOnglet, aFermerMenu, aAjouterHistorique, aGenreAffichage) {
            if (this.getEtatSaisie() === true && !GApplication.getModeExclusif()) {
                this.genreOngletSuivant = $.isNumeric(aGenreOnglet) ? parseInt(aGenreOnglet) : aGenreOnglet;
                this.genreAffichageSuivant = aGenreAffichage;
                ControleSaisieEvenement(this.traiterEvenementConfirmationSortie.bind(this));
            } else {
                this.SetEtatSaisie(false);
                var lFermerMenu = (aFermerMenu !== null && aFermerMenu !== undefined) ? aFermerMenu : true,
                    lAjouterHistorique = (aAjouterHistorique !== null && aAjouterHistorique !== undefined) ? aAjouterHistorique : true;
                this.genreOngletSuivant = null;
                this.genreAffichageSuivant = null;
                this.genreOngletPrecedent = this.GenreOnglet;
                this.GenreOnglet = $.isNumeric(aGenreOnglet) ? parseInt(aGenreOnglet) : aGenreOnglet;
                if (aGenreAffichage) {
                    this.genreAffichage = aGenreAffichage;
                } else {
                    this.genreAffichage = null;
                }
                if (GEtatUtilisateur.setGenreAffichage) {
                    GEtatUtilisateur.setGenreAffichage(this.genreAffichage);
                }
                if (!!this.idMenuOnglets) {
                    this.GetInstance(this.idMenuOnglets).setOnglet(aGenreOnglet);
                }
                this.closePopup();
                this.actionSurEvenementOnglet(lFermerMenu);
                if (lAjouterHistorique) {
                    this._ajouterHistorique(aGenreOnglet, aGenreAffichage);
                }
            }
        };
        _ObjetInterfaceMobile.prototype.evenementAvantAffichageOnglet = function() {};
        _ObjetInterfaceMobile.prototype.actionSurEvenementOnglet = function(aFermerMenu) {
            if (aFermerMenu) {
                this.fermerMenuOnglet();
            }
            Invocateur.evenement(ObjetInvocateur.events.fermerFenetres);
            if (this.GetInstance(this.identPageMobile) && this.GetInstance(this.identPageMobile).free) {
                this.GetInstance(this.identPageMobile).free();
            }
            this.Instances[this.identPageMobile] = null;
            if (GApplication.estAppliMobile) {
                window.messageData.push({
                    action: 'actionOnglet'
                });
            }
            $('body > [id^="select-options"]').remove();
            this.evenementAvantAffichageOnglet(this.GenreOnglet);
            this.Instances[this.identPageMobile] = this.CreerPage(this.GenreOnglet);
            this.GetInstance(this.identPageMobile).setGenreAffichage(this.genreAffichage);
            GEtatUtilisateur.setGenreOnglet(this.GenreOnglet);
            this.GetInstance(this.identEnteteMobile).setBoutonAccueil(this.GenreOnglet !== this.getGenreOngletAccueil());
            this.GetInstance(this.identEnteteMobile).actualiserTitre();
            this.GetInstance(this.identPageMobile).Initialiser();
            if ((this.genreAffichage !== null && this.genreAffichage !== undefined)) {
                GEtatUtilisateur.resetPage();
            }
            this.GetInstance(this.identEnteteMobile).focusTitre();
        };
        _ObjetInterfaceMobile.prototype.ouvrirMenuOnglet = function() {
            if (!!this.GetInstance(this.idMenuOnglets)) {
                $('#' + this.GetInstance(this.idMenuOnglets).GetNom().escapeJQ()).sidenav('open');
            }
        };
        _ObjetInterfaceMobile.prototype.fermerMenuOnglet = function() {
            if (!!this.GetInstance(this.idMenuOnglets)) {
                $('#' + this.GetInstance(this.idMenuOnglets).GetNom().escapeJQ()).sidenav('close');
            }
        };
        _ObjetInterfaceMobile.prototype.actionSurRecupererDonnees = function() {};
        _ObjetInterfaceMobile.prototype._surOuvrirLienPDF = function(aUrl) {
            var T = [],
                lId = GUID.getId();
            T.push('<a href="' + aUrl + '" id="', lId, '" class="link" target="_blank">' + GTraductions.getValeur('GenerationPDF.Lien.CliquerIci') + '</a>');
            GApplication.getMessage().afficher({
                message: T.join(''),
                titre: GTraductions.getValeur('GenerationPDF.Lien.TitreLienPDF')
            });
            $('#' + lId).click(function() {
                GApplication.getMessage().Fermer();
            });
        };
        _ObjetInterfaceMobile.prototype._getConstructeurOnglet = function() {};
        module.exports = _ObjetInterfaceMobile;
    },
    fn: "_interfacemobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        function ObjetThemesPrimaire() {}
        ObjetThemesPrimaire.prototype.setTheme = function() {
            var lThemeCourant = this.getTheme();
            $('#' + GApplication.getIdConteneur().escapeJQ()).addClass(lThemeCourant);
        };
        ObjetThemesPrimaire.prototype.getTheme = function() {
            var lGenreTheme = this.getGenreTheme();
            var lClass = '';
            switch (lGenreTheme) {
                case '0':
                    lClass = 'ThemeButterfly';
                    break;
                case '1':
                    lClass = 'ThemeNotebook';
                    break;
                case '2':
                    lClass = 'ThemeSchool';
                    break;
            }
            return 'AvecThemeFond ' + (lClass || 'ThemeSchool');
        };
        ObjetThemesPrimaire.prototype.getGenreTheme = function() {
            var T = new RegExp('[?&]' + 'theme' + '=([^&#]*)').exec(window.location.href);
            return T ? T[1] : '2';
        };
        module.exports.GThemesPrimaire = new ObjetThemesPrimaire();
    },
    fn: "themesprimaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreRepas = {
            Midi: 0,
            Soir: 1
        };
        module.exports = EGenreRepas;
    },
    fn: "enumere_repas.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreSanction = {
            Avertissement: 0,
            Blame: 1,
            ExclusionTemporaireEtablissement: 2,
            ExclusionTemporaireClasse: 3,
            ExclusionDefinitive: 4,
            Autre_Exclusion: 5,
            ExclusionInternat: 6,
            ExclusionDP: 7,
            Autre_Sanction: 8,
            Responsabilisation: 9,
            MesureConservatoire: 10
        };
        EGenreSanction.getSanctionsDansLOrdre = function() {
            return [EGenreSanction.ExclusionDefinitive, EGenreSanction.ExclusionTemporaireEtablissement, EGenreSanction.ExclusionTemporaireClasse, EGenreSanction.ExclusionDP, EGenreSanction.ExclusionInternat, EGenreSanction.Autre_Exclusion, EGenreSanction.Responsabilisation, EGenreSanction.Avertissement, EGenreSanction.Blame, EGenreSanction.Autre_Sanction];
        };
        EGenreSanction.estUneExclusion = function(aGenre) {
            switch (aGenre) {
                case EGenreSanction.ExclusionDP:
                case EGenreSanction.ExclusionDefinitive:
                case EGenreSanction.ExclusionInternat:
                case EGenreSanction.ExclusionTemporaireClasse:
                case EGenreSanction.ExclusionTemporaireEtablissement:
                case EGenreSanction.Autre_Exclusion:
                    return true;
            }
            return false;
        };
        EGenreSanction.estUneExclusionTemporaire = function(aGenre) {
            switch (aGenre) {
                case EGenreSanction.ExclusionDP:
                case EGenreSanction.ExclusionInternat:
                case EGenreSanction.ExclusionTemporaireClasse:
                case EGenreSanction.ExclusionTemporaireEtablissement:
                case EGenreSanction.Autre_Exclusion:
                    return true;
            }
            return false;
        };
        module.exports = EGenreSanction;
    },
    fn: "enumere_sanction.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreIndividuAuteur = {
            GIA_Administratif: 0,
            GIA_Inspecteur: 1,
            GIA_Personnel: 2,
            GIA_Professeur: 3,
            GIA_ProfesseurHistorique: 4,
            GIA_PersonnelHistorique: 5,
            GIA_MaitreDeStage: 6,
            GIA_Responsable: 7,
            GIA_Eleve: 8,
            GIA_Utilisateur: 9,
            GIA_ResponsablePostulant: 10
        };
        module.exports.TypeGenreIndividuAuteur = TypeGenreIndividuAuteur;
    },
    fn: "typegenreindividuauteur.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypePerimetreMesureConservatoire = {
            PMC_Internat: 0,
            PMC_Externat: 1,
            PMC_DP: 2
        };
        module.exports.TypePerimetreMesureConservatoire = TypePerimetreMesureConservatoire;
    },
    fn: "typeperimetremesureconservatoire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('espace/css/ObjetFichePresenceStyle.css');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var GStyle = require('GStyle.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var TUtilitaireDuree = require('UtilitaireDuree.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRepas = require('Enumere_Repas.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var EGenreSanction = require('Enumere_Sanction.js');
        var TypeGenreIndividuAuteur = require('TypeGenreIndividuAuteur.js').TypeGenreIndividuAuteur;
        var TypeGenreObservationVS = require('TypeGenreObservationVS.js').TypeGenreObservationVS;
        var TypeGenrePunition = require('TypeGenrePunition.js').TypeGenrePunition;
        var TypePerimetreMesureConservatoire = require('TypePerimetreMesureConservatoire.js').TypePerimetreMesureConservatoire;

        function ObjetUtilitaireAbsence() {
            this.maxLengthCommentaire = 200;
        }
        ObjetUtilitaireAbsence.prototype.getChaineTraductionGenreAbsenceTitre = function(aObjet) {
            if (!!aObjet.aucun) {
                switch (aObjet.genre) {
                    case EGenreRessource.ObservationProfesseurEleve:
                        switch (aObjet.genreObservation) {
                            case TypeGenreObservationVS.OVS_ObservationParent:
                                return GTraductions.getValeur('AbsenceVS.aucuneObservation');
                            case TypeGenreObservationVS.OVS_Encouragement:
                                return GTraductions.getValeur('AbsenceVS.aucunEncouragement');
                            case TypeGenreObservationVS.OVS_DefautCarnet:
                                return GTraductions.getValeur('AbsenceVS.aucunDefautCarnet');
                            case TypeGenreObservationVS.OVS_Autres:
                                return GTraductions.getValeur('AbsenceVS.aucuneAutreObservation');
                            default:
                                ;
                                return '';
                        }
                        case EGenreRessource.Absence:
                            return GTraductions.getValeur('AbsenceVS.aucuneAbsence');
                        case EGenreRessource.AbsenceRepas:
                            return GTraductions.getValeur('AbsenceVS.aucuneAbsenceRepas');
                        case EGenreRessource.AbsenceInternat:
                            return GTraductions.getValeur('AbsenceVS.aucuneAbsenceInternat');
                        case EGenreRessource.Retard:
                            return GTraductions.getValeur('AbsenceVS.aucunRetard');
                        case EGenreRessource.Infirmerie:
                            return GTraductions.getValeur('AbsenceVS.aucunInfirmerie');
                        case EGenreRessource.Incident:
                            return GTraductions.getValeur('AbsenceVS.aucunIncident');
                        case EGenreRessource.Punition:
                            return GTraductions.getValeur('AbsenceVS.aucunePunition');
                        case EGenreRessource.Sanction:
                            return GTraductions.getValeur('AbsenceVS.aucuneSanction');
                        case EGenreRessource.MesureConservatoire:
                            return GTraductions.getValeur('AbsenceVS.aucuneMesure');
                        default:
                            ;
                            return '';
                }
            } else {
                switch (aObjet.genre) {
                    case EGenreRessource.ObservationProfesseurEleve:
                        if (aObjet.genreObservation !== undefined) {
                            switch (aObjet.genreObservation) {
                                case TypeGenreObservationVS.OVS_ObservationParent:
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.observation') : GTraductions.getValeur('AbsenceVS.observations');
                                case TypeGenreObservationVS.OVS_Encouragement:
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.encouragement') : GTraductions.getValeur('AbsenceVS.encouragements');
                                case TypeGenreObservationVS.OVS_DefautCarnet:
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.defautDeCarnet') : GTraductions.getValeur('AbsenceVS.defautsDeCarnet');
                                case TypeGenreObservationVS.OVS_Autres:
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.autreObservation') : GTraductions.getValeur('AbsenceVS.autresObservations');
                                default:
                                    ;
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.observation') : GTraductions.getValeur('AbsenceVS.observations');
                            }
                        }
                        if (aObjet.estLue === undefined) {
                            return GTraductions.getValeur('AbsenceVS.observation');
                        }
                        if (aObjet.estLue) {
                            return GTraductions.getValeur('AbsenceVS.observationLue');
                        } else {
                            return GTraductions.getValeur('AbsenceVS.observationNonLue');
                        }
                        case EGenreRessource.Absence:
                            if (aObjet.justifie === undefined) {
                                return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceEnCours') : GTraductions.getValeur('AbsenceVS.absencesEnCours');
                            } else if (aObjet.justifie) {
                                return GTraductions.getValeur('AbsenceVS.absencesRecapJust');
                            } else {
                                return GTraductions.getValeur('AbsenceVS.absencesRecapNonJust');
                            }
                            case EGenreRessource.AbsenceRepas:
                                return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceRepas') : GTraductions.getValeur('AbsenceVS.absencesRepas');
                            case EGenreRessource.AbsenceInternat:
                                return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceInternat') : GTraductions.getValeur('AbsenceVS.absencesInternat');
                            case EGenreRessource.Retard:
                                return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.retard') : GTraductions.getValeur('AbsenceVS.retards');
                            case EGenreRessource.Infirmerie:
                                return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.infirmerie') : GTraductions.getValeur('AbsenceVS.infirmeries');
                            case EGenreRessource.Exclusion:
                                return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.exclusion') : GTraductions.getValeur('AbsenceVS.exclusions');
                            case EGenreRessource.Punition:
                                if (aObjet.estLIncident) {
                                    return GTraductions.getValeur('AbsenceVS.incidentPunition');
                                }
                                if (aObjet.genreNature === undefined) {
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.punition') : GTraductions.getValeur('AbsenceVS.punitions');
                                }
                                switch (aObjet.genreNature) {
                                    case TypeGenrePunition.GP_ExclusionCours:
                                        return GTraductions.getValeur('AbsenceVS.exclusion');
                                    case TypeGenrePunition.GP_Retenues:
                                        return GTraductions.getValeur('AbsenceVS.retenue');
                                    case TypeGenrePunition.GP_Devoir:
                                        return GTraductions.getValeur('AbsenceVS.devoirSuppl');
                                    case TypeGenrePunition.GP_Autre:
                                        return GTraductions.getValeur('AbsenceVS.punitionAutre');
                                    default:
                                        ;
                                        return '';
                                }
                                case EGenreRessource.MesureConservatoire:
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.mesureConservatoire') : GTraductions.getValeur('AbsenceVS.mesuresConservatoires');
                                case EGenreRessource.Sanction:
                                    if (!aObjet.libelle && !aObjet.genreNature) {
                                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.sanction') : GTraductions.getValeur('AbsenceVS.sanctions');
                                    }
                                    return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.sanction') : GTraductions.getValeur('AbsenceVS.sanctions');
                                case EGenreRessource.Incident:
                                    if (!aObjet.genreNature) {
                                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.incident') : GTraductions.getValeur('AbsenceVS.incidents');
                                    }
                                    switch (aObjet.genreNature) {
                                        case EGenreRessource.Punition:
                                            return GTraductions.getValeur('AbsenceVS.LieAPunition');
                                        case EGenreRessource.Sanction:
                                            return GTraductions.getValeur('AbsenceVS.LieASanction');
                                        case EGenreRessource.MesureConservatoire:
                                            return GTraductions.getValeur('AbsenceVS.LieAMesureConservatoire');
                                        case EGenreRessource.Aucune:
                                            return GTraductions.getValeur('AbsenceVS.SansMesureDiciplinaire');
                                        default:
                                            ;
                                            return '';
                                    }
                                    default:
                                        ;
                                        return '';
                }
            }
        };
        ObjetUtilitaireAbsence.prototype.getSaisieObservation = function(aObservation, aCallBack, aID, aSansLabel) {
            var H = [];
            var lLibelle = '';
            switch (aObservation.genreObservation) {
                case TypeGenreObservationVS.OVS_DefautCarnet:
                    lLibelle = GTraductions.getValeur('AbsenceVS.titres.prisConnaissance');
                    break;
                case TypeGenreObservationVS.OVS_Autres:
                    if (aObservation.avecARObservation) {
                        lLibelle = GTraductions.getValeur('AbsenceVS.titres.prisConnaissance');
                    } else {
                        lLibelle = '';
                    }
                    break;
                case TypeGenreObservationVS.OVS_ObservationParent:
                    lLibelle = GTraductions.getValeur('AbsenceVS.prisConnaissanceObservation');
                    break;
                case TypeGenreObservationVS.OVS_Encouragement:
                    lLibelle = GTraductions.getValeur('AbsenceVS.prisConnaissanceEncouragement');
                    break;
                default:
                    lLibelle = '';
            }
            if (aSansLabel) {
                H.push('<ie-checkbox type="checkbox" id="', aID, '" onclick="', aCallBack, '" ', (aObservation.estLue ? 'checked disabled ' : ''), '></ie-checkbox>');
            } else {
                H.push('<div class="EspaceGauche">', '<ie-checkbox id="', aID, '" onclick="', aCallBack, '" ', (aObservation.estLue ? 'checked disabled ' : ''), '>', lLibelle, '</ie-checkbox>', '</div>');
            }
            return H.join('');
        };
        ObjetUtilitaireAbsence.prototype.getARdePunition = function(aAbsence, aCallBack, aID) {
            var H = [];
            H.push('<div class="EspaceGauche">', '<ie-checkbox id="', aID, '" onclick="', aCallBack, '" ', (aAbsence.parentAAccuseDeReception ? 'checked disabled ' : ''), '/>', GTraductions.getValeur('AbsenceVS.accuseDeReception'), '</ie-checkbox>', '</div>');
            return H.join('');
        };
        ObjetUtilitaireAbsence.prototype.getInfoAbsenceAccessible = function(aAbsence) {
            var H = [];
            switch (aAbsence.Genre) {
                case EGenreRessource.ObservationProfesseurEleve:
                    H.push(this.getMatiere(aAbsence, false, true));
                    H.push(this.getCommentaire(aAbsence, false, false));
                    break;
                case EGenreRessource.Absence:
                    H.push(this.getHeuresCoursManquees(aAbsence));
                    break;
                case EGenreRessource.AbsenceRepas:
                    break;
                case EGenreRessource.AbsenceInternat:
                    break;
                case EGenreRessource.Retard:
                    break;
                case EGenreRessource.Infirmerie:
                    H.push(this.getSymptomesMedicaux(aAbsence, true, false));
                    H.push(this.getActesMedicaux(aAbsence, true, false));
                    break;
                case EGenreRessource.Exclusion:
                case EGenreRessource.Punition:
                case EGenreRessource.Sanction:
                case EGenreRessource.Incident:
                case EGenreRessource.MesureConservatoire:
                    for (var I = 0; I < aAbsence.listeMotifs.GetNbrElements(); I++) {
                        H.push('<span>', aAbsence.listeMotifs.GetLibelle(I), '</span><br>');
                    }
                    if (aAbsence.circonstances) {
                        H.push('<span>', aAbsence.circonstances, '</span><br>');
                    }
                    if (aAbsence.travailAFaire) {
                        H.push('<span>', GTraductions.getValeur('AbsenceVS.travailAFaire'), ' : ', aAbsence.travailAFaire, '</span><br>');
                    }
                    var lIndividu = this.getDemandeurDecideur(aAbsence);
                    if (lIndividu) {
                        H.push('<span>', lIndividu, '</span><br>');
                    }
                    break;
                default:
                    break;
            }
            return H.join('');
        };
        ObjetUtilitaireAbsence.prototype.getMotifAbsence = function(aObjet) {
            var lTitle = '';
            var lResult = '';
            var lMotif = '';
            if (aObjet.donnee.reglee || (aObjet.donnee.listeMotifs && aObjet.donnee.listeMotifs.GetNbrElements() > 0)) {
                if (this.estEspaceParent() && aObjet.donnee.message && aObjet.enListe) {
                    lTitle = 'ie-hint="' + (aObjet.donnee.message.replace ? aObjet.donnee.message.replace(/\n/g, '<br />') : aObjet.donnee.message) + '"';
                }
                lMotif = aObjet.donnee.listeMotifs.getTableauLibelles().join(', ');
                if (aObjet.donnee.reglee && aObjet.donnee.listeMotifs.GetNbrElements() === 0) {
                    lMotif = GTraductions.getValeur('AbsenceVS.sansMotif').ucfirst();
                }
                if ((aObjet.donnee.GetGenre() === EGenreRessource.Absence || aObjet.donnee.GetGenre() === EGenreRessource.Retard) && !aObjet.donnee.justifie) {
                    if (lMotif) {
                        lMotif += ' (' + GTraductions.getValeur('AbsenceVS.sansRaisonValable') + ')';
                    } else {
                        lMotif = GTraductions.getValeur('AbsenceVS.sansRaisonValable').ucfirst();
                    }
                }
                lResult = !aObjet.enListe || (aObjet.editable === false) ? lMotif : '<div class="PetitEspace' + (lTitle && aObjet.classe ? ' ' + aObjet.classe : '') + '" ' + lTitle + '>' + lMotif + '</div>';
                if (!aObjet.enListe && aObjet.donnee.message && this.estEspaceParent()) {
                    lResult += '<div class="Texte10 Italique EspaceHaut">' + aObjet.donnee.message + '</div>';
                }
                return lResult;
            }
            if (!this.estEspaceParent() || !MethodesTableau.existe(aObjet.donnee.GetGenre(), [EGenreRessource.Absence, EGenreRessource.Retard])) {
                return '';
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getCommentaireMotifAbsence = function(aObjet) {
            if (!this.estEspaceParent() || !MethodesTableau.existe(aObjet.donnee.GetGenre(), [EGenreRessource.Absence, EGenreRessource.Retard])) {
                return '';
            }
            var lResult = '';
            if (aObjet.donnee.reglee || aObjet.donnee.listeMotifs.GetNbrElements() > 0) {
                if (!aObjet.enListe || aObjet.donnee.message) {
                    return '';
                }
                lResult = '<div class="PetitEspace">' + aObjet.donnee.justification + '</div>';
                return lResult;
            }
            var lValue = '';
            if (!aObjet.enListe) {
                lResult += '<div class="Texte10">' + GTraductions.getValeur('AbsenceVS.saisissezCommentaire', [this.maxLengthCommentaire]).ucfirst() + '&nbsp;:</div>';
            }
            var lStyle = !aObjet.enListe ? GStyle.composeHeight(90) : 'padding:3px;';
            if (aObjet.donnee.justification) {
                lValue = aObjet.donnee.justification;
            }
            if (!aObjet.enListe) {
                lResult += '<div><textarea class="Texte10" maxlength="' + this.maxLengthCommentaire + '" id="' + aObjet.id + '" style="line-height:14px; ' + GStyle.composeWidth(aObjet.width ? aObjet.width : 100, aObjet.width ? 'px' : '%') + GStyle.composeCouleurBordure(GCouleur.bordure, 1) + lStyle + '" onfocus="$(this).one(\'mouseup\',function(){$(this).select();return false;}).select();" onkeyup="' + aObjet.callback + '" onchange="' + aObjet.callback + '">' + lValue + '</textarea></div>';
            } else if (aObjet.editable !== false) {
                lResult += '<div><input class="Texte10" maxlength="' + this.maxLengthCommentaire + '" type="text" id="' + aObjet.id + '" style="line-height:14px; ' + GStyle.composeWidth(aObjet.width ? aObjet.width : 100, aObjet.width ? 'px' : '%') + GStyle.composeCouleurBordure(GCouleur.bordure, 1) + lStyle + '" onfocus="$(this).one(\'mouseup\',function(){$(this).select();return false;}).select();" onkeyup="' + aObjet.callback + '" onchange="' + aObjet.callback + '" value="' + lValue + '" /></div>';
            }
            if (aObjet.donnee.message && this.estEspaceParent() && !aObjet.enListe && !aObjet.donnee.reglee && aObjet.donnee.listeMotifs.GetNbrElements() === 0) {
                lResult += '<div class="Texte10 Italique EspaceHaut">' + aObjet.donnee.message + '</div>';
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getHeuresCoursManquees = function(aElement, aSansSpan) {
            if (!aElement.NbrHeures || aElement.NbrHeures === '0h00') {
                return '';
            }
            var lTrad = '';
            if (parseInt(aElement.NbrHeures.charAt(0)) < 2) {
                lTrad = GTraductions.getValeur('AbsenceVS.heureCoursManque', [aElement.NbrHeures]);
            } else {
                lTrad = GTraductions.getValeur('AbsenceVS.heuresCoursManquees', [aElement.NbrHeures]);
            }
            if (aSansSpan) {
                return lTrad;
            }
            return '<span>' + lTrad + '</span><br>';
        };
        ObjetUtilitaireAbsence.prototype.getHeuresCoursManqueesBulletin = function(aElement) {
            if (!aElement.nbrHeures || aElement.nbrHeures === '0h00') {
                return '';
            }
            var lTrad = '';
            var lArray = aElement.nbrHeures.split('h');
            if (parseInt(lArray[0]) < 2) {
                lTrad = GTraductions.getValeur('AbsenceVS.heureCoursManque', [aElement.nbrHeures]);
            } else {
                lTrad = GTraductions.getValeur('AbsenceVS.heuresCoursManquees', [aElement.nbrHeures]);
            }
            return lTrad;
        };
        ObjetUtilitaireAbsence.prototype.getXAbsencesNonJustifiees = function(aNombreAbsencesNonJustifiees) {
            if ($.isNumeric(aNombreAbsencesNonJustifiees) && aNombreAbsencesNonJustifiees > 0) {
                return GTraductions.getValeur('AbsenceVS.absenceNonjustifiees', [aNombreAbsencesNonJustifiees]);
            }
            return '';
        };
        ObjetUtilitaireAbsence.prototype.getDontXObservationsNonLu = function(aNombreNonLu) {
            if ($.isNumeric(aNombreNonLu) && aNombreNonLu > 0) {
                return GTraductions.getValeur('AbsenceVS.obs_Encouragements_NonLus', [aNombreNonLu]);
            }
            return '';
        };
        ObjetUtilitaireAbsence.prototype.getDontXRetardNonJustifies = function(aNombreRetardsNonJustifies) {
            if ($.isNumeric(aNombreRetardsNonJustifies) && aNombreRetardsNonJustifies > 0) {
                return GTraductions.getValeur('AbsenceVS.retardNonjustifies', [aNombreRetardsNonJustifies]);
            }
            return '';
        };
        ObjetUtilitaireAbsence.prototype.getDontXNonJustifiees = function(aNombreAbsencesNonJustifiees) {
            if ($.isNumeric(aNombreAbsencesNonJustifiees) && aNombreAbsencesNonJustifiees > 0) {
                if (aNombreAbsencesNonJustifiees === 1) {
                    return GTraductions.getValeur('AbsenceVS.Dont1AbsenceNonJustifiee', [aNombreAbsencesNonJustifiees]);
                } else {
                    return GTraductions.getValeur('AbsenceVS.DontXAbsenceNonJustifiee', [aNombreAbsencesNonJustifiees]);
                }
            }
            return '';
        };
        ObjetUtilitaireAbsence.prototype.getDemiJourneesBulletin = function(aElement) {
            if (!$.isNumeric(aElement.nombreDemiJournees) || aElement.nombreDemiJournees <= 0) {
                return '';
            }
            var lResult = '';
            var lTraduction = aElement.nombreDemiJournees > 1 ? 'demiJournees' : 'demiJournee';
            lResult = GTraductions.getValeur('AbsenceVS.' + lTraduction, [aElement.nombreDemiJournees]);
            if ($.isNumeric(aElement.nombreDemiJourneesNonJustifies) && aElement.nombreDemiJourneesNonJustifies > 0) {
                lResult += ' (' + this.getDontXNonJustifiees(aElement.nombreDemiJourneesNonJustifies) + ')';
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getDemiJourneesNonJustifiesBulletin = function(aElement) {
            if (!$.isNumeric(aElement.nombreDemiJourneesNonJustifies) || aElement.nombreDemiJourneesNonJustifies <= 0) {
                return '';
            }
            var lTraduction = aElement.nombreDemiJournees > 1 ? 'demiJourneesNJ' : 'demiJourneeNJ';
            return GTraductions.getValeur('AbsenceVS.' + lTraduction, [aElement.nombreDemiJournees]);
        };
        ObjetUtilitaireAbsence.prototype.getDemiJournees = function(aElement, aSansSpan) {
            if (!$.isNumeric(aElement.NbrJours) || aElement.NbrJours <= 0) {
                return '';
            }
            var lTraduction = aElement.NbrJours > 1 ? 'demiJournees' : 'demiJournee';
            if (aSansSpan) {
                return GTraductions.getValeur('AbsenceVS.' + lTraduction, [aElement.NbrJours]);
            }
            return '<span>' + GTraductions.getValeur('AbsenceVS.' + lTraduction, [aElement.NbrJours]) + '</span><br>';
        };
        ObjetUtilitaireAbsence.prototype.getSymptomesMedicaux = function(aElement, aAvecLibelle, aSansSpan) {
            if (!aElement.symptomesMedicaux) {
                return '';
            }
            var lResult = (aAvecLibelle ? GTraductions.getValeur('AbsenceVS.titres.symptMedicaux').ucfirst() + ' : ' : '') + aElement.symptomesMedicaux.getTableauLibelles().join(', ');
            if (aSansSpan) {
                return lResult;
            }
            return '<span>' + lResult + '</span><br>';
        };
        ObjetUtilitaireAbsence.prototype.getActesMedicaux = function(aElement, aAvecLibelle, aSansSpan) {
            if (!aElement.symptomesMedicaux) {
                return '';
            }
            var lResult = (aAvecLibelle ? GTraductions.getValeur('AbsenceVS.titres.actesMedicaux').ucfirst() + ' : ' : '') + aElement.actesMedicaux.getTableauLibelles().join(', ');
            if (aSansSpan) {
                return lResult;
            }
            return '<span>' + lResult + '</span><br>';
        };
        ObjetUtilitaireAbsence.prototype.getMatiere = function(aElement, aSansSpan, aSansDate) {
            if (!aElement.matiere || !aElement.matiere.existeNumero()) {
                return '';
            }
            var lResult = aElement.matiere.GetLibelle();
            if (aElement.dateDebut && (aElement.dateDebut.getHours() !== 0) && !aSansDate) {
                lResult += ' ' + GTraductions.getValeur('Dates.AHeure', [GDate.FormatDate(aElement.dateDebut, '%xh%sh%mm')]) + ' ';
            }
            if (aSansSpan) {
                return lResult;
            }
            return '<span>' + lResult + '</span><br>';
        };
        ObjetUtilitaireAbsence.prototype.getCommentaire = function(aElement, aAvecLibelle, aSansSpan) {
            if (!aElement.commentaire) {
                return '';
            }
            var lResult = (aAvecLibelle ? GTraductions.getValeur('AbsenceVS.titres.observation').ucfirst() + ' : ' : '') + aElement.commentaire;
            if (aSansSpan) {
                return lResult;
            }
            return '<span>' + lResult + '</span><br>';
        };
        ObjetUtilitaireAbsence.prototype.getCirconstances = function(aElement) {
            var lCirconstance = '';
            if (!!aElement.circonstances) {
                lCirconstance = aElement.circonstances;
            }
            var lCirconstanceDoc = [];
            if (!!aElement.documentsCirconstances) {
                aElement.documentsCirconstances.parcourir(function(D) {
                    lCirconstanceDoc.push(GChaine.composerUrlLienExterne({
                        documentJoint: D,
                        genreRessource: EGenreRessource.DocJointEleve
                    }));
                });
            }
            return lCirconstance + (!!lCirconstance && !!lCirconstanceDoc.length ? '<br>' : '') + lCirconstanceDoc.join(', ');
        };
        ObjetUtilitaireAbsence.prototype.getDemandeurDecideur = function(aElement, aAvecTitre, aAvecDate) {
            var lResult = '';
            if (aElement.GetGenre() === EGenreRessource.ObservationProfesseurEleve) {
                if (aAvecTitre) {
                    lResult = GTraductions.getValeur('AbsenceVS.titres.saisiepar') + ' ';
                }
                return '<div class="AlignementHaut InlineBlock">' + lResult + aElement.demandeur.GetLibelle() + '&nbsp;</div>';
            }
            var lStrTraduction = 'decidePar';
            var lDate = '';
            if (aAvecDate) {
                lStrTraduction = 'decideLePar';
                lDate = GDate.FormatDate(aElement.dateDebut, '%J %MMM');
            }
            var lIndividu = null;
            if (aElement.GetGenre() === EGenreRessource.Punition) {
                if (aAvecDate) {
                    lStrTraduction = 'demandeeLePar';
                    lDate = GDate.FormatDate(aElement.dateDemande, '%J %MMM');
                } else {
                    lStrTraduction = 'demandePar';
                }
                lIndividu = aElement.demandeur;
            } else if (aElement.GetGenre() === EGenreRessource.Incident) {
                lIndividu = aElement.rapporteur;
            } else {
                lIndividu = aElement.decideur;
            }
            if (!lIndividu || !lIndividu.existeNumero()) {
                return lResult;
            }
            lResult += lIndividu.GetLibelle();
            if (lIndividu.GetGenre() !== TypeGenreIndividuAuteur.GIA_Personnel) {
                lResult += ' (' + GTraductions.getValeur('AbsenceVS.titres.professeur').ucfirst() + ')';
            }
            if (aAvecTitre && lResult) {
                if (aAvecDate) {
                    lResult = GTraductions.getValeur('AbsenceVS.' + lStrTraduction, [lDate, lResult]);
                } else {
                    lResult = GTraductions.getValeur('AbsenceVS.' + lStrTraduction, [lResult]);
                }
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getDate = function(aElement, aAvecChaineAujourdhui, aSansDate) {
            var lEstJourEgal = !(aElement.dateDebut && aElement.dateFin) || GDate.estJourEgal(aElement.dateDebut, aElement.dateFin);
            var lSansDate = (aSansDate === true) && lEstJourEgal;
            var lDateDebut = !!aElement.dateDebut ? GDate.FormatDate(aElement.dateDebut, lEstJourEgal ? aAvecChaineAujourdhui ? '[' + GTraductions.getValeur('Dates.LeDate', ['%J %MMM']) + ']' : GTraductions.getValeur('Dates.LeDate', ['%J %MMM']) : (aElement.ouverte ? GTraductions.getValeur('Dates.LeDate', ['%J %MMM']) : GTraductions.getValeur('Dates.DuDate', ['%J %MMM']))) : '';
            var lDateFin = !!aElement.dateFin ? GDate.FormatDate(aElement.dateFin, '%J %MMM') : '';
            var lHeureDebut = !!aElement.dateDebut ? GDate.FormatDate(aElement.dateDebut, '%xh%sh%mm') : '';
            var lHeureFin = !!aElement.dateFin ? GDate.FormatDate(aElement.dateFin, '%xh%sh%mm') : '';
            var lPlace = aElement.place;
            if (aElement.GetGenre() === EGenreRessource.MesureConservatoire) {
                var lHeureDebutMesureConservatoire = GDate.PlaceParJourEnDate(aElement.placeDebutMesureConservatoire);
                lHeureDebut = GDate.FormatDate(lHeureDebutMesureConservatoire, '%xh%sh%mm');
            }
            switch (aElement.GetGenre()) {
                case EGenreRessource.AbsenceRepas:
                    return lDateDebut + ' ' + (aElement.genreRepas === EGenreRepas.Midi ? GTraductions.getValeur('AbsenceVS.amidi') : GTraductions.getValeur('AbsenceVS.ausoir'));
                case EGenreRessource.ObservationProfesseurEleve:
                    if (aElement.dateDebut.getHours() === 0) {
                        return lDateDebut;
                    } else {
                        return GTraductions.getValeur('Dates.DateDebutAHeureDebut', [lDateDebut, lHeureDebut]);
                    }
                    case EGenreRessource.Infirmerie:
                    case EGenreRessource.Absence:
                        if (aElement.ouverte) {
                            return GTraductions.getValeur('Dates.DepuisDateAHeure', [lDateDebut, lHeureDebut]);
                        }
                        if (lEstJourEgal) {
                            return (lSansDate ? '' : lDateDebut + ' ') + GTraductions.getValeur('Dates.DeHeureDebutAHeureFin', [lHeureDebut, lHeureFin]);
                        }
                        return GTraductions.getValeur('Dates.DateDebutAHeureDebutAuDateFinAHeureFin', [lDateDebut, lHeureDebut, lDateFin, lHeureFin]);
                    case EGenreRessource.Incident:
                    case EGenreRessource.Retard:
                        if (lSansDate) {
                            return GTraductions.getValeur('Dates.AHeure', [lHeureDebut]);
                        } else {
                            return GTraductions.getValeur('Dates.DateDebutAHeureDebut', [lDateDebut, lHeureDebut]);
                        }
                        case EGenreRessource.Punition:
                            var lResult = '';
                            lPlace = aElement.placeDemande;
                            if (aElement.horsCours) {
                                lPlace = null;
                            }
                            var lFormatDate = GTraductions.getValeur('Dates.LeDate', ['%J %MMM']);
                            if (aAvecChaineAujourdhui !== false) {
                                lFormatDate = '[' + lFormatDate + ']';
                            }
                            lDateDebut = GDate.FormatDate(aElement.dateDemande, lFormatDate);
                            if ((lPlace !== null && lPlace !== undefined)) {
                                var lDate = GDate.PlaceAnnuelleEnDate(lPlace);
                                if (lDate && GDate.estDateValide(lDate) && GDate.estJourEgal(lDate, aElement.dateDemande)) {
                                    lResult = GTraductions.getValeur('Dates.DateDebutAHeureDebut', [lDateDebut, GDate.FormatDate(lDate, '%xh%sh%mm')]) + ' ';
                                } else {
                                    lResult = lDateDebut;
                                }
                            } else {
                                lResult = lDateDebut;
                            }
                            return lResult;
                        case EGenreRessource.AbsenceInternat:
                        case EGenreRessource.Sanction:
                            if (lEstJourEgal) {
                                return lDateDebut;
                            }
                            return GTraductions.getValeur('Dates.DateDebutAuDateFin', [lDateDebut, lDateFin]);
                        case EGenreRessource.MesureConservatoire:
                            if (lEstJourEgal) {
                                return lDateDebut;
                            }
                            return GTraductions.getValeur('Dates.DateDebutAHeureDebutAuDateFin', [lDateDebut, lHeureDebut, lDateFin]);
                        default:
                            return '';
            }
        };
        ObjetUtilitaireAbsence.prototype.getDureeDAbsence = function(aAbsence) {
            if (aAbsence.Genre === EGenreRessource.Retard) {
                return aAbsence.duree;
            } else {
                if (MethodesObjet.isString(aAbsence.duree)) {
                    return aAbsence.duree;
                }
                if (MethodesObjet.isDate(aAbsence.duree)) {
                    return GDate.FormatDate(aAbsence.duree, '%xh%sh%mm ');
                }
                if (MethodesObjet.isNumber(aAbsence.duree)) {
                    return GDate.FormatDureeEnMillisecondes(TUtilitaireDuree.minEnMs(aAbsence.duree));
                }
            }
            return aAbsence.duree;
        };
        ObjetUtilitaireAbsence.prototype.getDureeSanction = function(aAbsence) {
            var H = [];
            var lNombre = 0;
            var lTraduction = '';
            if (EGenreSanction.estUneExclusionTemporaire(aAbsence.nature.GetGenre())) {
                lNombre = aAbsence.duree;
                lTraduction = (aAbsence.nature.GetGenre() === EGenreSanction.ExclusionInternat) ? (lNombre > 1 ? GTraductions.getValeur('AbsenceVS.nuits') : GTraductions.getValeur('AbsenceVS.nuit')) : (lNombre > 1 ? GTraductions.getValeur('AbsenceVS.jours') : GTraductions.getValeur('AbsenceVS.jour'));
                H.push('&nbsp;', lNombre, '&nbsp;', GTraductions.getValeur('AbsenceVS.' + lTraduction));
                if (aAbsence.estDemiJournee) {
                    H.push(' (' + (aAbsence.estMatin ? GTraductions.getValeur('AbsenceVS.matin') : GTraductions.getValeur('AbsenceVS.apresMidi')) + ')');
                }
                if (aAbsence.avecSursis) {
                    if (aAbsence.dureeSursis > 0) {
                        H.push(' ', GTraductions.getValeur('AbsenceVS.dont'), ' ', aAbsence.dureeSursis, ' ', GTraductions.getValeur('AbsenceVS.avecSursis'));
                        if (aAbsence.dateFinSursis) {
                            H.push(GDate.FormatDate(aAbsence.dateFinSursis, ' ' + GTraductions.getValeur('jusquAu') + ' %J %MMM'));
                        }
                    } else {
                        H.push(' ', GTraductions.getValeur('AbsenceVS.avecSursis'));
                    }
                }
            } else if (aAbsence.nature.GetGenre() === EGenreSanction.Responsabilisation) {
                lNombre = aAbsence.duree;
                lTraduction = (lNombre > 1 ? GTraductions.getValeur('Heures').toLowerCase() : GTraductions.getValeur('Heure').toLowerCase());
                H.push('&nbsp;', lNombre, '&nbsp;', GTraductions.getValeur('AbsenceVS.' + lTraduction));
            } else if (aAbsence.nature.GetGenre() === EGenreSanction.ExclusionDefinitive) {
                if (aAbsence.avecSursis) {
                    H.push(' (', GTraductions.getValeur('AbsenceVS.avecSursis'));
                    if (aAbsence.dateFinSursis) {
                        H.push(GDate.FormatDate(aAbsence.dateFinSursis, ' ' + GTraductions.getValeur('jusquAu') + ' %J %MMM'));
                    }
                    H.push(')');
                }
            }
            return H.join('');
        };
        ObjetUtilitaireAbsence.prototype.getModalitesPunitionSanction = function(aAbsence) {
            var lResult = '';
            switch (aAbsence.Genre) {
                case EGenreRessource.Exclusion:
                case EGenreRessource.Punition:
                    if (aAbsence.nature && aAbsence.nature.GetLibelle()) {
                        lResult += aAbsence.nature.GetLibelle();
                    } else {
                        lResult += GTraductions.getValeur('AbsenceVS.punition');
                    }
                    if (aAbsence.programmation && (aAbsence.programmation.GetNbrElements() > 0)) {
                        lResult += ' ' + (aAbsence.nature.GetGenre() === TypeGenrePunition.GP_Devoir ? GTraductions.getValeur('AbsenceVS.aRendreLe') : GTraductions.getValeur('Le'));
                        var lArray = [];
                        for (var I = 0; I < aAbsence.programmation.GetNbrElements(); I++) {
                            var lProg = aAbsence.programmation.GetElement(I);
                            var lTemp = GDate.FormatDate(lProg.date, ' %J %MMM');
                            var lDate = $.isNumeric(lProg.place) ? (aAbsence.Genre === EGenreRessource.Punition) && aAbsence.nature && (aAbsence.nature.GetGenre() !== TypeGenrePunition.GP_ExclusionCours) ? GDate.PlaceParJourEnDate(lProg.place) : GDate.PlaceAnnuelleEnDate(lProg.place) : '';
                            if (lDate && GDate.estDateValide(lDate)) {
                                lTemp += ' ' + GTraductions.getValeur('Dates.AHeure', [GDate.FormatDate(lDate, '%xh%sh%mm')]) + ' ';
                            }
                            if (lProg.duree) {
                                if (lProg.placeExecution !== undefined && lProg.placeExecution !== null) {
                                    var lExecution = GDate.PlaceParJourEnDate(lProg.placeExecution);
                                    if (lExecution && GDate.estDateValide(lExecution)) {
                                        lTemp += ' ' + GTraductions.getValeur('Dates.AHeure', [GDate.FormatDate(lExecution, '%xh%sh%mm')]) + ' ';
                                    }
                                }
                                lTemp += ' - ' + GDate.FormatDureeEnMillisecondes(TUtilitaireDuree.minEnMs(lProg.duree));
                            }
                            lArray.push(lTemp);
                        }
                        lResult += lArray.join(',');
                    } else if (aAbsence.estProgrammable) {
                        lResult += ' - ' + GTraductions.getValeur('AbsenceVS.nonProgramme');
                    }
                    break;
                case EGenreRessource.MesureConservatoire:
                    if (aAbsence.nature) {
                        lResult += aAbsence.nature.GetLibelle();
                    } else {
                        lResult += GTraductions.getValeur('AbsenceVS.mesureConservatoire');
                    }
                    break;
                case EGenreRessource.Sanction:
                    if (aAbsence.nature) {
                        lResult += aAbsence.nature.GetLibelle();
                    } else {
                        lResult += GTraductions.getValeur('AbsenceVS.sanction');
                    }
                    if (aAbsence.nature.GetGenre() === EGenreSanction.Autre_Exclusion) {
                        lResult += ' (' + GTraductions.getValeur('AbsenceVS.exclusion2').toLowerCase() + ') ';
                    }
                    lResult += this.getDureeSanction(aAbsence);
                    break;
                case EGenreRessource.Incident:
                    if (aAbsence.mesure) {
                        lResult += this.getModalitesPunitionSanction(aAbsence.mesure);
                    } else {
                        lResult += GTraductions.getValeur('AbsenceVS.AucuneMesure');
                    }
                    break;
                default:
                    break;
            }
            return lResult.ucfirst();
        };
        ObjetUtilitaireAbsence.prototype.getLibellesInterdit = function(aAbsence) {
            var lResult = '';
            if ((aAbsence.GetGenre() === EGenreRessource.MesureConservatoire) && !!aAbsence.interditAcces && aAbsence.interditAcces.count() > 0) {
                lResult += '<div class="TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.interditLAcces').ucfirst() + ' :</div>';
                if (aAbsence.interditAcces.contains(TypePerimetreMesureConservatoire.PMC_Externat)) {
                    lResult += '- ' + GTraductions.getValeur('AbsenceVS.mesureconservatoire.aLEtablissement') + '<br />';
                }
                if (aAbsence.interditAcces.contains(TypePerimetreMesureConservatoire.PMC_DP)) {
                    lResult += '- ' + GTraductions.getValeur('AbsenceVS.mesureconservatoire.aLaDemiPension') + '<br />';
                }
                if (aAbsence.interditAcces.contains(TypePerimetreMesureConservatoire.PMC_Internat)) {
                    lResult += '- ' + GTraductions.getValeur('AbsenceVS.mesureconservatoire.aLInternat') + '<br />';
                }
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getLibellePunitionSanctionDIncident = function(aAbsence) {
            var lResult = '';
            if (MethodesTableau.existe(aAbsence.GetGenre(), [EGenreRessource.Punition, EGenreRessource.Sanction, EGenreRessource.MesureConservatoire]) && !aAbsence.estProgrammation && aAbsence.estLieAUnIncident && aAbsence.incident && aAbsence.incident.publie) {
                lResult = GTraductions.getValeur('AbsenceVS.IncidentSignaleLe', [GDate.FormatDate(aAbsence.incident.date, '%J %MMM'), GDate.FormatDate(aAbsence.incident.date, '%xh%sh%mm')]);
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getChaineTraductionGenreAbsence = function(aObjet) {
            switch (aObjet.genre) {
                case EGenreRessource.ObservationProfesseurEleve:
                    switch (aObjet.genreObservation) {
                        case TypeGenreObservationVS.OVS_DefautCarnet:
                            if (!!aObjet.libelle) {
                                return aObjet.libelle;
                            }
                            return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.defautDeCarnet') : GTraductions.getValeur('AbsenceVS.defautsDeCarnet');
                        case TypeGenreObservationVS.OVS_Autres:
                            if (!!aObjet.libelle) {
                                return aObjet.libelle;
                            }
                            return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.autreObservation') : GTraductions.getValeur('AbsenceVS.autresObservations');
                        case TypeGenreObservationVS.OVS_ObservationParent:
                            if (aObjet.estLue === false) {
                                return GTraductions.getValeur('AbsenceVS.observationNonLue');
                            }
                            return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.observation') : GTraductions.getValeur('AbsenceVS.observations');
                        case TypeGenreObservationVS.OVS_Encouragement:
                            if (aObjet.estLue === false) {
                                return GTraductions.getValeur('AbsenceVS.encouragementNonLu');
                            }
                            return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.encouragement') : GTraductions.getValeur('AbsenceVS.encouragements');
                        default:
                            return '';
                    }
                    case EGenreRessource.Absence:
                        if (aObjet.justifie === true) {
                            return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceCoursJust') : GTraductions.getValeur('AbsenceVS.absencesCoursJust');
                        }
                        if (aObjet.justifie === false) {
                            return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceCoursNonJust') : GTraductions.getValeur('AbsenceVS.absencesCoursNonJust');
                        }
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absence') : GTraductions.getValeur('AbsenceVS.absences');
                    case EGenreRessource.AbsenceRepas:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceRepas') : GTraductions.getValeur('AbsenceVS.absencesRepas');
                    case EGenreRessource.AbsenceInternat:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.absenceInternat') : GTraductions.getValeur('AbsenceVS.absencesInternat');
                    case EGenreRessource.Retard:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.retard') : GTraductions.getValeur('AbsenceVS.retards');
                    case EGenreRessource.Infirmerie:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.infirmerie') : GTraductions.getValeur('AbsenceVS.infirmeries');
                    case EGenreRessource.Exclusion:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.exclusion') : GTraductions.getValeur('AbsenceVS.exclusions');
                    case EGenreRessource.Punition:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.punition') : GTraductions.getValeur('AbsenceVS.punitions');
                    case EGenreRessource.Sanction:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.sanction') : GTraductions.getValeur('AbsenceVS.sanctions');
                    case EGenreRessource.MesureConservatoire:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.mesureConservatoire') : GTraductions.getValeur('AbsenceVS.mesuresConservatoires');
                    case EGenreRessource.Incident:
                        return aObjet.singulier ? GTraductions.getValeur('AbsenceVS.incident') : GTraductions.getValeur('AbsenceVS.incidents');
                    default:
                        ;
                        return '';
            }
        };
        ObjetUtilitaireAbsence.prototype.arrayToChaine = function(aArray, aSeparateur, aSeparateurFin) {
            var lResult = '';
            if (aArray.length > 0) {
                lResult = aArray[aArray.length - 1];
                if (aArray.length > 1) {
                    aArray.pop();
                    lResult = aArray.join(aSeparateur) + aSeparateurFin + lResult;
                }
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getChaineRecapitulatifPunitionSanction = function(aObjet) {
            var lResult = '';
            if (aObjet.genre === EGenreRessource.MesureConservatoire) {
                lResult += aObjet.nombre + ' ' + (aObjet.nombre === 1 ? GTraductions.getValeur('AbsenceVS.mesureConservatoire').toLowerCase() : GTraductions.getValeur('AbsenceVS.mesuresConservatoires').toLowerCase());
                return lResult;
            } else if (aObjet.genre === EGenreRessource.Sanction) {
                lResult += aObjet.nombre + ' ' + (aObjet.nombre === 1 ? GTraductions.getValeur('AbsenceVS.sanction').toLowerCase() : GTraductions.getValeur('AbsenceVS.sanctions').toLowerCase());
            } else {
                lResult += aObjet.nombre + ' ' + (aObjet.nombre === 1 ? GTraductions.getValeur('AbsenceVS.punition').toLowerCase() : GTraductions.getValeur('AbsenceVS.punitions').toLowerCase());
            }
            if (aObjet.nombre > 1 && !!aObjet.recap && (aObjet.recap.getNombre() > 0)) {
                lResult += ' (' + GTraductions.getValeur('AbsenceVS.dont') + ' ';
                var lPunitions = [];
                for (var j in aObjet.recap.Nombre) {
                    var lLibelle = aObjet.recap.libelles[j];
                    var lNombre = aObjet.recap.Nombre[j];
                    if (lNombre > 0) {
                        lPunitions.push(lNombre + ' ' + lLibelle);
                    }
                }
                lResult += this.arrayToChaine(lPunitions, ', ', ' ' + GTraductions.getValeur('Et') + ' ');
                lResult += ')';
            }
            return lResult;
        };
        ObjetUtilitaireAbsence.prototype.getLibelleTAF = function(aAbsence) {
            var lLibelle = '';
            var lTAFDoc = [];
            if (!!aAbsence.travailAFaire || (!!aAbsence.documentsTAF && aAbsence.documentsTAF.GetNbrElements() > 0)) {
                lLibelle += '<span>' + GTraductions.getValeur('AbsenceVS.travailAFaire') + ' : ' + '</span>';
            }
            if (!!aAbsence.travailAFaire) {
                lLibelle += aAbsence.travailAFaire;
            }
            if (!!aAbsence.documentsTAF && aAbsence.documentsTAF.GetNbrElements() > 0) {
                if (!!aAbsence.travailAFaire) {
                    lLibelle += '<br />';
                }
                for (var i = 0; i < aAbsence.documentsTAF.GetNbrElements(); i++) {
                    var lDoc = aAbsence.documentsTAF.GetElement(i);
                    lTAFDoc.push(GChaine.composerUrlLienExterne({
                        documentJoint: lDoc,
                        genreRessource: EGenreRessource.DocJointEleve
                    }));
                }
                lLibelle += lTAFDoc.join(', ');
            }
            return ((lLibelle !== '') ? '<div class="Texte10 EspaceHaut10">' + lLibelle + '</div>' : '');
        };
        ObjetUtilitaireAbsence.prototype.getTravailAFaire = function(aElement) {
            var lTAF = '';
            if (!!aElement.travailAFaire) {
                lTAF = aElement.travailAFaire;
            }
            var lTAFDoc = [];
            if (!!aElement.documentsTAF) {
                for (var k = 0; k < aElement.documentsTAF.GetNbrElements(); k++) {
                    var lDocTAF = aElement.documentsTAF.GetElement(k);
                    lTAFDoc.push(GChaine.composerUrlLienExterne({
                        documentJoint: lDocTAF,
                        genreRessource: EGenreRessource.DocJointEleve
                    }));
                }
            }
            return lTAF + (!!lTAF && !!lTAFDoc.length ? '<br>' : '') + lTAFDoc.join(', ');
        };
        ObjetUtilitaireAbsence.prototype.estEspaceParent = function() {
            return MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Parent, EGenreEspace.PrimParent, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent]);
        };
        ObjetUtilitaireAbsence.prototype.getIndiceCoursParPlace = function(aListeCours, aPlaceCourante) {
            var lEcartAvant = -1000;
            var lIndiceAvant;
            if (MethodesObjet.isNumber(aPlaceCourante)) {
                for (var I = 0; I < aListeCours.GetNbrElements(); I++) {
                    var lCours = aListeCours.GetElement(I);
                    if (lCours && lCours.Visible !== false && GDate.estJourEgal(lCours.DateDuCours, new Date())) {
                        if ((aPlaceCourante >= lCours.Debut) && ((lCours.Fin - aPlaceCourante) > lEcartAvant)) {
                            lEcartAvant = lCours.Fin - aPlaceCourante;
                            lIndiceAvant = I;
                        }
                    }
                }
            }
            return lIndiceAvant;
        };
        module.exports = ObjetUtilitaireAbsence;
    },
    fn: "objetutilitaireabsence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreWidget = {
            discussions: 0,
            casier: 1,
            appelNonFait: 2,
            CDTNonSaisi: 3,
            conseilDeClasse: 4,
            menuDeLaCantine: 5,
            vieScolaire: 6,
            travailAFaire: 7,
            agenda: 8,
            actualites: 9,
            notes: 10,
            QCM: 11,
            EDT: 12,
            ressources: 13,
            kiosque: 14,
            ressourcePedagogique: 15,
            DS: 16,
            aide: 17,
            competences: 18,
            coursNonAssures: 19,
            penseBete: 20,
            DSEvaluation: 21,
            RetourEspace: 22,
            carnetDeCorrespondance: 23,
            Encouragement: 24,
            TAFARendre: 25,
            Intendance_Execute: 26,
            lienUtile: 27,
            partenaireCDI: 28,
            partenaireAgate: 29,
            incidents: 30,
            donneesVS: 31,
            donneesProfs: 32,
            tableauDeBord: 33,
            communications: 34,
            connexionsEnCours: 35,
            partenaireARD: 36,
            personnelsAbsents: 37,
            tachesSecretariat_Execute: 38,
            Planning: 39,
            elections: 40,
            activite: 41,
            enseignementADistance: 42,
            TAFPrimaire: 43
        };
        module.exports = EGenreWidget;
    },
    fn: "enumere_widget.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GUID = require('GUID.js');
        var GHtml = require('GHtml.js');
        var GTraductions = require('ObjetTraduction.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        require('produit/css/Widgets-dashboard.css');
        var UtilitaireWidget = {};
        UtilitaireWidget.parametres = {};
        UtilitaireWidget.hauteurTitre = 27;
        UtilitaireWidget.nbrItemsVisible = 3;
        UtilitaireWidget.suffixIdWidget = GUID.getId();
        UtilitaireWidget.suffixIdContenu = '';
        UtilitaireWidget.suffixIdWrapper = GUID.getId();
        UtilitaireWidget.suffixIdActualiser = GUID.getId();
        UtilitaireWidget.suffixIdToutVoir = GUID.getId();
        UtilitaireWidget.initialiserThemes = function(aGenreTheme) {
            UtilitaireWidget.themes = [{
                avecPuce: true,
                couleurTitre: GCouleur.themeNeutre.sombre,
                fondTitre: GCouleur.themeNeutre.moyen1,
                tailleTitre: 'Texte11',
                tailleToutVoir: 'Texte10',
                tailleBordure: 2,
                tailleSeparateur: 1,
                couleurSeparateur: GCouleur.themeCouleur.foncee,
                hauteurSeparateur: 2,
                margeDroite: 5,
                margeBasWidget: 5
            }, {
                avecPuce: false,
                couleurTitre: GCouleur.themeNeutre.foncee,
                fondTitre: GCouleur.blanc,
                tailleTitre: 'Texte13',
                tailleToutVoir: 'Texte9',
                tailleBordure: 1,
                tailleSeparateur: 1,
                couleurSeparateur: GCouleur.themeNeutre.foncee,
                hauteurSeparateur: 1,
                margeDroite: 25,
                margeBas: 25
            }];
            UtilitaireWidget.theme = UtilitaireWidget.themes[aGenreTheme];
        };
        UtilitaireWidget.setParametres = function(aParametres) {
            this.parametres = aParametres;
        };
        UtilitaireWidget.compose = function(aParams) {
            var H = [];
            var themeInitial = UtilitaireWidget.theme;
            if (aParams.theme !== undefined) {
                UtilitaireWidget.theme = UtilitaireWidget.themes[aParams.theme];
            }
            if (!aParams.sansTitre) {
                H.push(this.composeTitre(aParams));
            }
            H.push(aParams.contenu);
            UtilitaireWidget.theme = themeInitial;
            return H.join('');
        };
        UtilitaireWidget.composeTitre = function(aParams) {
            if (UtilitaireWidget.invisible) {
                return '';
            }
            var H = [];
            H.push('<header', aParams.hint ? ' title="' + aParams.hint + '">' : '>', aParams.titre ? aParams.titre : '', '</header>');
            return H.join('');
        };
        UtilitaireWidget.composeWidget = function(aWidget, aNom) {
            return UtilitaireWidget.compose({
                titre: UtilitaireWidget.composeTitreWidget(aWidget, aNom),
                hint: aWidget.hint,
                contenu: UtilitaireWidget.composeContenuWidget(aWidget),
                couleurFond: aWidget.couleurFond,
                maximise: aWidget.maximise,
                sansTitre: aWidget.sansTitre,
                sansGabarit: aWidget.sansGabarit
            });
        };
        UtilitaireWidget.composeTitreWidget = function(aWidget, aNom) {
            var lExistePage = (aWidget.page && (GEtatUtilisateur.existeGenreOnglet ? GEtatUtilisateur.existeGenreOnglet(aWidget.page.Onglet) : true)) || aWidget.getPage;
            var H = [];
            if (aWidget.titre) {
                var lAttrSupplementairesTitre = [];
                if (!aWidget.hint && !aWidget.titreFixe) {
                    lAttrSupplementairesTitre.push('ie-ellipsis');
                }
                if (lExistePage) {
                    lAttrSupplementairesTitre.push('onclick="' + aNom + '._surToutVoir(' + aWidget.genre + ')"');
                    lAttrSupplementairesTitre.push('class="clickable"');
                }
                lAttrSupplementairesTitre.push('id="' + aWidget.id + '_TitreText"');
                H.push('<h3 ', lAttrSupplementairesTitre.join(' '), '>', '<span>', aWidget.titre, ((aWidget.nbrElements > 0 && (this.parametres.avecCompteur || UtilitaireWidget._avecCompteur(aWidget))) ? ' (' + aWidget.nbrElements + ')' : ''), '</span>', '</h3>');
            } else {
                H.push('<h3 class="Masquer" id="' + aWidget.id + '_TitreText">', aWidget.hint ? aWidget.hint : '', '</h3>');
            }
            H.push('<div class="cta-conteneur">');
            if (lExistePage) {
                if (this.parametres.avecToutVoir) {
                    H.push(UtilitaireWidget.composeToutVoir(aWidget, aNom));
                } else {
                    H.push('<i role="button" tabIndex="0" aria-label="' + GTraductions.getValeur('accueil.hint.toutVoir') + '" id="', aWidget.idToutVoir, '" class="as-button bt-widget icon icon_affichage_widget "  ie-hint="' + GTraductions.getValeur('accueil.hint.toutVoir') + '" onclick="' + aNom + '._surToutVoir (' + aWidget.genre + ', false)"></i>');
                }
            }
            if (aWidget && aWidget.avecActualisation) {
                H.push('<div role="button" tabIndex="0"  aria-label="' + GTraductions.getValeur('accueil.hint.refresh') + '"  id="', aWidget.id, UtilitaireWidget.suffixIdActualiser, '" onclick="' + aNom + '._surActualiser (', aWidget.genre, ')"><i class="as-button bt-refresh icon icon_refresh"  ie-hint="' + GTraductions.getValeur('accueil.hint.refresh') + '" ></i></div>');
            }
            if (this.parametres.avecFermer) {
                H.push('<i role="button" tabIndex="0" aria-label="' + GTraductions.getValeur('accueil.hint.fermer') + '" class="as-button bt-close icon icon_fermeture_widget" ie-hint="' + GTraductions.getValeur('accueil.hint.fermer') + '" onclick="' + aNom + '._surFermer (', aWidget.genre, ', false)"></i>');
            }
            MethodesTableau.parcourir(aWidget.listeElementsGraphiques, function(D) {
                (!!D.html && !!D.mrFiche) ? H.push(D.html): '';
            });
            H.push('</div>');
            return H.join('');
        };
        UtilitaireWidget.composeContenuWidget = function(aWidget) {
            var H = [];
            aWidget.nbrItemsVisible = (aWidget.nbrItemsVisible === undefined) ? this.nbrItemsVisible : aWidget.nbrItemsVisible;
            if (aWidget.listeElementsGraphiques !== undefined) {
                H.push('<div class="filtre-conteneur">');
                MethodesTableau.parcourir(aWidget.listeElementsGraphiques, function(D) {
                    if (!!D.id) {
                        H.push('<span id="' + D.id + '" ></span>');
                    } else if (!!D.html && !D.mrFiche) {
                        H.push(D.html);
                    }
                });
                H.push('</div>');
            }
            H.push('<div class="content-container" id="', aWidget.id, UtilitaireWidget.suffixIdWrapper, '" ', '>');
            H.push('<div id="', aWidget.id + UtilitaireWidget.suffixIdContenu, '">');
            H.push(aWidget.afficherMessage && aWidget.message ? UtilitaireWidget.composeMessageAucuneDonnee(aWidget) : aWidget.html);
            H.push('</div>');
            if (aWidget.isCollapsible) {
                if (!!aWidget.nbrListes && aWidget.nbrListes > 0 && !!aWidget.liste) {
                    var lNbrElements = UtilitaireWidget._getNbrElementsNonVisibles(aWidget);
                    if (lNbrElements > 0) {
                        H.push('<div class="as-footer"><a class="btn-collapse"><span class="icon icon_eye_open"></span><span class="counter"> +</span>' + lNbrElements + '</a></div>');
                    }
                } else if (aWidget.nbrElements > aWidget.nbrItemsVisible) {
                    H.push('<div class="as-footer"><a class="btn-collapse"><span class="icon icon_eye_open"></span><span class="counter"> +</span>' + (aWidget.nbrElements - aWidget.nbrItemsVisible) + '</a></div>');
                }
            }
            H.push('</div>');
            return H.join('');
        };
        UtilitaireWidget.actualiserWidget = function(aWidget, aNom) {
            GHtml.setHtml(aWidget.id + UtilitaireWidget.suffixIdActualiser, aWidget.avecActualisation ? '<div id="' + aWidget.id + UtilitaireWidget.suffixIdActualiser + '" onclick="' + aNom + '._surActualiser (' + aWidget.genre + ')" role="button" tabIndex="0" ><i class="as-button bt-widget icon icon_refresh"></i></div>' : '');
            GHtml.setHtml(aWidget.id + UtilitaireWidget.suffixIdContenu, aWidget.afficherMessage && aWidget.message ? UtilitaireWidget.composeMessageAucuneDonnee(aWidget) : aWidget.html, {
                controleur: aWidget.controleur
            });
            GHtml.setHtml(aWidget.id + '_TitreText', aWidget.titre + (aWidget.nbrElements > 0 ? ' (' + aWidget.nbrElements + ')' : ''), {
                controleur: aWidget.controleur
            });
        };
        UtilitaireWidget.composeMessageAucuneDonnee = function(aWidget, aMessage) {
            var H = [];
            H.push('<div class="no-events" tabIndex="0" aria-label="', (aWidget && aWidget.message ? aWidget.message : aMessage), '"><p>', aWidget && aWidget.message ? aWidget.message : aMessage, '</p></div>');
            return H.join('');
        };
        UtilitaireWidget.composeToutVoir = function(aWidget, aNom) {
            var H = [];
            H.push('<i id="' + aWidget.id + UtilitaireWidget.suffixIdToutVoir + '" ' + GObjetWAI.composeRole(EGenreRole.Button), ' title="', GTraductions.getValeur('accueil.toutVoir'), '"', ' class="as-button bt-widget icon icon_affichage_widget"', ' onclick="' + aNom + '._surToutVoir(' + aWidget.genre + ')"', ' tabIndex="0" role="button" aria-label="' + GTraductions.getValeur('accueil.toutVoir') + '">', '</i>');
            return H.join('');
        };
        UtilitaireWidget.afficherMasquerListe = function(aWidget) {
            aWidget.nbrItemsVisible = (aWidget.nbrItemsVisible === undefined) ? this.nbrItemsVisible : aWidget.nbrItemsVisible;
            if (aWidget.isCollapsible) {
                var lWidgetComplet = $('#' + aWidget.id).closest('.widget');
                var lListItems;
                if (aWidget.nomDonnees === 'actualites' && lWidgetComplet.find('ul ul').length > 1) {
                    lListItems = lWidgetComplet.find('ul.liste-clickable');
                } else {
                    lListItems = lWidgetComplet.find('ul');
                }
                lListItems.find(' > li:gt(' + (aWidget.nbrItemsVisible - 1) + ')').addClass('more masked');
                $('.btn-collapse', lWidgetComplet).on('click', function() {
                    var lIconBt = $(this).find('span.icon');
                    var more = lListItems.find('li.more');
                    lIconBt.hasClass('icon_eye_close') ? lIconBt.toggleClass('icon_eye_close icon_eye_open') : lIconBt.toggleClass('icon_eye_open icon_eye_close');
                    if (more.hasClass('masked')) {
                        more.toggleClass('masked unmasked');
                        $(this).find('span.counter').text('-');
                    } else {
                        more.toggleClass('unmasked masked');
                        $(this).find('span.counter').text('+');
                    }
                });
            }
        };
        UtilitaireWidget._getNbrElementsNonVisibles = function(aWidget) {
            var i, j, lNbr, lNbrElements = 0,
                lListes = [];
            for (i = 0, j = -1, lNbr = aWidget.liste.GetNbrElements(); i < lNbr; i++) {
                if (aWidget.liste.GetElement(i).estUnDeploiement) {
                    j++;
                    lListes[j] = new ObjetListeElements();
                    continue;
                }
                lListes[j].add(aWidget.liste.GetElement(i));
            }
            for (i = 0, lNbr = lListes.length; i < lNbr; i++) {
                if (lListes[i].GetNbrElements() > aWidget.nbrItemsVisible) {
                    lNbrElements = lNbrElements + (lListes[i].GetNbrElements() - aWidget.nbrItemsVisible);
                }
            }
            return lNbrElements;
        };
        UtilitaireWidget._avecCompteur = function(aWidget) {
            return MethodesTableau.existe(aWidget.nomDonnees, ['discussions']) ? true : false;
        };
        module.exports = UtilitaireWidget;
    },
    fn: "utilitairewidget.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreLienDS = {
            tGL_Devoir: 0,
            tGL_Evaluation: 1
        };
        module.exports = EGenreLienDS;
    },
    fn: "enumere_liends.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetFenetre_Mobile = require('ObjetFenetre_Mobile.js');

        function ObjetFiche_Mobile() {
            this.inheritedCreate(arguments);
            this.EnAffichage = false;
            this.idContenu = this.Nom + '_ContenuFiche';
            this.IdPremierElement = this.idContenu;
            this.setOptionsFenetre({
                estFicheMobile: true,
                modale: false,
                largeur: null,
                hauteur: null,
                avecAbonnementBlocage: true,
                avecAbonnementPremierPlan: true,
                htmlContenu: ''
            });
        }
        MethodesObjet.heritagePrototype(ObjetFiche_Mobile, ObjetFenetre_Mobile);
        ObjetFiche_Mobile.prototype.Compose = function() {
            var H = '';
            H += '<div tabindex="-1" id="' + this.idContenu + '">';
            H += this.optionsFenetre.htmlContenu || this.ComposeContenu();
            H += '</div>';
            return H;
        };
        ObjetFiche_Mobile.prototype.SurAfficher = function() {
            if (this.surPreAffichage) {
                this.surPreAffichage();
            }
            this.positionnerFenetre(this._parametresAffichageFiche);
        };
        ObjetFiche_Mobile.prototype.actualiser = function() {
            this.Afficher();
        };
        ObjetFiche_Mobile.prototype.Afficher = function() {
            ObjetFenetre_Mobile.prototype.Afficher.call(this, this.Compose());
        };
        ObjetFiche_Mobile.prototype.afficherFiche = function() {
            this.Afficher();
        };
        ObjetFiche_Mobile.prototype.Fermer = function(ASurInteractionUtilisateur) {
            var lEstEnAffichage = this.EnAffichage;
            this.inherited('Fermer');
            if (lEstEnAffichage) {
                var LSurInteractionUtilisateur = ASurInteractionUtilisateur === null || ASurInteractionUtilisateur === undefined ? true : ASurInteractionUtilisateur;
                if (LSurInteractionUtilisateur) {
                    this.callback.appel();
                }
            }
        };
        module.exports = ObjetFiche_Mobile;
    },
    fn: "objetfiche_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        if (IE.estMobile) {
            module.exports = require('ObjetFiche_Mobile.js');
        } else {
            module.exports = require('ObjetFiche_Espace.js');
        }
    },
    fn: "objetfiche.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreReponseInternetActualite = {
            AvecAR: 0,
            Textuelle: 1,
            ChoixUnique: 2,
            ChoixMultiple: 3,
            SansAR: 4,
            SansReponse: 5
        };
        module.exports.TypeGenreReponseInternetActualite = TypeGenreReponseInternetActualite;
    },
    fn: "typegenrereponseinternetactualite.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var TypeEtatPublication = {
            Publiee: 0,
            PublieeFutur: 1,
            PublieePasse: 2,
            Brouillon: 3
        };
        module.exports.TypeEtatPublication = TypeEtatPublication;
        TypeEtatPublication.getClassEtatPublication = function(aActu, aPublie) {
            switch (aActu.etatPublication) {
                case TypeEtatPublication.Publiee:
                    return (aPublie === true) ? 'Image_Publie' : 'Image_NonPublie_Grise';
                case TypeEtatPublication.PublieeFutur:
                    return (aPublie === true) ? 'Image_PublieEnAttente' : 'Image_NonPublie_Grise';
                case TypeEtatPublication.PublieePasse:
                    return (aPublie === true) ? 'Image_Publie_Grise' : 'Image_NonPublie_Grise';
                case TypeEtatPublication.Brouillon:
                    return (aPublie === true) ? 'Image_Publie_Grise' : 'Image_NonPublie';
                default:
                    ;
                    return '';
            }
        };
        TypeEtatPublication.getEtatPublication = function(aEtatPublication) {
            switch (aEtatPublication) {
                case TypeEtatPublication.Publiee:
                    return 'Image_Publie';
                case TypeEtatPublication.PublieeFutur:
                    return 'Image_PublieEnAttente';
                case TypeEtatPublication.PublieePasse:
                    return 'Image_Publie_Grise';
                case TypeEtatPublication.Brouillon:
                    return 'Image_NonPublie';
                default:
                    ;
                    return '';
            }
        };
        TypeEtatPublication.getHintPublication = function(aEtatPublication) {
            switch (aEtatPublication) {
                case TypeEtatPublication.Publiee:
                    return GTraductions.getValeur('actualites.info.PubEnCours');
                case TypeEtatPublication.PublieeFutur:
                    return GTraductions.getValeur('actualites.info.PubAVenir');
                case TypeEtatPublication.PublieePasse:
                    return GTraductions.getValeur('actualites.info.PubPassee');
                case TypeEtatPublication.Brouillon:
                    return GTraductions.getValeur('actualites.info.NonPubliee');
                default:
                    ;
                    return '';
            }
        };
    },
    fn: "typeetatpublication.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;

        function TUtilitaireListePeriodes() {}(function() {
            TUtilitaireListePeriodes.choix = {
                aujourdhui: 1,
                hier: 1,
                demain: 1,
                semaineCourante: 1,
                semainePrecedente: 1,
                semaineSuivante: 1,
                moisCourant: 1,
                periodes: 1,
                annee: 1,
                mois: 1
            };
            MethodesObjet.indenterEnumere(TUtilitaireListePeriodes.choix);
            TUtilitaireListePeriodes.construireListePeriodes = function(aChoixPeriodes, aOptions) {
                var lListe = new ObjetListeElements(),
                    lOptions = $.extend({
                        dateDebut: GParametres.PremiereDate,
                        dateFin: GParametres.DerniereDate,
                        dansBornes: function(aDate) {
                            return (aDate > this.dateDebut || GDate.estJourEgal(aDate, this.dateDebut)) && (aDate < this.dateFin || GDate.estJourEgal(aDate, this.dateFin));
                        },
                        datesOK: function(aDateDebut, aDateFin) {
                            return this.dansBornes(aDateDebut) || this.dansBornes(aDateFin);
                        },
                        borner: function(aDate) {
                            if (aDate < this.dateDebut) {
                                return new Date(this.dateDebut.getTime());
                            }
                            if (aDate > this.dateFin) {
                                return new Date(this.dateFin.getTime());
                            }
                            return aDate;
                        }
                    }, aOptions);
                if (MethodesObjet.isArray(aChoixPeriodes)) {
                    for (var i = 0; i < aChoixPeriodes.length; i++) {
                        _ajouterChoix(lListe, aChoixPeriodes[i], lOptions);
                    }
                }
                return lListe;
            };

            function _ajouterChoix(aListe, aChoix, aOptions) {
                var lElement = null,
                    lDate, lDateDebut, lDateFin, lCycle;

                function _ajouterElement(aLibelle, aDateDebut, aDateFin) {
                    var lElement = new ObjetElement(aLibelle);
                    lElement.dates = {
                        debut: aOptions.borner(aDateDebut),
                        fin: aOptions.borner(aDateFin)
                    };
                    lElement.choix = aChoix;
                    aListe.AddElement(lElement);
                }
                switch (aChoix) {
                    case TUtilitaireListePeriodes.choix.aujourdhui:
                        _ajouterElement(GTraductions.getValeur('Aujourdhui').ucfirst(), GDate.getDateCourante(), GDate.getDateCourante());
                        break;
                    case TUtilitaireListePeriodes.choix.hier:
                        lDate = GDate.GetJourSuivant(GDate.getDateCourante(), -1);
                        if (aOptions.datesOK(lDate, lDate)) {
                            _ajouterElement(GTraductions.getValeur('Hier').ucfirst(), lDate, lDate);
                        }
                        break;
                    case TUtilitaireListePeriodes.choix.demain:
                        lDate = GDate.GetJourSuivant(GDate.getDateCourante(), 1);
                        if (aOptions.datesOK(lDate, lDate)) {
                            _ajouterElement(GTraductions.getValeur('Demain').ucfirst(), lDate, lDate);
                        }
                        break;
                    case TUtilitaireListePeriodes.choix.semaineCourante:
                        lCycle = IE.Cycles.cycleCourant();
                        lDateDebut = IE.Cycles.dateDebutCycle(lCycle);
                        lDateFin = IE.Cycles.dateFinCycle(lCycle);
                        if (aOptions.datesOK(lDateDebut, lDateFin)) {
                            _ajouterElement(GTraductions.getValeur('SemaineEnCours'), lDateDebut, lDateFin);
                        }
                        break;
                    case TUtilitaireListePeriodes.choix.semainePrecedente:
                        lCycle = IE.Cycles.cycleCourant() - 1;
                        if (IE.Cycles.cycleDansAnnee(lCycle) !== lCycle) {
                            return;
                        }
                        lDateDebut = IE.Cycles.dateDebutCycle(lCycle);
                        lDateFin = IE.Cycles.dateFinCycle(lCycle);
                        if (aOptions.datesOK(lDateDebut, lDateFin)) {
                            _ajouterElement(GTraductions.getValeur('SemainePrecedente'), lDateDebut, lDateFin);
                        }
                        break;
                    case TUtilitaireListePeriodes.choix.semaineSuivante:
                        lCycle = IE.Cycles.cycleCourant() + 1;
                        if (IE.Cycles.cycleDansAnnee(lCycle) !== lCycle) {
                            return;
                        }
                        lDateDebut = IE.Cycles.dateDebutCycle(lCycle);
                        lDateFin = IE.Cycles.dateFinCycle(lCycle);
                        if (aOptions.datesOK(lDateDebut, lDateFin)) {
                            _ajouterElement(GTraductions.getValeur('SemaineSuivante'), lDateDebut, lDateFin);
                        }
                        break;
                    case TUtilitaireListePeriodes.choix.moisCourant:
                        lDate = GDate.getDateCourante();
                        lDateDebut = GDate.GetPremierJourDuMois(lDate.getFullYear(), lDate.getMonth());
                        lDateFin = GDate.GetDernierJourDuMois(lDate.getFullYear(), lDate.getMonth());
                        if (aOptions.datesOK(lDateDebut, lDateFin)) {
                            _ajouterElement(GTraductions.getValeur('MoisEnCours'), lDateDebut, lDateFin);
                        }
                        break;
                    case TUtilitaireListePeriodes.choix.periodes:
                        var lListePeriodesSaisie = new ObjetListeElements();
                        GParametres.listePeriodes.parcourir(function(D) {
                            if (D.GetGenre() > 0 && D.GetGenre() !== 3 && (aOptions.datesOK(D.dates.debut, D.dates.fin))) {
                                lElement = MethodesObjet.dupliquer(D);
                                lElement.choix = aChoix;
                                lElement.dates.debut = aOptions.borner(D.dates.debut);
                                lElement.dates.fin = aOptions.borner(D.dates.fin);
                                lListePeriodesSaisie.AddElement(lElement);
                            }
                        });
                        lListePeriodesSaisie.setTri([ObjetTri.init(function(D) {
                            return D.GetGenre() === 3 ? 0 : 1;
                        }), ObjetTri.init(function(D) {
                            return D.GetGenre();
                        })]);
                        lListePeriodesSaisie.trier();
                        aListe.FusionnerListe(lListePeriodesSaisie);
                        break;
                    case TUtilitaireListePeriodes.choix.annee:
                        GParametres.listePeriodes.parcourir(function(D) {
                            if (D.GetGenre() === 3) {
                                lElement = MethodesObjet.dupliquer(D);
                                lElement.SetLibelle(GTraductions.getValeur('AnneeComplete'));
                                lElement.choix = aChoix;
                                lElement.dates.debut = aOptions.borner(D.dates.debut);
                                lElement.dates.fin = aOptions.borner(D.dates.fin);
                                aListe.AddElement(lElement);
                                return false;
                            }
                        });
                        break;
                    case TUtilitaireListePeriodes.choix.mois:
                        GDate.getListeMoisAPartirDeDate(aOptions.dateDebut, aOptions.dateFin).parcourir(function(D) {
                            _ajouterElement(D.GetLibelle(), D.dateDebut, D.dateFin);
                        });
                        break;
                    default:
                        ;
                }
            }
        })();
        module.exports = TUtilitaireListePeriodes;
    },
    fn: "utilitairelisteperiodes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var GStyle = require('GStyle.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var TypeDomaine = require('TypeDomaine.js');
        var TypeEnsembleNombre = require('TypeEnsembleNombre.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var TypeEtatPublication = require('TypeEtatPublication.js').TypeEtatPublication;
        var TypeGenreReponseInternetActualite = require('TypeGenreReponseInternetActualite.js').TypeGenreReponseInternetActualite;
        var TUtilitaireListePeriodes = require('UtilitaireListePeriodes.js');

        function TUtilitaireInformations() {}
        TUtilitaireInformations.creerActualiteDiffusionDesResultatsSondage = function(aSondage, aListeCategories, aListePiecesJointesResultats) {
            var lCategorieParDefaut = null;
            if (!!aListeCategories) {
                aListeCategories.parcourir(function(D) {
                    if (!!D && D.estDefaut) {
                        lCategorieParDefaut = D;
                        return false;
                    }
                });
                if (!lCategorieParDefaut) {
                    lCategorieParDefaut = aListeCategories.GetPremierElement();
                }
            }
            var lNouvelleActualite = TUtilitaireInformations.initialiserNouveauItem({
                categorie: lCategorieParDefaut
            });
            lNouvelleActualite.SetLibelle(GTraductions.getValeur('actualites.Edition.TitreDiffusionResultatsDuSondage', [(aSondage.GetLibelle() || '')]));
            lNouvelleActualite.publie = true;
            lNouvelleActualite.estUneDiffusionDeResultatsSondage = true;
            var lStrTypeSondage = (aSondage.reponseAnonyme ? GTraductions.getValeur('actualites.Anonyme') : GTraductions.getValeur('actualites.Nominatif'));
            var lMessageNouvelleInformation = GTraductions.getValeur('actualites.Edition.MessageDiffusionResultatsDuSondage', [lStrTypeSondage.toLowerCase(), (aSondage.GetLibelle() || '')]);
            var lPremiereQuestion = lNouvelleActualite.listeQuestions.GetPremierElement();
            lPremiereQuestion.texte = lMessageNouvelleInformation;
            if (!lPremiereQuestion.listePiecesJointes) {
                lPremiereQuestion.listePiecesJointes = new ObjetListeElements();
            }
            aListePiecesJointesResultats.parcourir(function(D) {
                lPremiereQuestion.listePiecesJointes.AddElement(D);
            });
            return lNouvelleActualite;
        };
        TUtilitaireInformations.getListePiecesJointesDActualite = function(aActualite) {
            var lListePiecesJointes = new ObjetListeElements();
            if (!!aActualite && !!aActualite.listeQuestions) {
                aActualite.listeQuestions.parcourir(function(aQuestion) {
                    if (!!aQuestion && !!aQuestion.listePiecesJointes) {
                        aQuestion.listePiecesJointes.parcourir(function(aPJQuestion) {
                            lListePiecesJointes.AddElement(aPJQuestion);
                        });
                    }
                });
            }
            return lListePiecesJointes;
        };

        function _calculeDateFinSondage(aDate) {
            var i = 0;
            var lDate = new Date(aDate.getTime());
            do {
                lDate = GDate.GetJourSuivant(lDate);
                if (!GParametres.JoursFeries.GetValeur(GDate.getNbrJoursEntreDeuxDates(IE.Cycles.dateDebutPremierCycle(), aDate) + 1) && GDate.estUnJourOuvre(lDate)) {
                    i++;
                }
            } while (i < 15 && lDate < GDate.derniereDate);
            return lDate;
        }
        TUtilitaireInformations.initialiserNouveauItem = function(aParam) {
            var lInformation = aParam.actualite ? new ObjetElement(GTraductions.getValeur('actualites.Edition.CopieDe', [aParam.actualite.GetLibelle()])) : new ObjetElement('');
            var lGenreReponse = aParam.genreReponse ? aParam.genreReponse : TypeGenreReponseInternetActualite.AvecAR;
            var lForcerAR = GApplication.droits.get(TypeDroits.fonctionnalites.forcerARInfos);
            if ((lGenreReponse === TypeGenreReponseInternetActualite.SansAR) && lForcerAR === true) {
                lGenreReponse = TypeGenreReponseInternetActualite.AvecAR;
            }
            lInformation.categorie = !aParam.categorie ? !aParam.actualite ? GEtatUtilisateur.listeCategories.GetElement(this.indiceCategorieParDefaut) : aParam.actualite.categorie : aParam.categorie;
            lInformation.auteur = GEtatUtilisateur.getUtilisateur().GetLibelle();
            lInformation.reponseAnonyme = false;
            lInformation.estInformation = MethodesTableau.existe(lGenreReponse, [TypeGenreReponseInternetActualite.AvecAR, TypeGenreReponseInternetActualite.SansAR]);
            lInformation.estSondage = !lInformation.estInformation;
            lInformation.date = '';
            lInformation.publie = aParam.actualite ? false : true;
            var lDateDebut = GDate.getDateCourante();
            var lDateFin = lInformation.estInformation ? GDate.derniereDate : _calculeDateFinSondage(lDateDebut);
            lInformation.dateDebut = aParam.actualite && aParam.actualite.dateDebut ? aParam.actualite.dateDebut : lDateDebut;
            lInformation.dateFin = aParam.actualite ? aParam.actualite.dateFin : lDateFin;
            lInformation.etatPublication = TUtilitaireInformations.getEtatPublication.call(this, lInformation);
            lInformation.avecReponse = TUtilitaireInformations.avecReponse;
            lInformation.aToutRepondu = TUtilitaireInformations.aToutRepondu;
            lInformation.lue = false;
            lInformation.public = new ObjetElement('');
            lInformation.genrePublic = -1;
            lInformation.visible = true;
            if (aParam.actualite && aParam.actualite.listeQuestions) {
                lInformation.listeQuestions = _copierQuestions.call(this, aParam.actualite.listeQuestions);
            } else {
                lInformation.listeQuestions = new ObjetListeElements();
                lInformation.listeQuestions.AddElement(TUtilitaireInformations.creerQuestionOuTexteSondage({
                    genreReponse: lGenreReponse
                }));
            }
            lInformation.estVerrouille = false;
            lInformation.nombreDestinataire = aParam.actualite ? aParam.actualite.nombreDestinataire : 0;
            lInformation.nomDestinataire = aParam.actualite ? aParam.actualite.nomDestinataire : GTraductions.getValeur('actualites.Aucun');
            lInformation.detailPublic = aParam.actualite ? aParam.actualite.detailPublic : GTraductions.getValeur('actualites.AucunDestinataire');
            lInformation.avecModificationPublic = aParam.actualite || aParam.listePublic ? true : false;
            lInformation.avecElevesRattaches = false;
            lInformation.genresPublicEntite = aParam.actualite ? MethodesObjet.dupliquer(aParam.actualite.genresPublicEntite) : new TypeEnsembleNombre();
            lInformation.listePublicEntite = aParam.actualite ? MethodesObjet.dupliquer(aParam.actualite.listePublicEntite) : new ObjetListeElements();
            if (aParam.listePublic && aParam.genresPublic) {
                lInformation.listePublicEntite = new ObjetListeElements();
                lInformation.listePublicIndividu = new ObjetListeElements();
                if (aParam.genresPublic.length > 0) {
                    if (($.inArray(EGenreRessource.Classe, this.getGenresRessourceAffDestinataire()) > -1) || ($.inArray(EGenreRessource.Groupe, this.getGenresRessourceAffDestinataire()) > -1)) {
                        lInformation.listePublicEntite = aParam.listePublic;
                    } else {
                        lInformation.listePublicIndividu = aParam.listePublic;
                    }
                }
            } else {
                lInformation.listePublicEntite = aParam.actualite ? MethodesObjet.dupliquer(aParam.actualite.listePublicEntite) : new ObjetListeElements();
                lInformation.listePublicIndividu = aParam.actualite ? MethodesObjet.dupliquer(aParam.actualite.listePublicIndividu) : new ObjetListeElements();
            }
            lInformation.getDate = TUtilitaireInformations.getDate.bind(lInformation);
            return lInformation;
        };
        TUtilitaireInformations.creerQuestionOuTexteSondage = function(aParams) {
            var lParams = aParams || {};
            var lRang = lParams.rang ? lParams.rang : 1;
            var lGenreReponse = (!lParams.genreReponse || ((lParams.genreReponse === TypeGenreReponseInternetActualite.SansAR) && GApplication.droits.get(TypeDroits.fonctionnalites.forcerARInfos))) ? TypeGenreReponseInternetActualite.AvecAR : lParams.genreReponse;
            var lRangElement = lParams.rangElement ? lParams.rangElement : lRang;
            var lLibelle;
            if (!!aParams.genreReponse && aParams.genreReponse === TypeGenreReponseInternetActualite.SansReponse) {
                lLibelle = GTraductions.getValeur('actualites.Edition.TexteN', [lRangElement]);
            } else {
                lLibelle = GTraductions.getValeur('actualites.Edition.QuestionN', [lRangElement]);
            }
            var lResult = new ObjetElement(lLibelle);
            lResult.rang = lRang;
            lResult.genreReponse = lGenreReponse;
            lResult.texte = '';
            lResult.tailleReponse = 200;
            lResult.listePiecesJointes = new ObjetListeElements();
            lResult.listeChoix = new ObjetListeElements();
            lResult.reponse = new ObjetElement();
            if (lGenreReponse === TypeGenreReponseInternetActualite.Textuelle) {
                lResult.reponse.valeurReponse = '';
            } else if (MethodesTableau.existe(lGenreReponse, [TypeGenreReponseInternetActualite.ChoixMultiple, TypeGenreReponseInternetActualite.ChoixUnique])) {
                lResult.reponse.valeurReponse = new TypeDomaine();
            }
            lResult.reponse.avecReponse = false;
            return lResult;
        };
        TUtilitaireInformations.getDate = function() {
            return GTraductions.getValeur('Du') + GDate.FormatDate(this.dateDebut, ' %JJ/%MM/%AAAA ') + GTraductions.getValeur('Au') + GDate.FormatDate(this.dateFin, ' %JJ/%MM/%AAAA');
        };
        TUtilitaireInformations.avecReponse = function() {
            var lResult = false;
            for (var i = 0; i < this.listeQuestions.GetNbrElements() && !lResult; i++) {
                var lQuestion = this.listeQuestions.GetElement(i);
                lResult = lQuestion.reponse.avecReponse || (lQuestion.genreReponse === TypeGenreReponseInternetActualite.SansAR);
            }
            return lResult;
        };
        TUtilitaireInformations.aToutRepondu = function() {
            var lResult = true;
            for (var i = 0; i < this.listeQuestions.GetNbrElements() && lResult; i++) {
                var lQuestion = this.listeQuestions.GetElement(i);
                lResult = lQuestion.reponse.avecReponse || (MethodesTableau.existe(lQuestion.genreReponse, [TypeGenreReponseInternetActualite.SansAR, TypeGenreReponseInternetActualite.SansReponse]));
            }
            return lResult;
        };
        TUtilitaireInformations.getEtatPublication = function(aActualite) {
            var lActualite = aActualite ? aActualite : this.actualite;
            if (!lActualite.publie) {
                return TypeEtatPublication.Brouillon;
            } else {
                if (GDate.dateEntreLesDates(GDate.getDateCourante(), lActualite.dateDebut, lActualite.dateFin, true)) {
                    return TypeEtatPublication.Publiee;
                } else {
                    if (GDate.estDateJourAvant(GDate.getDateCourante(), lActualite.dateDebut)) {
                        return TypeEtatPublication.PublieeFutur;
                    } else {
                        return TypeEtatPublication.PublieePasse;
                    }
                }
            }
        };

        function _copierQuestions(aListeQuestions) {
            var lResult = new ObjetListeElements();
            for (var i = 0; i < aListeQuestions.GetNbrElements(); i++) {
                if (aListeQuestions.Existe(i)) {
                    var lElement = _copieQuestion(aListeQuestions.GetElement(i));
                    lElement.SetEtat(EGenreEtat.Creation);
                    lResult.AddElement(lElement);
                }
            }
            return lResult;
        }

        function _copieQuestion(aQuestion) {
            var lNouvelleQuestion = TUtilitaireInformations.creerQuestionOuTexteSondage(aQuestion);
            lNouvelleQuestion.SetLibelle(aQuestion.GetLibelle());
            lNouvelleQuestion.rang = aQuestion.rang;
            lNouvelleQuestion.genreReponse = aQuestion.genreReponse;
            lNouvelleQuestion.texte = aQuestion.texte;
            lNouvelleQuestion.tailleReponse = aQuestion.tailleReponse;
            lNouvelleQuestion.listePiecesJointes = _copierDocuments(aQuestion.listePiecesJointes);
            lNouvelleQuestion.listeChoix = _copierChoixReponses(aQuestion.listeChoix);
            return lNouvelleQuestion;
        }

        function _copierDocuments(aListeDocuments) {
            var lResult = MethodesObjet.dupliquer(aListeDocuments);
            for (var i = 0; i < lResult.GetNbrElements(); i++) {
                if (lResult.Existe(i)) {
                    var lElement = lResult.GetElement(i);
                    lElement.SetEtat(EGenreEtat.Creation);
                }
            }
            return lResult;
        }

        function _copierChoixReponses(aListeChoix) {
            var lResult = new ObjetListeElements();
            for (var i = 0; i < aListeChoix.GetNbrElements(); i++) {
                if (aListeChoix.Existe(i)) {
                    var lElement = aListeChoix.GetElement(i);
                    var lChoix = new ObjetElement(lElement.GetLibelle());
                    lChoix.rang = lElement.rang;
                    lChoix.SetEtat(EGenreEtat.Creation);
                    lResult.AddElement(lChoix);
                }
            }
            return lResult;
        }
        TUtilitaireInformations.getIDReponse = function(aParams) {
            return aParams.instance.Nom + '_reponse_' + aParams.indice;
        };
        TUtilitaireInformations.composeReponse = function(aParams) {
            var H = [];
            if (aParams.avecLibelleQuestion) {
                H.push('<div class="Actu_Question" style="padding: 2px 0px;">', (aParams.question.genreReponse !== TypeGenreReponseInternetActualite.SansReponse) ? aParams.question.GetLibelle() : '', '</div>');
            }
            var lIdReponse = TUtilitaireInformations.getIDReponse(aParams);
            if (aParams.question.genreReponse === TypeGenreReponseInternetActualite.ChoixMultiple && aParams.question.avecMaximum) {
                H.push('<div style="padding: 2px 0px 1px 0px;">', GTraductions.getValeur('actualites.Edition.NbrMaxChoix', [aParams.question.nombreReponsesMax]), '</div>');
            }
            H.push('<div id="titre_', lIdReponse, '" class="AvecSelectionTexte" style="padding: 2px 0px 1px 0px;">', aParams.question.texte, '</div>');
            H.push('<div id="', lIdReponse, '" class="PetitEspaceBas">');
            var lSurKeyUp = '';
            var lSurSaisie = '';
            switch (aParams.question.genreReponse) {
                case TypeGenreReponseInternetActualite.AvecAR:
                    lSurKeyUp = aParams.instance.Nom + '.surKeyUpReponse (' + aParams.indice + ');';
                    lSurSaisie = aParams.instance.Nom + '.surSaisieReponse(' + aParams.indice + ');';
                    H.push('<div class="Actu_AR"><ie-checkbox tabindex="-1" id="', lIdReponse, '_0" class="', this._classActualiteSaisieDirect, '" ', GObjetWAI.composeAttribut({
                        genre: EGenreAttribut.label,
                        valeur: GTraductions.getValeur('accueil.prisConnaissance')
                    }), 'onclick="', lSurSaisie, '"', 'onkeyup=" ', lSurKeyUp, '"', (aParams.question.reponse.avecReponse ? ' checked="checked" disabled' : (aParams.estAffEditionActualite ? ' disabled' : '')), '><label class="EspaceGauche" for="', lIdReponse, '">', GTraductions.getValeur('accueil.prisConnaissance'), '</label></ie-checkbox></div>');
                    break;
                case TypeGenreReponseInternetActualite.Textuelle:
                    lSurSaisie = aParams.instance.Nom + '.surSaisieReponse (' + aParams.indice + ',value);';
                    H.push('<div style="padding:1px 1px;"><textarea maxlength="0" tabindex="-1" id="', lIdReponse, '_0" class="Texte10" style="width: 100%; overflow : hidden; ', GStyle.composeCouleurBordure(GCouleur.grisClair), '" rows="3" ', GObjetWAI.composeAttribut({
                        genre: EGenreAttribut.label,
                        valeur: GTraductions.getValeur('accueil.saisirReponse')
                    }), 'onkeyup="', lSurSaisie, '" maxlength="' + aParams.question.tailleReponse + '" placeholder="', GTraductions.getValeur('actualites.SaisirReponse'), '"', (aParams.estAffEditionActualite ? ' disabled' : ''), '>', aParams.question.reponse.valeurReponse, '</textarea></div>');
                    break;
                case TypeGenreReponseInternetActualite.ChoixUnique:
                case TypeGenreReponseInternetActualite.ChoixMultiple:
                    var lNombreCoche = aParams.question && aParams.question.reponse && aParams.question.reponse.valeurReponse ? aParams.question.reponse.valeurReponse.GetNbrValeurs() : 0;
                    for (var I = 0; I < aParams.question.listeChoix.GetNbrElements(); I++) {
                        var lNr = I + 1;
                        var lValeurReponse = aParams.question.reponse && aParams.question.reponse.valeurReponse ? aParams.question.reponse.valeurReponse.GetValeur(lNr) : undefined;
                        var lDisabled = false;
                        if (aParams.question.genreReponse === TypeGenreReponseInternetActualite.ChoixMultiple && aParams.question.avecMaximum && (lNombreCoche >= aParams.question.nombreReponsesMax)) {
                            lDisabled = !lValeurReponse;
                        }
                        var ieInput = (aParams.question.genreReponse === TypeGenreReponseInternetActualite.ChoixMultiple ? 'ie-checkbox' : 'ie-radio');
                        lSurSaisie = aParams.instance.Nom + '.surSaisieReponse (' + aParams.indice + ', value, checked);';
                        H.push('<div class="Actu_InfoCoche NoWrap" ><', ieInput, ' class="InlineBlock AlignementMilieuVertical" id="', lIdReponse, '_', I, '" name="coches_', lIdReponse, '" ', GObjetWAI.composeAttribut({
                            genre: EGenreAttribut.label,
                            valeur: aParams.question.listeChoix.GetLibelle(I)
                        }), 'onclick="', lSurSaisie, '" value="', lNr, '"' + (lValeurReponse ? ' checked="checked"' : '') + (aParams.estAffEditionActualite || lDisabled ? ' disabled' : '') + ' ></', ieInput, '><label class="EspaceGauche InlineBlock AlignementMilieuVertical" for="', lIdReponse, '_', I, '">' + aParams.question.listeChoix.GetLibelle(I) + '</label></div>');
                    }
                    break;
                default:
                    break;
            }
            H.push('</div>');
            if (aParams.question.listePiecesJointes && aParams.question.listePiecesJointes.GetNbrElements() > 0) {
                H.push('<div class="PetitEspace">', TUtilitaireInformations.composeDocuments(aParams.question.listePiecesJointes), '</div>');
            }
            return H.join('');
        };
        TUtilitaireInformations.composeDocuments = function(aListeDocumentsJoints) {
            var lHtml = [];
            for (var I = 0; I < aListeDocumentsJoints.GetNbrElements(); I++) {
                var lDocumentJoint = aListeDocumentsJoints.GetElement(I);
                lHtml.push(GChaine.composerUrlLienExterne({
                    documentJoint: lDocumentJoint,
                    genreRessource: EGenreRessource.DocJointEtablissement
                }));
            }
            return lHtml.join('<br/>');
        };
        TUtilitaireInformations.initListePeriodes = function() {
            return TUtilitaireListePeriodes.construireListePeriodes([TUtilitaireListePeriodes.choix.aujourdhui, TUtilitaireListePeriodes.choix.semaineCourante, TUtilitaireListePeriodes.choix.moisCourant, TUtilitaireListePeriodes.choix.annee, TUtilitaireListePeriodes.choix.periodes, TUtilitaireListePeriodes.choix.mois]);
        };
        TUtilitaireInformations.avecCumul = function(aListe) {
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Parent, EGenreEspace.Mobile_Parent, EGenreEspace.Entreprise])) {
                if (GEtatUtilisateur.Identification.ListeRessources.GetNbrElements() > 1) {
                    return true;
                } else {
                    var lGenre = (GEtatUtilisateur.GenreEspace === EGenreEspace.Entreprise) ? EGenreRessource.MaitreDeStage : EGenreRessource.Responsable;
                    return (aListe.getIndiceElementParFiltre(function(aElement) {
                        return (aElement.public.GetNumero() === GEtatUtilisateur.getUtilisateur().GetNumero()) && (aElement.public.GetNumero() === lGenre);
                    }) > -1);
                }
            } else {
                return false;
            }
        };
        TUtilitaireInformations.avecInfoPublic = function(aActualite) {
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Parent, EGenreEspace.Mobile_Parent, EGenreEspace.Entreprise, EGenreEspace.PrimParent, EGenreEspace.Mobile_PrimParent])) {
                var lGenre = (GEtatUtilisateur.GenreEspace === EGenreEspace.Entreprise) ? EGenreRessource.MaitreDeStage : EGenreRessource.Responsable;
                var lEstActuDUtilisateur = (aActualite.public.GetNumero() === GEtatUtilisateur.getUtilisateur().GetNumero()) && (aActualite.public.GetGenre() === lGenre);
                return !lEstActuDUtilisateur;
            } else {
                return false;
            }
        };
        TUtilitaireInformations.formaterListePourCumul = function(aListe) {
            for (var I = 0; I < aListe.GetNbrElements(); I++) {
                var lElement = aListe.GetElement(I);
                if (lElement.public) {
                    var lCumulPere = aListe.GetElementParNumeroEtGenre(lElement.public.GetNumero(), lElement.public.GetGenre());
                    if (!lCumulPere) {
                        var lGenre = (GEtatUtilisateur.GenreEspace === EGenreEspace.Entreprise) ? EGenreRessource.MaitreDeStage : EGenreRessource.Responsable;
                        var lATitreIndividuel = (lElement.public.GetNumero() === GEtatUtilisateur.getUtilisateur().GetNumero()) && (lElement.public.GetGenre() === lGenre);
                        var lLibelle = lATitreIndividuel ? GTraductions.getValeur('actualites.ATitreIndividuel') : GTraductions.getValeur('actualites.AProposDe', [lElement.public.prenom && (GEtatUtilisateur.GenreEspace !== EGenreEspace.Entreprise) ? lElement.public.prenom : lElement.public.GetLibelle()]);
                        lCumulPere = new ObjetElement(lLibelle, lElement.public.GetNumero(), lElement.public.GetGenre());
                        lCumulPere.estUnDeploiement = true;
                        lCumulPere.estDeploye = true;
                        lCumulPere.aTitreIndividuel = lATitreIndividuel;
                        aListe.AddElement(lCumulPere);
                    }
                    lElement.pere = lCumulPere;
                }
            }
            aListe.setTri(ObjetTri.initRecursif('pere', [
                ObjetTri.init('aTitreIndividuel'), ObjetTri.init(function(D) {
                    return D.estUnDeploiement ? D.GetLibelle() : D.pere.GetLibelle();
                }), ObjetTri.init(function(D) {
                    return D.dateDebut;
                }, EGenreTriElement.Decroissant), ObjetTri.init(function(D) {
                    return D.dateFin;
                }), ObjetTri.init('Libelle'), ObjetTri.init('Numero')
            ]));
            aListe.trier();
        };
        module.exports = TUtilitaireInformations;
    },
    fn: "utilitaireinformations.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var ObjetFiche = require('ObjetFiche.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeGenreReponseInternetActualite = require('TypeGenreReponseInternetActualite.js').TypeGenreReponseInternetActualite;
        var TUtilitaireInformations = require('UtilitaireInformations.js');
        var GDate = require('ObjetDate.js').GDate;
        MethodesObjet.heritagePrototype(ObjetFicheActualite, ObjetFiche);

        function ObjetFicheActualite() {
            this.inheritedCreate(arguments);
            this.largeurMax = 750;
            this.hauteurMax = 400;
            this.setOptionsFenetre({
                largeur: 300,
                hauteur: 150,
                titre: function() {
                    return this.actualite ? this.actualite.GetLibelle() : '';
                }.bind(this)
            });
        }
        ObjetFicheActualite.prototype.SetDonnees = function(aActualite) {
            this.actualite = aActualite;
            this.actualite.estAValider = false;
            this.Afficher();
        };
        ObjetFicheActualite.prototype.surAfficher = function() {
            $('#' + this.Nom.escapeJQ()).find(':checkbox, :radio').jIECheckBox();
        };
        ObjetFicheActualite.prototype.ComposeContenu = function() {
            var H = [];
            H.push('<div class="PetitEspace">');
            H.push('<div style="margin:5px;min-width:190px;min-height:90px;max-width:', (GNavigateur.EcranL - 10), 'px;max-height:', (GNavigateur.EcranH - 10 - 24 - 10), 'px;overflow:auto;">');
            for (var i = 0; i < this.actualite.listeQuestions.GetNbrElements(); i++) {
                var lQuestion = this.actualite.listeQuestions.GetElement(i);
                H.push(TUtilitaireInformations.composeReponse({
                    instance: this,
                    actu: this.actualite,
                    question: lQuestion,
                    indice: i,
                    avecLibelleQuestion: (this.actualite.listeQuestions.GetNbrElements() > 1)
                }));
            }
            if (this.actualite.dateDebut) {
                H.push('<div style="text-align: right; font-style: italic; padding: 0.4rem 0;">', GTraductions.getValeur('Le'), ' ', GDate.FormatDate(this.actualite.dateDebut, '%JJ/%MM/%AAAA'), '</div>');
            }
            H.push('</div>');
            if (this.actualite.estSondage) {
                H.push('<div style="height: 19px; margin-bottom: 3px;"><ie-bouton style="float: right;" onclick="', this.Nom, '.surBouton ();">', GTraductions.getValeur('Valider'), '</ie-bouton></div>');
            }
            H.push('</div>');
            return H.join('');
        };
        ObjetFicheActualite.prototype.surKeyUpReponse = function(aIndice) {
            if (GNavigateur.IsToucheSelection()) {
                this.surSaisieReponse(aIndice);
            }
        };
        ObjetFicheActualite.prototype.surSaisieReponse = function(aIndice, aValeurReponse, aValeurCoche) {
            var lQuestion = this.actualite.listeQuestions.GetElement(aIndice);
            switch (lQuestion.genreReponse) {
                case TypeGenreReponseInternetActualite.Textuelle:
                    if (aValeurReponse.length <= lQuestion.tailleReponse) {
                        lQuestion.reponse.valeurReponse = aValeurReponse;
                        lQuestion.reponse.SetEtat(EGenreEtat.Modification);
                        lQuestion.SetEtat(EGenreEtat.Modification);
                        this.actualite.SetEtat(EGenreEtat.FilsModification);
                    } else {
                        GApplication.getMessage().Afficher(EGenreBoiteMessage.Information, null, GTraductions.getValeur('actualites.TailleMaximale'));
                        GHtml.setValue(TUtilitaireInformations.getIDReponse({
                            indice: aIndice,
                            instance: this
                        }), lQuestion.reponse.valeurReponse);
                    }
                    break;
                case TypeGenreReponseInternetActualite.ChoixUnique:
                case TypeGenreReponseInternetActualite.ChoixMultiple:
                    if (lQuestion.genreReponse === TypeGenreReponseInternetActualite.ChoixUnique) {
                        lQuestion.reponse.valeurReponse.Vider();
                    }
                    lQuestion.reponse.SetEtat(EGenreEtat.Modification);
                    lQuestion.reponse.valeurReponse.SetValeur(aValeurCoche, aValeurReponse);
                    lQuestion.SetEtat(EGenreEtat.Modification);
                    this.actualite.SetEtat(EGenreEtat.FilsModification);
                    if (lQuestion.genreReponse === TypeGenreReponseInternetActualite.ChoixMultiple && lQuestion.avecMaximum) {
                        var lNombreCoche = lQuestion.reponse.valeurReponse.GetNbrValeurs();
                        var I, lID;
                        if (lNombreCoche < lQuestion.nombreReponsesMax) {
                            for (I = 0; I < lQuestion.listeChoix.GetNbrElements(); I++) {
                                lID = TUtilitaireInformations.getIDReponse({
                                    instance: this,
                                    indice: aIndice
                                }) + '_' + I;
                                $('#' + lID.escapeJQ()).inputDisabled(false);
                            }
                        } else {
                            for (I = 0; I < lQuestion.listeChoix.GetNbrElements(); I++) {
                                lID = TUtilitaireInformations.getIDReponse({
                                    instance: this,
                                    indice: aIndice
                                }) + '_' + I;
                                var lValue = lQuestion.reponse.valeurReponse.GetValeur(I + 1);
                                $('#' + lID.escapeJQ()).inputDisabled(!lValue);
                            }
                        }
                    }
                    break;
                case TypeGenreReponseInternetActualite.AvecAR:
                    lQuestion.reponse.valeurReponse = '';
                    lQuestion.reponse.SetEtat(EGenreEtat.Modification);
                    lQuestion.SetEtat(EGenreEtat.Modification);
                    this.actualite.SetEtat(EGenreEtat.Modification);
                    break;
                default:
                    ;
                    break;
            }
            lQuestion.reponse.avecReponse = true;
            if (this.actualite.estInformation) {
                this.Fermer();
            }
        };
        ObjetFicheActualite.prototype.surBouton = function() {
            this.actualite.SetEtat(EGenreEtat.Modification);
            if (this.actualite.estSondage) {
                this.actualite.estAValider = true;
            }
            this.Fermer();
        };
        module.exports = ObjetFicheActualite;
    },
    fn: "objetficheactualite.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetFicheActualite = require('ObjetFicheActualite.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var TUtilitaireInformations = require('UtilitaireInformations.js');

        function WidgetActualites() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetActualites, Identite);
        WidgetActualites.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.creerObjetstActualites();
            var lNbrElements = this.donnees.listeActualites.GetNbrElements();
            var lAvecCumul = TUtilitaireInformations.avecCumul(this.donnees.listeActualites);
            this.donnees.listeActualites.setTri([ObjetTri.init(function(a) {
                return a.categorie ? a.categorie.GetLibelle() : '';
            })]);
            this.donnees.listeActualites.trier();
            if (lAvecCumul) {
                TUtilitaireInformations.formaterListePourCumul(this.donnees.listeActualites);
            } else {
                this.donnees.listeActualites.setTri([
                    ObjetTri.init('dateDebut', EGenreTriElement.Decroissant), ObjetTri.init('dateFin'), ObjetTri.init('Libelle')
                ]);
                this.donnees.listeActualites.trier();
            }
            for (var i = 0, lNbrListes = 0, lNbr = this.donnees.listeActualites.GetNbrElements(); i < lNbr; i++) {
                if (this.donnees.listeActualites.GetElement(i).estUnDeploiement) {
                    lNbrListes++;
                }
            }
            var lWidget = {
                html: this.composeWidgetActualites(),
                nbrElements: lNbrElements,
                nbrListes: lNbrListes,
                liste: this.donnees.listeActualites,
                afficherMessage: lNbrElements === 0,
                fermerFiches: function() {
                    this.ficheActualite.Fermer();
                }.bind(this)
            };
            $.extend(true, aParams.donnees, lWidget);
            aParams.construireWidget(this.donnees);
            this.initialiserObjetsActualites();
        };
        WidgetActualites.prototype.creerObjetstActualites = function() {
            this.ficheActualite = ObjetFenetre.creerInstance(ObjetFicheActualite, {
                pere: this,
                evenement: this._evenementSurFicheActualite
            });
            this.ficheActualite.destructionSurFermeture = false;
        };
        WidgetActualites.prototype.initialiserObjetsActualites = function() {
            this.ficheActualite.Initialiser();
        };
        WidgetActualites.prototype.composeWidgetActualites = function() {
            this.indiceLigne = 0;
            var H = [];
            if (this.donnees.listeActualites.GetNbrElements() > 0) {
                H.push('<ul role="list" class="liste-nested">');
                for (var I = 0; I < this.donnees.listeActualites.GetNbrElements(); I++) {
                    var lElement = this.donnees.listeActualites.GetElement(I);
                    lElement.avecReponse = TUtilitaireInformations.avecReponse;
                    lElement.aToutRepondu = TUtilitaireInformations.aToutRepondu;
                    if (lElement.estUnDeploiement) {
                        if (I !== 0) {
                            H.push('</ul></li>');
                        }
                        H.push('<li role="listitem" tabIndex="0" aria-label="', lElement.GetLibelle(), '">', '<h4>', lElement.GetLibelle(), '</h4>');
                        H.push('<ul role="list" class="liste-clickable">');
                    } else {
                        if (I === 0) {
                            H.push('<ul role="list" class="liste-clickable">');
                        }
                        H.push(this.composeActualite(lElement, I));
                    }
                }
                H.push('</ul>');
                H.push('</ul>');
            }
            return H.join('');
        };
        WidgetActualites.prototype.composeActualite = function(aActualite, i) {
            var H = [];
            var lID = this.donnees.id + '_div_' + i;
            var lOnKeyUp = 'if (GNavigateur.IsToucheSelection()) GHtml.setFocus(' + this.Nom + '.getIDReponse(' + i + ')+\'_0\');';
            var lLabel = aActualite.estInformation ? GTraductions.getValeur('accueil.informations.hintLien.information') : GTraductions.getValeur('accueil.informations.hintLien.sondage');
            var lTitre = aActualite.GetLibelle();
            if ((lTitre === null) || (lTitre === undefined) || (lTitre === '')) {
                lTitre = GTraductions.getValeur('SansTitre');
            }
            H.push('<li id="', lID, '" ', 'class="as-offset ', aActualite.estInformation ? 'icon_diffuser_info" ie-hint="' + GTraductions.getValeur('accueil.informations.hintLien.information') + '"' : 'icon_diffuser_sondage" ie-hint="' + GTraductions.getValeur('accueil.informations.hintLien.sondage') + '"', '" onclick="', this.Nom, '._surActualite (', i, ')"', ' onkeyup="', lOnKeyUp, '" ', GObjetWAI.composeRole(EGenreRole.Listitem), GObjetWAI.composeAttribut({
                genre: EGenreAttribut.label,
                valeur: lLabel + (lTitre ? ' : ' + lTitre : '')
            }), i === 0 ? GObjetWAI.composeAttribut({
                genre: EGenreAttribut.describedby,
                valeur: lID + '_detail'
            }) : '', ' tabIndex="0">');
            H.push('<div class="wrap">');
            H.push('<h5><span>', lTitre, '</span></h5>', aActualite.auteur ? '<span>' + aActualite.auteur + '</span>' : '');
            H.push('</div>');
            if ((GEtatUtilisateur.GenreEspace === EGenreEspace.Parent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent) && aActualite.prenom) {
                H.push('<div class="circle" ie-hint="', aActualite.prenom, '">' + aActualite.prenom.substr(0, 1).toUpperCase() + '</div>');
            }
            H.push('</li>');
            return H.join('');
        };
        WidgetActualites.prototype._surActualite = function(i) {
            this.ficheActualite.SetDonnees(this.donnees.listeActualites.GetElement(i));
        };
        WidgetActualites.prototype._evenementSurFicheActualite = function() {
            if (this.ficheActualite.actualite && this.ficheActualite.actualite.avecReponse() && !this.ficheActualite.actualite.lue && (!this.ficheActualite.actualite.estSondage || this.ficheActualite.actualite.estAValider)) {
                if (this.ficheActualite.actualite.aToutRepondu()) {
                    this.ficheActualite.actualite.lue = true;
                }
                this.ficheActualite.actualite.marqueLueSeulement = false;
                this.ficheActualite.actualite.SetEtat(EGenreEtat.Modification);
                this.Valider();
            }
        };
        module.exports = WidgetActualites;
    },
    fn: "espace/script/widget/widgetactualites.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GStyle = require('GStyle.js');
        var ObjetFiche = require('ObjetFiche.js');
        MethodesObjet.heritagePrototype(ObjetFicheEvenement, ObjetFiche);

        function ObjetFicheEvenement() {
            this.inheritedCreate(arguments);
            this.largeurMax = 750;
            this.hauteurMax = 400;
            this.setOptionsFenetre({
                largeur: 300,
                hauteur: 150,
                titre: function() {
                    return this.evenement ? this.evenement.GetLibelle() : '';
                }.bind(this)
            });
        }
        ObjetFicheEvenement.prototype.SetDonnees = function(aListeEvenements, aEvenement) {
            this.listeEvenements = aListeEvenements;
            this.evenement = aEvenement;
            this.Afficher();
        };
        ObjetFicheEvenement.prototype.ComposeContenu = function() {
            var H = [];
            H.push('<div class="PetitEspace">');
            H.push('<div style="clear: both" class="PetitEspace">', '<div style="float: left; width: 12px; ', GStyle.composeCouleurFond(this.evenement.CouleurCellule), '">&nbsp;</div>', '<div style="float: left; padding:0px 5px;">', this.listeEvenements._getDateEvenement({
                evenement: this.evenement
            }), '</div>', '</div>');
            H.push('<div  style="clear: both" class="PetitEspace">', this.evenement.Commentaire, '</div>');
            if (this.evenement.listeDocJoints && this.evenement.listeDocJoints.GetNbrElements() > 0) {
                H.push('<div  style="clear: both" class="PetitEspace">', this.composeDocuments(this.evenement.listeDocJoints), '</div>');
            }
            H.push('</div>');
            return H.join('');
        };
        ObjetFicheEvenement.prototype.composeDocuments = function(aListeDocumentsJoints) {
            var lHtml = [];
            for (var I = 0; I < aListeDocumentsJoints.GetNbrElements(); I++) {
                var lDocumentJoint = aListeDocumentsJoints.GetElement(I);
                lHtml.push(GChaine.composerUrlLienExterne({
                    documentJoint: lDocumentJoint
                }));
            }
            return lHtml.join('<br/>');
        };
        module.exports = ObjetFicheEvenement;
    },
    fn: "objetficheevenement.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetFicheEvenement = require('ObjetFicheEvenement.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var GTraductions = require('ObjetTraduction.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var MethodesTableau = require('MethodesTableau.js');
        var GHtml = require('GHtml.js');
        var GDate = require('ObjetDate.js').GDate;

        function WidgetAgenda() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetAgenda, Identite);
        WidgetAgenda.prototype.getControleur = function(aInstance) {
            return {
                getNode: function(aIndice) {
                    $(this.node).on('click', function() {
                        aInstance.ficheEvenement.SetDonnees(aInstance.donnees.listeEvenements, aInstance.donnees.listeEvenements.GetElement(aIndice));
                    });
                }
            };
        };
        WidgetAgenda.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var lWidget = {
                html: _composeWidgetAgenda.call(this),
                nbrElements: this.donnees.listeEvenements.GetNbrElements(),
                afficherMessage: this.donnees.listeEvenements.GetNbrElements() === 0,
                fermerFiches: function() {
                    this.ficheEvenement.Fermer();
                }.bind(this)
            };
            $.extend(this.donnees, lWidget);
            aParams.construireWidget(aParams.donnees);
            _creerObjetstAgenda.call(this);
        };

        function _composeEvenement(aEvenement, i) {
            var H = [];
            H.push('<li tabIndex="0" ', GObjetWAI.composeRole(EGenreRole.Listitem), ' ', GObjetWAI.composeAttribut({
                genre: EGenreAttribut.label,
                valeur: aEvenement.GetLibelle() + ' ' + this.donnees.listeEvenements._getLibelleEvenement({
                    evenement: aEvenement
                }).join(',')
            }), GHtml.composeAttr('ie-node', 'getNode', i), '>');
            H.push('<div class="wrap">');
            H.push('<div class="bloc-date-conteneur">', GDate.FormatDate(aEvenement.DateDebut, '<div>%JJ</div><div>%MMM</div>'), '</div>');
            H.push('<div class="infos-agenda-conteneur">');
            H.push('<h4 title="', GTraductions.getValeur('accueil.agenda.hintLien'), '">', aEvenement.GetLibelle(), '</h4>');
            H.push('<span>' + this.donnees.listeEvenements._getDateEvenement({
                evenement: aEvenement
            }) + '</span>');
            H.push('</div>');
            H.push('</div>');
            if (aEvenement.listeEleves && aEvenement.listeEleves.length > 0) {
                H.push('<div class="liste-enfants">');
                MethodesTableau.parcourir(aEvenement.listeEleves, function(aEleve) {
                    H.push('<span class="circle" ie-hint="' + aEleve + '">', aEleve.substr(0, 1), '</span>');
                });
                H.push('</div>');
            }
            H.push('</li>');
            return H.join('');
        }

        function _creerObjetstAgenda() {
            this.ficheEvenement = ObjetFenetre.creerInstance(ObjetFicheEvenement, {
                pere: this,
                evenement: this.evenementSurFicheEvenement,
                initialiser: false
            });
            this.ficheEvenement.destructionSurFermeture = false;
            this.ficheEvenement.Initialiser();
        }

        function _composeWidgetAgenda() {
            var H = [];
            if (this.donnees.listeEvenements.GetNbrElements() > 0) {
                H.push('<ul role="list" class="liste-clickable">');
                for (var I = 0; I < this.donnees.listeEvenements.GetNbrElements(); I++) {
                    H.push(_composeEvenement.call(this, this.donnees.listeEvenements.GetElement(I), I));
                }
                H.push('</ul>');
            }
            return H.join('');
        }
        module.exports = WidgetAgenda;
    },
    fn: "espace/script/widget/widgetagenda.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeNote = require('TypeNote.js');
        var MethodesTableau = require('MethodesTableau.js');
        require('NiveauAcquisition.css');
        var EGenreNiveauDAcquisition = {
            Multiple: 100,
            Utilisateur: 0,
            Expert: 1,
            Acquis: 2,
            PresqueAcquis: 3,
            EnCoursAcquisition: 4,
            DebutAcquisition: 5,
            NonAcquis: 6,
            Absent: 7,
            NonEvalue: 8,
            Dispense: 9,
            NonRendu: 10
        };
        EGenreNiveauDAcquisition.getNombrePointsBrevet = function(aParams) {
            return !!aParams.niveauDAcquisition && !!aParams.niveauDAcquisition.nombrePointsBrevet ? aParams.niveauDAcquisition.nombrePointsBrevet : new TypeNote('');
        };
        EGenreNiveauDAcquisition.getPonderation = function(aNiveauDAcquisition) {
            return !!aNiveauDAcquisition ? aNiveauDAcquisition.ponderation : new TypeNote('');
        };
        EGenreNiveauDAcquisition.estUneAnnotation = function(aNiveauAcquisition) {
            return MethodesTableau.existe(aNiveauAcquisition.GetGenre(), [EGenreNiveauDAcquisition.Absent, EGenreNiveauDAcquisition.Dispense, EGenreNiveauDAcquisition.NonRendu]);
        };

        function getHtmlPastille(aParams) {
            var H = [];
            var lClassesNiveauAcquisition = ['NiveauAcquisition'];
            if (!!aParams.nomIcone) {
                lClassesNiveauAcquisition.push('NiveauAcquisition_Annotation');
            } else {
                lClassesNiveauAcquisition.push('NiveauAcquisition_Pastille');
            }
            if (aParams.estPastillePositionnement) {
                lClassesNiveauAcquisition.push('NiveauAcquisition_Positionnement');
            }
            var lAttributTitle = !!aParams.title ? ' title="' + aParams.title + '"' : '';
            if (!!aParams.nomIcone) {
                H.push('<span class="', lClassesNiveauAcquisition.join(' '), '"', (lAttributTitle || ''), '>', '<i class="', aParams.nomIcone, '"></i>', '</span>');
            } else {
                var lContenu = '&nbsp;';
                var lCouleurContenu = '';
                if (!!aParams.contenu) {
                    lContenu = aParams.contenu.valeur;
                    lCouleurContenu = aParams.contenu.couleur;
                }
                var lCouleurPastille = 'white';
                if (!!aParams.couleurIcone) {
                    lCouleurPastille = aParams.couleurIcone;
                }
                var lStyles = [];
                lStyles.push('background-color:', lCouleurPastille, ';');
                if (!!lCouleurContenu) {
                    lStyles.push('color: ', lCouleurContenu, ';');
                }
                H.push('<span class="', lClassesNiveauAcquisition.join(' '), '" style="', lStyles.join(''), '"', (lAttributTitle || ''), '>', lContenu, '</span>');
            }
            return H.join('');
        }

        function getNomIcone(aNiveauAcquisition) {
            var lNomIcone;
            if (!!aNiveauAcquisition) {
                switch (aNiveauAcquisition.GetGenre()) {
                    case (EGenreNiveauDAcquisition.Absent):
                        return 'icon_competence_absent';
                    case (EGenreNiveauDAcquisition.Dispense):
                        return 'icon_competence_dispense';
                    case (EGenreNiveauDAcquisition.NonRendu):
                        return 'icon_competence_non_rendu';
                    default:
                        return '';
                }
            }
            return lNomIcone;
        }

        function getCouleurIcone(aNiveauAcquisition) {
            var lCouleurIcon;
            if (!!aNiveauAcquisition) {
                if (EGenreNiveauDAcquisition.estUneAnnotation(aNiveauAcquisition)) {
                    lCouleurIcon = '#009ee1';
                } else {
                    lCouleurIcon = EGenreNiveauDAcquisition.getCouleur(aNiveauAcquisition);
                }
            }
            return lCouleurIcon;
        }
        EGenreNiveauDAcquisition.getImage = function(aNiveauAcquisition, aParams) {
            var H = [];
            if (!!aNiveauAcquisition) {
                var lValeurTitle = (!aParams || aParams.avecTitle || aParams.avecTitle === null || aParams.avecTitle === undefined ? this.getLibelle(aNiveauAcquisition) : null);
                if (GParametres.afficherAbbreviationNiveauDAcquisition || GEtatUtilisateur.estModeAccessible()) {
                    H.push('<span', (lValeurTitle ? ' title="' + lValeurTitle + '"' : ''), '>', EGenreNiveauDAcquisition.getAbbreviation(aNiveauAcquisition, aParams), '</span>');
                } else if (aNiveauAcquisition.GetGenre() >= EGenreNiveauDAcquisition.Expert) {
                    var lCouleurIcon = getCouleurIcone(aNiveauAcquisition);
                    var lContenuPastille;
                    if (aNiveauAcquisition.GetGenre() === EGenreNiveauDAcquisition.Expert) {
                        lContenuPastille = {
                            valeur: '+',
                            couleur: GCouleur.getCouleurCorrespondance(lCouleurIcon)
                        };
                    }
                    H.push(getHtmlPastille({
                        title: lValeurTitle,
                        nomIcone: getNomIcone(aNiveauAcquisition),
                        couleurIcone: lCouleurIcon,
                        contenu: lContenuPastille
                    }));
                }
            }
            return H.join('');
        };
        EGenreNiveauDAcquisition.getAbbreviation = function(aNiveauAcquisition, aParams) {
            return !!aNiveauAcquisition && (aNiveauAcquisition.existeNumero() || (!!aParams && aParams.afficherValeurPourNonRempli)) ? (aNiveauAcquisition.abbreviation || '') : '';
        };
        EGenreNiveauDAcquisition.getLibelle = function(aNiveauDAcquisition) {
            return !!aNiveauDAcquisition ? aNiveauDAcquisition.GetLibelle() : '';
        };
        EGenreNiveauDAcquisition.getCouleur = function(aNiveauDAcquisition) {
            return !!aNiveauDAcquisition ? aNiveauDAcquisition.couleur : 'white';
        };
        EGenreNiveauDAcquisition.ordre = function() {
            return [
                this.Expert, this.Acquis, this.PresqueAcquis, this.EnCoursAcquisition, this.DebutAcquisition, this.NonAcquis, this.Absent, this.NonEvalue, this.Dispense, this.NonRendu, this.Utilisateur
            ];
        };
        EGenreNiveauDAcquisition.getImagePositionnement = function(aParams) {
            var H = [];
            if (aParams.niveauDAcquisition) {
                var lNiveauDAcquisition = aParams.niveauDAcquisition;
                var lValeurTitle = (aParams.avecTitle || aParams.avecTitle === null || aParams.avecTitle === undefined ? this.getLibellePositionnement(aParams) : null);
                if (GParametres.afficherAbbreviationNiveauDAcquisition || GEtatUtilisateur.estModeAccessible()) {
                    H.push('<span', (lValeurTitle ? ' title="' + lValeurTitle + '"' : ''), '>', getAbbreviationPositionnement(lNiveauDAcquisition, aParams), '</span');
                } else if (lNiveauDAcquisition.GetGenre() >= EGenreNiveauDAcquisition.Expert) {
                    var lCouleurIcone = getCouleurIcone(lNiveauDAcquisition);
                    var lContenuPastille;
                    if (lNiveauDAcquisition.GetGenre() === EGenreNiveauDAcquisition.Expert) {
                        lContenuPastille = {
                            valeur: 4
                        };
                    } else if (lNiveauDAcquisition.GetGenre() === EGenreNiveauDAcquisition.Acquis) {
                        lContenuPastille = {
                            valeur: 3
                        };
                    } else if (lNiveauDAcquisition.GetGenre() === EGenreNiveauDAcquisition.EnCoursAcquisition) {
                        lContenuPastille = {
                            valeur: 2
                        };
                    } else if (lNiveauDAcquisition.GetGenre() === EGenreNiveauDAcquisition.NonAcquis) {
                        lContenuPastille = {
                            valeur: 1
                        };
                    }
                    if (!!lContenuPastille) {
                        lContenuPastille.couleur = GCouleur.getCouleurCorrespondance(lCouleurIcone);
                    }
                    H.push(getHtmlPastille({
                        estPastillePositionnement: true,
                        title: lValeurTitle,
                        nomIcone: getNomIcone(lNiveauDAcquisition),
                        couleurIcone: lCouleurIcone,
                        contenu: lContenuPastille
                    }));
                }
            }
            return H.join('');
        };
        EGenreNiveauDAcquisition.getLibellePositionnement = function(aParams) {
            var lPositionnement = !!aParams.niveauDAcquisition.listePositionnements.GetNbrElements() ? aParams.niveauDAcquisition.listePositionnements.GetElementParGenre(aParams.genrePositionnement) : null;
            return (!!lPositionnement && (lPositionnement.GetLibelle() || !!aParams.avecPositionnementVide) ? lPositionnement.GetLibelle() : aParams.niveauDAcquisition.GetLibelle());
        };

        function getAbbreviationPositionnement(aNiveauAcquisition, aParams) {
            var lPositionnement = aNiveauAcquisition.listePositionnements ? aNiveauAcquisition.listePositionnements.GetElementParGenre(aParams.genrePositionnement) : null;
            var result = '';
            if ((!!lPositionnement && lPositionnement.abbreviation) || aParams.avecPositionnementVide) {
                result = (aParams.avecPrefixe ? lPositionnement.abbreviationAvecPrefixe : lPositionnement.abbreviation);
            } else {
                result = EGenreNiveauDAcquisition.getAbbreviation(aNiveauAcquisition, aParams);
            }
            return result;
        }
        module.exports = EGenreNiveauDAcquisition;
    },
    fn: "enumere_niveaudacquisition.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeFichierExterneHttpSco = {
            Aucun: 'Aucun',
            EvaluationSujet: 'EvaluationSujet',
            EvaluationCorrige: 'EvaluationCorrige',
            DevoirSujet: 'DevoirSujet',
            DevoirCorrige: 'DevoirCorrige',
            TAFRenduEleve: 'TAFRenduEleve',
            TAFCorrigeRenduEleve: 'TAFCorrigeRenduEleve'
        };
        module.exports.TypeFichierExterneHttpSco = TypeFichierExterneHttpSco;
    },
    fn: "typefichierexternehttpsco.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var ObjetElement = require('ObjetElement.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;
        var EformatDocJoint = require('Enumere_FormatDocJoint.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;

        function WidgetCompetences() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetCompetences, Identite);
        WidgetCompetences.prototype.creerObjetstCompetences = function() {};
        WidgetCompetences.prototype.initialiserObjetsCompetences = function() {};
        WidgetCompetences.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.creerObjetstCompetences();
            this.ordre = EGenreNiveauDAcquisition.ordre();
            this.donnees.listeEvaluations.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant), ObjetTri.init('matiere.Libelle')]);
            this.donnees.listeEvaluations.trier();
            var H = [];
            H.push('<ul role="list" class="liste-clickable">');
            for (var i = 0; i < this.donnees.listeEvaluations.GetNbrElements(); i++) {
                var lEvaluation = this.donnees.listeEvaluations.GetElement(i);
                H.push(this.composeEvaluation(lEvaluation, i));
            }
            H.push('</ul>');
            var lWidget = {
                html: H.join(''),
                nbrElements: this.donnees.listeEvaluations.GetNbrElements(),
                afficherMessage: this.donnees.listeEvaluations.GetNbrElements() === 0
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
            this.initialiserObjetsCompetences();
        };
        WidgetCompetences.prototype.composeEvaluation = function(aEvaluation, aIndex) {
            var H = [];
            aEvaluation.listeNiveauxDAcquisitions.setTri([ObjetTri.init('ordre')]);
            aEvaluation.listeNiveauxDAcquisitions.trier();
            var lStrDate = [];
            if (aEvaluation.date) {
                lStrDate.push(GDate.FormatDate(aEvaluation.date, '[' + GTraductions.getValeur('Le') + ' ' + '%J %MMM' + ']'));
            }
            if (GEtatUtilisateur.pourPrimaire() && aEvaluation.coefficient === 0) {
                if (lStrDate.length > 0) {
                    lStrDate.push(' ');
                }
                lStrDate.push('(', GTraductions.getValeur('evaluations.NonComptabiliseDansBilan'), ')');
            }
            var lWAI = GObjetWAI.composeAttribut({
                genre: EGenreAttribut.label,
                valeur: GTraductions.getValeur('Matiere') + ' : ' + aEvaluation.matiere.GetLibelle()
            });
            H.push('<li role="listitem" tabindex="0" ', lWAI, ' onclick="' + this.Nom + '._surDernieresEvaluationClick(' + aIndex + ')">', '<div class="wrap">', '<h4><span>', aEvaluation.matiere.GetLibelle(), '</span></h4>', '<div class="infos-conteneur">', '<span class="date">', lStrDate.join(''), '</span>');
            if (aEvaluation.libelleCorrige || aEvaluation.libelleSujet) {
                H.push('<div class="liste-infos">');
                if (aEvaluation.libelleSujet) {
                    var lLienSujet = getLienSujetCorrige(aEvaluation, true);
                    var lTypefile = EformatDocJoint.getClassIconDeGenre(TypeFichierExterneHttpSco.DevoirSujet);
                    H.push('<span class="file-contain icon ', lTypefile, '" title="' + GTraductions.getValeur('TelechargerSujet') + '" onclick="event.stopPropagation();">', '<a class="file-name" href="', lLienSujet, '">&nbsp;', GTraductions.getValeur('AfficherSujet'), '</a>', '</span>');
                    if (aEvaluation.libelleCorrige) {
                        var lLienCorrige = getLienSujetCorrige(aEvaluation, false);
                        lTypefile = EformatDocJoint.getClassIconDeGenre(TypeFichierExterneHttpSco.DevoirCorrige);
                        H.push('<span class="file-contain  icon ', lTypefile, '" title="' + GTraductions.getValeur('TelechargerCorrige') + '" onclick="event.stopPropagation();">', '<a class="file-name" href="', lLienCorrige, '">&nbsp;', GTraductions.getValeur('AfficherCorrige'), '</a>', '</span>');
                        if (!!aEvaluation.executionQCM && !!aEvaluation.executionQCM.fichierDispo && !!aEvaluation.executionQCM.publierCorrige) {
                            H.push('<span class="as-info">', GTraductions.getValeur('AfficherCorrige'), '</span>');
                        }
                    }
                }
                H.push('</div>');
            }
            H.push('</div>', '</div>');
            H.push('<div class="evaluations-conteneur">');
            aEvaluation.listeNiveauxDAcquisitions.parcourir(function(D) {
                var lHintNiveauDAcquisition = '';
                if (!!D.item) {
                    lHintNiveauDAcquisition = D.item.GetLibelle();
                } else if (!!D.domaine) {
                    lHintNiveauDAcquisition = D.domaine.GetLibelle();
                }
                var lNiveauDAcquisitionGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParNumero(D.GetNumero());
                var lImage = EGenreNiveauDAcquisition.getImage(lNiveauDAcquisitionGlobal, {
                    avecTitle: false
                });
                var lWAITitle = GTraductions.getValeur('competences.niveauDeMaitrise') + ': ' + EGenreNiveauDAcquisition.getLibelle(lNiveauDAcquisitionGlobal);
                H.push('<span', (!!lHintNiveauDAcquisition ? ' tabindex="0" title="' + GTraductions.getValeur('competences.evaluations') + ': ' + GChaine.toTitle(lHintNiveauDAcquisition) + '" aria-label="' + lWAITitle + '" ' : ''), '>', lImage, '</span>');
            });
            H.push('</div>');
            H.push('</li>');
            return H.join('');
        };

        function getLienSujetCorrige(aEvaluation, aPourSujet) {
            var lDocumentJoint = new ObjetElement((aPourSujet ? aEvaluation.libelleSujet : aEvaluation.libelleCorrige), aEvaluation.GetNumero(), EGenreDocumentJoint.Fichier);
            var lGenreRessource = aPourSujet ? TypeFichierExterneHttpSco.EvaluationSujet : TypeFichierExterneHttpSco.EvaluationCorrige;
            var lLibelleEcran = aPourSujet ? GTraductions.getValeur('AfficherSujet') : GTraductions.getValeur('AfficherCorrige');
            return GChaine.composerUrlLienExterne({
                documentJoint: lDocumentJoint,
                genreRessource: lGenreRessource,
                libelleEcran: lLibelleEcran,
                brut: true
            });
        }
        WidgetCompetences.prototype.surCorrige = function(i) {
            var lEvaluation = this.donnees.listeEvaluations.GetElement(i);
            if (!!lEvaluation) {
                this.afficherExecutionQCM(lEvaluation.executionQCM);
            }
        };
        WidgetCompetences.prototype._surDernieresEvaluationClick = function(i) {
            var lEvaluation = this.donnees.listeEvaluations.GetElement(i);
            GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Evaluation, lEvaluation);
            if (!!this.donnees.page) {
                this.donnees.page.periode = lEvaluation.periode;
            }
            if (GEtatUtilisateur.estEspaceMobile()) {
                this.evenementPage({
                    genreOngletDest: this.donnees.page.Onglet
                });
            } else {
                this.evenementPage(this.genreEvenement.selectionPage, this.donnees.page);
            }
        };
        module.exports = WidgetCompetences;
    },
    fn: "espace/script/widget/widgetcompetences.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreAffichageCahierDeTextes = {
            TravailAFaire: 0,
            ContenuDeCours: 1,
            QCM: 2,
            CahierDeTextes: 3
        };
        module.exports = EGenreAffichageCahierDeTextes;
    },
    fn: "enumere_affichagecahierdetextes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeModeCorrectionQCM = {
            FBQ_CorrigeSans: 0,
            FBQ_CorrigeApresQuestion: 1,
            FBQ_CorrigeALaFin: 2
        };
        module.exports.TypeModeCorrectionQCM = TypeModeCorrectionQCM;
    },
    fn: "typemodecorrectionqcm.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeGenreRenduTAF = {
            GRTAF_AucunRendu: 0,
            GRTAF_RenduPapier: 1,
            GRTAF_RenduPronote: 2,
            GRTAF_RenduKiosque: 3
        };
        module.exports.TypeGenreRenduTAF = TypeGenreRenduTAF;
        TypeGenreRenduTAF.getLibelle = function(aGenre) {
            switch (aGenre) {
                case this.GRTAF_AucunRendu:
                    return GTraductions.getValeur('CahierDeTexte.TAFARendre.AucunRenduPrevu');
                case this.GRTAF_RenduPapier:
                    return GTraductions.getValeur('CahierDeTexte.TAFARendre.ARemettre');
                case this.GRTAF_RenduPronote:
                    return GTraductions.getValeur('CahierDeTexte.TAFARendre.ADeposer');
                case this.GRTAF_RenduKiosque:
                    return GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeur');
                default:
                    ;
                    return '';
            }
        };
        TypeGenreRenduTAF.getOrdre = function(aGenre) {
            return [0, 1, 2, 3][aGenre];
        };
        TypeGenreRenduTAF.toElement = function(aGenre) {
            var lElement = new ObjetElement(TypeGenreRenduTAF.getLibelle(aGenre), 0, aGenre);
            lElement.ordre = TypeGenreRenduTAF.getOrdre(aGenre);
            return lElement;
        };
        TypeGenreRenduTAF.fromElement = function(aElt) {
            return (aElt !== null) && (aElt !== undefined) ? aElt.GetGenre() : TypeGenreRenduTAF.GRTAF_AucunRendu;
        };
        TypeGenreRenduTAF.toListe = function(aGenresAExclure) {
            var lListe = new ObjetListeElements();
            for (var iRendu in TypeGenreRenduTAF) {
                var lElement, lRendu = TypeGenreRenduTAF[iRendu];
                if (MethodesObjet.isNumber(lRendu) && (!aGenresAExclure || !MethodesTableau.existe(lRendu, aGenresAExclure))) {
                    lElement = TypeGenreRenduTAF.toElement(lRendu);
                    lListe.AddElement(lElement);
                }
            }
            lListe.setTri([ObjetTri.init('ordre')]);
            lListe.trier();
            return lListe;
        };
    },
    fn: "typegenrerendutaf.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeHttpMarqueurContenuCours = {
            hmcc_ReservePar: 0,
            hmcc_LibelleHoraire: 1,
            hmcc_TitreCDT: 2,
            hmcc_Remplacant: 3,
            hmcc_PeriodeAnnuel: 4,
            hmcc_PartiesCours: 5
        };
        module.exports.TypeHttpMarqueurContenuCours = TypeHttpMarqueurContenuCours;
    },
    fn: "typehttpmarqueurcontenucours.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GLog = require('IELog.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var TypeModeCorrectionQCM = require('TypeModeCorrectionQCM.js').TypeModeCorrectionQCM;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var TypeGenrePunition = require('TypeGenrePunition.js').TypeGenrePunition;
        var TypeGenreRenduTAF = require('TypeGenreRenduTAF.js').TypeGenreRenduTAF;
        var TypeHttpMarqueurContenuCours = require('TypeHttpMarqueurContenuCours.js').TypeHttpMarqueurContenuCours;

        function ObjetDeserialiser() {}
        ObjetDeserialiser.prototype.listeEvenementsVS = function(aListe, aPourAccueil) {
            this.pourAccueil = aPourAccueil;
            aListe.parcourir(_enrichirEvenementVS.bind(this, aListe));
            aListe.setTri([ObjetTri.init('aRegulariser', EGenreTriElement.Decroissant), ObjetTri.init(function(D) {
                return D.dateDebut ? D.dateDebut : D.dateDemande;
            }, EGenreTriElement.Decroissant)]);
            aListe.trier();
            return aListe;
        };

        function _enrichirEvenementVS(aListe, aElement) {
            new ObjetDeserialiser()._formaterEvenementVS({
                element: aElement,
                pourAccueil: this.pourAccueil,
                liste: aListe
            });
        }
        ObjetDeserialiser.prototype._formaterEvenementVS = function(aParam) {
            aParam.element.avecSaisie = aParam.element.avecSaisie ? true : false;
            if (aParam.element.date) {
                aParam.element.dateDebut = aParam.element.date;
                aParam.element.dateFin = aParam.element.date;
            }
            if (!aParam.element.dateFin) {
                aParam.element.dateFin = aParam.element.dateDebut;
            }
            aParam.element.estDemiJournee = aParam.element.estMatin ? true : false;
            if (aParam.element.GetGenre() === EGenreRessource.Punition && ((aParam.element.nature.GetGenre() === TypeGenrePunition.GP_ExclusionCours) || !aParam.pourAccueil)) {
                aParam.element.dateDebut = aParam.element.dateDemande;
                aParam.element.dateFin = aParam.element.dateDemande;
                aParam.element.place = aParam.element.placeDemande;
                if (!aParam.pourAccueil && aParam.liste) {
                    for (var I = 0; aParam.element.programmation && (I < aParam.element.programmation.GetNbrElements()); I++) {
                        var lNewElement = MethodesObjet.dupliquer(aParam.element);
                        var lProg = aParam.element.programmation.GetElement(I);
                        lNewElement.dateDebut = lProg.date;
                        lNewElement.dateFin = lProg.date;
                        lNewElement.estProgrammation = true;
                        if ((lProg.place !== null && lProg.place !== undefined)) {
                            lNewElement.place = lProg.place;
                        }
                        if (lProg.duree) {
                            lNewElement.duree = lProg.duree;
                        } else {
                            lNewElement.duree = aParam.element.duree;
                        }
                        lNewElement.Position = EGenreRessource.getPositionAbsence({
                            genre: lNewElement.GetGenre(),
                            genreObservation: lNewElement.genreObservation,
                            genreNature: lNewElement.nature.GetGenre()
                        });
                        aParam.liste.AddElement(lNewElement);
                    }
                }
            }
            if (aParam.element.programmation) {
                aParam.element.programmation.setTri([ObjetTri.init('date')]);
                aParam.element.programmation.trier();
            }
            var lObjet = {
                genre: aParam.element.GetGenre(),
                estLue: aParam.element.estLue
            };
            if ((aParam.element.nature !== null && aParam.element.nature !== undefined)) {
                lObjet.genreNature = aParam.element.nature.GetGenre();
            }
            if (aParam.element.GetGenre() === EGenreRessource.ObservationProfesseurEleve) {
                lObjet.genreObservation = aParam.element.genreObservation;
            }
            aParam.element.Position = EGenreRessource.getPositionAbsence(lObjet);
            aParam.element.aRegulariser = this._evenementVSARegulariser(aParam.element);
        };
        ObjetDeserialiser.prototype._evenementVSARegulariser = function(aElement) {
            switch (aElement.GetGenre()) {
                case (EGenreRessource.Absence):
                case (EGenreRessource.Retard):
                    return aElement.avecSaisie && !aElement.motifParent;
                case (EGenreRessource.ObservationProfesseurEleve):
                    return !aElement.estLue;
                case (EGenreRessource.Punition):
                    return aElement.nature && aElement.nature.estAvecARParent && !aElement.parentAAccuseDeReception ? true : false;
                default:
                    return false;
            }
        };
        ObjetDeserialiser.prototype.listeCours = function(aJSON) {
            var lListe = new ObjetListeElements().fromJSON(aJSON.ListeCours, this._ajouterCours.bind(this));
            lListe.setTri([ObjetTri.init('DateDuCours')]);
            lListe.trier();
            return lListe;
        };
        ObjetDeserialiser.prototype._ajouterCours = function(aJSON, aElement) {
            aElement.copieJSON(aJSON);
            aElement.Debut = aElement.place;
            aElement.Fin = aElement.place + aElement.duree - 1;
            if (aJSON.estSortiePedagogique) {
                aElement.couleurFondHorsBordure = '#FFFFFF';
                aElement.ListeContenus = new ObjetListeElements();
                var lElement = Object.assign(new ObjetElement(GTraductions.getValeur('EDT.AbsRess.SortiePedagogique')), {
                    marqueur: 'titreSortie',
                    estLibelleTitreSortie: true
                });
                aElement.ListeContenus.AddElement(lElement);
                lElement = Object.assign(new ObjetElement(aElement.strDateDebut), {
                    marqueur: 'titreSortie'
                });
                aElement.ListeContenus.AddElement(lElement);
                if (aElement.strDateFin) {
                    lElement = Object.assign(new ObjetElement(aElement.strDateFin), {
                        marqueur: 'titreSortie'
                    });
                    aElement.ListeContenus.AddElement(lElement);
                }
                lElement = Object.assign(new ObjetElement(aElement.motif), {
                    marqueur: 'motifSortie'
                });
                aElement.ListeContenus.AddElement(lElement);
                if (aElement.accompagnateurs && aElement.accompagnateurs.forEach) {
                    aElement.accompagnateurs.forEach(function(aStr) {
                        aElement.ListeContenus.AddElement(new ObjetElement(aStr, 0, EGenreRessource.Enseignant));
                    });
                }
            } else if (aJSON.estRetenue) {
                aElement.CouleurFond = '#FF0000';
                aElement.couleurFondHorsBordure = '#FFFFFF';
            } else {
                aElement.estAnnule = !!aJSON.estAnnule;
                aElement.estPermanence = !!aJSON.estPermanence;
                aElement.AppelFait = (aElement.NomImageAppelFait === 'AppelFait') || (aElement.NomImageAppelFait === 'AppelVerrouFait');
                aElement.estAppelVerrouille = (aElement.NomImageAppelFait === 'AppelVerrouNonFait') || (aElement.NomImageAppelFait === 'AppelVerrouFait');
                aElement.AvecCdT = aElement.cahierDeTextes && aElement.cahierDeTextes.existeNumero();
                aElement.utilisable = aJSON.utilisable === false ? false : true;
                aElement.utilisableCDT = aJSON.utilisableCDT === false ? false : true;
                aElement.utilisableAppel = aJSON.utilisableAppel === false ? false : true;
                aElement.modifiable = !!aJSON.modifiable;
                aElement.ressourcesModifiables = !!aJSON.ressourcesModifiables;
                aElement.verrouDeplacement = !!aJSON.verrouDeplacement;
                aElement.cdtAffecte = aJSON.CahierDeTextes && aJSON.CahierDeTextes.Affecte;
                aElement.avecTafPublie = aJSON.AvecTafPublie;
                aElement.avecChargeTAF = !!aJSON.AvecChargeTAF;
                aElement.estGAEV = !!aJSON.estGAEV;
                aElement.estCoEnseignement = !!aJSON.estCoEnseignement;
                aElement.ListeContenus.parcourir(function(aContenu) {
                    if (aContenu.GetGenre() === EGenreRessource.Matiere) {
                        aElement.matiere = aContenu;
                    }
                    if (aContenu.GetGenre() === EGenreRessource.Materiel || aContenu.GetGenre() === EGenreRessource.Salle) {
                        aContenu.nombre = aContenu.nombre || 1;
                    }
                });
                aElement.ListeContenus.setTri([
                    ObjetTri.init(function(D) {
                        switch (D.GetGenre()) {
                            case EGenreRessource.Matiere:
                                return -1;
                            case EGenreRessource.LibelleCours:
                                return -0.4;
                            case EGenreRessource.Enseignant:
                                return 0;
                            case EGenreRessource.Groupe:
                                return 1;
                            case EGenreRessource.Classe:
                                return 2;
                            case EGenreRessource.PartieDeClasse:
                                return 3;
                            case EGenreRessource.Salle:
                                return 4;
                            case EGenreRessource.Site:
                                return 5;
                            case EGenreRessource.Personnel:
                                return 6;
                            case EGenreRessource.Materiel:
                                return 7;
                            case EGenreRessource.Service:
                                return 8;
                        }
                        switch (D.marqueur) {
                            case TypeHttpMarqueurContenuCours.hmcc_ReservePar:
                                return -0.6;
                            case TypeHttpMarqueurContenuCours.hmcc_LibelleHoraire:
                                return 99999;
                            case TypeHttpMarqueurContenuCours.hmcc_TitreCDT:
                                return -0.5;
                            case TypeHttpMarqueurContenuCours.hmcc_Remplacant:
                                return 4.5;
                            case TypeHttpMarqueurContenuCours.hmcc_PeriodeAnnuel:
                                return -9999;
                            case TypeHttpMarqueurContenuCours.hmcc_PartiesCours:
                                return -10;
                        };
                        return 1000;
                    }), ObjetTri.init('Libelle')
                ]);
                aElement.ListeContenus.trier();
                if (aElement.matiere) {
                    aElement.matiere.CouleurFond = aElement.CouleurFond;
                }
            }
            if (aElement.DateDuCours) {
                aElement.numeroSemaine = IE.Cycles.cycleDeLaDate(aElement.DateDuCours);
            }
        };
        ObjetDeserialiser._aUnElementVide = function() {
            var lResult = false;
            for (var I = 0; I < this.GetNbrElements() && !lResult; I++) {
                if (this.Existe(I) && (this.GetElement(I).estVide)) {
                    lResult = true;
                }
            }
            return lResult;
        };
        ObjetDeserialiser._verifierAvantValidation = function() {
            for (var I = 0; I < this.GetNbrElements(); I++) {
                if (this.Existe(I) && (this.GetElement(I).estVide)) {
                    if (!this.GetElement(I).executionQCM) {
                        this.GetElement(I).SetEtat(EGenreEtat.Suppression);
                    }
                }
            }
        };
        ObjetDeserialiser.prototype._ajouterQCM = function(aJSON, aElement) {
            aElement.copieJSON(aJSON);
            if (aElement.GetGenre() === EGenreRessource.ExecutionQCM) {
                aElement.QCM = new ObjetElement().fromJSON(aJSON.QCM);
                aElement.QCM.copieJSON(aJSON.QCM);
                var lEspaceQCMConsult = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Parent, EGenreEspace.PrimParent, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Accompagnant, EGenreEspace.PrimAccompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant, EGenreEspace.Entreprise]);
                if (lEspaceQCMConsult && (aElement.etatCloture === undefined || aElement.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_EnCours)) {
                    aElement.modeDiffusionCorrige = TypeModeCorrectionQCM.FBQ_CorrigeSans;
                    GLog.addLog('modification modeDiffusionCorrige');
                }
            } else {
                aElement.niveau = new ObjetElement().fromJSON(aJSON.niveau);
                aElement.proprietaire = new ObjetElement().fromJSON(aJSON.proprietaire);
            }
            if (!aElement.matiere || !$.isFunction(aElement.matiere.existeNumero)) {
                aElement.matiere = new ObjetElement().fromJSON(aJSON.matiere);
            }
        };
        ObjetDeserialiser.prototype.getListeEvenements = function(aJSON, aCroissant) {
            var lListeEvenements = new ObjetListeElements().fromJSON(aJSON, _ajouterEvenement);
            lListeEvenements.setTri([
                ObjetTri.init(function(D) {
                    return D.sansHoraire ? new Date(D.DateDebut.getFullYear(), D.DateDebut.getMonth(), D.DateDebut.getDate()) : D.DateDebut;
                }, aCroissant ? EGenreTriElement.Croissant : EGenreTriElement.Decroissant), ObjetTri.init(function(D) {
                    return D.sansHoraire ? new Date(D.DateFin.getFullYear(), D.DateFin.getMonth(), D.DateFin.getDate()) : D.DateFin;
                }, aCroissant ? EGenreTriElement.Croissant : EGenreTriElement.Decroissant), ObjetTri.init('Libelle')
            ]);
            lListeEvenements.trier();
            lListeEvenements._getLibelleEvenement = _getLibelleEvenement;
            lListeEvenements._getDateEvenement = _getDateEvenement;
            return lListeEvenements;
        };

        function _ajouterEvenement(aJSON, aElement) {
            aElement.DateDebut = aJSON.DateDebut;
            aElement.DateFin = aJSON.DateFin;
            aElement.sansHoraire = aJSON.sansHoraire;
            aElement.Commentaire = aJSON.Commentaire;
            aElement.CouleurCellule = aJSON.CouleurCellule;
            aElement.estConseilClasse = aJSON.estConseilClasse;
            aElement.famille = aJSON.famille;
            aElement.strAuteur = aJSON.strAuteur;
            aElement.estPeriodique = aJSON.estPeriodique;
            aElement.periodicite = aJSON.Periodicite;
            aElement.publie = !aJSON.nonPublie;
            aElement.proprietaire = aJSON.Proprietaire;
            aElement.listeEleves = aJSON.listeEleves;
            aElement.genresPublicEntite = aJSON.genresPublicEntite;
            aElement.avecElevesRattaches = aJSON.avecElevesRattaches;
            aElement.listePublicEntite = aJSON.listePublicEntite;
            aElement.listePublicIndividu = aJSON.listePublicIndividu;
            aElement.avecDirecteur = !!aJSON.avecDirecteur;
            aElement.listeDocJoints = new ObjetListeElements().fromJSON(aJSON.PiecesJointes, _ajouterDocJoint);
            aElement.navigation = aJSON.navigation;
        }

        function _ajouterDocJoint(aJSON, aElement) {
            aElement.url = aJSON.url;
            aElement.Url = GChaine.composerUrlLienExterne({
                documentJoint: aElement,
                brut: true
            });
        }

        function _composeListeDelegues(aTitre, aListe) {
            var lResult = '';
            lResult += aTitre + ' : ';
            var lArrayDelegues = [];
            for (var I = 0; I < aListe.GetNbrElements() && I < 2; I++) {
                var lElement = aListe.GetElement(I);
                lArrayDelegues.push(lElement.GetLibelle());
            }
            lResult += lArrayDelegues.join(', ');
            if (aListe.GetNbrElements() > 2) {
                lResult += ', ...';
            }
            return lResult;
        }

        function _getLibelleEvenement(aParam) {
            var lTab = [],
                lParam = {
                    evenement: null,
                    avecTitre: false,
                    avecDetailConseil: false,
                    avecDateDuJour: true,
                    formatDateDuJour: '[' + GTraductions.getValeur('Le').ucfirst() + ' %J %MMMM' + ']'
                };
            $.extend(lParam, aParam);
            if (lParam.avecTitre) {
                lTab.push(lParam.evenement.GetLibelle());
            }
            var lChaine = GDate.strDates(lParam.evenement.DateDebut, lParam.evenement.DateFin, {
                sansHoraire: lParam.evenement.sansHoraire
            });
            lTab.push(lChaine.trim());
            lTab.push(lParam.evenement.Commentaire);
            if (lParam.avecDetailConseil) {
                if (lParam.evenement.salle) {
                    lTab.push(GTraductions.getValeur('Agenda.Salle') + ' : ' + lParam.evenement.salle);
                }
                if (lParam.evenement.president && lParam.evenement.president.GetLibelle()) {
                    lTab.push(GTraductions.getValeur('Agenda.President') + ' : ' + lParam.evenement.president.GetLibelle());
                }
                if (lParam.evenement.listeParentsDelegues && lParam.evenement.listeParentsDelegues.GetNbrElements() > 0) {
                    lTab.push(_composeListeDelegues(GTraductions.getValeur('Agenda.ParentsDelegues'), lParam.evenement.listeParentsDelegues));
                }
                if (lParam.evenement.listeElevesDelegues && lParam.evenement.listeElevesDelegues.GetNbrElements() > 0) {
                    lTab.push(_composeListeDelegues(GTraductions.getValeur('Agenda.ElevesDelegues'), lParam.evenement.listeElevesDelegues));
                }
            }
            return lTab;
        }

        function _getDateEvenement(aParam) {
            var lParam = {
                evenement: null,
                avecDateDuJour: true,
                formatDateDuJour: '[' + GTraductions.getValeur('Le') + ' %J %MMM' + ']'
            };
            $.extend(lParam, aParam);
            var lChaine = GDate.strDates(lParam.evenement.DateDebut, lParam.evenement.DateFin, {
                sansHoraire: lParam.evenement.sansHoraire,
                formatDate: ' %J %MMM'
            });
            return lChaine.toLowerCase().ucfirst();
        }
        ObjetDeserialiser.prototype.deserialiserTAF = function(aTAF) {
            if (aTAF.avecMiseEnForme === undefined || aTAF.avecMiseEnForme === null) {
                aTAF.avecMiseEnForme = true;
            }
            aTAF.descriptif = GChaine.nettoyerCommentaire(aTAF.descriptif);
            aTAF.estVide = false;
            if (!aTAF.genreRendu) {
                aTAF.genreRendu = TypeGenreRenduTAF.GRTAF_AucunRendu;
            }
            if (!aTAF.ListePieceJointe) {
                aTAF.ListePieceJointe = new ObjetListeElements();
            }
            aTAF.ListePieceJointe.parcourir(function(aPieceJointeDeTAF) {
                aPieceJointeDeTAF.Url = GChaine.composerUrlLienExterne({
                    documentJoint: aPieceJointeDeTAF,
                    brut: true
                });
            });
            if (!!aTAF.executionQCM) {
                var lExecutionQCMaRemplir = new ObjetElement();
                new ObjetDeserialiser()._ajouterQCM(aTAF.executionQCM, lExecutionQCMaRemplir);
                aTAF.executionQCM = lExecutionQCMaRemplir;
            }
        };
        ObjetDeserialiser.prototype.deserialiserContenuDeCours = function(aContenuCours) {
            aContenuCours.descriptif = GChaine.nettoyerCommentaire(aContenuCours.descriptif);
            aContenuCours.objectifs = GChaine.nettoyerCommentaire(aContenuCours.objectifs || '');
            if (!aContenuCours.categorie) {
                aContenuCours.categorie = new ObjetElement('', 0);
            }
            aContenuCours.estVide = false;
            if (!aContenuCours.ListePieceJointe) {
                aContenuCours.ListePieceJointe = new ObjetListeElements();
            }
            aContenuCours.ListePieceJointe.parcourir(function(aPieceJointeDeContenuDeCours) {
                aPieceJointeDeContenuDeCours.Url = GChaine.composerUrlLienExterne({
                    documentJoint: aPieceJointeDeContenuDeCours,
                    brut: true
                });
            });
            aContenuCours.ListePieceJointe.setTri([
                ObjetTri.init(function(D) {
                    return D.GetGenre() !== EGenreDocumentJoint.Fichier;
                }), ObjetTri.init('Libelle'), ObjetTri.init('Numero')
            ]).trier();
            aContenuCours.listeExecutionQCM = new ObjetListeElements();
            if (!!aContenuCours.training) {
                var lDeserialiser = new ObjetDeserialiser();
                aContenuCours.listeExecutionQCM = new ObjetListeElements().fromJSON(aContenuCours.training.ListeExecutionsQCM, lDeserialiser._ajouterQCM.bind(lDeserialiser));
            }
        };
        ObjetDeserialiser.prototype.deserialiserCahierDeTexte = function(aCahierDeTexte) {
            var lThis = this;
            if (!aCahierDeTexte.listeContenus) {
                aCahierDeTexte.listeContenus = new ObjetListeElements();
            }
            aCahierDeTexte.listeContenus.parcourir(function(aContenu) {
                lThis.deserialiserContenuDeCours(aContenu);
            });
            aCahierDeTexte.listeContenus.aUnElementVide = ObjetDeserialiser._aUnElementVide;
            aCahierDeTexte.listeContenus.verifierAvantValidation = ObjetDeserialiser._verifierAvantValidation;
            if (!!aCahierDeTexte.Matiere) {
                aCahierDeTexte.Matiere.CouleurFond = aCahierDeTexte.CouleurFond;
            }
            if (!aCahierDeTexte.ListeTravailAFaire) {
                aCahierDeTexte.ListeTravailAFaire = new ObjetListeElements();
            }
            aCahierDeTexte.ListeTravailAFaire.parcourir(function(aTaf) {
                lThis.deserialiserTAF(aTaf);
            });
            aCahierDeTexte.ListeTravailAFaire.setTri([ObjetTri.init('DonneLe'), ObjetTri.init('Genre')]);
            aCahierDeTexte.ListeTravailAFaire.trier();
            aCahierDeTexte.ListeTravailAFaire.aUnElementVide = ObjetDeserialiser._aUnElementVide;
            aCahierDeTexte.ListeTravailAFaire.verifierAvantValidation = ObjetDeserialiser._verifierAvantValidation;
        };
        module.exports = ObjetDeserialiser;
    },
    fn: "objetdeserialiser.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var EGenreAffichageCahierDeTextes = require('Enumere_AffichageCahierDeTextes.js');
        var ObjetDeserialiser = require('ObjetDeserialiser.js');

        function ObjetRequeteFicheCDT() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('FicheCDT', ObjetRequeteFicheCDT, ObjetRequeteConsultation);
        ObjetRequeteFicheCDT.prototype.lancerRequete = function(aParametres) {
            var lParametres = {
                pourCDT: false,
                pourTAF: false,
                cahierDeTextes: undefined,
                cours: undefined,
                numeroSemaine: undefined,
                matiere: undefined,
                date: undefined,
                contenu: undefined,
                TAF: undefined
            };
            $.extend(lParametres, aParametres);
            this.JSON = {
                pourCDT: lParametres.pourCDT,
                pourTAF: lParametres.pourTAF,
                cahierDeTextes: lParametres.cahierDeTextes,
                cours: lParametres.cours,
                numeroSemaine: lParametres.numeroSemaine,
                matiere: lParametres.matiere,
                date: lParametres.date,
                contenu: lParametres.contenu,
                TAF: lParametres.TAF
            };
            return this.appelAsynchrone();
        };
        ObjetRequeteFicheCDT.prototype.actionApresRequete = function() {
            var lGenreAffichageCDT;
            if (this.JSON.pourTAF) {
                lGenreAffichageCDT = EGenreAffichageCahierDeTextes.TravailAFaire;
            } else {
                lGenreAffichageCDT = EGenreAffichageCahierDeTextes.ContenuDeCours;
            }
            var lObjetDeserialiser = new ObjetDeserialiser();
            var lCahierDeTexte = new ObjetElement();
            if (!!this.JSONReponse.listeCahiersDeTexte && this.JSONReponse.listeCahiersDeTexte.GetNbrElements() > 0 && !!this.JSONReponse.listeCahiersDeTexte.GetElement(0)) {
                lCahierDeTexte = this.JSONReponse.listeCahiersDeTexte.GetElement(0);
            }
            lObjetDeserialiser.deserialiserCahierDeTexte(lCahierDeTexte);
            this.callbackReussite.appel(lGenreAffichageCDT, lCahierDeTexte);
        };
        module.exports = ObjetRequeteFicheCDT;
    },
    fn: "objetrequetefichecdt.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreLienDS = require('Enumere_LienDS.js');
        var ObjetRequeteFicheCDT = require('ObjetRequeteFicheCDT.js');
        var EGenreOnglet = require('Enumere_Onglet.js');

        function WidgetDS() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetDS, Identite);
        WidgetDS.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            if (this.donnees.listeDS) {
                this.donnees.listeDS.setTri([ObjetTri.init('dateDebut')]);
                this.donnees.listeDS.trier();
            }
            var lWidget = {
                html: this.composeWidgetDS(EGenreLienDS.tGL_Devoir),
                nbrElements: this.donnees.listeDS.GetNbrElements()
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetDS.prototype.composeWidgetDS = function(aGenreLienDS) {
            var H = [];
            this.donnees.listeDS = this.donnees.listeDS ? this.donnees.listeDS : (this.donneesSurveille ? this.donneesSurveille.listeDS : null);
            if (this.donnees.listeDS) {
                H.push('<ul class="liste-clickable" role="list">');
                for (var i = 0; i < this.donnees.listeDS.GetNbrElements(); i++) {
                    var lDS = this.donnees.listeDS.GetElement(i);
                    if (lDS.GetGenre() === aGenreLienDS) {
                        var lStrDate = GDate.FormatDate(lDS.dateDebut, '[' + GTraductions.getValeur('Le') + ' ' + '%JJJJ %J %MMM' + ']' + ' ' + GTraductions.getValeur('De') + ' ' + '%hh%sh%mm') + GDate.FormatDate(lDS.dateFin, ' ' + GTraductions.getValeur('A') + ' ' + '%hh%sh%mm');
                        H.push('<li onclick="', this.Nom, '.surDS (', i, ')" onkeyup="if (GNavigateur.IsToucheSelection ()) ', this.Nom, '.surDS (', i, ')">', '<div class="wrap">', '<div class="bloc-date-conteneur">', GDate.FormatDate(lDS.dateDebut, '<div>%JJ</div><div>%MMM</div>'), '</div>', '<div class="infos-ds-conteneur">', '<h4>', lDS.matiere.GetLibelle(), '</<h4>', '<h5 class="as-libelle">', lDS.GetLibelle(), '</h5>', '<span class="date">', lStrDate.ucfirst(), '</span>', lDS.listeSalles ? '<span> - ' + (lDS.listeSalles.GetNbrElements() ? GTraductions.getValeur('Salle') : GTraductions.getValeur('Salles')) + ' ' + lDS.listeSalles.getTableauLibelles().join(', ') + '</span>' : '', '</div>', '</div>', '</li>');
                    }
                }
                H.push('</ul>');
            }
            return H.join('');
        };
        WidgetDS.prototype.surDS = function(i) {
            var lDS = this.donnees.listeDS ? this.donnees.listeDS.GetElement(i) : this.donneesSurveille.listeDS.GetElement(i);
            if (this._actionSurRequeteFicheCDT) {
                new ObjetRequeteFicheCDT(this, this._actionSurRequeteFicheCDT.bind(this)).lancerRequete({
                    pourCDT: true,
                    contenu: lDS
                });
            } else {
                GEtatUtilisateur.setNavigationDate(lDS.dateDebut);
                this.evenementPage({
                    genreOngletDest: EGenreOnglet.CDT_Contenu
                });
            }
        };
        module.exports = WidgetDS;
    },
    fn: "espace/script/widget/widgetds.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var WidgetDS = require('espace/script/widget/WidgetDS.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreLienDS = require('Enumere_LienDS.js');

        function WidgetDSEvaluation() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetDSEvaluation, WidgetDS);
        WidgetDSEvaluation.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.donneesSurveille = aParams.instance.donnees.devoirSurveille;
            if (this.donneesSurveille.listeDS) {
                this.donneesSurveille.listeDS.setTri([ObjetTri.init('dateDebut')]);
                this.donneesSurveille.listeDS.trier();
            }
            var lWidget = {
                html: this.composeWidgetDS(EGenreLienDS.tGL_Evaluation),
                nbrElements: this.donnees.listeDS.GetNbrElements()
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        module.exports = WidgetDSEvaluation;
    },
    fn: "espace/script/widget/widgetdsevaluations.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieElectionVotant() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieElectionVotant', ObjetRequeteSaisieElectionVotant, ObjetRequeteSaisie);
        ObjetRequeteSaisieElectionVotant.prototype.lancerRequete = function(aParam) {
            this.JSON.election = aParam.election.toJSONAll();
            aParam.election.vote.setSerialisateurJSON({
                ignorerEtatsElements: true
            });
            this.JSON.election.vote = aParam.election.vote;
            return this.appelAsynchrone();
        };
        module.exports = ObjetRequeteSaisieElectionVotant;
    },
    fn: "objetrequetesaisieelectionvotant.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreCandidatElection = {
            GCE_Liste: 0,
            GCE_Individu: 1,
            GCE_Blanc: 2
        };
        module.exports.TypeGenreCandidatElection = TypeGenreCandidatElection;
    },
    fn: "typegenrecandidatelection.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Identite = require('ObjetIdentite.js');
        var ObjetRequeteSaisieElectionVotant = require('ObjetRequeteSaisieElectionVotant.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var GDate = require('ObjetDate.js').GDate;
        var MethodesTableau = require('MethodesTableau.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetElement = require('ObjetElement.js');
        var GChaine = require('GChaine.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreAction = require('Enumere_Action.js');
        var TypeThemeBouton = require('Type_ThemeBouton.js');
        var EGenreReponseSaisie = require('ObjetRequeteJSON.js').EGenreReponseSaisie;
        var TypeGenreCandidatElection = require('TypeGenreCandidatElection.js').TypeGenreCandidatElection;
        var EformatDocJoint = require('Enumere_FormatDocJoint.js');

        function WidgetElections() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetElections, Identite);
        WidgetElections.prototype.composeWidgetElections = function() {
            var H = [];
            if (!!this.donnees.listeElections && this.donnees.listeElections.GetNbrElements() > 0) {
                for (var I = 0; I < this.donnees.listeElections.GetNbrElements(); I++) {
                    var lElement = this.donnees.listeElections.GetElement(I);
                    H.push(this.composeElection(lElement, I));
                }
            }
            return H.join('');
        };
        WidgetElections.prototype.composeElection = function(aElection, aIndiceElection) {
            var H = [];
            var lID = this.donnees.id + '_div_' + aIndiceElection;
            var lTitre = aElection.GetLibelle() || GTraductions.getValeur('accueil.elections.sansTitre');
            H.push('<div id="', lID, '" ', GObjetWAI.composeRole(EGenreRole.Treeitem), GObjetWAI.composeAttribut({
                genre: EGenreAttribut.expanded,
                valeur: (aIndiceElection === 0 ? 'true' : 'false')
            }), GObjetWAI.composeAttribut({
                genre: EGenreAttribut.labelledby,
                valeur: lID + '_wai'
            }), aIndiceElection === 0 ? GObjetWAI.composeAttribut({
                genre: EGenreAttribut.describedby,
                valeur: lID + '_detail'
            }) : '', ' tabIndex="-1">');
            var lFormat = '%JJ %MMMM %AAAA';
            if (aElection.ouvert) {
                H.push('<div class="vote-header">', '<h4>', lTitre, '</h4>', '<p>', GTraductions.getValeur('accueil.elections.voteOuvertDuAu', [GDate.FormatDate(aElection.dateDebut, lFormat), GDate.FormatDate(aElection.dateFin, lFormat)]), '</p>');
                if (aElection.description) {
                    H.push(aElection.description);
                }
                if (aElection.nbMaxChoix > 1) {
                    H.push('<p class="nombre-choix">', GTraductions.getValeur('accueil.elections.nbMaxChoix', ['<span>' + aElection.nbMaxChoix + '</span>']), '</p>');
                }
                H.push('</div>');
                if (aElection.documents && aElection.documents.GetNbrElements() > 0) {
                    H.push('<div class="vote-files">');
                    for (var aIndiceDoc = 0; aIndiceDoc < aElection.documents.GetNbrElements(); aIndiceDoc++) {
                        var lDocumentJoint = aElection.documents.GetElement(aIndiceDoc);
                        var lSuffixe = lDocumentJoint.GetLibelle().split('.');
                        var lTypefile = EformatDocJoint.getClassIconDeGenre(EformatDocJoint.getGenreDeFichier(lSuffixe[lSuffixe.length - 1]));
                        H.push('<a href="', GChaine.composerUrlLienExterne({
                            documentJoint: lDocumentJoint,
                            genreRessource: EGenreRessource.DocJointEtablissement,
                            brut: true
                        }), '" class="icon ' + lTypefile + '">', lDocumentJoint.GetLibelle(), '</a>');
                    }
                    H.push('</div>');
                }
                H.push(this.composeListeCandidats(aElection, aIndiceElection));
                H.push('<div class="vote-footer">', '<ie-bouton  ie-model="btnVote(', aIndiceElection, ')">', GTraductions.getValeur('accueil.elections.voter'), '</ie-bouton>', '</div>');
            } else {
                H.push('<div class="vote-header">', '<h4>', GTraductions.getValeur('accueil.elections.prochainementOuverture'), ' : <br />', lTitre, '</h4>', '<p>', GTraductions.getValeur('accueil.elections.leVoteSeraOuvertDuAu', [GDate.FormatDate(aElection.dateDebut, lFormat), GDate.FormatDate(aElection.dateFin, lFormat)]), '</p>', '</div>');
            }
            H.push(GObjetWAI.composeSpan(lTitre, lID + '_wai'));
            H.push('</div>');
            return H.join('');
        };
        WidgetElections.prototype.composeListeCandidats = function(aElection, aIndiceElection) {
            var H = [];
            if (!!aElection.candidats && aElection.candidats.GetNbrElements() > 0) {
                H.push('<ul role="list" class="liste-clickable one-line">');
                aElection.candidats.parcourir(function(aCandidat, aIndiceCandidat) {
                    H.push('<li role="listitem" tabindex="0">', _composeCandidat(aCandidat, aIndiceElection, aIndiceCandidat, (aElection.nbMaxChoix > 1)), '</li>');
                });
                H.push('</ul>');
            }
            return H.join('');
        };

        function _composeCandidat(aCandidat, aIndiceElection, aIndiceCandidat, aAvecChoixMultiple) {
            var lChoixCandidat;
            if (!aAvecChoixMultiple) {
                lChoixCandidat = _composeRadioCandidat(aCandidat, aIndiceElection, aIndiceCandidat);
            } else {
                lChoixCandidat = _composeCBCandidat(aCandidat, aIndiceElection, aIndiceCandidat);
            }
            return lChoixCandidat;
        }

        function _composeCBCandidat(aCandidat, aIndiceElection, aIndiceCandidat) {
            var H = [];
            H.push('<ie-checkbox ie-textleft ie-model="cbChoixCandidat(', aIndiceElection, ', ', aIndiceCandidat, ')">', '<span class="libelle">', aCandidat.GetLibelle(), '</span>');
            if (aCandidat.GetGenre() === TypeGenreCandidatElection.GCE_Liste) {
                H.push('<i class="icon icon_info_sign" ie-node="btnAfficherConstitutionListe(', aIndiceElection, ', ', aIndiceCandidat, ')"></i>');
            }
            H.push('</ie-checkbox>');
            return H.join('');
        }

        function _composeRadioCandidat(aCandidat, aIndiceElection, aIndiceCandidat) {
            var lNameGroupeRadio = 'election_' + aIndiceElection;
            var H = [];
            H.push('<ie-radio ie-textleft ie-model="rdChoixCandidat(', aIndiceElection, ', ', aIndiceCandidat, ')" name="', lNameGroupeRadio, '">', '<span class="libelle">', aCandidat.GetLibelle(), '</span>');
            if (aCandidat.GetGenre() === TypeGenreCandidatElection.GCE_Liste) {
                H.push('<i class="icon icon_info_sign" ie-node="btnAfficherConstitutionListe(', aIndiceElection, ', ', aIndiceCandidat, ')" ></i>');
            }
            H.push('</ie-checkbox>');
            return H.join('');
        }
        WidgetElections.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            if (this.donnees.listeElections && this.donnees.listeElections.GetNbrElements() > 0) {
                this.donnees.listeElections.setTri([ObjetTri.init('dateDebut'), ObjetTri.init('dateFin')]);
                this.donnees.listeElections.trier();
                var lWidget = {
                    html: this.composeWidgetElections(),
                    nbrElements: this.donnees.listeElections.GetNbrElements(),
                    afficherMessage: this.donnees.listeElections.GetNbrElements() === 0
                };
                $.extend(true, this.donnees, lWidget);
                var lThis = this;
                $.extend(this.controleur, {
                    rdChoixCandidat: {
                        getValue: function(aIndiceElection, aIndiceCandidat) {
                            if (!lThis.donnees) {
                                return false;
                            }
                            var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                            var lCandidat = lElection.candidats.GetElement(aIndiceCandidat);
                            if (!lElection.vote || lElection.vote.GetNbrElements() === 0) {
                                return false;
                            } else {
                                return MethodesTableau.existe(lCandidat.GetNumero(), lElection.vote.getTableauNumeros());
                            }
                        },
                        setValue: function(aIndiceElection, aIndiceCandidat, aValue) {
                            if (!lThis.donnees) {
                                return false;
                            }
                            var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                            var lCandidat = lElection.candidats.GetElement(aIndiceCandidat);
                            if (aValue) {
                                lElection.vote = new ObjetListeElements();
                                lElection.vote.AddElement(lCandidat);
                            }
                        }
                    },
                    cbChoixCandidat: {
                        getValue: function(aIndiceElection, aIndiceCandidat) {
                            if (!lThis.donnees) {
                                return false;
                            }
                            var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                            var lCandidat = lElection.candidats.GetElement(aIndiceCandidat);
                            if (!lElection.vote || lElection.vote.GetNbrElements() === 0) {
                                return false;
                            } else {
                                return MethodesTableau.existe(lCandidat.GetNumero(), lElection.vote.getTableauNumeros());
                            }
                        },
                        setValue: function(aIndiceElection, aIndiceCandidat, aValue) {
                            if (!lThis.donnees) {
                                return false;
                            }
                            var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                            var lCandidat = lElection.candidats.GetElement(aIndiceCandidat);
                            if (!lElection.vote) {
                                lElection.vote = new ObjetListeElements();
                            }
                            var lNumero = lCandidat.GetNumero();
                            var lIndice = lElection.vote.getIndiceElementParFiltre(function(aElement) {
                                return aElement.GetNumero() === lNumero;
                            });
                            if (aValue) {
                                if (lIndice === -1) {
                                    lElection.vote.AddElement(lCandidat);
                                }
                            } else {
                                if (lIndice !== -1) {
                                    lElection.vote.remove(lIndice);
                                }
                            }
                        },
                        getDisabled: function(aIndiceElection, aIndiceCandidat) {
                            if (!lThis.donnees || !lThis.donnees.listeElections) {
                                return false;
                            }
                            var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                            if (!lElection || !lElection.vote) {
                                return false;
                            } else {
                                var lCandidat = lElection.candidats.GetElement(aIndiceCandidat);
                                var lNumero = lCandidat.GetNumero();
                                var lCandidatEstSelectionne = lElection.vote.getIndiceElementParFiltre(function(aElement) {
                                    return aElement.GetNumero() === lNumero;
                                }) > -1;
                                return (lElection.vote.GetNbrElements() >= lElection.nbMaxChoix) && !lCandidatEstSelectionne;
                            }
                        }
                    },
                    btnAfficherConstitutionListe: function(aIndiceElection, aIndiceCandidat) {
                        $(this.node).on({
                            'click': function() {
                                if (lThis.donnees && lThis.donnees.listeElections) {
                                    var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                                    var lListeCandidate = lElection.candidats.GetElement(aIndiceCandidat);
                                    if (lListeCandidate && lListeCandidate.membres && lListeCandidate.membres.GetNbrElements() > 0) {
                                        lListeCandidate.membres.trier();
                                        var lHtml = [];
                                        lHtml.push('<div>', GTraductions.getValeur('accueil.elections.constitutionDeLaListe', [lListeCandidate.GetLibelle()]), '</div>');
                                        lHtml.push('<div class="Espace">');
                                        lHtml.push('<ul>');
                                        lListeCandidate.membres.parcourir(function(aMembreDeListeCandidate) {
                                            lHtml.push('<li>');
                                            lHtml.push(aMembreDeListeCandidate.GetLibelle());
                                            if (!!aMembreDeListeCandidate.statut) {
                                                lHtml.push(' - <span class="Gras">', aMembreDeListeCandidate.statut, '</span>');
                                            }
                                            lHtml.push('</li>');
                                        });
                                        lHtml.push('</ul>');
                                        lHtml.push('</div>');
                                        GApplication.getMessage().afficher({
                                            type: EGenreBoiteMessage.Information,
                                            titre: GTraductions.getValeur('accueil.elections.candidatsConstitutifsDesListes'),
                                            message: lHtml.join('')
                                        });
                                    }
                                }
                                return false;
                            }
                        });
                    },
                    btnVote: {
                        event: function(aIndiceElection) {
                            if (lThis.donnees && lThis.donnees.listeElections) {
                                var lElection = lThis.donnees.listeElections.GetElement(aIndiceElection);
                                if ((lElection.nbMaxChoix === 1) && (!lElection.vote || lElection.vote.GetNbrElements() === 0)) {
                                    GApplication.getMessage().afficher({
                                        type: EGenreBoiteMessage.Information,
                                        message: GTraductions.getValeur('accueil.elections.aucunChoixEffectue')
                                    });
                                } else {
                                    var lElectionPourVote = new ObjetElement(lElection.GetLibelle(), lElection.GetNumero(), lElection.GetGenre());
                                    if (!lElection.vote && lElection.nbMaxChoix > 1) {
                                        lElection.vote = new ObjetListeElements();
                                    }
                                    lElectionPourVote.vote = MethodesObjet.dupliquer(lElection.vote);
                                    var lHtml = [];
                                    lHtml.push('<div>', GTraductions.getValeur('accueil.elections.confirmationVote', [lElection.GetLibelle()]), '</div>');
                                    lHtml.push('<div class="Espace">');
                                    lHtml.push('<ul>');
                                    if (lElection.vote.GetNbrElements() === 0 && lElection.nbMaxChoix > 1) {
                                        lHtml.push('<li>', GTraductions.getValeur('accueil.elections.neSePrononcePas'), '</li>');
                                    }
                                    for (var i = 0; i < lElection.vote.GetNbrElements(); i++) {
                                        lHtml.push('<li>', lElection.vote.GetLibelle(i), '</li>');
                                    }
                                    lHtml.push('</ul>');
                                    lHtml.push('</div>');
                                    GApplication.getMessage().afficher({
                                        type: EGenreBoiteMessage.Confirmation,
                                        message: lHtml.join(''),
                                        listeBoutons: [{
                                            libelle: GTraductions.getValeur('Oui'),
                                            theme: TypeThemeBouton.primaire,
                                            genreAction: EGenreAction.Valider
                                        }, {
                                            libelle: GTraductions.getValeur('Non'),
                                            theme: TypeThemeBouton.secondaire,
                                            genreAction: EGenreAction.NePasValider
                                        }],
                                        callback: function(aElection, aAccepte) {
                                            if (aAccepte === EGenreAction.Valider) {
                                                this.titreElection = aElection.GetLibelle();
                                                new ObjetRequeteSaisieElectionVotant(lThis, lThis.actionApresSaisieVotant).lancerRequete({
                                                    election: aElection
                                                });
                                            }
                                        }.bind(lThis, lElectionPourVote)
                                    });
                                }
                            }
                        }
                    }
                });
            }
            aParams.construireWidget(this.donnees);
        };
        WidgetElections.prototype.actionApresSaisieVotant = function(aJSONRapport) {
            if (aJSONRapport.genreReponse === EGenreReponseSaisie.succes && aJSONRapport.JSONRapportSaisie.vote) {
                GApplication.getMessage().afficher({
                    type: EGenreBoiteMessage.Information,
                    titre: this.titreElection ? this.titreElection : undefined,
                    message: GTraductions.getValeur('accueil.elections.votePrisEnCompte') + '<br />' + GTraductions.getValeur('accueil.elections.merciParticipation'),
                    callback: function() {
                        this.RecupererDonnees([this.donnees.genre]);
                    }.bind(this)
                });
            }
        };
        module.exports = WidgetElections;
    },
    fn: "espace/script/widget/widgetelections.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreDemiJours = {
            Matin: 0,
            ApresMidi: 1
        };
        module.exports = EGenreDemiJours;
    },
    fn: "enumere_demijours.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Requetes = require('CollectionRequetes.js');
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var ObjetFenetre = require('ObjetFenetre.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetElement = require('ObjetElement.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var TypeThemeBouton = require('Type_ThemeBouton.js');
        var EGenreAction = require('Enumere_Action.js');
        require('ObjetFenetre_SaisieVisiosCours.css');
        Requetes.inscrire('SaisieURLCours', ObjetRequeteSaisie);
        var TypeBoutonFenetreSaisieVisiosCours = {
            Supprimer: 'supprimer',
            Annuler: 'annuler',
            Valider: 'valider'
        };
        MethodesObjet.heritagePrototype(ObjetFenetre_SaisieVisiosCours, ObjetFenetre);

        function ObjetFenetre_SaisieVisiosCours() {
            this.inheritedCreate(arguments);
            this.setOptionsFenetre({
                titre: GTraductions.getValeur('FenetreSaisieVisiosCours.URLAssocieeAuCours'),
                largeur: 500,
                hauteur: 300,
                listeBoutons: [{
                    libelle: GTraductions.getValeur('Supprimer'),
                    theme: TypeThemeBouton.secondaire,
                    typeBouton: TypeBoutonFenetreSaisieVisiosCours.Supprimer
                }, {
                    libelle: GTraductions.getValeur('Annuler'),
                    theme: TypeThemeBouton.secondaire,
                    typeBouton: TypeBoutonFenetreSaisieVisiosCours.Annuler
                }, {
                    libelle: GTraductions.getValeur('Valider'),
                    theme: TypeThemeBouton.primaire,
                    typeBouton: TypeBoutonFenetreSaisieVisiosCours.Valider
                }]
            });
            this.saisieDirecte = false;
            this.callbackOuvrirLienVisio = null;
            this.tailleMaxChamps = {
                libelle: 60,
                commentaire: 255
            };
            this.donnees = {
                cours: null
            };
        }

        function estLienTesterURLVisible(aVisioCours) {
            var lEstLienVisible = true;
            if (!aVisioCours || !aVisioCours.url || aVisioCours.url.length === 0) {
                lEstLienVisible = false;
            }
            return lEstLienVisible;
        }

        function afficherMasquerLienTest(aVisible) {
            var $lienTestUrl = $('.ObjetFenetreSaisieVisiosCours .TestChampURL');
            if (aVisible) {
                $lienTestUrl.show();
            } else {
                $lienTestUrl.hide();
            }
        }
        ObjetFenetre_SaisieVisiosCours.prototype.getVisioCours = function() {
            var lVisioCours = null;
            if (!!this.donnees.cours) {
                if (!this.donnees.cours.listeVisios) {
                    this.donnees.cours.listeVisios = new ObjetListeElements();
                }
                if (this.donnees.cours.listeVisios.GetNbrElementsExistes() === 0) {
                    var lNouveauVisio = new ObjetElement();
                    lNouveauVisio.SetEtat(EGenreEtat.Creation);
                    this.donnees.cours.listeVisios.add(lNouveauVisio);
                }
                lVisioCours = this.donnees.cours.listeVisios.GetPremierElement();
            }
            return lVisioCours;
        };
        ObjetFenetre_SaisieVisiosCours.prototype.getNbVisiosProgrammesSurLaJournee = function() {
            var lNbVisios = 0;
            if (!!this.donnees.cours) {
                lNbVisios = this.donnees.cours.nbVisiosMaxProgrammes || 0;
            }
            return lNbVisios;
        };
        ObjetFenetre_SaisieVisiosCours.prototype.getControleur = function(aInstance) {
            return {
                getNodeTestURL: function() {
                    $(this.node).on('click', function(event) {
                        event.preventDefault();
                        if (!!aInstance.callbackOuvrirLienVisio) {
                            var lVisioCours = aInstance.getVisioCours();
                            aInstance.callbackOuvrirLienVisio(lVisioCours);
                        }
                    });
                },
                modelURL: {
                    getValue: function() {
                        var lVisioCours = aInstance.getVisioCours();
                        return lVisioCours ? (lVisioCours.url || '') : '';
                    },
                    setValue: function(aValue) {
                        var lVisioCours = aInstance.getVisioCours();
                        if (!!lVisioCours) {
                            lVisioCours.url = aValue;
                            lVisioCours.SetEtat(EGenreEtat.Modification);
                        }
                        afficherMasquerLienTest(estLienTesterURLVisible(lVisioCours));
                    }
                },
                modelLibelleLien: {
                    getValue: function() {
                        var lVisioCours = aInstance.getVisioCours();
                        return lVisioCours ? (lVisioCours.libelleLien || '') : '';
                    },
                    setValue: function(aValue) {
                        var lVisioCours = aInstance.getVisioCours();
                        if (!!lVisioCours) {
                            lVisioCours.libelleLien = aValue;
                            lVisioCours.SetEtat(EGenreEtat.Modification);
                        }
                    }
                },
                modelCommentaire: {
                    getValue: function() {
                        var lVisioCours = aInstance.getVisioCours();
                        return lVisioCours ? (lVisioCours.commentaire || '') : '';
                    },
                    setValue: function(aValue) {
                        var lVisioCours = aInstance.getVisioCours();
                        if (!!lVisioCours) {
                            lVisioCours.commentaire = aValue;
                            lVisioCours.SetEtat(EGenreEtat.Modification);
                        }
                    }
                },
                afficherNbVisiosProgrammes: function() {
                    return aInstance.getNbVisiosProgrammesSurLaJournee() > 0;
                },
                getStrNbVisiosProgrammes: function() {
                    var lNbVisios = aInstance.getNbVisiosProgrammesSurLaJournee();
                    if (lNbVisios > 1) {
                        return GTraductions.getValeur('FenetreSaisieVisiosCours.XCoursEnVisioProgrammes', [lNbVisios]);
                    } else {
                        return GTraductions.getValeur('FenetreSaisieVisiosCours.1CoursEnVisioProgramme');
                    }
                }
            };
        };
        ObjetFenetre_SaisieVisiosCours.prototype.setAvecSaisieDirecte = function(aSaisieDirecte) {
            this.saisieDirecte = !!aSaisieDirecte;
        };
        ObjetFenetre_SaisieVisiosCours.prototype.setCallbackOuvrirLienVisio = function(aCallbackOuvrirLienVisio) {
            this.callbackOuvrirLienVisio = aCallbackOuvrirLienVisio;
        };
        ObjetFenetre_SaisieVisiosCours.prototype.setDonnees = function(aCours, aParametres) {
            this.donnees.cours = aCours;
            if (!!aParametres) {
                if (aParametres.tailleMaxLibelle) {
                    this.tailleMaxChamps.libelle = aParametres.tailleMaxLibelle;
                }
                if (aParametres.tailleMaxCommentaire) {
                    this.tailleMaxChamps.commentaire = aParametres.tailleMaxCommentaire;
                }
            }
            var lVisioCours = this.getVisioCours();
            this.setBoutonVisible(0, lVisioCours.Etat !== EGenreEtat.Creation);
            this.Afficher();
            if (!estLienTesterURLVisible(lVisioCours)) {
                afficherMasquerLienTest(false);
            }
        };
        ObjetFenetre_SaisieVisiosCours.prototype.ComposeContenu = function() {
            var T = [];
            T.push('<div class="ObjetFenetreSaisieVisiosCours">');
            T.push('<div class="LigneChamp">', '<div class="ChampNom">', GTraductions.getValeur('FenetreSaisieVisiosCours.ChampURL'), ' : ', GTraductions.getValeur('FenetreSaisieVisiosCours.MarqueurChampObligatoire'), '<span class="TestChampURL" ie-node="getNodeTestURL"><a href="#">', GTraductions.getValeur('FenetreSaisieVisiosCours.TesterURL'), '</a></span>', '</div>', '<input ie-model="modelURL" ie-trim class="style-input"/>', '</div>');
            T.push('<div class="LigneChamp">', '<div class="ChampNom">', GTraductions.getValeur('FenetreSaisieVisiosCours.ChampLibelleURL'), ' :', '</div>', '<input ie-model="modelLibelleLien" ie-trim class="style-input" maxlength="', this.tailleMaxChamps.libelle, '"/>', '</div>');
            T.push('<div class="LigneChamp">', '<div class="ChampNom">', GTraductions.getValeur('FenetreSaisieVisiosCours.ChampCommentaireURL'), ' :', '</div>', '<ie-textareamax style="height: 6rem; border: solid 1px gray; border-radius: 0.5rem;" ie-model="modelCommentaire" maxlength="', this.tailleMaxChamps.commentaire, '"></ie-textareamax>', '</div>');
            T.push('<div ie-if="afficherNbVisiosProgrammes()">', '<span ie-html="getStrNbVisiosProgrammes()"></span>', '</div>');
            T.push('</div>');
            return T.join('');
        };
        ObjetFenetre_SaisieVisiosCours.prototype.ComposeBas = function() {
            return GTraductions.getValeur('FenetreSaisieVisiosCours.MarqueurChampObligatoire') + ' ' + GTraductions.getValeur('FenetreSaisieVisiosCours.ChampObligatoire');
        };
        ObjetFenetre_SaisieVisiosCours.prototype.SurValidation = function(aNumeroBouton) {
            var lVisioCours = this.getVisioCours();
            if (!lVisioCours) {
                this.Fermer();
                return;
            }
            var lTypeBouton = TypeBoutonFenetreSaisieVisiosCours.Annuler;
            var lBouton = this.getBoutonNumero(aNumeroBouton);
            if (!!lBouton && lBouton.typeBouton !== undefined) {
                lTypeBouton = lBouton.typeBouton;
            }
            if (lTypeBouton === TypeBoutonFenetreSaisieVisiosCours.Valider) {
                var lMessagesChampsObligatoires = [];
                if (!lVisioCours.url || lVisioCours.url.length === 0) {
                    lMessagesChampsObligatoires.push(GTraductions.getValeur('FenetreSaisieVisiosCours.ChampURLEstObligatoire'));
                }
                if (lMessagesChampsObligatoires.length > 0) {
                    GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Information,
                        message: lMessagesChampsObligatoires.join('<br/>')
                    });
                    return;
                }
            }
            var lThis = this;
            (lTypeBouton === TypeBoutonFenetreSaisieVisiosCours.Supprimer ? new Promise(function(aResolve) {
                GApplication.getMessage().afficher({
                    type: EGenreBoiteMessage.Confirmation,
                    message: GTraductions.getValeur('FenetreSaisieVisiosCours.ConfirmationSuppression'),
                    callback: function(aNumeroBouton) {
                        if (aNumeroBouton === EGenreAction.Valider) {
                            aResolve();
                        }
                    }
                });
            }) : Promise.resolve()).then(function() {
                if (lTypeBouton === TypeBoutonFenetreSaisieVisiosCours.Supprimer) {
                    lVisioCours.SetEtat(EGenreEtat.Suppression);
                } else if (lTypeBouton !== TypeBoutonFenetreSaisieVisiosCours.Valider) {
                    if (lVisioCours.Etat === EGenreEtat.Creation) {
                        lVisioCours.SetEtat(EGenreEtat.Suppression);
                    }
                }
                if (lThis.saisieDirecte && (lTypeBouton === TypeBoutonFenetreSaisieVisiosCours.Valider || lTypeBouton === TypeBoutonFenetreSaisieVisiosCours.Supprimer)) {
                    var lParamsSaisie = {
                        cours: lThis.donnees.cours.toJSON(),
                        listeVisioCours: lThis.donnees.cours.listeVisios
                    };
                    lParamsSaisie.cours.dateCours = lThis.donnees.cours.DateDuCours;
                    lParamsSaisie.listeVisioCours.setSerialisateurJSON({
                        methodeSerialisation: function(aElement, AJSON) {
                            AJSON.url = aElement.url;
                            AJSON.libelleLien = aElement.libelleLien;
                            AJSON.commentaire = aElement.commentaire;
                        }
                    });
                    Requetes('SaisieURLCours', lThis, function() {
                        lThis.callback.appel(lTypeBouton);
                        lThis.Fermer();
                    }).lancerRequete(lParamsSaisie);
                } else {
                    lThis.callback.appel(lTypeBouton, lThis.donnees);
                    lThis.Fermer();
                }
            });
        };
        module.exports = {
            ObjetFenetre_SaisieVisiosCours: ObjetFenetre_SaisieVisiosCours,
            TypeBoutonFenetreSaisieVisiosCours: TypeBoutonFenetreSaisieVisiosCours
        };
    },
    fn: "objetfenetre_saisievisioscours.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetFenetre = require('ObjetFenetre.js');
        var GChaine = require('GChaine.js');
        var ObjetFenetre_SaisieVisiosCours = require('ObjetFenetre_SaisieVisiosCours.js').ObjetFenetre_SaisieVisiosCours;
        var TypeBoutonFenetreSaisieVisiosCours = require('ObjetFenetre_SaisieVisiosCours.js').TypeBoutonFenetreSaisieVisiosCours;

        function UtilitaireVisios() {}
        UtilitaireVisios.prototype.getTailleMaxLibelle = function() {
            return 50;
        };
        UtilitaireVisios.prototype.getTailleMaxCommentaire = function() {
            return 255;
        };
        UtilitaireVisios.prototype.getNomIconeParametrageVisios = function() {
            return 'icon_cours_virtuel_lien';
        };
        UtilitaireVisios.prototype.getNomIconePresenceVisios = function() {
            return 'icon_cours_virtuel';
        };
        UtilitaireVisios.prototype.getHintListeVisiosCours = function(aListeVisiosCours) {
            var H = [];
            if (!!aListeVisiosCours && aListeVisiosCours.GetNbrElementsExistes() > 0) {
                aListeVisiosCours.parcourir(function(aVisioCours) {
                    if (!!aVisioCours.libelleLien) {
                        H.push('<span style="font-weight: bold;">', aVisioCours.libelleLien, '</span>');
                    } else if (!!aVisioCours.url) {
                        H.push(aVisioCours.url);
                    }
                    if (!!aVisioCours.commentaire) {
                        if (H.length > 0) {
                            H.push('<br/>');
                        }
                        H.push(aVisioCours.commentaire);
                    }
                });
            }
            return H.join('');
        };
        UtilitaireVisios.prototype.ouvrirLiensVisioCours = function(aListeVisiosCours) {
            if (!!aListeVisiosCours && aListeVisiosCours.GetNbrElementsExistes() > 0) {
                this.ouvrirLienVisioCours(aListeVisiosCours.GetPremierElement());
            }
        };
        UtilitaireVisios.prototype.ouvrirLienVisioCours = function(aVisioCours) {
            if (!!aVisioCours && !!aVisioCours.url) {
                var lURLCorrigee = GChaine.verifierURLHttp(aVisioCours.url);
                window.open(lURLCorrigee);
            }
        };
        UtilitaireVisios.prototype.ouvrirFenetreEditionVisiosCours = function(aCours, aCallbackApresModification) {
            var lFenetre = ObjetFenetre.creerInstance(ObjetFenetre_SaisieVisiosCours, {
                pere: this,
                evenement: function(aNumeroBouton) {
                    if (aNumeroBouton !== TypeBoutonFenetreSaisieVisiosCours.Annuler) {
                        if (!!aCallbackApresModification) {
                            aCallbackApresModification();
                        }
                    }
                }
            });
            lFenetre.setAvecSaisieDirecte(true);
            lFenetre.setCallbackOuvrirLienVisio(this.ouvrirLienVisioCours);
            lFenetre.setDonnees(aCours, {
                tailleMaxLibelle: this.getTailleMaxLibelle(),
                tailleMaxCommentaire: this.getTailleMaxCommentaire()
            });
        };
        module.exports = UtilitaireVisios;
    },
    fn: "utilitairevisios.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var UtilitaireVisios = require('UtilitaireVisios.js');

        function UtilitaireVisiosSco() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(UtilitaireVisiosSco, UtilitaireVisios);
        UtilitaireVisios.prototype.getTailleMaxLibelle = function() {
            return GParametres.tailleMaxLibelleUrlCours;
        };
        UtilitaireVisios.prototype.getTailleMaxCommentaire = function() {
            return GParametres.tailleMaxCommentaireUrlCours;
        };
        module.exports = {
            UtilitaireVisios: new UtilitaireVisios()
        };
    },
    fn: "utilitairevisiossco.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Identite = require('ObjetIdentite.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var EGenreDemiJours = require('Enumere_DemiJours.js');
        var UtilitaireVisios = require('UtilitaireVisiosSco.js').UtilitaireVisios;
        var GChaine = require('GChaine.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;

        function WidgetEnseignementADistance() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetEnseignementADistance, Identite);
        WidgetEnseignementADistance.prototype.existeWidgetEnseignementADistance = function() {
            return !this.donnees || !!this.donnees.actif;
        };
        WidgetEnseignementADistance.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var lWidget = {
                html: this.composeWidgetEnseignementADistance(),
                nbrElements: compterNombreLignesWidget(this.donnees),
                afficherMessage: false
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };

        function compterNombreLignesWidget(aDonnees) {
            var lNbLignes = 0;
            if (aDonnees && aDonnees.jours) {
                aDonnees.jours.parcourir(function(aJourEnseignements) {
                    if (aJourEnseignements.jourEntier) {
                        lNbLignes++;
                    } else {
                        if (aJourEnseignements.enEtablissement && aJourEnseignements.aDistance) {
                            lNbLignes++;
                            lNbLignes++;
                        } else {
                            lNbLignes++;
                        }
                    }
                });
            }
            return lNbLignes;
        }

        function composeLienVisio(aLienVisio) {
            var H = [];
            if (!!aLienVisio && !!aLienVisio.url) {
                var lLibelleLien;
                if (!!aLienVisio.libelleLien) {
                    lLibelleLien = aLienVisio.libelleLien;
                }
                if (!lLibelleLien) {
                    lLibelleLien = GTraductions.getValeur('FenetreSaisieVisiosCours.AccederAuCoursVirtuel');
                }
                H.push('<div class="lien-visio"', (aLienVisio.commentaire ? (' title="' + aLienVisio.commentaire + '"') : ''), '>', '<div class="heure-matiere-conteneur">', '<span class="horaires">', GTraductions.getValeur('Dates.DeHeureDebutAHeureFin', [GDate.FormatDate(aLienVisio.dateDebutCours, '%xh%sh%mm'), GDate.FormatDate(aLienVisio.dateFinCours, '%xh%sh%mm')]), '</span>', (aLienVisio.matiere ? ('<span class="matiere">' + aLienVisio.matiere.GetLibelle() + '</span>') : ''), '</div>', '<a class="', UtilitaireVisios.getNomIconePresenceVisios(), '" href="', GChaine.verifierURLHttp(aLienVisio.url), '" target="_blank">', lLibelleLien, '</a>', '</div>');
            }
            return H.join('');
        }
        WidgetEnseignementADistance.prototype.composeLigneEnseignement = function(aEnseignement) {
            var H = [];
            if (!!aEnseignement) {
                var lLibelleEnseignement;
                var lClassEnseignement;
                if (!aEnseignement.estALaMaison) {
                    lLibelleEnseignement = GTraductions.getValeur('accueil.enseignementADistance.enEtablissement');
                    lClassEnseignement = 'at-school';
                } else {
                    lLibelleEnseignement = GTraductions.getValeur('accueil.enseignementADistance.aLaMaison');
                    lClassEnseignement = 'at-home';
                }
                H.push('<li role="listitem" tabindex="0">', '<div class="wrap-as-column">');
                H.push('<div class="wrap">', '<div class="date">', aEnseignement.libelleDate, '</div>', '<div class="infos-presence ', lClassEnseignement, '">', lLibelleEnseignement.toUpperCase(), '</div>', '</div>');
                if (!!aEnseignement.listeLiensVisio && aEnseignement.listeLiensVisio.GetNbrElements() > 0) {
                    aEnseignement.listeLiensVisio.setTri([ObjetTri.init('dateDebutCours')]).trier();
                    H.push('<div class="liste-visios">');
                    aEnseignement.listeLiensVisio.parcourir(function(aLienVisio) {
                        if ((aLienVisio.estMatin && !!aEnseignement.estEnseignementMatin) || (!aLienVisio.estMatin && !!aEnseignement.estEnseignementAprem)) {
                            H.push(composeLienVisio(aLienVisio));
                        }
                    });
                    H.push('</div>');
                }
                H.push('</div>', '</li>');
            }
            return H.join('');
        };
        WidgetEnseignementADistance.prototype.composeWidgetEnseignementADistance = function() {
            var H = [];
            H.push('<ul role="list" class="one-line">');
            if (this.donnees && this.donnees.jours && (this.donnees.jours.GetNbrElements() > 0)) {
                for (var lIdx = 0; lIdx < this.donnees.jours.GetNbrElements(); lIdx++) {
                    var lJour = this.donnees.jours.GetElement(lIdx);
                    var lLibelleDate = GDate.FormatDate(lJour.date, '[' + '%JJJ %J %MMM' + ']');
                    var lEstALaMaison = false;
                    if (lJour.jourEntier) {
                        if (lJour.enEtablissement) {
                            lEstALaMaison = false;
                        } else if (lJour.aDistance) {
                            lEstALaMaison = true;
                        } else {}
                        H.push(this.composeLigneEnseignement({
                            libelleDate: lLibelleDate,
                            estALaMaison: lEstALaMaison,
                            listeLiensVisio: lJour.listeVisios,
                            estEnseignementMatin: true,
                            estEnseignementAprem: true
                        }));
                    } else {
                        if (lJour.enEtablissement && lJour.aDistance) {
                            if (MethodesTableau.existe(EGenreDemiJours.Matin, lJour.setOfDJTravaille)) {
                                lEstALaMaison = false;
                            } else if (MethodesTableau.existe(EGenreDemiJours.Matin, lJour.setOfDJADistance)) {
                                lEstALaMaison = true;
                            } else {}
                            H.push(this.composeLigneEnseignement({
                                libelleDate: lLibelleDate + ' ' + GTraductions.getValeur('accueil.enseignementADistance.matin'),
                                estALaMaison: lEstALaMaison,
                                listeLiensVisio: lJour.listeVisios,
                                estEnseignementMatin: true
                            }));
                            if (MethodesTableau.existe(EGenreDemiJours.ApresMidi, lJour.setOfDJTravaille)) {
                                lEstALaMaison = false;
                            } else if (MethodesTableau.existe(EGenreDemiJours.ApresMidi, lJour.setOfDJADistance)) {
                                lEstALaMaison = true;
                            } else {}
                            H.push(this.composeLigneEnseignement({
                                libelleDate: lLibelleDate + ' ' + GTraductions.getValeur('accueil.enseignementADistance.aprem'),
                                estALaMaison: lEstALaMaison,
                                listeLiensVisio: lJour.listeVisios,
                                estEnseignementAprem: true
                            }));
                        } else {
                            if (lJour.enEtablissement) {
                                lEstALaMaison = false;
                            } else if (lJour.aDistance) {
                                lEstALaMaison = true;
                            } else {}
                            var lEstCoursMatin = MethodesTableau.existe(EGenreDemiJours.Matin, lJour.setOfDJCours);
                            H.push(this.composeLigneEnseignement({
                                libelleDate: lLibelleDate + ' ' + (lEstCoursMatin ? GTraductions.getValeur('accueil.enseignementADistance.matin') : GTraductions.getValeur('accueil.enseignementADistance.aprem')),
                                estALaMaison: lEstALaMaison,
                                listeLiensVisio: lJour.listeVisios,
                                estEnseignementMatin: lEstCoursMatin,
                                estEnseignementAprem: !lEstCoursMatin
                            }));
                        }
                    }
                }
            }
            H.push('</ul>');
            return H.join('');
        };
        module.exports = WidgetEnseignementADistance;
    },
    fn: "espace/script/widget/widgetenseignementadistance.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreApiKiosque = {
            Api_AjoutPanier: 0,
            Api_RenduPJTAF: 1,
            Api_EnvoiNote: 2
        };
        module.exports.TypeGenreApiKiosque = TypeGenreApiKiosque;
    },
    fn: "typegenreapikiosque.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var GImage = require('ObjetImage.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var MethodesObjet = require('MethodesObjet.js');
        var TypeGenreApiKiosque = require('TypeGenreApiKiosque.js').TypeGenreApiKiosque;
        var UtilitaireManuelsNumeriques = {};
        UtilitaireManuelsNumeriques.formatDonnees = function(aDonnees, aOptions) {
            var lResult = {
                liste: new ObjetListeElements(),
                avecCumulMatiere: false
            };
            var lMatiere, lNewElm;
            if (aOptions.avecCumulMatiere) {
                for (var i = 0; i < aDonnees.GetNbrElements(); i++) {
                    var lRessource = aDonnees.GetElement(i);
                    if (lRessource.listeMatieres && lRessource.listeMatieres.GetNbrElements() > 0) {
                        for (var j = 0; j < lRessource.listeMatieres.GetNbrElements(); j++) {
                            lMatiere = lRessource.listeMatieres.GetElement(j);
                            lNewElm = MethodesObjet.dupliquer(lRessource);
                            lNewElm.matiere = lMatiere;
                            lResult.avecCumulMatiere = true;
                            lResult.liste.AddElement(lNewElm);
                        }
                    } else {
                        lNewElm = MethodesObjet.dupliquer(lRessource);
                        lNewElm.matiere = new ObjetElement(GTraductions.getValeur('Kiosque.AutresMatieres'), 0, -1);
                        lResult.liste.AddElement(lNewElm);
                    }
                }
                var lTris = [
                    ObjetTri.init(function(D) {
                        return D.matiere ? !D.matiere.existeNumero() : false;
                    }), ObjetTri.init(function(D) {
                        return D.matiere ? D.matiere.GetLibelle() : '';
                    })
                ];
                if (!!aOptions.avecNomEditeur) {
                    lTris.push(ObjetTri.init('editeur'));
                }
                lTris.push(ObjetTri.init('titre'));
                lResult.liste.setTri(lTris).trier();
            } else {
                lResult.liste = aDonnees;
            }
            return lResult;
        };
        UtilitaireManuelsNumeriques.composeListeManuelsNumeriques_Mobile = function(aDonnees, aOptions, aControleur) {
            var lHtml = [];
            var lDonnees = UtilitaireManuelsNumeriques.formatDonnees(aDonnees, aOptions);
            var lMatiere;
            var lRessource;
            $.extend(aControleur, {
                nodeDescription: function(aDescription) {
                    $(this.node).on({
                        click: function() {
                            if (!!aDescription) {
                                GApplication.getMessage().afficher({
                                    message: GChaine.ToHTML(GChaine.ajouterEntites(aDescription))
                                });
                            }
                        }
                    });
                },
                nodeNonResponsive: function() {
                    $(this.node).on({
                        click: function() {
                            GApplication.getMessage().afficher({
                                message: GChaine.toTitle(GTraductions.getValeur('Kiosque.ContenuNonResponsive'))
                            });
                        }
                    });
                }
            });
            lHtml.push('<ul class="collection with-header">');
            if (!!lDonnees.liste && lDonnees.liste.GetNbrElements() > 0) {
                for (var i = 0; i < lDonnees.liste.GetNbrElements(); i++) {
                    lRessource = lDonnees.liste.GetElement(i);
                    if (lDonnees.avecCumulMatiere) {
                        if (!lMatiere || (lMatiere.GetNumero() !== lRessource.matiere.GetNumero())) {
                            lMatiere = lRessource.matiere;
                            lHtml.push('<li class="collection-header">', GChaine.AvecEspaceSiVide(lMatiere.GetLibelle()), '</li>');
                        }
                    }
                    var lHtmlManuel = [];
                    lHtml.push('<li class="collection-item with-action">');
                    if (aOptions.avecNomEditeur) {
                        lHtmlManuel.push('<div class="NoWrap">');
                        if (lRessource.logo) {
                            lHtmlManuel.push('<div class="InlineBlock AlignementMilieuVertical" ', (lRessource.avecLien ? ' ie-hint="' + GTraductions.getValeur('CahierDeTexte.avecLien') + '"' : ''), '>', GImage.composeImage(lRessource.logo), '</div>');
                        }
                        lHtmlManuel.push('<div class="InlineBlock AlignementMilieuVertical">', GChaine.Insecable(lRessource.editeur), '</div>');
                        lHtmlManuel.push('</div>');
                    }
                    lHtmlManuel.push('<div class="NoWrap">');
                    var lAvecApiRenduTAF = !!lRessource && !!lRessource.apiSupport && lRessource.apiSupport.contains(TypeGenreApiKiosque.Api_RenduPJTAF);
                    var lAvecApiEnvoiNote = !!lRessource && !!lRessource.apiSupport && lRessource.apiSupport.contains(TypeGenreApiKiosque.Api_EnvoiNote);
                    if (aOptions.avecDetailsRessources) {
                        if (GEtatUtilisateur.activerKiosqueRenduTAF && lAvecApiRenduTAF) {
                            lHtmlManuel.push('<div style="float:right; width: 16px;" title="', GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.ManuelTAF')), '" class="AlignementMilieuVertical ', (lAvecApiRenduTAF ? 'Image_Kiosque_ListeCahierTexte AvecMain' : ''), '"></div>');
                        }
                        if (GEtatUtilisateur.activerKiosqueEnvoiNote && lAvecApiEnvoiNote) {
                            lHtmlManuel.push('<div style="float:right; width: 16px;" title="', GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.ManuelDevoir')), '" class="AlignementMilieuVertical ', (lAvecApiEnvoiNote ? 'Image_Kiosque_ListeDevoir AvecMain' : ''), '"></div>');
                        }
                    }
                    lHtmlManuel.push('<div class="InlineBlock AlignementMilieuVertical">', lRessource.titre);
                    if (!!lRessource.description) {
                        lHtmlManuel.push('<div class="InlineBlock AlignementMilieuVertical EspaceGauche AvecMain" ', GHtml.composeAttr('ie-node', 'nodeDescription', [lRessource.description]), '><i class="icon_info_sign"></i></div>');
                    }
                    lHtmlManuel.push('</div></div>');
                    if (lRessource.avecUrlAppliMobile) {
                        lHtmlManuel.push('<div class="NoWrap">');
                        lHtmlManuel.push('<div class="InlineBlock AlignementMilieuVertical" style="margin-left:15px;">', GChaine.composerUrlLienExterne({
                            documentJoint: lRessource,
                            title: lRessource.description,
                            libelleEcran: GTraductions.getValeur('Kiosque.OuvrirAppli'),
                            libelle: lRessource.titre,
                            avecLien: true,
                            iconeOverride: 'icon_th_large',
                            infoSupp: {
                                universalLink: true
                            }
                        }), '</div>');
                        lHtmlManuel.push('</div>');
                    }
                    lHtmlManuel.push('<div class="NoWrap">');
                    lHtmlManuel.push('<div class="AlignementMilieuVertical AlignementMilieu" style="float:right; width:20px;"');
                    if (!lRessource.responsive) {
                        lHtmlManuel.push(GHtml.composeAttr('ie-node', 'nodeNonResponsive'), '>');
                        lHtmlManuel.push('<i class="icon_exclamation" style="color:', GCouleur.rougeClair, '"></i>');
                    } else {
                        lHtmlManuel.push('>');
                    }
                    lHtmlManuel.push('</div>');
                    lHtmlManuel.push('<div class="InlineBlock AlignementMilieuVertical" style="margin-left:15px;">' + GChaine.composerUrlLienExterne({
                        documentJoint: lRessource,
                        title: lRessource.description,
                        libelleEcran: GTraductions.getValeur('Kiosque.OuvrirManuel'),
                        libelle: lRessource.titre,
                        avecLien: true,
                        iconeOverride: 'icon_book'
                    }) + '</div>');
                    lHtmlManuel.push('</div>');
                    lHtml.push(lHtmlManuel.join(''));
                    for (var j = 0; j < lRessource.listeRessourcesAtomiques.GetNbrElements(); j++) {
                        var lRessourceAtomique = lRessource.listeRessourcesAtomiques.GetElement(j);
                        lHtml.push('<div class="Espace" style="border-bottom: 1px solid #e0e0e0; margin: 7px 5px 5px 5px;"></div>');
                        lHtml.push('<div class="NoWrap EspaceDroit">');
                        var lRAAvecApiRenduTAF = !!lRessourceAtomique && !!lRessourceAtomique.apiSupport && lRessourceAtomique.apiSupport.contains(TypeGenreApiKiosque.Api_RenduPJTAF);
                        var lRAAvecApiEnvoiNote = !!lRessourceAtomique && !!lRessourceAtomique.apiSupport && lRessourceAtomique.apiSupport.contains(TypeGenreApiKiosque.Api_EnvoiNote);
                        if (aOptions.avecDetailsRessources) {
                            if (GEtatUtilisateur.activerKiosqueRenduTAF) {
                                lHtml.push('<div style="float:right; width: 16px;" title="', (lRAAvecApiRenduTAF ? GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.LienTAF')) : ''), '" class="AlignementMilieuVertical ', (lRAAvecApiRenduTAF ? 'Image_Kiosque_ListeCahierTexte AvecMain' : ''), '"></div>');
                            }
                            if (GEtatUtilisateur.activerKiosqueEnvoiNote) {
                                lHtml.push('<div style="float:right; width: 16px;" title="', (lRAAvecApiEnvoiNote ? GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.LienDevoir')) : ''), '" class="AlignementMilieuVertical ', (lRAAvecApiEnvoiNote ? 'Image_Kiosque_ListeDevoir AvecMain' : ''), '"></div>');
                            }
                        }
                        lHtml.push('<div class="InlineBlock AlignementMilieuVertical" style="padding-left: 33px;">', GChaine.composerUrlLienExterne({
                            documentJoint: lRessourceAtomique,
                            title: lRessourceAtomique.description,
                            libelleEcran: lRessourceAtomique.titre
                        }), '</div>');
                        lHtml.push('</div>');
                    }
                    lHtml.push('</li>');
                }
            }
            lHtml.push('</ul>');
            return lHtml.join('');
        };
        module.exports = UtilitaireManuelsNumeriques;
    },
    fn: "utilitairemanuelsnumeriques.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var IEHtml = require('IEHtml.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        require('IEHtml.BtnImage.js');
        var GTraductions = require('ObjetTraduction.js');
        (function() {
            IEHtml.addAttribut('ie-mrfiche', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
                _creerMrFiche(aContexteCourant, aNodeName, aAttributValue, aOutils, {
                    class: 'Image_MonsieurFiche',
                    width: 20
                });
            });
            IEHtml.addAttribut('ie-mrficheblanc', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
                _creerMrFiche(aContexteCourant, aNodeName, aAttributValue, aOutils, {
                    class: 'Image_MrFicheFenetre',
                    width: 18
                });
            });
            IEHtml.addAttribut('ie-mrfichewidget', function(aContexteCourant, aNodeName, aAttributValue, aOutils) {
                _creerMrFiche(aContexteCourant, aNodeName, aAttributValue, aOutils, {
                    class: 'icon as-button bt-widget icon_info_widget btnImageIcon'
                });
            });

            function _creerMrFiche(aContexteCourant, aNodeName, aAttributValue, aOutils, aImage) {
                if (!aAttributValue) {
                    return true;
                };
                var lControleur = {
                    btnMrFiche: {
                        event: function() {
                            var lNode = this.node;
                            GApplication.getMessage().afficher({
                                idRessource: aAttributValue
                            }).then(function() {
                                GHtml.setFocus(lNode);
                            });
                        }
                    }
                };
                var H = ['<ie-btnimage ie-model="btnMrFiche" class="' + aImage.class + ' AvecMain"', ' style="', GStyle.composeWidth(aImage.width), '"', GHtml.composeAttr('title', GTraductions.getTitreMFiche(aAttributValue)), '></ie-btnimage>'];
                aOutils.addCommentaireDebug(aContexteCourant.node, 'ie-mrfiche="' + aAttributValue + '"');
                aOutils.injectHTML({
                    element: aContexteCourant.node,
                    html: H.join(''),
                    controleur: lControleur,
                    ignorerScroll: true,
                    contexte: aContexteCourant.contexte
                });
                return {
                    node: aContexteCourant.node,
                    avecCompileFils: false
                };
            }
        }());
        module.exports = IEHtml;
    },
    fn: "iehtml.mrfiche.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Invocateur = require('Invocateur.js').Invocateur;
        var GChaine = require('GChaine.js');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GImage = require('ObjetImage.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var TypeGenreApiKiosque = require('TypeGenreApiKiosque.js').TypeGenreApiKiosque;
        var MethodesTableau = require('MethodesTableau.js');
        var UtilitaireManuelsNumeriques = require('UtilitaireManuelsNumeriques.js');
        require('IEHtml.MrFiche.js');

        function WidgetKiosque() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetKiosque, Identite);
        WidgetKiosque.prototype.initialiserObjetsKiosque = function() {
            Invocateur.abonner('notification_Kiosque', this._notificationKiosque, this);
        };
        WidgetKiosque.prototype._notificationKiosque = function() {
            this.RecupererDonnees([this.donnees.genre]);
        };
        WidgetKiosque.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.optionsKiosque = {
                avecNomEditeur: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.PrimProfesseur, EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_PrimProfesseur]),
                avecDetailsRessources: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.PrimProfesseur, EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_PrimProfesseur]),
                avecCumulMatiere: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.PrimEleve, EGenreEspace.Parent, EGenreEspace.PrimParent, EGenreEspace.Accompagnant, EGenreEspace.PrimAccompagnant, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant])
            };
            var lWidget = {
                html: this.composeWidgetKiosque(),
                nbrElements: this.donnees.listeRessources.GetNbrElements(),
                afficherMessage: false,
                listeElementsGraphiques: [{
                    html: '<span class="as-mrfiche" ie-mrfichewidget="accueil.kiosques.mrFiche"></span>',
                    mrFiche: true
                }]
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
            this.initialiserObjetsKiosque();
        };
        WidgetKiosque.prototype.composeWidgetKiosque = function() {
            var lDonnees = UtilitaireManuelsNumeriques.formatDonnees(this.donnees.listeRessources, this.optionsKiosque);
            var H = [],
                lMatiere, lRessource, i, lLien;
            for (i = 0; i < lDonnees.liste.GetNbrElements(); i++) {
                lRessource = lDonnees.liste.GetElement(i);
                if (lRessource.matiere && lRessource.matiere.existeNumero()) {
                    lDonnees.avecCumulMatiere = true;
                }
            }
            H.push('<ul role="list" class="liste-clickable grouped-like">');
            for (i = 0; i < lDonnees.liste.GetNbrElements(); i++) {
                lRessource = lDonnees.liste.GetElement(i);
                if (lDonnees.avecCumulMatiere) {
                    if (!lMatiere || (lMatiere.GetNumero() !== lRessource.matiere.GetNumero())) {
                        lMatiere = lRessource.matiere;
                        H.push('<li aria-level="4" class="has-title">', '<h4>', GChaine.AvecEspaceSiVide(lRessource.matiere.GetLibelle()), '</h4>', '</li>');
                    }
                }
                lLien = GChaine.composerUrlLienExterne({
                    documentJoint: lRessource,
                    libelle: '',
                    brut: true
                });
                H.push('<li tabIndex="0" onclick="window.open(\'', lLien, '\')"' + (!this.optionsKiosque.avecNomEditeur ? ' class="has-bullet"' : '') + '>');
                if (this.optionsKiosque.avecNomEditeur) {
                    H.push('<span ');
                    if (lRessource.logo) {
                        if (lRessource.avecLien) {
                            H.push(' ie-hint="' + GTraductions.getValeur('CahierDeTexte.avecLien') + '"');
                        }
                        H.push(' class="logo-contain">', GImage.composeImage(lRessource.logo));
                    } else {
                        H.push(' class="libelle-contain">', GChaine.Insecable(lRessource.editeur));
                    }
                    H.push('</span>');
                }
                H.push('<div class="contain-wrapper">', '<a class="link-as-wrapper" title="', lRessource.description, '" >', '<span' + (!this.optionsKiosque.avecNomEditeur ? ' class="with-bullet"' : '') + '>', lRessource.titre, '</span></a>');
                var lAvecApiRenduTAF = !!lRessource && !!lRessource.apiSupport && lRessource.apiSupport.contains(TypeGenreApiKiosque.Api_RenduPJTAF);
                var lAvecApiEnvoiNote = !!lRessource && !!lRessource.apiSupport && lRessource.apiSupport.contains(TypeGenreApiKiosque.Api_EnvoiNote);
                if (this.optionsKiosque.avecDetailsRessources) {
                    if (GEtatUtilisateur.activerKiosqueRenduTAF) {
                        H.push('<span', (lAvecApiRenduTAF ? ' title="' + GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.ManuelTAF')) + '" ' : ''), (lAvecApiRenduTAF ? ' onclick="' + this.Nom + '._evntGenreApiKiosque(' + TypeGenreApiKiosque.Api_RenduPJTAF + ')' + '" ' : ''), (lAvecApiRenduTAF ? ' class="ico-btn kiosque-liste-cdt"' : ''), '></span>');
                    }
                    if (GEtatUtilisateur.activerKiosqueEnvoiNote) {
                        H.push('<span', (lAvecApiEnvoiNote ? ' title="' + GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.ManuelDevoir')) + '" ' : ''), (lAvecApiEnvoiNote ? ' onclick="' + this.Nom + '._evntGenreApiKiosque(' + TypeGenreApiKiosque.Api_EnvoiNote + ')' + '" ' : ''), (lAvecApiEnvoiNote ? ' class="ico-btn kiosque-liste-devoir"' : ''), '></span>');
                    }
                }
                H.push('</div>', '</li>');
                for (var j = 0; j < lRessource.listeRessourcesAtomiques.GetNbrElements(); j++) {
                    var lRessourceAtomique = lRessource.listeRessourcesAtomiques.GetElement(j);
                    lLien = GChaine.composerUrlLienExterne({
                        documentJoint: lRessourceAtomique,
                        libelle: '',
                        brut: true
                    });
                    H.push('<li tabIndex="0" onclick="window.open(\'', lLien, '\')">', '<a class="link-as-wrapper atomic-rsc" title="', lRessourceAtomique.description, '"><span>', lRessourceAtomique.titre, '</span></a>');
                    var lRAAvecApiRenduTAF = !!lRessourceAtomique && !!lRessourceAtomique.apiSupport && lRessourceAtomique.apiSupport.contains(TypeGenreApiKiosque.Api_RenduPJTAF);
                    var lRAAvecApiEnvoiNote = !!lRessourceAtomique && !!lRessourceAtomique.apiSupport && lRessourceAtomique.apiSupport.contains(TypeGenreApiKiosque.Api_EnvoiNote);
                    if (this.optionsKiosque.avecDetailsRessources) {
                        if (GEtatUtilisateur.activerKiosqueRenduTAF) {
                            H.push('<span', (lRAAvecApiRenduTAF ? ' title="' + GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.LienTAF')) + '" ' : ''), (lRAAvecApiRenduTAF ? ' onclick="' + this.Nom + '._evntGenreApiKiosque(' + TypeGenreApiKiosque.Api_RenduPJTAF + ')' + '" ' : ''), (lRAAvecApiRenduTAF ? ' class="ico-btn kiosque-liste-cdt"' : ''), '></span>');
                        }
                        if (GEtatUtilisateur.activerKiosqueEnvoiNote) {
                            H.push('<span', (lRAAvecApiEnvoiNote ? ' title="' + GChaine.toTitle(GTraductions.getValeur('FenetrePanierKiosque.hint.LienDevoir')) + '" ' : ''), (lRAAvecApiEnvoiNote ? ' onclick="' + this.Nom + '._evntGenreApiKiosque(' + TypeGenreApiKiosque.Api_EnvoiNote + ')' : ''), (lRAAvecApiEnvoiNote ? ' class="ico-btn kiosque-liste-devoir"' : ''), '></span>');
                        }
                    }
                    H.push('</li>');
                }
            }
            H.push('</ul>');
            return H.join('');
        };
        WidgetKiosque.prototype._evntGenreApiKiosque = function(aGenre) {
            var lPage = {};
            switch (aGenre) {
                case TypeGenreApiKiosque.Api_RenduPJTAF:
                    lPage.Onglet = EGenreOnglet.SaisieCahierDeTextes;
                    if (GEtatUtilisateur.estEspaceMobile()) {
                        this.evenementPage({
                            genreOngletDest: lPage.Onglet
                        });
                    } else {
                        this.evenementPage(this.genreEvenement.selectionPage, lPage);
                    }
                    break;
                case TypeGenreApiKiosque.Api_EnvoiNote:
                    lPage.Onglet = EGenreOnglet.SaisieNotes;
                    if (GEtatUtilisateur.estEspaceMobile()) {
                        this.evenementPage({
                            genreOngletDest: lPage.Onglet
                        });
                    } else {
                        this.evenementPage(this.genreEvenement.selectionPage, lPage);
                    }
                    break;
                default:
                    ;
                    break;
            }
        };
        module.exports = WidgetKiosque;
    },
    fn: "espace/script/widget/widgetkiosque.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteGenerationURLRecherchePartenaire() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('GenerationURLRecherchePartenaire', ObjetRequeteGenerationURLRecherchePartenaire, ObjetRequeteConsultation);
        ObjetRequeteGenerationURLRecherchePartenaire.prototype.lancerRequete = function(aDonnees) {
            this.JSON = aDonnees;
            return this.appelAsynchrone();
        };
        ObjetRequeteGenerationURLRecherchePartenaire.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse.urlRecherche);
        };
        module.exports = ObjetRequeteGenerationURLRecherchePartenaire;
    },
    fn: "objetrequetegenerationurlrecherchepartenaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');
        var GTraductions = require('ObjetTraduction.js');

        function ObjetRequeteSaisieURLPartenaire() {
            this.inheritedCreate(arguments);
            this.setOptions({
                avecControleModeExclusif: false
            });
        }
        Requetes.inscrire('SaisieURLPartenaire', ObjetRequeteSaisieURLPartenaire, ObjetRequeteSaisie);
        ObjetRequeteSaisieURLPartenaire.prototype.lancerRequete = function(aDonnees) {
            this.JSON.SSO = aDonnees.SSO;
            return this.appelAsynchrone({
                messageDetail: GTraductions.getValeur('requete.VeuillezPatienter')
            });
        };
        ObjetRequeteSaisieURLPartenaire.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONRapportSaisie.urlSSO);
        };
        module.exports = ObjetRequeteSaisieURLPartenaire;
    },
    fn: "objetrequetesaisieurlpartenaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');
        var GTraductions = require('ObjetTraduction.js');

        function ObjetRequeteSaisieURLPartenaireCDI() {
            this.inheritedCreate(arguments);
            this.setOptions({
                avecControleModeExclusif: false
            });
        }
        Requetes.inscrire('SaisieURLPartenaireCDI', ObjetRequeteSaisieURLPartenaireCDI, ObjetRequeteSaisie);
        ObjetRequeteSaisieURLPartenaireCDI.prototype.lancerRequete = function(aDonnees) {
            this.JSON.url = aDonnees.url;
            return this.appelAsynchrone({
                messageDetail: GTraductions.getValeur('requete.VeuillezPatienter')
            });
        };
        ObjetRequeteSaisieURLPartenaireCDI.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONRapportSaisie.urlSSO);
        };
        module.exports = ObjetRequeteSaisieURLPartenaireCDI;
    },
    fn: "objetrequetesaisieurlpartenairecdi.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteGenerationURLRecherchePartenaire = require('ObjetRequeteGenerationURLRecherchePartenaire.js');
        var ObjetRequeteSaisieURLPartenaire = require('ObjetRequeteSaisieURLPartenaire.js');
        var ObjetRequeteSaisieURLPartenaireCDI = require('ObjetRequeteSaisieURLPartenaireCDI.js');

        function TUtilitairePartenaire() {
            this.windowURLPartenaire = null;
        }
        TUtilitairePartenaire.ouvrirPatience = function() {
            try {
                this.windowURLPartenaire = window.open('message.html?G=patiencePartenaire', '_blank');
            } catch (e) {
                this.windowURLPartenaire = null;
            }
        };
        TUtilitairePartenaire.fermerPatience = function() {
            if (this.windowURLPartenaire) {
                this.windowURLPartenaire.close();
            }
        };
        TUtilitairePartenaire.ouvrirUrl = function(aUrl) {
            if (this.windowURLPartenaire) {
                this.windowURLPartenaire.location.replace(aUrl);
            } else {
                window.open(aUrl);
            }
        };
        TUtilitairePartenaire.ouvrirURLPartenaireCDI = function(aLien) {
            TUtilitairePartenaire.ouvrirPatience();
            new ObjetRequeteSaisieURLPartenaireCDI(this, this._actionSurLienPartenaire).lancerRequete(aLien);
        };
        TUtilitairePartenaire.ouvrirURLPartenaire = function(aLien) {
            TUtilitairePartenaire.ouvrirPatience();
            new ObjetRequeteSaisieURLPartenaire(this, this._actionSurLienPartenaire).lancerRequete(aLien);
        };
        TUtilitairePartenaire.ouvrirURLPartenaireRecherche = function(aObjetPartenaire, aTexteRecherche) {
            TUtilitairePartenaire.ouvrirPatience();
            new ObjetRequeteGenerationURLRecherchePartenaire(this, this._actionSurLienPartenaire).lancerRequete({
                portailCDI: aObjetPartenaire,
                recherche: aTexteRecherche
            });
        };
        TUtilitairePartenaire._actionSurLienPartenaire = function(aUrlSSO) {
            if (aUrlSSO) {
                if (this.windowURLPartenaire) {
                    setTimeout(function() {
                        this.windowURLPartenaire.location.replace(aUrlSSO);
                    }.bind(this), 0);
                } else {
                    window.open(aUrlSSO);
                }
            } else {
                TUtilitairePartenaire.fermerPatience();
            }
        };
        module.exports = TUtilitairePartenaire;
    },
    fn: "utilitairepartenaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GChaine = require('GChaine.js');
        var TUtilitairePartenaire = require('UtilitairePartenaire.js');

        function WidgetLienUtile() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetLienUtile, Identite);
        WidgetLienUtile.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var lWidget = {
                html: this.composeWidgetLienUtile(),
                nbrElements: this.donnees.listeLiens.GetNbrElements(),
                afficherMessage: this.donnees.listeLiens.GetNbrElements() === 0
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetLienUtile.prototype.composeWidgetLienUtile = function() {
            var H = [];
            H.push('<ul class="liste-clickable one-line" role="list">');
            for (var i = 0; i < this.donnees.listeLiens.GetNbrElements(); i++) {
                var lLien = this.donnees.listeLiens.GetElement(i);
                if (lLien.SSO) {
                    H.push('<li class="has-sso" onclick="', this.Nom, '._surLienPartenaire (', i, ')">', '<div>', '<a ', (lLien.commentaire ? ' ie-hint="' + lLien.commentaire + '"' : ''), '>', lLien.GetLibelle(), '</a>', lLien.commentaire ? '<p>' + lLien.commentaire + '</p>' : '', '</div>', '</li>');
                } else {
                    H.push('<li class="no-sso" onclick="window.open(\'', GChaine.verifierURLHttp(lLien.url), '\')">', '<div>', '<a class="LienAccueil"', (lLien.commentaire ? ' ie-hint="' + lLien.commentaire + '"' : ''), '>', lLien.GetLibelle(), '</a>', lLien.commentaire ? '<p>' + lLien.commentaire + '</p>' : '', '</div>', '</li>');
                }
            }
            H.push('</ul>');
            return H.join('');
        };
        WidgetLienUtile.prototype._surLienPartenaire = function(i) {
            var lLien = this.donnees.listeLiens.GetElement(i);
            TUtilitairePartenaire.ouvrirURLPartenaire(lLien);
        };
        module.exports = WidgetLienUtile;
    },
    fn: "espace/script/widget/widgetlienutile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GChaine = require('GChaine.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var EGenreRessource = require('Enumere_Ressource.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var ObjetElement = require('ObjetElement.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;
        var Identite = require('ObjetIdentite.js');
        var EformatDocJoint = require('Enumere_FormatDocJoint.js');
        var MethodesObjet = require('MethodesObjet.js');

        function WidgetNotes() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetNotes, Identite);
        WidgetNotes.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var H = [];
            if (this.donnees.listeDevoirs.GetNbrElements() > 0) {
                this.donnees.listeDevoirs.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant), ObjetTri.init('service.Libelle')]);
                this.donnees.listeDevoirs.trier();
                var lAvecLien = this.donnees.avecDetailDevoir;
                H.push('<ul role="list" class="liste-clickable">');
                for (var I = 0; I < this.donnees.listeDevoirs.GetNbrElements(); I++) {
                    H.push(this.composeNote(this.donnees.listeDevoirs.GetElement(I), I, lAvecLien));
                }
                H.push('</ul>');
            }
            var lWidget = {
                html: H.join(''),
                nbrElements: this.donnees.listeDevoirs.GetNbrElements(),
                afficherMessage: this.donnees.listeDevoirs.GetNbrElements() === 0
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetNotes.prototype.composeNote = function(aDevoir, aIndex, aAvecLienDetail) {
            var lEstBaremeParDefaut = aDevoir.bareme.getValeur() === aDevoir.baremeParDefaut.getValeur();
            var lStrDate = GDate.FormatDate(aDevoir.date, '[' + GTraductions.getValeur('Le') + ' ' + '%J %MMM' + ']');
            var lStrClasse = aDevoir.moyenne ? ' - ' + (aDevoir.estEnGroupe ? GTraductions.getValeur('accueil.moyGroupe') : GTraductions.getValeur('accueil.moyClasse')) + '  ' + aDevoir.moyenne.getNote() + (lEstBaremeParDefaut ? '' : ' ' + aDevoir.bareme.getBaremeEntierSansSlash()) : '';
            var lStrClasseAria = aDevoir.moyenne ? (aDevoir.estEnGroupe ? GTraductions.getValeur('accueil.moyGroupe') + ' ' : GTraductions.getValeur('accueil.moyClasse') + ' ') + aDevoir.moyenne.getNote() + (lEstBaremeParDefaut ? '' : ' ' + aDevoir.bareme.getBaremeEntier()) : '';
            var lStrNote = aDevoir.note.getNote() + (lEstBaremeParDefaut || isNaN(parseFloat(aDevoir.note.getNote())) ? '' : '<span class="bareme"> ' + aDevoir.bareme.getBaremeEntierSansSlash() + '</span>');
            var lStrNoteAria = aDevoir.note.getNote() + (lEstBaremeParDefaut || isNaN(parseFloat(aDevoir.note.getNote())) ? '' : GTraductions.getValeur('Notes.NoteSur', [aDevoir.bareme.getBaremeEntierSansSlash()]));
            var lWAI = GObjetWAI.composeAttribut({
                genre: EGenreAttribut.label,
                valeur: GTraductions.getValeur('Matiere') + ' : ' + aDevoir.service.GetLibelle() + ' ; ' + GTraductions.getValeur('Notes.Note') + ' : ' + lStrNoteAria + ' ; ' + GTraductions.getValeur('Date') + ' : ' + lStrDate + (lStrClasseAria ? ' ; ' + lStrClasseAria : '')
            });
            var H = [];
            H.push('<li role="listitem" id="', this.Nom, '_notes_', aIndex, '" tabIndex="0"', lWAI, aAvecLienDetail ? 'onclick="' + this.Nom + '._surDernieresNoteMatiereClick(event, ' + aIndex + ')"' : '', '>', '<div class="wrap">', '<h4><span>', aDevoir.service.GetLibelle(), '</span></h4>', '<div class="infos-conteneur">', '<span class="date">', lStrDate, '</span>', lStrClasse ? '<span class="as-link"> - ' + lStrClasse + '</span>' : '');
            if (aDevoir.libelleSujet || aDevoir.libelleCorrige) {
                H.push('<div class="liste-infos">');
                if (aDevoir.libelleSujet) {
                    var lTypefile = EformatDocJoint.getClassIconDeGenre(TypeFichierExterneHttpSco.DevoirSujet);
                    var lLienSujet = getLienSujetCorrige(aDevoir, true);
                    H.push('<span class="file-contain icon ', lTypefile, '" title="' + GTraductions.getValeur('TelechargerSujet') + '">', '<a class="file-name" href="', lLienSujet, '">&nbsp;', GTraductions.getValeur('AfficherSujet'), '</a>', '</span>');
                }
                if (aDevoir.libelleCorrige) {
                    lTypefile = EformatDocJoint.getClassIconDeGenre(TypeFichierExterneHttpSco.DevoirCorrige);
                    var lLienCorrige = getLienSujetCorrige(aDevoir, false);
                    H.push('<span class="file-contain  icon ', lTypefile, '" title="' + GTraductions.getValeur('TelechargerCorrige') + '">', '<a class="file-name" href="', lLienCorrige, '">&nbsp;', GTraductions.getValeur('AfficherCorrige'), '</a>', '</span>');
                }
                if (aDevoir.executionQCM && aDevoir.executionQCM.fichierDispo && aDevoir.executionQCM.publierCorrige) {
                    H.push('<span class="icon ', lTypefile, '"  title="', GTraductions.getValeur('TelechargerCorrige'), '">', GTraductions.getValeur('AfficherCorrige'), '</span>');
                }
                H.push('</div>');
            }
            H.push('</div>', '</div>');
            H.push('<div class="as-info fixed" aria-label="', lStrNoteAria, '">', lStrNote, '</div>');
            H.push('</li>');
            return H.join('');
        };

        function getLienSujetCorrige(aDevoir, aPourSujet) {
            var lDocumentJoint = new ObjetElement((aPourSujet ? aDevoir.libelleSujet : aDevoir.libelleCorrige), aDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
            var lGenreRessource = aPourSujet ? TypeFichierExterneHttpSco.DevoirSujet : TypeFichierExterneHttpSco.DevoirCorrige;
            var lLibelleEcran = aPourSujet ? GTraductions.getValeur('AfficherSujet') : GTraductions.getValeur('AfficherCorrige');
            return GChaine.composerUrlLienExterne({
                documentJoint: lDocumentJoint,
                genreRessource: lGenreRessource,
                libelleEcran: lLibelleEcran,
                brut: true
            });
        }
        WidgetNotes.prototype._surDernieresNoteMatiereClick = function(aEvent, i) {
            if ($(aEvent.target).parentsUntil(aEvent.currentTarget).addBack().filter('a').length === 0) {
                var lDevoir = this.donnees.listeDevoirs.GetElement(i);
                GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Devoir, lDevoir);
                if (!!this.donnees.page) {
                    this.donnees.page.periode = lDevoir.periode;
                }
                if (GEtatUtilisateur.estEspaceMobile()) {
                    this.evenementPage({
                        genreOngletDest: this.donnees.page.Onglet
                    });
                } else {
                    this.evenementPage(this.genreEvenement.selectionPage, this.donnees.page);
                }
            }
        };
        WidgetNotes.prototype.surQCM = function(I) {
            var lDevoir = this.donnees.listeDevoirs.GetElement(I);
            this.afficherExecutionQCM(lDevoir.executionQCM);
        };
        module.exports = WidgetNotes;
    },
    fn: "espace/script/widget/widgetnotes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Identite = require('ObjetIdentite.js');
        var GTraductions = require('ObjetTraduction.js');
        var TUtilitairePartenaire = require('UtilitairePartenaire.js');
        var MethodesObjet = require('MethodesObjet.js');

        function WidgetPartenaireARD() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetPartenaireARD, Identite);
        WidgetPartenaireARD.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var lWidget = {
                html: this.composeWidgetPartenaireArd(),
                nbrElements: null,
                titre: GTraductions.getValeur('accueil.ard.titre'),
                avecActualisation: !!this.donnees.avecActualisation
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetPartenaireARD.prototype.composeWidgetPartenaireArd = function() {
            var H = [];
            if (!this.donnees || this.donnees.porteMonnaie.GetNbrElements() > 0) {
                H.push('<table>', '<thead>', '<tr>', '<th>', GTraductions.getValeur('accueil.ard.porteMonnaie'), '</th>', '<th>', GTraductions.getValeur('accueil.ard.dernierSolde'), '</th>', '<tr>', '</thead>');
                for (var i = 0; i < this.donnees.porteMonnaie.GetNbrElements(); i++) {
                    var lPrix = this.donnees.porteMonnaie.GetElement(i);
                    H.push('<tr>', '<td title="', lPrix.hintPorteMonnaie, '">', lPrix.libellePorteMonnaie, '</td>', '<td title="', lPrix.avecWarning ? GTraductions.getValeur('accueil.ard.attentionSolde') + ': ' + lPrix.hintSolde + '"  class="date-alert">' : lPrix.hintSolde, '">', '<span class="info-montant">', lPrix.valeurSolde, '</span></td>', '</tr>');
                }
                H.push('</table>');
            } else {
                H.push('<div class="no-events"><p>', GTraductions.getValeur('accueil.ard.msgAucun'), '</p></div>');
            }
            if (this.donnees.SSO && this.donnees.SSO.intituleLien) {
                H.push('<div class="link-contain" onclick="' + this.Nom + '._surPartenaireArd ()">', '<label>', this.donnees.SSO.intituleLien, '</label>', '<p>', this.donnees.SSO.description, '</p>', '</div>');
            }
            return H.join('');
        };
        WidgetPartenaireARD.prototype._surPartenaireArd = function() {
            TUtilitairePartenaire.ouvrirURLPartenaire(this.donnees);
        };
        module.exports = WidgetPartenaireARD;
    },
    fn: "espace/script/widget/widgetpartenaireard.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenrePret = {
            GP_EnCours: 0,
            GP_EnRetard: 1,
            GP_Historique: 2
        };
        module.exports.TypeGenrePret = TypeGenrePret;
    },
    fn: "typegenrepret.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var EGenreEvenementObjetSaisie = require('Enumere_EvenementObjetSaisie.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetFiche = require('ObjetFiche.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetSaisie = require('ObjetSaisie.js');
        var GTraductions = require('ObjetTraduction.js');
        var UtilitaireWidget = require('UtilitaireWidget.js');
        var TypeGenrePret = require('TypeGenrePret.js').TypeGenrePret;
        var TUtilitairePartenaire = require('UtilitairePartenaire.js');

        function WidgetPartenaireCDI() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetPartenaireCDI, Identite);
        WidgetPartenaireCDI.prototype.creerObjetstPartenaireCDI = function() {
            this.comboCDI = Identite.creerInstance(ObjetSaisie, {
                pere: this,
                evenement: this._evenementSurComboCDI
            });
            this._initialiserComboCDI(this.comboCDI);
            this.ficheHistorique = ObjetFenetre.creerInstance(ObjetFiche, {
                pere: this,
                initialiser: false
            });
            this.ficheHistorique.destructionSurFermeture = false;
        };
        WidgetPartenaireCDI.prototype.initialiserObjetsPartenaireCDI = function() {
            this.comboCDI.Initialiser();
            this.comboCDI.SetDonnees(this.donnees.listeCDI, 0);
            this.comboCDI.SetVisible(this.donnees.listeCDI.GetNbrElements() > 1);
            this.ficheHistorique.Initialiser();
        };
        WidgetPartenaireCDI.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.creerObjetstPartenaireCDI();
            var lWidget = {
                listeElementsGraphiques: [{
                    id: this.comboCDI.GetNom()
                }],
                nbrElements: null,
                afficherMessage: false,
                avecActualisation: true,
                fermerFiches: function() {
                    this.ficheHistorique.Fermer();
                }.bind(this)
            };
            $.extend(true, this.donnees, lWidget);
            this.idInputRecherche = this.Nom + '_inputSearch';
            aParams.construireWidget(this.donnees);
            this.initialiserObjetsPartenaireCDI();
        };
        WidgetPartenaireCDI.prototype.actualiserPartenaireCDI = function(aCDI) {
            this.CDI = aCDI;
            var lTitre = aCDI.avecDelegationAuth ? '<span class="AvecMain" onclick="' + this.Nom + '._surPartenaireCDI ()">' + (this.donnees.listeCDI.GetNbrElements() === 1 ? aCDI.GetLibelle() : GTraductions.getValeur('accueil.CDI.titre')) + '</span>' : '<a href="' + GChaine.verifierURLHttp(aCDI.url) + '" target="_blank">' + (this.donnees.listeCDI.GetNbrElements() === 1 ? aCDI.GetLibelle() : GTraductions.getValeur('accueil.CDI.titre')) + '</a>';
            var lWidget = {
                html: this.composeWidgetPartenaireCDI(aCDI),
                nbrElements: null,
                afficherMessage: false,
                titre: lTitre,
                avecActualisation: !!aCDI.avecActualisation
            };
            $.extend(true, this.donnees, lWidget);
            UtilitaireWidget.actualiserWidget(this.donnees, this.NomInterface);
        };
        WidgetPartenaireCDI.prototype.composeWidgetPartenaireCDI = function(aCDI) {
            var H = [];
            this.donneesRequete.partenaireCDI.CDI = aCDI;
            H.push('<div class="input-wrapper fullsize">', '<div class="as-search">', '<input id="', this.idInputRecherche, '" type="text" placeholder="', GTraductions.getValeur('accueil.CDI.recherche'), '" onkeypress="', this.Nom, '._onKeyPress(event)"/>', '<span onclick="', this.Nom, '._surRechercheCDI ()"></span>', '</div>', '</div>');
            if (!!aCDI.listePrets && aCDI.listePrets.GetNbrElements()) {
                H.push(this.composeListePrets(aCDI, false));
                H.push('<div class="LienAccueil PetitEspace" style="float: right" onclick="', this.Nom, '._surHistorique ()">', GTraductions.getValeur('accueil.CDI.voirHistorique'), '</div>');
            }
            return H.join('');
        };
        WidgetPartenaireCDI.prototype.composeListePrets = function(aCDI, aPourHistorique) {
            var H = [];
            if (!!aCDI.listePrets && aCDI.listePrets.GetNbrElements()) {
                H.push('<table class="is-clickable">');
                H.push('<thead>', '<tr>', '<th>', GTraductions.getValeur('accueil.CDI.ressourcesEmpruntees'), '</th>', '<th>', GTraductions.getValeur('accueil.CDI.emprunteLe'), '</th>', '<th>', aPourHistorique ? GTraductions.getValeur('accueil.CDI.renduLe') : GTraductions.getValeur('accueil.CDI.aRendreLe'), '</th>', '</tr>', '</thead>');
                for (var i = 0; i < aCDI.listePrets.GetNbrElements(); i++) {
                    var lPret = aCDI.listePrets.GetElement(i);
                    var lAfficher = aPourHistorique ? (lPret.GetGenre() === TypeGenrePret.GP_Historique) : (lPret.GetGenre() === TypeGenrePret.GP_EnCours) || (lPret.GetGenre() === TypeGenrePret.GP_EnRetard);
                    if (lAfficher) {
                        H.push('<tr>', '<td>', '<a href="', GChaine.verifierURLHttp(lPret.url), '" target="_blank" class=LienAccueil"', (lPret.commentaire ? ' ie-hint="' + lPret.commentaire + '"' : ''), '>', lPret.titre, '</a>', '</td>', '<td>', GDate.FormatDate(lPret.dateEmprunt, '[%JJ/%MM/%AA]'), '</td>', '<td', lPret.GetGenre() === TypeGenrePret.GP_EnRetard ? ' class="date-alert"' : '', '>', GDate.FormatDate(aPourHistorique ? lPret.dateRetourEffectif : lPret.dateRetourPrevue, '[%JJ/%MM/%AA]'), '</td>', '</tr>');
                    }
                }
                H.push('</table>');
            }
            return H.join('');
        };
        WidgetPartenaireCDI.prototype._surHistorique = function() {
            this.ficheHistorique.setOptionsFenetre({
                titre: GTraductions.getValeur('accueil.CDI.historique'),
                htmlContenu: this.composeListePrets(this.donneesRequete.partenaireCDI.CDI, true)
            });
            this.ficheHistorique.Afficher();
        };
        WidgetPartenaireCDI.prototype._onKeyPress = function(aEvent) {
            if (aEvent.keyCode === require('ToucheClavier.js').RetourChariot) {
                this._surRechercheCDI();
            }
        };
        WidgetPartenaireCDI.prototype._surRechercheCDI = function() {
            var lValeurRecherchee = $('#' + this.idInputRecherche.escapeJQ()).val();
            if (!!lValeurRecherchee) {
                lValeurRecherchee = lValeurRecherchee.trim();
            }
            if (!!lValeurRecherchee && lValeurRecherchee.length > 0) {
                TUtilitairePartenaire.ouvrirURLPartenaireRecherche(this.donneesRequete.partenaireCDI.CDI, lValeurRecherchee);
            }
        };
        WidgetPartenaireCDI.prototype._initialiserComboCDI = function(aObjet) {
            aObjet.setOptions_ObjetSaisie({
                longueur: 80,
                avecBoutonsPrecSuiv: false,
                avecBoutonsPrecSuivVisiblesInactifs: false
            });
        };
        WidgetPartenaireCDI.prototype._evenementSurComboCDI = function(aGenre, aElement) {
            if (aGenre === EGenreEvenementObjetSaisie.selection) {
                this.actualiserPartenaireCDI(aElement);
            }
        };
        WidgetPartenaireCDI.prototype._surPartenaireCDI = function() {
            TUtilitairePartenaire.ouvrirURLPartenaireCDI(this.CDI);
        };
        module.exports = WidgetPartenaireCDI;
    },
    fn: "espace/script/widget/widgetpartenairecdi.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreRessource = require('Enumere_Ressource.js');

        function WidgetQCM() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetQCM, Identite);
        WidgetQCM.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var H = [];
            if (this.donnees.listeExecutionsQCM && this.donnees.listeExecutionsQCM.GetNbrElements() > 0) {
                this.donnees.listeExecutionsQCM.setTri([ObjetTri.init('dateDebutPublication'), ObjetTri.init('Position')]);
                H.push('<ul class="liste-clickable" role="list">');
                for (var I = 0; I < this.donnees.listeExecutionsQCM.GetNbrElements(); I++) {
                    var lExecution = this.donnees.listeExecutionsQCM.GetElement(I);
                    var lStrInfosComplementaires;
                    if (GEtatUtilisateur.pourPrimaire() && lExecution.coefficientEvaluation === 0) {
                        lStrInfosComplementaires = '(' + GTraductions.getValeur('evaluations.NonComptabiliseDansBilan') + ')';
                    }
                    H.push('<li', (lExecution.estEnPublication ? ' class="is-clickable"' : ''));
                    if (lExecution.fichierDispo && lExecution.estEnPublication) {
                        H.push(' onclick="' + this.Nom + '.surExecutionQCM (event, ' + I + ')"');
                    }
                    if (!lExecution.fichierDispo) {
                        H.push(' title="' + GTraductions.getValeur('ExecutionQCM.FichierIndispo') + '"');
                    }
                    H.push('>', '<div class="wrap">', '<div class="bloc-date-conteneur">', GDate.FormatDate(lExecution.dateDebutPublication, '<div>%JJ</div><div>%MMM</div>'), '</div>', '<div class="infos-ds-conteneur">');
                    if (lExecution.GetGenre() === EGenreRessource.ExecutionQCM) {
                        H.push('<h4>', lExecution.service.GetLibelle(), '</<h4>', '<h5 class="as-libelle">', lExecution.QCM.GetLibelle(), '</h5>');
                    } else {
                        H.push(this.composeExecutionKiosque(lExecution, I));
                    }
                    H.push('<span class="date">', GDate.strDates(lExecution.dateDebutPublication, lExecution.dateFinPublication, true).ucfirst(), (!!lStrInfosComplementaires ? (' ' + lStrInfosComplementaires) : ''), '</span>');
                    H.push('</div>', '</div>', '</li>');
                }
            }
            var lWidget = {
                html: H.join(''),
                nbrElements: this.donnees.listeExecutionsQCM ? this.donnees.listeExecutionsQCM.GetNbrElements() : 0,
                afficherMessage: this.donnees.listeExecutionsQCM ? this.donnees.listeExecutionsQCM.GetNbrElements() === 0 : true
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetQCM.prototype.composeExecutionKiosque = function(aExecutionKiosque, aIndice) {
            var H = [];
            if (!!aExecutionKiosque) {
                H.push('<div>');
                H.push(GChaine.composerUrlLienExterne({
                    documentJoint: aExecutionKiosque,
                    avecLien: aExecutionKiosque.estEnPublication,
                    title: (aExecutionKiosque.estEnPublication ? GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeur') : ''),
                    libelleEcran: aExecutionKiosque.service.GetLibelle()
                }));
                H.push('<div>', '&nbsp;-&nbsp;', aExecutionKiosque.titre, '</div>');
                H.push('</div>');
            }
            return H.join('');
        };
        WidgetQCM.prototype.surExecutionQCM = function(aEvent, I) {
            var lExecutionsQCM = this.donnees.listeExecutionsQCM.GetElement(parseInt(I));
            this.afficherExecutionQCM(lExecutionsQCM);
        };
        module.exports = WidgetQCM;
    },
    fn: "espace/script/widget/widgetqcm.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;
        var EGenreRessourcePedagogique = {
            documentJoint: 0,
            site: 1,
            QCM: 2,
            sujet: 3,
            corrige: 4,
            travailRendu: 5,
            kiosque: 6,
            documentCloud: 7
        };
        EGenreRessourcePedagogique.getImage = function(aGenreRessource) {
            return ['Image_Casier_DocumentJoint', 'Image_Insertion_Site', 'Image_Casier_IDevoir', 'Image_Casier_Sujet', 'Image_Casier_Corrige', 'Image_Casier_TravauxRendus', 'Image_Casier_Kiosque', 'Image_Casier_DocumentCloud'][aGenreRessource];
        };
        EGenreRessourcePedagogique.getUrl = function(aGenreRessource, aRessource) {
            switch (aGenreRessource) {
                case (EGenreRessourcePedagogique.documentJoint):
                    if (aRessource.url) {
                        return aRessource.url;
                    }
                    return GChaine.composerUrlLienExterne({
                        libelle: aRessource.GetLibelle(),
                        documentJoint: aRessource,
                        brut: true
                    });
                case (EGenreRessourcePedagogique.documentCloud):
                    return aRessource.url;
                case (EGenreRessourcePedagogique.site):
                    return GChaine.encoderUrl(GChaine.verifierURLHttp(aRessource.GetLibelle()));
                case (EGenreRessourcePedagogique.sujet):
                case (EGenreRessourcePedagogique.corrige):
                case (EGenreRessourcePedagogique.travailRendu):
                    return GChaine.composerUrlLienExterne({
                        libelle: aRessource.GetLibelle(),
                        documentJoint: aRessource,
                        brut: true
                    });
            }
        };
        EGenreRessourcePedagogique.composerURL = function(aGenreRessourcePedagogique, aRessource, aLibelleEcran, aUrlBrute) {
            var lGenreRessource = TypeFichierExterneHttpSco.Aucun;
            var lLibelle;
            switch (aGenreRessourcePedagogique) {
                case (EGenreRessourcePedagogique.sujet):
                    if (aRessource.GetGenre() === EGenreRessource.Devoir) {
                        lGenreRessource = TypeFichierExterneHttpSco.DevoirSujet;
                    }
                    if (aRessource.GetGenre() === EGenreRessource.Evaluation) {
                        lGenreRessource = TypeFichierExterneHttpSco.EvaluationSujet;
                    }
                    break;
                case (EGenreRessourcePedagogique.corrige):
                    if (aRessource.GetGenre() === EGenreRessource.Devoir) {
                        lGenreRessource = TypeFichierExterneHttpSco.DevoirCorrige;
                    }
                    if (aRessource.GetGenre() === EGenreRessource.Evaluation) {
                        lGenreRessource = TypeFichierExterneHttpSco.EvaluationCorrige;
                    }
                    if (aRessource.GetGenre() === EGenreRessource.RelationTravailAFaireEleve) {
                        lGenreRessource = TypeFichierExterneHttpSco.TAFCorrigeRenduEleve;
                    }
                    break;
                case (EGenreRessourcePedagogique.site):
                    aLibelleEcran = aRessource.GetLibelle();
                    lLibelle = 'link';
                    break;
                case (EGenreRessourcePedagogique.kiosque):
                case (EGenreRessourcePedagogique.documentJoint):
                case (EGenreRessourcePedagogique.documentCloud):
                    break;
                case (EGenreRessourcePedagogique.travailRendu):
                    lGenreRessource = TypeFichierExterneHttpSco.TAFRenduEleve;
                    break;
                default:
                    ;
                    break;
            }
            return GChaine.composerUrlLienExterne({
                documentJoint: aRessource,
                genreRessource: lGenreRessource,
                libelleEcran: aLibelleEcran,
                libelle: lLibelle,
                brut: aUrlBrute
            });
        };
        EGenreRessourcePedagogique.getLibelleDeGenreEtNombre = function(aGenreRessource, aNombre) {
            var lChaine = '';
            switch (aGenreRessource) {
                case EGenreRessourcePedagogique.documentJoint:
                    lChaine = ((aNombre === 1) || (aNombre === undefined)) ? GTraductions.getValeur('RessourcePedagogique.DocJoint_S') : GTraductions.getValeur('RessourcePedagogique.DocJoint');
                    break;
                case EGenreRessourcePedagogique.site:
                    lChaine = ((aNombre === 1) || (aNombre === undefined)) ? GTraductions.getValeur('RessourcePedagogique.SitesWeb_S') : GTraductions.getValeur('RessourcePedagogique.SitesWeb');
                    break;
                case EGenreRessourcePedagogique.QCM:
                    lChaine = ((aNombre === 1) || (aNombre === undefined)) ? GTraductions.getValeur('RessourcePedagogique.IDevoirs_S') : GTraductions.getValeur('RessourcePedagogique.IDevoirs');
                    break;
                case EGenreRessourcePedagogique.sujet:
                    lChaine = ((aNombre === 1) || (aNombre === undefined)) ? GTraductions.getValeur('RessourcePedagogique.Sujets_S') : GTraductions.getValeur('RessourcePedagogique.Sujets');
                    break;
                case EGenreRessourcePedagogique.corrige:
                    lChaine = ((aNombre === 1) || (aNombre === undefined)) ? GTraductions.getValeur('RessourcePedagogique.Corriges_S') : GTraductions.getValeur('RessourcePedagogique.Corriges');
                    break;
                case EGenreRessourcePedagogique.kiosque:
                    lChaine = ((aNombre === 1) || (aNombre === undefined)) ? GTraductions.getValeur('RessourcePedagogique.Kiosque_S') : GTraductions.getValeur('RessourcePedagogique.Kiosque');
                    break;
            }
            return lChaine;
        };
        module.exports = EGenreRessourcePedagogique;
    },
    fn: "enumere_ressourcepedagogique.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GChaine = require('GChaine.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreRessourcePedagogique = require('Enumere_RessourcePedagogique.js');
        var EformatDocJoint = require('Enumere_FormatDocJoint.js');
        var UtilitaireQCM = require('UtilitaireQCM.js').UtilitaireQCM;
        var Identite = require('ObjetIdentite.js');
        var MethodesObjet = require('MethodesObjet.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;

        function WidgetRessourcePedagogique() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetRessourcePedagogique, Identite);
        WidgetRessourcePedagogique.prototype.creerObjetstRessourcePedagogique = function() {};
        WidgetRessourcePedagogique.prototype.initialiserObjetsRessourcePedagogique = function() {};
        WidgetRessourcePedagogique.prototype.composeWidgetRessourcePedagogique = function() {
            for (var i = 0; i < this.donnees.listeRessources.GetNbrElements(); i++) {
                var lRessource = this.donnees.listeRessources.GetElement(i);
                var lMatiere = this.donnees.listeMatieres.GetElementParNumero(lRessource.matiere.GetNumero());
                if (lMatiere && (!lMatiere.date || (lRessource.date > lMatiere.date))) {
                    lMatiere.date = lRessource.date;
                }
            }
            this.donnees.listeMatieres.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant)]);
            this.donnees.listeMatieres.trier();
            this.donnees.listeRessources.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant)]);
            this.donnees.listeRessources.trier();
            var H = [];
            H.push(this.composeWidgetRessourcePedagogique_Matiere());
            return H.join('');
        };
        WidgetRessourcePedagogique.prototype.composeWidgetRessourcePedagogique_Matiere = function(aMatiere) {
            var lExisteDocument = [],
                H = [];
            H.push('<ul role="list" class="liste-clickable">');
            for (var i = 0; i < this.donnees.listeRessources.GetNbrElements(); i++) {
                var lRessource = this.donnees.listeRessources.GetElement(i);
                var lCle = lRessource.GetGenre() + '_' + (lRessource.ressource ? lRessource.ressource.GetNumero() : '');
                lExisteDocument[lCle] = true;
                H.push(this.composeWidgetRessourcePedagogique_Ressource(i, lRessource));
            }
            H.push('</ul>');
            return H.join('');
        };
        WidgetRessourcePedagogique.prototype.composeWidgetRessourcePedagogique_Ressource = function(i, aDocument) {
            var lMatiere = this.donnees.listeMatieres.GetElementParNumero(aDocument.matiere.GetNumero());
            var H = [];
            var lSuffixe = aDocument.ressource.GetLibelle().split('.');
            var lTypefile = EformatDocJoint.getClassIconDeGenre(EformatDocJoint.getGenreDeFichier(lSuffixe[lSuffixe.length - 1]));
            var lAriaLabel = (lMatiere ? lMatiere.GetLibelle() : '') + ' ' + GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'), [GDate.FormatDate(aDocument.date, '%J %MMMM')]) + ' ';
            if (aDocument.GetGenre() === EGenreRessourcePedagogique.QCM) {
                H.push('<li role="listitem" tabIndex="0"  aria-label="', lAriaLabel, '" ', UtilitaireQCM.estCliquable(aDocument.ressource) ? 'onclick="' + this.Nom + '._surRessourceQCM (' + i + ')' : '', '" class="icon icon_file_alt">');
                H.push('<div class="wrap">');
                if (lMatiere) {
                    H.push('<h4>', lMatiere.GetLibelle(), '</h4>');
                }
                H.push('<span class="file-name">' + aDocument.ressource.QCM.GetLibelle() + '</span>', '<span class="date">', GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'), [GDate.FormatDate(aDocument.date, '%J %MMM')]), '</span>');
            } else {
                var lLien = null;
                if (aDocument.GetGenre() === EGenreRessourcePedagogique.travailRendu && !!aDocument.ressource.documentCorrige) {
                    lLien = GChaine.composerUrlLienExterne({
                        documentJoint: aDocument.ressource.documentCorrige,
                        genreRessource: TypeFichierExterneHttpSco.TAFCorrigeRenduEleve,
                        libelleEcran: GTraductions.getValeur('CahierDeTexte.TAFARendre.ConsulterLaCopieCorrigee'),
                        brut: true
                    });
                } else {
                    lLien = EGenreRessourcePedagogique.composerURL(aDocument.GetGenre(), aDocument.ressource, (aDocument.ressource.GetLibelle ? aDocument.ressource.GetLibelle() : aDocument.ressource), true);
                }
                H.push('<li tabIndex="0" role="listitem" aria-label="', lAriaLabel, '" title="', (aDocument.ressource.GetLibelle ? aDocument.ressource.GetLibelle() : aDocument.ressource), '" class="icon ', lTypefile, '" onclick="window.open(\'', lLien, '\')">', '<div class="wrap">');
                if (lMatiere) {
                    H.push('<h4>', lMatiere.GetLibelle(), '</h4>');
                }
                H.push('<a class="file-name">', (aDocument.ressource.GetLibelle ? aDocument.ressource.GetLibelle() : aDocument.ressource), '</a>');
                H.push('<span class="date">', GChaine.Format(GTraductions.getValeur('accueil.ressourcePedagogique.deposeLe'), [GDate.FormatDate(aDocument.date, '%J %MMM')]), '</span>');
            }
            H.push('</div>');
            H.push('</li>');
            return H.join('');
        };
        WidgetRessourcePedagogique.prototype._surRessourceQCM = function(i) {
            var lRessource = this.donnees.listeRessources.GetElement(i);
            this.afficherExecutionQCM(lRessource.ressource);
        };
        WidgetRessourcePedagogique.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.creerObjetstRessourcePedagogique();
            var lWidget = {
                html: this.composeWidgetRessourcePedagogique(),
                nbrElements: this.donnees.listeRessources.GetNbrElements(),
                afficherMessage: this.donnees.listeRessources.GetNbrElements() === 0
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
            this.initialiserObjetsRessourcePedagogique();
        };
        module.exports = WidgetRessourcePedagogique;
    },
    fn: "espace/script/widget/widgetressourcepedagogique.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var UtilitaireRedirection = require('UtilitaireRedirection.js');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');

        function WidgetRetourEspace() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetRetourEspace, Identite);
        WidgetRetourEspace.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            var lWidget = {
                html: this.composeWidgetRetourEspace()
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetRetourEspace.prototype.composeWidgetRetourEspace = function() {
            return '<div class="message-conteneur" onclick="' + this.Nom + '.retourEspaceBureau()">' + '<span class="IconeRetourEspace">&nbsp</span>' +
                GTraductions.getValeur('mobile.accederVersionClassique') + '</div>';
        };
        WidgetRetourEspace.prototype.retourEspaceBureau = function() {
            window.location.assign(GParametres.URLEspace + new UtilitaireRedirection().getParametresUrl({
                parametres: [{
                    parametre: 'fd',
                    valeur: '1'
                }],
                parametresASupprimer: ['redirect']
            }));
        };
        module.exports = WidgetRetourEspace;
    },
    fn: "mobile/script/widget/widgetretourespace.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieTAFFaitEleve() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieTAFFaitEleve', ObjetRequeteSaisieTAFFaitEleve, ObjetRequeteSaisie);
        ObjetRequeteSaisieTAFFaitEleve.prototype.lancerRequete = function(aParam) {
            this.JSON.listeTAF = aParam.listeTAF.setSerialisateurJSON({
                methodeSerialisation: _serialiserTAF
            });
            return this.appelAsynchrone();
        };

        function _serialiserTAF(aElement, aJSON) {
            aJSON.TAFFait = aElement.TAFFait;
        }
        ObjetRequeteSaisieTAFFaitEleve.prototype.actionApresRequete = function(aXml, aGenreReponse) {
            this.callbackReussite.appel(aXml, aGenreReponse, this.JSONRapportSaisie);
        };
        module.exports = ObjetRequeteSaisieTAFFaitEleve;
    },
    fn: "objetrequetesaisietaffaiteleve.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreRessource = require('Enumere_Ressource.js');
        var EGenreBloc = {
            Actu: 1,
            Agenda: 2,
            Discussion: 3,
            Casier: 4,
            Absence: 5,
            Retard: 6,
            TravailAFaire: 7,
            ContenuDeCours: 8,
            SaisiePrim_CDC: 9,
            CahiersDeTexte: 10,
            Billet: 11,
            Activite_Prim: 12
        };
        EGenreBloc.associerGenreBlocAListeElements = function(aGenreBloc, aListeElements) {
            var i, lNbr;
            for (i = 0, lNbr = aListeElements.GetNbrElements(); i < lNbr; i++) {
                var lElement = aListeElements.GetElement(i);
                lElement.genreBloc = aGenreBloc;
            }
        };
        EGenreBloc.estBlocVS = function(aGenreBloc) {
            switch (aGenreBloc) {
                case EGenreBloc.Absence:
                case EGenreBloc.Retard:
                    return true;
                default:
                    return false;
            }
        };
        EGenreBloc.getGenreBlocDeRessource = function(aGenreRessource) {
            switch (aGenreRessource) {
                case EGenreRessource.Absence:
                    return EGenreBloc.Absence;
                case EGenreRessource.Retard:
                    return EGenreBloc.Retard;
                default:
                    ;
            }
        };
        EGenreBloc.associerGenreBlocAListeElementsVS = function(aListeElements) {
            var i, lNbr;
            for (i = 0, lNbr = aListeElements.GetNbrElements(); i < lNbr; i++) {
                var lElement = aListeElements.GetElement(i);
                lElement.genreBloc = EGenreBloc.getGenreBlocDeRessource(lElement.Genre);
            }
        };
        module.exports.EGenreBloc = EGenreBloc;
    },
    fn: "enumere_bloc.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieTAFARendreEleve() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieTAFARendreEleve', ObjetRequeteSaisieTAFARendreEleve, ObjetRequeteSaisie);
        ObjetRequeteSaisieTAFARendreEleve.prototype.lancerRequete = function(aListeFichiers) {
            if (aListeFichiers) {
                this.JSON.listeFichiers = aListeFichiers.setSerialisateurJSON({
                    methodeSerialisation: _serialiserFichier
                });
            }
            return this.appelAsynchrone();
        };

        function _serialiserFichier(aElement, aJSON) {
            aJSON.idFichier = aElement.idFichier;
            aJSON.TAF = aElement.TAF;
        }
        ObjetRequeteSaisieTAFARendreEleve.prototype.actionApresRequete = function(aXml, aGenreReponse) {
            this.callbackReussite.appel(aXml, aGenreReponse, this.JSONRapportSaisie);
        };
        module.exports = ObjetRequeteSaisieTAFARendreEleve;
    },
    fn: "objetrequetesaisietafarendreeleve.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeNiveauDifficulte = {
            ND_NonPrecise: 0,
            ND_Facile: 1,
            ND_Moyen: 2,
            ND_Difficile: 3
        };
        module.exports.TypeNiveauDifficulte = TypeNiveauDifficulte;
        TypeNiveauDifficulte.typeToStr = function(aNiveauDifficulte, aAvecValPourNonPrecise) {
            if (!aAvecValPourNonPrecise && aNiveauDifficulte === TypeNiveauDifficulte.ND_NonPrecise) {
                return '';
            }
            return GTraductions.getValeur('TypeNiveauDifficulte.' + aNiveauDifficulte);
        };
        TypeNiveauDifficulte.getImage = function(aParams) {
            return aParams.niveauDifficulte ? ['<div', (aParams.alignementMilieu || aParams.enInlineBlock ? ' class="' + (aParams.alignementMilieu ? 'AlignementMilieu' : '') + ' ' + (aParams.enInlineBlock ? 'InlineBlock' : '') + '" ' : ''), (aParams.avecTitle || aParams.avecTitle === null || aParams.avecTitle === undefined ? ' title="' + this.typeToStr(aParams.niveauDifficulte, aParams.avecValPourNonPrecise) + '"' : ''), '>', this.construireIcon(aParams), '</div>'].join('') : '';
        };
        TypeNiveauDifficulte.construireIcon = function(aParams) {
            switch (aParams.niveauDifficulte) {
                case TypeNiveauDifficulte.ND_Facile:
                    return creerIconEtoile([1, 0, 0], aParams.color);
                case TypeNiveauDifficulte.ND_Moyen:
                    return creerIconEtoile([1, 1, 0], aParams.color);
                case TypeNiveauDifficulte.ND_Difficile:
                    return creerIconEtoile([1, 1, 1], aParams.color);
                default:
                    return '';
            }
        };

        function creerIconEtoile(aArrayEtoiles, aColor) {
            var lResult = [];
            var lStyle = '';
            if (aColor) {
                lStyle = ' style="color:' + aColor + ';"';
            }
            for (var i in aArrayEtoiles) {
                var lIcon = 'icon_star_empty';
                if (aArrayEtoiles[i]) {
                    lIcon = 'icon_star';
                }
                lResult.push('<i class="material-icons ', lIcon, '"', lStyle, '></i>');
            }
            return lResult.join('');
        }
        TypeNiveauDifficulte.toElement = function(aGenre, aAvecValPourNonPrecise) {
            return new ObjetElement(TypeNiveauDifficulte.typeToStr(aGenre, aAvecValPourNonPrecise), 0, aGenre);
        };
        TypeNiveauDifficulte.fromElement = function(aElement) {
            return (aElement !== null) && (aElement !== undefined) ? aElement.GetGenre() : TypeNiveauDifficulte.ND_NonPrecise;
        };
        TypeNiveauDifficulte.toListe = function(aAvecValPourNonPrecise) {
            var lListeNiveaux = new ObjetListeElements();
            for (var iNiveau in TypeNiveauDifficulte) {
                var lNiveau = TypeNiveauDifficulte[iNiveau];
                if (MethodesObjet.isNumber(lNiveau)) {
                    lListeNiveaux.AddElement(TypeNiveauDifficulte.toElement(lNiveau, aAvecValPourNonPrecise));
                }
            }
            lListeNiveaux.setTri([ObjetTri.init('Genre')]);
            lListeNiveaux.trier();
            return lListeNiveaux;
        };
    },
    fn: "typeniveaudifficulte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeOrigineCreationCategorieCahierDeTexte = {
            OCCCDT_Utilisateur: 0,
            OCCCDT_Pre_Cours: 1,
            OCCCDT_Pre_Correction: 2,
            OCCCDT_Pre_Devoir: 3,
            OCCCDT_Pre_Interro: 4,
            OCCCDT_Pre_TD: 5,
            OCCCDT_Pre_TP: 6,
            OCCCDT_Pre_Evaluation: 7,
            OCCCDT_Pre_EPI: 8,
            OCCCDT_Pre_AP: 9,
            OCCCDT_Pre_Mod_Peda_Oral: 10,
            OCCCDT_Pre_Mod_Peda_Ecrit: 11
        };
        module.exports.TypeOrigineCreationCategorieCahierDeTexte = TypeOrigineCreationCategorieCahierDeTexte;
        TypeOrigineCreationCategorieCahierDeTexte.getImage = function(aGenre) {
            switch (aGenre) {
                case TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Devoir:
                    return 'Image_IconeDS';
                case TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Evaluation:
                    return 'Image_IconeEvaluation';
                case TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_EPI:
                    return 'Image_IconeEPI';
                case TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_AP:
                    return 'Image_IconeAP';
            }
            return '';
        };
        TypeOrigineCreationCategorieCahierDeTexte.typesAvecImages = [
            TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Devoir, TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Evaluation, TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_EPI, TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_AP
        ];
    },
    fn: "typeoriginecreationcategoriecahierdetexte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EModeAffichageTimeline = {
            classique: 1,
            widget: 2,
            grille: 3,
            compact: 4
        };
        module.exports = EModeAffichageTimeline;
    },
    fn: "enumere_modeaffichagetimeline.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetFenetre = require('ObjetFenetre.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeThemeBouton = require('Type_ThemeBouton.js');
        var GPosition = require('GPosition.js');
        var GHtml = require('GHtml.js');

        function ObjetFenetre_Bloc() {
            this.inheritedCreate(arguments);
            this._donnees = {
                element: null,
                gestionnaireBloc: null
            };
            this._idBloc = this.Nom + '_fenetre_bloc';
            this.idScroll = this.Nom + '_scroll';
            this.setOptionsFenetre({
                avecTitre: false,
                largeur: 'auto',
                largeurMin: 600,
                hauteur: 'auto',
                hauteurMin: 150,
                marge: 7,
                listeBoutons: [{
                    libelle: GTraductions.getValeur('Fermer'),
                    index: 0,
                    theme: TypeThemeBouton.secondaire
                }],
                avecPaddingContenu: false,
                positionnerFenetreSurAfficher: false
            });
            this.setLargeurMin(this.optionsFenetre.largeurMin);
            this.hauteurMax = GNavigateur.EcranH - 70;
        }
        MethodesObjet.heritagePrototype(ObjetFenetre_Bloc, ObjetFenetre);
        ObjetFenetre_Bloc.prototype.setLargeurMin = function(aValeur) {
            if (aValeur !== this.optionsFenetre.largeurMin) {
                this.setOptionsFenetre({
                    largeurMin: aValeur
                });
            }
            this.largeurMax = GNavigateur.EcranL - 100;
            if (this.largeurMax < this.optionsFenetre.largeurMin) {
                this.largeurMax = this.optionsFenetre.largeurMin;
            }
        };
        ObjetFenetre_Bloc.prototype.SetDonnees = function(aDonnees) {
            $.extend(this._donnees, aDonnees);
            this.Actualiser();
            this.Afficher();
            this.remplirBlocs();
            this.apresAfficher();
            this.$refreshSelf();
        };
        ObjetFenetre_Bloc.prototype.remplirBlocs = function() {
            if (!!this._donnees.liste) {
                var nbElements = this._donnees.liste.GetNbrElements();
                for (var i = 0; i < nbElements; i++) {
                    var aElement = this._donnees.liste.GetElement(i);
                    this.ajouterElementAuBloc(aElement, i);
                }
            } else {
                this.ajouterElementAuBloc(this._donnees.element, 0);
            }
        };
        ObjetFenetre_Bloc.prototype.ajouterElementAuBloc = function(aElement, aIndice) {
            var lEltBloc = this.composeElementBloc(aElement);
            if (lEltBloc) {
                var lElementAvecMarge = '';
                if (aIndice > 0) {
                    lElementAvecMarge = '<div style="margin: 2px 10px 5px 10px;" ><hr style="border-color: ' + GCouleur.themeNeutre.light + ';" /></div>';
                }
                lElementAvecMarge += '<div>' + lEltBloc.html + '</div>';
                GHtml.addHtml(this._idBloc, lElementAvecMarge, {
                    controleur: lEltBloc.controleur
                });
            }
        };
        ObjetFenetre_Bloc.prototype.composeElementBloc = function(aElement) {
            if (this._donnees.gestionnaireBloc !== null) {
                return this._donnees.gestionnaireBloc.composeBlocComplet(aElement);
            }
        };
        ObjetFenetre_Bloc.prototype.infoOverflow = function(aWidthBtnAction) {
            var lResult = {
                avecOverflow: false,
                scrollWidth: this.optionsFenetre.largeurMin - aWidthBtnAction,
                scrollHeight: 0
            };
            var lJqElm = $('#' + this._idBloc.escapeJQ()).find('.PourFenetreBloc_Contenu');
            lJqElm.each(function(index, element) {
                if (lResult.scrollWidth < element.scrollWidth) {
                    if (element.scrollWidth === this.largeurMax - 20 - aWidthBtnAction) {
                        $(element).width(lResult.scrollWidth);
                        if (element.scrollWidth > lResult.scrollWidth) {
                            lResult.scrollWidth = element.scrollWidth;
                        }
                        $(element).css('width', 'auto');
                    } else {
                        lResult.scrollWidth = element.scrollWidth;
                    }
                }
                if (lResult.scrollHeight < element.scrollHeight) {
                    lResult.scrollHeight = element.scrollHeight;
                }
            }.bind(this));
            if (lResult.scrollWidth > this.largeurMax - 20 - aWidthBtnAction) {
                lResult.avecOverflow = true;
            }
            return lResult;
        };
        ObjetFenetre_Bloc.prototype.apresAfficher = function() {
            if (!!this._donnees.gestionnaireBloc) {
                this._donnees.gestionnaireBloc.refresh();
                GPosition.placer(this.Nom, 0, 0);
                if (this.idScroll) {
                    $('#' + this.idScroll.escapeJQ()).destroyScrollPane();
                    var lJqScroll = $('#' + this.idScroll.escapeJQ());
                    if (lJqScroll.length === 1) {
                        var lNewWidth = this.largeurMax;
                        var lJqBloc = $('#' + this._idBloc.escapeJQ());
                        var lHeight = lJqBloc.outerHeight(true);
                        var lWidth = lJqBloc.outerWidth(true) + 5;
                        var lRatioHeight = ((lHeight + this.hauteurMax) / (this.hauteurMax * 2));
                        var lRatioWidth = (lWidth + this.largeurMax) / (this.largeurMax * 2);
                        var lWidthBtnAction = this._donnees.gestionnaireBloc._instances && this._donnees.gestionnaireBloc._instances.length > 0 ? this._donnees.gestionnaireBloc._instances[0].getWidthBtnAction() : 0;
                        var lInfoOverflow = this.infoOverflow(lWidthBtnAction);
                        var lJqContenu = lJqBloc.find('.PourFenetreBloc_Contenu');
                        if ((((lHeight < this.hauteurMax) && (lWidth >= this.largeurMax)) || (lRatioHeight < lRatioWidth) || ((lRatioHeight > 1) && (lRatioWidth < 1))) && !lInfoOverflow.avecOverflow) {
                            lNewWidth = Math.max(Math.ceil(this.largeurMax * lRatioHeight), this.optionsFenetre.largeurMin, lInfoOverflow.scrollWidth + 20 + lWidthBtnAction);
                            lNewWidth = Math.min(lNewWidth, this.largeurMax);
                            lJqScroll.css({
                                "maxWidth": lNewWidth
                            });
                            lJqContenu.css({
                                "maxWidth": lNewWidth - 20 - lWidthBtnAction
                            });
                        }
                        if (lInfoOverflow.avecOverflow) {
                            lJqContenu.each(function(index, element) {
                                $(element).css({
                                    "overflow": ""
                                });
                                $(element).css({
                                    "maxWidth": ""
                                });
                                $(element).width(lInfoOverflow.scrollWidth);
                                $(element).parents('.UtilitaireBloc_containerNormal').first().css({
                                    "justify-content": "flex-start"
                                });
                            });
                        }
                        if ((lHeight > this.hauteurMax) || (lWidth > this.largeurMax) || lInfoOverflow.avecOverflow) {
                            lJqScroll.ieScrollPane();
                        }
                    }
                }
                if (this._donnees.coordonnees) {
                    GPosition.placer(this.Nom, this._donnees.coordonnees.left, this._donnees.coordonnees.top);
                    this.setCoordonnees();
                } else {
                    GPosition.centrer(this.Nom, null, true);
                }
            }
        };
        ObjetFenetre_Bloc.prototype.ComposeContenu = function() {
            var T = [];
            var lHauteurZoneDeplacement = this.optionsFenetre.marge + 16;
            T.push('<div class="ZoneDeplacementFenetre" style="position:absolute;width:100%; height: ', lHauteurZoneDeplacement, 'px; top: 0px; left:0px; z-index:100;"></div>');
            T.push('<div id="', this.idScroll, '" class="Fenetre_Scroll" style="width:100%; height:100%; max-height:', this.hauteurMax, 'px; max-width:', this.largeurMax, 'px;">');
            T.push('<div id="', this._idBloc, '"></div>');
            T.push('</div>');
            return T.join('');
        };
        module.exports = ObjetFenetre_Bloc;
    },
    fn: "objetfenetre_bloc.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Identite = require('ObjetIdentite.js');
        var GStyle = require('GStyle.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var EModeAffichage = require('Enumere_ModeAffichageTimeline.js');
        var ObjetFenetre_Bloc = require('ObjetFenetre_Bloc.js');

        function TUtilitaireCDT() {}
        TUtilitaireCDT.strtMatiere = function(aMatiere, aListeGroupes, aPourFiche) {
            var H = [];
            H.push('<div class="InlineBlock" style="float: left; margin-right: 3px; width: 8px; height: 12px; ', GStyle.composeCouleurFond(aMatiere.CouleurFond), '"></div>', '<div class="InlineBlock', aPourFiche ? ' Move' : '', '">', '<span class="Gras">', aMatiere.GetLibelle() ? aMatiere.GetLibelle() : '&nbsp;', '</span>', aListeGroupes ? (' (' + aListeGroupes.getTableauLibelles().join(', ') + ')') : '', '</div>');
            return H.join('');
        };
        TUtilitaireCDT.strtDate = function(aDate) {
            var H = [];
            H.push(aDate ? GTraductions.getValeur('CahierDeTexte.le') + GDate.FormatDate(aDate, ' %JJ %MMMM %AAAA ' + GTraductions.getValeur('CahierDeTexte.a') + ' %hh%sh%mm') : '');
            return H.join('');
        };
        TUtilitaireCDT.afficheFenetreDetail = function(aObjetDonnee, aParams, aOptions) {
            if (this.fenetreCDT) {
                this._coordonneesFenetreCDT = this.fenetreCDT.coordonnees;
                this.fenetreCDT.Fermer();
            } else {
                this._coordonneesFenetreCDT = null;
            }
            var lGestionnaireBloc;
            var lParams = {
                fenetre: true
            };
            if (aParams) {
                $.extend(lParams, aParams);
            }
            lGestionnaireBloc = Identite.creerInstance(aObjetDonnee.gestionnaire, {
                pere: this,
                evenement: lParams.evenementSurBlocCDT ? lParams.evenementSurBlocCDT.bind(this, lParams) : this.evenementSurBlocCDT.bind(this, lParams)
            });
            var lOptions = {
                avecPastille: false,
                modeAffichage: EModeAffichage.classique,
                formatDate: '%JJJ %JJ %MMM',
                avecZoneAction: false,
                avecBordure: false,
                avecOmbre: false,
                initPlie: false,
                callBackTitre: undefined
            };
            if (aOptions) {
                $.extend(lOptions, aOptions);
            }
            lGestionnaireBloc.setOptions(lOptions);
            var lObjDonnees = {
                gestionnaireBloc: lGestionnaireBloc
            };
            if (aObjetDonnee) {
                lObjDonnees.element = aObjetDonnee;
            }
            if (this._coordonneesFenetreCDT && this._coordonneesFenetreCDT.left !== null && this._coordonneesFenetreCDT.top !== null) {
                lObjDonnees.coordonnees = this._coordonneesFenetreCDT;
            }
            this.fenetreCDT = ObjetFenetre.creerInstance(ObjetFenetre_Bloc, {
                pere: this,
                initialiser: false
            });
            this.fenetreCDT.setOptionsFenetre({
                modale: false
            });
            this.fenetreCDT.Initialiser();
            this.fenetreCDT.SetDonnees(lObjDonnees);
        };
        TUtilitaireCDT.initGrilleCalendrier = function(aInstance) {
            aInstance.SetParametres(GParametres.PremiereDate, GParametres.DerniereDate, GParametres.JoursOuvres, false, false, false, false, false, false);
            aInstance.setOptions({
                avecDeploiement: false,
                avecSelection: true,
                avecCouleurSelection: false
            });
        };
        module.exports = TUtilitaireCDT;
    },
    fn: "utilitairecdt.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeThemeBouton = require('Type_ThemeBouton.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetListeElements = require('ObjetListeElements.js');
        var UtilitaireTraitementImage = require('UtilitaireTraitementImage.js');
        var TUtilitaireUrl = require('UtilitaireUrl.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var UtilitaireSelecFile = require('UtilitaireSelecFile.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var EGenreAction = require('Enumere_Action.js');
        require('ObjetFenetre_UploadFichiers.css');
        MethodesObjet.heritagePrototype(ObjetFenetre_UploadFichiers, ObjetFenetre);

        function ObjetFenetre_UploadFichiers() {
            this.inheritedCreate(arguments);
            this.setOptionsFenetre({
                modale: true,
                titre: GTraductions.getValeur('FenetreUploadFichiers.Titre'),
                largeur: 400,
                hauteur: 320,
                listeBoutons: []
            });
            this.optionsFenetreUpload = {
                libelleContexteFenetre: null,
                tailleMaxUploadFichier: 0,
                avecRetaillageImage: true,
                avecGenerationPDFImages: true,
                functionGetNomPdfGenere: null
            };
            this.donnees = {
                genreRessourcePJ: null,
                listeFichiersEnAttente: new ObjetListeElements()
            };
        }

        function _getNomPdfGenere() {
            var lNomPDF;
            if (!!this.optionsFenetreUpload.functionGetNomPdfGenere) {
                lNomPDF = this.optionsFenetreUpload.functionGetNomPdfGenere();
                if (!!lNomPDF) {
                    lNomPDF = lNomPDF.replace(/ /g, "");
                }
            }
            if (!lNomPDF) {
                lNomPDF = GDate.FormatDate(GDate.getDateHeureCourante(), '%JJ%MM%AAAA_%hh%mm%ss') + '.pdf';
            }
            return lNomPDF;
        }
        ObjetFenetre_UploadFichiers.prototype.getControleur = function(aInstance) {
            return {
                BoutonUnSeulFichier: {
                    getOptionsSelecFile: function() {
                        return {
                            maxSize: aInstance.optionsFenetreUpload.tailleMaxUploadFichier
                        };
                    },
                    addFiles: function(aParams) {
                        aInstance.callback.appel(EGenreAction.Valider, new ObjetListeElements().AddElement(aParams.eltFichier));
                    }
                },
                BoutonPlusieursImages: {
                    getOptionsSelecFile: function() {
                        var lOptionsSelecFile = {
                            maxSize: aInstance.optionsFenetreUpload.tailleMaxUploadFichier,
                            multiple: true,
                            maxFiles: 20,
                            avecResizeImage: aInstance.optionsFenetreUpload.avecRetaillageImage
                        };
                        if (!aInstance.optionsFenetreUpload.avecGenerationPDFImages) {
                            lOptionsSelecFile.accept = 'image/*';
                        }
                        if (aInstance.optionsFenetreUpload.avecGenerationPDFImages) {
                            lOptionsSelecFile.genererPDFImages = true;
                            lOptionsSelecFile.nomPDFaGenerer = _getNomPdfGenere.call(aInstance);
                        }
                        return lOptionsSelecFile;
                    },
                    addFiles: function(aParams) {
                        aInstance.callback.appel(EGenreAction.Valider, aParams.listeFichiers);
                    }
                },
                BoutonAjoutImageUnique: {
                    getOptionsSelecFile: function() {
                        var lOptionsSelectFile = {
                            avecResizeImage: aInstance.optionsFenetreUpload.avecRetaillageImage,
                            maxSize: aInstance.optionsFenetreUpload.tailleMaxUploadFichier
                        };
                        if (aInstance.optionsFenetreUpload.avecGenerationPDFImages) {
                            lOptionsSelectFile.accept = UtilitaireTraitementImage.getTabMIME_PDFImage().join(', ');
                        }
                        return lOptionsSelectFile;
                    },
                    addFiles: function(aParams) {
                        var lFichier = aParams.eltFichier;
                        aInstance.donnees.listeFichiersEnAttente.AddElement(lFichier);
                    }
                },
                getHtmlFichiersEnAttente: function() {
                    return TUtilitaireUrl.construireListeUrls({
                        liste: aInstance.donnees.listeFichiersEnAttente,
                        genreRessource: aInstance.donnees.genreRessourcePJ,
                        separateur: '<div class="InlineBlock" style="width:1rem;"> </div>',
                        IEModelBtnSupp: 'SuppressionFichierEnAttente'
                    });
                },
                SuppressionFichierEnAttente: {
                    event: function(aIndice) {
                        var lFichierASupp = aInstance.donnees.listeFichiersEnAttente.GetElement(aIndice);
                        if (!!lFichierASupp) {
                            lFichierASupp.SetEtat(EGenreEtat.Suppression);
                        }
                    }
                },
                BoutonEnvoiFichiersEnAttente: {
                    event: function() {
                        if (!!aInstance.donnees.listeFichiersEnAttente) {
                            var lListeFichiersAEnvoyer = new ObjetListeElements();
                            lListeFichiersAEnvoyer = aInstance.donnees.listeFichiersEnAttente.getListeElements(function(aElement) {
                                return aElement.Existe();
                            });
                            if (lListeFichiersAEnvoyer.GetNbrElements() > 0) {
                                if (aInstance.optionsFenetreUpload.avecGenerationPDFImages) {
                                    var lNomPDF = _getNomPdfGenere.call(aInstance);
                                    var lMessagesErreur = [];
                                    UtilitaireSelecFile.genererPdfPromise(lListeFichiersAEnvoyer, lMessagesErreur, lNomPDF, EGenreDocumentJoint.Fichier).then(function() {
                                        lListeFichiersAEnvoyer = UtilitaireSelecFile.controleTailleFichiers(lListeFichiersAEnvoyer, lMessagesErreur, aInstance.optionsFenetreUpload.tailleMaxUploadFichier);
                                        if (lMessagesErreur.length > 0) {
                                            return GApplication.getMessage().afficher({
                                                message: lMessagesErreur.join('<br>')
                                            });
                                        } else {
                                            var lFichierPdfGenere = lListeFichiersAEnvoyer.GetElement(0);
                                            aInstance.callback.appel(EGenreAction.Valider, new ObjetListeElements().AddElement(lFichierPdfGenere));
                                        }
                                    });
                                } else {
                                    aInstance.callback.appel(EGenreAction.Valider, lListeFichiersAEnvoyer);
                                }
                            }
                        }
                    },
                    getDisabled: function() {
                        return !aInstance.donnees.listeFichiersEnAttente || aInstance.donnees.listeFichiersEnAttente.GetNbrElementsExistes() === 0;
                    }
                }
            };
        };
        ObjetFenetre_UploadFichiers.prototype.setDonnees = function(aGenreRessourcePieceJointe, aOptionsFenetre) {
            this.donnees.genreRessourcePJ = aGenreRessourcePieceJointe;
            if (!!aOptionsFenetre) {
                Object.assign(this.optionsFenetreUpload, aOptionsFenetre);
            }
        };

        function _composeZoneAjoutImageUnique() {
            var H = [];
            H.push('<div id="libelleExplicationSelectionUnique">', GTraductions.getValeur('FenetreUploadFichiers.SelectionUneParUne'), '</div>');
            H.push('<div>', '<ie-bouton ie-model="BoutonAjoutImageUnique" ie-selecfile class="BoutonSelecteurFichier ', TypeThemeBouton.secondaire, '">', GTraductions.getValeur('FenetreUploadFichiers.BoutonUneImage'), '</ie-bouton>', '</div>');
            H.push('<div id="listeFichiersEnAttente" ie-html="getHtmlFichiersEnAttente"></div>');
            H.push('<div id="wrapperBoutonEnvoiFichiersEnAttente">', '<ie-bouton ie-model="BoutonEnvoiFichiersEnAttente" class="', TypeThemeBouton.secondaire, '">', GTraductions.getValeur('FenetreUploadFichiers.EnvoyerImages'), '</ie-bouton>', '</div>');
            return H.join('');
        }

        function composeContenuFenetre() {
            var H = [];
            H.push('<div class="FenetreUploadFichiers">');
            if (!!this.optionsFenetreUpload.libelleContexteFenetre) {
                H.push('<div id="libelleContexte">', this.optionsFenetreUpload.libelleContexteFenetre, '</div>');
            }
            H.push('<div id="ChoixTypeUpload">');
            H.push('<div>', GTraductions.getValeur('FenetreUploadFichiers.ChoisissezNatureFichier'), '</div>');
            H.push('<div>', '<ie-bouton ie-model="BoutonUnSeulFichier" ie-selecfile class="BoutonSelecteurFichier ', TypeThemeBouton.secondaire, '">', GTraductions.getValeur('FenetreUploadFichiers.BoutonUnSeulFichier'), '</ie-bouton>', '</div>');
            H.push('<div id="libelleOu">', GTraductions.getValeur('FenetreUploadFichiers.ou'), '</div>');
            H.push('<div>', '<ie-bouton ie-model="BoutonPlusieursImages" ie-selecfile class="BoutonSelecteurFichier ', TypeThemeBouton.secondaire, '">', GTraductions.getValeur('FenetreUploadFichiers.BoutonPlusieursImages'), '</ie-bouton>', '</div>');
            H.push('</div>');
            H.push('<div id="SelectionUnitaire">', _composeZoneAjoutImageUnique.call(this), '</div>');
            H.push('</div>');
            return H.join('');
        }
        ObjetFenetre_UploadFichiers.prototype.afficher = function() {
            var lContenuFenetre = composeContenuFenetre.call(this);
            this.Afficher(lContenuFenetre);
        };
        module.exports = ObjetFenetre_UploadFichiers;
    },
    fn: "objetfenetre_uploadfichiers.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var Callback = require('Callback.js');
        var GUID = require('GUID.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreBloc = require('Enumere_Bloc.js').EGenreBloc;
        var GDate = require('ObjetDate.js').GDate;
        var GImage = require('ObjetImage.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAffichageCahierDeTextes = require('Enumere_AffichageCahierDeTextes.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetRequeteSaisieTAFARendreEleve = require('ObjetRequeteSaisieTAFARendreEleve.js');
        var TypeGenreRenduTAF = require('TypeGenreRenduTAF.js').TypeGenreRenduTAF;
        var TypeNiveauDifficulte = require('TypeNiveauDifficulte.js').TypeNiveauDifficulte;
        var TypeOrigineCreationCategorieCahierDeTexte = require('TypeOrigineCreationCategorieCahierDeTexte.js').TypeOrigineCreationCategorieCahierDeTexte;
        var TUtilitaireCDT = require('UtilitaireCDT.js');
        var UtilitaireQCM = require('UtilitaireQCM.js').UtilitaireQCM;
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;
        var ObjetFenetre = require('ObjetFenetre.js');
        var EGenreAction = require('Enumere_Action.js');
        var ObjetFenetre_UploadFichiers = require('ObjetFenetre_UploadFichiers.js');

        function ObjetUtilitaireCahierDeTexte(aNom, aPere, aEvenement) {
            this.Nom = aNom;
            this.pere = aPere;
            this.evenement = aEvenement;
            this.callback = new Callback(this.pere, aEvenement);
            this.peuFaireTAF = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve]);
            this.idTAFARendre = GUID.getId();
        }
        ObjetUtilitaireCahierDeTexte.prototype.composeCDC = function(aElement, aParam) {
            var lHtml = [],
                i;
            for (i = 0; i < aElement.listeContenus.GetNbrElements(); i++) {
                var lContenu = aElement.listeContenus.GetElement(i);
                lHtml.push('<div class="Espace">', '<div class="Espace" style="', GStyle.composeCouleur(GCouleur.blanc, GCouleur.noire, GCouleur.themeNeutre.claire), '">');
                if (MethodesTableau.existe(lContenu.categorie.GetGenre(), [TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Devoir, TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Evaluation])) {
                    lHtml.push('<div style="float: right">', _composeSymboleCategorie(lContenu.categorie.GetGenre()), '</div>');
                }
                lHtml.push('<div>', lContenu.Libelle, (lContenu.categorie.Libelle ? (lContenu.Libelle ? ' - ' : '') + lContenu.categorie.Libelle : ''), '</div>');
                lHtml.push('<div>', lContenu.descriptif, '</div>');
                if (lContenu.ListePieceJointe.GetNbrElements() > 0) {
                    lHtml.push('<div>', this.composePiecesJointes(lContenu, aParam.nom, false), '</div>');
                }
                if (lContenu.listeExecutionQCM.GetNbrElements() > 0) {
                    var nbExecutionQCM = lContenu.listeExecutionQCM.GetNbrElements();
                    for (var j = 0; j < nbExecutionQCM; j++) {
                        var lExecutionQCM = lContenu.listeExecutionQCM.GetElement(j);
                        lHtml.push('<div>', this.getTitreExecutionQCMContenu(aElement.GetNumero() + '_' + lContenu.GetNumero() + '_' + j, lExecutionQCM, aParam.nom), '</div>');
                    }
                }
                lHtml.push('</div>', '</div>');
            }
            var lElementProgrammeCDT;
            if (aElement.listeElementsProgrammeCDT && aElement.listeElementsProgrammeCDT.GetNbrElements()) {
                lHtml.push('<div class="Espace">', '<div class="Espace" style="', GStyle.composeCouleur(GCouleur.blanc, GCouleur.noire, GCouleur.themeNeutre.claire), '">', '<div class="Gras">', GTraductions.getValeur('CahierDeTexte.ElementsProgramme'), ' :', '</div>', '<ul>');
                for (i = 0; i < aElement.listeElementsProgrammeCDT.GetNbrElements(); i++) {
                    lElementProgrammeCDT = aElement.listeElementsProgrammeCDT.GetElement(i);
                    lHtml.push('<li>', lElementProgrammeCDT.GetLibelle(), '</li>');
                }
                lHtml.push('</ul>', '</div>', '</div>');
            }
            if (aElement.ListeTravailAFaire.GetNbrElements()) {
                lHtml.push('<div>', this.composeTAF(aElement, aElement.ListeTravailAFaire, true), '</div>');
            }
            return lHtml.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.getTitreExecutionQCM = function(I, aExecutionQCM, aNom) {
            var H = [];
            var lAvecAction = aNom &&
                UtilitaireQCM.estCliquable(aExecutionQCM);
            var lAction = lAvecAction ? ' class="AvecMain Souligne" onclick="' + aNom + '.surExecutionQCM (event, \'' + I + '\')"' : '';
            H.push('<div>', aExecutionQCM.estEnPublication === true ? GTraductions.getValeur('ExecutionQCM.RepondreQCM') : GDate.FormatDate(aExecutionQCM.dateDebutPublication, '' + GTraductions.getValeur('ExecutionQCM.QCMPublieLe') + ' %J %MMMM'), ' : ', '<span', lAction, '>', aExecutionQCM.QCM.GetLibelle(), '</span>', '</div>');
            return H.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.getTitreExecutionQCMContenu = function(I, aExecutionQCM, aNom) {
            var H = [];
            var lAvecAction = aNom &&
                UtilitaireQCM.estCliquable(aExecutionQCM);
            var lAction = lAvecAction ? ' class="AvecMain Souligne" onclick="' + aNom + '.surExecutionQCMContenu (event, \'' + I + '\')"' : '';
            H.push('<div>', GTraductions.getValeur('ExecutionQCM.RepondreQCMContenu'), ' : ', '<span', lAction, '>', aExecutionQCM.QCM.GetLibelle(), '</span>', '</div>');
            return H.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.composePiecesJointes = function(aElement) {
            var lHtml = [];
            var nbPiecesJointes = aElement.ListePieceJointe.GetNbrElements();
            for (var I = 0; I < nbPiecesJointes; I++) {
                var lPieceJointe = aElement.ListePieceJointe.GetElement(I);
                lHtml.push('<div>', GChaine.composerUrlLienExterne({
                    documentJoint: lPieceJointe
                }), '</div>');
            }
            return lHtml.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.composeTitreTAF = function(aElement, aListe, aPourGrille) {
            var T = [];
            T.push('<table ', GObjetWAI.composeRole(EGenreRole.Gridcell), ' style="', GStyle.composeCouleur(GCouleur.themeNeutre.legere, GCouleur.noire), ' width:100%; height:15px;" border="0" cellpadding="0" cellspacing="0">', '<tr>', '<td class="Texte10 ', (!aPourGrille ? 'AvecMove' : ''), '"><div class="PetitEspace Texte10">', TUtilitaireCDT.strtMatiere(aElement, aElement.groupe, false), '</td>', '</tr>', '</table>');
            return T.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.composeTitreCDC = function(aElement, aListeCDT) {
            var T = [];
            var lElt = aListeCDT.GetElementParNumero(aElement.ressources.GetNumero(0));
            var lClasseSelectionnee = GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Classe);
            if (!lClasseSelectionnee && GEtatUtilisateur.getMembre()) {
                lClasseSelectionnee = GEtatUtilisateur.getMembre().Classe;
            }
            var lAvecGroupe = !!lElt.listeGroupes && lElt.listeGroupes.GetNbrElements() > 0 && !!lElt.listeGroupes.GetElement(0) && lClasseSelectionnee && (lClasseSelectionnee.GetNumero() !== lElt.listeGroupes.GetElement(0).GetNumero());
            T.push('<table ', GObjetWAI.composeRole(EGenreRole.Gridcell), ' style="', GStyle.composeCouleur(GCouleur.themeNeutre.legere, GCouleur.noire), ' width:100%; height:15px;" border="0" cellpadding="0" cellspacing="0">', '<tr>', '<td class="Texte10 AvecMove"><div class="PetitEspace Texte10">', '<div>', TUtilitaireCDT.strtMatiere(aElement, lAvecGroupe ? lElt.listeGroupes : false, false), '</div>', '<div>', TUtilitaireCDT.strtDate(aElement.Date), '</div>', '</td>', '</tr>', '</table>');
            return T.join('');
        };

        function _composeSymboleCategorie(aGenre) {
            var T = [];
            T.push('<div class="InlineBlock ', TypeOrigineCreationCategorieCahierDeTexte.getImage(aGenre), ' AlignementMilieuVertical" style="width:17px"></div>');
            return T.join('');
        }
        ObjetUtilitaireCahierDeTexte.prototype.composeTAF = function(aElement, aListeTAF, aParam, aPourLe) {
            var T = [],
                I;
            var lNbrElements = aElement.ressources ? aElement.ressources.GetNbrElements() : aListeTAF.GetNbrElements();
            var lElement, lRessource;
            var lBandeauDS;
            var lDonneLe, lNewDonneLe;
            var lPourLe, lNewPourLe;
            for (I = 0; I < lNbrElements; I++) {
                if (aElement.ressources) {
                    lRessource = aElement.ressources.GetElement(I);
                    lElement = lRessource.estUnDS ? lRessource : aListeTAF.GetElementParNumero(lRessource.GetNumero());
                } else {
                    lElement = aListeTAF.GetElement(I);
                }
                if (lElement.estUnDS) {
                    if (!lBandeauDS) {
                        T.push('<div style="height:4px; ', GStyle.composeCouleur(GCouleur.themeNeutre.legere, GCouleur.noire), '">&nbsp;</div>');
                        lBandeauDS = true;
                    }
                    if (lElement.estDevoir) {
                        T.push('<div class="NoWrap PetitEspace EspaceGauche">', '<div class="InlineBlock GrandEspaceDroit AlignementMilieuVertical" >', lElement.GetLibelle(), '</div>', _composeSymboleCategorie(TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Devoir), '</div>');
                    }
                    if (lElement.estEval) {
                        T.push('<div class="NoWrap PetitEspace EspaceGauche">', '<div class="InlineBlock GrandEspaceDroit AlignementMilieuVertical" >', lElement.GetLibelle(), '</div>', _composeSymboleCategorie(TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Evaluation), '</div>');
                    }
                } else {
                    var lNbJours = lElement.DonneLe ? GDate.GetDifferenceJours(lElement.PourLe, lElement.DonneLe) : 0;
                    var lStrJours = (lNbJours > 1 ? GTraductions.getValeur('CahierDeTexte.jours') : GTraductions.getValeur('CahierDeTexte.jour'));
                    lNewDonneLe = GTraductions.getValeur('CahierDeTexte.donneLe') + GDate.FormatDate(lElement.DonneLe, ' %JJ/%MM');
                    lNewPourLe = GTraductions.getValeur('CahierDeTexte.pourLe') + GDate.FormatDate(lElement.PourLe, ' %JJ/%MM');
                    T.push('<div class="Espace">');
                    if (aPourLe) {
                        if (!lPourLe || lPourLe !== lNewPourLe) {
                            T.push('<div class="EspaceBas">', '<span class="Gras">' + lNewPourLe + '</span><span>', '</div>');
                        }
                    } else {
                        if (!lDonneLe || lDonneLe !== lNewDonneLe) {
                            T.push('<div class="EspaceBas">', '<span class="Gras">' + lNewDonneLe + '</span><span>' + ' [' + lNbJours + ' ' + lStrJours + ']</span>', '</div>');
                        }
                    }
                    T.push(this.composeInformationsTAF(lElement, aParam));
                    T.push('<div class="Espace" style="margin-top: 3px; ', GStyle.composeCouleur(GCouleur.blanc, GCouleur.noire, GCouleur.themeNeutre.claire), '">');
                    var lEstQCM = lElement.executionQCM && lElement.executionQCM.existeNumero();
                    T.push('<div class="NoWrap" style="', 'position:relative; overflow:auto', '">', _composeCBTAFFait.call(this, lElement), '<div class="InlineBlock AlignementHaut" style="', (_estAvecCocheTAFFait.call(this, lElement) ? GStyle.composeWidthCalc(14) : ''), '">', (lEstQCM ? this.getTitreExecutionQCM(lElement.GetNumero(), lElement.executionQCM, aParam.nom) : lElement.descriptif), (lElement.ListePieceJointe.GetNbrElements() > 0 ? this.composePiecesJointes(lElement, aParam.nom, true) : ''), '</div>', !aParam || aParam.ignorerTAFFait !== true ? _composeLabelTAFFait.call(this, lElement) : '', '</div>');
                    if (!aParam.listeTAF) {
                        aParam.listeTAF = aListeTAF;
                    }
                    T.push(this.composeTAFARendre(lElement, aParam));
                    T.push('</div>');
                    T.push('</div>');
                    lDonneLe = lNewDonneLe;
                    lPourLe = lNewPourLe;
                }
            }
            return T.join('');
        };

        function _estAvecCocheTAFFait(aElement) {
            var lAvecERendu = !!aElement.genreRendu && MethodesTableau.existe(aElement.genreRendu, [TypeGenreRenduTAF.GRTAF_RenduPronote, TypeGenreRenduTAF.GRTAF_RenduKiosque]);
            var lEstQCM = aElement.executionQCM && aElement.executionQCM.existeNumero();
            if (!this.peuFaireTAF || lEstQCM || lAvecERendu) {
                return false;
            }
            return true;
        }

        function _composeCBTAFFait(aElement) {
            if (!_estAvecCocheTAFFait.call(this, aElement)) {
                return '';
            }
            var H = [];
            H.push('<div class="InlineBlock AlignementHaut"><ie-checkbox ie-hint="getHint" ie-model="cbxTAFFait (\'', aElement.GetNumero(), '\')">');
            H.push('</ie-checkbox></div>');
            return H.join('');
        }

        function _composeLabelTAFFait(lElement) {
            var H = [];
            var lTitle = !this.peuFaireTAF && lElement.TAFFait ? ' title="' + GTraductions.getValeur('accueil.hintParentTravailFait', [GEtatUtilisateur.getMembre().GetLibelle()]) + '"' : '';
            H.push('<div class="InlineBlock AlignementHaut" style="float:right;"', lTitle, '><div ie-html="labelTAFFait (\'', lElement.GetNumero(), '\')"></div></div>');
            return H.join('');
        }

        function getInfoTAFRendu(I, aTaf, aNom) {
            var H = [];
            var lAvecAction = aNom && aTaf && aTaf.avecRendu;
            var lAction = lAvecAction ? ' class="AvecMain LienAccueil" onclick="' + aNom + '.surDetailRendu (event, \'' + I + '\')"' : '';
            H.push('<span class="InlineBlock" style="line-height: 14px;">', '&nbsp;-&nbsp;', GTraductions.getValeur('CahierDeTexte.TAFARendre.RenduPar'), '&nbsp;', '</span>', '<span', lAction, ' class="InlineBlock" style="line-height: 14px;">', aTaf.nbrRendus + '/' + aTaf.nbrEleves, '</span>');
            return H.join('');
        }
        ObjetUtilitaireCahierDeTexte.prototype.composeInformationsTAF = function(aTaf, aParam) {
            if (!(aTaf.duree || aTaf.niveauDifficulte)) {
                return '';
            }
            var T = [];
            var lAvecMargeGauche = false;
            T.push('<div style="margin-top: 3px; line-height: 14px;">');
            if (aParam && aParam.avecDetailTAF) {
                if (aTaf.nomPublic) {
                    T.push('<span class="InlineBlock">', GImage.composeImage('Image_TAF_Public'), '</span>', '<span class="PetitEspaceGauche InlineBlock">', aTaf.pourTousLesEleves ? aTaf.nomPublic : GTraductions.getValeur('CahierDeTexte.TAFARendre.eleves', [aTaf.nbrEleves]), '</span>');
                }
                if (aTaf.avecRendu) {
                    T.push(getInfoTAFRendu(aTaf.GetNumero(), aTaf, aParam.nom));
                }
                lAvecMargeGauche = true;
            }
            if (aTaf.duree) {
                var lFormatMin = aTaf.duree > 60 ? '%mm' : '%xm';
                var lStrDuree = GDate.FormatDureeEnMillisecondes(aTaf.duree * 60 * 1000, aTaf.duree > 60 ? '%xh%sh' + lFormatMin : lFormatMin + 'mn');
                T.push('<div class="InlineBlock SansMain" title="', GTraductions.getValeur('CahierDeTexte.DureeEstimee'), '">', '<span class="', lAvecMargeGauche ? 'GrandEspaceGauche ' : '', 'InlineBlock">', GImage.composeImage('Image_TAF_Duree'), '</span>', '<span class="PetitEspaceGauche InlineBlock">', lStrDuree, '</span>', '</div>');
                lAvecMargeGauche = true;
            }
            if (aTaf.niveauDifficulte) {
                T.push('<div class="InlineBlock SansMain" title="', GTraductions.getValeur('CahierDeTexte.NiveauDifficulte'), '">', '<span class="', lAvecMargeGauche ? 'GrandEspaceGauche ' : '', 'InlineBlock">', GImage.composeImage('Image_TAF_Niveau'), '</span>', '<span class="PetitEspaceGauche InlineBlock">', TypeNiveauDifficulte.typeToStr(aTaf.niveauDifficulte), '</span>', '</div>');
                lAvecMargeGauche = true;
            }
            T.push('</div>');
            return T.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.surSupprimer = function(aNumeroTAF) {
            var lFichier = new ObjetElement(),
                lListeFichiers = new ObjetListeElements();
            lListeFichiers.AddElement(lFichier, 0);
            lFichier.TAF = new ObjetElement('', aNumeroTAF);
            lFichier.SetEtat(EGenreEtat.Suppression);
            new ObjetRequeteSaisieTAFARendreEleve(this, this.actionSurRequeteSaisieTAFARendreEleve).lancerRequete(lListeFichiers);
        };
        ObjetUtilitaireCahierDeTexte.prototype.actionSurRequeteSaisieTAFARendreEleve = function() {
            this.callback.appel();
        };
        ObjetUtilitaireCahierDeTexte.prototype.surSurvol = function(aElement, aSurSurvol, aAvecSouligne) {
            if (aSurSurvol) {
                GHtml.setClass(aElement, 'InlineBlock AlignementMilieuVertical LienAccueil AvecMain Souligne');
            } else {
                GHtml.setClass(aElement, 'InlineBlock AlignementMilieuVertical LienAccueil AvecMain' + (aAvecSouligne ? ' Souligne' : ''));
            }
        };
        ObjetUtilitaireCahierDeTexte.prototype.execFicheSelecFile = function(aTaf) {
            return _executerDepotFichierPourTAF.call(this, aTaf);
        };

        function _executerDepotFichierPourTAF(aTaf) {
            var lLibelle = '';
            if (aTaf && aTaf.matiere) {
                lLibelle = aTaf.matiere.GetLibelle();
            } else if (aTaf && aTaf.Matiere) {
                lLibelle = aTaf.Matiere.GetLibelle();
            }
            if (aTaf && aTaf.pourLe) {
                lLibelle += ' - ' + (GDate.estDateParticulier(aTaf.pourLe) ? GTraductions.getValeur('accueil.pour').ucfirst() : GTraductions.getValeur('accueil.pourle').ucfirst()) + ' ' + GDate.FormatDate(aTaf.pourLe, '[' + '%JJJJ %J %MMM' + ']');
            }
            var lThis = this;
            var lNumeroTAF = aTaf.GetNumero();
            var lObjetFenetreAjoutMultiple = ObjetFenetre.creerInstance(ObjetFenetre_UploadFichiers, {
                pere: this,
                evenement: function(aGenreBouton, aListeFichiers) {
                    if (aGenreBouton === EGenreAction.Valider) {
                        if (!!aListeFichiers && aListeFichiers.GetNbrElements() > 0) {
                            var lSeulFichier = aListeFichiers.GetPremierElement();
                            lSeulFichier.TAF = new ObjetElement('', lNumeroTAF);
                            new ObjetRequeteSaisieTAFARendreEleve(lThis, lThis.actionSurRequeteSaisieTAFARendreEleve).addUpload({
                                listeFichiers: aListeFichiers
                            }).lancerRequete(aListeFichiers);
                        }
                    }
                    lObjetFenetreAjoutMultiple.Fermer();
                }
            });
            lObjetFenetreAjoutMultiple.setOptionsFenetre({
                titre: GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.DeposerCopie')
            });
            lObjetFenetreAjoutMultiple.setDonnees(EGenreRessource.DocumentJoint, {
                tailleMaxUploadFichier: GApplication.droits.get(TypeDroits.tailleMaxRenduTafEleve),
                libelleContexteFenetre: lLibelle,
                functionGetNomPdfGenere: function() {
                    var lLibelleUtilisateur = GEtatUtilisateur.getMembre().GetLibelle();
                    return lLibelleUtilisateur + '_' + GDate.FormatDate(GDate.getDateHeureCourante(), '%JJ%MM%AAAA_%hh%mm%ss') + '.pdf';
                }
            });
            lObjetFenetreAjoutMultiple.afficher();
        }

        function _getFicheSelecFile(aTaf, aParam) {
            var lThis = this;
            if (aTaf && aTaf.avecRendu) {
                if (!aParam.controleur) {
                    return '';
                }
                aParam.controleur.utilFicheFileTAF = function(aNumero) {
                    var lTaf = aTaf;
                    var lListeTaf = aParam.listeTAF;
                    if (!lListeTaf && this.instance && this.instance.donnees) {
                        lListeTaf = this.instance.donnees.listeTAF || (!!this.instance.donnees.travailAFaire ? this.instance.donnees.travailAFaire.listeTAF : undefined);
                    }
                    if (lListeTaf) {
                        lTaf = lListeTaf.GetElementParNumero(aNumero);
                    }
                    $(this.node).eventValidation(function(aTaf, aEvent) {
                        aEvent.stopPropagation();
                        _executerDepotFichierPourTAF.call(lThis, aTaf);
                    }.bind(this.instance, lTaf));
                };
                return GHtml.composeAttr('ie-node', 'utilFicheFileTAF', [aTaf.GetNumero()]);
            }
            return '';
        }

        function _supprimerFichier(aTaf, aParam) {
            var lThis = this;
            if (aTaf && aTaf.avecRendu) {
                if (!aParam.controleur) {
                    return '';
                }
                if (!aParam.controleur.supprimerFichier) {
                    aParam.controleur.supprimerFichier = function(aNumero) {
                        $(this.node).eventValidation(function(aNumero) {
                            this.surSupprimer(aNumero);
                        }.bind(lThis, aNumero));
                    };
                }
                return GHtml.composeAttr('ie-node', 'supprimerFichier', [aTaf.GetNumero()]);
            }
            return '';
        }
        ObjetUtilitaireCahierDeTexte.prototype.composeTAFARendreRaw = function(aTaf, aParam) {
            var H = [];
            var lAvecSouligne = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_Accompagnant]) && !aParam.pourAccueil;
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Parent, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_PrimParent, EGenreEspace.Accompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.PrimAccompagnant, EGenreEspace.Mobile_PrimAccompagnant]) && aTaf.avecRendu) {
                H.push('<div class="taf-btn-conteneur">');
                switch (aTaf.genreRendu) {
                    case TypeGenreRenduTAF.GRTAF_RenduPapier:
                        H.push('<span class="as-info-light', (aTaf.TAFFait ? ' done' : ''), '">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RenduPapier'), '</span>');
                        break;
                    case TypeGenreRenduTAF.GRTAF_RenduPronote:
                        if (aTaf.peuRendre && !aTaf.documentRendu) {
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                H.push('<div role="button" tabIndex="0" id="', getIdTAFARendre.call(this, aTaf), '" ', _getFicheSelecFile.call(this, aTaf, aParam), ' class="as-cta rendu-pn">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RenduPronote'), '</div>');
                            } else {
                                H.push('<span class="as-info-light', (aTaf.TAFFait ? ' done' : ''), '">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RenduNumerique'), '</span>');
                            }
                        }
                        if (aTaf.peuRendre && aTaf.documentRendu) {
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                H.push('<a class="as-cta supp-rendu-pn" title="', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.SupprimerRenduPronote'), '"  role="button" tabIndex="0" ', _supprimerFichier.call(this, aTaf, aParam), '>', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.Supprimer'), '</a>', '<a role="button" tabIndex="0" id="', getIdTAFARendre.call(this, aTaf), '" ', _getFicheSelecFile.call(this, aTaf, aParam), ' class="as-cta edit-rendu-pn" title="', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.NouveauRenduPronote'), '">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.Deposer'), '</a>');
                            }
                        }
                        if (aTaf.documentRendu) {
                            var lLienCopie = GChaine.composerUrlLienExterne({
                                documentJoint: aTaf.documentRendu,
                                genreRessource: TypeFichierExterneHttpSco.TAFRenduEleve,
                                sansImgFormat: true,
                                brut: true
                            });
                            var lLibelleLienDocumentRendu;
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                lLibelleLienDocumentRendu = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirMaCopie');
                            } else {
                                lLibelleLienDocumentRendu = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirLaCopie');
                            }
                            H.push('<a  role="button" tabIndex="0" id="', GUID.getId(), '" target="_blank" href="', lLienCopie, '" class="as-cta voir-rendu-pn" >', lLibelleLienDocumentRendu, '</a>');
                        }
                        if (aTaf.documentCorrige) {
                            var lLienCopieCorrigee = GChaine.composerUrlLienExterne({
                                documentJoint: aTaf.documentCorrige,
                                genreRessource: TypeFichierExterneHttpSco.TAFCorrigeRenduEleve,
                                sansImgFormat: true,
                                brut: true
                            });
                            var lLibelleLienDocumentCorrige;
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                lLibelleLienDocumentCorrige = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirMaCopieCorrigee');
                            } else {
                                lLibelleLienDocumentCorrige = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirLaCopieCorrigee');
                            }
                            H.push('<a  role="button" tabIndex="0" id="', GUID.getId(), '" target="_blank" href="', lLienCopieCorrigee, '" class="as-cta voir-rendu-pn" >', lLibelleLienDocumentCorrige, '</a>');
                        }
                        break;
                    case TypeGenreRenduTAF.GRTAF_RenduKiosque:
                        if (aTaf.peuRendre && !aTaf.documentRendu) {
                            if (aTaf.avecUrlAppliMobile && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_Eleve])) {
                                H.push('<div>', GChaine.composerUrlLienExterne({
                                    documentJoint: aTaf,
                                    iconeOverride: 'icon_th_large',
                                    infoSupp: {
                                        universalLink: true
                                    },
                                    libelleEcran: GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeurAppli'),
                                    title: (aTaf.titreKiosque || '')
                                }), '</div>');
                            }
                            var lTrad = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_Eleve]) ? GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeurSite') : GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeur');
                            H.push('<div>', GChaine.composerUrlLienExterne({
                                documentJoint: aTaf,
                                iconeOverride: 'icon_book',
                                libelleEcran: lTrad,
                                title: (aTaf.titreKiosque || '')
                            }), '</div>');
                        }
                        if (aTaf.documentRendu) {
                            H.push('<div class="InlineBlock AlignementMilieuVertical">', GChaine.composerUrlLienExterne({
                                documentJoint: aTaf,
                                genreRessource: EGenreRessource.RelationTravailAFaireEleve,
                                libelle: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve]) ? GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.ConsulterMesReponses') : GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.ConsulterLesReponses'),
                                class: 'LienAccueil'
                            }), '</div>');
                        }
                        if (aTaf.peuRendre && aTaf.documentRendu) {
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                H.push('<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>', GChaine.composerUrlLienExterne({
                                    documentJoint: aTaf,
                                    libelleEcran: GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RepondreANouveau'),
                                    title: (aTaf.titreKiosque || ''),
                                    class: 'LienAccueil'
                                }), '<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>', '<a class="InlineBlock AlignementMilieuVertical LienAccueil AvecMain' + (lAvecSouligne ? ' Souligne' : '') + '" title="', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.SupprimerMesReponses'), '" tabIndex="0" ', _supprimerFichier.call(this, aTaf, aParam), '>', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.Supprimer'), '</a>');
                            }
                        }
                        break;
                }
                H.push('</div>');
            }
            return H.join('');
        };
        ObjetUtilitaireCahierDeTexte.prototype.composeTAFARendre = function(aTaf, aParam) {
            var H = [];
            var lAvecImage = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Eleve, EGenreEspace.Eleve, EGenreEspace.Mobile_Parent, EGenreEspace.Parent, EGenreEspace.Accompagnant]);
            var lAvecSouligne = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_Accompagnant]) && !aParam.pourAccueil;
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Parent, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_PrimParent, EGenreEspace.Accompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.PrimAccompagnant, EGenreEspace.Mobile_PrimAccompagnant]) && aTaf.avecRendu) {
                H.push('<div style="float: right;">');
                switch (aTaf.genreRendu) {
                    case TypeGenreRenduTAF.GRTAF_RenduPapier:
                        H.push(lAvecImage ? '<i class="icon_punition EspaceDroit"></i>' : '', '<span class="InlineBlock AlignementMilieuVertical">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RenduPapier'), '</span>');
                        break;
                    case TypeGenreRenduTAF.GRTAF_RenduPronote:
                        if (aTaf.peuRendre && !aTaf.documentRendu) {
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                H.push(lAvecImage ? '<i class="icon_punition EspaceDroit"></i>' : '', '<div id="', getIdTAFARendre.call(this, aTaf), '" ', _getFicheSelecFile.call(this, aTaf, aParam), ' tabIndex="0" class="InlineBlock LienAccueil AlignementMilieuVertical AvecMain' + (lAvecSouligne ? ' Souligne' : '') + '" onmouseenter="', this.Nom, '.surSurvol (this, true)" onmouseleave="', this.Nom, '.surSurvol (this, false, ' + lAvecSouligne + ')">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RenduPronote'), '</div>');
                            } else {
                                H.push(lAvecImage ? '<i class="icon_punition EspaceDroit"></i>' : '', '<span class="InlineBlock AlignementMilieuVertical">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RenduNumerique'), '</span>');
                            }
                        }
                        if (aTaf.documentRendu) {
                            var lLibelleLienDocumentRendu;
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                lLibelleLienDocumentRendu = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirMaCopie');
                            } else {
                                lLibelleLienDocumentRendu = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirLaCopie');
                            }
                            H.push(lAvecImage ? '<i class="icon_punition EspaceDroit"></i>' : '', '<div class="InlineBlock AlignementMilieuVertical">', GChaine.composerUrlLienExterne({
                                documentJoint: aTaf.documentRendu,
                                genreRessource: TypeFichierExterneHttpSco.TAFRenduEleve,
                                libelleEcran: lLibelleLienDocumentRendu,
                                class: 'LienAccueil',
                                sansImgFormat: true
                            }), '</div>');
                        }
                        if (aTaf.documentCorrige) {
                            var lLibelleLienDocumentCorrige;
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                lLibelleLienDocumentCorrige = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirMaCopieCorrigee');
                            } else {
                                lLibelleLienDocumentCorrige = GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.VoirLaCopieCorrigee');
                            }
                            H.push('<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>');
                            lAvecImage = false;
                            H.push(lAvecImage ? '<i class="icon_punition EspaceDroit"></i>' : '', '<div class="InlineBlock AlignementMilieuVertical">', GChaine.composerUrlLienExterne({
                                documentJoint: aTaf.documentCorrige,
                                genreRessource: TypeFichierExterneHttpSco.TAFCorrigeRenduEleve,
                                libelleEcran: lLibelleLienDocumentCorrige,
                                class: 'LienAccueil',
                                sansImgFormat: true
                            }), '</div>');
                        }
                        if (aTaf.peuRendre && aTaf.documentRendu) {
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                H.push('<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>', '<a id="', getIdTAFARendre.call(this, aTaf), '" ', _getFicheSelecFile.call(this, aTaf, aParam), ' tabIndex="0" class="InlineBlock AlignementMilieuVertical LienAccueil AvecMain' + (lAvecSouligne ? ' Souligne' : '') + '" title="', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.NouveauRenduPronote'), '" onmouseenter="', this.Nom, '.surSurvol (this, true)" onmouseleave="', this.Nom, '.surSurvol (this, false, ' + lAvecSouligne + ')">', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.Deposer'), '</a>', '<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>', '<a class="InlineBlock AlignementMilieuVertical LienAccueil AvecMain' + (lAvecSouligne ? ' Souligne' : '') + '" tabIndex="0" title="', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.SupprimerRenduPronote'), '" ', _supprimerFichier.call(this, aTaf, aParam), '>', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.Supprimer'), '</a>');
                            }
                        }
                        break;
                    case TypeGenreRenduTAF.GRTAF_RenduKiosque:
                        if (aTaf.peuRendre && !aTaf.documentRendu) {
                            if (aTaf.avecUrlAppliMobile && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_Eleve])) {
                                H.push('<div>', GChaine.composerUrlLienExterne({
                                    documentJoint: aTaf,
                                    iconeOverride: 'icon_th_large',
                                    infoSupp: {
                                        universalLink: true
                                    },
                                    libelleEcran: GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeurAppli'),
                                    title: (aTaf.titreKiosque || '')
                                }), '</div>');
                            }
                            var lTrad = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_PrimEleve, EGenreEspace.Mobile_Eleve]) ? GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeurSite') : GTraductions.getValeur('CahierDeTexte.TAFARendre.ACompleterEditeur');
                            H.push('<div>', GChaine.composerUrlLienExterne({
                                documentJoint: aTaf,
                                iconeOverride: 'icon_book',
                                libelleEcran: lTrad,
                                title: (aTaf.titreKiosque || '')
                            }), '</div>');
                        }
                        if (aTaf.documentRendu) {
                            H.push('<div class="InlineBlock AlignementMilieuVertical">', GChaine.composerUrlLienExterne({
                                documentJoint: aTaf,
                                genreRessource: EGenreRessource.RelationTravailAFaireEleve,
                                libelle: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve]) ? GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.ConsulterMesReponses') : GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.ConsulterLesReponses'),
                                class: 'LienAccueil'
                            }), '</div>');
                        }
                        if (aTaf.peuRendre && aTaf.documentRendu) {
                            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])) {
                                H.push('<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>', GChaine.composerUrlLienExterne({
                                    documentJoint: aTaf,
                                    libelleEcran: GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.RepondreANouveau'),
                                    title: (aTaf.titreKiosque || ''),
                                    class: 'LienAccueil'
                                }), '<span class="InlineBlock AlignementMilieuVertical">', '&nbsp;-&nbsp;', '</span>', '<a class="InlineBlock AlignementMilieuVertical LienAccueil AvecMain' + (lAvecSouligne ? ' Souligne' : '') + '" title="', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.SupprimerMesReponses'), '" tabIndex="0" ', _supprimerFichier.call(this, aTaf, aParam), '>', GTraductions.getValeur('CahierDeTexte.TAFARendre.Eleve.Supprimer'), '</a>');
                            }
                        }
                        break;
                }
                H.push('</div>');
                H.push('<div style="clear: both;"></div>');
            }
            return H.join('');
        };

        function getIdTAFARendre(aTaf) {
            return this.idTAFARendre + '_' + aTaf.GetNumero();
        }
        ObjetUtilitaireCahierDeTexte.prototype.getListeDonneesBrute = function(aParam) {
            if (aParam.modeAffichage === EGenreAffichageCahierDeTextes.TravailAFaire) {
                if (aParam.avecDS && aParam.listeDS) {
                    aParam.listeDS.parcourir(function(D) {
                        D.estUnDS = true;
                        return true;
                    });
                    if (aParam.avecTAF) {
                        return new ObjetListeElements().FusionnerListe(aParam.listeTAF).FusionnerListe(aParam.listeDS);
                    } else {
                        return aParam.listeDS;
                    }
                } else {
                    return aParam.avecTAF ? aParam.listeTAF : new ObjetListeElements();
                }
            } else {
                return aParam.listeCDT;
            }
        };
        ObjetUtilitaireCahierDeTexte.prototype._getListeFusionnee = function(aMatieres, aDonnees, aAvecMatieresVides) {
            var lMatiere;
            var lDateCourante = null;

            function _filtrerParMatiereEtDate(aElt) {
                var lResult = false;
                if ((aElt.GetNumero() === lMatiere) && (GDate.estJourEgal(aElt.Date, lDateCourante))) {
                    aElt.estTraite = true;
                    lResult = true;
                }
                return lResult;
            }

            function _filtrerDonneesParDateNonTraite(aElt) {
                return (!aElt.estTraite) && (GDate.estJourEgal(aElt.Date, lDateCourante));
            }
            var lMatiereCourante;
            var lListeMatieresDuJour = [];
            var lDonneesNonTraitees;
            var lResult = new ObjetListeElements();
            var i, lNbr, lElt;
            for (i = 0, lNbr = aMatieres.GetNbrElements(); i < lNbr; i++) {
                lElt = aMatieres.GetElement(i);
                var lDate = lElt.date;
                lMatiere = lElt.Matiere.GetNumero();
                if (!GDate.estJourEgal(lDate, lDateCourante)) {
                    var n = 0;
                    while (GDate.estDateJourAvant(lDateCourante, lDate) && !!lDateCourante && n < 7) {
                        lDonneesNonTraitees = aDonnees.getListeElements(_filtrerDonneesParDateNonTraite);
                        if (lDonneesNonTraitees.GetNbrElements() > 0) {
                            lResult.FusionnerListe(lDonneesNonTraitees);
                        }
                        lDateCourante = GDate.GetJourSuivant(lDateCourante);
                        n++;
                    }
                    lDateCourante = lDate;
                    lMatiereCourante = null;
                    lListeMatieresDuJour = [];
                }
                if (lMatiere !== lMatiereCourante) {
                    lMatiereCourante = lMatiere;
                    if (!MethodesTableau.existe(lMatiere, lListeMatieresDuJour)) {
                        lListeMatieresDuJour.push(lMatiere);
                        var lDonneeFiltre = aDonnees.getListeElements(_filtrerParMatiereEtDate);
                        if (lDonneeFiltre.GetNbrElements() === 1) {
                            lResult.AddElement(lDonneeFiltre.GetElement(0));
                        } else {
                            if (aAvecMatieresVides) {
                                var lEltMatiere = new ObjetElement(lElt.Matiere.Libelle, lElt.Matiere.Numero, lElt.Matiere.Genre, lElt.Matiere.Position, lElt.Matiere.Actif);
                                lEltMatiere.Date = lDateCourante;
                                lEltMatiere.couleurBordure = GCouleur.liste.bordure;
                                lEltMatiere.estUneSuite = false;
                                lEltMatiere.aUneSuite = false;
                                lEltMatiere.CouleurFond = lElt.CouleurFond;
                                lEltMatiere.ressources = new ObjetListeElements();
                                lResult.AddElement(lEltMatiere);
                            }
                        }
                    }
                }
            }
            if (!!lDateCourante && !!aDonnees) {
                lDonneesNonTraitees = aDonnees.getListeElements(_filtrerDonneesParDateNonTraite);
                if (!!lDonneesNonTraitees && lDonneesNonTraitees.GetNbrElements() > 0) {
                    lResult.FusionnerListe(lDonneesNonTraitees);
                }
            }
            return lResult;
        };
        ObjetUtilitaireCahierDeTexte.prototype.formatDonnees = function(aParam) {
            var I, lElt, elementRessource, newElement;
            var lModeTAF = (aParam.modeAffichage === EGenreAffichageCahierDeTextes.TravailAFaire);
            var lListeDonnees = this.getListeDonneesBrute(aParam);
            var lResult = new ObjetListeElements();
            var lDate = null;
            var lMatiere = null;
            var lElementPrecedent = null;
            lListeDonnees.setTri([
                ObjetTri.init(function(D) {
                    if (lModeTAF) {
                        return D.PourLe;
                    }
                    return D.Date;
                }), ObjetTri.init('Matiere.Libelle'), ObjetTri.init(function(D) {
                    if (lModeTAF && !D.estUnDS) {
                        return GDate.GetJour(D.DonneLe);
                    }
                    return null;
                }), ObjetTri.init(function(D) {
                    if (lModeTAF && !D.estUnDS) {
                        return D.GetGenre();
                    }
                    return null;
                }), ObjetTri.init(function(D) {
                    if (lModeTAF && !D.estUnDS) {
                        return D.GetLibelle();
                    }
                    return null;
                })
            ]);
            lListeDonnees.trier();
            for (I = 0; I < lListeDonnees.GetNbrElements(); I++) {
                lElt = lListeDonnees.GetElement(I);
                if ((lModeTAF) || (lElt.listeContenus && (lElt.listeContenus.GetNbrElements() > 0))) {
                    if (aParam.estChargeTAF && lElementPrecedent && GDate.estJourEgal(lElementPrecedent.Date, lElt.PourLe) && (lElementPrecedent.Libelle === lElt.Matiere.Libelle)) {
                        newElement = lElementPrecedent;
                    } else {
                        newElement = new ObjetElement(lElt.Matiere.Libelle, lElt.Matiere.Numero, lElt.Matiere.Genre, lElt.Matiere.Position, lElt.Matiere.Actif);
                        newElement.genreBloc = lModeTAF ? EGenreBloc.TravailAFaire : EGenreBloc.ContenuDeCours;
                        newElement.Date = lModeTAF ? lElt.PourLe : lElt.Date;
                        newElement.DateDebut = newElement.Date;
                        newElement.couleurBordure = GCouleur.liste.bordure;
                        newElement.estUneSuite = false;
                        newElement.aUneSuite = false;
                        newElement.CouleurFond = lElt.CouleurFond;
                        if (lModeTAF) {
                            newElement.listeGroupes = MethodesObjet.dupliquer(lElt.listeGroupes);
                        }
                    }
                    elementRessource = new ObjetElement(lModeTAF ? (lElt.estUnDS ? lElt.horaires : lElt.Libelle) : lElt.listeContenus.GetLibelle(0), lElt.Numero, lElt.Genre, lElt.Position, lElt.Actif);
                    elementRessource.genreMatiere = lElt.Matiere.Genre;
                    elementRessource.elementOriginal = lElt;
                    if (lModeTAF) {
                        elementRessource.estUnDS = lElt.estUnDS;
                        if (lElt.estUnDS) {
                            elementRessource.estDevoir = lElt.estDevoir;
                            elementRessource.estEval = lElt.estEval;
                        }
                        elementRessource.DonneLe = lElt.DonneLe;
                        elementRessource.nomPublic = lElt.nomPublic;
                    } else {
                        var j, lNbr, lContenu;
                        for (j = 0, lNbr = lElt.listeContenus.GetNbrElements(); j < lNbr; j++) {
                            lContenu = lElt.listeContenus.GetElement(j);
                            if (lContenu.categorie && lContenu.categorie.GetGenre() === TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Devoir) {
                                elementRessource.estUnDS = true;
                            }
                        }
                    }
                    if (lModeTAF && !aParam.sansRegroupementTAF && lDate && GDate.estJourEgal(lDate, newElement.Date) && (lMatiere === newElement.Libelle)) {
                        lElementPrecedent.ressources.AddElement(elementRessource);
                        lElementPrecedent.ressources.setTri([
                            ObjetTri.init(function(D) {
                                return !D.estUnDS;
                            }), ObjetTri.init('DonneLe'), ObjetTri.init('genreMatiere')
                        ]);
                        lElementPrecedent.ressources.trier();
                    } else {
                        newElement.ressources = new ObjetListeElements();
                        newElement.ressources.AddElement(elementRessource);
                        lResult.AddElement(MethodesObjet.dupliquer(newElement));
                        lElementPrecedent = lResult.GetElement(lResult.GetNbrElements() - 1);
                    }
                    if (elementRessource.estUnDS) {
                        lElementPrecedent.estAvecDS = true;
                        lElementPrecedent.estDevoir = lElt.estDevoir;
                        lElementPrecedent.estEval = lElt.estEval;
                    }
                    lDate = newElement.Date;
                    lMatiere = newElement.Libelle;
                }
            }
            lResult.setTri([
                ObjetTri.init('Date'), ObjetTri.init('Libelle')
            ]);
            lResult.trier();
            if (lModeTAF && aParam.listeMatieres) {
                var lTri = [ObjetTri.init('place'), ObjetTri.init(function(D) {
                    return D.Matiere.GetLibelle();
                })];
                aParam.listeMatieres.setTri(lTri);
                aParam.listeMatieres.trier();
                lResult = this._getListeFusionnee(aParam.listeMatieres, lResult, aParam.avecMatieres);
            }
            $.extend(aParam, {
                listeElements: lResult
            });
            _apresFormatterDonneesPourAffichage.call(this, aParam);
            return lResult;
        };

        function _apresFormatterDonneesPourAffichage(aParam) {
            var lElt;
            var T = [];
            var i, j, lNbr;
            for (i = 0, lNbr = aParam.listeElements.GetNbrElements(); i < lNbr; i++) {
                lElt = aParam.listeElements.GetElement(i);
                T = [];
                if (lElt.estAvecDS) {
                    T.push('<div class="NoWrap">');
                    T.push('<div class="InlineBlock AlignementMilieuVertical GrandEspaceDroit">');
                }
                T.push('<div style="float: left; height: 100%; margin-top: 3px; margin-bottom: 3px; margin-left : 3px;" class="NoWrap">', TUtilitaireCDT.strtMatiere(lElt, false, false), '</div>');
                if ((aParam.modeAffichage === EGenreAffichageCahierDeTextes.TravailAFaire) && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Parent, EGenreEspace.Accompagnant])) {
                    var lAvecRendu = [];
                    for (j = 0; lElt.ressources && (j < lElt.ressources.GetNbrElements()); j++) {
                        var lTaf = aParam.listeTAF.GetElementParNumero(lElt.ressources.GetElement(j).GetNumero());
                        if (lTaf && (lTaf.genreRendu !== TypeGenreRenduTAF.GRTAF_AucunRendu)) {
                            lAvecRendu[lTaf.genreRendu] = true;
                        }
                    }
                    T.push('<div style="float: right; margin-top: 3px;">');
                    if (lAvecRendu[TypeGenreRenduTAF.GRTAF_RenduPronote]) {
                        T.push('<div class="InlineBlock" style="margin-right: 3px; ' + GStyle.composeCouleurFond(GCouleur.themeCouleur.foncee) + '">' + GImage.composeImage('Image_TAFARendre_RenduPronote', 13) + '</div>');
                    }
                    if (lAvecRendu[TypeGenreRenduTAF.GRTAF_RenduPapier]) {
                        T.push('<div class="InlineBlock" style="margin-right: 3px;">' + GImage.composeImage('Image_TAFARendre_RenduPapier', 13) + '</div>');
                    }
                    T.push('</div>');
                }
                T.push('<div style="clear: both"></div>');
                if (lElt.estAvecDS) {
                    T.push('</div>');
                    if (lElt.estDevoir) {
                        T.push('<div class="InlineBlock AlignementMilieuVertical" >', _composeSymboleCategorie(TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Devoir), '</div>');
                    }
                    if (lElt.estEval) {
                        T.push('<div class="InlineBlock AlignementMilieuVertical', lElt.estDevoir ? ' PetitEspaceGauche' : '', '" >', _composeSymboleCategorie(TypeOrigineCreationCategorieCahierDeTexte.OCCCDT_Pre_Evaluation), '</div>');
                    }
                    T.push('</div>');
                }
                if (aParam.avecDonneeLe) {
                    var lNbr2, lRessource;
                    var lDonneeLeCourant = null;
                    for (j = 0, lNbr2 = lElt.ressources.GetNbrElements(); j < lNbr2; j++) {
                        lRessource = lElt.ressources.GetElement(j);
                        if (!lRessource.estUnDS && lRessource.DonneLe !== lDonneeLeCourant) {
                            lDonneeLeCourant = lRessource.DonneLe;
                            var lNbJours = GDate.GetDifferenceJours(lElt.Date, lDonneeLeCourant);
                            var lStrJours = (lNbJours > 1 ? GTraductions.getValeur('CahierDeTexte.jours') : GTraductions.getValeur('CahierDeTexte.jour'));
                            T.push('<div class=" GrandEspaceGauche">');
                            T.push('<ul style="padding: 0px; margin: 0px;"><li style="list-style-position: inside; padding: 0px 0px 5px 0px;">');
                            T.push('<span class="EspaceGauche">' + GTraductions.getValeur('CahierDeTexte.donneLe') + GDate.FormatDate(lDonneeLeCourant, ' %JJ/%MM') + '</span>');
                            T.push('<span>' + ' [' + lNbJours + ' ' + lStrJours + ']</span>');
                            T.push('</li></ul>');
                            T.push('</div>');
                        }
                    }
                }
                lElt.html = [];
                lElt.html[0] = T.join('');
                var lAffTAF = (aParam.modeAffichage === EGenreAffichageCahierDeTextes.TravailAFaire);
                T = [];
                T.push('<table ', GObjetWAI.composeRole(EGenreRole.Gridcell), ' class="Texte10" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');
                T.push('<tr><td>', lAffTAF ? this.composeTitreTAF(lElt, aParam.listeTAF, true) : this.composeTitreCDC(lElt, aParam.listeCDT), '</td></tr>');
                T.push('<tr><td height="100%;" class="FondBlanc" valign="top">');
                T.push('<table class="Texte10" style="width:100%;" border="0" cellpadding="0" cellspacing="0">');
                T.push('<tr>');
                T.push('<td class="AlignementHaut">');
                T.push('<div style=width:100%; height:100%;">');
                T.push(lAffTAF ? this.composeTAF(lElt, aParam.listeTAF, {
                    avecDetailTAF: aParam.avecDetailTAF,
                    nom: aParam.nom,
                    listeDS: aParam.listeDS,
                    controleur: aParam.controleur
                }) : this.composeCDC(aParam.listeCDT.GetElementParNumero(lElt.ressources.GetNumero(0)), aParam));
                T.push('</div>');
                T.push('</td>');
                T.push('</tr>');
                T.push('</table>');
                T.push('</td></tr>');
                T.push('</table>');
                lElt.html[1] = T.join('');
            }
        }
        ObjetUtilitaireCahierDeTexte.composeZoneListeRessourcesPedagogiquesEleve = function(aStrChaineDescriptive, aHtmlListeRessources, aOptionsAffichage) {
            var lOptionsAffichage = Object.assign({
                avecMargeHaute: false
            }, aOptionsAffichage);
            var H = [];
            H.push('<div style="background-color: ', GCouleur.themeNeutre.light, ';" class="Espace', (lOptionsAffichage.avecMargeHaute ? ' MargeHaut' : ''), '">', '<div style="color: ', GCouleur.themeNeutre.foncee, ';">', aStrChaineDescriptive, '</div>', '<div class="GrandEspaceGauche EspaceHaut">', aHtmlListeRessources, '</div>', '</div>');
            return H.join('');
        };
        module.exports = ObjetUtilitaireCahierDeTexte;
    },
    fn: "objetutilitairecahierdetexte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var EformatDocJoint = require('Enumere_FormatDocJoint.js');
        var ObjetRequeteFicheCDT = require('ObjetRequeteFicheCDT.js');
        var ObjetRequeteSaisieTAFFaitEleve = require('ObjetRequeteSaisieTAFFaitEleve.js');
        var ObjetUtilitaireCahierDeTexte = require('ObjetUtilitaireCahierDeTexte.js');
        var TypeGenreRenduTAF = require('TypeGenreRenduTAF.js').TypeGenreRenduTAF;
        var UtilitaireQCM = require('UtilitaireQCM.js').UtilitaireQCM;

        function WidgetTAF() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetTAF, Identite);
        WidgetTAF.prototype.creerObjetsTAF = function() {
            this.utilitaireCDT = new ObjetUtilitaireCahierDeTexte(this.Nom + '.utilitaireCDT', this, this.surUtilitaireCDT);
        };
        WidgetTAF.prototype.surUtilitaireCDT = function() {
            this.RecupererDonnees([this.donnees.genre]);
        };
        WidgetTAF.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.peuFaireTAF = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve]);
            var lThis = this;
            $.extend(this.controleur, {
                cbTAFFait: {
                    getValue: function(i) {
                        var lTAF = lThis.donnees.listeTAF.GetElement(i);
                        return lTAF.TAFFait;
                    },
                    getHint: function(i) {
                        var lTAF = lThis.donnees.listeTAF.GetElement(i);
                        return lTAF.TAFFait ? GTraductions.getValeur('accueil.hintTravailFait') : GTraductions.getValeur('accueil.hintTravailAFaire');
                    },
                    setValue: function(i, aValue) {
                        var lTAF = lThis.donnees.listeTAF.GetElement(i);
                        lTAF.TAFFait = aValue;
                        lTAF.SetEtat(EGenreEtat.Modification);
                        new ObjetRequeteSaisieTAFFaitEleve(lThis, lThis.surUtilitaireCDT).lancerRequete({
                            listeTAF: lThis.donnees.listeTAF
                        });
                    },
                    getDisabled: function() {
                        return !lThis.peuFaireTAF;
                    }
                }
            });
            this.creerObjetsTAF();
            if (this.donnees.listeTAF) {
                this.donnees.listeTAF.setTri([ObjetTri.init('ordre'), ObjetTri.init(function(aElement) {
                    return aElement.matiere.GetLibelle();
                })]);
                this.donnees.listeTAF.trier();
            }
            var H = [];
            var lDate, lTaf, i;
            var T = [];
            if (this.donnees.listeTAF && this.donnees.listeTAF.GetNbrElements() > 0) {
                H.push('<ul class="liste-nested" role="list">');
                for (var I = 0; I < this.donnees.listeTAF.GetNbrElements(); I++) {
                    lTaf = this.donnees.listeTAF.GetElement(I);
                    lTaf.indice = I;
                    if (!T[lTaf.pourLe]) {
                        T[lTaf.pourLe] = [];
                    }
                    T[lTaf.pourLe].push(lTaf);
                }
                if (this.donnees.listeTAF.GetNbrElements() > 0) {
                    for (lDate in T) {
                        var lDateConcernee = new Date(lDate);
                        H.push('<li role="listitem" aria-level="4" aria-labelledby="' + this.getIdDate(lDateConcernee) + '" tabIndex="0">');
                        H.push(this.composeDate(lDateConcernee));
                        this.indiceLigne = 0;
                        H.push('<ul class="sub-liste" role="list">');
                        for (i in T[lDate]) {
                            lTaf = T[lDate][i];
                            H.push(this.composeTAF(lTaf.indice, lTaf, lDateConcernee));
                        }
                        H.push('</ul>');
                        H.push('</li>');
                    }
                }
                H.push('</ul>');
            }
            var lWidget = {
                html: H.join(''),
                nbrElements: this.donnees.listeTAF ? this.donnees.listeTAF.GetNbrElements() : 0,
                afficherMessage: !this.donnees.listeTAF || this.donnees.listeTAF.GetNbrElements() === 0
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
        };
        WidgetTAF.prototype.getIdDate = function(aDate) {
            var lIdDate = [this.donnees.id, '_date'];
            if (aDate) {
                lIdDate.push('_', aDate.getFullYear());
                lIdDate.push('_', aDate.getMonth());
                lIdDate.push('_', aDate.getDate());
            }
            return lIdDate.join('');
        };
        WidgetTAF.prototype.composeDate = function(aDate) {
            var H = [];
            H.push('<h4 id="', this.getIdDate(aDate), '">');
            H.push('<span>', (GDate.estDateParticulier(aDate) ? GTraductions.getValeur('accueil.pour').ucfirst() : GTraductions.getValeur('accueil.pourle').ucfirst()), '</span>' + ' ' + GDate.FormatDate(aDate, '[' + '%JJJJ %J %MMM' + ']'));
            H.push('</h4>');
            return H.join('');
        };
        WidgetTAF.prototype.composeMatiere = function(aTaf) {
            var H = [];
            H.push(aTaf.matiere.GetLibelle());
            return H.join('');
        };
        WidgetTAF.prototype.composeTAF = function(i, aTaf, aDateConcernee) {
            var H = [];
            var lAvecERendu = !!aTaf.genreRendu && MethodesTableau.existe(aTaf.genreRendu, [TypeGenreRenduTAF.GRTAF_RenduPronote, TypeGenreRenduTAF.GRTAF_RenduKiosque]);
            var lEstQCM = !!aTaf.executionQCM;
            var lEstFait = (lEstQCM ? aTaf.QCMFait : aTaf.TAFFait);
            var lOnclick = !GEtatUtilisateur.estEspaceMobile() ? 'onclick="' + this.Nom + '._surTAF(' + i + ')" ' : '';
            H.push('<li ', GObjetWAI.composeRole(EGenreRole.Listitem), ' ', GObjetWAI.composeAttribut({
                genre: EGenreAttribut.labelledby,
                valeur: this.getIdDate(aDateConcernee)
            }), '>');
            H.push('<div class="wrap">');
            var lTitleTafFait = '';
            if (!this.peuFaireTAF && aTaf.TAFFait) {
                lTitleTafFait = GTraductions.getValeur('accueil.hintParentTravailFait', [GEtatUtilisateur.getMembre().GetLibelle()]);
            }
            H.push('<div class="as-header"', lTitleTafFait ? 'title="' + lTitleTafFait + '"' : '', '>', '<h5 ', lOnclick, ' tabIndex="0"><span>', this.composeMatiere(aTaf), '</span></h5>', (aTaf.TAFFait && !GEtatUtilisateur.estEspaceEleve() || aTaf.QCMFait) ? ' <span class="as-done">' + GTraductions.getValeur('accueil.hintTravailFait') + '</span>' : '');
            if (this.peuFaireTAF && !lEstQCM && !lAvecERendu) {
                H.push('<ie-switch class="on-widgets" ie-model="cbTAFFait (', i, ')">', '<span>', GTraductions.getValeur('accueil.hintTravailNonFait'), '</span>', '<span>', GTraductions.getValeur('accueil.hintTravailFait'), '</span>', '</ie-switch>');
            }
            H.push('</div>');
            H.push('<div tabIndex="0" class="as-content', (this.peuFaireTAF ? ' avecAction' : ''), (lEstFait ? ' done' : ''), '" aria-labelledby ="' + this.Nom + '_' + i + '">');
            if (aTaf.listeDocumentJoint) {
                aTaf.listeDocumentJoint.trier();
            }
            H.push(lEstQCM && !lEstFait && UtilitaireQCM.estCliquable(aTaf.executionQCM) ? '<div class="descriptif as-qcm" id="' + this.Nom + '_' + i + '"><span class="image-taf Image_Icone_QCM" onclick="' + this.Nom + '._surQCMTAF (' + i + ')">' + aTaf.descriptif + '</span></div>' : '<div class="descriptif' + (lEstFait ? ' done' : '') + '" id="' + this.Nom + '_' + i + '">' + (lEstQCM ? '<span class="image-taf Image_Icone_QCM">' + aTaf.descriptifCourt + '</span>' : aTaf.descriptif) + '</div>');
            if (aTaf.listeDocumentJoint && (aTaf.listeDocumentJoint.GetNbrElements() > 0)) {
                H.push('<div class="liste-docs">');
                for (var j = 0; j < aTaf.listeDocumentJoint.GetNbrElements(); j++) {
                    var lPieceJointe = aTaf.listeDocumentJoint.GetElement(j);
                    var lSuffixe = lPieceJointe.GetLibelle().split('.');
                    var lTypefile = EformatDocJoint.getClassIconDeGenre(EformatDocJoint.getGenreDeFichier(lSuffixe[lSuffixe.length - 1]));
                    if (lPieceJointe.GetGenre() !== 0) {
                        H.push('<a href="', GChaine.composerUrlLienExterne({
                            documentJoint: lPieceJointe,
                            genreRessource: EGenreRessource.DocumentJoint,
                            brut: true
                        }), '" class="icon ' + lTypefile + '" title="', lPieceJointe.GetLibelle(), '">', lSuffixe[0], '</a>');
                    } else {
                        H.push('<a href="', lPieceJointe.GetLibelle(), '" class="icon icon_link">', lPieceJointe.GetLibelle(), '</a>');
                    }
                }
                H.push('</div>');
            }
            H.push('</div>');
            H.push(this.utilitaireCDT.composeTAFARendreRaw(aTaf, {
                nom: this.Nom,
                pourAccueil: true,
                controleur: this.controleur,
                listeTAF: this.donnees.listeTAF
            }));
            H.push('</div>');
            H.push('</li>');
            return H.join('');
        };
        WidgetTAF.prototype._surQCMTAF = function(i) {
            var lTaf = this.donnees.listeTAF.GetElement(i);
            this.afficherExecutionQCM(lTaf.executionQCM);
        };
        WidgetTAF.prototype._surTAF = function(i) {
            var lThis = this;
            this.TAF = this.donnees.listeTAF.GetElement(i);
            new ObjetRequeteFicheCDT(lThis, lThis.Pere._actionSurRequeteFicheCDT.bind(lThis.Pere)).lancerRequete({
                pourTAF: true,
                matiere: lThis.TAF.matiere,
                date: lThis.TAF.pourLe
            });
        };
        WidgetTAF.prototype.evenementSurBlocCDT = function() {};
        module.exports = WidgetTAF;
    },
    fn: "espace/script/widget/widgettaf.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        require('IEHtml.SelecFile.js');
        var Identite = require('ObjetIdentite.js');
        var TUtilitaireUrl = require('UtilitaireUrl.js');
        var ToucheClavier = require('ToucheClavier.js');
        MethodesObjet.heritagePrototype(ObjetModulePJ, Identite);

        function ObjetModulePJ() {
            this.inheritedCreate(arguments);
            this.id_trombone = this.Nom + '_trombone';
            this.idOrigPJ = true;
            this.id_libellesPJ = this.Nom + '_libellesPJ';
            this.genreCommande = {
                menuContext: 0,
                click: 1
            };
            this._options = {
                genrePJ: EGenreDocumentJoint.Fichier,
                forcerEvenementSurClickIcon: false,
                modeleBoutonSupp: false,
                controleur: null,
                title: '',
                maxWidthLibelle: 0,
                addFiles: null,
                getDisabledFiles: null,
                libelleSelecteur: '',
                input: {}
            };
        }
        ObjetModulePJ.prototype.setOptions = function(aOptions) {
            $.extend(this._options, aOptions);
            return this;
        };
        ObjetModulePJ.prototype.getControleur = function(aInstance) {
            return {
                getNodeConteneur: function() {
                    $(this.node).on('contextmenu', function(event) {
                        event.stopImmediatePropagation();
                        event.preventDefault();
                        aInstance.callback.appel({
                            action: aInstance.genreCommande.menuContext
                        });
                        return false;
                    });
                },
                nodeTrombone: function() {
                    $(this.node).on('focus', {
                        couleur: GCouleur.texte
                    }, function(event) {
                        $(this).css('box-shadow', '0 0 5px -1px ' + event.data.couleur);
                    }).on('blur', {
                        couleur: GCouleur.texte
                    }, function() {
                        $(this).css('box-shadow', '');
                    });
                    if ((aInstance._options.genrePJ === EGenreDocumentJoint.Url) || aInstance._options.forcerEvenementSurClickIcon) {
                        $(this.node).addClass('AvecMain').on('click keyup', function(event) {
                            if (event.type === 'keyup' && event.which !== ToucheClavier.RetourChariot && event.which !== ToucheClavier.Espace) {
                                return;
                            }
                            event.stopImmediatePropagation();
                            event.preventDefault();
                            aInstance.callback.appel({
                                action: aInstance.genreCommande.click
                            });
                            return false;
                        });
                    }
                },
                getClassNodeTrombone: function() {
                    return aInstance._options.libelleSelecteur && aInstance.Actif ? ' LienAccueil' : '';
                },
                trombone: {
                    getOptionsSelecFile: function() {
                        return aInstance._options.getOptionsSelecFile();
                    },
                    addFiles: function(aParams) {
                        if (aInstance._options.addFiles) {
                            aInstance._options.addFiles(aParams);
                            this.controleur.$refreshSelf();
                        }
                    },
                    getDisabled: function() {
                        return aInstance._options.genrePJ === EGenreDocumentJoint.Url ||
                            !aInstance.Actif ||
                            !!(aInstance._options.getDisabledFiles && aInstance._options.getDisabledFiles());
                    }
                }
            };
        };
        ObjetModulePJ.prototype.setGenrePJ = function(aGenrePJ) {
            this._options.genrePJ = aGenrePJ;
        };
        ObjetModulePJ.prototype.ConstruireAffichage = function() {
            if (!this._avecDonnees) {
                return '';
            }
            var H = [];
            var lImage = this._options.genrePJ === EGenreDocumentJoint.Url ? 'Image_Blog' : 'Image_Trombone';
            H.push('<div class="NoWrap" ie-node="getNodeConteneur">');
            H.push('<div ie-node="nodeTrombone" ie-class="getClassNodeTrombone" class="InlineBlock AlignementHaut"', ' style="width:auto; height: 16px;" tabIndex="0" title="', this._options.title, '"', (this._options.genrePJ !== EGenreDocumentJoint.Url && !this._options.forcerEvenementSurClickIcon ? ' ie-model="trombone" ie-selecfile ' : ''), '>', (this._options.libelleSelecteur ? '<div style="display:flex; align-items: center; height: 16px;">' : ''), '<div id="', this.id_trombone, '" class="', lImage, '" style="width: 12px;"></div>', (this._options.libelleSelecteur ? '<div>' + this._options.libelleSelecteur + '</div></div>' : ''), '</div>');
            if (this.idOrigPJ) {
                H.push('<div id="', this.id_libellesPJ, '" class="InlineBlock AlignementHaut EspaceGauche EspaceDroit"></div>');
            }
            H.push('</div>');
            return H.join('');
        };
        ObjetModulePJ.prototype.setDonnees = function(aParam) {
            this._avecDonnees = true;
            this.genreRessourcePJ = aParam.genreRessourcePJ;
            this.Afficher();
            if (aParam.idListePJ) {
                this.setIdPourLibellesPJ(aParam.idListePJ);
            }
            if (aParam.listePJ) {
                this.setLibellesPJ(aParam.listePJ);
            }
        };
        ObjetModulePJ.prototype.getNomTrombone = function() {
            return this.id_trombone;
        };
        ObjetModulePJ.prototype.setLibellesPJ = function(aListePJ) {
            if (aListePJ) {
                $('#' + this.id_libellesPJ.escapeJQ()).IEHtml(TUtilitaireUrl.construireListeUrls({
                    liste: aListePJ,
                    genreFiltre: this._options.genrePJ,
                    genreRessource: this.genreRessourcePJ,
                    IEModelBtnSupp: this.Actif ? this._options.modeleBoutonSupp : '',
                    maxWidth: this._options.maxWidthLibelle
                }), {
                    controleur: this._options.controleur
                });
            }
        };
        ObjetModulePJ.prototype.setIdPourLibellesPJ = function(aIdListePJ) {
            this.idOrigPJ = false;
            this.id_libellesPJ = aIdListePJ;
        };
        ObjetModulePJ.prototype.SetActif = function(AActif) {
            this.Actif = AActif;
            this.$refreshSelf();
        };
        module.exports = ObjetModulePJ;
    },
    fn: "objetmodulepj.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var EGenreAction = require('Enumere_Action.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetMenuContextuel = require('ObjetMenuContextuel.js');
        var GTraductions = require('ObjetTraduction.js');

        function ObjetSelecteurPJCP() {
            this.inheritedCreate(arguments);
            this.AvecCadre = false;
            this.genreMenuContextuel = {
                ajouterPJNouvelle: 0,
                ajouterPJExistante: 1,
                supprimerPJ: 2
            };
            this._initialiserOptions();
        }
        MethodesObjet.heritagePrototype(ObjetSelecteurPJCP, ObjetAbstraitInterface);
        ObjetSelecteurPJCP.genreEvnt = {
            selectionPJ: 1,
            suppressionPJ: 2,
            editionPJ: 3,
            ajouterPJs: 4
        };
        ObjetSelecteurPJCP.prototype._initialiserOptions = function() {
            this._options = {
                genrePJ: EGenreDocumentJoint.Fichier,
                genreRessourcePJ: -1,
                title: '',
                styleSite: false,
                maxFiles: 0,
                maxSize: 1048576,
                avecAjoutExistante: false,
                interdireDoublonsLibelle: true,
                avecCmdAjoutNouvelle: true,
                idLibellePJ: '',
                avecEtatSaisie: true,
                avecBoutonSupp: false,
                maxWidthLibelle: 0,
                libelleSelecteur: '',
                avecInActifVisible: false,
                ouvrirFenetreGestionnaireSurClick: false,
                fenetrePieceJointe: {
                    avecBoutonActualiser: true
                },
                avecCallbackAjouterPJs: false,
                multiple: false,
                acceptDragDrop: true
            };
        };
        ObjetSelecteurPJCP.prototype.setOptions = function(aOptions) {
            $.extend(this._options, aOptions);
            if (this._options.maxFiles === 1) {
                this._options.avecCmdAjoutNouvelle = false;
            }
        };
        ObjetSelecteurPJCP.prototype.ConstruireInstances = function() {
            this.identPJ = this.Add(require('ObjetModulePJ.js'), this.evntModulePJ, this.initModulePJ);
        };
        ObjetSelecteurPJCP.prototype.getControleur = function(aInstance) {
            return {
                btnSuppPJ: {
                    event: function(aIndice) {
                        var lElement = aInstance.listePJ ? aInstance.listePJ.GetElement(aIndice) : null;
                        if (lElement) {
                            _supprimerPJ.call(aInstance, lElement);
                        }
                    },
                    getDisabled: function(aIndice) {
                        var lElement = aInstance.listePJ ? aInstance.listePJ.GetElement(aIndice) : null;
                        return !aInstance.Actif || !lElement;
                    }
                }
            };
        };
        ObjetSelecteurPJCP.prototype.ComposeContenu = function() {
            var H = [];
            H.push('<div class="EspaceHaut" id="', this.GetNomInstance(this.identPJ), '"></div>');
            return H.join('');
        };
        ObjetSelecteurPJCP.prototype.SetActif = function(AActif) {
            this.Actif = AActif;
            if (this.GetInstance(this.identPJ)) {
                this.GetInstance(this.identPJ).SetActif(AActif);
            }
        };

        function _getOptionsSelecFile() {
            return {
                title: this._options.title,
                maxFiles: this._options.maxFiles,
                maxSize: this._options.maxSize,
                genrePJ: this._options.genrePJ,
                multiple: this._options.multiple,
                acceptDragDrop: this._options.acceptDragDrop
            };
        }

        function _getDisabledFiles() {
            return !this.Actif || (this._options.maxFiles !== 0 && this.listePJ.GetNbrElementsExistes() >= this._options.maxFiles);
        }
        ObjetSelecteurPJCP.prototype.SetDonnees = function(aParam) {
            this.avecInputFile = this._options.genrePJ !== EGenreDocumentJoint.Url;
            this.listePJTotale = aParam.listeTotale;
            this.listePJ = aParam.listePJ;
            this.idContextFocus = aParam.idContextFocus;
            var lParam = {
                listePJ: this.listePJ,
                genreRessourcePJ: this._options.genreRessourcePJ,
                styleSite: this._options.styleSite
            };
            if (aParam.idListePJ) {
                lParam.idListePJ = aParam.idListePJ;
            }
            this.GetInstance(this.identPJ).setOptions({
                genrePJ: this._options.genrePJ,
                addFiles: _addFiles.bind(this),
                getDisabledFiles: _getDisabledFiles.bind(this),
                getOptionsSelecFile: _getOptionsSelecFile.bind(this)
            }).setDonnees(lParam);
        };
        ObjetSelecteurPJCP.prototype.setTailleMaxPJ = function(aTailleMax) {
            this._options.maxSize = aTailleMax;
        };
        ObjetSelecteurPJCP.prototype.controlerFichierSelectionne = function(aParam) {
            if (this._isLibelleFichierExiste(aParam.GetLibelle())) {
                return {
                    succes: false,
                    msg: GTraductions.getValeur('inputFile.msgEchecLibelleFichierAvecInfo')
                };
            }
            return {
                succes: true,
                msg: ''
            };
        };
        ObjetSelecteurPJCP.prototype._isLibelleFichierExiste = function(aNomFichier) {
            if (!this._options.interdireDoublonsLibelle) {
                return false;
            }
            var lNbrElts = this.listePJTotale.GetNbrElements();
            var lElt;
            for (var I = 0; I < lNbrElts; I++) {
                lElt = this.listePJTotale.GetElement(I);
                var lLibelle = lElt.GetLibelle();
                if (lElt.Existe() && lLibelle && aNomFichier && lLibelle.toLowerCase && aNomFichier.toLowerCase && lLibelle.trim().toLowerCase() === aNomFichier.trim().toLowerCase()) {
                    return true;
                }
            }
            return false;
        };
        ObjetSelecteurPJCP.prototype.initModulePJ = function(aInstance) {
            if (this._options.idLibellePJ) {
                aInstance.setIdPourLibellesPJ(this._options.idLibellePJ);
            }
            aInstance.setOptions({
                genrePJ: this._options.genrePJ,
                forcerEvenementSurClickIcon: this._options.ouvrirFenetreGestionnaireSurClick,
                modeleBoutonSupp: this._options.avecBoutonSupp ? 'btnSuppPJ' : '',
                controleur: this._options.avecBoutonSupp ? this.controleur : null,
                title: this._options.title,
                maxWidthLibelle: this._options.maxWidthLibelle,
                libelleSelecteur: this._options.libelleSelecteur
            });
        };
        ObjetSelecteurPJCP.prototype.initEditionPJ = function(aInstance) {
            if (aInstance.setOptions) {
                aInstance.setOptions(this._options.fenetrePieceJointe);
            }
        };
        ObjetSelecteurPJCP.prototype.addFilesDeSelecFile = function(aParams) {
            return _addFiles.call(this, aParams);
        };

        function _addFiles(aParams) {
            var lParam;
            var lFiles = [];
            aParams.listeFichiers.parcourir(function(aFichier) {
                var lControle = this.controlerFichierSelectionne(aFichier);
                lParam = null;
                if (lControle.succes) {
                    this.listePJTotale.AddElement(aFichier);
                    this.listePJ.AddElement(aFichier);
                    lParam = {
                        evnt: ObjetSelecteurPJCP.genreEvnt.selectionPJ,
                        fichier: aFichier
                    };
                    lFiles.push(aFichier);
                    if (this._options.avecEtatSaisie) {
                        this.SetEtatSaisie(true);
                    }
                } else {
                    GApplication.getMessage().Afficher(EGenreBoiteMessage.Information, null, lControle.msg);
                }
                this.GetInstance(this.identPJ).setLibellesPJ(this.listePJ);
                if (lParam) {
                    this.callback.appel(lParam);
                }
            }.bind(this));
            if (lFiles.length > 0 && this._options.avecCallbackAjouterPJs) {
                this.callback.appel({
                    evnt: ObjetSelecteurPJCP.genreEvnt.ajouterPJs,
                    tabFichiers: lFiles
                });
            }
        }

        function _ouvrirFenetrePJ() {
            this.GetInstance(this.identEditionPJ).afficherFenetrePJ({
                listePJTot: this.listePJTotale,
                listePJContexte: this.listePJ,
                genreFenetrePJ: this._options.genrePJ,
                genrePJ: this._options.genrePJ,
                genreRessourcePJ: this._options.genreRessourcePJ,
                avecFiltre: {
                    date: true
                },
                avecEtatSaisie: this._options.avecEtatSaisie,
                avecInActifVisible: this._options.avecInActifVisible,
                optionsSelecFile: _getOptionsSelecFile.call(this)
            });
        }

        function _afficherMenuContextuel() {
            ObjetMenuContextuel.afficher({
                pere: this,
                evenement: function() {},
                initCommandes: function(aInstance) {
                    if (this._options.avecCmdAjoutNouvelle && this.avecInputFile) {
                        aInstance.addSelecFile(this._options.genrePJ === EGenreDocumentJoint.Url ? GTraductions.getValeur('selecteurPJ.ajoutNouveauLien') : GTraductions.getValeur('selecteurPJ.ajoutNouvellePJ'), {
                            getOptionsSelecFile: _getOptionsSelecFile.bind(this),
                            addFiles: _addFiles.bind(this)
                        }, !_getDisabledFiles.call(this));
                        aInstance.avecSeparateurSurSuivant();
                    }
                    if (this._options.avecAjoutExistante) {
                        aInstance.add(this._options.genrePJ === EGenreDocumentJoint.Url ? GTraductions.getValeur('selecteurPJ.ajoutLienExistant') : GTraductions.getValeur('selecteurPJ.ajoutPJExistante'), true, function() {
                            _ouvrirFenetrePJ.call(this);
                        }.bind(this));
                    }
                    if (this._options.avecCmdAjoutNouvelle || this._options.avecAjoutExistante) {
                        aInstance.avecSeparateurSurSuivant();
                    }
                    var lListePJ = new ObjetListeElements();
                    if (this.listePJ && this.listePJ.GetNbrElementsExistes() > 0) {
                        this.listePJ.parcourir(function(aElement) {
                            if (aElement.Existe() && (aElement.GetGenre() === undefined || aElement.GetGenre() === null || aElement.GetGenre() === this._options.genrePJ)) {
                                lListePJ.AddElement(aElement);
                            }
                        }.bind(this));
                    }
                    if (lListePJ.GetNbrElements() > 0) {
                        aInstance.addSousMenu(GTraductions.getValeur('selecteurPJ.supprimerPJ'), function(aInstanceSousMenu) {
                            lListePJ.parcourir(function(aElement) {
                                aInstanceSousMenu.add(aElement.GetLibelle(), aElement.actif, function() {
                                    _supprimerPJ.call(this, aElement);
                                }.bind(this), {
                                    image: aElement.image,
                                    largeurImage: aElement.largeurImage
                                });
                            }.bind(this));
                        }.bind(this));
                    }
                }
            });
        }
        ObjetSelecteurPJCP.prototype.evntModulePJ = function(aParam) {
            if (!this.Actif) {
                return;
            }
            switch (aParam.action) {
                case this.GetInstance(this.identPJ).genreCommande.menuContext:
                    _afficherMenuContextuel.call(this);
                    break;
                case this.GetInstance(this.identPJ).genreCommande.click:
                    if (this._options.avecAjoutExistante && ((this._options.genrePJ === EGenreDocumentJoint.Url) || this._options.ouvrirFenetreGestionnaireSurClick)) {
                        _ouvrirFenetrePJ.call(this);
                    }
                    break;
                default:
                    ;
                    break;
            }
        };

        function _supprimerPJ(aElementASupprimer) {
            this.eltASupprimer = aElementASupprimer;
            var message = '<div ie-ellipsis-fixe>' + (this._options.genrePJ === EGenreDocumentJoint.Url ? GTraductions.getValeur('selecteurPJ.msgConfirmLien', [aElementASupprimer.GetLibelle()]) : GTraductions.getValeur('selecteurPJ.msgConfirmPJ', [aElementASupprimer.GetLibelle()])) + '</div>';
            GApplication.getMessage().afficher({
                type: EGenreBoiteMessage.Confirmation,
                message: message,
                callback: _evntSupprimerPJ.bind(this)
            });
        }

        function _evntSupprimerPJ(aAccepte) {
            if (!this.Actif) {
                return;
            }
            if (this.existeInstance(this.identEditionPJ)) {
                this.GetInstance(this.identEditionPJ).Fermer();
            }
            if (aAccepte !== EGenreAction.Valider) {
                return;
            }
            this.eltASupprimer.SetEtat(EGenreEtat.Suppression);
            if (this._options.avecEtatSaisie) {
                this.SetEtatSaisie(true);
            }
            this.GetInstance(this.identPJ).setLibellesPJ(this.listePJ);
            this.callback.appel({
                evnt: ObjetSelecteurPJCP.genreEvnt.suppressionPJ
            });
            this.$refresh();
        }
        ObjetSelecteurPJCP.prototype.evntEditionPJ = function() {
            if (!this.Actif) {
                return;
            }
            var alisteDocumentsJoints = this.listePJTotale;
            if (!alisteDocumentsJoints) {
                return;
            }
            var lDoc;
            for (var I = 0; I < alisteDocumentsJoints.GetNbrElements(); I++) {
                var lDocumentJoint = this.listePJ.GetElementParNumero(alisteDocumentsJoints.GetNumero(I));
                var lActif = alisteDocumentsJoints.GetElement(I).Actif && alisteDocumentsJoints.Existe(I);
                if (lDocumentJoint) {
                    if (!lActif) {
                        lDocumentJoint.SetEtat(EGenreEtat.Suppression);
                    } else {
                        lDoc = alisteDocumentsJoints.GetElement(I);
                        if (lDoc.Etat === EGenreEtat.Modification) {
                            lDocumentJoint.Libelle = lDoc.Libelle;
                        }
                    }
                } else {
                    if (lActif) {
                        var lEltFichier;
                        lDoc = alisteDocumentsJoints.GetElement(I);
                        if (lDoc.Fichier) {
                            lDoc.idFichier = lDoc.Fichier.idFichier;
                            lDoc.Libelle = lDoc.Fichier.Libelle;
                            lDoc.nomOriginal = lDoc.Fichier.nomOriginal;
                            lDoc.file = lDoc.Fichier.file;
                        }
                        lEltFichier = MethodesObjet.dupliquer(lDoc);
                        lEltFichier.file = lDoc.file;
                        lEltFichier.SetEtat(EGenreEtat.Creation);
                        this.listePJ.AddElement(lEltFichier);
                    }
                }
            }
            this.GetInstance(this.identPJ).setLibellesPJ(this.listePJ);
            this.callback.appel({
                evnt: ObjetSelecteurPJCP.genreEvnt.editionPJ
            });
        };
        ObjetSelecteurPJCP.prototype.setIdPourLibellesPJ = function(aIdListePJ) {
            this.GetInstance(this.identPJ).setIdPourLibellesPJ(aIdListePJ);
        };
        module.exports = ObjetSelecteurPJCP;
    },
    fn: "objetselecteurpjcp.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetSelecteurPJCP = require('ObjetSelecteurPJCP.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetFenetre_PieceJointe = require('ObjetFenetre_PieceJointe.js');

        function ObjetSelecteurPJ() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(ObjetSelecteurPJ, ObjetSelecteurPJCP);
        ObjetSelecteurPJ.prototype._initialiserOptions = function() {
            this.inherited('_initialiserOptions');
            Object.assign(this._options, {
                genreRessourcePJ: EGenreRessource.DocJointEtablissement
            });
        };
        ObjetSelecteurPJ.prototype.ConstruireInstances = function() {
            this.inherited('ConstruireInstances');
            if (ObjetFenetre_PieceJointe) {
                this.identEditionPJ = this.addFenetre(ObjetFenetre_PieceJointe, this.evntEditionPJ, this.initEditionPJ);
            }
        };
        module.exports = ObjetSelecteurPJ;
    },
    fn: "objetselecteurpj.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        require('espace/css/ObjetFichePresenceStyle.css');
        var GUID = require('GUID.js');
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreEvenementObjetSaisie = require('Enumere_EvenementObjetSaisie.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSaisie = require('ObjetSaisie.js');
        var ObjetSelecteurPJCP = require('ObjetSelecteurPJCP.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRepas = require('Enumere_Repas.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetSelecteurPJ = require('ObjetSelecteurPJ.js');
        var ObjetUtilitaireAbsence = require('ObjetUtilitaireAbsence.js');
        var TypeGenreObservationVS = require('TypeGenreObservationVS.js').TypeGenreObservationVS;
        var TypeGenrePunition = require('TypeGenrePunition.js').TypeGenrePunition;
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        var TypeThemeBouton = require('Type_ThemeBouton.js');
        MethodesObjet.heritagePrototype(ObjetDetailVS, ObjetAbstraitInterface);

        function ObjetDetailVS() {
            this.inheritedCreate(arguments);
            this.tailleImages = 17;
            this.utilitaireAbsence = new ObjetUtilitaireAbsence();
            this.idBouton = GUID.getId();
            this.options = {
                avecCallBackSurBouton: false
            };
            Invocateur.abonner(ObjetInvocateur.events.modeExclusif, this._setModeExclusif, this);
        }
        ObjetDetailVS.prototype.getControleur = function() {
            return {};
        };
        ObjetDetailVS.prototype.setParametres = function(aDonnees, aOptions) {
            this.donneesRecues = true;
            $.extend(this.options, aOptions);
            this.donnees = aDonnees;
            this.autorisations = this.options.autorisations;
            this.avecSaisie = this.options.avecSaisie;
            this.sansSetEtatSaisie = this.options.sansSetEtatSaisie;
            this.afficherPourBlocs = ((this.options.afficherPourBlocs !== null) && this.options.afficherPourBlocs !== undefined) ? this.options.afficherPourBlocs : false;
        };
        ObjetDetailVS.prototype.ConstruireStructureAffichage = function() {
            var H = [];
            if (this.donneesRecues) {
                this._creationCombos();
                this._creationPJ();
                H.push('<div><table class="Table Texte10 Espace ContenuTableauPresence" border="0" cellspacing="0" cellpadding="0">');
                for (var i = 0; i < this.donnees.GetNbrElements(); i++) {
                    if (this.afficherPourBlocs === true) {
                        H.push(this.composeAbsencePourBloc(this.donnees.GetElement(i), i));
                    } else {
                        H.push(this.composeAbsence(this.donnees.GetElement(i), i));
                    }
                }
                H.push('<tr>');
                H.push('<td style="' + GStyle.composeHeight(100, '%') + '"></td>');
                H.push('</tr>');
                H.push('</table></div>');
                if (this.avecSaisie) {
                    H.push('<div class="Texte10 Espace AlignementDroit"><ie-bouton class="' + TypeThemeBouton.primaire + '" id="', this.idBouton, '" onclick="', this.Nom, '.surBouton ()" disabled>', GTraductions.getValeur('Valider'), '</ie-bouton></div>');
                }
            }
            return H.join('');
        };
        ObjetDetailVS.prototype._creationCombos = function() {
            var I, lNbr, lId, lAbsence;
            this.combos = {};
            for (I = 0, lNbr = this.donnees.GetNbrElements(); I < lNbr; I++) {
                lAbsence = this.donnees.GetElement(I);
                var lListe = lAbsence.GetGenre() === EGenreRessource.Absence ? GEtatUtilisateur.listeMotifsAbsences : GEtatUtilisateur.listeMotifsRetards;
                var lSaisieMotif = false;
                switch (lAbsence.GetGenre()) {
                    case EGenreRessource.Absence:
                        lSaisieMotif = this.autorisations ? this.autorisations.saisieMotifAbsence : false;
                        break;
                    case EGenreRessource.Retard:
                        lSaisieMotif = this.autorisations ? this.autorisations.saisieMotifRetard : false;
                        break;
                    default:
                        break;
                }
                if (lSaisieMotif && MethodesTableau.existe(lAbsence.GetGenre(), [EGenreRessource.Absence, EGenreRessource.Retard]) && lListe.GetNbrElements() > 0) {
                    lId = this._getIdCombo(I);
                    this.combos[lId] = new ObjetSaisie(this.Nom + '.saisies' + lId, null, this, this._surEvenementSaisie.bind(this, I));
                    var lWidth = 220;
                    this.combos[lId].setOptions_ObjetSaisie({
                        longueur: lWidth
                    });
                }
            }
        };
        ObjetDetailVS.prototype._surEvenementSaisie = function(aIndice, aGenreSelection, aElement) {
            var lAbsence = this.donnees.GetElement(aIndice);
            if ((aGenreSelection === EGenreEvenementObjetSaisie.selection && aElement) && (!lAbsence.motifParent || (lAbsence.motifParent.GetNumero() !== aElement.GetNumero()))) {
                lAbsence.motifParent = aElement;
                lAbsence.SetEtat(EGenreEtat.Modification);
                GHtml.setDisabled(this.idBouton, false);
                if (!GEtatUtilisateur.estEspaceMobile()) {
                    this.SetEtatSaisie(true);
                }
            }
        };
        ObjetDetailVS.prototype._creationPJ = function() {
            var I, lAbsence;
            this._detruireInputFiles();
            for (I = 0; I < this.donnees.GetNbrElements(); I++) {
                lAbsence = this.donnees.GetElement(I);
                if ((lAbsence.GetGenre() === EGenreRessource.Absence) && this.options.avecJustificatifAbsence) {
                    this.pjs[I] = new ObjetSelecteurPJ(this.Nom + '.pjs.' + I, null, this, this._surDocument.bind(this, I));
                    this.pjs[I].setOptions({
                        genrePJ: EGenreDocumentJoint.Fichier,
                        genreRessourcePJ: EGenreRessource.DocJointEleve,
                        title: GTraductions.getValeur('AbsenceVS.TelechargerUnJustifcatif'),
                        avecBoutonSupp: this.options.avecJustificatifAbsence,
                        maxFiles: 1,
                        maxWidthLibelle: 210,
                        maxSize: GApplication.droits.get(TypeDroits.tailleMaxDocJointEtablissement)
                    });
                    this.pjs[I].SetActif(this.autorisations ? this.autorisations.saisieMotifAbsence : false);
                    this.listePJs[I] = lAbsence.documents ? MethodesObjet.dupliquer(lAbsence.documents) : new ObjetListeElements();
                }
            }
        };
        ObjetDetailVS.prototype._surDocument = function(aIndice, aParam) {
            var lAbsence = this.donnees.GetElement(aIndice);
            switch (aParam.evnt) {
                case ObjetSelecteurPJCP.genreEvnt.selectionPJ:
                    if (lAbsence) {
                        lAbsence.SetEtat(EGenreEtat.Modification);
                        GHtml.setDisabled(this.idBouton, false);
                        if (!GEtatUtilisateur.estEspaceMobile()) {
                            this.SetEtatSaisie(true);
                        } else {
                            this.SetEtatSaisie(false);
                        }
                    }
                    break;
                case ObjetSelecteurPJCP.genreEvnt.suppressionPJ:
                    if (lAbsence) {
                        lAbsence.SetEtat(EGenreEtat.Modification);
                        GHtml.setDisabled(this.idBouton, false);
                        if (!GEtatUtilisateur.estEspaceMobile()) {
                            this.SetEtatSaisie(true);
                        } else {
                            this.SetEtatSaisie(false);
                        }
                    }
                    break;
                default:
                    break;
            }
        };
        ObjetDetailVS.prototype._detruireInputFiles = function() {
            this.pjs = {};
            this.listePJs = {};
        };
        ObjetDetailVS.prototype.composeAbsence = function(aAbsence, aIndice) {
            var H = [];
            H.push('<!-- composeAbsence -->');
            H.push('<tr>');
            var lEstLue = (GEtatUtilisateur.GenreEspace === EGenreEspace.Eleve) && (aAbsence.genreObservation === TypeGenreObservationVS.OVS_Encouragement) ? true : aAbsence.estLue;
            var lClassIcon = EGenreRessource.getNomImageAbsence({
                genre: aAbsence.GetGenre(),
                genreObservation: aAbsence.genreObservation,
                genreNature: aAbsence.nature ? aAbsence.nature.GetGenre() : null,
                justifie: aAbsence.justifie,
                estProgrammation: aAbsence.estProgrammation,
                estLue: lEstLue,
                avecSursis: aAbsence.avecSursis
            });
            H.push('<td class="Texte10 AlignementHaut PetitEspaceBas"><div style="' + GStyle.composeWidth(25) + '"><div ', this.getInfoAbsence(aAbsence), 'class="AlignementMilieu" style="' + GStyle.composeWidth(this.tailleImages) + '"><i class="Texte10 ' + lClassIcon + '"></i></div></div></td>');
            H.push('<td class="Texte10 AlignementHaut PetitEspaceBas" style="line-height: 1;1rem;">');
            if ((aAbsence.GetGenre() === EGenreRessource.Punition) && aAbsence.estProgrammation) {
                H.push('<div class="Gras">');
                H.push(this.getLibelleModalitePunitionSanction(aAbsence, true));
                H.push('</div>');
            } else {
                H.push('<div class="Gras">');
                H.push(this.getLibelleTitre(aAbsence));
                H.push('</div>');
            }
            H.push('<div class="EspaceTitreInfoVS">');
            H.push(this.getLibelleObservation(aAbsence));
            if (aAbsence.GetGenre() !== EGenreRessource.Incident) {
                H.push(this.getLibelleDemandeurDecideur(aAbsence, (aAbsence.GetGenre() === EGenreRessource.Punition) && aAbsence.estProgrammation));
            }
            H.push(this.getLibellePunitionSanctionDIncident(aAbsence));
            H.push(this.getLibelleMotifs(aAbsence, aIndice, {
                applatCouleurPJ: false
            }));
            H.push(this.getCirconstances(aAbsence));
            H.push(this.getLibelleTAF(aAbsence));
            if (aAbsence.GetGenre() === EGenreRessource.MesureConservatoire) {
                H.push(this.getLibellesInterdit(aAbsence));
            }
            if (aAbsence.GetGenre() === EGenreRessource.Incident) {
                H.push(this.getGravite(aAbsence));
                H.push(this.getMesureDisciplinaire(aAbsence));
            }
            H.push('</div>');
            H.push('<div class="EspaceTitreInfoVS">');
            H.push(this.utilitaireAbsence.getHeuresCoursManquees(aAbsence));
            H.push('</div>');
            if (this.options.avecSaisieObservation && aAbsence.avecARObservation) {
                H.push('<div class="EspaceTitreInfoVS">');
                H.push(this.utilitaireAbsence.getSaisieObservation(aAbsence, this.Nom + '.surSelection (' + aIndice + ')', this.getIDCheckBox(aIndice)));
                H.push('</div>');
            }
            if (aAbsence.GetGenre() === EGenreRessource.Punition && aAbsence.nature && aAbsence.nature.estAvecARParent && this.options.avecARPunition && !aAbsence.estProgrammation) {
                H.push('<div class="EspaceTitreInfoVS">');
                H.push(this.utilitaireAbsence.getARdePunition(aAbsence, this.Nom + '.surAR (' + aIndice + ')', this.getIDCheckBox(aIndice)));
                H.push('</div>');
            }
            H.push('&nbsp;</td>');
            H.push('</tr>');
            return H.join('');
        };
        ObjetDetailVS.prototype.composeAbsencePourBloc = function(aAbsence, aIndice) {
            var H = [];
            H.push('<!-- composeAbsencePourBloc -->');
            var lAvecContenu;
            H.push('<tr>');
            H.push('<td class="Texte10 AlignementHaut PetitEspaceHaut" style="line-height: 1.1rem;">');
            var lHeuresCoursManquees = this.utilitaireAbsence.getHeuresCoursManquees(aAbsence);
            lAvecContenu = (lHeuresCoursManquees !== '');
            if (lAvecContenu) {
                H.push('<div>');
                H.push(lHeuresCoursManquees);
                H.push('</div>');
            }
            var lClass = lAvecContenu ? 'EspaceHaut' : '';
            var lMotifs = this.getLibelleMotifs(aAbsence, aIndice, {
                applatCouleurPJ: true
            });
            var lTAFs = this.getLibelleTAF(aAbsence);
            lAvecContenu = (lMotifs !== '') || (lTAFs !== '');
            if (lAvecContenu) {
                H.push('<div class="', lClass, '">');
                H.push(lMotifs);
                H.push(lTAFs);
                H.push('</div>');
            }
            H.push('&nbsp;</td>');
            H.push('</tr>');
            return H.join('');
        };
        ObjetDetailVS.prototype.getInfoAbsence = function(aAbsence) {
            var lDebut = 'title="';
            var lFin = '" ';
            switch (aAbsence.GetGenre()) {
                case EGenreRessource.ObservationProfesseurEleve:
                    switch (aAbsence.genreObservation) {
                        case TypeGenreObservationVS.OVS_DefautCarnet:
                        case TypeGenreObservationVS.OVS_Autres:
                            return '';
                        case TypeGenreObservationVS.OVS_ObservationParent:
                            if (aAbsence.estLue) {
                                return lDebut + GTraductions.getValeur('AbsenceVS.observationLue').ucfirst() + lFin;
                            }
                            return lDebut + GTraductions.getValeur('AbsenceVS.observationNonLue').ucfirst() + lFin;
                        case TypeGenreObservationVS.OVS_Encouragement:
                            if (aAbsence.estLue) {
                                return lDebut + GTraductions.getValeur('AbsenceVS.encouragementLu').ucfirst() + lFin;
                            }
                            return lDebut + GTraductions.getValeur('AbsenceVS.encouragementNonLu').ucfirst() + lFin;
                    }
                    break;
                case EGenreRessource.Absence:
                    if (aAbsence.justifie) {
                        return lDebut + GTraductions.getValeur('AbsenceVS.absenceCoursJust').ucfirst() + lFin;
                    }
                    return lDebut + GTraductions.getValeur('AbsenceVS.absenceCoursNonJust').ucfirst() + lFin;
                case EGenreRessource.AbsenceRepas:
                    return lDebut + GTraductions.getValeur('AbsenceVS.absenceRepas').ucfirst() + lFin;
                case EGenreRessource.AbsenceInternat:
                    return lDebut + GTraductions.getValeur('AbsenceVS.absenceInternat').ucfirst() + lFin;
                case EGenreRessource.Retard:
                    return lDebut + GTraductions.getValeur('AbsenceVS.retard').ucfirst() + lFin;
                case EGenreRessource.Infirmerie:
                    return lDebut + GTraductions.getValeur('AbsenceVS.infirmerie').ucfirst() + lFin;
                case EGenreRessource.Exclusion:
                    return lDebut + GTraductions.getValeur('AbsenceVS.exclusion').ucfirst() + lFin;
                case EGenreRessource.Punition:
                    switch (aAbsence.nature.GetGenre()) {
                        case TypeGenrePunition.GP_ExclusionCours:
                            return lDebut + GTraductions.getValeur('AbsenceVS.exclusion').ucfirst() + lFin;
                        case TypeGenrePunition.GP_Retenues:
                        case TypeGenrePunition.GP_Devoir:
                        case TypeGenrePunition.GP_Autre:
                            return lDebut + GTraductions.getValeur('AbsenceVS.punition').ucfirst() + lFin;
                    }
                    break;
                case EGenreRessource.Sanction:
                    return lDebut + GTraductions.getValeur('AbsenceVS.sanction').ucfirst() + lFin;
                case EGenreRessource.MesureConservatoire:
                    return lDebut + GTraductions.getValeur('AbsenceVS.mesureConservatoire').ucfirst() + lFin;
            }
            return '';
        };
        ObjetDetailVS.prototype.getLibelleModalitePunitionSanction = function(aAbsence, aSansTitre) {
            var lLibelle = '';
            var lModalite = '';
            if (aAbsence.GetGenre() !== EGenreRessource.MesureConservatoire) {
                lModalite = this.utilitaireAbsence.getModalitesPunitionSanction(aAbsence);
            }
            if (lModalite) {
                lLibelle += '<span class="EspaceTitreInfoVS">' + (aSansTitre ? '' : '<br>') + lModalite + '</span>';
            }
            return lLibelle;
        };
        ObjetDetailVS.prototype.getLibelleTitre = function(aAbsence) {
            var lLibelle = this.getChaineTraductionGenreAbsence(aAbsence);
            if (aAbsence.GetGenre() === EGenreRessource.ObservationProfesseurEleve) {
                lLibelle = '<div class="InlineBlock AlignementHaut" style="xheight:14px; line-height: 1.1rem;">' + lLibelle + '&nbsp;</div>';
            }
            return (lLibelle !== '') ? '<div class="Texte10 InsecableFichePresence Gras">' + lLibelle + '</div>' : '';
        };
        ObjetDetailVS.prototype.getLibellePunitionSanctionDIncident = function(aAbsence) {
            var lLibelle = '';
            var lModalite = this.utilitaireAbsence.getLibellePunitionSanctionDIncident(aAbsence);
            if (lModalite) {
                lLibelle += '<span class="EspaceTitreInfoVS"><br>' + lModalite + '<br></span>';
            }
            return lLibelle;
        };
        ObjetDetailVS.prototype.getLibelleObservation = function(aAbsence) {
            var lLibelle = '';
            if (aAbsence.GetGenre() === EGenreRessource.ObservationProfesseurEleve) {
                lLibelle += this.utilitaireAbsence.getMatiere(aAbsence, true);
                lLibelle += (lLibelle && aAbsence.commentaire ? '<br>' : '') + aAbsence.commentaire;
            }
            return (lLibelle !== '') ? '<div class="Texte10">' + lLibelle + '</div>' : '';
        };
        ObjetDetailVS.prototype.getLibelleDemandeurDecideur = function(aAbsence, aAvecDateDemande) {
            var lLibelle = '';
            if (aAbsence.GetGenre() !== EGenreRessource.ObservationProfesseurEleve) {
                lLibelle += this.utilitaireAbsence.getDemandeurDecideur(aAbsence, true, true);
                if (aAvecDateDemande && (aAbsence.GetGenre() === EGenreRessource.Punition) && GDate.estDateValide(aAbsence.dateDemande)) {
                    if (lLibelle === '') {
                        lLibelle += GTraductions.getValeur('AbsenceVS.demande');
                    }
                    lLibelle += ' ' + GTraductions.getValeur('Dates.LeDate', [GDate.FormatDate(aAbsence.dateDemande, ' %J %MMMM')]) + ' ';
                }
            }
            return (lLibelle !== '') ? '<div class="Texte10 InsecableFichePresence">' + lLibelle + '</div>' : '';
        };
        ObjetDetailVS.prototype._getIdCombo = function(aIndice) {
            return '_I_' + aIndice;
        };
        ObjetDetailVS.prototype.getLibelleMotifs = function(aAbsence, aIndice, aParam) {
            var lLibelle = '';
            if (aAbsence.avecSaisie) {
                var lCombo = this.combos[this._getIdCombo(aIndice)];
                if (lCombo) {
                    lLibelle = '<div class="EspaceHaut">' + GTraductions.getValeur('AbsenceVS.votreRaison') + '&nbsp;:</div>';
                    lLibelle += '<div id="' + lCombo.Nom + '" class="motif" style="margin-bottom: 2px;"></div>';
                }
                if ((aAbsence.GetGenre() === EGenreRessource.Absence)) {
                    var lPJ = this.pjs[aIndice];
                    if (lPJ) {
                        var lStylePJ = '';
                        if (aParam && (aParam.applatCouleurPJ === true)) {
                            lStylePJ = GStyle.composeCouleurFond(GCouleur.fond) + ' margin-top:5px; margin-bottom:5px; padding:5px;';
                        }
                        lLibelle += '<div style="' + lStylePJ + '">';
                        lLibelle += '<div class="EspaceHaut">' + GTraductions.getValeur('AbsenceVS.titres.justificatif').ucfirst() + '&nbsp;:</div>';
                        lLibelle += '<div class="EspaceDroit"><div id="' + lPJ.Nom + '" style="margin-bottom: 2px;"></div></div>';
                        lLibelle += '</div>';
                    }
                }
                lLibelle += '<div class="EspaceHaut">' + this.utilitaireAbsence.getCommentaireMotifAbsence({
                    callback: this.Nom + '.surSaisieVS(' + aIndice + ')',
                    donnee: aAbsence,
                    id: this.getIDElementVS(aIndice),
                    enListe: false,
                    width: 246
                }) + '</div>';
            } else {
                var lMotifAbs = this.utilitaireAbsence.getMotifAbsence({
                    callback: this.Nom + '.surSaisieVS(' + aIndice + ')',
                    donnee: aAbsence,
                    id: this.getIDElementVS(aIndice),
                    enListe: false,
                    traduction: ''
                });
                lLibelle += (lMotifAbs !== '') ? '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst() + '&nbsp;:</div>' : '';
                lLibelle += (lMotifAbs !== '') ? '<div>' + lMotifAbs + '</div>' : '';
            }
            return (lLibelle !== '') ? '<div class="Texte10">' + lLibelle + '</div>' : '';
        };
        ObjetDetailVS.prototype.surSaisieVS = function(aIndice) {
            var lElement = this.donnees.GetElement(aIndice);
            var lInput = $('#' + this.getIDElementVS(aIndice).escapeJQ()).val();
            if (lInput === GTraductions.getValeur('AbsenceVS.saisissezCommentaire').ucfirst() || lInput === lElement.justification) {
                return;
            }
            lElement.justification = lInput;
            lElement.SetEtat(EGenreEtat.Modification);
            this.etatSaisie = this.donnees.existeElementPourValidation();
            if (this.etatSaisie) {
                GHtml.setDisabled(this.idBouton, false);
            }
            if (!this.sansSetEtatSaisie && !GEtatUtilisateur.estEspaceMobile()) {
                this.SetEtatSaisie(this.etatSaisie);
            }
        };
        ObjetDetailVS.prototype.surBouton = function() {
            if (this.options.avecCallBackSurBouton && this.callback && this.donnees.GetNbrElements() === 1) {
                var lElement = this.donnees.GetElement(0);
                var lListePJ = !!this.listePJs ? this.listePJs[0] : new ObjetListeElements();
                this.callback.appel(true, lElement, lListePJ);
            } else if (this.Pere && this.Pere.Valider) {
                this.Pere.Valider();
            }
        };
        ObjetDetailVS.prototype.getCirconstances = function(aAbsence) {
            var lLibelle = this.utilitaireAbsence.getCirconstances(aAbsence);
            if (!!lLibelle) {
                lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.circonstances').ucfirst() + '&nbsp;:</div><div>' + lLibelle + '<div>';
            }
            return lLibelle;
        };
        ObjetDetailVS.prototype.getLibelleTAF = function(aAbsence) {
            var lLibelle = this.utilitaireAbsence.getTravailAFaire(aAbsence);
            if (!!lLibelle) {
                lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.travailAFaire').ucfirst() + '&nbsp;:</div>' + lLibelle;
            }
            return lLibelle;
        };
        ObjetDetailVS.prototype.getLibellesInterdit = function(aAbsence) {
            return '<div class="EspaceTitreInfoVS">' + this.utilitaireAbsence.getLibellesInterdit(aAbsence) + '</div>';
        };
        ObjetDetailVS.prototype.getGravite = function(aElement) {
            var lLibelle = aElement.gravite || '';
            if (!!lLibelle) {
                lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.gravite').ucfirst() + '&nbsp;:</div>' + lLibelle;
            }
            return lLibelle;
        };
        ObjetDetailVS.prototype.getMesureDisciplinaire = function(aElement) {
            var lLibelle = !!aElement.mesure ? aElement.mesure.nature.GetLibelle() : '';
            if (!!lLibelle) {
                lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.mesureDisciplinaire').ucfirst() + '&nbsp;:</div>' + lLibelle;
            }
            return lLibelle;
        };
        ObjetDetailVS.prototype.getIDCheckBox = function(aIndice) {
            return this.Nom + '_input_' + aIndice;
        };
        ObjetDetailVS.prototype.getIDElementVS = function(aIndice) {
            return this.Nom + '_inputVS_' + aIndice;
        };
        ObjetDetailVS.prototype.getChaineTraductionGenreAbsence = function(aAbsence) {
            var lResult = '';
            switch (aAbsence.Genre) {
                case EGenreRessource.ObservationProfesseurEleve:
                    switch (aAbsence.genreObservation) {
                        case TypeGenreObservationVS.OVS_DefautCarnet:
                        case TypeGenreObservationVS.OVS_Autres:
                            lResult = aAbsence.GetLibelle() ? aAbsence.GetLibelle() : '';
                            break;
                        case TypeGenreObservationVS.OVS_ObservationParent:
                            lResult = GTraductions.getValeur('AbsenceVS.observation');
                            break;
                        case TypeGenreObservationVS.OVS_Encouragement:
                            lResult = GTraductions.getValeur('AbsenceVS.encouragement');
                            break;
                        default:
                            lResult = '';
                    }
                    if (aAbsence.demandeur && aAbsence.demandeur.existeNumero()) {
                        lResult += '<br />' + (MethodesTableau.existe(this.genreObservation, [TypeGenreObservationVS.OVS_ObservationParent, TypeGenreObservationVS.OVS_Encouragement]) ? GTraductions.getValeur('AbsenceVS.deProfesseur', [aAbsence.demandeur.GetLibelle()]) : GTraductions.getValeur('AbsenceVS.signalePar', [aAbsence.demandeur.GetLibelle()]));
                    }
                    break;
                case EGenreRessource.Absence:
                    lResult += this.utilitaireAbsence.getChaineTraductionGenreAbsence({
                        genre: aAbsence.GetGenre(),
                        singulier: true,
                        justifie: aAbsence.justifie
                    }).ucfirst() + '<br />' + this.utilitaireAbsence.getDate(aAbsence, true);
                    break;
                case EGenreRessource.AbsenceRepas:
                    lResult += GTraductions.getValeur('AbsenceVS.absenceRepas');
                    lResult += ' - ' + (aAbsence.genreRepas === EGenreRepas.Midi ? GTraductions.getValeur('AbsenceVS.midi') : GTraductions.getValeur('AbsenceVS.soir'));
                    break;
                case EGenreRessource.AbsenceInternat:
                    lResult += GTraductions.getValeur('AbsenceVS.absenceInternat');
                    break;
                case EGenreRessource.Retard:
                    lResult += GTraductions.getValeur('AbsenceVS.retardDe', [this.utilitaireAbsence.getDureeDAbsence(aAbsence)]) + '<br />' + GDate.FormatDate(aAbsence.dateDebut, GTraductions.getValeur('Dates.LeDateDebutAHeureDebut', ['%J %MMMM', '%xh%sh%mm'])) + ' ';
                    break;
                case EGenreRessource.Infirmerie:
                    lResult += GTraductions.getValeur('AbsenceVS.infirmerie');
                    lResult += '<br />' + GTraductions.getValeur('Dates.DeHeureDebutAHeureFin', [GDate.FormatDate(aAbsence.dateDebut, '%xh%sh%mm'), GDate.FormatDate(aAbsence.dateFin, '%xh%sh%mm')]) + ' ';
                    break;
                case EGenreRessource.Exclusion:
                case EGenreRessource.Punition:
                case EGenreRessource.Sanction:
                case EGenreRessource.Incident:
                    lResult += this.utilitaireAbsence.getModalitesPunitionSanction(aAbsence).ucfirst();
                    break;
                case EGenreRessource.MesureConservatoire:
                    var lStrDate = this.utilitaireAbsence.getDate(aAbsence, true);
                    lResult += this.utilitaireAbsence.getChaineTraductionGenreAbsence({
                        genre: aAbsence.GetGenre(),
                        singulier: true,
                        justifie: aAbsence.justifie
                    }).ucfirst() + (lStrDate ? ' - ' + lStrDate : '');
                    break;
                default:
                    break;
            }
            return lResult.ucfirst();
        };
        ObjetDetailVS.prototype.DetruireInstances = function() {
            this._detruireInputFiles();
        };
        ObjetDetailVS.prototype.ConstruireInstances = function() {};
        ObjetDetailVS.prototype.RecupererDonnees = function() {
            if (this.donnees) {
                if (this.donnees.GetNbrElements() > 0) {
                    this._initCombos();
                    this._initPJs();
                }
                if (this.donnees.existeElementPourValidation()) {
                    GHtml.setDisabled(this.idBouton, false);
                }
                $('#' + this.Nom.escapeJQ() + ' input[type="checkbox"]').jIECheckBox({
                    marginRightMin: 0
                });
                if (GApplication.getModeExclusif()) {
                    this._setModeExclusif(true);
                }
            }
        };
        ObjetDetailVS.prototype._setModeExclusif = function(aModeExclusif) {
            $('#' + this.Nom.escapeJQ() + ' input:checkbox[id^="' + (this.Nom + '_input_').escapeJQ() + '"] ').each(function() {
                if (!$(this).data('disable')) {
                    $(this).inputDisabled(aModeExclusif);
                }
            });
        };
        ObjetDetailVS.prototype._initCombos = function() {
            var I, lCombo;
            for (I = 0; I < this.donnees.GetNbrElements(); I++) {
                lCombo = this.combos[this._getIdCombo(I)];
                if (lCombo) {
                    lCombo.Initialiser();
                    this._actualiserCombo(I);
                }
            }
        };
        ObjetDetailVS.prototype._actualiserCombo = function(aIndice) {
            var lCombo = this.combos[this._getIdCombo(aIndice)];
            if (!lCombo) {
                return;
            }
            var lAbsence = this.donnees.GetElement(aIndice);
            var lListe = lAbsence.GetGenre() === EGenreRessource.Absence ? GEtatUtilisateur.listeMotifsAbsences : GEtatUtilisateur.listeMotifsRetards;
            lCombo.SetDonnees(lListe);
            if (lAbsence.motifParent && lAbsence.motifParent.existeNumero()) {
                lCombo.initSelectionParNumeroEtGenre(lAbsence.motifParent.GetNumero());
            } else {
                lCombo.SetContenu(GTraductions.getValeur('AbsenceVS.aPreciser'));
            }
        };
        ObjetDetailVS.prototype._initPJs = function() {
            var I, lPJ;
            for (I = 0; I < this.donnees.GetNbrElements(); I++) {
                lPJ = this.pjs[I];
                if (lPJ) {
                    lPJ.Initialiser();
                    this._actualiserPJ(I);
                }
            }
        };
        ObjetDetailVS.prototype._actualiserPJ = function(aIndice) {
            var lPJ = this.pjs[aIndice];
            if (!lPJ) {
                return;
            }
            var lAbsence = this.donnees.GetElement(aIndice);
            lPJ.SetDonnees({
                listePJ: lAbsence.documents,
                listeTotale: this.listePJs[aIndice],
                idContextFocus: this.Nom
            });
        };
        ObjetDetailVS.prototype.surAR = function(aIndice) {
            var lElement = this.donnees.GetElement(aIndice);
            lElement.parentAAccuseDeReception = true;
            lElement.SetEtat(EGenreEtat.Modification);
            $('#' + this.getIDCheckBox(aIndice).escapeJQ()).inputDisabled(true).data('disable', true);
            this.callback.appel(true, lElement);
        };
        ObjetDetailVS.prototype.surSelection = function(aIndice) {
            var lElement = this.donnees.GetElement(aIndice);
            lElement.estLue = true;
            lElement.SetEtat(EGenreEtat.Modification);
            $('#' + this.getIDCheckBox(aIndice).escapeJQ()).inputDisabled(true).data('disable', true);
            this.callback.appel(true, lElement);
        };
        module.exports = ObjetDetailVS;
    },
    fn: "objetdetailvs.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('espace/css/ObjetFichePresenceStyle.css');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetFiche = require('ObjetFiche.js');
        var ObjetDetailVS = require('ObjetDetailVS.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var MethodesTableau = require('MethodesTableau.js');
        MethodesObjet.heritagePrototype(ObjetFichePresence, ObjetFiche);

        function ObjetFichePresence() {
            this.inheritedCreate(arguments);
            this.largeurMax = 500;
            this.hauteurMax = 450;
            this.idScroll = this.Nom + '_scroll';
            this.objetDetailVS = new ObjetDetailVS(this.Nom + ".objetDetailVS", null, this, this.evntDetailVS);
            this.options = {
                avecCallBackSurBouton: false
            };
            this.setOptionsFenetre({
                largeur: 293,
                hauteur: 135,
                titre: function() {
                    return '<div>' + this.titreFiche + '</div>';
                }.bind(this)
            });
        }
        ObjetFichePresence.prototype.evntDetailVS = function(aAvecSaisie, aAbsence, aListePJs) {
            this.callback.appel(aAvecSaisie, aAbsence, aListePJs);
        };
        ObjetFichePresence.prototype.setOptions = function(aOptions) {
            $.extend(this.options, aOptions);
        };
        ObjetFichePresence.prototype.DetruireInstances = function() {
            this.objetDetailVS.DetruireInstances();
            this.Fermer(false);
        };
        ObjetFichePresence.prototype.SetDonnees = function(aParams) {
            this.donnees = aParams.donnees;
            this.avecSaisie = this.donnees.getIndiceElementParFiltre(function(aElement) {
                return aElement.avecSaisie;
            }) > -1;
            this.setTitre(aParams.titre);
            var lEstEspaceParent = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Parent, EGenreEspace.PrimParent, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent]);
            $.extend(this.options, {
                autorisations: aParams.autorisations,
                avecSaisie: this.avecSaisie,
                sansSetEtatSaisie: !!aParams.sansSetEtatSaisie,
                avecJustificatifAbsence: lEstEspaceParent,
                avecSaisieObservation: lEstEspaceParent,
                avecARPunition: lEstEspaceParent
            });
            this.objetDetailVS.setParametres(this.donnees, this.options);
            this.afficherFiche({
                id: aParams.id,
                positionSurSouris: true,
                positionSurSourisSiAffiche: true
            });
        };
        ObjetFichePresence.prototype.setTitre = function(aTitre) {
            this.titreFiche = aTitre;
        };
        ObjetFichePresence.prototype.ComposeContenu = function() {
            var H = [];
            H.push('<div id="', this.objetDetailVS.GetNom(), '"></div>');
            return H.join('');
        };
        ObjetFichePresence.prototype.surPreAffichage = function() {
            this.objetDetailVS.Initialiser();
        };
        module.exports = ObjetFichePresence;
    },
    fn: "objetfichepresence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetFichePresence = require('ObjetFichePresence.js');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetUtilitaireAbsence = require('ObjetUtilitaireAbsence.js');
        var TypeGenreObservationVS = require('TypeGenreObservationVS.js').TypeGenreObservationVS;

        function WidgetVieScolaire() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(WidgetVieScolaire, Identite);
        WidgetVieScolaire.prototype.creerObjets = function() {
            this.fichePresence = ObjetFenetre.creerInstance(ObjetFichePresence, {
                pere: this,
                evenement: this._evnFichePresence,
                initialiser: false
            });
            this.fichePresence.destructionSurFermeture = false;
            this.fichePresence.setOptions({
                avecCallBackSurBouton: true
            });
            this.utilitaireAbsence = new ObjetUtilitaireAbsence();
        };
        WidgetVieScolaire.prototype.initialiserObjets = function() {
            this.fichePresence.Initialiser();
        };
        WidgetVieScolaire.prototype.composeWidget = function() {
            var H = [];
            if (this.donnees.listeAbsences.GetNbrElements() > 0) {
                H.push('<ul role="list" class="liste-clickable">');
                for (var I = 0; I < this.donnees.listeAbsences.GetNbrElements(); I++) {
                    var lAbsence = this.donnees.listeAbsences.GetElement(I);
                    H.push(this.composeAbsence(lAbsence, I));
                }
                H.push('</ul">');
            }
            return H.join('');
        };
        WidgetVieScolaire.prototype.construire = function(aParams) {
            this.donnees = aParams.donnees;
            this.creerObjets();
            var lWidget = {
                html: this.composeWidget(),
                nbrElements: this.donnees.listeAbsences.GetNbrElements(),
                afficherMessage: this.donnees.listeAbsences.GetNbrElements() === 0,
                fermerFiches: function() {
                    this.fichePresence.Fermer();
                }.bind(this)
            };
            $.extend(true, this.donnees, lWidget);
            aParams.construireWidget(this.donnees);
            this.initialiserObjets();
        };
        WidgetVieScolaire.prototype.composeAbsence = function(aAbsence, i) {
            var H = [];
            var lLibelle = this.utilitaireAbsence.getChaineTraductionGenreAbsence({
                genre: aAbsence.GetGenre(),
                genreObservation: aAbsence.genreObservation,
                libelle: aAbsence.GetLibelle(),
                singulier: true,
                justifie: aAbsence.justifie
            }).ucfirst();
            var lDate = this.utilitaireAbsence.getDate(aAbsence, true);
            var lEstLue = (GEtatUtilisateur.GenreEspace === EGenreEspace.Eleve) && (aAbsence.genreObservation === TypeGenreObservationVS.OVS_Encouragement) ? true : aAbsence.estLue;
            var lClassIcon = EGenreRessource.getNomImageAbsence({
                genre: aAbsence.GetGenre(),
                genreObservation: aAbsence.genreObservation,
                genreNature: aAbsence.nature ? aAbsence.nature.GetGenre() : null,
                justifie: aAbsence.justifie,
                estLue: lEstLue,
                avecSursis: aAbsence.avecSursis
            });
            H.push('<li tabIndex="0" class="icon ', lClassIcon, '"', GObjetWAI.composeRole(EGenreRole.Listitem), ' ', GObjetWAI.composeAttribut({
                genre: EGenreAttribut.label,
                valeur: lLibelle + ' ' + lDate
            }), ' ', ' onclick="', this.Nom, '._surAbsence (', i, ')">');
            H.push('<div class="wrap">', '<h4>', lLibelle, '</h4>', '<span class="date">', lDate, '</span>', '</div>', '</li>');
            return H.join('');
        };
        WidgetVieScolaire.prototype._surAbsence = function(i) {
            var lListeAbsencesFiche = new ObjetListeElements();
            var lAbsence = this.donnees.listeAbsences.GetElement(i);
            lListeAbsencesFiche.AddElement(lAbsence);
            this.fichePresence.SetDonnees({
                titre: GTraductions.getValeur('AbsenceVS.detailDeLEvenement'),
                donnees: lListeAbsencesFiche,
                autorisations: this.autorisationsVS()
            });
        };
        WidgetVieScolaire.prototype._evnFichePresence = function(aAvecSaisie, aAbsence, aListePJs) {
            if (!aAvecSaisie) {
                return;
            }
            var lElement = this.donnees.listeAbsences.GetElementParElement(aAbsence);
            if ((MethodesTableau.existe(lElement.GetGenre(), [EGenreRessource.Absence, EGenreRessource.Retard])) || ((lElement.GetGenre() === EGenreRessource.Punition) && lElement.nature && lElement.nature.estAvecARParent) || (lElement.GetGenre() === EGenreRessource.ObservationProfesseurEleve) && aAbsence.avecARObservation) {
                this.Valider(aListePJs);
            } else {
                this.SetEtatSaisie(this.donnees.actualites.listeActualites.existeElementPourValidation() || this.donnees.listeAbsences.existeElementPourValidation());
            }
        };
        module.exports = WidgetVieScolaire;
    },
    fn: "espace/script/widget/widgetviescolaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GUID = require('GUID.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var EGenreWidget = require('Enumere_Widget.js');
        var EGenreLienDS = require('Enumere_LienDS.js');
        var GTraductions = require('ObjetTraduction.js');
        var MethodesTableau = require('MethodesTableau.js');
        var WidgetActualites = require('espace/script/widget/WidgetActualites.js');
        var WidgetAgenda = require('espace/script/widget/WidgetAgenda.js');
        var WidgetAide = require('espace/script/widget/WidgetAide.js');
        var WidgetAppelNonFait = require('espace/script/widget/WidgetAppelNonFait.js');
        var WidgetCarnetDeCorrespondance = require('espace/script/widget/WidgetCarnetDeCorrespondance.js');
        var WidgetCasier = require('espace/script/widget/WidgetCasier.js');
        var WidgetCDC = require('espace/script/widget/WidgetCDC.js');
        var WidgetCDTNonSaisi = require('espace/script/widget/WidgetCDTNonSaisi.js');
        var WidgetCompetences = require('espace/script/widget/WidgetCompetences.js');
        var WidgetConnexionsEnCours = require('espace/script/widget/WidgetConnexionsEnCours.js');
        var WidgetCoursNonAssures = require('espace/script/widget/WidgetCoursNonAssures.js');
        var WidgetDiscussions = require('espace/script/widget/WidgetDiscussions.js');
        var WidgetDonneesProfs = require('espace/script/widget/WidgetDonneesProfs.js');
        var WidgetDonneesVS = require('espace/script/widget/WidgetDonneesVS.js');
        var WidgetDS = require('espace/script/widget/WidgetDS.js');
        var WidgetDSEvaluation = require('espace/script/widget/WidgetDSEvaluations.js');
        var WidgetEDT = require('espace/script/widget/WidgetEDT.js');
        var WidgetElections = require('espace/script/widget/WidgetElections.js');
        var WidgetEnseignementADistance = require('espace/script/widget/WidgetEnseignementADistance.js');
        var WidgetIncidents = require('espace/script/widget/WidgetIncidents.js');
        var WidgetIntendance_Execute = require('espace/script/widget/WidgetIntendance_Execute.js');
        var WidgetKiosque = require('espace/script/widget/WidgetKiosque.js');
        var WidgetLienUtile = require('espace/script/widget/WidgetLienUtile.js');
        var WidgetMenu = require('espace/script/widget/WidgetMenu.js');
        var WidgetNotes = require('espace/script/widget/WidgetNotes.js');
        var WidgetPartenaireAgate = require('espace/script/widget/WidgetPartenaireAgate.js');
        var WidgetPartenaireARD = require('espace/script/widget/WidgetPartenaireArd.js');
        var WidgetPartenaireCDI = require('espace/script/widget/WidgetPartenaireCDI.js');
        var WidgetPenseBete = require('espace/script/widget/WidgetPenseBete.js');
        var WidgetPersonnelsAbsents = require('espace/script/widget/WidgetPersonnelsAbsents.js');
        var WidgetPlanning = require('WidgetPlanning.js');
        var WidgetQCM = require('espace/script/widget/WidgetQCM.js');
        var WidgetRessources = require('espace/script/widget/WidgetRessources.js');
        var WidgetRessourcePedagogique = require('espace/script/widget/WidgetRessourcePedagogique.js');
        var WidgetRetourEspace = require('mobile/script/Widget/WidgetRetourEspace.js');
        var WidgetTableauDeBord = require('espace/script/widget/WidgetTableauDeBord.js');
        var WidgetTAF = require('espace/script/widget/WidgetTAF.js');
        var WidgetTAFPrimaire = require('espace/script/widget/widgetTAFPrimaire.js');
        var WidgetTAFARendre = require('espace/script/widget/WidgetTAFARendre.js');
        var WidgetVieScolaire = require('espace/script/widget/WidgetVieScolaire.js');

        function ObjetMoteurAccueil() {
            this.genreColonne = {
                agendaEtInformations: {
                    genre: 0,
                    position: 4,
                    actif: false,
                    visible: true
                },
                notes: {
                    genre: 1,
                    position: 2,
                    actif: false,
                    visible: true
                },
                CDT: {
                    genre: 2,
                    position: 1,
                    minWidth: 360,
                    maxWidth: 500,
                    actif: false,
                    visible: true
                },
                emploiDuTemps: {
                    genre: 3,
                    position: 0,
                    maximise: GEtatUtilisateur.GenreEspace === EGenreEspace.Professeur ? true : false,
                    actif: false,
                    visible: true
                },
                absencesProf: {
                    genre: 4,
                    position: 3,
                    actif: false,
                    visible: true
                },
                aide: {
                    genre: 5,
                    position: 5,
                    poids: 1,
                    actif: false,
                    visible: true
                },
                tableauDeBord: {
                    genre: 6,
                    position: 0,
                    minWidth: 850,
                    maxWidth: 1000,
                    actif: false,
                    visible: true
                },
                communications: {
                    genre: 7,
                    position: 2,
                    minWidth: 360,
                    maxWidth: 500,
                    actif: false,
                    visible: true
                },
                central: {
                    genre: 8,
                    position: 2,
                    minWidth: 360,
                    maxWidth: 500,
                    actif: false,
                    visible: true
                }
            };
        }
        ObjetMoteurAccueil.WidgetMenu = WidgetMenu;
        ObjetMoteurAccueil.prototype.setDonnees = function(aDonnees) {
            this.donnees = aDonnees;
        };
        ObjetMoteurAccueil.prototype.setDateParDefaut = function(aDate) {
            this.dateParDefaut = aDate;
        };
        ObjetMoteurAccueil.prototype.setSemaineSelectionnee = function(aSemaineSelectionnee) {
            this.semaineSelectionnee = aSemaineSelectionnee;
        };
        ObjetMoteurAccueil.prototype.existeDS = function(aGenreLienDS) {
            if (this.donnees.devoirSurveille.listeDS) {
                for (var i = 0; i < this.donnees.devoirSurveille.listeDS.GetNbrElements(); i++) {
                    if (this.donnees.devoirSurveille.listeDS.GetGenre(i) === aGenreLienDS) {
                        return true;
                    }
                }
            }
            return false;
        };
        ObjetMoteurAccueil.prototype.getDeclarationWidget = function(aGenreWidget) {
            switch (aGenreWidget) {
                case EGenreWidget.activite:
                    return {
                        nomDonnees: 'activite', genre: EGenreWidget.activite, id: GUID.getId(), classWidget: WidgetTAFPrimaire, existe: function() {
                            return !!this.donnees.activite && !!this.donnees.activite.listeActivite && !!this.donnees.activite.listeActivite.GetNbrElements();
                        }, isCollapsible: false, titre: GTraductions.getValeur('accueil.ActiviteDuJour'), page: {
                            Onglet: EGenreOnglet.CDT_TAF
                        }, dateSelectionnee: this.getDatePremierTaf
                    };
                case EGenreWidget.actualites:
                    return {
                        nomDonnees: 'actualites', genre: EGenreWidget.actualites, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement || GEtatUtilisateur.pourPrimaire() ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetActualites, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.Informations
                        }, titre: GEtatUtilisateur.pourPrimaire() && (GEtatUtilisateur.GenreEspace !== EGenreEspace.PrimProfesseur && GEtatUtilisateur.GenreEspace !== EGenreEspace.Mobile_PrimProfesseur) ? GTraductions.getValeur('accueil.actualitesPrimaire') : GTraductions.getValeur('accueil.actualites'), hint: GTraductions.getValeur('accueil.info.actualites'), message: GTraductions.getValeur('accueil.aucuneActualite'), existe: function() {
                            return !this.donnees || this.donnees.actualites.listeActualites;
                        }.bind(this), isCollapsible: true, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 13 : 12, poids: 2, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.agenda:
                    return {
                        nomDonnees: 'agenda', genre: EGenreWidget.agenda, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement || GEtatUtilisateur.pourPrimaire() ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetAgenda, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.Agenda
                        }, titre: GTraductions.getValeur('accueil.agenda.titre'), hint: GTraductions.getValeur('accueil.info.agenda'), message: GTraductions.getValeur('accueil.aucuneAgenda'), existe: function() {
                            return !this.donnees || this.donnees.agenda.listeEvenements;
                        }.bind(this), isCollapsible: true, maxItemsVisible: 13, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 12 : 11, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', semaineSelectionnee: this.numeroSemaineParDefaut
                    };
                case EGenreWidget.aide:
                    return {
                        nomDonnees: 'aide', genre: EGenreWidget.aide, genreColonne: this.genreColonne.aide.genre, classWidget: WidgetAide, id: GUID.getId(), titre: GTraductions.getValeur('accueil.aide.titre'), existe: function() {
                            return false;
                        }, isCollapsible: false, position: 1, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', maximise: true
                    };
                case EGenreWidget.appelNonFait:
                    return {
                        nomDonnees: 'appelNonFait', genre: EGenreWidget.appelNonFait, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetAppelNonFait, id: GUID.getId(), page: {
                            Onglet: GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.SaisieAbsences_AppelEtSuivi) ? EGenreOnglet.SaisieAbsences_AppelEtSuivi : EGenreOnglet.SaisieAbsences_Appel
                        }, titre: GTraductions.getValeur('accueil.appelNonFait.titre'), hint: '', message: GTraductions.getValeur('accueil.appelNonFait.message'), existe: function() {
                            return !this.donnees || this.donnees.appelNonFait.listeAppelNonFait ? true : false;
                        }, isCollapsible: true, nbrItemsVisible: 3, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 6 : 2, poids: 1, selecteurNavigationFleche: '[onclick]', jourSelectionne: this.dateParDefaut, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.casier:
                    return {
                        nomDonnees: 'casier', genre: EGenreWidget.casier, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement || GEtatUtilisateur.pourPrimaire() ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetCasier, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.Casier_MonCasier
                        }, titre: GTraductions.getValeur('accueil.casier.titre'), hint: GTraductions.getValeur('accueil.casier.titre'), message: GTraductions.getValeur('accueil.casier.message'), existe: function() {
                            return !this.donnees || this.donnees.casier.listeDocuments;
                        }, isCollapsible: true, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 15 : 14, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.carnetDeCorrespondance:
                    return {
                        nomDonnees: 'carnetDeCorrespondance', genre: EGenreWidget.carnetDeCorrespondance, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetCarnetDeCorrespondance, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.Saisie_CarnetCorrespondance
                        }, titre: GTraductions.getValeur('accueil.carnetDeCorrespondance.titre'), hint: GTraductions.getValeur('accueil.carnetDeCorrespondance.hint'), message: GTraductions.getValeur('accueil.carnetDeCorrespondance.message'), existe: function() {
                            return !this.donnees || this.donnees.carnetDeCorrespondance.listeObservations;
                        }, isCollapsible: true, nbrItemsVisible: 5, position: 4, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', semaineSelectionnee: IE.Cycles.cycleDeLaDate(GApplication.getDateDemo() ? GApplication.getDateDemo() : new Date())
                    };
                case EGenreWidget.conseilDeClasse:
                    return {
                        nomDonnees: 'conseilDeClasse', genre: EGenreWidget.conseilDeClasse, genreColonne: this.genreColonne.emploiDuTemps.genre, classWidget: WidgetCDC, id: GUID.getId(), page: null, titre: GTraductions.getValeur('accueil.CDC.titre'), hint: '', existe: function() {
                            return !this.donnees || (this.donnees.conseilDeClasse.listeClasses && this.donnees.conseilDeClasse.listeClasses.GetNbrElements() > 0);
                        }, isCollapsible: false, position: 10, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.CDTNonSaisi:
                    return {
                        nomDonnees: 'CDTNonSaisi', genre: EGenreWidget.CDTNonSaisi, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetCDTNonSaisi, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.SaisieCahierDeTextes
                        }, titre: GTraductions.getValeur('accueil.CDTNonSaisi.titre'), hint: '', message: GTraductions.getValeur('accueil.CDTNonSaisi.message'), existe: function() {
                            return !this.donnees || this.donnees.CDTNonSaisi.listeCours ? true : false;
                        }, isCollapsible: true, nbrItemsVisible: 5, position: 3, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', jourSelectionne: GApplication.getDateDemo() ? GApplication.getDateDemo() : GParametres.JourOuvre, semaineSelectionnee: this.semaineSelectionnee
                    };
                case EGenreWidget.competences:
                    return {
                        nomDonnees: 'competences', genre: aGenreWidget, genreColonne: this.genreColonne.notes.genre, classWidget: WidgetCompetences, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.DernieresEvaluations
                        }, titre: GTraductions.getValeur('accueil.competences.titre'), hint: GTraductions.getValeur('accueil.competences.hint'), message: '', existe: function() {
                            return (!this.donnees || (this.donnees.competences.listeEvaluations && this.donnees.competences.listeEvaluations.GetNbrElements()));
                        }, isCollapsible: false, maxItemsVisible: -1, position: 3, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', feminin: true
                    };
                case EGenreWidget.connexionsEnCours:
                    return {
                        nomDonnees: 'connexionsEnCours', genre: EGenreWidget.connexionsEnCours, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetConnexionsEnCours, id: GUID.getId(), titre: GTraductions.getValeur('accueil.connexionsEnCours.titre'), message: '', titreDansParametrage: GTraductions.getValeur('accueil.connexionsEnCours.titre'), existe: function() {
                            return GEtatUtilisateur.GenreEspace === EGenreEspace.Administrateur || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Administrateur && (!this.donnees || !!this.donnees.connexionsEnCours);
                        }, isCollapsible: false, position: 13, poids: 1
                    };
                case EGenreWidget.coursNonAssures:
                    return {
                        nomDonnees: 'coursNonAssures', genre: EGenreWidget.coursNonAssures, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetCoursNonAssures, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.CoursNonAssures
                        }, titre: GTraductions.getValeur('accueil.coursNonAssures.titre'), hint: '', message: GTraductions.getValeur('accueil.coursNonAssures.message'), existe: function() {
                            return !this.donnees || (this.donnees.coursNonAssures.listeCoursNonAssures);
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 9 : 8, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.discussions:
                    return {
                        nomDonnees: 'discussions', genre: aGenreWidget, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement || GEtatUtilisateur.pourPrimaire() ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetDiscussions, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.Messagerie
                        }, titre: GTraductions.getValeur('accueil.discussions.titre'), hint: GTraductions.getValeur('accueil.info.discussions'), message: GTraductions.getValeur('accueil.aucunMessage'), existe: function() {
                            return !this.donnees || this.donnees.discussions.listeMessagerie;
                        }, isCollapsible: true, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 14 : 13, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', feminin: true
                    };
                case EGenreWidget.donneesProfs:
                    return {
                        nomDonnees: 'donneesProfs', genre: aGenreWidget, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetDonneesProfs, id: GUID.getId(), titre: GTraductions.getValeur('accueil.donneesProfs.titre'), message: '', titreDansParametrage: GTraductions.getValeur('accueil.donneesProfs.titre'), existe: function() {
                            return !this.donnees || (this.donnees.donneesProfs.listeDonneesProfs && this.donnees.donneesProfs.listeDonneesProfs.GetNbrElements());
                        }, isCollapsible: false, position: 12, poids: 1, semaineSelectionnee: this.semaineSelectionnee
                    };
                case EGenreWidget.donneesVS:
                    return {
                        nomDonnees: 'donneesVS', genre: aGenreWidget, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetDonneesVS, id: GUID.getId(), titre: GTraductions.getValeur('accueil.donneesVS.titre'), message: '', titreDansParametrage: GTraductions.getValeur('accueil.donneesVS.titre'), existe: function() {
                            return !this.donnees || (this.donnees.donneesVS.listeDonneesVS && this.donnees.donneesVS.listeDonneesVS.GetNbrElements());
                        }, isCollapsible: false, position: 11, poids: 1, semaineSelectionnee: this.semaineSelectionnee
                    };
                case EGenreWidget.DS:
                    return {
                        nomDonnees: 'devoirSurveille', genre: EGenreWidget.DS, genreColonne: this.genreColonne.CDT.genre, classWidget: WidgetDS, id: GUID.getId(), titre: GTraductions.getValeur('accueil.DS.titre'), hint: GTraductions.getValeur('accueil.DS.hint'), existe: function() {
                            return !this.donnees || this.moteur.existeDS(EGenreLienDS.tGL_Devoir);
                        }, isCollapsible: false, genreDS: EGenreLienDS.tGL_Devoir, position: 0, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.DSEvaluation:
                    return {
                        nomDonnees: 'devoirSurveilleEvaluation', genre: EGenreWidget.DSEvaluation, genreColonne: this.genreColonne.CDT.genre, classWidget: WidgetDSEvaluation, id: GUID.getId(), titre: GTraductions.getValeur('accueil.DSEvaluation.titre'), hint: GTraductions.getValeur('accueil.DSEvaluation.hint'), existe: function() {
                            return !this.donnees || this.moteur.existeDS(EGenreLienDS.tGL_Evaluation);
                        }, isCollapsible: false, genreDS: EGenreLienDS.tGL_Evaluation, position: 1, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.EDT:
                    return {
                        genre: EGenreWidget.EDT, genreColonne: this.genreColonne.emploiDuTemps.genre, classWidget: WidgetEDT, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.EmploiDuTemps
                        }, titreDansParametrage: GTraductions.getValeur('accueil.emploiDuTemps'), existe: function() {
                            return !this.donnees || this.donnees.EDT.listeCours;
                        }.bind(this), isCollapsible: false, position: 1, poids: 1, maximise: true, sansReduction: true, semaineSelectionnee: this.numeroSemaineParDefaut, coursSelectionne: null
                    };
                case EGenreWidget.elections:
                    return {
                        nomDonnees: 'elections', genre: EGenreWidget.elections, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetElections, id: GUID.getId(), titre: GTraductions.getValeur('accueil.elections.titre'), existe: function() {
                            return !this.donnees || (this.donnees.elections.listeElections && this.donnees.elections.listeElections.GetNbrElements() > 0);
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 1 : 10, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.enseignementADistance:
                    return {
                        nomDonnees: 'enseignementADistance', genre: EGenreWidget.enseignementADistance, genreColonne: this.genreColonne.notes.genre, classWidget: WidgetEnseignementADistance, id: GUID.getId(), titre: GEtatUtilisateur.estEspaceEleve() ? GTraductions.getValeur('accueil.enseignementADistance.titre') : GTraductions.getValeur('accueil.enseignementADistance.titreParent'), hint: GTraductions.getValeur('accueil.enseignementADistance.info'), existe: function() {
                            return !this.donnees || !!this.donnees.enseignementADistance.actif;
                        }, position: 0, poids: 1, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', isCollapsible: true, nbrItemsVisible: 3
                    };
                case EGenreWidget.incidents:
                    return {
                        nomDonnees: 'incidents', genre: EGenreWidget.incidents, genreColonne: this.genreColonne.absencesProf.genre, id: GUID.getId(), classWidget: WidgetIncidents, page: {
                            Onglet: EGenreOnglet.Incidents
                        }, titre: GTraductions.getValeur('accueil.incident.titre'), message: GTraductions.getValeur('accueil.incident.msgAucun'), titreDansParametrage: GTraductions.getValeur('accueil.incident.titre'), existe: function() {
                            return !this.donnees || (this.donnees.incidents.listeIncidents);
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 11 : 10, poids: 1, semaineSelectionnee: this.numeroSemaineParDefaut
                    };
                case EGenreWidget.Intendance_Execute:
                    return {
                        nomDonnees: 'intendanceExecute', genre: EGenreWidget.Intendance_Execute, genreColonne: this.genreColonne.absencesProf.genre, id: GUID.getId(), classWidget: WidgetIntendance_Execute, titre: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur]) ? GTraductions.getValeur('TvxIntendance.Widget.Maintenance.TitreToutesDemandes') : GTraductions.getValeur('TvxIntendance.Widget.Maintenance.Titre'), hint: '', message: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur]) ? GTraductions.getValeur('TvxIntendance.Widget.Maintenance.MsgAucunToutesDemandes') : GTraductions.getValeur('TvxIntendance.Widget.Maintenance.MsgAucun'), existe: function() {
                            return !this.donnees || this.donnees.intendanceExecute.listeLignes;
                        }, isCollapsible: false, position: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur]) ? 15 : (GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 7 : 6), poids: 1, page: {
                            Onglet: EGenreOnglet.Intendance_SaisieDemandesTravaux
                        }, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.tachesSecretariat_Execute:
                    return {
                        nomDonnees: 'tachesSecretariatExecute', genre: EGenreWidget.tachesSecretariat_Execute, genreColonne: this.genreColonne.absencesProf.genre, id: GUID.getId(), classWidget: WidgetIntendance_Execute, titre: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur]) ? GTraductions.getValeur('TvxIntendance.Widget.Secretariat.TitreToutesDemandes') : GTraductions.getValeur('TvxIntendance.Widget.Secretariat.Titre'), hint: '', message: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur]) ? GTraductions.getValeur('TvxIntendance.Widget.Secretariat.MsgAucunToutesDemandes') : GTraductions.getValeur('TvxIntendance.Widget.Secretariat.MsgAucun'), existe: function() {
                            return (!this.donnees || this.donnees.tachesSecretariatExecute.listeLignes) && GEtatUtilisateur.GenreEspace !== EGenreEspace.Professeur && GEtatUtilisateur.GenreEspace !== EGenreEspace.Mobile_Professeur;
                        }, isCollapsible: false, position: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Administrateur]) ? 16 : (GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 8 : 7), poids: 1, page: {
                            Onglet: EGenreOnglet.Intendance_SaisieSecretariat
                        }, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.kiosque:
                    return {
                        nomDonnees: 'kiosque', genre: aGenreWidget, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Professeur || GEtatUtilisateur.GenreEspace === EGenreEspace.PrimProfesseur ? this.genreColonne.absencesProf.genre : this.genreColonne.CDT.genre, classWidget: WidgetKiosque, id: GUID.getId(), page: IE.estMobile ? {
                            Onglet: EGenreOnglet.ManuelsNumeriques
                        } : null, titre: GTraductions.getValeur('accueil.kiosque.titre'), hint: '', existe: function() {
                            return !this.donnees || (!!this.donnees.kiosque.listeRessources && (this.donnees.kiosque.listeRessources.GetNbrElements() > 0));
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.PrimProfesseur ? 15 : 12, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.lienUtile:
                    return {
                        nomDonnees: 'lienUtile', genre: EGenreWidget.lienUtile, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement || GEtatUtilisateur.pourPrimaire() ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, id: GUID.getId(), classWidget: WidgetLienUtile, titre: GTraductions.getValeur('accueil.lienUtile.titre'), hint: GTraductions.getValeur('accueil.lienUtile.titre'), message: GTraductions.getValeur('accueil.lienUtile.message'), existe: function() {
                            return !this.donnees || (this.donnees.lienUtile.listeLiens && (this.donnees.lienUtile.listeLiens.GetNbrElements() > 0));
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 5 : 3, poids: 1, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.menuDeLaCantine:
                    return {
                        nomDonnees: 'menuDeLaCantine', genre: EGenreWidget.menuDeLaCantine, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, id: GUID.getId(), classWidget: WidgetMenu, page: {
                            Onglet: EGenreOnglet.Menus
                        }, titre: GTraductions.getValeur('accueil.menu'), hint: GTraductions.getValeur('accueil.info.menu'), message: GTraductions.getValeur('accueil.pasDeMenu'), existe: function() {
                            return !this.donnees || this.donnees.menuDeLaCantine.listeRepas;
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 16 : 15, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', semaineSelectionnee: this.numeroSemaineParDefaut
                    };
                case EGenreWidget.notes:
                    return {
                        nomDonnees: 'notes', genre: aGenreWidget, genreColonne: this.genreColonne.notes.genre, classWidget: WidgetNotes, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.DernieresNotes
                        }, titre: GTraductions.getValeur('accueil.dernieresNotes'), hint: GTraductions.getValeur('accueil.info.notes'), message: GTraductions.getValeur('accueil.aucuneNote'), existe: function() {
                            return !this.donnees || this.donnees.notes.listeDevoirs;
                        }, isCollapsible: false, position: 2, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', feminin: true
                    };
                case EGenreWidget.partenaireAgate:
                    return {
                        nomDonnees: 'partenaireAgate', genre: aGenreWidget, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetPartenaireAgate, id: GUID.getId(), titre: GTraductions.getValeur('accueil.agate.titre'), titreDansParametrage: GTraductions.getValeur('accueil.agate.titre'), hint: '', message: GTraductions.getValeur('accueil.agate.msgAucun'), existe: function() {
                            return !this.donnees || this.donnees.partenaireAgate.listePrix;
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 3 : 1, poids: 1, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', avecActualisation: true
                    };
                case EGenreWidget.partenaireARD:
                    return {
                        nomDonnees: 'partenaireArd', genre: aGenreWidget, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetPartenaireARD, id: GUID.getId(), titre: GTraductions.getValeur('accueil.ard.titre'), titreDansParametrage: GTraductions.getValeur('accueil.ard.titre'), hint: '', message: GTraductions.getValeur('accueil.ard.msgAucun'), existe: function() {
                            return this.donnees && this.donnees.partenaireArd && this.donnees.partenaireArd.porteMonnaie;
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 4 : 2, poids: 1, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', avecActualisation: true
                    };
                case EGenreWidget.partenaireCDI:
                    return {
                        nomDonnees: 'partenaireCDI', genre: aGenreWidget, genreColonne: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? this.genreColonne.absencesProf.genre : this.genreColonne.agendaEtInformations.genre, classWidget: WidgetPartenaireCDI, id: GUID.getId(), titre: GTraductions.getValeur('accueil.CDI.titre'), titreDansParametrage: GTraductions.getValeur('accueil.CDI.titre'), hint: '', message: '', existe: function() {
                            return !this.donnees || (this.donnees.partenaireCDI.listeCDI && (this.donnees.partenaireCDI.listeCDI.GetNbrElements() > 0));
                        }, isCollapsible: false, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 2 : 0, poids: 1, classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', avecActualisation: true
                    };
                case EGenreWidget.penseBete:
                    return {
                        nomDonnees: 'penseBete', genre: EGenreWidget.penseBete, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetPenseBete, id: GUID.getId(), titre: GTraductions.getValeur('accueil.penseBete.titre'), hint: '', message: '', position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 0 : 1, poids: 1, tailleFixe: true, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.personnelsAbsents:
                    return {
                        nomDonnees: 'personnelsAbsents', genre: aGenreWidget, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetPersonnelsAbsents, id: GUID.getId(), titre: GTraductions.getValeur('accueil.personnelsAbsents.titre'), hint: '', message: GTraductions.getValeur('accueil.personnelsAbsents.message'), existe: function() {
                            return !this.donnees || (this.donnees.personnelsAbsents.listePersonnelsAbsents);
                        }, isCollapsible: true, nbrItemsVisible: 5, position: GEtatUtilisateur.GenreEspace === EGenreEspace.Etablissement ? 10 : 9, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.Planning:
                    return {
                        genre: EGenreWidget.Planning, genreColonne: this.genreColonne.emploiDuTemps.genre, classWidget: WidgetPlanning, id: GUID.getId(), titreDansParametrage: GTraductions.getValeur('accueil.planning'), dateParDefaut: this.dateParDefaut, existe: function() {
                            return this.donnees && this.donnees.planning && this.donnees.planning.listeRessourcesPlanning && this.donnees.planning.listeRessourcesPlanning.GetNbrElements();
                        }, isCollapsible: false, position: 0, poids: 1, maximise: true, sansReduction: true
                    };
                case EGenreWidget.QCM:
                    return {
                        nomDonnees: 'QCM', genre: EGenreWidget.QCM, genreColonne: this.genreColonne.CDT.genre, classWidget: WidgetQCM, id: GUID.getId(), page: null, titre: GTraductions.getValeur('accueil.executionsQCM'), hint: GTraductions.getValeur('accueil.info.executionsQCM'), message: GTraductions.getValeur('accueil.AucuneExecutionsQCM'), existe: function() {
                            return !this.donnees || (this.donnees.QCM.listeExecutionsQCM && this.donnees.QCM.listeExecutionsQCM.GetNbrElements());
                        }, isCollapsible: false, position: 2, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.ressources:
                    return {
                        nomDonnees: 'ressources', genre: EGenreWidget.ressources, genreColonne: this.genreColonne.emploiDuTemps.genre, id: GUID.getId(), page: null, titre: GEtatUtilisateur.existeGenreOnglet(EGenreOnglet.ProgrammesBO) ? GTraductions.getValeur('accueil.ressources.titreAvecBO') : GTraductions.getValeur('accueil.ressources.titreSansBO'), hint: '', existe: function() {
                            return this.donnees && this.donnees.ressources && this.donnees.ressources.listeMatieres && this.donnees.ressources.listeMatieres.GetNbrElements();
                        }, classWidget: WidgetRessources, isCollapsible: false, position: 11, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', feminin: true, avecScroll: true
                    };
                case EGenreWidget.ressourcePedagogique:
                    return {
                        nomDonnees: 'ressourcePedagogique', genre: aGenreWidget, genreColonne: this.genreColonne.CDT.genre, classWidget: WidgetRessourcePedagogique, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.CDT_Contenu
                        }, titre: GTraductions.getValeur('accueil.ressourcePedagogique.titre'), message: GTraductions.getValeur('accueil.ressourcePedagogique.aucuneRessourcePedagogique'), hint: GTraductions.getValeur('accueil.ressourcePedagogique.info'), existe: function() {
                            return !this.donnees || this.donnees.ressourcePedagogique.listeRessources;
                        }, isCollapsible: false, position: 5, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus', feminin: true
                    };
                case EGenreWidget.RetourEspace:
                    return {
                        nomDonnees: 'retourEspace', genre: EGenreWidget.RetourEspace, classWidget: WidgetRetourEspace, id: GUID.getId(), titre: GTraductions.getValeur('mobile.redirigeVersionMobile'), existe: function() {
                            return window.location.search.search("redirect=1") > 0 && (GApplication.acces.estConnexionCAS() || GApplication.acces.estConnexionCookie()) && GParametres.URLEspace && GEtatUtilisateur.premierChargement;
                        }
                    };
                case EGenreWidget.tableauDeBord:
                    return {
                        genre: EGenreWidget.tableauDeBord, genreColonne: this.genreColonne.tableauDeBord.genre, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.TableauDeBord
                        }, titre: GTraductions.getValeur('accueil.tableauDeBord.titre'), classWidget: WidgetTableauDeBord, position: 0, poids: 1, maximise: true, sansReduction: true, sansGabarit: true, isCollapsible: true
                    };
                case EGenreWidget.travailAFaire:
                    return {
                        nomDonnees: 'travailAFaire', genre: aGenreWidget, genreColonne: this.genreColonne ? this.genreColonne.CDT.genre : null, classWidget: WidgetTAF, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.CDT_TAF
                        }, titre: IE.estMobile ? GTraductions.getValeur('accueil.TAFProchainsJours') : GTraductions.getValeur('accueil.travailAFaire.titre'), hint: GTraductions.getValeur('accueil.info.travailAFaire'), message: GTraductions.getValeur('accueil.aucunTAF'), existe: function() {
                            return !GEtatUtilisateur.pourPrimaire() && (!this.donnees || this.donnees.travailAFaire.listeTAF ? true : false);
                        }, isCollapsible: false, position: 4, poids: 1, selecteurNavigationFleche: '.ElmMatierePourNavigation', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.TAFPrimaire:
                    return {
                        nomDonnees: 'travailAFairePrimaire', genre: EGenreWidget.TAFPrimaire, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.CDT_TAF
                        }, titre: GTraductions.getValeur('accueil.TAFProchainsJours'), message: GTraductions.getValeur('accueil.aucunTAF'), classWidget: WidgetTAFPrimaire, existe: function() {
                            return GEtatUtilisateur.pourPrimaire() && (!!this.donnees.travailAFaire && !!this.donnees.travailAFaire.listeTAF && !!this.donnees.travailAFaire.listeTAF.GetNbrElements());
                        }, isCollapsible: false, dateSelectionnee: this.getDatePremierTaf
                    };
                case EGenreWidget.TAFARendre:
                    return {
                        nomDonnees: 'TAFARendre', genre: EGenreWidget.TAFARendre, genreColonne: this.genreColonne.absencesProf.genre, classWidget: WidgetTAFARendre, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.RessourcePedagogique
                        }, titre: GTraductions.getValeur('accueil.TAFARendre.titre'), hint: '', message: GTraductions.getValeur('accueil.TAFARendre.msgAucun'), existe: function() {
                            return !this.donnees || this.donnees.TAFARendre.listeTAF;
                        }, isCollapsible: false, position: 5, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                case EGenreWidget.vieScolaire:
                    return {
                        nomDonnees: 'vieScolaire', genre: EGenreWidget.vieScolaire, genreColonne: GEtatUtilisateur.pourPrimaire() ? this.genreColonne.absencesProf.genre : this.genreColonne.notes.genre, classWidget: WidgetVieScolaire, id: GUID.getId(), page: {
                            Onglet: EGenreOnglet.VieScolaire_Recapitulatif
                        }, titre: GTraductions.getValeur('accueil.vieScolaire'), hint: GTraductions.getValeur('accueil.info.viescolaire'), message: GTraductions.getValeur('accueil.aucuneAbsence'), existe: function() {
                            return !this.donnees || this.donnees.vieScolaire.listeAbsences;
                        }, isCollapsible: false, position: 1, poids: 1, selecteurNavigationFleche: '[onclick]', classElementFocus: 'ObjetAffichagePageAccueilElementAvecFocus'
                    };
                default:
                    ;
                    break;
            }
        };
        module.exports = ObjetMoteurAccueil;
    },
    fn: "produit/script/objetmoteuraccueil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GUID = require('GUID.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetUtilitaireAbsence = require('ObjetUtilitaireAbsence.js');
        var EGenreWidget = require('Enumere_Widget.js');
        var GHtml = require('GHtml.js');
        var Identite = require('ObjetIdentite.js');
        var UtilitaireWidget = require('UtilitaireWidget.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetMoteurAccueil = require('produit/script/ObjetMoteurAccueil.js');
        MethodesObjet.heritagePrototype(ObjetAccueil, ObjetIdentite_Mobile);

        function ObjetAccueil() {
            this.inheritedCreate(arguments);
            this.moteur = new ObjetMoteurAccueil();
            this.donneesRecues = false;
            this.autorisationVS = null;
            if (GEtatUtilisateur.pourPrimaire()) {
                this.listeGenreWidgets = getListeWidgetsMobilePourPrimaire(GEtatUtilisateur.GenreEspace);
            } else {
                this.listeGenreWidgets = getListeWidgetsMobile(GEtatUtilisateur.GenreEspace);
            }
            this.construireDeclarationsWidgets();
            this.utilitaireAbsence = new ObjetUtilitaireAbsence();
            this.premierChargement = true;
            this.instancesWidgets = {};
            this.genreEvenement = {
                selectionPage: 0,
                saisie: 1
            };
        }

        function getListeWidgetsMobilePourPrimaire(aGenreUtilisateur) {
            var result = [];
            switch (aGenreUtilisateur) {
                case EGenreEspace.Mobile_PrimProfesseur:
                    result.push(EGenreWidget.penseBete, EGenreWidget.RetourEspace, EGenreWidget.lienUtile, EGenreWidget.actualites, EGenreWidget.agenda);
                    break;
                case EGenreEspace.Mobile_PrimParent:
                    result.push(EGenreWidget.RetourEspace, EGenreWidget.lienUtile, EGenreWidget.TAFPrimaire, EGenreWidget.competences, EGenreWidget.vieScolaire, EGenreWidget.EDT, EGenreWidget.actualites, EGenreWidget.agenda);
                    break;
                case EGenreEspace.Mobile_PrimEleve:
                    result.push(EGenreWidget.RetourEspace, EGenreWidget.lienUtile, EGenreWidget.QCM, EGenreWidget.activite, EGenreWidget.TAFPrimaire, EGenreWidget.EDT, EGenreWidget.competences);
                    break;
                case EGenreEspace.Mobile_PrimAccompagnant:
                    result.push(EGenreWidget.RetourEspace, EGenreWidget.lienUtile, EGenreWidget.TAFPrimaire, EGenreWidget.competences, EGenreWidget.vieScolaire, EGenreWidget.EDT);
                    break;
                default:
                    ;
                    break;
            }
            return result;
        }

        function getListeWidgetsMobile(aGenreUtilisateur) {
            var result = [];
            switch (aGenreUtilisateur) {
                case EGenreEspace.Mobile_Eleve:
                    result.push(EGenreWidget.RetourEspace, EGenreWidget.elections, EGenreWidget.lienUtile, EGenreWidget.partenaireCDI, EGenreWidget.partenaireARD, EGenreWidget.DS, EGenreWidget.DSEvaluation, EGenreWidget.QCM, EGenreWidget.travailAFaire, EGenreWidget.enseignementADistance, EGenreWidget.EDT, EGenreWidget.notes, EGenreWidget.competences, EGenreWidget.vieScolaire, EGenreWidget.agenda);
                    break;
                case EGenreEspace.Mobile_Parent:
                    result.push(EGenreWidget.RetourEspace, EGenreWidget.elections, EGenreWidget.lienUtile, EGenreWidget.partenaireCDI, EGenreWidget.partenaireARD, EGenreWidget.DS, EGenreWidget.DSEvaluation, EGenreWidget.travailAFaire, EGenreWidget.enseignementADistance, EGenreWidget.vieScolaire, EGenreWidget.EDT, EGenreWidget.notes, EGenreWidget.competences, EGenreWidget.agenda);
                    break;
                case EGenreEspace.Mobile_Professeur:
                    result.push(EGenreWidget.penseBete, EGenreWidget.RetourEspace, EGenreWidget.elections, EGenreWidget.lienUtile, EGenreWidget.partenaireCDI, EGenreWidget.partenaireARD, EGenreWidget.partenaireAgate, EGenreWidget.EDT, EGenreWidget.personnelsAbsents, EGenreWidget.appelNonFait, EGenreWidget.CDTNonSaisi, EGenreWidget.Intendance_Execute, EGenreWidget.agenda);
                    break;
                case EGenreEspace.Mobile_Administrateur:
                    result.push(EGenreWidget.penseBete, EGenreWidget.RetourEspace, EGenreWidget.elections, EGenreWidget.agenda, EGenreWidget.incidents, EGenreWidget.donneesVS, EGenreWidget.donneesProfs, EGenreWidget.coursNonAssures, EGenreWidget.personnelsAbsents, EGenreWidget.connexionsEnCours, EGenreWidget.Intendance_Execute, EGenreWidget.tachesSecretariat_Execute);
                    break;
                case EGenreEspace.Mobile_Etablissement:
                    result.push(EGenreWidget.penseBete, EGenreWidget.RetourEspace, EGenreWidget.elections, EGenreWidget.EDT, EGenreWidget.lienUtile, EGenreWidget.partenaireCDI, EGenreWidget.incidents, EGenreWidget.coursNonAssures, EGenreWidget.personnelsAbsents, EGenreWidget.appelNonFait, EGenreWidget.Intendance_Execute, EGenreWidget.tachesSecretariat_Execute, EGenreWidget.agenda);
                    break;
                case EGenreEspace.Mobile_Accompagnant:
                    result.push(EGenreWidget.RetourEspace, EGenreWidget.elections, EGenreWidget.lienUtile, EGenreWidget.DS, EGenreWidget.DSEvaluation, EGenreWidget.travailAFaire, EGenreWidget.enseignementADistance, EGenreWidget.vieScolaire, EGenreWidget.EDT, EGenreWidget.notes, EGenreWidget.competences, EGenreWidget.agenda);
                    break;
                default:
                    ;
                    break;
            }
            return result;
        }
        ObjetAccueil.prototype.construireDeclarationsWidgets = function() {
            this.donnees = {};
            for (var i = 0; i < this.listeGenreWidgets.length; i++) {
                var lObjDeclarationWidget = getDeclarationWidget.call(this, this.listeGenreWidgets[i]);
                if (!!lObjDeclarationWidget) {
                    this.donnees[lObjDeclarationWidget.nomDonnees] = lObjDeclarationWidget;
                }
            }
        };

        function getDeclarationWidget(aGenreWidget) {
            this.moteur.setDonnees(this.donnees);
            var result;
            switch (aGenreWidget) {
                case EGenreWidget.EDT:
                    result = {
                        nomDonnees: 'EDT',
                        genre: EGenreWidget.EDT,
                        id: GUID.getId(),
                        titre: GTraductions.getValeur('accueil.prochainsCours'),
                        existe: this.existeWidgetEDT,
                        construire: this.composeCours.bind(this),
                        page: {
                            Onglet: EGenreOnglet.EmploiDuTemps
                        }
                    };
                    break;
                case EGenreWidget.activite:
                case EGenreWidget.actualites:
                case EGenreWidget.aide:
                case EGenreWidget.agenda:
                case EGenreWidget.appelNonFait:
                case EGenreWidget.carnetDeCorrespondance:
                case EGenreWidget.casier:
                case EGenreWidget.CDTNonSaisi:
                case EGenreWidget.conseilDeClasse:
                case EGenreWidget.competences:
                case EGenreWidget.connexionsEnCours:
                case EGenreWidget.coursNonAssures:
                case EGenreWidget.DS:
                case EGenreWidget.DSEvaluation:
                case EGenreWidget.donneesProfs:
                case EGenreWidget.donneesVS:
                case EGenreWidget.elections:
                case EGenreWidget.enseignementADistance:
                case EGenreWidget.incidents:
                case EGenreWidget.Intendance_Execute:
                case EGenreWidget.kiosque:
                case EGenreWidget.lienUtile:
                case EGenreWidget.menuDeLaCantine:
                case EGenreWidget.notes:
                case EGenreWidget.partenaireCDI:
                case EGenreWidget.partenaireAgate:
                case EGenreWidget.partenaireARD:
                case EGenreWidget.penseBete:
                case EGenreWidget.personnelsAbsents:
                case EGenreWidget.QCM:
                case EGenreWidget.ressources:
                case EGenreWidget.ressourcePedagogique:
                case EGenreWidget.RetourEspace:
                case EGenreWidget.tachesSecretariat_Execute:
                case EGenreWidget.travailAFaire:
                case EGenreWidget.TAFARendre:
                case EGenreWidget.TAFPrimaire:
                case EGenreWidget.vieScolaire:
                    result = this.moteur.getDeclarationWidget(aGenreWidget);
                    break;
                default:
                    ;
                    break;
            }
            if (result) {
                if (!result.construire) {
                    result.construire = function() {
                        return '';
                    };
                }
                if (result.classWidget !== undefined) {
                    result.construireInstance = _construireInstanceWidget.bind(this);
                    var lExiste = result.existe;
                    result.existe = function() {
                        return !!result.classWidget && (!lExiste || lExiste.call(this));
                    }.bind(this);
                }
            }
            return result;
        }

        function _construireInstanceWidget(aDonneesWidget) {
            if (this.instancesWidgets[aDonneesWidget.genre]) {
                this.instancesWidgets[aDonneesWidget.genre].free();
            }
            try {
                this.instancesWidgets[aDonneesWidget.genre] = Identite.creerInstance(aDonneesWidget.classWidget, {
                    pere: this
                });
            } catch (e) {
                this.instancesWidgets[aDonneesWidget.genre] = null;
                return;
            }
            Object.assign(this.instancesWidgets[aDonneesWidget.genre], {
                autorisationsVS: this.getAutorisationsVS.bind(this),
                donneesRequete: this.Pere.donneesRequete,
                evenementPage: this.Pere.evenementPage.bind(this.Pere),
                genreEvenement: this.genreEvenement,
                actionSurSaisie: this.Pere.actionSurSaisie.bind(this.Pere),
                dateParDefaut: this.Pere.dateParDefaut,
                NomInterface: this.Pere.Nom,
                numeroSemaineParDefaut: this.Pere.numeroSemaineParDefaut,
                RecupererDonnees: this.Pere.RecupererDonnees.bind(this),
                Valider: this.Valider.bind(this),
                afficherExecutionQCM: function(aExecutionsQCM) {
                    this.callback.appel({
                        executionQCM: aExecutionsQCM
                    });
                }.bind(this)
            });
            try {
                this.instancesWidgets[aDonneesWidget.genre].construire({
                    instance: this,
                    donnees: aDonneesWidget,
                    construireWidget: _construireWidget.bind(this)
                });
            } catch (e) {}
        }
        ObjetAccueil.prototype.getDonneesDeWidget = function(aGenre) {
            var lDeclarationWidget = getDeclarationWidget.call(this, aGenre);
            if (!!lDeclarationWidget && !!lDeclarationWidget.nomDonnees) {
                return this.donnees[lDeclarationWidget.nomDonnees];
            }
            return null;
        };
        ObjetAccueil.prototype._surActualiser = function(aGenre) {
            this.Pere.RecupererDonnees([aGenre]);
        };
        ObjetAccueil.prototype.DetruireInstances = function() {};
        ObjetAccueil.prototype.SetDonnees = function(aDonnees, aNumeroSemaineParDefaut, aDonneesRequete, aDateParDefaut, aAutorisationsVS) {
            $.extend(true, this.donnees, aDonnees);
            this.donneesRecues = true;
            this.moteur.setSemaineSelectionnee(aNumeroSemaineParDefaut);
            this.moteur.setDateParDefaut(aDateParDefaut);
            this.donneesRequete = aDonneesRequete;
            this.autorisationsVS = aAutorisationsVS;
            this.Afficher();
            var $ulCollectionWidgets = $('#' + this.Nom.escapeJQ()).find('ul.collapsible');
            M.Collapsible.init($ulCollectionWidgets, {
                accordion: false
            });
            UtilitaireWidget.setParametres({
                avecFermer: false,
                avecToutVoir: true,
                avecCompteur: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Administrateur, EGenreEspace.Mobile_PrimProfesseur])
            });
            Object.keys(this.donnees).forEach(function(aKey) {
                var lWidget = this.donnees[aKey];
                if (lWidget && lWidget.construireInstance && !!lWidget.existe && lWidget.existe.call(this)) {
                    lWidget.construireInstance(lWidget);
                }
            }.bind(this));
            GEtatUtilisateur.premierChargement = false;
        };

        function _construireWidget(aParams) {
            var lInstanceWidget = this.instancesWidgets[aParams.genre];
            GHtml.setHtml(aParams.id + '_contenu', UtilitaireWidget.composeWidget(aParams, this.Nom), {
                instance: lInstanceWidget || this
            });
            UtilitaireWidget.afficherMasquerListe(aParams);
        }
        ObjetAccueil.prototype.evenementSaisiePage = function(aSaisie) {
            this.callback.appel({
                saisie: aSaisie
            });
        };
        ObjetAccueil.prototype.ConstruireAffichage = function() {
            if (!this.donneesRecues) {
                return '';
            }
            var lHtml = [];
            lHtml.push('<div class="collapsible popout global-mobile-container">');
            var i, lDonnees;
            for (i = 0; i < this.listeGenreWidgets.length; i++) {
                lDonnees = this.getDonneesDeWidget(this.listeGenreWidgets[i]);
                if (lDonnees) {
                    lHtml.push(this.composeSection(lDonnees));
                }
            }
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetAccueil.prototype.composeSection = function(aWidget) {
            var lHtml = [];
            var lNom = this.Nom;

            function _composeCorps(aFonction, aAvecDonnees) {
                var liResult = [];
                liResult.push('<article role="region" aria-labelledby="' + aWidget.id + '_TitreText" class="widget ' + aWidget.nomDonnees.toLowerCase() + '">');
                liResult.push('<div id="' + aWidget.id + '_contenu" class="', 'card-container', (!aAvecDonnees ? ' card-nodata' : ''), '" tabIndex="0">');
                (aWidget.nomDonnees === 'EDT') ? liResult.push('<header>', '<h3 id="' + aWidget.id + '_TitreText">', aWidget.titre, '</h3>', '<div class="cta-conteneur">', '<i role="button" class="as-button bt-widget icon icon_affichage_widget" tabIndex="0" title="' + GTraductions.getValeur('accueil.hint.toutVoir') + '" onclick="' + lNom + '._surToutVoir (' + aWidget.genre + ', false)"></i>', '</div>', '</header>'): '';
                liResult.push((aWidget.nomDonnees === 'EDT') ? '<div class="content-container">' : '', aFonction(), (aWidget.nomDonnees === 'EDT') ? '</div>' : '', '</div>', '</article>');
                return liResult.join('');
            }
            if (!!aWidget && !!aWidget.existe && aWidget.existe.call(this)) {
                var lEstAvecDonnees = aWidget.existeDonnees ? aWidget.existeDonnees.call(this) : true;
                lHtml.push(_composeCorps(aWidget.construire, lEstAvecDonnees));
            }
            return lHtml.join('');
        };
        ObjetAccueil.prototype._surToutVoir = function(aGenre) {
            var lWidget = this.getDonneesDeWidget(aGenre);
            var lPage = lWidget.page;
            if (!!lWidget.dateSelectionnee) {
                var lDateSelectionnee = lWidget.dateSelectionnee.call(this);
                if (!!lDateSelectionnee) {
                    GEtatUtilisateur.setDerniereDate(lDateSelectionnee);
                }
            }
            if (!!lWidget.jourSelectionne) {
                GEtatUtilisateur.setNavigationDate(lWidget.jourSelectionne);
            }
            if (GEtatUtilisateur.listeOngletsInvisibles.indexOf(lPage.Onglet) === -1) {
                this.callback.appel({
                    genreOngletDest: lPage.Onglet
                });
            }
        };
        ObjetAccueil.prototype._surAction = function(aGenre) {
            var lWidget = this.getDonneesDeWidget(aGenre);
            var lPage = lWidget.action;
            if (GEtatUtilisateur.listeOngletsInvisibles.indexOf(lPage.Onglet) === -1) {
                this.callback.appel({
                    genreOngletDest: lPage.Onglet
                });
            }
        };
        ObjetAccueil.prototype.getAutorisationsVS = function() {
            return this.autorisationsVS;
        };
        ObjetAccueil.prototype.Valider = function(aListePJs) {
            var lAvecValidationIncidents = this.donnees.incidents && this.donnees.incidents.listeIncidents && this.donnees.incidents.listeIncidents.existeElementPourValidation();
            var lAvecValidationActualitees = this.donnees.actualites && this.donnees.actualites.listeActualites && this.donnees.actualites.listeActualites.existeElementPourValidation();
            var lAvecValidationVieScolaire = this.donnees.vieScolaire && this.donnees.vieScolaire.listeAbsences && this.donnees.vieScolaire.listeAbsences.existeElementPourValidation();
            var lAvecValidationTravailAFaire = this.donnees.travailAFaire && this.donnees.travailAFaire.listeFichiers && this.donnees.travailAFaire.listeFichiers.existeElementPourValidation();
            if (lAvecValidationActualitees ||
                lAvecValidationVieScolaire ||
                lAvecValidationTravailAFaire ||
                lAvecValidationIncidents) {
                this.callback.appel({
                    saisie: this.genreEvenement.saisie,
                    donnees: this.donnees,
                    pieceJoints: aListePJs
                });
            }
        };
        ObjetAccueil.prototype.composeAucuneDonnees = function(aMessage) {
            return '<div class="no-events"><p>' + aMessage + '</p></div>';
        };
        module.exports = ObjetAccueil;
    },
    fn: "mobile/script/pageaccueil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var MethodesTableau = require('MethodesTableau.js');
        var Requetes = require('CollectionRequetes.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetDeserialiser = require('ObjetDeserialiser.js');
        var EGenreWidget = require('Enumere_Widget.js');

        function ObjetRequetePageAccueil() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageAccueil', ObjetRequetePageAccueil, ObjetRequeteConsultation);
        ObjetRequetePageAccueil.prototype.lancerRequete = function(aDonnees) {
            this.JSON = $.extend({
                avecConseilDeClasse: true
            }, aDonnees);
            return this.appelAsynchrone();
        };
        ObjetRequetePageAccueil.prototype.actionApresRequete = function() {
            var lUtilitaireDeserialisation;
            var lVieScolaire;
            if (this._recupererDonneesWidget(EGenreWidget.vieScolaire) && this.JSONReponse.vieScolaire) {
                this.autorisationsVS = this.JSONReponse.vieScolaire.autorisations;
                var lListeAbsences = new ObjetDeserialiser().listeEvenementsVS(this.JSONReponse.vieScolaire.listeAbsences, true);
                lListeAbsences.libelle = this.JSONReponse.vieScolaire.L;
                lVieScolaire = {
                    listeAbsences: this.JSONReponse.vieScolaire.listeAbsences.getListeElements(function(aElement) {
                        return !MethodesTableau.existe(aElement.GetGenre(), [EGenreRessource.Incident]) || !aElement.mesure || !aElement.mesure.publication || !lListeAbsences.GetElementParNumero(aElement.mesure.GetNumero());
                    })
                };
            }
            var lQCM;
            if (this._recupererDonneesWidget(EGenreWidget.QCM)) {
                lUtilitaireDeserialisation = new ObjetDeserialiser();
                var lListeExecutionsQCM = this.JSONReponse.QCM ? new ObjetListeElements().fromJSON(this.JSONReponse.QCM.listeExecutionsQCM, lUtilitaireDeserialisation._ajouterQCM.bind(lUtilitaireDeserialisation)) : null;
                var lListeExecutionKiosque = this.JSONReponse.QCM ? new ObjetListeElements().fromJSON(this.JSONReponse.QCM.listeDevoirs, this._ajouterDevoir.bind(this)) : null;
                var lListeWidgetQCMKiosque = null;
                if (!!lListeExecutionsQCM || !!lListeExecutionKiosque) {
                    if (!!lListeExecutionsQCM) {
                        lListeWidgetQCMKiosque = lListeExecutionsQCM;
                    } else {
                        lListeWidgetQCMKiosque = new ObjetListeElements();
                    }
                    if (!!lListeExecutionKiosque) {
                        lListeWidgetQCMKiosque.FusionnerListe(lListeExecutionKiosque);
                    }
                }
                lQCM = {
                    listeExecutionsQCM: lListeWidgetQCMKiosque
                };
            }
            var lEDT;
            if (this._recupererDonneesWidget(EGenreWidget.EDT) && this.JSONReponse.ListeCours) {
                lEDT = {
                    listeCours: new ObjetDeserialiser().listeCours(this.JSONReponse),
                    avecCoursAnnule: this.JSONReponse.AvecCoursAnnule,
                    listeAbsRessources: this.JSONReponse.listeAbsRessources || null,
                    joursStage: this.JSONReponse.joursStage || null,
                    disponibilites: this.JSONReponse.disponibilites || null,
                    prefsGrille: this.JSONReponse.prefsGrille || null,
                    absences: this.JSONReponse.absences || null
                };
            }
            var lPlanning;
            if (this._recupererDonneesWidget(EGenreWidget.Planning) && this.JSONReponse.planning) {
                lPlanning = {
                    listeRessourcesPlanning: this.JSONReponse.planning.listeRessourcesPlanning
                };
            }
            if (this._recupererDonneesWidget(EGenreWidget.Agenda) && this.JSONReponse.agenda) {
                this.JSONReponse.agenda.listeEvenements = new ObjetDeserialiser().getListeEvenements(this.JSONReponse.agenda.listeEvenements, true);
            }
            if (this._recupererDonneesWidget(EGenreWidget.Notes) && !!this.JSONReponse.notes && !!this.JSONReponse.notes.listeDevoirs) {
                this.JSONReponse.notes.listeDevoirs.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant)]);
                this.JSONReponse.notes.listeDevoirs.trier();
            }
            if (this._recupererDonneesWidget(EGenreWidget.ressourcePedagogique) && this.JSONReponse.ressourcePedagogique) {
                lUtilitaireDeserialisation = new ObjetDeserialiser();
                this.JSONReponse.ressourcePedagogique.listeRessources.parcourir(function(aEle) {
                    if (aEle && aEle.ressource && aEle.ressource.QCM) {
                        var lTempEle = new ObjetElement();
                        lUtilitaireDeserialisation._ajouterQCM(aEle.ressource, lTempEle);
                        aEle.ressource = lTempEle;
                    }
                });
            }
            if (this._recupererDonneesWidget(EGenreWidget.travailAFaire) && this.JSONReponse.travailAFaire) {
                lUtilitaireDeserialisation = new ObjetDeserialiser();
                this.JSONReponse.travailAFaire.listeTAF.parcourir(function(aEle) {
                    if (aEle && aEle.executionQCM) {
                        var lTempEle = new ObjetElement();
                        lUtilitaireDeserialisation._ajouterQCM(aEle.executionQCM, lTempEle);
                        aEle.executionQCM = lTempEle;
                    }
                });
            }
            if (this._recupererDonneesWidget(EGenreWidget.activite) && this.JSONReponse.activite) {
                lUtilitaireDeserialisation = new ObjetDeserialiser();
                this.JSONReponse.activite.listeActivite.parcourir(function(aEle) {
                    if (aEle && aEle.executionQCM) {
                        var lTempEle = new ObjetElement();
                        lUtilitaireDeserialisation._ajouterQCM(aEle.executionQCM, lTempEle);
                        aEle.executionQCM = lTempEle;
                    }
                });
            }
            var lAutorisationKiosque = !!this.JSONReponse.autorisationKiosque;
            this.callbackReussite.appel({
                message: this.JSONReponse.message,
                QCM: lQCM,
                notes: this.JSONReponse.notes,
                vieScolaire: lVieScolaire,
                actualites: this.JSONReponse.actualites,
                discussions: this.JSONReponse.discussions,
                agenda: this.JSONReponse.agenda,
                menuDeLaCantine: this.JSONReponse.menuDeLaCantine,
                EDT: lEDT,
                planning: lPlanning,
                travailAFaire: this.JSONReponse.travailAFaire,
                travailAFairePrimaire: GEtatUtilisateur.pourPrimaire() ? this.JSONReponse.travailAFaire : undefined,
                casier: this.JSONReponse.casier,
                appelNonFait: this.JSONReponse.appelNonFait,
                CDTNonSaisi: this.JSONReponse.CDTNonSaisi,
                conseilDeClasse: this.JSONReponse.conseilDeClasse,
                ressources: this.JSONReponse.ressources,
                kiosque: this.JSONReponse.kiosque,
                ressourcePedagogique: this.JSONReponse.ressourcePedagogique,
                devoirSurveille: this.JSONReponse.devoirSurveille,
                competences: this.JSONReponse.competences,
                penseBete: this.JSONReponse.penseBete,
                coursNonAssures: this.JSONReponse.coursNonAssures,
                personnelsAbsents: this.JSONReponse.personnelsAbsents,
                devoirSurveilleEvaluation: this.JSONReponse.devoirSurveilleEvaluation,
                carnetDeCorrespondance: this.JSONReponse.carnetDeCorrespondance,
                TAFARendre: this.JSONReponse.TAFARendre,
                intendanceExecute: this.JSONReponse.IntendanceExecute,
                tachesSecretariatExecute: this.JSONReponse.tachesSecretariatExecute,
                lienUtile: this.JSONReponse.lienUtile,
                partenaireCDI: this.JSONReponse.partenaireCDI,
                partenaireAgate: this.JSONReponse.partenaireAgate,
                partenaireArd: this.JSONReponse.partenaireARD,
                incidents: this.JSONReponse.incidents,
                donneesVS: this.JSONReponse.donneesVS,
                donneesProfs: this.JSONReponse.donneesProfs,
                connexionsEnCours: this.JSONReponse.connexionsEnCours,
                elections: this.JSONReponse.elections,
                activite: this.JSONReponse.activite,
                enseignementADistance: this.JSONReponse.enseignementADistance
            }, this.autorisationsVS, lAutorisationKiosque);
        };
        ObjetRequetePageAccueil.prototype._ajouterDevoir = function(aJSON, aDevoir) {
            aDevoir.copieJSON(aJSON);
        };
        ObjetRequetePageAccueil.prototype._recupererDonneesWidget = function(aGenreWidget) {
            if (this.JSON.widgets) {
                return MethodesTableau.existe(aGenreWidget, this.JSON.widgets);
            }
            return true;
        };
        module.exports = ObjetRequetePageAccueil;
    },
    fn: "objetrequetepageaccueil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeStatutCours = {
            EnseignementNormal: 0,
            ConseilDeClasse: 1,
            EnseignementRemplacement: 2,
            EnseignementHistorique: 3,
            EnseignementSuppleant: 4
        };
        module.exports.TypeStatutCours = TypeStatutCours;
        TypeStatutCours.getCouleur = function(aCours) {
            if (!aCours) {
                return '';
            }
            if (!aCours.estAnnule && (aCours.estPermanence || aCours.GetGenre() === TypeStatutCours.EnseignementRemplacement)) {
                return 'blue';
            }
            if (aCours.GetGenre() === TypeStatutCours.ConseilDeClasse) {
                return 'white';
            }
            return 'red';
        };
        TypeStatutCours.getCouleurFond = function(aCours) {
            return aCours && aCours.GetGenre() === TypeStatutCours.ConseilDeClasse ? 'green' : 'white';
        };
    },
    fn: "typestatutcours.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GStyle = require('GStyle.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var TypeStatutCours = require('TypeStatutCours.js').TypeStatutCours;
        var GHtml = require('GHtml.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var UtilitaireVisios = require('UtilitaireVisiosSco.js').UtilitaireVisios;
        var ObjetFenetre = require('ObjetFenetre.js');
        var GUID = require('GUID.js');
        var GChaine = require('GChaine.js');
        var UtilitaireEmploiDuTemps_Mobile = {};
        UtilitaireEmploiDuTemps_Mobile.composeCours = function(aParams) {
            var lParams = Object.assign({
                cours: null,
                indexCours: -1,
                indexCoursM: -1,
                objetDispense: null,
                getNodeCours: '',
                forcerClickCours: false,
                getNodeVisioCours: null
            }, aParams);
            var lCours = lParams.cours;
            var lHtml = [];
            var lElem;
            var lCouleur = lCours.CouleurFond;
            var lLibelleDebut = GDate.FormatDate(lCours.DateDuCours || GDate.placeEnDateHeure(lCours.Debut), '%xh%sh%mm');
            var lLibelleFin = GDate.FormatDate(lCours.DateDuCoursFin ? lCours.DateDuCoursFin : GDate.placeEnDateHeure(lCours.Fin, true), '%xh%sh%mm');
            var lAriaLabel = GTraductions.getValeur('EDT.Cours') + ' : ' + GDate.strDates(lCours.DateDuCours || GDate.placeEnDateHeure(lCours.Debut), lCours.DateDuCoursFin || GDate.placeEnDateHeure(lCours.Fin, true));
            var lIdAriaLabel = GUID.getId();
            var lCliquable = lParams.getNodeCours && (lParams.forcerClickCours || lCours.estRetenue || lCours.estSortiePedagogique);
            lHtml.push('<li role="listitem" aria-labelledby="', lIdAriaLabel, '" tabIndex="0" class="collection-item collection-cours', (lCliquable ? ' with-action' : ''), '"', (lCliquable ? GHtml.composeAttr('ie-node', lParams.getNodeCours, [lParams.indexCours, lParams.indexCoursM]) : ''), '>');
            lHtml.push('<div class="horaire-container">', '<span>' + lLibelleDebut + '</span>', '<span>' + lLibelleFin + '</span>', '</div>');
            lHtml.push('<div class="li-wrapper" style="border-color: ' + lCouleur + ';">');
            if (!!lCours.Statut) {
                lAriaLabel += ' ; ' + lCours.Statut;
                lHtml.push('<div class="statutCoursMobile" style="' + GStyle.composeCouleurFond(TypeStatutCours.getCouleurFond(lCours)) + ';">', '<span style="', GStyle.composeCouleurTexte(TypeStatutCours.getCouleur(lCours)), '">', lCours.Statut, '</span>');
                lHtml.push('</div>');
            }
            var lDejaTraite = false;
            for (var k = 0; k < lCours.ListeContenus.GetNbrElements(); k++) {
                lElem = lCours.ListeContenus.GetElement(k);
                if (!lElem) {
                    continue;
                }
                var lLibelle = lElem.GetLibelle();
                var lLibelleAria = '';
                switch (lElem.GetGenre()) {
                    case EGenreRessource.Matiere:
                        lLibelleAria = GTraductions.getValeur('Matiere');
                        break;
                    case EGenreRessource.Enseignant:
                        lLibelleAria = GTraductions.getValeur('Professeur');
                        break;
                    case EGenreRessource.Classe:
                        lLibelleAria = GTraductions.getValeur('Classe');
                        break;
                    case EGenreRessource.Groupe:
                        lLibelleAria = GTraductions.getValeur('Groupe');
                        break;
                    case EGenreRessource.Salle:
                        lLibelleAria = GTraductions.getValeur('Salle');
                        break;
                    default:
                        break;
                }
                lLibelleAria += ' : ' + lLibelle;
                var lColor = '';
                if (lCours.estRetenue && lElem.estHoraire) {
                    lColor = lCours.CouleurFond;
                } else if (lCours.estSortiePedagogique && lElem.marqueur === 'titreSortie') {
                    lColor = GCouleur.getCouleurContrastee(lCours.CouleurFond, '#FFF');
                } else if (lCours.estSortiePedagogique && lCours.accompagnateurs && lElem.GetGenre() === EGenreRessource.Enseignant) {
                    if (lDejaTraite) {
                        continue;
                    } else {
                        lDejaTraite = true;
                        lLibelle = lCours.accompagnateurs.join(', ');
                    }
                }
                lAriaLabel += ' ; ' + lLibelleAria;
                lHtml.push('<div class="item', (k === 0 ? ' matiere' : ''), '"', lColor ? ' style="' + GStyle.composeCouleurTexte(lColor) + '"' : '', '>');
                lHtml.push(lLibelle);
                lHtml.push('</div>');
            }(lCours.dispenseEleve || !!lCours.listeVisios && lCours.listeVisios.GetNbrElementsExistes() > 0) ? lHtml.push('<div class="dispenses-container">'): '';
            if (!!lCours.listeVisios && lCours.listeVisios.GetNbrElementsExistes() > 0) {
                lAriaLabel += ' ; ' + GTraductions.getValeur('FenetreSaisieVisiosCours.URLAssocieeAuCours');
                var lAttributIeNodeVisios = (!!lParams.getNodeVisioCours ? GHtml.composeAttr('ie-node', lParams.getNodeVisioCours, [lCours.GetNumero()]) : '');
                lHtml.push('<div class="visios-container ', UtilitaireVisios.getNomIconePresenceVisios(), '" ', lAttributIeNodeVisios, '></div>');
            }
            if (lCours.dispenseEleve) {
                lAriaLabel += ' ; ' + (lCours.dispenseEleve.maison ? GTraductions.getValeur('UtilitaireEmploiDuTemps_Mobile.ALaMaison') : GTraductions.getValeur('UtilitaireEmploiDuTemps_Mobile.Dispense')) + ' - ' + lCours.dispenseEleve.GetLibelle();
                lHtml.push(UtilitaireEmploiDuTemps_Mobile.composeImageDispense(lCours, lParams.objetDispense));
            }(lCours.dispenseEleve || !!lCours.listeVisios && lCours.listeVisios.GetNbrElementsExistes() > 0) ? lHtml.push('</div>'): '';
            if (!!lCours.memo) {
                lAriaLabel += ' ; ' + GTraductions.getValeur('EDT.WAI.memo') + ' : ' + lCours.memo;
                lHtml.push('<div>', '<div class="InlineBlock AlignementMilieuVertical Image_ColonnePostIt"></div>', '<div class="InlineBlock AlignementMilieuVertical">', lCours.memo, '</div>', '</div>');
            }
            lHtml.push('</div>');
            lHtml.push('<div id="', lIdAriaLabel, '" class="wai_hidden" aria-label="', lAriaLabel, '"></div>');
            lHtml.push('</li>');
            return lHtml.join('');
        };
        UtilitaireEmploiDuTemps_Mobile.surClicVisioCours = function(aCours) {
            var lVisioCours = null;
            if (!!aCours && !!aCours.listeVisios && aCours.listeVisios.GetNbrElementsExistes() > 0) {
                lVisioCours = aCours.listeVisios.GetPremierElement();
            }
            if (!!lVisioCours && !!lVisioCours.url) {
                var lUrl = lVisioCours.url;
                var lLibelleLien = lVisioCours.libelleLien;
                var lCommentaire = lVisioCours.commentaire;
                var lAvecLibelleLien = (!!lLibelleLien && lLibelleLien.length > 0);
                var lAvecCommentaire = (!!lCommentaire && lCommentaire.length > 0);
                if (lAvecLibelleLien || lAvecCommentaire) {
                    var lCouleurFondBouton = '#f1f1f1;';
                    var lStrLibelleLien = [];
                    lStrLibelleLien.push('<span style="background-color: ', lCouleurFondBouton, ';color: #343434;border: #d1d1d1 1px solid;padding: 0.5rem 1rem; border-radius: 1rem;">');
                    lStrLibelleLien.push('<i class="', UtilitaireVisios.getNomIconePresenceVisios(), ' MargeDroit"></i>');
                    lStrLibelleLien.push(lAvecLibelleLien ? lLibelleLien : GTraductions.getValeur('FenetreSaisieVisiosCours.AccederAuCoursVirtuel'));
                    lStrLibelleLien.push('</span>');
                    var lMessage = [];
                    lMessage.push('<div class="AlignementMilieu">', '<a href="', GChaine.verifierURLHttp(lUrl), '" target="_blank">', (lStrLibelleLien.join('')), '</a>', '</div>');
                    if (lAvecCommentaire) {
                        lMessage.push('<div class="EspaceHaut10">', lCommentaire, '</div>');
                    }
                    var lFenetreLienVisioCours = ObjetFenetre.creerInstance(ObjetFenetre, {
                        pere: this,
                        initialiser: function(aInstance) {
                            aInstance.setOptionsFenetre({
                                modale: true,
                                titre: GTraductions.getValeur('FenetreSaisieVisiosCours.URLAssocieeAuCours'),
                                fermerFenetreSurClicHorsFenetre: true,
                                hauteurEcran_mobile: false
                            });
                        }
                    });
                    lFenetreLienVisioCours.Afficher(lMessage.join(''));
                } else {
                    UtilitaireVisios.ouvrirLienVisioCours(lVisioCours);
                }
            }
        };
        UtilitaireEmploiDuTemps_Mobile.composeImageDispense = function(aCours, aObjet) {
            var lAvecLegende = aObjet && aCours.dispenseEleve.GetLibelle() && !aCours.dispenseEleve.maison;
            if (lAvecLegende) {
                if (!aObjet.legendeDispenses) {
                    aObjet.legendeDispenses = [];
                }
                aObjet.legendeDispenses.push(aCours.dispenseEleve.GetLibelle());
            }
            var lLibelle = aCours.dispenseEleve.maison ? GTraductions.getValeur('UtilitaireEmploiDuTemps_Mobile.ALaMaison') : GTraductions.getValeur('UtilitaireEmploiDuTemps_Mobile.Dispense');
            return ['<div class="cours_pastilledispense', (aCours.dispenseEleve.maison ? ' cours_pastilledispense_maison' : ''), '" role="presentation">', '<div>', '<span>' + lLibelle.toUpperCase(), '</span>', lAvecLegende ? '&nbsp;&nbsp;&nbsp;&nbsp;<div>(' + aObjet.legendeDispenses.length + ')</div>' : '', '</div>', '</div>'].join('');
        };
        UtilitaireEmploiDuTemps_Mobile.composeTrou = function() {
            var lHtml = [];
            lHtml.push('<li class="collection-item collection-absencecours"></li>');
            return lHtml.join('');
        };
        UtilitaireEmploiDuTemps_Mobile.getPlaceDebutCours = function(aCours) {
            return !aCours || aCours.horsHoraire ? -1 : aCours.Debut;
        };
        UtilitaireEmploiDuTemps_Mobile.getPlaceFinCours = function(aCours) {
            var lPlace = aCours.Fin;
            var lJourDebut = Math.floor(aCours.Debut / GParametres.PlacesParJour);
            if (Math.floor(aCours.Fin / GParametres.PlacesParJour) !== lJourDebut) {
                lPlace = lJourDebut * GParametres.PlacesParJour + GParametres.PlacesParJour - 1;
            }
            return lPlace;
        };
        module.exports = UtilitaireEmploiDuTemps_Mobile;
    },
    fn: "utilitaireemploidutemps_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('WidgetEdtMobile.css');
        var ObjetAccueil = require('mobile/script/PageAccueil.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var UtilitaireEmploiDuTemps_Mobile = require('UtilitaireEmploiDuTemps_Mobile.js');
        ObjetAccueil.prototype.existeWidgetEDT = function() {
            return !!this.donnees.EDT && !!this.donnees.EDT.listeCours && !!this.donnees.EDT.listeCours.GetNbrElements();
        };
        ObjetAccueil.prototype.composeCours = function() {
            var lHtml = [];
            var lCours;
            var lIndex = 0;
            var lListe = this.donnees.EDT.listeCours;
            lListe.setTri([ObjetTri.init('DateDuCours')]);
            lListe.trier();
            var lDateCoursPrecedent = null;
            if (lListe.GetNbrElements() > 0) {
                lHtml.push('<ul role="list">');
                var lNbrCoursAffiche = 0;
                for (var i = 0; i < lListe.GetNbrElements() && lIndex < 3; i++) {
                    lCours = lListe.GetElement(i);
                    if (!lCours.estAnnule) {
                        lIndex++;
                        lNbrCoursAffiche++;
                        if (lDateCoursPrecedent === null || lDateCoursPrecedent === undefined || GDate.GetJour(lCours.DateDuCours) > GDate.GetJour(lDateCoursPrecedent)) {
                            if (lDateCoursPrecedent !== null) {
                                lHtml.push('</li>');
                            }
                            lHtml.push('<li role="group" class="as-header"><h4>', GDate.FormatDate(lCours.DateDuCours, '[' + '%JJJ %J %MMMM' + ']'), '</h4></li>');
                        }
                        lDateCoursPrecedent = lCours.DateDuCours;
                        lHtml.push(UtilitaireEmploiDuTemps_Mobile.composeCours({
                            cours: lCours,
                            getNodeVisioCours: 'getNodeVisioCours'
                        }));
                    }
                }
                if (lNbrCoursAffiche === 0) {
                    lHtml.push(this.composeAucuneDonnees(GTraductions.getValeur('accueil.aucunCours')));
                } else {
                    lHtml.push('</li>');
                }
                lHtml.push('</ul>');
            } else {
                lHtml.push(this.composeAucuneDonnees(GTraductions.getValeur('accueil.aucunCours')));
            }
            return lHtml.join('');
        };

        function _getCoursParNumero(aNumeroCours) {
            var lCours = null;
            if (!!this.donnees && !!this.donnees.EDT && !!this.donnees.EDT.listeCours) {
                lCours = this.donnees.EDT.listeCours.GetElementParNumero(aNumeroCours);
            }
            return lCours;
        }
        ObjetAccueil.prototype.getControleur = function(aInstance) {
            return {
                getNodeVisioCours: function(aNumeroCours) {
                    var lCours = _getCoursParNumero.call(aInstance, aNumeroCours);
                    $(this.node).on('click', function() {
                        UtilitaireEmploiDuTemps_Mobile.surClicVisioCours(lCours);
                    });
                }
            };
        };
        module.exports = ObjetAccueil;
    },
    fn: "mobile/script/widget/widgetedt.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');
        var TypeGenreReponseInternetActualite = require('TypeGenreReponseInternetActualite.js').TypeGenreReponseInternetActualite;

        function ObjetRequeteSaisieAccueil() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieAccueil', ObjetRequeteSaisieAccueil, ObjetRequeteSaisie);
        (function() {
            ObjetRequeteSaisieAccueil.prototype.lancerRequete = function(aDonnees) {
                if (aDonnees.actualites && aDonnees.actualites.listeActualites) {
                    var lListeActualites = aDonnees.actualites.listeActualites.getListeElements(function(aElement, aIndice) {
                        return !aElement.estUnDeploiement;
                    });
                    lListeActualites.setSerialisateurJSON({
                        methodeSerialisation: _serialiserActualite.bind(this)
                    });
                    this.JSON.listeActualites = lListeActualites;
                }
                if (aDonnees.vieScolaire && aDonnees.vieScolaire.listeAbsences) {
                    aDonnees.vieScolaire.listeAbsences.setSerialisateurJSON({
                        methodeSerialisation: _serialiserAbsences.bind(this)
                    });
                    this.JSON.listeAbsences = aDonnees.vieScolaire.listeAbsences;
                }
                if (aDonnees.incidents && aDonnees.incidents.listeIncidents) {
                    aDonnees.incidents.listeIncidents.setSerialisateurJSON({
                        methodeSerialisation: function(aElt, aJSON) {
                            aJSON.estVise = aElt.estVise;
                        }
                    });
                    this.JSON.incidents = aDonnees.incidents.listeIncidents;
                }
                return this.appelAsynchrone();
            };
            ObjetRequeteSaisieAccueil.prototype.actionApresRequete = function(aXml, aGenreReponse) {
                this.callbackReussite.appel(aXml, aGenreReponse, this.JSONRapportSaisie);
            };

            function _serialiserActualite(aActualite, aJSON) {
                aJSON.genrePublic = aActualite.genrePublic;
                aJSON.public = aActualite.public;
                aJSON.lue = aActualite.lue;
                aActualite.listeQuestions.setSerialisateurJSON({
                    methodeSerialisation: _serialiserListeQuestions.bind(this)
                });
                aJSON.listeQuestions = aActualite.listeQuestions;
            }

            function _serialiserListeQuestions(aQuestion, aJSON) {
                aJSON.reponse = aQuestion.reponse.toJSONAll();
                aJSON.genreReponse = aQuestion.genreReponse;
                if (aQuestion.genreReponse > TypeGenreReponseInternetActualite.AvecAR && aQuestion.reponse.avecReponse) {
                    aJSON.reponse.valeurReponse = aQuestion.reponse.valeurReponse;
                }
                aJSON.reponse.avecReponse = aQuestion.reponse.avecReponse;
            }

            function _serialiserAbsences(aAbsence, aJSON) {
                aJSON.estLue = aAbsence.estLue;
                aJSON.justification = aAbsence.justification;
                if (!!aAbsence.documents) {
                    aAbsence.documents.setSerialisateurJSON({
                        methodeSerialisation: _surValidation_Fichier.bind(this)
                    });
                    aJSON.documents = aAbsence.documents;
                }
                aJSON.motifParent = aAbsence.motifParent;
                aJSON.parentAAccuseDeReception = aAbsence.parentAAccuseDeReception;
            }

            function _surValidation_Fichier(aElement, aJSON) {
                var lIdFichier = aElement.idFichier !== undefined ? aElement.idFichier : (aElement.Fichier !== undefined ? aElement.Fichier.idFichier : null);
                if (lIdFichier !== null) {
                    aJSON.idFichier = '' + lIdFichier;
                }
                aJSON.url = aElement.url;
            }
        })();
        module.exports = ObjetRequeteSaisieAccueil;
    },
    fn: "objetrequetesaisieaccueil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetAccueil = require('mobile/script/PageAccueil.js');
        var ObjetRequetePageAccueil = require('ObjetRequetePageAccueil.js');
        require('mobile/script/Widget/WidgetEDT.js');
        var ObjetRequeteSaisieAccueil = require('ObjetRequeteSaisieAccueil.js');
        var ObjetElement = require('ObjetElement.js');
        var GDate = require('ObjetDate.js').GDate;
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageAccueilMobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageAccueilMobile() {
            this.inheritedCreate(arguments);
            this.dateParDefaut = GApplication.getDateDemo() ? GApplication.getDateDemo() : GParametres.JourOuvre;
            this.numeroSemaineParDefaut = IE.Cycles.cycleDeLaDate(this.dateParDefaut);
            this.setTraductions();
            this.donneesRequete = {
                dateGrille: null,
                incidents: {
                    numeroSemaine: this.numeroSemaineParDefaut
                },
                donneesVS: {
                    date: GDate.getDateBornee(GDate.aujourdhui)
                },
                donneesProfs: {
                    date: GDate.getDateBornee(GDate.aujourdhui)
                },
                personnelsAbsents: {
                    numeroSemaine: this.numeroSemaineParDefaut
                },
                coursNonAssures: {
                    numeroSemaine: this.numeroSemaineParDefaut
                },
                menuDeLaCantine: {
                    date: this.dateParDefaut
                },
                TAFARendre: {
                    date: this.dateParDefaut
                },
                partenaireCDI: {
                    CDI: new ObjetElement()
                }
            };
        }
        ObjetAffichagePageAccueilMobile.prototype.ConstruireInstances = function() {
            this.identPage = this.Add(ObjetAccueil, this.evenementPage);
        };
        ObjetAffichagePageAccueilMobile.prototype.RecupererDonnees = function(aWidget) {
            if (aWidget) {
                this.donneesRequete.widgets = aWidget;
            }
            this.donneesRequete.dateGrille = GApplication.getDateDemo() ? GApplication.getDateDemo() : GParametres.JourOuvre;
            if (this.actionSurRecupererDonnees !== undefined) {
                new ObjetRequetePageAccueil(this, this.actionSurRecupererDonnees).lancerRequete(this.donneesRequete);
            } else {
                new ObjetRequetePageAccueil(this, this.Pere.actionSurRecupererDonnees.bind(this.Pere)).lancerRequete(this.donneesRequete);
            }
        };
        ObjetAffichagePageAccueilMobile.prototype.actionSurRecupererDonnees = function(aDonnees, aAutorisationsVS) {
            this.DonneesRecues = true;
            this.donnees = aDonnees;
            this.GetInstance(this.identPage).SetDonnees(aDonnees, this.numeroSemaineParDefaut, this.donneesRequete, this.dateParDefaut, aAutorisationsVS);
        };
        ObjetAffichagePageAccueilMobile.prototype.evenementPage = function(aParam) {
            if (aParam.saisie) {
                var lRequete = new ObjetRequeteSaisieAccueil(this, this.actionSurSaisie);
                if (aParam.pieceJoints && aParam.pieceJoints.GetNbrElements()) {
                    lRequete.addUpload({
                        listeFichiers: aParam.pieceJoints
                    });
                }
                lRequete.lancerRequete(this.donnees);
            } else if (aParam.executionQCM) {
                this.callback.appel({
                    genreOnglet: EGenreOnglet.Accueil,
                    executionQCM: aParam.executionQCM
                });
            } else {
                this.callback.appel({
                    genreOnglet: EGenreOnglet.Accueil,
                    genreOngletDest: aParam.genreOngletDest
                });
            }
        };
        ObjetAffichagePageAccueilMobile.prototype.Valider = function() {
            this.GetInstance(this.identPage).Valider();
        };
        ObjetAffichagePageAccueilMobile.prototype.actionSurSaisie = function() {
            this.RecupererDonnees();
        };
        module.exports = ObjetAffichagePageAccueilMobile;
    },
    fn: "mobile/script/interfacepageaccueil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GDate = require('ObjetDate.js').GDate;
        var Identite = require('ObjetIdentite.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeDomaine = require('TypeDomaine.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var GHtml = require('GHtml.js');
        MethodesObjet.heritagePrototype(ObjetCalendrierMobile, Identite);

        function ObjetCalendrierMobile() {
            this.inheritedCreate(arguments);
            this.dateCourante = GDate.getDateCourante();
            this.dateAffichage = GDate.getDateCourante();
            this.idContainerModalCalendrier = 'ContainerModaleCalendrier';
            this.idCalendrier = this.Nom + '_CalendrierMobile';
            this.idJourCourant = this.Nom + '_JourCourant';
            this.idJourPrecedent = this.Nom + '_JourPrecedent';
            this.idJourSuivant = this.Nom + '_JourSuivant';
            this.idSelecteur = this.Nom + '_Selecteur';
            this.cycles = IE.Cycles;
            this.premiereDate = new Date(GParametres.PremiereDate.getTime() + (GDate.DureeJours / 2));
            this.derniereDate = new Date(GParametres.DerniereDate.getTime() + (GDate.DureeJours / 2));
            this.PeriodeDeConsultation = new TypeDomaine(true, this.cycles.nombreCyclesAnneeScolaire());
            this.joursFeries = GParametres.JoursFeries;
            this.joursOuvres = GParametres.JoursOuvres;
            this.avecSelectionJoursFeries = false;
            this.avecSelectionJoursNonOuvres = false;
            this.estSelectionPeriode = false;
            this.actif = true;
        }
        ObjetCalendrierMobile.prototype.dateDansPeriodeDePresence = function(aDate) {
            return this.joursPresence ? this.joursPresence.GetValeur(GDate.getNbrJoursEntreDeuxDates(this.premiereDate, aDate)) : true;
        };

        function _getDateBornee(aDate, aDateMin, aDateMax) {
            if (aDate < aDateMin) {
                return aDateMin;
            }
            if (aDate > aDateMax) {
                return aDateMax;
            } else {
                return aDate;
            }
        }
        ObjetCalendrierMobile.prototype.setInstanceCycles = function(aCycles) {
            if (aCycles) {
                this.cycles = aCycles;
            }
        };
        ObjetCalendrierMobile.prototype.SetDonnees = function(aPeriode, aJoursPresence, aDate) {
            var lDateCourant;
            if (this.estSelectionPeriode) {
                this.PeriodeDeConsultation = aPeriode;
                lDateCourant = ((aDate !== null && aDate !== undefined) ? aDate : new Date((GApplication.getDemo() ? GApplication.getDateDemo() : GDate.getDateCourante()).getTime() + (GDate.DureeJours / 2)));
                this.joursPresence = new TypeDomaine(false, this.cycles.nombreCyclesAnneeScolaire() - 7);
            } else {
                this.PeriodeDeConsultation = aPeriode;
                this.joursPresence = aJoursPresence;
                lDateCourant = ((aDate !== null && aDate !== undefined) ? aDate : (GApplication.getDemo() ? GApplication.getDateDemo() : GDate.getDateCourante()));
            }
            this.premiereDateConsult = this.cycles.dateDebutPremierCycle();
            this.derniereDateConsult = this.avecSelectionJoursNonOuvres ? this.cycles.dateFinDernierCycle() : this.cycles.dateDernierJourOuvreCycle(this.cycles.nombreCyclesAnneeScolaire());
            if (lDateCourant > this.derniereDate) {
                this.setDateCourante(this._getJourSuivantValide(this.derniereDate, true));
            } else if (lDateCourant < this.premiereDate) {
                this.setDateCourante(this._getJourSuivantValide(this.premiereDate, false));
            } else {
                this.setDateCourante(this._getJourSuivantValide(lDateCourant, false) !== null ? this._getJourSuivantValide(lDateCourant, false) : lDateCourant);
            }
            this.setDateAffichage(this.dateCourante);
        };
        ObjetCalendrierMobile.prototype.SetParametres = function(aParam) {
            this.premiereDate = new Date((aParam.premiereDate ? aParam.premiereDate.getTime() : GParametres.PremiereDate.getTime()) + (GDate.DureeJours / 2));
            this.derniereDate = new Date((aParam.derniereDate ? aParam.derniereDate.getTime() : GParametres.DerniereDate.getTime()) + (GDate.DureeJours / 2));
            this.PeriodeDeConsultation = new TypeDomaine(true, this.cycles.nombreCyclesAnneeScolaire());
            this.joursFeries = aParam.joursFeries ? aParam.joursFeries : GParametres.JoursFeries;
            this.joursOuvres = aParam.joursOuvres ? aParam.joursOuvres : GParametres.JoursOuvres;
            this.avecSelectionJoursFeries = aParam.avecSelectionJoursFeries || false;
            this.avecSelectionJoursNonOuvres = aParam.avecSelectionJoursNonOuvres || false;
            this.estSelectionPeriode = aParam.selectionPeriode || false;
            this.icone = aParam.icone || 'icon_calendar';
            this.avecBoutonsPrecedentSuivant = (aParam.avecBoutonsPrecedentSuivant === null || aParam.avecBoutonsPrecedentSuivant === undefined ? true : aParam.avecBoutonsPrecedentSuivant);
        };
        ObjetCalendrierMobile.prototype.RecupererDonnees = function() {};
        ObjetCalendrierMobile.prototype.DetruireInstances = function() {};
        ObjetCalendrierMobile.prototype.setDateAffichage = function(aDate) {
            this.afficherDateCourante = true;
            this.avecDate = true;
            this.dateAffichage = _getDateBornee(aDate, this.premiereDate, this.derniereDate);
            this.moisAffichage = this.dateAffichage.getMonth();
            this.premierLundiDuMoisAff = GDate.GetPremierLundiDuMois(this.dateAffichage.getFullYear(), this.moisAffichage);
        };
        ObjetCalendrierMobile.prototype._estDateNonValide = function(aDate) {
            var lJourDeLaSemaine = GDate.GetJourDeDate(aDate);
            var lJourCourant = GDate.getNbrJoursEntreDeuxDates(this.premiereDateConsult, aDate);
            return !GDate.dateEntreLesDates(aDate, this.premiereDate, this.derniereDate) || (!this.avecSelectionJoursFeries && this.joursFeries.GetValeur(lJourCourant + 1)) || (!this.dateDansPeriodeDePresence(aDate)) || (!this.avecSelectionJoursNonOuvres && !this.joursOuvres.GetValeur((lJourDeLaSemaine % 7) + 1)) || (!this.dateDansPeriodeDeConsultation(aDate));
        };
        ObjetCalendrierMobile.prototype.dateDansPeriodeDeConsultation = function(aDate) {
            return this.PeriodeDeConsultation.GetValeur(this.cycles.cycleDeLaDate(aDate));
        };
        ObjetCalendrierMobile.prototype._getJourSuivantValide = function(aDateCourant, aSenseInverse) {
            var lDateCourant = aDateCourant;
            var lNrJours = aSenseInverse ? -1 : 1;
            if (this._estDateNonValide(lDateCourant) && GDate.dateEntreLesDates(lDateCourant, this.premiereDateConsult, this.derniereDateConsult)) {
                do {
                    lDateCourant = GDate.GetJourSuivant(lDateCourant, lNrJours);
                }
                while (this._estDateNonValide(lDateCourant) && GDate.dateEntreLesDates(lDateCourant, this.premiereDateConsult, this.derniereDateConsult));
            }
            if (this._estDateNonValide(lDateCourant)) {
                return null;
            } else {
                return lDateCourant;
            }
        };
        ObjetCalendrierMobile.prototype._getSemaineSuivanteValide = function(aSenseInverse) {
            var lDateCourant = this.dateCourante,
                lNumeroCycle = this.cycles.cycleDeLaDate(lDateCourant);
            var lIncrement = aSenseInverse ? -1 : 1;
            lDateCourant = aSenseInverse ? this.cycles.dateFinCycle(lNumeroCycle - 1) : this.cycles.dateDebutCycle(lNumeroCycle + 1);
            if (this._estDateNonValide(lDateCourant) && GDate.dateEntreLesDates(GDate.GetJourSuivant(lDateCourant, lIncrement), this.premiereDate, this.derniereDate)) {
                do {
                    lDateCourant = GDate.GetJourSuivant(lDateCourant, lIncrement);
                }
                while (this._estDateNonValide(lDateCourant) && GDate.dateEntreLesDates(lDateCourant, this.premiereDate, this.derniereDate));
            }
            if (this._estDateNonValide(lDateCourant)) {
                lDateCourant = this.dateCourante;
            }
            return _getDateBornee(lDateCourant, this.premiereDateConsult, this.derniereDateConsult);
        };
        ObjetCalendrierMobile.prototype.incrementerJour = function(aSensInverse) {
            if (this.actif === true) {
                var lJourSuivant;
                if (this.estSelectionPeriode) {
                    lJourSuivant = this._getSemaineSuivanteValide(aSensInverse);
                } else {
                    var lNombreJours = aSensInverse ? -1 : 1;
                    lJourSuivant = this._getJourSuivantValide(GDate.GetJourSuivant(this.dateCourante, lNombreJours), aSensInverse);
                }
                if (!!lJourSuivant) {
                    var lInstanceDatePicker = this.getInstanceDatePicker();
                    lInstanceDatePicker.setDate(lJourSuivant);
                }
            }
        };

        function getPeriodeCourante() {
            var lCycleCourant = this.cycles.cycleDeLaDate(this.dateCourante);
            var lDateDeb = this.cycles.dateDebutCycle(lCycleCourant);
            var lDateFin = this.avecSelectionJoursNonOuvres ? this.cycles.dateFinCycle(lCycleCourant) : this.cycles.dateDernierJourOuvreCycle(lCycleCourant);
            return {
                dateDebut: lDateDeb,
                dateFin: lDateFin,
                estJourUnique: lDateDeb === lDateFin,
                estMoisUnique: lDateDeb.getMonth() === lDateFin.getMonth() && lDateDeb.getFullYear() === lDateFin.getFullYear(),
                estAnneeUnique: lDateDeb.getFullYear() === lDateFin.getFullYear()
            };
        }
        ObjetCalendrierMobile.prototype.setDateCourante = function(aDateCourante) {
            this.dateCourante = aDateCourante;
            if (this.estSelectionPeriode) {
                var lPeriodeChaine = [],
                    lPeriode = getPeriodeCourante.call(this);
                var lFormatDateDeb = '%J' + (lPeriode.estMoisUnique ? '' : ' %MMM') + (lPeriode.estAnneeUnique ? '' : ' %AA'),
                    lFormatDateFin = '%J %MMM' + (lPeriode.estAnneeUnique ? '' : ' %AA');
                lPeriodeChaine.push(GTraductions.getValeur('Du'), ' ', GDate.FormatDate(lPeriode.dateDebut, lFormatDateDeb), ' ', GTraductions.getValeur('Au'), ' ', GDate.FormatDate(lPeriode.dateFin, lFormatDateFin));
                $('#' + this.idJourCourant.escapeJQ()).html((this.icone ? '<i class="material-icons ' + this.icone + '" style="margin-right: .3rem;"></i>' : '') + lPeriodeChaine.join(''));
            } else {
                $('#' + this.idJourCourant.escapeJQ()).html((this.icone ? '<i class="material-icons ' + this.icone + '" style="margin-right: .3rem;"></i>' : '') + GDate.FormatDate(this.dateCourante, '%JJJJ %J %MMM %AA'));
            }
            this.setDateAffichage(this.dateCourante);
            this.callback.appel(this.dateCourante, this.dateDansPeriodeDeConsultation(this.dateCourante));
        };
        ObjetCalendrierMobile.prototype.ConstruireAffichage = function() {
            var lStyleWidthButton = 'width:calc(100%';
            if (this.avecBoutonsPrecedentSuivant) {
                lStyleWidthButton += ' - ((34px + 6px) * 2)';
            }
            lStyleWidthButton += ');';
            var lHtml = [];
            lHtml.push('<div id="', this.idCalendrier, '">', '<div style="margin: 0 0.5rem;">', '<button id="', this.idJourCourant, '" class="', (this.actif ? 'triangleGrey' : 'disabled'), ' btn-flat" onclick="', this.Nom, '.ouvrirCalendrier();" style="', lStyleWidthButton, 'text-align:left; overflow:hidden;" ', (this.actif ? '' : 'disabled '), '>&nbsp;</button>', (this.avecBoutonsPrecedentSuivant ? ('<button id="' + this.idJourPrecedent + '" class="' + (this.actif ? '' : 'disabled') + ' btn-flat btn-floating" title="' + GTraductions.getValeur('Mobile.titleBoutonJourPrecedent') + '" onclick="' + this.Nom + '.incrementerJour(true)" ' + (this.actif ? '' : 'disabled ') + '>' + '<i class="material-icons icon_angle_left"></i>' + '</button>' + '<button id="' + this.idJourSuivant + '" class="' + (this.actif ? '' : 'disabled') + ' btn-flat btn-floating" title="' + GTraductions.getValeur('Mobile.titleBoutonJourSuivant') + '" onclick="' + this.Nom + '.incrementerJour(false)" ' + (this.actif ? '' : 'disabled ') + '>' + '<i class="material-icons icon_angle_right"></i>' + '</button>') : ''), '</div>', '<div id="', this.idSelecteur, '" style="display:none;"></div>', '</div>');
            return lHtml.join('');
        };

        function _getTraductionsDatePicker() {
            var lJours = $.map(GTraductions.getValeur('Jours'), function(aEle) {
                return aEle;
            });
            var lJoursCourt = $.map(GTraductions.getValeur('JoursCourt'), function(aEle) {
                return aEle;
            });
            lJours.unshift(lJours.pop());
            lJoursCourt.unshift(lJoursCourt.pop());
            return {
                months: $.map(GTraductions.getValeur('Mois'), function(aEle) {
                    return aEle.toLowerCase();
                }),
                monthsShort: $.map(GTraductions.getValeur('MoisCourt'), function(aEle) {
                    return aEle.toLowerCase();
                }),
                weekdaysFull: lJours,
                weekdaysShort: lJoursCourt,
                weekdaysAbbrev: $.map(lJoursCourt, function(aEle) {
                    return aEle.charAt(0).toUpperCase();
                })
            };
        }

        function _estModalePresenteDansLeDom(aInstanceDatePicker) {
            var result = false;
            if (!!aInstanceDatePicker && aInstanceDatePicker.$modalEl) {
                result = ($('body').find(aInstanceDatePicker.$modalEl).length > 0);
            }
            return result;
        }
        ObjetCalendrierMobile.prototype.getInstanceDatePicker = function() {
            var $datePicker = $('#' + this.idSelecteur.escapeJQ());
            var lInstanceDatePicker = M.Datepicker.getInstance($datePicker);
            if (!!lInstanceDatePicker && !_estModalePresenteDansLeDom(lInstanceDatePicker)) {
                lInstanceDatePicker.destroy();
                lInstanceDatePicker = null;
            }
            if (!lInstanceDatePicker) {
                var $modaleCalendrier = $('#' + this.idContainerModalCalendrier);
                if ($modaleCalendrier.length === 0) {
                    $(ZoneFenetre.getElementZoneFenetre()).append('<div id="' + this.idContainerModalCalendrier + '"></div>');
                    $modaleCalendrier = $('#' + this.idContainerModalCalendrier);
                } else {
                    $modaleCalendrier.empty();
                }
                var lPremiereAnnee = (!!this.premiereDate ? this.premiereDate.getFullYear() : 0);
                var lDerniereAnnee = (!!this.derniereDate ? this.derniereDate.getFullYear() : 0);
                var lAnneesPossibles;
                if (lPremiereAnnee > 0 || lDerniereAnnee > 0) {
                    lAnneesPossibles = [];
                    if (lPremiereAnnee > 0 && lDerniereAnnee > 0) {
                        var lAnneeTemp = lPremiereAnnee;
                        if (lPremiereAnnee > lDerniereAnnee) {
                            lPremiereAnnee = lDerniereAnnee;
                            lDerniereAnnee = lAnneeTemp;
                        }
                        var lAnneeControleDeadLock = (lPremiereAnnee + 10);
                        while (lAnneeTemp <= lDerniereAnnee) {
                            lAnneesPossibles.push(lAnneeTemp);
                            lAnneeTemp++;
                            if (lAnneeTemp > (lAnneeControleDeadLock)) {
                                break;
                            }
                        }
                    } else if (lPremiereAnnee > 0) {
                        lAnneesPossibles.push(lPremiereAnnee);
                    } else {
                        lAnneesPossibles.push(lDerniereAnnee);
                    }
                }
                if (!lAnneesPossibles || lAnneesPossibles.length === 0) {
                    lAnneesPossibles = 1;
                }
                var lThis = this;
                M.Datepicker.init($datePicker, {
                    container: $modaleCalendrier.get(0),
                    defaultDate: this.dateCourante,
                    setDefaultDate: (!!this.dateCourante),
                    firstDay: 1,
                    i18n: _getTraductionsDatePicker(),
                    showDaysInNextAndPreviousMonths: true,
                    minDate: this.premiereDate,
                    maxDate: this.derniereDate,
                    yearRange: lAnneesPossibles,
                    autoClose: true,
                    disableDayFn: function(aDate) {
                        return lThis._estDateNonValide(aDate);
                    },
                    onDraw: function(aParams) {
                        var lPeriodeCourante = null;
                        if (lThis.estSelectionPeriode) {
                            lPeriodeCourante = getPeriodeCourante.call(lThis);
                        }
                        var $modal = aParams.$modalEl;
                        if (lThis.estSelectionPeriode) {
                            var $tdSelected = $modal.find('td.is-selected');
                            $tdSelected.siblings(':not(.is-empty):not(.is-disabled)').addClass('is-selected');
                        }
                        if (lThis.estSelectionPeriode && !!lPeriodeCourante && !lPeriodeCourante.estAnneeUnique && !!aParams.yearTextEl) {
                            var $libelleAnneeCourante = $(aParams.yearTextEl);
                            var lAnneesCourantes = [GDate.FormatDate(lPeriodeCourante.dateDebut, '%AAAA'), ' - ', GDate.FormatDate(lPeriodeCourante.dateFin, '%AAAA')];
                            $libelleAnneeCourante.html(lAnneesCourantes.join(''));
                        }
                        if (!!aParams.dateTextEl) {
                            var $libelleDateCourante = $(aParams.dateTextEl);
                            var lLibelleDateCourante = [];
                            if (aParams.date) {
                                if (lThis.estSelectionPeriode) {
                                    if (!!lPeriodeCourante) {
                                        if (lPeriodeCourante.estMoisUnique) {
                                            lLibelleDateCourante.push(GDate.FormatDate(lPeriodeCourante.dateDebut, '%J'), ' - ', GDate.FormatDate(lPeriodeCourante.dateFin, '%J %MMM'));
                                        } else {
                                            lLibelleDateCourante.push(GDate.FormatDate(lPeriodeCourante.dateDebut, '%J %MMM'), '<br/>', GDate.FormatDate(lPeriodeCourante.dateFin, '%J %MMM'));
                                        }
                                    }
                                } else {
                                    lLibelleDateCourante.push(GDate.FormatDate(aParams.date, '%JJJJ'), '<br/>');
                                    lLibelleDateCourante.push(GDate.FormatDate(aParams.date, '%J %MMM'));
                                }
                            }
                            $libelleDateCourante.html(lLibelleDateCourante.join(''));
                        }
                        var lMoisCourant = aParams.calendars[0].month;
                        var lAnneeCourante = aParams.calendars[0].year;
                        var lOnBloqueClicMoisPrecedent = (!!this.minDate && this.minDate.getFullYear() >= lAnneeCourante && this.minDate.getMonth() >= lMoisCourant);
                        if (lOnBloqueClicMoisPrecedent) {
                            $($modal.find('.month-prev')).click(function(e) {
                                e.stopPropagation();
                            });
                        }
                        var lOnBloqueClicMoisSuivant = (!!this.maxDate && this.maxDate.getFullYear() <= lAnneeCourante && this.maxDate.getMonth() <= lMoisCourant);
                        if (lOnBloqueClicMoisSuivant) {
                            $($modal.find('.month-next')).click(function(e) {
                                e.stopPropagation();
                            });
                        }
                    },
                    onSelect: function(aDate) {
                        lThis.setDateCourante(aDate);
                    },
                    onOpen: function() {
                        var $modalFooter = this.$modalEl.find('.datepicker-footer');
                        if (this.options.autoClose) {
                            $modalFooter.css('display', 'none');
                        } else {
                            $modalFooter.css('display', '');
                        }
                    }
                });
                lInstanceDatePicker = M.Datepicker.getInstance($datePicker);
            }
            return lInstanceDatePicker;
        };
        ObjetCalendrierMobile.prototype.ouvrirCalendrier = function() {
            if (this.actif === true) {
                var lInstanceDatePicker = this.getInstanceDatePicker();
                lInstanceDatePicker.open();
            }
        };
        ObjetCalendrierMobile.prototype.setActif = function(aActif) {
            if ((aActif !== null) && (aActif !== undefined) && (aActif !== this.actif)) {
                this.actif = aActif;
                GHtml.setDisabled(this.idJourCourant, !aActif);
                if (aActif === true) {
                    $('#' + this.idJourCourant.escapeJQ()).addClass("triangleGrey").removeClass("disabled");
                } else {
                    $('#' + this.idJourCourant.escapeJQ()).removeClass("triangleGrey").addClass("disabled");
                }
                if (this.avecBoutonsPrecedentSuivant) {
                    GHtml.setDisabled(this.idJourPrecedent, !aActif);
                    if (aActif === true) {
                        $('#' + this.idJourPrecedent.escapeJQ()).removeClass("disabled");
                    } else {
                        $('#' + this.idJourPrecedent.escapeJQ()).addClass("disabled");
                    }
                    GHtml.setDisabled(this.idJourSuivant, !aActif);
                    if (aActif === true) {
                        $('#' + this.idJourSuivant.escapeJQ()).removeClass("disabled");
                    } else {
                        $('#' + this.idJourSuivant.escapeJQ()).addClass("disabled");
                    }
                }
            }
        };
        module.exports = ObjetCalendrierMobile;
    },
    fn: "objetcalendrier_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetCalendrierMobile = require('ObjetCalendrier_Mobile.js');
        var GDate = require('ObjetDate.js').GDate;
        var TypeDomaine = require('TypeDomaine.js');
        MethodesObjet.heritagePrototype(ObjetCalendrierMobilePN, ObjetCalendrierMobile);

        function ObjetCalendrierMobilePN() {
            this.inheritedCreate(arguments);
        }
        ObjetCalendrierMobilePN.prototype.estVisible = function() {
            return true;
        };
        ObjetCalendrierMobilePN.prototype.SetDonnees = function(aPeriode, aJoursPresence, aDate, aDateCourantExact) {
            var lDateCourant;
            if (this.estCalendrierAnnuel) {
                this.PeriodeDeConsultation = new TypeDomaine(true, this.cycles.nombreCyclesAnneeScolaire());
                lDateCourant = (aDate !== null && aDate !== undefined ? aDate : new Date(GDate.getDateCourante().getTime() + (GDate.DureeJours / 2)));
                this.joursPresence = new TypeDomaine(true, 365);
            } else {
                this.PeriodeDePresence = aPeriode;
                this.PeriodeDeConsultation = GApplication.droits.get(TypeDroits.cours.domaineConsultationEDT);
                this.joursPresence = aJoursPresence;
                lDateCourant = (aDate !== null && aDate !== undefined ? aDate : GDate.getDateCourante());
            }
            this.premiereDateConsult = this.cycles.dateDebutPremierCycle();
            this.derniereDateConsult = this.avecSelectionJoursNonOuvres ? this.cycles.dateFinDernierCycle() : this.cycles.dateDernierJourOuvreCycle(this.cycles.nombreCyclesAnneeScolaire());
            if (lDateCourant > this.derniereDate) {
                this.setDateCourante(this._getJourSuivantValide(this.derniereDate, true));
            } else if (lDateCourant < this.premiereDate) {
                this.setDateCourante(this._getJourSuivantValide(this.premiereDate, false));
            } else {
                this.setDateCourante(this._getJourSuivantValide(lDateCourant, false) !== null && !aDateCourantExact ? this._getJourSuivantValide(lDateCourant, false) : lDateCourant);
            }
            this.setDateAffichage(this.dateCourante);
        };
        module.exports = ObjetCalendrierMobilePN;
    },
    fn: "objetcalendrierpn.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GDate = require('ObjetDate.js').GDate;
        var TypeStatutCours = require('TypeStatutCours.js').TypeStatutCours;

        function ObjetCalculCoursMultiple() {}

        function _estCoursDansGrille(aCours) {
            if (this.parametres.estCoursDansGrille) {
                return this.parametres.estCoursDansGrille(aCours);
            }
            return true;
        }
        ObjetCalculCoursMultiple.prototype.calculer = function(aParametres) {
            var I, lCours, lPlaceDebut, lPlaceFin;
            this.parametres = $.extend({
                listeCours: null,
                avecCoursAnnules: true,
                avecCoursAnnulesSuperposes: true,
                avecCoursPrevus: true,
                getPlaceDebutCours: null,
                getPlaceFinCours: null,
                estCoursDansGrille: null,
                estEDTAnnuel: false
            }, aParametres);
            this.listeCours = this.parametres.listeCours;
            if (this.listeCours.__listeCoursBackup) {
                this.listeCours.ListeElements = this.listeCours.__listeCoursBackup.ListeElements;
                delete this.listeCours.__listeCoursBackup;
            }
            this.listeCours.__listeCoursBackup = MethodesObjet.dupliquer(this.listeCours);
            this.listeCoursMultiples = new ObjetListeElements();
            if (!this.parametres.avecCoursAnnules) {
                this.listeCours.parcourir(function(aCours) {
                    if (aCours.estAnnule) {
                        aCours.Visible = false;
                    }
                });
            }
            if (!this.parametres.avecCoursPrevus) {
                this.listeCours.parcourir(function(aCours) {
                    if (aCours.Visible !== false && !aCours.estAnnule && [TypeStatutCours.EnseignementNormal, TypeStatutCours.EnseignementHistorique, TypeStatutCours.EnseignementSuppleant].indexOf(aCours.GetGenre()) >= 0) {
                        aCours.Visible = false;
                    }
                });
            }
            if (this.parametres.avecCoursAnnules && !this.parametres.avecCoursAnnulesSuperposes) {
                var lTrouveAnnuleInvisble = _rendreInvisibleCoursAnnulesSuperposes.bind(this)();
                while (lTrouveAnnuleInvisble) {
                    lTrouveAnnuleInvisble = _rendreInvisibleCoursAnnulesSuperposes.bind(this)();
                }
            }
            this.placesOccupees = [];
            this.listeCours.parcourir(function(aCours, aIndex) {
                if (aCours.Visible !== false && !aCours.horsHoraire && _estCoursDansGrille.call(this, aCours)) {
                    lPlaceDebut = this.parametres.getPlaceDebutCours(aCours);
                    if (lPlaceDebut >= 0) {
                        lPlaceFin = this.parametres.getPlaceFinCours(aCours);
                        for (var lPlace = lPlaceDebut; lPlace <= lPlaceFin; lPlace++) {
                            if (MethodesObjet.isUndefined(this.placesOccupees[lPlace])) {
                                this.placesOccupees[lPlace] = aIndex;
                            } else {
                                _creationCoursMultiSeances.bind(this)(aIndex);
                                break;
                            }
                        }
                    }
                }
            }.bind(this));
            for (I = 0; I < this.listeCoursMultiples.GetNbrElements(); I++) {
                lCours = this.listeCoursMultiples.GetElement(I);
                if (lCours) {
                    var lTris = [
                        ObjetTri.init(function(D) {
                            return !!D.estAnnule;
                        }), ObjetTri.init(function(D) {
                            return !D.estSortiePedagogique;
                        }), ObjetTri.init(function(D) {
                            return !D.estRetenue;
                        })
                    ];
                    if (this.parametres.estEDTAnnuel) {
                        lTris.push(ObjetTri.init('numeroSemaine'));
                    }
                    lTris.push(ObjetTri.init('Debut'), ObjetTri.init(function(E) {
                        return E.Fin - E.Debut;
                    }), ObjetTri.init(function(E) {
                        return E.Statut ? E.Statut : '';
                    }), ObjetTri.init('Position'), ObjetTri.init('Numero'));
                    lCours.listeCours.setTri(lTris).trier();
                    _calculerPositionnementCouloir.bind(this)(lCours);
                    this.listeCours.AddElement(lCours);
                }
            }
        };

        function _unePlaceEstOccupee(aPlacesCours, aPlacesCouloir) {
            for (var I in aPlacesCours) {
                if (aPlacesCouloir[I]) {
                    return true;
                }
            }
            return false;
        }

        function _calculerPositionnementCouloir(aCoursMultiple) {
            aCoursMultiple.listeCours.nbCouloirs = 0;
            aCoursMultiple.numeroCouloir = 0;
            var lCouloirs = [];
            for (var I = 0; I < aCoursMultiple.listeCours.GetNbrElements(); I++) {
                lCouloirs[I] = [];
            }
            for (I = 0; I < aCoursMultiple.listeCours.GetNbrElements(); I++) {
                var lTabOccupation = [];
                var lCours = aCoursMultiple.listeCours.GetElement(I);
                var lPlaceDebut = this.parametres.getPlaceDebutCours(lCours),
                    lPlaceFin = this.parametres.getPlaceFinCours(lCours);
                for (var lPlace = lPlaceDebut; lPlace <= lPlaceFin; lPlace++) {
                    lTabOccupation[lPlace] = true;
                }
                var lNumeroCouloir = 0;
                while (_unePlaceEstOccupee(lTabOccupation, lCouloirs[lNumeroCouloir])) {
                    lNumeroCouloir++;
                    aCoursMultiple.listeCours.nbCouloirs = Math.max(aCoursMultiple.listeCours.nbCouloirs, lNumeroCouloir + 1);
                }
                for (var J in lTabOccupation) {
                    if (lTabOccupation[J]) {
                        lCouloirs[lNumeroCouloir][J] = true;
                    }
                }
                lCours.numeroCouloir = lNumeroCouloir;
            }
        }

        function _rendreInvisibleCoursAnnulesSuperposes() {
            var I, j, lNb = this.listeCours.GetNbrElements(),
                lCours, lCoursSuperpose, lPlaceOccupees = [];
            for (I = 0; I < lNb; I++) {
                lCours = this.listeCours.GetElement(I);
                var lPlaceDebut = this.parametres.getPlaceDebutCours(lCours),
                    lPlaceFin = this.parametres.getPlaceFinCours(lCours);
                if (lCours.Visible !== false && _estCoursDansGrille.call(this, lCours)) {
                    for (var lPlace = lPlaceDebut; lPlace <= lPlaceFin; lPlace++) {
                        if (MethodesObjet.isUndefined(lPlaceOccupees[lPlace])) {
                            lPlaceOccupees[lPlace] = I;
                        } else {
                            var lCoursSuperposees = _getTableauIndicesCoursSuperposesDeCours.bind(this)(I, lPlaceOccupees);
                            var lAvecCoursAnnule = false,
                                lAvecCoursNormal = false;
                            for (j = 0; j < lCoursSuperposees.length; j++) {
                                lCoursSuperpose = this.listeCours.GetElement(lCoursSuperposees[j]);
                                if (!lAvecCoursNormal) {
                                    lAvecCoursNormal = !lCoursSuperpose.estAnnule;
                                }
                                if (!lAvecCoursAnnule) {
                                    lAvecCoursAnnule = lCoursSuperpose.estAnnule;
                                }
                            }
                            if (lAvecCoursNormal && lAvecCoursAnnule) {
                                for (j = 0; j < lCoursSuperposees.length; j++) {
                                    lCoursSuperpose = this.listeCours.GetElement(lCoursSuperposees[j]);
                                    if (lCoursSuperpose && lCoursSuperpose.estAnnule) {
                                        lCoursSuperpose.Visible = false;
                                        return true;
                                    }
                                }
                            }
                            break;
                        }
                    }
                }
            }
            return false;
        }

        function _getTableauIndicesCoursSuperposesDeCours(aIndiceCours, aPlaceOccupees) {
            var lCours = this.listeCours.GetElement(aIndiceCours);
            var lCoursSuperposees = [aIndiceCours];
            var lPlaceDebut = this.parametres.getPlaceDebutCours(lCours),
                lPlaceFin = this.parametres.getPlaceFinCours(lCours);
            for (var lPlace = lPlaceDebut; lPlace <= lPlaceFin; lPlace++) {
                var lIndiceCours = aPlaceOccupees[lPlace];
                if (!MethodesObjet.isUndefined(lIndiceCours)) {
                    if ((lIndiceCours !== aIndiceCours) && (!MethodesTableau.existe(lIndiceCours, lCoursSuperposees))) {
                        lCoursSuperposees.push(lIndiceCours);
                    }
                }
            }
            return lCoursSuperposees;
        }

        function _creationCoursMultiSeances(aIndiceCours) {
            var lCours = this.listeCours.GetElement(aIndiceCours);
            var lCoursSuperposees = _getTableauIndicesCoursSuperposesDeCours.bind(this)(aIndiceCours, this.placesOccupees);
            var lPlaceDebut = lCours.Debut;
            var lPlaceFin = lCours.Fin;
            var lListeCoursDansCoursMultiple = new ObjetListeElements(),
                lSemaine = lCours.numeroSemaine,
                lRessource = lCours.ressource;
            var lDateDuCoursFin = MethodesObjet.isDate(lCours.DateDuCoursFin) ? lCours.DateDuCoursFin : 0;
            for (var I = 0; I < lCoursSuperposees.length; I++) {
                if (lCoursSuperposees[I] < 0) {
                    var lIndice = -lCoursSuperposees[I] - 1;
                    lCours = this.listeCoursMultiples.GetElement(lIndice);
                    for (var J = 0; J < lCours.listeCours.GetNbrElements(); J++) {
                        lListeCoursDansCoursMultiple.AddElement(lCours.listeCours.GetElement(J));
                    }
                    this.listeCoursMultiples.AddElement(null, lIndice);
                } else {
                    lCours = this.listeCours.GetElement(lCoursSuperposees[I]);
                    var lCoursDuplique = MethodesObjet.dupliquer(lCours);
                    lCoursDuplique.coursOrigine = lCours;
                    lCoursDuplique.indiceCoursOrigine = lCoursSuperposees[I];
                    lCoursDuplique.Visible = true;
                    lListeCoursDansCoursMultiple.AddElement(lCoursDuplique);
                    lCours.Visible = false;
                    lCours.estCoursMS = true;
                    lCours.coursCopie = lCoursDuplique;
                }
                lPlaceDebut = Math.min(lPlaceDebut, lCours.Debut);
                lPlaceFin = Math.max(lPlaceFin, lCours.Fin);
                if (MethodesObjet.isDate(lCours.DateDuCoursFin) && (!lDateDuCoursFin || lCours.DateDuCoursFin > lDateDuCoursFin)) {
                    lDateDuCoursFin = lCours.DateDuCoursFin;
                }
            }
            var lCoursMultiple = new ObjetElement(lCours.GetLibelle(), 0);
            lCoursMultiple.coursMultiple = true;
            lCoursMultiple.place = lPlaceDebut;
            lCoursMultiple.Debut = lCoursMultiple.place;
            lCoursMultiple.Fin = lPlaceFin;
            lCoursMultiple.duree = lPlaceFin - lPlaceDebut + 1;
            lCoursMultiple.CouleurFond = GCouleur.nonEditable.fond;
            lCoursMultiple.numeroSemaine = lSemaine;
            lCoursMultiple.ressource = lRessource;
            lCoursMultiple.DateDuCours = GDate.placeEnDate(lSemaine, lPlaceDebut, false);
            if (lDateDuCoursFin && lDateDuCoursFin.getTime) {
                lCoursMultiple.DateDuCoursFin = new Date(lDateDuCoursFin.getTime());
            }
            lCoursMultiple.listeCours = lListeCoursDansCoursMultiple;
            lCoursMultiple.ListeContenus = new ObjetListeElements();
            this.listeCoursMultiples.AddElement(lCoursMultiple);
            var lIndiceCoursMultiple = this.listeCoursMultiples.GetNbrElements();
            var lPlaceDebutCoursGrille = this.parametres.getPlaceDebutCours(lCoursMultiple),
                lPlaceFinCoursGrille = this.parametres.getPlaceFinCours(lCoursMultiple);
            for (var lPlace = lPlaceDebutCoursGrille; lPlace <= lPlaceFinCoursGrille; lPlace++) {
                this.placesOccupees[lPlace] = -lIndiceCoursMultiple;
            }
        }
        module.exports = ObjetCalculCoursMultiple;
    },
    fn: "objetcalculcoursmultiple.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GHtml = require('GHtml.js');
        var ZoneFenetre = require('IEZoneFenetre.js');

        function FenetrePopUp_Mobile() {
            this.Nom = 'FenetrePopup';
            this.options = {
                noClose: false,
                onOpen: null,
                onCloseStart: null,
                onCloseEnd: null,
                noScroll: true,
                withFixedHeader: true
            };
        }

        function _construireAffichage(aId) {
            return (['<div id="' + aId + '" class="modal" style="height: 70%;">', '<div class="modal-close" style="display:none;"></div>', '<div class="modal-header" style="display:none;"></div>', '<div class="modal-content"></div>', '<div class="modal-footer" style="display:none;"></div>', '</div>']).join('');
        }

        function setPopupHeader(aHtmlTitre, aControleurTitre) {
            var $header = $('#' + this.Nom + ' .modal-header');
            var lAvecHeader = (!!aHtmlTitre && aHtmlTitre.length > 0);
            if (lAvecHeader) {
                var lParams = null;
                if (!!aControleurTitre) {
                    lParams = {
                        controleur: aControleurTitre
                    };
                }
                $header.IEHtml(aHtmlTitre, lParams);
                $header.show();
            } else {
                $header.hide();
            }
            if (lAvecHeader && this.options.withFixedHeader) {
                $('#' + this.Nom).addClass('modal-fixed-header');
            } else {
                $('#' + this.Nom).removeClass('modal-fixed-header');
            }
        }

        function setPopupContent(aHtmlContent, aControleurContent) {
            var lParams = null;
            if (!!aControleurContent) {
                lParams = {
                    controleur: aControleurContent
                };
            }
            $('#' + this.Nom + ' .modal-content').IEHtml(aHtmlContent, lParams);
        }

        function setPopupFooter(aFooter, aControleurFooter) {
            var $footer = $('#' + this.Nom + ' .modal-footer');
            var lAvecFooter = (!!aFooter && aFooter.length > 0);
            if (lAvecFooter) {
                var lParams = null;
                if (!!aControleurFooter) {
                    lParams = {
                        controleur: aControleurFooter
                    };
                }
                var lHtmlFooter = $.isArray(aFooter) ? aFooter.map(function(ele) {
                    return '<button class="modal-action waves-effect ' + (ele.stylePlat !== false ? 'btn-flat' : 'btn') + (!!ele.ferme ? ' modal-close' : '') + (!!ele.aGauche ? ' left' : '') + '"' + (ele.attrSuppl ? ' ' + ele.attrSuppl : '') + '>' + ele.libelle + '</button>';
                }).join('') : aFooter;
                $footer.IEHtml(lHtmlFooter, lParams);
                $footer.show();
            } else {
                $footer.hide();
            }
            if (lAvecFooter) {
                $('#' + this.Nom).addClass('modal-fixed-footer');
            } else {
                $('#' + this.Nom).removeClass('modal-fixed-footer');
            }
        }
        FenetrePopUp_Mobile.prototype.setOptionsPopup = function(aParams) {
            Object.assign(this.options, aParams);
        };
        FenetrePopUp_Mobile.prototype._getInstanceModalePopup = function() {
            var lPopup = $('#' + this.Nom);
            var lInstanceModalePopUp = M.Modal.getInstance(lPopup);
            if (!lInstanceModalePopUp) {
                var lThis = this;
                M.Modal.init(lPopup, {
                    dismissible: !this.options.noClose,
                    onOpenStart: $.isFunction(this.options.onOpen) ? this.options.onOpen : undefined,
                    onCloseStart: $.isFunction(this.options.onCloseStart) ? this.options.onCloseStart : undefined,
                    onCloseEnd: function() {
                        lInstanceModalePopUp.destroy();
                        lInstanceModalePopUp.$el.remove();
                        if ($.isFunction(lThis.options.onCloseEnd)) {
                            lThis.options.onCloseEnd();
                        }
                    },
                    preventScrolling: this.options.noScroll ? true : false
                });
                lInstanceModalePopUp = M.Modal.getInstance(lPopup);
            }
            return lInstanceModalePopUp;
        };
        FenetrePopUp_Mobile.prototype.openPopup = function(aDonneesAffichage) {
            if (!!aDonneesAffichage) {
                if (!GHtml.elementExiste(this.Nom)) {
                    var lElement = GHtml.htmlToDOM(_construireAffichage(this.Nom));
                    GHtml.insererElementDOM(ZoneFenetre.getElementZoneFenetre(), lElement);
                }
                setPopupHeader.call(this, aDonneesAffichage.titre, aDonneesAffichage.titreControleur);
                var lContenu = aDonneesAffichage.contenu || '';
                setPopupContent.call(this, lContenu, aDonneesAffichage.contenuControleur);
                setPopupFooter.call(this, aDonneesAffichage.footer, aDonneesAffichage.footerControleur);
                this._getInstanceModalePopup().open();
            }
        };
        FenetrePopUp_Mobile.prototype.closePopup = function() {
            this._getInstanceModalePopup().close();
        };
        module.exports = FenetrePopUp_Mobile;
    },
    fn: "fenetrepopup_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetCalculCoursMultiple = require('ObjetCalculCoursMultiple.js');
        var UtilitaireEmploiDuTemps_Mobile = require('UtilitaireEmploiDuTemps_Mobile.js');
        var EGenreDirectionSlide = require('EGenreDirectionSlide.js');
        var GHtml = require('GHtml.js');
        var FenetrePopUp_Mobile = require('FenetrePopUp_Mobile.js');
        MethodesObjet.heritagePrototype(ObjetCours_Mobile, ObjetIdentite_Mobile);

        function ObjetCours_Mobile() {
            this.inheritedCreate(arguments);
            this.baseprogressionId = this.Nom + '_progression';
            this.dateActive = null;
            this.callbackPopup = null;
            this.options = {
                estCoursVisible: null,
                forcerClickCours: false
            };
        }
        ObjetCours_Mobile.prototype.setOptions = function(aOptions) {
            Object.assign(this.options, aOptions);
            return this;
        };
        ObjetCours_Mobile.prototype.getControleur = function(aInstance) {
            return {
                getNodeCours: function(aIndex, aIndexMS) {
                    $(this.node).on('click', function() {
                        var lCours = aInstance.listeCours.GetElement(aIndex);
                        if (aIndexMS >= 0 && lCours && lCours.listeCours) {
                            lCours = lCours.listeCours.GetElement(aIndexMS);
                            if (aInstance.options.forcerClickCours === true) {
                                aInstance.modale.closePopup();
                            }
                        };
                        aInstance.callback.appel(lCours);
                    });
                },
                getNodeCoursMultiple: function(aIndex) {
                    $(this.node).on('click', function() {
                        _popupCoursMultiple.call(aInstance, aIndex);
                    });
                },
                getNodeVisioCours: function(aNumeroCours) {
                    var lCours = aInstance.listeCours.GetElementParNumero(aNumeroCours);
                    $(this.node).on('click', function() {
                        UtilitaireEmploiDuTemps_Mobile.surClicVisioCours(lCours);
                    });
                }
            };
        };
        ObjetCours_Mobile.prototype.SetDonnees = function(aDate, aListeCours, aAvecCoursAnnule, aCallbackPopup) {
            if (aListeCours) {
                this.listeCours = aListeCours;
            }
            if (aAvecCoursAnnule) {
                this.avecCoursAnnule = aAvecCoursAnnule;
            }
            if (aCallbackPopup) {
                this.callbackPopup = aCallbackPopup;
            }
            var lSensInverse = !this.dateActive || GDate.estDateEgale(aDate, this.dateActive) ? EGenreDirectionSlide.Aucune : (aDate < this.dateActive ? EGenreDirectionSlide.Droite : EGenreDirectionSlide.Gauche);
            new ObjetCalculCoursMultiple().calculer({
                listeCours: this.listeCours,
                avecCoursAnnules: this.avecCoursAnnule,
                avecCoursAnnulesSuperposes: !GEtatUtilisateur.estEspacePourEleve(),
                getPlaceDebutCours: function(aCours) {
                    return UtilitaireEmploiDuTemps_Mobile.getPlaceDebutCours(aCours);
                }.bind(this),
                getPlaceFinCours: function(aCours) {
                    return UtilitaireEmploiDuTemps_Mobile.getPlaceFinCours(aCours);
                }.bind(this)
            });
            this.listeCours.trier();
            this.dateActive = aDate;
            this.Afficher(null, lSensInverse);
        };
        ObjetCours_Mobile.prototype.slideProgression = function(aPositionCours) {
            $("#" + (this.baseprogressionId + aPositionCours).escapeJQ()).toggleClass('progDiv-open');
        };

        function _popupCoursMultiple(aIndice) {
            var lCoursMultiple = this.listeCours.GetElement(aIndice);
            var lContenu = [];
            lContenu.push('<ul class="collection collection-listecours" style="margin:0;">');
            for (var i = 0; i < lCoursMultiple.listeCours.GetNbrElements(); i++) {
                lContenu.push(UtilitaireEmploiDuTemps_Mobile.composeCours({
                    cours: lCoursMultiple.listeCours.GetElement(i),
                    indexCours: parseInt(aIndice),
                    indexCoursM: i,
                    getNodeCours: 'getNodeCours',
                    forcerClickCours: this.options.forcerClickCours
                }));
            }
            lContenu.push('</ul>');
            this.modale = new FenetrePopUp_Mobile();
            this.modale.setOptionsPopup({
                onCloseEnd: this.callbackPopup
            });
            var lTitreModale = [];
            lTitreModale.push('<h2>');
            lTitreModale.push(GChaine.Format(GTraductions.getValeur('EDT.coursMultipleEntreEt'), [lCoursMultiple.listeCours.GetNbrElements(), GDate.FormatDate(GDate.placeEnDateHeure(lCoursMultiple.Debut), '%xh%sh%mm'), lCoursMultiple.DateDuCoursFin ? lCoursMultiple.DateDuCoursFin : GDate.FormatDate(GDate.placeEnDateHeure(lCoursMultiple.Fin, true), '%xh%sh%mm')]));
            lTitreModale.push('</h2>');
            this.modale.openPopup({
                titre: lTitreModale.join(''),
                contenu: lContenu.join(''),
                contenuControleur: this.controleur,
                footer: [{
                    libelle: GTraductions.getValeur('Fermer'),
                    ferme: true
                }]
            });
        }
        ObjetCours_Mobile.prototype.composeCoursMultiple = function(aCoursMultiple, aIndice) {
            var lHtml = [];
            var lLibelleDebut = GDate.FormatDate(GDate.placeEnDateHeure(aCoursMultiple.Debut), '%xh%sh%mm');
            var lLibelleFin = GDate.FormatDate(aCoursMultiple.DateDuCoursFin || GDate.placeEnDateHeure(aCoursMultiple.Fin, true), '%xh%sh%mm');
            var lCouleur = "#C7C7C7";
            lHtml.push('<li class="collection-item collection-cours with-action"', GHtml.composeAttr('ie-node', 'getNodeCoursMultiple', [aIndice]), '>');
            lHtml.push('<div style="border-left:solid 5px ' + lCouleur + ';">');
            lHtml.push('<span class="Gras Texte12" style="position:absolute;top:3%;left:-3.4rem;">' + lLibelleDebut + '</span>');
            lHtml.push('<span class="Gras Texte12" style="position:absolute;bottom:3%;left:-3.4rem;">' + lLibelleFin + '</span>');
            lHtml.push('<div>');
            lHtml.push(GChaine.Format(GTraductions.getValeur('EDT.seancesDifferentes'), [aCoursMultiple.listeCours.GetNbrElements(), GDate.FormatDate(GDate.placeEnDate(0, aCoursMultiple.Debut), '%JJJJ'), GDate.FormatDate(GDate.placeEnDate(0, aCoursMultiple.Debut), '%xh%sh%mm'), GDate.FormatDate(GDate.placeEnDate(0, aCoursMultiple.Fin, true), '%xh%sh%mm')]));
            lHtml.push('</a>');
            lHtml.push('</li>');
            return lHtml.join('');
        };
        ObjetCours_Mobile.prototype.ConstruireAffichage = function() {
            if (!this.listeCours) {
                return '';
            }
            var lCours;
            var lPasDeCours = true;
            var lHtml = [];
            var lFinPrecedent = -1;
            var lPremierCours = true;
            var lObjetCours = {};
            lHtml.push('<ul class="collection collection-listecours">');
            if (this.listeCours.GetNbrElements() > 0) {
                for (var i = 0; i < this.listeCours.GetNbrElements(); i++) {
                    lCours = this.listeCours.GetElement(i);
                    if ((lCours.coursMultiple && this.options.estCoursVisible(lCours.listeCours.GetElement(0)) ||
                            this.options.estCoursVisible(lCours)) && ((this.avecCoursAnnule && lCours.estAnnule) || !lCours.estAnnule)) {
                        if (lCours.horsHoraire) {
                            lHtml.push(UtilitaireEmploiDuTemps_Mobile.composeTrou());
                        } else if ((lPremierCours && lCours.Debut % GParametres.PlacesParJour !== 0 && lCours.Visible !== false) || (lFinPrecedent !== -1 && lFinPrecedent + 1 !== lCours.Debut && lCours.Visible !== false)) {
                            lHtml.push(UtilitaireEmploiDuTemps_Mobile.composeTrou());
                        }
                        if (lCours.coursMultiple) {
                            lPasDeCours = false;
                            lHtml.push(this.composeCoursMultiple(lCours, i));
                        } else if (lCours.Visible !== false) {
                            lPasDeCours = false;
                            lHtml.push(UtilitaireEmploiDuTemps_Mobile.composeCours({
                                cours: lCours,
                                indexCours: i,
                                objetDispense: lObjetCours,
                                getNodeCours: 'getNodeCours',
                                forcerClickCours: this.options.forcerClickCours,
                                getNodeVisioCours: 'getNodeVisioCours'
                            }));
                        }
                        lFinPrecedent = lCours.Fin;
                        if (lPremierCours) {
                            lPremierCours = false;
                        }
                    }
                }
            }
            if (!lPasDeCours && lCours.Debut + GParametres.PlacesParJour % GParametres.PlacesParJour !== 0) {
                lHtml.push(UtilitaireEmploiDuTemps_Mobile.composeTrou());
            }
            lHtml.push('</ul>');
            if (lObjetCours.legendeDispenses) {
                lObjetCours.legendeDispenses.forEach(function(aLegende, aIndex) {
                    lHtml.push('<div>', '(', aIndex + 1, ') ', aLegende, '</div>');
                });
            }
            if (lPasDeCours) {
                lHtml = [this.composeAucuneDonnee(GTraductions.getValeur('Mobile.AucunCours'))];
            }
            return lHtml.join('');
        };
        ObjetCours_Mobile.prototype.DeclencherEvenement = function(aNumeroCours) {
            this.callback.appel(this.listeCours.GetElementParNumero(aNumeroCours));
        };
        module.exports = ObjetCours_Mobile;
    },
    fn: "objetcours_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GStyle = require('GStyle.js');
        var GDate = require('ObjetDate.js').GDate;
        var Identite = require('ObjetIdentite.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeStatutCours = require('TypeStatutCours.js').TypeStatutCours;
        MethodesObjet.heritagePrototype(ObjetFicheCours_Mobile, Identite);

        function ObjetFicheCours_Mobile() {
            this.inheritedCreate(arguments);
            this.coursOrigine = null;
        }
        ObjetFicheCours_Mobile.prototype.ConstruireAffichage = function() {
            return '';
        };
        ObjetFicheCours_Mobile.prototype.Compose = function() {
            var H = '';
            H += '<div>';
            for (var I = 0; I < this.ListeCours.GetNbrElements(); I++) {
                if (this.ListeCours.GetNbrElements() === 1 || this.coursOrigine.tronque || this.ListeCours.GetElement(I).GetNumero() !== this.coursOrigine.GetNumero()) {
                    H += this.ComposeCours(this.ListeCours.GetElement(I));
                }
            }
            H += '</div>';
            return H;
        };

        function _getListeContenusDeGenre(aCours, aGenre) {
            return aCours.ListeContenus.getListeElements(function(D) {
                return D.GetGenre() === aGenre;
            });
        }
        ObjetFicheCours_Mobile.prototype.ComposeCours = function(ACours) {
            var H = '';
            H += this.ComposeBandeau(ACours);
            H += '<div style="padding: 0.3em 0.5em">';
            H += this.ComposeLibelle(ACours.ListeMatieres, this.NbrMatieres, this.coursPourComparaison.ListeMatieres, ACours);
            H += this.ComposeLibelle(_getListeContenusDeGenre(ACours, EGenreRessource.Enseignant), this.NbrProfesseurs, _getListeContenusDeGenre(this.coursPourComparaison, EGenreRessource.Enseignant), ACours);
            H += this.ComposeLibelle(_getListeContenusDeGenre(ACours, EGenreRessource.Classe), this.NbrClasses, _getListeContenusDeGenre(this.coursPourComparaison, EGenreRessource.Classe), ACours);
            H += this.ComposeLibelle(_getListeContenusDeGenre(ACours, EGenreRessource.Groupe), this.NbrGroupes, _getListeContenusDeGenre(this.coursPourComparaison, EGenreRessource.Groupe), ACours);
            H += this.ComposeLibelle(_getListeContenusDeGenre(ACours, EGenreRessource.PartieDeClasse), _getListeContenusDeGenre(this.coursPourComparaison, EGenreRessource.PartieDeClasse), ACours);
            H += this.ComposeLibelle(_getListeContenusDeGenre(ACours, EGenreRessource.Salle), this.NbrSalles, _getListeContenusDeGenre(this.coursPourComparaison, EGenreRessource.Salle), ACours);
            H += (ACours.strSite ? '<div>' + ACours.strSite + '</div>' : '');
            H += '</div>';
            return H;
        };
        ObjetFicheCours_Mobile.prototype.getSousTitre = function(ACours) {
            var lHeureDebut = GDate.FormatDate(GDate.PlaceParJourEnDate(ACours.place % GParametres.PlacesParJour), '%hh%sh%mm');
            var lHeureFin = GDate.FormatDate(GDate.PlaceParJourEnDate((ACours.place + ACours.duree) % GParametres.PlacesParJour), '%hh%sh%mm');
            return GTraductions.getValeur('EDT.CoursDu') + ' ' + GDate.FormatDate(ACours.DateDuCours, '%JJ/%MM') + ' ' + GTraductions.getValeur('De') + ' ' + lHeureDebut + ' ' + GTraductions.getValeur('A') + ' ' + lHeureFin;
        };
        ObjetFicheCours_Mobile.prototype.ComposeBandeau = function(ACours) {
            var H = '';
            if (ACours.Statut) {
                H += '<div class="FicheCours_Statut_' + ACours.Genre + '" style="' + GStyle.composeCouleurTexte(TypeStatutCours.getCouleur(ACours)) + ';border:#e0e0e0 1px solid;">' + '<div class="Gras">' + ACours.Statut + '</div>';
            } else {
                H += '<div class="">';
            }
            H += '<div class="' + (!GDate.estDateEgale(ACours.DateDuCours, this.coursPourComparaison.DateDuCours) ? 'Gras' : '') + '">';
            H += this.getSousTitre(ACours);
            H += '</div>';
            H += '</div>';
            return H;
        };
        ObjetFicheCours_Mobile.prototype.ComposeLibelle = function(AListeElements, N, aListeComparaison, aCours) {
            var lClasse = '';
            var T = [];
            if (N) {
                for (var I = 0; I < N; I++) {
                    if (I < AListeElements.GetNbrElements()) {
                        var LElement = AListeElements.GetElement(I);
                        if (aListeComparaison && !aListeComparaison.GetElementParElement(LElement)) {
                            lClasse = aCours.estAnnule ? 'Barre' : 'Gras';
                        }
                        if (LElement.GetLibelle()) {
                            T.push('<div class="Texte12 ' + lClasse + ' ' + (LElement.GetGenre() === 1 ? ' Barre' : '') + '">' + LElement.GetLibelle() + '</div>');
                        }
                    } else {
                        T.push('<div class="Texte12">&nbsp;</div>');
                    }
                }
            }
            return T.join('');
        };
        ObjetFicheCours_Mobile.prototype.SetDonnees = function(AListeCours, aCoursOrigine) {
            this.setTraductions(GTraductions.getValeur('CahierDeTexte'));
            this.ListeCours = AListeCours;
            if (aCoursOrigine) {
                this.coursOrigine = aCoursOrigine;
            }
            this.SetNbrRessources();
            for (var I = 0; I < this.ListeCours.GetNbrElements(); I++) {
                if (this.ListeCours.GetElement(I).GetNumero() === this.coursOrigine.GetNumero()) {
                    this.coursPourComparaison = this.ListeCours.GetElement(I);
                }
            }
        };
        ObjetFicheCours_Mobile.prototype.Afficher = function(aFonctionClose) {
            var lHtml = [];
            lHtml.push('<div>');
            lHtml.push(this.Compose());
            lHtml.push('</div>');
            GInterface.setPopupHeader('<h1></h1>');
            GInterface.setPopupFooter('');
            GInterface.setPopupContent(lHtml.join(''));
            GInterface.openPopup({
                onClose: aFonctionClose
            });
        };
        ObjetFicheCours_Mobile.prototype.SetNbrRessources = function() {
            this.NbrMatieres = 0;
            this.NbrProfesseurs = 0;
            this.NbrClasses = 0;
            this.NbrGroupes = 0;
            this.NbrSalles = 0;
            for (var I = 0; I < this.ListeCours.GetNbrElements(); I++) {
                var LCours = this.ListeCours.GetElement(I);
                LCours.ListeMatieres = new ObjetListeElements();
                LCours.ListeMatieres.AddElement(LCours.matiere);
                this.NbrMatieres = Math.max(this.NbrMatieres, _getListeContenusDeGenre(LCours, EGenreRessource.Matiere).GetNbrElements());
                this.NbrProfesseurs = Math.max(this.NbrProfesseurs, _getListeContenusDeGenre(LCours, EGenreRessource.Enseignant).GetNbrElements());
                this.NbrGroupes = Math.max(this.NbrGroupes, _getListeContenusDeGenre(LCours, EGenreRessource.Groupe).GetNbrElements());
                this.NbrSalles = Math.max(this.NbrSalles, _getListeContenusDeGenre(LCours, EGenreRessource.Salle).GetNbrElements());
            }
        };
        module.exports = ObjetFicheCours_Mobile;
    },
    fn: "objetfichecours_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteFicheCours() {
            this.inheritedCreate(arguments);
            this.setOptions({
                gererMessageErreur: null
            });
        }
        Requetes.inscrire('FicheCours', ObjetRequeteFicheCours, ObjetRequeteConsultation);
        ObjetRequeteFicheCours.prototype.lancerRequete = function(aParametres) {
            this.JSON = $.extend({
                cours: null,
                numeroSemaine: null,
                ressource: null,
                estEDTAnnuel: undefined
            }, aParametres);
            return this.appelAsynchrone();
        };
        ObjetRequeteFicheCours.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequeteFicheCours;
    },
    fn: "objetrequetefichecours.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreMessage = {
            SelectionClasse: 0,
            SelectionGroupe: 1,
            SelectionEleve: 2,
            SelectionService: 3,
            SelectionAppreciation: 4,
            SelectionPeriode: 5,
            AucunElevePourPeriode: 6,
            AucunService: 7,
            AucunAppreciation: 8,
            PasDeNotes: 9,
            SelectionClasseOuGroupe: 10,
            AucunElevePourClasse: 11,
            SelectionPilier: 12,
            AucunClassePourPilier: 13,
            AucunPilierPourEleve: 14,
            AucunBulletinPourEleve: 15,
            AucunRelevePourEleve: 16,
            AucunConseilPourEleve: 17,
            AucunClassePourProfesseur: 18,
            AucunMatierePourClasseProf: 19,
            SelectionPalier: 20,
            AucunPalier: 21,
            SelectionMatiere: 22,
            AucunMatiere: 23,
            SelectionCompetence: 24,
            SelectionSalle: 25,
            AucunElevePourGroupe: 26,
            SelectionDisciplineLivret: 27,
            AucuneDiciplineLivret: 28,
            SelectionProfesseur: 29,
            AucuneClasseDisponible: 30,
            AucunBulletinDeCompetencesPourEleve: 31,
            AucuneSalleDisponible: 32,
            SelectionPersonnel: 33,
            SelectionMateriel: 34,
            AucunMaterielDisponible: 35,
            AucunePeriodes: 36,
            SelectionSousMatiere: 37
        };
        module.exports = EGenreMessage;
    },
    fn: "enumere_message.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetDeserialiser = require('ObjetDeserialiser.js');

        function ObjetRequetePageEmploiDuTemps() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageEmploiDuTemps', ObjetRequetePageEmploiDuTemps, ObjetRequeteConsultation);
        ObjetRequetePageEmploiDuTemps.prototype.lancerRequete = function(aParametres) {
            this.JSON = $.extend({
                ressource: undefined,
                listeRessources: undefined,
                numeroSemaine: undefined,
                dateDebut: undefined,
                dateFin: undefined,
                ignorerHeures: undefined,
                domaine: undefined,
                matiere: undefined,
                niveau: undefined,
                dossierProgression: undefined,
                elementProgression: undefined,
                avecAbsencesEleve: false,
                avecConseilDeClasse: false,
                estEDTPermanence: false,
                estEDTAnnuel: undefined,
                avecAbsencesRessource: undefined,
                avecDisponibilites: undefined,
                avecRessourcesLibrePiedHoraire: undefined
            }, aParametres);
            if (aParametres.ressource) {
                this.JSON.Ressource = aParametres.ressource;
            }
            if (this.JSON.listeRessources) {
                this.JSON.listeRessources.setSerialisateurJSON({
                    ignorerEtatsElements: true
                });
            }
            if ((aParametres.domaine !== null && aParametres.domaine !== undefined)) {
                this.JSON.Domaine = aParametres.domaine;
            } else if ((aParametres.numeroSemaine !== null && aParametres.numeroSemaine !== undefined)) {
                this.JSON.NumeroSemaine = aParametres.numeroSemaine;
            } else if (!aParametres.estEDTAnnuel) {
                this.JSON.DateDebut = aParametres.dateDebut;
                this.JSON.ignorerHeures = aParametres.ignorerHeures;
                if ((aParametres.dateFin !== null && aParametres.dateFin !== undefined)) {
                    this.JSON.DateFin = aParametres.dateFin;
                }
            }
            return this.appelAsynchrone();
        };
        ObjetRequetePageEmploiDuTemps.prototype.actionApresRequete = function() {
            this.JSONReponse.listeCours = new ObjetDeserialiser().listeCours(this.JSONReponse);
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequetePageEmploiDuTemps;
    },
    fn: "objetrequetepageemploidutemps.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequetePageEmploiDuTemps_DomainePresence() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageEmploiDuTemps_DomainePresence', ObjetRequetePageEmploiDuTemps_DomainePresence, ObjetRequeteConsultation);
        ObjetRequetePageEmploiDuTemps_DomainePresence.prototype.lancerRequete = function(aRessource) {
            this.JSON.Ressource = aRessource;
            return this.appelAsynchrone();
        };
        ObjetRequetePageEmploiDuTemps_DomainePresence.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse.Domaine, this.JSONReponse.joursPresence);
        };
        module.exports = ObjetRequetePageEmploiDuTemps_DomainePresence;
    },
    fn: "objetrequetepageemploidutemps_domainepresence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var GDate = require('ObjetDate.js').GDate;

        function UtilitaireEDTSortiePedagogique() {}
        UtilitaireEDTSortiePedagogique.strDate = function(aAbs) {
            if (!aAbs) {
                return '';
            }
            if (aAbs.strDateFin) {
                return aAbs.strDateDebut + ' ' + aAbs.strDateFin;
            }
            return GTraductions.getValeur('Le') + ' ' + GDate.FormatDate(aAbs.DateDuCours, '%JJ/%MM') + ' ' + aAbs.strDateDebut;
        };
        module.exports = UtilitaireEDTSortiePedagogique;
    },
    fn: "utilitaireedtsortiepedagogique.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeEnsembleNombre = require('TypeEnsembleNombre.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GDate = require('ObjetDate.js').GDate;

        function UtilitairePrefsGrilleStructure() {}
        UtilitairePrefsGrilleStructure.modeles = {
            defaut: -1,
            perso: -2
        };
        UtilitairePrefsGrilleStructure.getGenreRessource = function(aRessources) {
            var lGenreRessource = null;
            if (aRessources && aRessources.GetNbrElements() > 0) {
                aRessources.parcourir(function(aRessource) {
                    var lGenreRessourceCourante = aRessource.GetGenre();
                    if (GEtatUtilisateur.pourPrimaire() && (lGenreRessourceCourante === EGenreRessource.Groupe || lGenreRessourceCourante === EGenreRessource.Eleve)) {
                        lGenreRessourceCourante = EGenreRessource.Classe;
                    }
                    if (lGenreRessource === null) {
                        lGenreRessource = lGenreRessourceCourante;
                    } else if (lGenreRessource !== lGenreRessourceCourante) {
                        lGenreRessource = null;
                        return false;
                    }
                });
            }
            return lGenreRessource;
        };
        UtilitairePrefsGrilleStructure.getPrefsGrille = function(aGenreRessource, aEstPlanning, aNumeroEtablisssement) {
            var lPrefs;
            var lNumeroModele = UtilitairePrefsGrilleStructure.modeles.defaut;
            var lGenreRessource = aGenreRessource && aGenreRessource.GetNbrElements ? UtilitairePrefsGrilleStructure.getGenreRessource(aGenreRessource) : aGenreRessource;
            if (lGenreRessource !== null && lGenreRessource !== EGenreRessource.Aucune) {
                lPrefs = GApplication.parametresUtilisateur.get(UtilitairePrefsGrilleStructure.getCleModelePrefsGrille(aGenreRessource, aEstPlanning));
                if (lPrefs && lPrefs.joursOuvres) {
                    lNumeroModele = lPrefs.modele;
                }
            }
            if (lNumeroModele === UtilitairePrefsGrilleStructure.modeles.perso) {
                var lNbJours = IE.Cycles.indicesJoursOuvres().length;
                lPrefs.joursOuvres.items().forEach(function(aIndice) {
                    if (aIndice >= lNbJours) {
                        lPrefs.joursOuvres.remove(aIndice);
                    }
                });
                return lPrefs;
            } else {
                lPrefs = null;
                var lNumeroEtablissement = null;
                if (lNumeroModele === UtilitairePrefsGrilleStructure.modeles.defaut) {
                    lNumeroEtablissement = aNumeroEtablisssement;
                } else {
                    lNumeroEtablissement = lNumeroModele;
                }
                if (GEtatUtilisateur.tabEtablissementsModeleGrille) {
                    GEtatUtilisateur.tabEtablissementsModeleGrille.forEach(function(aModeleEtab) {
                        if (aModeleEtab.numero === lNumeroEtablissement) {
                            lPrefs = aModeleEtab;
                            return false;
                        }
                    });
                }
                if (lPrefs) {
                    return lPrefs;
                }
            }
            return UtilitairePrefsGrilleStructure.getPrefsGrilleDefaut();
        };
        UtilitairePrefsGrilleStructure.getPrefsGrilleDefaut = function() {
            var lJoursOuvres = new TypeEnsembleNombre();
            IE.Cycles.indicesJoursOuvres().forEach(function(aJour, aIndice) {
                lJoursOuvres.add(aIndice);
            });
            return {
                placeDebut: 0,
                placeFin: GParametres.PlacesParJour - 1,
                nbPas: 1,
                joursOuvres: lJoursOuvres
            };
        };
        UtilitairePrefsGrilleStructure.getCleModelePrefsGrille = function(aGenreRessource, aEstPlanning) {
            return 'EDT.Prefs.' + (aEstPlanning ? 1 : 0) + '.' + (aGenreRessource || EGenreRessource.Enseignant);
        };
        UtilitairePrefsGrilleStructure.getDomaineJoursOuvresDePrefsGrille = function(aPrefGrille) {
            var lJoursOuvres = MethodesObjet.dupliquer(GParametres.JoursOuvres);
            if (!aPrefGrille) {
                return lJoursOuvres;
            }
            lJoursOuvres.getSemaines().forEach(function(aJour, aIndex) {
                if (aPrefGrille.joursOuvres.items().indexOf(aIndex) < 0) {
                    lJoursOuvres.SetValeur(false, aJour);
                }
            });
            return lJoursOuvres;
        };
        UtilitairePrefsGrilleStructure.getProchaineDateOuvreeDePrefsGrille = function(aDate, aPrefGrille) {
            var lResult = {
                date: aDate,
                trouve: false,
                dateChangee: false
            };
            if (!aPrefGrille) {
                return lResult;
            }
            while (!lResult.trouve && GDate.estDateDansAnneeScolaire(lResult.date)) {
                var lJourCycle = IE.Cycles.dateEnJourCycle(lResult.date);
                if (aPrefGrille.joursOuvres.indexOf(lJourCycle) < 0) {
                    lResult.date = GDate.GetJourSuivant(lResult.date);
                    lResult.dateChangee = true;
                } else {
                    lResult.trouve = true;
                }
            }
            return lResult;
        };
        module.exports = UtilitairePrefsGrilleStructure;
    },
    fn: "utilitaireprefsgrillestructure.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('Produit/Css/ObjetBoutonFlottant.css');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GUID = require('GUID.js');

        function ObjetBoutonFlottant() {
            this.inheritedCreate(arguments);
            this.IdBouton = GUID.getId();
            _initOptionsBouton.call(this);
            this.iconeCommandeDefaut = 'icon_ellipsis_vertical';
            this.positionHorizontalDefaut = "";
            this.positionVerticalDefaut = "bottom";
        }
        MethodesObjet.heritagePrototype(ObjetBoutonFlottant, Identite);
        var _initOptionsBouton = function() {
            this._optionsBouton = {
                fluide: false,
                retractable: false,
                position: {
                    vertical: 'bottom',
                    horizontal: ''
                },
                listeBoutons: [{
                    primaire: false,
                    icone: 'icon_diffuser_information',
                    callback: '',
                    libelle: '',
                    disabled: false,
                    boutons: [{
                        icone: '',
                        callback: '',
                        libelle: '',
                        disabled: false
                    }]
                }]
            };
        };
        ObjetBoutonFlottant.prototype.setOptionsBouton = function(aOptions) {
            $.extend(this._optionsBouton, aOptions);
        };
        ObjetBoutonFlottant.prototype.getOptionsBouton = function() {
            return this._optionsBouton;
        };
        ObjetBoutonFlottant.prototype.Actualiser = function(lParam) {
            if (!!lParam) {
                this.setOptionsBouton(lParam);
            }
            this.Afficher();
        };
        ObjetBoutonFlottant.prototype.getControleur = function(aInstance) {
            return {
                nodeBtn: function(aIndex) {
                    var lBouton = aInstance._optionsBouton.listeBoutons[aIndex];
                    if (!!lBouton) {
                        $(this.node).eventValidation(lBouton.callback);
                    }
                },
                nodeBtnCommande: function(aIndexCommande, aIndex) {
                    var lBouton = aInstance._optionsBouton.listeBoutons[aIndexCommande].boutons[aIndex];
                    if (!!lBouton) {
                        $(this.node).eventValidation(lBouton.callback);
                    }
                }
            };
        };
        ObjetBoutonFlottant.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            if (_validerListeBouton.call(this)) {
                lHtml.push('<div class="floating-btn-position', _getClassPosition.call(this), (this._optionsBouton.fluid) ? 'fluid ' : '', (this._optionsBouton.retractable) ? 'togglable ' : '', '">', '<div class="float-global-conteneur">');
                lHtml.push(this.composeBoutons());
                lHtml.push('</div>', '</div>');
            }
            return lHtml.join('');
        };

        function _getClassPosition() {
            var lHtml = [];
            var lHorizontal = (this._optionsBouton.position && this._optionsBouton.position.horizontal) ? this._optionsBouton.position.horizontal : this.positionHorizontalDefaut;
            var lVertical = (this._optionsBouton.position && this._optionsBouton.position.vertical) ? this._optionsBouton.position.vertical : this.positionVerticalDefaut;
            lHtml.push(lHorizontal ? 'h-' + lHorizontal : "");
            lHtml.push(lVertical ? 'v-' + lVertical : "");
            return lHtml.join(' ');
        }

        function _validerListeBouton() {
            if (this._optionsBouton.listeBoutons.length === 0) {
                return false;
            } else if (!!this._optionsBouton.listeBoutons && !Array.isArray(this._optionsBouton.listeBoutons)) {
                return false;
            }
            return true;
        }

        function _validerParametreBouton(lBouton) {
            if (!!lBouton.boutons && !Array.isArray(lBouton.boutons)) {
                return false;
            }
            if (!lBouton.icone) {
                return false;
            }
            return true;
        }
        ObjetBoutonFlottant.prototype.composeUnSeulBouton = function(aBouton, aIndex) {
            var lHtml = [];
            if (_validerParametreBouton(aBouton)) {
                var aIdBtn = GUID.getId();
                lHtml.push('<input type="checkbox" id="', aIdBtn, '" class="on-off" />', '<label for="', aIdBtn, '" id="', this.IdBouton, '" ie-node="nodeBtn(', aIndex, ')" class="as-button ', (!!aBouton.disabled) ? 'disabled ' : '', (aBouton.primaire) ? 'primary ' : '', '">', '<i class="icon ', aBouton.icone, '"></i>', '</label>');
            }
            return lHtml.join('');
        };
        ObjetBoutonFlottant.prototype.composeBoutonCommande = function(aListeBouton, aIndexBoutonCommande) {
            var lHtml = [];
            var lIdBtn = GUID.getId();
            lHtml.push('<input type="checkbox" id="', lIdBtn, '" class="on-off" />', '<label for="', lIdBtn, '" class="as-button primary command', (!!aListeBouton.disabled) ? ' disabled' : '', (this._optionsBouton.fluid) ? ' more' : '', '">', '<i class="icon ', (aListeBouton.icone) ? aListeBouton.icone : this.iconeCommandeDefaut, '"></i>', '</label>', '<ul class="sub-float-menu">');
            aListeBouton.boutons.forEach(function(aBouton, aIndex) {
                if (_validerParametreBouton(aBouton)) {
                    lIdBtn = GUID.getId();
                    lHtml.push('<li', (aBouton.callback) ? 'ie-node="nodeBtnCommande(' + aIndexBoutonCommande + ',' + aIndex + ')"' : "", '"', (!!aBouton.disabled) ? ' class= "disabled "' : '', '">', (aBouton.libelle) ? '<label>' + aBouton.libelle + '</label>' : '', '<i class="icon ', aBouton.icone, '"></i>', '</li>');
                }
            });
            lHtml.push('</ul>');
            return lHtml.join('');
        };
        ObjetBoutonFlottant.prototype.composeBoutons = function() {
            var lHtml = [];
            var lInstance = this;
            this._optionsBouton.listeBoutons.forEach(function(aBouton, aIndex) {
                if (!!aBouton.boutons && aBouton.boutons.length > 0) {
                    lHtml.push(lInstance.composeBoutonCommande(aBouton, aIndex));
                } else {
                    lHtml.push(lInstance.composeUnSeulBouton(aBouton, aIndex));
                }
            });
            return lHtml.join(' ');
        };
        module.exports = ObjetBoutonFlottant;
    },
    fn: "objetboutonflottant.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteGenerationPDF() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('GenerationPDF', ObjetRequeteGenerationPDF, ObjetRequeteConsultation);
        ObjetRequeteGenerationPDF.prototype.lancerRequete = function(aParametres, aOptionsPDF) {
            this.JSON = {
                options: {}
            };
            $.extend(this.JSON, aParametres);
            $.extend(this.JSON.options, aOptionsPDF);
            return this.appelAsynchrone();
        };
        ObjetRequeteGenerationPDF.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse.url);
        };
        module.exports = ObjetRequeteGenerationPDF;
    },
    fn: "objetrequetegenerationpdf.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteGenerationPDF = require('ObjetRequeteGenerationPDF.js');
        var Invocateur = require('Invocateur.js').Invocateur;
        var GChaine = require('GChaine.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var GTraductions = require('ObjetTraduction.js');
        var GenerationPDF = {};
        GenerationPDF.genererPDF = function(aParam) {
            var lWindowPDF = null,
                lParametresPDF = aParam.paramPDF,
                lAvecProblemeOuvertureWindow = GNavigateur.isAndroid || GApplication.estAppliMobile;
            if (!lAvecProblemeOuvertureWindow) {
                var EGenreMessageHtml = require('Enumere_MessageHtml.js').EGenreMessageHtml;
                var UtilitaireMessageHtml = require('Enumere_MessageHtml.js').UtilitaireMessageHtml;
                lWindowPDF = window.open(UtilitaireMessageHtml.construireUrl(EGenreMessageHtml.patiencePDF));
            }
            new ObjetRequeteGenerationPDF(this, _actionSurRequeteGenerationPDF.bind(this, lAvecProblemeOuvertureWindow, lWindowPDF), _surEchecRequetePDF.bind(this, lWindowPDF)).lancerRequete(lParametresPDF, aParam.optionsPDF);
        };

        function _actionSurRequeteGenerationPDF(aAvecProblemeOuvertureWindow, aWindowPDF, aUrl) {
            if (!aUrl) {
                if (aWindowPDF && aWindowPDF.close) {
                    aWindowPDF.close();
                }
                return GApplication.getMessage().afficher({
                    message: GTraductions.getValeur('requete.erreur')
                });
            }
            var lUrl = GChaine.encoderUrl(aUrl);
            if (!aAvecProblemeOuvertureWindow) {
                if (aWindowPDF && aWindowPDF.location) {
                    var lTimeout = null;
                    aWindowPDF.onbeforeunload = function() {
                        clearTimeout(lTimeout);
                    };
                    lTimeout = setTimeout(function() {
                        if (!aWindowPDF.location.href || !aWindowPDF.location.href.endsWith || !aWindowPDF.location.href.endsWith(lUrl)) {
                            if (aWindowPDF.close) {
                                aWindowPDF.close();
                            }
                            Invocateur.evenement('OuvrirFenetreLienPDF', lUrl);
                        }
                    }, 2000);
                    aWindowPDF.location.href = lUrl;
                } else {
                    window.open(lUrl);
                }
            } else {
                Invocateur.evenement('OuvrirFenetreLienPDF', lUrl);
            }
        }

        function _surEchecRequetePDF(aWindowPDF, aMessage) {
            var lMessage = aMessage && (aMessage.length > 0) ? aMessage : GTraductions.getValeur('requete.erreur');
            GApplication.getMessage().Afficher(EGenreBoiteMessage.Information, null, lMessage);
            if (aWindowPDF && aWindowPDF.close) {
                aWindowPDF.close();
            }
        }
        module.exports = GenerationPDF;
    },
    fn: "utilitairegenerationpdf.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGestionRenvoisImp = {
            impRenvoisAucun: 0,
            impRenvoisSousBloc: 1,
            impRenvoisApresPage: 2,
            impRenvoisCumulesALaFin: 3
        };
        module.exports.TypeGestionRenvoisImp = TypeGestionRenvoisImp;
    },
    fn: "typegestionrenvoisimp.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGestionRenvoisImp = require('TypeGestionRenvoisImp.js').TypeGestionRenvoisImp;
        var EGenreCouleurTexte_EDT = {
            aucune: 0,
            fond: 1,
            texte: 2
        };
        var OptionsPDF = {};
        OptionsPDF.defaut = {
            portrait: true,
            taillePolice: 8
        };
        OptionsPDF.EDT = Object.assign({
            portrait: false,
            taillePolice: 8,
            taillePoliceMin: 3,
            couleur: EGenreCouleurTexte_EDT.fond,
            renvoi: TypeGestionRenvoisImp.impRenvoisAucun,
            uneGrilleParSemaine: false,
            inversionGrille: false,
            ignorerLesPlagesSansCours: false
        });
        OptionsPDF.BulletinReleve = {
            portrait: true,
            taillePolice: 6.5,
            taillePoliceMin: 5,
            taillePolicePied: 6.5,
            taillePolicePiedMin: 5,
            hauteurServiceMin: 10,
            hauteurServiceMax: 15
        };
        OptionsPDF.Bulletin = Object.assign({
            adapterHauteurService: false
        }, OptionsPDF.BulletinReleve);
        module.exports = {
            OptionsPDF: OptionsPDF,
            EGenreCouleurTexte_EDT: EGenreCouleurTexte_EDT
        };
    },
    fn: "optionspdf.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var OptionsPDF = require('OptionsPDF.js').OptionsPDF;
        OptionsPDF.EDT = Object.assign(OptionsPDF.EDT, {
            estEDTAnnuel: false
        });
        OptionsPDF.LivretScolaire = Object.assign({
            avecGraphe: false,
            portrait: false
        });
        OptionsPDF.Bulletin = Object.assign({
            piedMonobloc: true,
            gererRectoVerso: false,
            desEleves: false
        }, OptionsPDF.Bulletin);
        OptionsPDF.ReleveDeNotes = Object.assign({
            avecPolices: true,
            libelleGroupePolices: ''
        }, OptionsPDF.BulletinReleve);
        OptionsPDF.BulletinDeCompetences = Object.assign({
            gererRectoVerso: false,
            adapterHauteur: false,
            avecGraphe: false,
            desEleves: false,
            taillePoliceMin: 5,
            taillePolicePied: 6.5,
            taillePolicePiedMin: 5
        }, OptionsPDF.defaut);
        OptionsPDF.ReleveDeCompetences = Object.assign({
            desEleves: false
        }, OptionsPDF.defaut);
        OptionsPDF.RecapitulatifMensuelAbsences = Object.assign({
            avecDetailMotifs: true
        }, OptionsPDF.defaut);
        module.exports = OptionsPDF;
    },
    fn: "optionspdfsco.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeHttpGenerationPDFSco = {
            EDT: 0,
            ReleveDeNotes: 1,
            Bulletin: 2,
            LivretScolaire: 3,
            LivretScolaire_Appreciations: 4,
            Resultats: 5,
            Trombinoscope: 6,
            NiveauxDeMaitriseParMatiere: 7,
            FeuilleAppel: 8,
            EquipePedagogique: 9,
            ListeStagiaires: 10,
            CertificatScolarite: 11,
            ListeRessources: 12,
            ResultatsQCM: 13,
            MenuCantine: 14,
            Agenda: 15,
            FicheBrevet: 16,
            BulletinBIA: 17,
            RecapAbsences: 18,
            AppreciationsProfBulletin: 19,
            RecapPunitionSanction: 20,
            RecapFeuilleAppel: 21,
            GraphiqueProfil: 22,
            BulletinDeCompetences: 23,
            ParcoursEducatifCompetences: 24,
            CarnetDeCorrespondance: 25,
            BilanFinDeCycle: 26,
            Attestation: 27,
            RecapMensuelAbsences: 28,
            Etiquettes: 29,
            ResultatsClasse: 30,
            ReleveDeCompetences: 31,
            PyramideDesAges: 32,
            SuiviElevesTutores: 33,
            AppreciationsProf: 34,
            DocumentTelechargeable: 35,
            DocumentTelechargeableMembre: 36,
            TableauDeBord: 37,
            RecapDemandeInscription: 38
        };
        module.exports.TypeHttpGenerationPDFSco = TypeHttpGenerationPDFSco;
    },
    fn: "typehttpgenerationpdfsco.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var EGenreEvenement_ObjetSelection = {
            avantSelection: 0,
            selectionElement: 1
        };
        var EGenreBouton_ObjetSelection = {
            precedent: 0,
            suivant: 1,
            selecteur: 2
        };
        MethodesObjet.heritagePrototype(ObjetSelection, Identite);

        function ObjetSelection() {
            this.inheritedCreate(arguments);
            this.idSelecteur = this.Nom + '_SelecteurMobile';
            this.idElementCourant = this.Nom + '_ElementCourant';
            this.idElementPrecedent = this.Nom + '_ElementPrecedent';
            this.idElementSuivant = this.Nom + '_ElementSuivant';
            this.idListeSelection = this.Nom + '_ListeObjetSelection';
            this.identList = this.Nom + '_ZoneListe';
            this.listeRessources = new ObjetListeElements();
            this.elementCourant = new ObjetElement();
            this.indice = 0;
            this.InteractionUtilisateur = false;
            this.options = {
                genreTri: EGenreTriElement.Croissant,
                styles: '',
                avecEvenementAvantSelection: false,
                icone: 'icon_calendar',
                avecBoutonsPrecedentSuivant: true,
                clbckSurPrecSuivant: null,
                height: null,
                getTitre: null
            };
            this.actif = true;
        }
        ObjetSelection.prototype._getInstanceModale = function() {
            var $objetSelection = $("#" + this.identList.escapeJQ());
            var lInstanceObjetSelection = M.Modal.getInstance($objetSelection);
            if (!lInstanceObjetSelection) {
                M.Modal.init($objetSelection, {});
                lInstanceObjetSelection = M.Modal.getInstance($objetSelection);
            }
            return lInstanceObjetSelection;
        };
        ObjetSelection.prototype.afficherModaleListe = function() {
            if ((this.listeRessources === null) || (this.listeRessources === undefined) || (this.listeRessources.GetNbrElements() === 0) || (this.listeRessources.GetNbrElements() === 1)) {
                return;
            } else {
                this._getInstanceModale().open();
            }
        };
        ObjetSelection.prototype.fermerModaleListe = function() {
            var lInstanceModale = this._getInstanceModale();
            if (lInstanceModale.isOpen) {
                lInstanceModale.close();
            }
        };
        ObjetSelection.prototype.getControleur = function(aInstance) {
            return {
                getNodeSelecteur: function() {
                    if (GHtml.elementExiste(aInstance.identList)) {
                        $('#' + aInstance.identList.escapeJQ()).remove();
                    }
                    GHtml.addHtml(ZoneFenetre.getElementZoneFenetre(), ['<div id="', aInstance.identList, '" style="max-width:95%;" class="modal">', aInstance.composeListe(), '</div>'].join(''));
                    $(this.node).on('destroyed', function() {
                        if (GHtml.elementExiste(aInstance.identList)) {
                            $('#' + aInstance.identList.escapeJQ()).remove();
                        }
                    });
                }
            };
        };
        ObjetSelection.prototype.estVisible = function() {
            return true;
        };
        ObjetSelection.prototype.SetParametres = function(aParam) {
            Object.assign(this.options, aParam);
        };
        ObjetSelection.prototype.SetDonnees = function(aListeRessources, aIndiceParDefaut) {
            this.listeRessources = aListeRessources;
            this.donneesRecues = true;
            this.Afficher();
            if (aIndiceParDefaut === null || aIndiceParDefaut === undefined) {
                aIndiceParDefaut = 0;
            }
            this.setElementCourant(aIndiceParDefaut, true);
        };
        ObjetSelection.prototype.ConstruireAffichage = function() {
            if (this.donneesRecues) {
                return this.composeSelecteur();
            } else {
                return '&nbsp;';
            }
        };
        ObjetSelection.prototype.afficherMessage = function(aMessage) {
            GHtml.setHtml(this.GetNom(), this.composeMessage(aMessage));
        };

        function _incrementerElement(aSens, aIndiceBase) {
            var lIndiceBase = $.isNumeric(aIndiceBase) ? aIndiceBase : this.indice;
            var lProchainIndice = lIndiceBase + aSens;
            if (lProchainIndice < 0) {
                lProchainIndice = this.listeRessources.GetNbrElements() - 1;
            } else if (lProchainIndice >= this.listeRessources.GetNbrElements()) {
                lProchainIndice = 0;
            }
            var lProchainElement = this.listeRessources.GetElement(lProchainIndice);
            if (!!lProchainElement) {
                if (lProchainElement.AvecSelection !== false) {
                    this.surClickElement(lProchainIndice);
                } else {
                    this.incrementerElement(aSens, lProchainIndice);
                }
            }
        }
        ObjetSelection.prototype.surPrecedent = function() {
            if ((this.options.clbckSurPrecSuivant !== null) && (this.options.clbckSurPrecSuivant !== undefined)) {
                this.options.clbckSurPrecSuivant({
                    estPrec: true
                });
            } else {
                _incrementerElement.call(this, this.options.genreTri === EGenreTriElement.Croissant ? -1 : 1);
            }
        };
        ObjetSelection.prototype.surSuivant = function() {
            if ((this.options.clbckSurPrecSuivant !== null) && (this.options.clbckSurPrecSuivant !== undefined)) {
                this.options.clbckSurPrecSuivant({
                    estPrec: false
                });
            } else {
                _incrementerElement.call(this, this.options.genreTri === EGenreTriElement.Croissant ? 1 : -1);
            }
        };
        ObjetSelection.prototype.setTitre = function(aElement) {
            var lHtml = [];
            if (this.options.icone) {
                lHtml.push('<i class="material-icons ' + this.options.icone + '" style="margin-right: .3rem;"></i>');
            }
            if (this.options.getTitre) {
                lHtml.push(this.options.getTitre(aElement));
            } else if (aElement && aElement.libelleHtmlTitre) {
                lHtml.push(aElement.libelleHtmlTitre);
            } else {
                lHtml.push('<span>', aElement ? aElement.GetLibelle() : '', '</span>', (aElement && aElement.sousTitre ? '&nbsp;<span>' + aElement.sousTitre + '</span>' : ''));
            }
            GHtml.setHtml(this.idElementCourant, lHtml.join(''));
        };
        ObjetSelection.prototype.setElementCourant = function(aIndice, aAvecEvenement, aGenreAffichage) {
            var lElement = this.listeRessources.GetElement(aIndice);
            if ((lElement !== null) && (lElement !== undefined)) {
                this.indice = aIndice;
                if (aGenreAffichage) {
                    this.genreAffichage = aGenreAffichage;
                } else {
                    this.genreAffichage = null;
                }
                this.elementCourant = lElement;
                this.setTitre(this.elementCourant);
                if (aAvecEvenement) {
                    this.callback.appel(EGenreEvenement_ObjetSelection.selectionElement, {
                        element: this.elementCourant,
                        genreAffichage: this.genreAffichage
                    });
                }
            }
        };
        ObjetSelection.prototype.composeSelecteur = function() {
            var lStyleWidthButton = 'width:calc(100%';
            if (this.options.avecBoutonsPrecedentSuivant) {
                lStyleWidthButton += ' - ((34px + 6px) * 2)';
            }
            lStyleWidthButton += ');';
            var lAvecModale = this.listeRessources.GetNbrElements() > 1;
            var lHtml = [];
            lHtml.push('<div id="', this.idSelecteur, '" style="margin: 0 0.5rem;" ie-node="getNodeSelecteur">', '<button id="' + this.idElementCourant + '" class="', (this.actif ? (lAvecModale ? 'triangleGrey' : '') : 'disabled'), ' btn-flat" style="' + lStyleWidthButton + 'text-align:left; overflow: hidden; ', (this.options.height !== null ? 'height:' + this.options.height + 'px; ' : ''), '" onclick="' + this.Nom + '.actionSurBouton(' + EGenreBouton_ObjetSelection.selecteur + ')" ', (this.actif ? '' : 'disabled '), '>&nbsp;</button>', (this.options.avecBoutonsPrecedentSuivant ? ('<button id="' + this.idElementPrecedent + '" class="' + (this.actif ? '' : 'disabled') + ' btn-flat btn-floating" title="' + GTraductions.getValeur('Precedent') + '" onclick="' + this.Nom + '.actionSurBouton(' + EGenreBouton_ObjetSelection.precedent + ')" ' + (this.actif ? '' : 'disabled ') + '>' + '<i class="material-icons icon_angle_left">' + GTraductions.getValeur('Precedent') + '</i>' + '</button>' + '<button id="' + this.idElementSuivant + '" class="' + (this.actif ? '' : 'disabled') + ' btn-flat btn-floating" title="' + GTraductions.getValeur('Suivant') + '" onclick="' + this.Nom + '.actionSurBouton(' + EGenreBouton_ObjetSelection.suivant + ')" ' + (this.actif ? '' : 'disabled ') + '>' + '<i class="material-icons icon_angle_right">' + GTraductions.getValeur('Suivant') + '</i>' + '</button>') : ''), '</div>');
            return lHtml.join('');
        };
        ObjetSelection.prototype.setActif = function(aActif) {
            if ((aActif !== null) && (aActif !== undefined) && (aActif !== this.actif)) {
                this.actif = aActif;
                GHtml.setDisabled(this.idElementCourant, !aActif);
                var lAvecModale = this.listeRessources.GetNbrElements() > 1;
                if (aActif === true) {
                    $('#' + this.idElementCourant.escapeJQ()).addClass(lAvecModale ? "triangleGrey" : '').removeClass("disabled");
                } else {
                    $('#' + this.idElementCourant.escapeJQ()).removeClass("triangleGrey").addClass("disabled");
                }
                if (this.options.avecBoutonsPrecedentSuivant) {
                    this.setActifBtnPrecSuiv({
                        estPrec: true,
                        actif: aActif
                    });
                    this.setActifBtnPrecSuiv({
                        estPrec: false,
                        actif: aActif
                    });
                }
            }
        };
        ObjetSelection.prototype.setActifBtnPrecSuiv = function(aParam) {
            var lIdBtn = (aParam.estPrec === true ? this.idElementPrecedent : this.idElementSuivant);
            var lActif = aParam.actif;
            GHtml.setDisabled(lIdBtn, !lActif);
            if (lActif === true) {
                $('#' + lIdBtn.escapeJQ()).removeClass("disabled");
            } else {
                $('#' + lIdBtn.escapeJQ()).addClass("disabled");
            }
        };

        function _nbEltAvecSelection() {
            var lListeElementsAvecSelection = this.listeRessources.getListeElements(function(ele) {
                return !!ele.AvecSelection;
            });
            return lListeElementsAvecSelection.GetNbrElements();
        }
        ObjetSelection.prototype.composeListe = function() {
            var lAvecHeader = _nbEltAvecSelection.call(this) > 0;
            var lHTML = [];
            lHTML.push('<ul id="', this.idListeSelection, '" class="collection', (lAvecHeader ? ' with-header' : ''), '" ', (this.options.styles ? 'style="' + this.options.styles + '"' : ''), '>', this.composeItems(), '</ul>');
            return lHTML.join('');
        };
        ObjetSelection.prototype.composeItems = function() {
            var lHTML = [];
            var lNbr = this.listeRessources.GetNbrElements();
            for (var i = 0; i < lNbr; i++) {
                var lElement = this.listeRessources.GetElement(i);
                if (lElement.Visible !== false) {
                    if (lElement.AvecSelection === false) {
                        lHTML.push('<li id="', this.composeIDItem(i), '" class="collection-header">', '<div class=" ', (lElement.classeTitre ? lElement.classeTitre : 'Gras'), '" style="padding-left: 3px;text-align:center">', lElement.libelleHtml ? '<div style="width:100%;height:100%;">' + lElement.libelleHtml + '</div>' : GChaine.Insecable(lElement.GetLibelle()), '</div>', '</li>');
                    } else {
                        var lImagePerso = lElement.imagePerso ? '<i class="material-icons ' + lElement.imagePerso + '"></i>' : '';
                        lHTML.push('<li class="collection-item  with-action" ', 'id="', this.composeIDItem(i), '" ', lElement.genreAffichages ? '' : 'onclick="' + this.Nom + '.surClickElement (' + i + ')"', '>');
                        lHTML.push((lImagePerso && lElement.imagePosition === "left" ? lImagePerso : ''), '<div class="truncate" ' + (lElement.genreAffichages ? 'onclick="' + this.Nom + '.surClickElement (' + i + ', ' + lElement.genreAffichages.GetElement(0).GetGenre() + ')"' : '') + (lElement.idNotif ? ' id="' + lElement.idNotif + '"' : '') + ' style="white-space: nowrap;position:relative;' + (lElement.idNotif ? 'padding-right:1.6em' : '') + '">', lElement.libelleHtml ? lElement.libelleHtml : GChaine.Insecable(lElement.GetLibelle()), '</div>', lElement.sousTitre ? '<div style="margin-left:18px;" class="Texte12 Gris truncate">' + lElement.sousTitre + '</div>' : '');
                        if (lElement.genreAffichages) {
                            for (var j = 0; j < lElement.genreAffichages.GetNbrElements(); j++) {
                                lHTML.push('<div class="truncate" onclick="' + this.Nom + '.surClickElement (' + i + ', ' + lElement.genreAffichages.GetElement(j).GetGenre() + ')" style="white-space: nowrap;line-height: 2em;margin-left:25px;" class="Texte12">' + lElement.genreAffichages.GetElement(j).GetLibelle() + '</div>');
                            }
                        }
                        lHTML.push('</li>');
                    }
                }
            }
            return lHTML.join('');
        };
        ObjetSelection.prototype.composeIDItem = function(i) {
            return this.Nom + '_Item_' + (i);
        };
        ObjetSelection.prototype.actionSurBouton = function(aGenreBouton) {
            if (this.actif === true) {
                switch (aGenreBouton) {
                    case EGenreBouton_ObjetSelection.selecteur:
                        this.afficherModaleListe();
                        break;
                    case EGenreBouton_ObjetSelection.precedent:
                        this.surPrecedent();
                        break;
                    case EGenreBouton_ObjetSelection.suivant:
                        this.surSuivant();
                        break;
                }
            }
        };
        ObjetSelection.prototype.surClickElement = function(aIndiceElement, aGenreAffichage) {
            if (this.options.avecEvenementAvantSelection) {
                this.callback.appel(EGenreEvenement_ObjetSelection.avantSelection, {
                    element: this.listeRessources.GetElement(aIndiceElement),
                    genreAffichage: aGenreAffichage,
                    callback: this.setElementCourant.bind(this, aIndiceElement, true, aGenreAffichage)
                });
            } else {
                this.setElementCourant(aIndiceElement, true, aGenreAffichage);
            }
            this.fermerModaleListe();
        };
        module.exports = {
            EGenreEvenement_ObjetSelection: EGenreEvenement_ObjetSelection,
            ObjetSelection: ObjetSelection
        };
    },
    fn: "objetselection.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        module.exports = function(aParams) {
            require('produit/css/DetailSortiePedagogique.css');
            var GTraductions = require('ObjetTraduction.js');
            var H = '';
            H += '<div class="DetailSortiePedagogique AvecSelectionTexte">';
            H += '<table class="dsp_champs">';
            H += '<tr>';
            H += '<td>' + aParams.strGenreRess + ' :</td>';
            H += '<td>' + aParams.strRess + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td>';
            H += GTraductions.getValeur('EDT.AbsRess.Motif');
            H += ' :</td>';
            H += '<td>' + aParams.motif + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td>';
            H += GTraductions.getValeur('EDT.AbsRess.Date');
            H += ' :</td>';
            H += '<td>' + aParams.strDate + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td>';
            H += GTraductions.getValeur('EDT.AbsRess.Duree');
            H += ' :</td>';
            H += '<td>' + aParams.duree + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td>';
            H += GTraductions.getValeur('EDT.AbsRess.Accompagnateurs');
            H += ' :</td>';
            H += '<td>' + aParams.accompagnateurs + '</td>';
            H += '</tr>';
            H += '</table>';
            if (aParams.avecMemoVisible) {
                H += '<div class="dsp_Memo">';
                H += '<div class="dsp_titreMemo">';
                H += GTraductions.getValeur('EDT.AbsRess.TitreMemoAbsence');
                H += '</div>';
                H += '<div>' + aParams.getMemo() + '</div>';
                H += '</div>';
            }
            H += '</div>';
            return H;
        };
    },
    fn: "detailsortiepedagogique.htmlmodele.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        module.exports = function(aParams) {
            var GTraductions = require('ObjetTraduction.js');
            var H = '';
            H += '<table cellpadding="0" cellspacing="3">';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable" style="width:1px;">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Demande');
            H += ' :</td>';
            H += '<td class="Gras">' + aParams.details.demande + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Motifs');
            H += ' :</td>';
            H += '<td class="Gras">' + aParams.details.motifs + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable" style="padding-top:10px;">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Circonstances');
            H += ' :</td>';
            H += '<td  class="Gras" style="padding-top:10px;"><div style="overflow:auto;' + aParams.styleMaxTaille + '">' + aParams.circonstances + '</div></td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable" style="padding-top:10px;">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Duree');
            H += ' :</td>';
            H += '<td  class="Gras" style="padding-top:10px;">' + aParams.details.duree + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Etat');
            H += ' :</td>';
            H += '<td class="Gras">' + aParams.details.realise + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Surveillant');
            H += ' :</td>';
            H += '<td class="Gras">' + aParams.details.surveillant + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.SalleOuLieu');
            H += ' :</td>';
            H += '<td class="Gras">' + aParams.details.salle + '</td>';
            H += '</tr>';
            H += '<tr>';
            H += '<td class="AlignementDroit AlignementHaut Insecable">';
            H += GTraductions.getValeur('ObjetFenetre_ProgrammationPunition.Tache');
            H += ' :</td>';
            H += '<td class="Gras"><div style="overflow:auto;' + aParams.styleMaxTaille + '">' + aParams.commentaire + '</div></td>';
            H += '</tr>';
            H += '</table>';
            return H;
        };
    },
    fn: "detailprogrammationpunition.html.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var ObjetCalendrierMobilePN = require('ObjetCalendrierPN.js');
        var ObjetCours_Mobile = require('ObjetCours_Mobile.js');
        var ObjetFicheCours_Mobile = require('ObjetFicheCours_Mobile.js');
        var ObjetRequeteFicheCours = require('ObjetRequeteFicheCours.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GHtml = require('GHtml.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreMessage = require('Enumere_Message.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetRequetePageEmploiDuTemps = require('ObjetRequetePageEmploiDuTemps.js');
        var ObjetRequetePageEmploiDuTemps_DomainePresence = require('ObjetRequetePageEmploiDuTemps_DomainePresence.js');
        var TypeDomaine = require('TypeDomaine.js');
        var GChaine = require('GChaine.js');
        var UtilitaireEDTSortiePedagogique = require('UtilitaireEDTSortiePedagogique.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var UtilitairePrefsGrilleStructure = require('UtilitairePrefsGrilleStructure.js');
        var ObjetBoutonFlottant = require('ObjetBoutonFlottant.js');
        var GenerationPDF = require('utilitairegenerationpdf.js');
        var OptionsPdf = require('OptionsPDFSco.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var TypeHttpGenerationPDFSco = require('TypeHttpGenerationPDFSco.js').TypeHttpGenerationPDFSco;
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        MethodesObjet.heritagePrototype(ObjetAffichagePageEmploiDuTemps_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageEmploiDuTemps_Mobile() {
            this.inheritedCreate(arguments);
            this.NumeroSemaine = null;
            this.popupOuvert = {};
            this.estEDTAnnuel = GEtatUtilisateur.pourPrimaire();
            this.GenreStructure = EStructureAffichage.Autre;
            this.forcerClickCours = false;
            if (GEtatUtilisateur.getNavigationDate()) {
                GEtatUtilisateur.setDerniereDate(GEtatUtilisateur.getNavigationDate());
            }
        }
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.ConstruireInstances = function() {
            this.ressources = GEtatUtilisateur.getMembre();
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]) && (GEtatUtilisateur.getGenreOnglet() === EGenreOnglet.EmploiDuTemps)) {
                this.ressources = GEtatUtilisateur.getUtilisateur();
            }
            this.identCalendrier = this.Add(ObjetCalendrierMobilePN, _evenementCalendrier, this.initialiserCalendrier);
            this.identPageListe = this.Add(ObjetCours_Mobile, this.evenementFicheCours, _initialiserPageListe.bind(this));
            this.identFicheCours = this.Add(ObjetFicheCours_Mobile);
            if (GEtatUtilisateur.getGenreOnglet() === EGenreOnglet.EmploiDuTempsClasse) {
                this.identComboClasse = this.Add(ObjetSelection, _evntSelecteur.bind(this), _initSelecteur.bind(this));
            }
            this.AddSurZone = [this.identComboClasse, this.identCalendrier];
        };

        function _initSelecteur(aInstance) {
            aInstance.SetParametres({
                avecBoutonsPrecedentSuivant: false,
                icone: null
            });
        }

        function _evntSelecteur(aInstance, aRessource) {
            this.classeSelectionne = aRessource;
            this.lancerRequete();
        }
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.ConstruireStructureAffichageAutre = function() {
            var lHtml = [];
            if (!this.identBtnFlottant) {
                $("#" + GInterface.idZonePrincipale).IEHtmlAppend('<div class="is-sticky" ie-identite="getIdentiteBouton" ></div>', {
                    controleur: this.controleur,
                    avecCommentaireConstructeur: false
                });
            }
            lHtml.push('<div>', '<div id="', this.GetInstance(this.identPageListe).GetNom(), '"></div>', '</div>');
            return lHtml.join('');
        };
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.getControleur = function(aInstance) {
            return {
                getIdentiteBouton: function() {
                    return {
                        class: ObjetBoutonFlottant,
                        pere: this,
                        init: function(aBtn) {
                            aInstance.identBtnFlottant = aBtn;
                            var lParam = {
                                listeBoutons: [{
                                    primaire: true,
                                    icone: "icon_pdf",
                                    callback: _genererPdf.bind(this, aInstance)
                                }]
                            };
                            aBtn.setOptionsBouton(lParam);
                        }
                    };
                }
            };
        };

        function _genererPdf(aInstance) {
            var lRessources = new ObjetListeElements().AddElement(aInstance.ressources);
            lRessources.setSerialisateurJSON({
                ignorerEtatsElements: true
            });
            var lParametrageAffichage = {
                genreGenerationPDF: TypeHttpGenerationPDFSco.EDT,
                estPlanning: false,
                estPlanningParRessource: false,
                estPlanningOngletParJour: false,
                estPlanningParJour: false,
                indiceJour: 0,
                domaine: new TypeDomaine().SetValeur(true, GDate.GetSemaine(aInstance.date)),
                ressource: lRessources.GetElement(0),
                ressources: lRessources,
                avecCoursAnnules: true,
                grilleInverse: false,
                prefsGrille: aInstance.lPrefsGrille
            };
            GenerationPDF.genererPDF({
                paramPDF: lParametrageAffichage,
                optionsPDF: OptionsPdf.EDT
            });
        }

        function _afficherPopUp(aTitre, aContenu) {
            if (GInterface.popupIsOpen()) {
                this.popupOuvert.header = GInterface.getPopupHeader();
                this.popupOuvert.footer = GInterface.getPopupFooter();
                this.popupOuvert.content = GInterface.getPopupContent();
            }
            GInterface.setPopupHeader('<h2>' + aTitre + '</h2>');
            GInterface.setPopupContent(aContenu);
            GInterface.setPopupFooter('');
            GInterface.openPopup({
                onClose: this.surFermeturePopup.bind(this)
            });
        }

        function _afficherSortiePeda(aCours) {
            var H = [];
            H.push('<div class="Espace">');
            H.push(require('DetailSortiePedagogique.htmlmodele.js')({
                strGenreRess: aCours.strGenreRess,
                strRess: aCours.strRess,
                motif: aCours.motif,
                strDate: UtilitaireEDTSortiePedagogique.strDate(aCours),
                duree: GDate.formatDureeEnPlaces(aCours.dureeReelle),
                accompagnateurs: aCours.accompagnateurs.join(', '),
                avecMemoVisible: aCours.memo !== undefined,
                getMemo: function() {
                    return aCours.memo ? '<div>' + GChaine.ToHTML(aCours.memo) + '</div>' : '';
                }
            }));
            H.push('</div>');
            _afficherPopUp.call(this, GTraductions.getValeur('EDT.AbsRess.SortiePedagogique') + ' ' + UtilitaireEDTSortiePedagogique.strDate(aCours), H.join(''));
        }
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.evenementFicheCours = function(aCours) {
            if (aCours.estSortiePedagogique) {
                _afficherSortiePeda.call(this, aCours);
                return;
            }
            new ObjetRequeteFicheCours(this).lancerRequete({
                cours: aCours,
                ressource: this.ressources,
                numeroSemaine: GDate.GetSemaine(this.date)
            }).then(_actionSurGrille.bind(this, aCours), function(aMessage) {
                return GApplication.getMessage().afficher({
                    message: aMessage || GTraductions.getValeur('requete.erreur')
                }).then(function() {
                    _evenementCalendrier.call(this, this.date);
                }.bind(this));
            }.bind(this));
        };

        function _actionSurGrille(aCours, aJSON) {
            if (aJSON.estProgrammationPunition) {
                var H = [];
                H.push('<div class="Espace">');
                H.push(require('DetailProgrammationPunition.html.js')({
                    details: aJSON,
                    circonstances: GChaine.ToHTML(aJSON.circonstances),
                    commentaire: GChaine.ToHTML(aJSON.commentaire),
                    styleMaxTaille: ''
                }));
                H.push('</div>');
                _afficherPopUp.call(this, aJSON.titre, H.join(''));
            } else {
                this.GetInstance(this.identFicheCours).SetDonnees(aJSON.listeCours, aCours);
                this.GetInstance(this.identFicheCours).Afficher(this.surFermeturePopup.bind(this));
            }
            this.avecRetourSurAffichage = true;
        }
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.surFermeturePopup = function() {
            if (this.popupOuvert && this.popupOuvert.content) {
                GInterface.setPopupHeader(this.popupOuvert.header.html, this.popupOuvert.header.controleur);
                GInterface.setPopupFooter(this.popupOuvert.footer.html, this.popupOuvert.footer.controleur);
                GInterface.setPopupContent(this.popupOuvert.content.html, this.popupOuvert.content.controleur);
                GInterface.openPopup();
                this.popupOuvert = {};
            }
        };
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.evenementSwipe = function(event) {
            this.GetInstance(this.identCalendrier).incrementerJour(event.type === 'swiperight');
        };
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.RecupererDonnees = function() {
            if (!!this.identComboClasse) {
                this.GetInstance(this.identComboClasse).SetDonnees(GEtatUtilisateur.getListeClasses({
                    avecClasse: true,
                    avecGroupe: true
                }));
            }
            if (this.ressources === null || this.ressources === undefined) {
                this.afficherMessage(GTraductions.getValeur('Message')[EGenreMessage.AucuneClasseDisponible]);
            } else if (this.estEDTAnnuel) {
                var lDomaine = new TypeDomaine();
                lDomaine.SetValeur(true, 1, IE.Cycles.nombreCyclesAnneeScolaire());
                this.GetInstance(this.identCalendrier).SetDonnees(lDomaine, null, GEtatUtilisateur.getDerniereDate());
            } else {
                new ObjetRequetePageEmploiDuTemps_DomainePresence(this).lancerRequete(this.ressources).then(function(aTabParams) {
                    this.domainePresence = aTabParams[0];
                    this.joursPresence = aTabParams[1];
                    this.GetInstance(this.identCalendrier).SetDonnees(this.domainePresence, this.joursPresence, GEtatUtilisateur.getDerniereDate());
                }.bind(this));
            }
        };
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.retourSurAffichage = function() {
            if (this.avecRetourSurAffichage) {
                GHtml.setDisplay(this.GetInstance(this.identCalendrier).GetNom(), true);
                GHtml.setDisplay(this.GetInstance(this.identPageListe).GetNom(), true);
                this.avecRetourSurAffichage = false;
                return true;
            } else {
                return false;
            }
        };
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.initialiserCalendrier = function(aInstance, aJoursOuvres) {
            var lPremiereSemaine = null;
            var lDerniereSemaine = null;
            for (var i = 0; i < GApplication.droits.get(TypeDroits.cours.domaineConsultationEDT).nombreValeurs; i++) {
                if (GApplication.droits.get(TypeDroits.cours.domaineConsultationEDT).GetValeur(i)) {
                    if (lPremiereSemaine === null || lPremiereSemaine === undefined) {
                        lPremiereSemaine = i;
                    }
                    lDerniereSemaine = i;
                }
            }
            aInstance.SetParametres({
                derniereDate: IE.Cycles.dateFinCycle(lDerniereSemaine),
                joursOuvres: aJoursOuvres
            });
        };

        function _evenementCalendrier(aDate) {
            this.date = GDate.GetJour(aDate);
            GEtatUtilisateur.setDerniereDate(this.date);
            if (this.estEDTAnnuel && this._cacheRequeteAnnuel) {
                _surReponseRequeteEDT.call(this, MethodesObjet.dupliquer(this._cacheRequeteAnnuel));
            } else {
                this.lancerRequeteEDT();
            }
        }
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.lancerRequeteEDT = function(aParam) {
            var lExisteParam = (aParam !== null) && (aParam !== undefined);
            return new ObjetRequetePageEmploiDuTemps(this).lancerRequete({
                ressource: lExisteParam && (aParam.ressources !== null) && (aParam.ressources !== undefined) ? aParam.ressources : this.ressources,
                dateDebut: lExisteParam && (aParam.dateDebut !== null) && (aParam.dateDebut !== undefined) ? aParam.dateDebut : this.date,
                estEDTAnnuel: lExisteParam && (aParam.estEDTAnnuel !== null) && (aParam.estEDTAnnuel !== undefined) ? aParam.estEDTAnnuel : this.estEDTAnnuel,
                avecConseilDeClasse: lExisteParam && (aParam.avecConseilDeClasse !== null) && (aParam.avecConseilDeClasse !== undefined) ? aParam.avecConseilDeClasse : true,
                avecInfosPrefsGrille: lExisteParam && (aParam.avecInfosPrefsGrille !== null) && (aParam.avecInfosPrefsGrille !== undefined) ? aParam.avecInfosPrefsGrille : true
            }).then(function(aParams) {
                if (lExisteParam && (aParam.clbckRequeteEDT !== null) && (aParam.clbckRequeteEDT !== undefined)) {
                    return aParam.clbckRequeteEDT(aParams);
                } else {
                    return _surReponseRequeteEDT.call(this, aParams);
                }
            }.bind(this));
        };

        function _initialiserPageListe(aInstance) {
            aInstance.setOptions({
                estCoursVisible: _estCoursVisible.bind(this),
                forcerClickCours: this.forcerClickCours
            });
        }

        function _estCoursVisible(aCours) {
            if (this.estEDTAnnuel) {
                return IE.Cycles.dateEnJourCycle(this.date) === Math.floor(aCours.Debut / GParametres.PlacesParJour);
            }
            return GDate.estJourEgal(this.date, aCours.DateDuCours);
        }

        function _surReponseRequeteEDT(aParam) {
            if (aParam.prefsGrille && [EGenreEspace.Eleve, EGenreEspace.PrimEleve, EGenreEspace.Parent, EGenreEspace.PrimParent, EGenreEspace.Accompagnant, EGenreEspace.PrimAccompagnant].indexOf(GEtatUtilisateur.GenreEspace) >= 0) {
                this.lPrefsGrille = UtilitairePrefsGrilleStructure.getPrefsGrille(aParam.prefsGrille.genreRessource, false, aParam.prefsGrille.numEtablissement);
            } else {
                this.lPrefsGrille = UtilitairePrefsGrilleStructure.getPrefsGrilleDefaut();
            }
            var lJoursOuvres = UtilitairePrefsGrilleStructure.getDomaineJoursOuvresDePrefsGrille(this.lPrefsGrille);
            var lProchaineDate = UtilitairePrefsGrilleStructure.getProchaineDateOuvreeDePrefsGrille(this.date, this.lPrefsGrille);
            var lCalendrier = this.GetInstance(this.identCalendrier);
            if ((lProchaineDate.trouve && lProchaineDate.dateChangee) || !lCalendrier.joursOuvres || !lCalendrier.joursOuvres.egal(lJoursOuvres)) {
                this.initialiserCalendrier(lCalendrier, lJoursOuvres);
                lCalendrier.SetDonnees(this.domainePresence, this.joursPresence, lProchaineDate.date);
                return;
            }
            if (this.estEDTAnnuel && !this._cacheRequeteAnnuel) {
                this._cacheRequeteAnnuel = MethodesObjet.dupliquer(aParam);
            }
            var lListeImages = new ObjetListeElements();
            lListeImages.AddElement(new ObjetElement('IconeTravailAFaire'));
            aParam.listeCours.parcourir(function(aCours) {
                aCours.ListeContenus.parcourir(function(aContenu) {
                    if ((aContenu.GetGenre() === EGenreRessource.Matiere) && aCours.avecTafPublie) {
                        aContenu.Class = '';
                        aContenu.listeImages = lListeImages;
                    }
                });
            });
            this.GetInstance(this.identPageListe).SetDonnees(this.date, !!aParam && aParam.listeCours, !!aParam && aParam.avecCoursAnnule, this.surFermeturePopup.bind(this));
            if (GEtatUtilisateur.getNavigationCours()) {
                var lCoursNav = GEtatUtilisateur.getNavigationCours();
                GEtatUtilisateur.setNavigationCours(null);
                var lCours = aParam.listeCours.GetElementParNumero(lCoursNav.GetNumero());
                if ((lCours !== null) && (lCours !== undefined)) {
                    this.evenementFicheCours(lCours);
                }
            }
        }
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.free = function() {
            this.inherited('free', arguments);
            if (this.identBtnFlottant) {
                $('#' + this.identBtnFlottant.GetNom().escapeJQ()).remove();
            }
        };
        ObjetAffichagePageEmploiDuTemps_Mobile.prototype.getDateCourante = function() {
            return this.GetInstance(this.identCalendrier).dateCourante;
        };
        module.exports = ObjetAffichagePageEmploiDuTemps_Mobile;
    },
    fn: "interfacepageemploidutemps_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetRequeteSaisieTAFFaitEleve = require('ObjetRequeteSaisieTAFFaitEleve.js');
        var ObjetUtilitaireCahierDeTexte = require('ObjetUtilitaireCahierDeTexte.js');
        var TypeGenreRenduTAF = require('TypeGenreRenduTAF.js').TypeGenreRenduTAF;
        var TypeOrigineCreationCategorieCahierDeTexte = require('TypeOrigineCreationCategorieCahierDeTexte.js').TypeOrigineCreationCategorieCahierDeTexte;
        var EGenreDirectionSlide = require('EGenreDirectionSlide.js');
        var UtilitaireQCM = require('UtilitaireQCM.js').UtilitaireQCM;
        MethodesObjet.heritagePrototype(ObjetCahierDeTexte_Mobile, ObjetIdentite_Mobile);

        function ObjetCahierDeTexte_Mobile() {
            this.inheritedCreate(arguments);
            this.cycleCourant = null;
            this.utilitaireCDT = new ObjetUtilitaireCahierDeTexte(this.Nom + '.utilitaireCDT', this, this.surUtilitaireCDT);
            this.idTaf = this.Nom + '_Taf_';
            this.idCheckboxTafFait = this.Nom + '_CheckboxTafFait_';
            this.idBadgeTafFait = this.Nom + '_BadgeTafFait_';
        }
        ObjetCahierDeTexte_Mobile.prototype.SetDonnees = function(aGenreOnglet, aListeTravailAFaire, aListeCahierDeTextes, aCycleCourant) {
            this.genreOnglet = aGenreOnglet;
            this.ListeTravailAFaire = aListeTravailAFaire;
            this.ListeCahierDeTextes = aListeCahierDeTextes;
            var lSensSwipe = !this.cycleCourant || aCycleCourant === this.cycleCourant ? EGenreDirectionSlide.Aucune : (aCycleCourant < this.cycleCourant ? EGenreDirectionSlide.Droite : EGenreDirectionSlide.Gauche);
            this.cycleCourant = aCycleCourant;
            if (this.genreOnglet === EGenreOnglet.CDT_TAF) {
                this.actualiser_TravailAFaire(this.ListeTravailAFaire);
            } else {
                this.actualiser_Contenu(this.ListeCahierDeTextes);
            }
            this.Afficher(null, lSensSwipe);
            return this.avecDonnees;
        };
        ObjetCahierDeTexte_Mobile.prototype.actualiser_Contenu = function() {
            if (this.ListeCahierDeTextes) {
                this.ListeCahierDeTextes.setTri([ObjetTri.init('Date')]).trier();
            }
        };
        ObjetCahierDeTexte_Mobile.prototype.actualiser_TravailAFaire = function(aListeTravailAFaire) {
            if (aListeTravailAFaire) {
                aListeTravailAFaire.setTri([
                    ObjetTri.init('PourLe'), ObjetTri.init('Matiere.Libelle'), ObjetTri.init('DonneLe'), ObjetTri.init('Genre')
                ]).trier();
            }
        };
        ObjetCahierDeTexte_Mobile.prototype.ConstruireAffichage = function() {
            return this.genreOnglet === EGenreOnglet.CDT_TAF ? this.composePage_TravailAFaire(this.ListeTravailAFaire) : this.composePage_Contenu(this.ListeCahierDeTextes);
        };
        ObjetCahierDeTexte_Mobile.prototype.composePage_Contenu = function(aListeCahierDeTextes) {
            if (!aListeCahierDeTextes) {
                return '';
            }
            var lDateCourante = null;
            var lHtml = [];
            if (!!aListeCahierDeTextes.GetNbrElements() && !!aListeCahierDeTextes.getListeElements(function(aEle) {
                    return (aEle.listeContenus && aEle.listeContenus.GetNbrElements() > 0) || (aEle.listeElementsProgrammeCDT && (aEle.listeElementsProgrammeCDT.GetNbrElements() > 0));
                }).GetNbrElements()) {
                lHtml.push('<ul class="collapsible" data-collapsible="expandable">');
                var lDateSelectionnee = !!GEtatUtilisateur.getNavigationDate() ? GEtatUtilisateur.getNavigationDate().getDate() : GEtatUtilisateur.getDerniereDate();
                GEtatUtilisateur.setNavigationDate(GDate.getDateCourante());
                for (var I = 0; I < aListeCahierDeTextes.GetNbrElements(); I++) {
                    var lCahierDeTextes = aListeCahierDeTextes.GetElement(I);
                    if ((lCahierDeTextes.listeContenus && lCahierDeTextes.listeContenus.GetNbrElements() > 0) || (lCahierDeTextes.listeElementsProgrammeCDT && (lCahierDeTextes.listeElementsProgrammeCDT.GetNbrElements() > 0))) {
                        var lDate = GDate.GetJour(lCahierDeTextes.Date);
                        if (!lDateCourante || !GDate.estJourEgal(lDateCourante, lDate)) {
                            if (!!lDateCourante) {
                                lHtml.push('</ul>');
                                lHtml.push('</div>');
                                lHtml.push('</li>');
                            }
                            lDateCourante = lDate;
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header', (lCahierDeTextes.Date.getDate() === lDateSelectionnee ? ' active' : ''), '">' + GDate.FormatDate(lDateCourante, '%JJJJ %JJ %MMMM %AAAA') + '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<ul class="collection">');
                        }
                        lHtml.push('<li class="collection-item">');
                        lHtml.push('<span class="title">', GDate.FormatDate(lCahierDeTextes.Date, '%hh%sh%mm - ') + lCahierDeTextes.Matiere.Libelle, '</span>');
                        lHtml.push(this.composeContenu(lCahierDeTextes));
                        lHtml.push(this.composeElementsProgramme(lCahierDeTextes));
                        lHtml.push('</li>');
                    }
                }
                lHtml.push('</ul>');
                lHtml.push('</div>');
                lHtml.push('</li>');
                lHtml.push('</ul>');
            } else {
                lHtml.push(this.composeAucuneDonnee(GTraductions.getValeur('CahierDeTexte.AucunContenu')));
            }
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.composePage_TravailAFaire = function(aListeTravailAFaire) {
            if (!aListeTravailAFaire) {
                return '';
            }
            var lHtml = [];
            this.donneLeCourant = '';
            var lDateCourante = null;
            this.libelleMatiereCourant = null;
            var lDateDonneLeCourante = null;
            var lDateTafSelectionnee = !!GEtatUtilisateur.getNavigationDate() ? GEtatUtilisateur.getNavigationDate() : GEtatUtilisateur.getDerniereDate();
            GEtatUtilisateur.setNavigationDate(GDate.getDateCourante());
            if (!!aListeTravailAFaire.GetNbrElements()) {
                lHtml.push('<ul class="collapsible" data-collapsible="expandable">');
                for (var I = 0; I < aListeTravailAFaire.GetNbrElements(); I++) {
                    var lTravailAFaire = aListeTravailAFaire.GetElement(I);
                    var lDate = lTravailAFaire.PourLe;
                    var lLibelleMatiere = lTravailAFaire.Matiere.Libelle;
                    var lDateDonneLe = lTravailAFaire.DonneLe;
                    if (lDate && (!lDateCourante || !GDate.estJourEgal(lDateCourante, lDate))) {
                        if (!!lDateCourante) {
                            lHtml.push('</ul>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lDateCourante = lDate;
                        this.libelleMatiereCourant = null;
                        lDateDonneLeCourante = null;
                        lHtml.push('<li>');
                        lHtml.push('<div class="collapsible-header', (lDate.getDate() === lDateTafSelectionnee ? ' active' : ''), '">' + GTraductions.getValeur('CahierDeTexte.pourLe') + ' ' + GDate.FormatDate(lDateCourante, '%JJJJ %JJ %MMMM %AAAA') + '</div>');
                        lHtml.push('<div class="collapsible-body">');
                        lHtml.push('<ul class="collection">');
                    }
                    if (this.libelleMatiereCourant !== lLibelleMatiere) {
                        if (!!lLibelleMatiere) {
                            lHtml.push('</li>');
                        }
                        lHtml.push('<li id="', this.idTaf + lTravailAFaire.GetNumero(), '" class="collection-item">');
                        this.libelleMatiereCourant = lLibelleMatiere;
                        lDateDonneLeCourante = null;
                        lHtml.push('<span class="title">' + lTravailAFaire.Matiere.Libelle + '</span>');
                    }
                    if (lDateDonneLe && (!lDateDonneLeCourante || !GDate.estJourEgal(lDateDonneLeCourante, lDateDonneLe))) {
                        lDateDonneLeCourante = lDateDonneLe;
                        lHtml.push(this.composeDonneLe(lTravailAFaire));
                    }
                    lHtml.push(this.composeTravailAFaire(lTravailAFaire));
                }
                lHtml.push('</li>');
                lHtml.push('</ul>');
                lHtml.push('</div>');
                lHtml.push('</li>');
                lHtml.push('</ul>');
            } else {
                lHtml.push(this.composeAucuneDonnee(GTraductions.getValeur('CahierDeTexte.AucunTAF')));
            }
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.composeDonneLe = function(aTravailAFaire) {
            var lNbrJours = GDate.GetDifferenceJours(aTravailAFaire.PourLe, aTravailAFaire.DonneLe);
            var lHtml = [];
            lHtml.push('<div class="grey-text text-darken-1">', GTraductions.getValeur('CahierDeTexte.donneLe'), ' ', GDate.FormatDate(aTravailAFaire.DonneLe, '%JJ/%MM'), ' [', lNbrJours, ' ', lNbrJours ? GTraductions.getValeur('CahierDeTexte.jours') : GTraductions.getValeur('CahierDeTexte.jour'), ']', '</div>');
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.composeTravailAFaire = function(aTravailAFaire) {
            var lHtml = [],
                lAvecERendu = !!aTravailAFaire.genreRendu && MethodesTableau.existe(aTravailAFaire.genreRendu, [TypeGenreRenduTAF.GRTAF_RenduPronote, TypeGenreRenduTAF.GRTAF_RenduKiosque]),
                lEstRendu = !!aTravailAFaire.genreRendu && MethodesTableau.existe(aTravailAFaire.genreRendu, [TypeGenreRenduTAF.GRTAF_RenduPronote]) && !!aTravailAFaire.documentRendu,
                lEstQCM = !(aTravailAFaire.executionQCM === null || aTravailAFaire.executionQCM === undefined),
                lEstFait = false;
            if (lEstQCM && !!aTravailAFaire.executionQCM.etatCloture) {
                lEstFait = aTravailAFaire.executionQCM.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_Termine;
            } else {
                lEstFait = aTravailAFaire.TAFFait;
            }
            lHtml.push('<div>', this.utilitaireCDT.composeInformationsTAF(aTravailAFaire), '</div>');
            if (GEtatUtilisateur.estEspaceEleve()) {
                lHtml.push('<div class="FondBlanc" style="margin-top: 0.2em;">');
                lHtml.push('<div class="InlineBlock" style="width:15%; padding: 0.1rem 0.4em;">');
                if (!lEstQCM && !lAvecERendu) {
                    lHtml.push('<label>', '<input id="', this.idCheckboxTafFait + aTravailAFaire.GetNumero(), '" onclick="', this.Nom, '.evenementTafFait(\'', aTravailAFaire.GetNumero(), '\');" type="checkbox"  ', (!!lEstFait ? 'checked="cheked"' : ''), ' >', '<span></span>', '</label>');
                }
                lHtml.push('</div>');
                lHtml.push('<div class="InlineBlock" style="width:84%; vertical-align:top;">');
            }
            lHtml.push('<div style="margin-top: 0.2em;" class="FondBlanc PetitEspace">');
            if (aTravailAFaire.executionQCM === null || aTravailAFaire.executionQCM === undefined) {
                lHtml.push('<div style="overflow-x:auto;">', aTravailAFaire.descriptif, '</div>', aTravailAFaire.ListePieceJointe.GetNbrElements() ? this.composePiecesJointes(aTravailAFaire) : '');
            } else {
                var lClass = '';
                var lAvecAction = UtilitaireQCM.estCliquable(aTravailAFaire.executionQCM);
                var lActionQCM = lAvecAction ? ' onclick="' + this.Nom + '.appelQCM(\'' + aTravailAFaire.executionQCM.GetNumero() + '\');" ' : '';
                if (lAvecAction) {
                    lClass = ' class="link"';
                }
                lHtml.push('<div><a' + lClass + lActionQCM + '>' + aTravailAFaire.descriptif + '</a></div>');
            }
            lHtml.push('<div class="Texte12">', this.utilitaireCDT.composeTAFARendre(aTravailAFaire, {
                controleur: this.controleur,
                listeTAF: this.ListeTravailAFaire
            }), '</div>');
            lHtml.push('<div class="left"></div>');
            if (!lEstFait || !lEstRendu) {
                lHtml.push('<div id="', this.idBadgeTafFait + aTravailAFaire.GetNumero(), '" class="right" style="' + (!!lEstFait ? 'display:block;' : 'display:none;') + '">', '<span class="new badge">' + GTraductions.getValeur('accueil.hintTravailFait') + '</span>', '</div>');
            }
            lHtml.push('<div class="clear"></div>');
            lHtml.push('</div>');
            if (GEtatUtilisateur.estEspaceEleve()) {
                lHtml.push('</div>');
                lHtml.push('</div>');
            }
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.composeContenu = function(aCDT) {
            var lHtml = [];
            for (var i = 0; i < aCDT.listeContenus.GetNbrElements(); i++) {
                var lContenu = aCDT.listeContenus.GetElement(i);
                if (i > 0) {
                    lHtml.push('');
                }
                var lImageCss = TypeOrigineCreationCategorieCahierDeTexte.getImage(lContenu.categorie.GetGenre());
                if (lImageCss) {
                    lHtml.push('<div class="NoWrap">', '<div style="float:right" class="EspaceDroit ', lImageCss, '"></div>', '<div style="float:left; margin-top:2px;">', lContenu.Libelle, (lContenu.categorie.Libelle && lContenu.Libelle ? ' - ' : ''), lContenu.categorie.GetLibelle(), '</div>', '<div style="clear:both;"></div>', '</div>');
                } else {
                    lHtml.push('<div>', lContenu.Libelle, (lContenu.categorie.Libelle && lContenu.Libelle ? ' - ' : ''), lContenu.categorie.GetLibelle(), '</div>');
                }
                lHtml.push('<div style="overflow-x:auto;">', lContenu.descriptif, '</div>', this.composePiecesJointes(lContenu, aCDT));
                for (var j = 0; lContenu.listeExecutionQCM && j < lContenu.listeExecutionQCM.GetNbrElements(); j++) {
                    var lExecutionQCM = lContenu.listeExecutionQCM.GetElement(j);
                    var lStyleQCM = 'font-style:italic;';
                    var lAvecAction = UtilitaireQCM.estCliquable(lExecutionQCM);
                    var lActionQCM = lAvecAction ? ' onclick="' + this.Nom + '.appelQCM(\'' + lExecutionQCM.GetNumero() + '\');" ' : '';
                    if (lAvecAction) {
                        lStyleQCM = 'font-style:italic;color:' + '#2073D3' + ';text-decoration:underline;';
                    }
                    lHtml.push('<div style="' + lStyleQCM + '"' + lActionQCM + '>' + lExecutionQCM.QCM.GetLibelle() + '</div>');
                }
            }
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.composePiecesJointes = function(aElement) {
            var lHtml = [];
            for (var I = 0; I < aElement.ListePieceJointe.GetNbrElements(); I++) {
                var lPieceJointe = aElement.ListePieceJointe.GetElement(I);
                lHtml.push('<div style="margin-top: 0.5em;">', GChaine.composerUrlLienExterne({
                    documentJoint: lPieceJointe
                }), '</div>');
            }
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.composeElementsProgramme = function(aCDT) {
            var lHtml = [];
            var lElementProgrammeCDT;
            if (aCDT.listeElementsProgrammeCDT && aCDT.listeElementsProgrammeCDT.GetNbrElements()) {
                lHtml.push('<div class="Gras">', GTraductions.getValeur('CahierDeTexte.ElementsProgramme'), ' :', '</div>');
                for (var i = 0; i < aCDT.listeElementsProgrammeCDT.GetNbrElements(); i++) {
                    lElementProgrammeCDT = aCDT.listeElementsProgrammeCDT.GetElement(i);
                    lHtml.push('<div>', '-&nbsp;' + lElementProgrammeCDT.GetLibelle(), '</div>');
                }
            }
            return lHtml.join('');
        };
        ObjetCahierDeTexte_Mobile.prototype.appelQCM = function(aNumeroQCM) {
            this.callback.appel({
                executionQCM: aNumeroQCM
            });
        };
        ObjetCahierDeTexte_Mobile.prototype.surUtilitaireCDT = function() {
            this.callback.appel();
        };
        ObjetCahierDeTexte_Mobile.prototype.evenementTafFait = function(aNumeroTaf) {
            var lElement = this.ListeTravailAFaire.GetElementParNumero(aNumeroTaf);
            if (!!lElement.TAFFait) {
                lElement.TAFFait = false;
                $('#' + this.idBadgeTafFait.escapeJQ() + lElement.GetNumero()).css('display', 'none');
            } else {
                lElement.TAFFait = true;
                $('#' + this.idBadgeTafFait.escapeJQ() + lElement.GetNumero()).css('display', 'block');
            }
            lElement.SetEtat(EGenreEtat.Modification);
            new ObjetRequeteSaisieTAFFaitEleve(this).lancerRequete({
                listeTAF: this.ListeTravailAFaire
            });
        };
        module.exports = ObjetCahierDeTexte_Mobile;
    },
    fn: "pagecahierdetexte_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetDeserialiser = require('ObjetDeserialiser.js');
        var ObjetListeElements = require('ObjetListeElements.js');

        function ObjetRequetePageCahierDeTexte() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageCahierDeTexte', ObjetRequetePageCahierDeTexte, ObjetRequeteConsultation);
        ObjetRequetePageCahierDeTexte.prototype.lancerRequete = function(aParametres) {
            this.JSON = {
                domaine: aParametres.domaine,
                eleve: aParametres.eleve,
                ressource: aParametres.ressource
            };
            return this.appelAsynchrone();
        };
        ObjetRequetePageCahierDeTexte.prototype.actionApresRequete = function() {
            var lObjetDeserialiser = new ObjetDeserialiser();
            var lListeTravauxAFaire = this.JSONReponse.ListeTravauxAFaire || new ObjetListeElements();
            lListeTravauxAFaire.parcourir(function(aTaf) {
                lObjetDeserialiser.deserialiserTAF(aTaf);
            });
            lListeTravauxAFaire.setTri([ObjetTri.init('DonneLe'), ObjetTri.init('Genre')]);
            lListeTravauxAFaire.trier();
            var lListeCahiersDeTextes = this.JSONReponse.ListeCahierDeTextes || new ObjetListeElements();
            lListeCahiersDeTextes.parcourir(function(aCahierDeTexte) {
                lObjetDeserialiser.deserialiserCahierDeTexte(aCahierDeTexte);
            });
            var lListeRessourcesPedagogiques;
            if (!!this.JSONReponse.ListeRessourcesPedagogiques && !!this.JSONReponse.ListeRessourcesPedagogiques.listeRessources && this.JSONReponse.ListeRessourcesPedagogiques.listeRessources.GetNbrElements() > 0) {
                lListeRessourcesPedagogiques = this.JSONReponse.ListeRessourcesPedagogiques.listeRessources;
                lListeRessourcesPedagogiques.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant), ObjetTri.init('Libelle')]);
                lListeRessourcesPedagogiques.trier();
                var lListeMatieresRessourcesPeda = this.JSONReponse.ListeRessourcesPedagogiques.listeMatieres;
                if (!!lListeMatieresRessourcesPeda) {
                    lListeMatieresRessourcesPeda.parcourir(function(aMatiere) {
                        aMatiere.CouleurFond = aMatiere.couleur;
                    });
                    var lMatiereAvecDonneesCompletes = null;
                    lListeRessourcesPedagogiques.parcourir(function(aRessource) {
                        if (!!aRessource.matiere && !!aRessource.matiere.GetNumero()) {
                            lMatiereAvecDonneesCompletes = lListeMatieresRessourcesPeda.GetElementParNumero(aRessource.matiere.GetNumero());
                            if (!!lMatiereAvecDonneesCompletes) {
                                aRessource.matiere = lMatiereAvecDonneesCompletes;
                            }
                        }
                    });
                }
            }
            var lListeRessourcesNumeriques;
            if (!!this.JSONReponse.ListeRessourcesNumeriques && !!this.JSONReponse.ListeRessourcesNumeriques.listeRessources && this.JSONReponse.ListeRessourcesNumeriques.listeRessources.GetNbrElements() > 0) {
                lListeRessourcesNumeriques = this.JSONReponse.ListeRessourcesNumeriques.listeRessources;
                lListeRessourcesNumeriques.setTri([ObjetTri.init('titre')]);
                lListeRessourcesNumeriques.trier();
            }
            this.callbackReussite.appel({
                listeTAF: lListeTravauxAFaire,
                listeCDT: lListeCahiersDeTextes,
                listeDS: this.JSONReponse.listeDS,
                listeMatieres: this.JSONReponse.listeMatieres,
                listeRessourcesNumeriques: lListeRessourcesNumeriques,
                listeRessourcesPedagogiques: lListeRessourcesPedagogiques
            });
        };
        module.exports = ObjetRequetePageCahierDeTexte;
    },
    fn: "objetrequetepagecahierdetexte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetCahierDeTexte_Mobile = require('pagecahierdetexte_mobile.js');
        var ObjetCalendrierMobilePN = require('ObjetCalendrierPN.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var TypeDomaine = require('TypeDomaine.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetRequetePageCahierDeTexte = require('ObjetRequetePageCahierDeTexte.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageCahierDeTexte_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageCahierDeTexte_Mobile() {
            this.inheritedCreate(arguments);
            this.dateCourantExact = false;
        }
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.ConstruireInstances = function() {
            this.identCalendrier = this.Add(ObjetCalendrierMobilePN, this.evenementSurCalendrier, this.initialiserCalendrier);
            this.identPage = this.Add(ObjetCahierDeTexte_Mobile, this.evenementSurPage, this.initialiserPage);
            this.AddSurZone = [this.identCalendrier];
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.initialiserCalendrier = function(aInstance) {
            aInstance.estCalendrierAnnuel = true;
            aInstance.SetParametres({
                selectionPeriode: true
            });
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.initialiserPage = function(aInstance) {
            if (GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().Date) {
                aInstance.dateDeploiement = GEtatUtilisateur.getPage().Date;
                this.dateCourant = GEtatUtilisateur.getPage().Date;
                this.dateCourantExact = true;
            }
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.DetruireInstances = function() {};
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.RecupererDonnees = function() {
            $('#' + this.GetInstance(this.identPage).GetNom().escapeJQ()).css('min-height', ((parseInt($('#' + this.Nom.escapeJQ()).css('min-height')) - $('#' + this.GetInstance(this.identCalendrier).GetNom().escapeJQ()).height()) * 0.9) + 'px');
            this.actionSurRecupererDonnees();
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.actionSurRecupererDonnees = function() {
            if (!this.dateCourant) {
                this.dateCourant = !!GEtatUtilisateur.getNavigationDate() ? GEtatUtilisateur.getNavigationDate() : GEtatUtilisateur.getDerniereDate();
            }
            this.GetInstance(this.identCalendrier).SetDonnees(null, null, this.dateCourant, this.dateCourantExact);
            $('#' + this.GetInstance(this.identPage).GetNom().escapeJQ()).css('min-height', ((parseInt($('#' + this.Nom.escapeJQ()).css('min-height')) - $('#' + this.GetInstance(this.identCalendrier).GetNom().escapeJQ()).height()) * 0.9) + 'px');
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.evenementSwipe = function(event) {
            this.GetInstance(this.identCalendrier).incrementerJour(event.type === 'swiperight');
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.evenementSurCalendrier = function(aDate) {
            this.cycleCourant = IE.Cycles.cycleDeLaDate(aDate);
            new ObjetRequetePageCahierDeTexte(this, this.actionSurCalendrier).lancerRequete({
                domaine: new TypeDomaine(this.cycleCourant)
            });
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.evenementSurPage = function(aObjet) {
            if (!aObjet) {
                this.RecupererDonnees();
            }
            var lExecutionQCM = null,
                i, lElement;
            if (GEtatUtilisateur.genreOnglet === EGenreOnglet.CDT_TAF) {
                for (i = 0; i < this.ListeTravailAFaire.GetNbrElements(); i++) {
                    lElement = this.ListeTravailAFaire.GetElement(i);
                    if (lElement.executionQCM && !!aObjet && !!aObjet.executionQCM && lElement.executionQCM.GetNumero() === aObjet.executionQCM) {
                        lExecutionQCM = lElement.executionQCM;
                        break;
                    }
                }
            } else if (GEtatUtilisateur.genreOnglet === EGenreOnglet.CDT_Contenu) {
                for (i = 0; i < this.ListeCahierDeTextes.GetNbrElements(); i++) {
                    lElement = this.ListeCahierDeTextes.GetElement(i);
                    for (var j = 0; lElement.listeContenus && j < lElement.listeContenus.GetNbrElements(); j++) {
                        var lContenu = lElement.listeContenus.GetElement(j);
                        for (var k = 0; lContenu.listeExecutionQCM && k < lContenu.listeExecutionQCM.GetNbrElements(); k++) {
                            lExecutionQCM = lContenu.listeExecutionQCM.GetElement(k);
                            if (lExecutionQCM && lExecutionQCM.GetNumero() === aObjet.executionQCM) {
                                break;
                            }
                        }
                        if (lExecutionQCM && lExecutionQCM.GetNumero() === aObjet.executionQCM) {
                            break;
                        }
                    }
                    if (lExecutionQCM && lExecutionQCM.GetNumero() === aObjet.executionQCM) {
                        break;
                    }
                }
            }
            if (lExecutionQCM) {
                this.callback.appel({
                    genreOnglet: GEtatUtilisateur.genreOnglet,
                    executionQCM: lExecutionQCM
                });
            }
        };
        ObjetAffichagePageCahierDeTexte_Mobile.prototype.actionSurCalendrier = function(aParametres) {
            this.ListeTravailAFaire = aParametres.listeTAF;
            this.ListeCahierDeTextes = aParametres.listeCDT;
            this.GetInstance(this.identPage).SetDonnees(this.Pere.GenreOnglet, this.ListeTravailAFaire, this.ListeCahierDeTextes, this.cycleCourant);
        };
        module.exports = ObjetAffichagePageCahierDeTexte_Mobile;
    },
    fn: "interfacepagecahierdetexte_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var MethodesTableau = require('MethodesTableau.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var GHtml = require('GHtml.js');
        var UtilitaireManuelsNumeriques = require('UtilitaireManuelsNumeriques.js');

        function ObjetInterfaceManuelsNumeriques_Mobile() {
            this.inheritedCreate(arguments);
            this.options = {
                avecNomEditeur: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_PrimProfesseur]),
                avecDetailsRessources: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_PrimProfesseur]),
                avecCumulMatiere: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_PrimEleve])
            };
        }
        MethodesObjet.heritagePrototype(ObjetInterfaceManuelsNumeriques_Mobile, ObjetInterfacePage_Mobile);
        Requetes.inscrire('ManuelsNumeriques', ObjetRequeteConsultation);
        ObjetInterfaceManuelsNumeriques_Mobile.prototype.RecupererDonnees = function() {
            this.ActualiserDonnees();
        };
        ObjetInterfaceManuelsNumeriques_Mobile.prototype.ActualiserDonnees = function() {
            Requetes('ManuelsNumeriques', this, _surRecupererDonnees.bind(this)).lancerRequete();
        };
        ObjetInterfaceManuelsNumeriques_Mobile.prototype.getControleur = function() {
            return {};
        };

        function _surRecupererDonnees(aJSON) {
            aJSON.kiosque.listeRessources.setTri([
                ObjetTri.init(function(D) {
                    return D.matiere ? !D.matiere.existeNumero() : false;
                }), ObjetTri.init(function(D) {
                    return D.matiere ? D.matiere.GetLibelle() : '';
                }), ObjetTri.init('editeur'), ObjetTri.init('titre')
            ]);
            aJSON.kiosque.listeRessources.trier();
            var lHtml = [];
            lHtml.push(UtilitaireManuelsNumeriques.composeListeManuelsNumeriques_Mobile(aJSON.kiosque.listeRessources, this.options, this.controleur));
            GHtml.setHtml(this.Nom, lHtml.join(''), {
                controleur: this.controleur
            });
        }
        module.exports = ObjetInterfaceManuelsNumeriques_Mobile;
    },
    fn: "interfacemanuelsnumeriques_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var UtilitaireBulletinEtReleve_Mobile = {};
        UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees = function(aIntitule, aContenu) {
            var lHtml = [];
            lHtml.push('<div class="petitBlocDonnees">', '<div>', aIntitule, '</div>', '<div>', (aContenu || '&nbsp;'), '</div>', '</div>');
            return lHtml.join('');
        };
        UtilitaireBulletinEtReleve_Mobile.composeAppreciation = function(aParam) {
            var lHtml = [];
            lHtml.push('<div class="Espace">');
            lHtml.push('<div class="left-align" style="', (!!aParam.styleBlockIntitule ? aParam.styleBlockIntitule : ''), '">', aParam.intituleDAppreciation, '</div>');
            lHtml.push('<div class="Espace" style="', (!!aParam.styleBlockContenu ? aParam.styleBlockContenu : ''), '">');
            if ($.isArray(aParam.contenuDAppreciation)) {
                lHtml = lHtml.concat(aParam.contenuDAppreciation);
            } else {
                lHtml.push(aParam.contenuDAppreciation);
            }
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        UtilitaireBulletinEtReleve_Mobile.composeVieScolaire = function(aDonneesAbsences) {
            var lHtml = [];
            for (var lAbs in aDonneesAbsences) {
                if (aDonneesAbsences[lAbs] && aDonneesAbsences[lAbs] !== "") {
                    lHtml.push('<div class="Espace">');
                    lHtml.push('<div>' + aDonneesAbsences[lAbs] + '</div>');
                    lHtml.push('</div>');
                }
            }
            return lHtml.join('');
        };
        module.exports = UtilitaireBulletinEtReleve_Mobile;
    },
    fn: "utilitairebulletinetreleve_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetElement = require('ObjetElement.js');
        var EGenreEvolution = {
            Aucune: 0,
            Progres: 1,
            Regularite: 2,
            Regression: 3
        };
        EGenreEvolution.getLibelle = function(aGenre) {
            switch (aGenre) {
                case EGenreEvolution.Aucune:
                    return GTraductions.getValeur('Aucune');
                case EGenreEvolution.Progres:
                    return GTraductions.getValeur('BulletinEtReleve.Progres');
                case EGenreEvolution.Regularite:
                    return GTraductions.getValeur('BulletinEtReleve.Regulier');
                case EGenreEvolution.Regression:
                    return GTraductions.getValeur('BulletinEtReleve.Regression');
            }
        };
        EGenreEvolution.getImage = function(aGenre) {
            var H = [];
            H.push('<div>');
            H.push((aGenre ? '<img src="images/evolution_' + aGenre + '.gif"></img>' : ''));
            H.push('</div>');
            return H.join('');
        };
        EGenreEvolution.getListePourMenu = function() {
            var lEvolution, lListeEvolutions = new ObjetListeElements();
            var lTabGenres = [
                EGenreEvolution.Aucune, EGenreEvolution.Progres, EGenreEvolution.Regularite, EGenreEvolution.Regression
            ];
            var i, lNbr, lGenre;
            for (i = 0, lNbr = lTabGenres.length; i < lNbr; i++) {
                lGenre = lTabGenres[i];
                lEvolution = new ObjetElement(EGenreEvolution.getLibelle(lGenre), lGenre, lGenre);
                lEvolution.image = EGenreEvolution.getImage(lGenre);
                lListeEvolutions.AddElement(lEvolution);
            }
            return lListeEvolutions;
        };
        module.exports = EGenreEvolution;
    },
    fn: "enumere_evolution.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var TypeModuleFonctionnelPiedBulletin = {
            MFPB_VieScolaire: 0,
            MFPB_Certificats: 1,
            MFPB_Appreciations: 2,
            MFPB_ParcoursEducatif: 3,
            MFPB_Competences: 4,
            MFPB_Stages: 5,
            MFPB_Orientations: 6,
            MFPB_Mentions: 7,
            MFPB_Legende: 8,
            MFPB_Projets: 9,
            MFPB_Credits: 10,
            MFPB_Appreciations_Generales_Annuelles: 11,
            MFPB_Appreciations_Annuelles: 12
        };
        TypeModuleFonctionnelPiedBulletin.getLibelle = function(aGenre) {
            switch (aGenre) {
                case this.MFPB_ParcoursEducatif:
                    return GTraductions.getValeur('ParcoursPeda.ComboGenreParcours');
                case this.MFPB_Stages:
                    return GTraductions.getValeur('PiedDeBulletin.Onglet.Titre.Stages');
                case this.MFPB_Competences:
                    return GTraductions.getValeur('PiedDeBulletin.Compétences');
                case this.MFPB_Orientations:
                    return GTraductions.getValeur('PiedDeBulletin.Orientations');
                case this.MFPB_Appreciations:
                    return GTraductions.getValeur('ConseilDeClasse');
                case this.MFPB_Mentions:
                    return GTraductions.getValeur('Appreciations.Mentions');
                case this.MFPB_Certificats:
                    return GTraductions.getValeur('FicheEleve.attestations');
                case this.MFPB_Credits:
                    return GTraductions.getValeur('PiedDeBulletin.CreditsAnnuel');
                case this.MFPB_Appreciations_Annuelles:
                    return GTraductions.getValeur('PiedDeBulletin.AppreciationsAnnuelles');
                case this.MFPB_Appreciations_Generales_Annuelles:
                    return GTraductions.getValeur('PiedDeBulletin.AppreciationsAnnuellesGenerales');
                default:
                    return '';
            }
        };
        TypeModuleFonctionnelPiedBulletin.getTabTousLesModules = function() {
            var lTousModules = [];
            var lKeysObject = Object.keys(TypeModuleFonctionnelPiedBulletin);
            for (var i = 0; i < lKeysObject.length; i++) {
                var lValeurEnum = TypeModuleFonctionnelPiedBulletin[lKeysObject[i]];
                if (typeof(lValeurEnum) === 'number') {
                    lTousModules.push(lValeurEnum);
                }
            }
            return lTousModules;
        };
        module.exports = TypeModuleFonctionnelPiedBulletin;
    },
    fn: "typemodulefonctionnelpiedbulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeContexteBulletin = {
            CB_Eleve: 0,
            CB_Classe: 1
        };
        module.exports = TypeContexteBulletin;
    },
    fn: "typecontextebulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeModeAffichagePiedBulletin = {
            MAPB_Onglets: 0,
            MAPB_Lineaire: 1,
            MAPB_Accessible: 2
        };
        module.exports = TypeModeAffichagePiedBulletin;
    },
    fn: "typemodeaffichagepiedbulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreAppreciation = {
            GA_Bulletin_Professeur: 0,
            GA_Bulletin_Generale: 1,
            GA_Bulletin_CPE: 2,
            GA_Releve_Professeur: 3,
            GA_Releve_Generale: 4,
            GA_BilanAnnuel_Professeur: 5,
            GA_BilanAnnuel_Generale: 6,
            GA_Observations_Competences: 7,
            GA_BulletinCompetence_Professeur: 8,
            GA_BulletinCompetence_Generale: 9,
            GA_BulletinCompetence_CPE: 10
        };
        module.exports.TypeGenreAppreciation = TypeGenreAppreciation;
    },
    fn: "typegenreappreciation.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreAppreciationGenerale = {
            AG_Assiduite: 1,
            AG_Autonomie: 2,
            AG_Globale: 3,
            AG_Commentaire1: 4,
            AG_Commentaire2: 5,
            AG_Commentaire3: 6,
            AG_CPE: 7,
            AG_Mention: 8
        };
        module.exports = EGenreAppreciationGenerale;
    },
    fn: "enumere_appreciationgenerale.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeReleveBulletin = {
            ReleveDeNotes: 0,
            BulletinNotes: 1,
            BulletinCompetences: 2,
            ReleveCompetences: 3,
            LivretScolaire: 4,
            AppreciationsBulletinParEleve: 5,
            AppreciationsBulletinProfesseur: 6,
            AppreciationsReleveProfesseur: 7,
            AvisProfesseur: 8
        };
        module.exports = TypeReleveBulletin;
    },
    fn: "typerelevebulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        function ObjetMoteurGrilleSaisie() {}
        ObjetMoteurGrilleSaisie.prototype.selectionCelluleSuivante = function(aParam) {
            aParam.instanceListe.selectionnerCelluleSuivante(Object.assign({
                entrerEdition: true
            }, aParam.suivante));
        };
        ObjetMoteurGrilleSaisie.prototype.estColVariable = function(aIdCol, aRacineCol) {
            return (aIdCol !== null) && (aIdCol !== undefined) ? aIdCol.startsWith(aRacineCol) : false;
        };
        ObjetMoteurGrilleSaisie.prototype.getIdColVariable = function(aIndice, aRacineCol) {
            return aRacineCol + '_' + aIndice;
        };
        ObjetMoteurGrilleSaisie.prototype.getIndiceColVariable = function(aIdCol) {
            if ((aIdCol !== null) && (aIdCol !== undefined)) {
                var lTab = aIdCol.split('_');
                var lTaille = lTab.length;
                return parseInt(lTab[lTaille - 1]);
            }
            return 0;
        };
        module.exports = ObjetMoteurGrilleSaisie;
    },
    fn: "objetmoteurgrillesaisie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var TypeModuleFonctionnelPiedBulletin = require('TypeModuleFonctionnelPiedBulletin.js');
        var TypeContexteBulletin = require('TypeContexteBulletin.js');
        var TypeModeAffichagePiedBulletin = require('TypeModeAffichagePiedBulletin.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var TypeGenreAppreciation = require('TypeGenreAppreciation.js').TypeGenreAppreciation;
        var EGenreAppreciationGenerale = require('Enumere_AppreciationGenerale.js');
        var TypeReleveBulletin = require('TypeReleveBulletin.js');
        var ObjetMoteurGrilleSaisie = require('ObjetMoteurGrilleSaisie.js');

        function ObjetMoteurPiedDeBulletin() {
            this.moteurGrille = new ObjetMoteurGrilleSaisie();
        }
        ObjetMoteurPiedDeBulletin.prototype.getContexteBulletin = function(aParam) {
            switch (aParam.typeReleveBulletin) {
                case TypeReleveBulletin.BulletinNotes: {
                    var lCtxEleve = ((aParam !== null) && (aParam !== undefined) && aParam.estCtxEleve);
                    return lCtxEleve ? TypeContexteBulletin.CB_Eleve : TypeContexteBulletin.CB_Classe;
                }
                case TypeReleveBulletin.ReleveDeNotes:
                    return TypeContexteBulletin.CB_Eleve;
                case TypeReleveBulletin.AppreciationsBulletinProfesseur:
                    return TypeContexteBulletin.CB_Classe;
                default:
                    ;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.getModulesHorsOnglets = function(aParam) {
            var lContexteBulletin = aParam.typeContexteBulletin;
            var lAvecSaisie = aParam.avecSaisie;
            switch (aParam.typeReleveBulletin) {
                case TypeReleveBulletin.BulletinNotes:
                    if (lAvecSaisie) {
                        return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire] : [TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire];
                    } else {
                        return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Competences, TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire, TypeModuleFonctionnelPiedBulletin.MFPB_Certificats] : [TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire];
                    }
                    case TypeReleveBulletin.ReleveDeNotes:
                        return [TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire];
                    case TypeReleveBulletin.BulletinCompetences:
                        if (lAvecSaisie) {
                            return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire] : [TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire];
                        } else {
                            return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire, TypeModuleFonctionnelPiedBulletin.MFPB_Certificats] : [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire];
                        }
                        case TypeReleveBulletin.ReleveCompetences:
                            ;
                            return lAvecSaisie ? [TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire] : [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Projets, TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire, TypeModuleFonctionnelPiedBulletin.MFPB_Certificats];
                        case TypeReleveBulletin.AppreciationsBulletinParEleve:
                            return [];
                        default:
                            ;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.getModulesOnglets = function(aParam) {
            var lAvecSaisie = aParam.avecSaisie;
            var lContexteBulletin = aParam.typeContexteBulletin;
            switch (aParam.typeReleveBulletin) {
                case TypeReleveBulletin.BulletinNotes:
                    if (lAvecSaisie) {
                        return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Competences, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Stages, TypeModuleFonctionnelPiedBulletin.MFPB_Certificats, TypeModuleFonctionnelPiedBulletin.MFPB_Credits] : [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Mentions, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations];
                    } else {
                        return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Stages, TypeModuleFonctionnelPiedBulletin.MFPB_Legende, TypeModuleFonctionnelPiedBulletin.MFPB_Credits] : [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Mentions];
                    }
                    case TypeReleveBulletin.ReleveDeNotes:
                        return [TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations];
                    case TypeReleveBulletin.BulletinCompetences:
                        if (lAvecSaisie) {
                            return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Competences, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Stages, TypeModuleFonctionnelPiedBulletin.MFPB_Certificats] : [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Mentions];
                        } else {
                            return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? [TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Competences, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Stages, TypeModuleFonctionnelPiedBulletin.MFPB_Legende] : [TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Mentions, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations];
                        }
                        case TypeReleveBulletin.ReleveCompetences:
                            ;
                            return lAvecSaisie ? [TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif, TypeModuleFonctionnelPiedBulletin.MFPB_Competences, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Stages, TypeModuleFonctionnelPiedBulletin.MFPB_Certificats] : [TypeModuleFonctionnelPiedBulletin.MFPB_Orientations, TypeModuleFonctionnelPiedBulletin.MFPB_Competences, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations, TypeModuleFonctionnelPiedBulletin.MFPB_Stages, TypeModuleFonctionnelPiedBulletin.MFPB_Legende];
                        case TypeReleveBulletin.AppreciationsBulletinParEleve:
                            return [
                                TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations_Annuelles, TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations_Generales_Annuelles
                            ];
                        default:
                            ;
            }
        };

        function _getModuleParDefaut(aParam) {
            var lAvecSaisie = aParam.avecSaisie;
            var lContexteBulletin = aParam.typeContexteBulletin;
            switch (aParam.typeReleveBulletin) {
                case TypeReleveBulletin.BulletinNotes:
                    if (lAvecSaisie) {
                        return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? TypeModuleFonctionnelPiedBulletin.MFPB_Orientations : TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations;
                    } else {
                        return null;
                    }
                    case TypeReleveBulletin.ReleveDeNotes:
                        return lAvecSaisie ? TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations : null;
                    case TypeReleveBulletin.BulletinCompetences:
                        if (lAvecSaisie) {
                            return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? TypeModuleFonctionnelPiedBulletin.MFPB_Orientations : TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations;
                        } else {
                            return (lContexteBulletin === TypeContexteBulletin.CB_Eleve) ? null : TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations;
                        }
                        case TypeReleveBulletin.ReleveCompetences:
                            ;
                            return lAvecSaisie ? TypeModuleFonctionnelPiedBulletin.MFPB_Orientations : null;
                        case TypeReleveBulletin.AppreciationsBulletinParEleve:
                            return TypeModuleFonctionnelPiedBulletin.MFPB_Orientations;
                        default:
                            ;
            }
        }

        function _getModeAffichage(aParam) {
            if (aParam.typeReleveBulletin === TypeReleveBulletin.AppreciationsBulletinParEleve) {
                return TypeModeAffichagePiedBulletin.MAPB_Onglets;
            }
            var lAvecSaisie = aParam.avecSaisie;
            if (GEtatUtilisateur.estModeAccessible()) {
                return TypeModeAffichagePiedBulletin.MAPB_Accessible;
            } else {
                return lAvecSaisie ? TypeModeAffichagePiedBulletin.MAPB_Onglets : TypeModeAffichagePiedBulletin.MAPB_Lineaire;
            }
        }
        ObjetMoteurPiedDeBulletin.prototype.initPiedPage = function(aInstance, aParam) {
            var lContexteBulletin = (aParam.typeContexteBulletin !== null) && (aParam.typeContexteBulletin !== undefined) ? aParam.typeContexteBulletin : this.getContexteBulletin(aParam);
            var lParam = $.extend(aParam, {
                typeContexteBulletin: lContexteBulletin
            });
            var lParametres = {
                typeReleveBulletin: lParam.typeReleveBulletin,
                modeSaisie: lParam.avecSaisie,
                modeAffichage: _getModeAffichage.call(this, lParam),
                contexte: lContexteBulletin,
                modulesHorsOnglets: this.getModulesHorsOnglets(lParam),
                modulesOnglets: this.getModulesOnglets(lParam),
                avecContenuVide: lParam.avecSaisie,
                avecValidationAuto: lParam.avecValidationAuto,
                clbckValidationAutoSurEdition: lParam.clbckValidationAutoSurEdition
            };
            var lDefaultModule = _getModuleParDefaut.call(this, lParam);
            if (lDefaultModule !== null) {
                $.extend(lParametres, {
                    moduleParDefaut: lDefaultModule
                });
            }
            aInstance.setParametres(lParametres);
        };
        ObjetMoteurPiedDeBulletin.prototype.estAppreciationGenerale = function(aParam) {
            if (!aParam.appreciation) {
                return false;
            }
            return this.estGenreApprGenerale(aParam.appreciation.Genre);
        };
        ObjetMoteurPiedDeBulletin.prototype.estGenreApprGenerale = function(aGenreAppr) {
            switch (aGenreAppr) {
                case 0:
                    return true;
                default:
                    return false;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.estAppreciationConseilDeClasse = function(aParam) {
            if (!aParam.appreciation) {
                return false;
            }
            return this.estGenreApprConseilDeClasse(aParam.appreciation.Genre);
        };
        ObjetMoteurPiedDeBulletin.prototype.estGenreApprConseilDeClasse = function(aGenreAppr) {
            switch (aGenreAppr) {
                case EGenreAppreciationGenerale.AG_Assiduite:
                case EGenreAppreciationGenerale.AG_Autonomie:
                case EGenreAppreciationGenerale.AG_Globale:
                case EGenreAppreciationGenerale.AG_Mention:
                    return true;
                default:
                    return false;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.estMention = function(aParam) {
            return (!!aParam.appreciation && (aParam.appreciation.Genre === EGenreAppreciationGenerale.AG_Mention));
        };
        ObjetMoteurPiedDeBulletin.prototype.estAppreciationCommentaire = function(aParam) {
            if (!aParam.appreciation) {
                return false;
            }
            return this.estGenreApprCommentaire(aParam.appreciation.Genre);
        };
        ObjetMoteurPiedDeBulletin.prototype.estGenreApprCommentaire = function(aGenreAppr) {
            switch (aGenreAppr) {
                case EGenreAppreciationGenerale.AG_Commentaire1:
                case EGenreAppreciationGenerale.AG_Commentaire2:
                case EGenreAppreciationGenerale.AG_Commentaire3:
                    return true;
                default:
                    return false;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.estAppreciationCPE = function(aParam) {
            if (!aParam.appreciation) {
                return false;
            }
            return this.estGenreApprCPE(aParam.appreciation.Genre);
        };
        ObjetMoteurPiedDeBulletin.prototype.estGenreApprCPE = function(aGenreAppr) {
            switch (aGenreAppr) {
                case EGenreAppreciationGenerale.AG_CPE:
                    return true;
                default:
                    return false;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.getTypeGenreAppreciationPdB = function(aParam) {
            if (this.estGenreApprGenerale(aParam.genreAppr)) {
                return aParam.typeReleveBulletin === TypeReleveBulletin.ReleveDeNotes ? TypeGenreAppreciation.GA_Releve_Generale : TypeGenreAppreciation.GA_Bulletin_Generale;
            } else if ((this.estGenreApprConseilDeClasse(aParam.genreAppr) || this.estGenreApprCommentaire(aParam.genreAppr))) {
                return TypeGenreAppreciation.GA_Bulletin_Generale;
            } else if (this.estGenreApprCPE(aParam.genreAppr)) {
                return TypeGenreAppreciation.GA_Bulletin_CPE;
            };
            return null;
        };
        ObjetMoteurPiedDeBulletin.prototype.avecAppCPE = function(aParam) {
            return (aParam.typeReleveBulletin === TypeReleveBulletin.BulletinNotes) || (aParam.typeReleveBulletin === TypeReleveBulletin.BulletinCompetences);
        };
        ObjetMoteurPiedDeBulletin.prototype.avecAppConseilDeClasse = function(aParam) {
            return (aParam.typeReleveBulletin === TypeReleveBulletin.BulletinNotes) || (aParam.typeReleveBulletin === TypeReleveBulletin.BulletinCompetences);
        };
        ObjetMoteurPiedDeBulletin.prototype.avecAppCommentaire = function(aParam) {
            return ((aParam.typeReleveBulletin === TypeReleveBulletin.BulletinNotes) || (aParam.typeReleveBulletin === TypeReleveBulletin.BulletinCompetences)) && (aParam.contexte === TypeContexteBulletin.CB_Eleve);
        };
        ObjetMoteurPiedDeBulletin.prototype.avecAppAG = function(aParam) {
            return (aParam.typeReleveBulletin === TypeReleveBulletin.ReleveDeNotes);
        };
        ObjetMoteurPiedDeBulletin.prototype.evenementOuvrirMentions = function(aParam) {
            var lFenetre = aParam.instanceFenetre;
            if ((lFenetre !== null) && (lFenetre !== undefined)) {
                lFenetre.SetDonnees(aParam.listeMentions);
                lFenetre.FocusSurPremierElement();
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.initialiserMentions = function(aParam) {
            var lFenetre = aParam.instanceFenetre;
            lFenetre.setParametres_Mention(GTraductions.getValeur('Appreciations.Mentions'));
            lFenetre.SetParametres_Fenetre(GTraductions.getValeur('Appreciations.SaisieMentions'), 300, 300, [GTraductions.getValeur('Annuler'), GTraductions.getValeur('Valider')]);
        };
        ObjetMoteurPiedDeBulletin.prototype.evenementMention = function(aGenreBouton, aParam) {
            var lElmtMention = aParam.instanceFenetre.getMentionSelectionnee();
            $.extend(aParam, {
                eltSelectionne: lElmtMention
            });
            this.traiterSelectionMention(aGenreBouton, aParam);
        };
        ObjetMoteurPiedDeBulletin.prototype.traiterSelectionMention = function(aGenreBouton, aParam) {
            switch (aGenreBouton) {
                case (1):
                    this.validerDonneesMentionSurValider(aParam);
                    var lInstanceListe = aParam.instanceListe;
                    if (aParam.avecValidationAuto === true && aParam.clbckValidationAutoSurEdition !== null && aParam.clbckValidationAutoSurEdition !== undefined) {
                        var lParam = {
                            instanceListe: lInstanceListe,
                            appreciation: aParam.appreciation
                        };
                        if (aParam.global === true) {
                            $.extend(lParam, {
                                periode: aParam.article
                            });
                        }
                        aParam.clbckValidationAutoSurEdition(lParam);
                    } else {
                        lInstanceListe.Actualiser(true);
                        this.moteurGrille.selectionCelluleSuivante({
                            instanceListe: lInstanceListe,
                            suivante: {
                                orientationVerticale: false
                            }
                        });
                    }
                    break;
                default:
                    break;
            }
        };
        ObjetMoteurPiedDeBulletin.prototype.validerDonneesMentionSurValider = function(aParam) {
            aParam.article.SetEtat(EGenreEtat.Modification);
            var lAppreciation = aParam.appreciation;
            var lElmtSelectionne = aParam.eltSelectionne;
            if (lElmtSelectionne && lElmtSelectionne.existeNumero()) {
                lAppreciation.SetEtat(EGenreEtat.Modification);
                lAppreciation.SetLibelle(lElmtSelectionne.GetLibelle());
            } else {
                lAppreciation.SetEtat(EGenreEtat.Suppression);
                lAppreciation.Libelle = '';
            }
            lAppreciation.SetNumero(lElmtSelectionne.GetNumero());
        };

        function _majAppreciation(aParam) {
            var lDonnees = aParam.instanceListe.getDonneesListe().Donnees;
            var lIndice = lDonnees.getIndiceElementParFiltre(function(aElt) {
                if (aParam.parPeriode) {
                    return aElt.GetNumero() === aParam.numeroPeriode;
                } else {
                    return aElt.GetGenre() === aParam.rangAppr;
                }
            }.bind(this));
            var lLigne = lDonnees.GetElement(lIndice);
            var lListe = aParam.parPeriode ? (aParam.global === true ? lLigne.listeAppreciationsGenerales : lLigne.listeAppreciations) : lLigne.ListeAppreciations;
            var lIndiceAppr = lListe.getIndiceElementParFiltre(function(aElt) {
                return (aElt.GetGenre() === aParam.apprSaisie.GetGenre());
            }.bind(this));
            if (lIndiceAppr !== -1) {
                var lAppr = lListe.GetElement(lIndiceAppr);
                var lApprSaisie = aParam.apprSaisie;
                lAppr.SetLibelle(lApprSaisie.GetLibelle());
                lAppr.SetNumero(lApprSaisie.GetNumero());
                lAppr.SetEtat(lApprSaisie.Etat);
            } else {}
        }
        ObjetMoteurPiedDeBulletin.prototype.majAppreciationPdBParPeriode = function(aParam) {
            _majAppreciation.call(this, $.extend(aParam, {
                parPeriode: true
            }));
        };
        ObjetMoteurPiedDeBulletin.prototype.majAppreciationPdB = function(aParam) {
            _majAppreciation.call(this, $.extend(aParam, {
                parPeriode: false
            }));
        };
        ObjetMoteurPiedDeBulletin.prototype.clbckValidationAutoSurEditionPdB = function(aCtx, aParam) {
            var lListe = aParam.instanceListe;
            var lEstCtxPiedBulletin = true;
            var lAppr = aParam.appreciation;
            aCtx.clbckSaisieAppreciation({
                instanceListe: lListe,
                estCtxPied: lEstCtxPiedBulletin,
                global: aParam.global,
                suivante: aParam.suivante
            }, {
                classe: aCtx.classe,
                periode: aCtx.periode,
                eleve: aCtx.eleve,
                service: aCtx.service,
                appreciation: lAppr,
                typeGenreAppreciation: this.getTypeGenreAppreciationPdB({
                    estCtxPied: lEstCtxPiedBulletin,
                    eleve: aCtx.eleve,
                    typeReleveBulletin: aCtx.typeReleveBulletin,
                    genreAppr: lAppr ? lAppr.Genre : null
                })
            });
        };
        module.exports = ObjetMoteurPiedDeBulletin;
    },
    fn: "objetmoteurpieddebulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeGenreParcoursEducatif = {
            GPE_ParcoursAvenir: 0,
            GPE_ParcoursCitoyen: 1,
            GPE_ParcoursArtistique: 2,
            GPE_ParcoursSante: 3,
            GPE_ParcoursExcellence: 4
        };
        module.exports.TypeGenreParcoursEducatif = TypeGenreParcoursEducatif;
        TypeGenreParcoursEducatif.getLibelle = function(aGenre) {
            if (GParametres.pourNouvelleCaledonie) {
                switch (aGenre) {
                    case this.GPE_ParcoursAvenir:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Orientation');
                    case this.GPE_ParcoursCitoyen:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Civique');
                    case this.GPE_ParcoursArtistique:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Artistique');
                    case this.GPE_ParcoursExcellence:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Excellence');
                    default:
                        ;
                        return '';
                }
            } else {
                switch (aGenre) {
                    case this.GPE_ParcoursAvenir:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Avenir');
                    case this.GPE_ParcoursCitoyen:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Citoyen');
                    case this.GPE_ParcoursArtistique:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Artistique');
                    case this.GPE_ParcoursSante:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Sante');
                    case this.GPE_ParcoursExcellence:
                        return GTraductions.getValeur('TypeGenreParcoursEducatif.libelle.Excellence');
                    default:
                        ;
                        return '';
                }
            }
        };
        TypeGenreParcoursEducatif.toListe = function() {
            var lListe = new ObjetListeElements();
            for (var iGenre in TypeGenreParcoursEducatif) {
                var lGenre = TypeGenreParcoursEducatif[iGenre];
                if (MethodesObjet.isNumber(lGenre)) {
                    lListe.AddElement(new ObjetElement(TypeGenreParcoursEducatif.getLibelle(lGenre), 0, lGenre));
                }
            }
            lListe.setTri([ObjetTri.init('Genre')]);
            lListe.trier();
            return lListe;
        };
    },
    fn: "typegenreparcourseducatif.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeRubriqueOrientation = {
            RO_IntentionFamille: 0,
            RO_AutreRecommandationConseil: 1,
            RO_VoeuDefinitif: 2,
            RO_AutrePropositionConseil: 3,
            RO_DecisionRetenue: 4,
            RO_OrientationEffective: 5
        };
        module.exports.TypeRubriqueOrientation = TypeRubriqueOrientation;
    },
    fn: "typerubriqueorientation.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeAvisConseil = {
            taco_Aucun: 0,
            taco_TresFavorable: 1,
            taco_Favorable: 2,
            taco_Reserve: 3,
            taco_Defavorable: 4
        };
        module.exports.TypeAvisConseil = TypeAvisConseil;
        TypeAvisConseil.toListe = function() {
            var lArray = [];
            for (var lType in TypeAvisConseil) {
                var lValeurType = TypeAvisConseil[lType];
                if (MethodesObjet.isNumber(lValeurType)) {
                    lArray.push(lValeurType);
                }
            }
            return lArray;
        };
        TypeAvisConseil.getLibelle = function(aTypeAvis) {
            return GTraductions.getValeur('TypeAvisConseil.Libelle.type_' + aTypeAvis);
        };
        TypeAvisConseil.getLibelleOuiNon = function(aTypeAvis) {
            return GTraductions.getValeur('TypeAvisConseil.LibelleOuiNon.type_' + aTypeAvis);
        };
        TypeAvisConseil.getAbbreviation = function(aTypeAvis) {
            return GTraductions.getValeur('TypeAvisConseil.Abbreviation.type_' + aTypeAvis);
        };
    },
    fn: "typeavisconseil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GTraductions = require('ObjetTraduction.js');
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetMoteurPiedDeBulletin = require('ObjetMoteurPiedDeBulletin.js');
        var TypeModuleFonctionnelPiedBulletin = require('TypeModuleFonctionnelPiedBulletin.js');
        var TypeGenreParcoursEducatif = require('TypeGenreParcoursEducatif.js').TypeGenreParcoursEducatif;
        var TypeRubriqueOrientation = require('TypeRubriqueOrientation.js').TypeRubriqueOrientation;
        var TypeAvisConseil = require('TypeAvisConseil.js').TypeAvisConseil;
        var UtilitaireBulletinEtReleve_Mobile = require('UtilitaireBulletinEtReleve_Mobile.js');
        require('espace/css/InterfacePageOrientation.css');
        MethodesObjet.heritagePrototype(PiedDeBulletinMobile, ObjetIdentite_Mobile);

        function PiedDeBulletinMobile() {
            this.inheritedCreate(arguments);
            this.moteurPdB = new ObjetMoteurPiedDeBulletin();
            this.donneesContexte = {
                typeContexteBulletin: 0,
                avecSaisie: false,
                typeReleveBulletin: 0
            };
            this.donneesPiedDeBulletin = null;
            this.donneesAbsences = null;
        }
        PiedDeBulletinMobile.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            var lModulesHorsOnglet = this.moteurPdB.getModulesHorsOnglets(this.donneesContexte);
            for (var i = 0; i < lModulesHorsOnglet.length; i++) {
                lHtml.push('<div class="PDB_ModuleFonctionnel">', construireModuleFonctionnel.call(this, lModulesHorsOnglet[i]), '</div>');
            }
            var lModulesOnglet = this.moteurPdB.getModulesOnglets(this.donneesContexte);
            for (var j = 0; j < lModulesOnglet.length; j++) {
                lHtml.push('<div class="PDB_ModuleFonctionnel">', construireModuleFonctionnel.call(this, lModulesOnglet[j]), '</div>');
            }
            return lHtml.join('');
        };

        function construireModuleFonctionnel(aTypeModuleFonctionnel) {
            var H = [];
            switch (aTypeModuleFonctionnel) {
                case TypeModuleFonctionnelPiedBulletin.MFPB_VieScolaire:
                    H.push(_construireVieScolaire(this.donneesPiedDeBulletin, this.donneesAbsences));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Certificats:
                    H.push(_construireAttestations(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Appreciations:
                    H.push(_construireListeAppreciations(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_ParcoursEducatif:
                    H.push(_construireParcoursEducatif(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Competences:
                    H.push(_construireBilanDeCycle(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Stages:
                    H.push(_construireStages(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Orientations:
                    H.push(_construireOrientations(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Legende:
                    H.push(_construireLegende(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Projets:
                    H.push(_construireProjets(this.donneesPiedDeBulletin));
                    break;
                case TypeModuleFonctionnelPiedBulletin.MFPB_Credits:
                    H.push(_construireCredits(this.donneesPiedDeBulletin));
                    break;
                default:
                    ;
                    break;
            }
            return H.join('');
        }
        PiedDeBulletinMobile.prototype.setDonneesContexte = function(aDonnees) {
            Object.assign(this.donneesContexte, aDonnees);
        };
        PiedDeBulletinMobile.prototype.setDonneesPiedDeBulletin = function(aDonnees, aDonneesAbsences) {
            this.donneesPiedDeBulletin = aDonnees;
            this.donneesAbsences = aDonneesAbsences;
        };

        function _construireVieScolaire(aDonneesPiedDeBulletin, aDonneesAbsences) {
            var lHtml = [];
            lHtml.push('<div style="margin-top:10px;">', UtilitaireBulletinEtReleve_Mobile.composeVieScolaire(aDonneesAbsences), '</div>');
            return lHtml.join('');
        }

        function _construireAttestations(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.ListeAttestationsEleve) {
                lHtml.push('<div>', '<ul style="display:table;">');
                aDonneesPiedDeBulletin.ListeAttestationsEleve.parcourir(function(aAttestation) {
                    lHtml.push('<li style="display:table-row;">', '<span style="display:table-cell;">- ', aAttestation.GetLibelle(), '</span>', '<div class="Italique GrandEspaceGauche">', aAttestation.delivree ? GTraductions.getValeur('FicheEleve.delivree') + ' ' + GDate.FormatDate(aAttestation.date, '%JJ/%MM/%AAAA') : GTraductions.getValeur('FicheEleve.nonDelivree'), '</div>', '</li>');
                });
                lHtml.push('</ul>', '</div>');
            }
            return lHtml.join('');
        }

        function _construireListeAppreciations(aDonneesPiedDeBulletin) {
            var lHtml = [];
            var i;
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.ListeAppreciations) {
                if (!!aDonneesPiedDeBulletin.ListeAppreciations.commentaires && !!aDonneesPiedDeBulletin.ListeAppreciations.commentaires.GetNbrElements()) {
                    var lCommentaires = aDonneesPiedDeBulletin.ListeAppreciations.commentaires;
                    var lNbrCommentaires;
                    for (i = 0, lNbrCommentaires = lCommentaires.GetNbrElements(); i < lNbrCommentaires; i++) {
                        var lCommentaire = lCommentaires.GetElement(i);
                        if (!!lCommentaire.ListeAppreciations && !!lCommentaire.ListeAppreciations.GetNbrElements() && !!lCommentaires.Intitule && lCommentaires.Intitule !== "" && lCommentaire.ListeAppreciations.getTableauLibelles().join(', ') !== "") {
                            lCommentaire.ListeAppreciations.setTri([ObjetTri.init('Genre')]);
                            lCommentaire.ListeAppreciations.trier();
                            lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                                intituleDAppreciation: lCommentaires.Intitule,
                                contenuDAppreciation: lCommentaire.ListeAppreciations.getTableauLibelles().join(', '),
                                styleBlockIntitule: 'color : #616161;',
                                styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                            }));
                        }
                    }
                }
                if (!!aDonneesPiedDeBulletin.ListeAppreciations.conseilDeClasse && !!aDonneesPiedDeBulletin.ListeAppreciations.conseilDeClasse.GetNbrElements()) {
                    var lAppreciationsConseilDeClasse = aDonneesPiedDeBulletin.ListeAppreciations.conseilDeClasse;
                    var lNbrAppreciationConseilDeClasse;
                    for (i = 0, lNbrAppreciationConseilDeClasse = lAppreciationsConseilDeClasse.GetNbrElements(); i < lNbrAppreciationConseilDeClasse; i++) {
                        var lAppConseilDeClass = lAppreciationsConseilDeClasse.GetElement(i);
                        if (!!lAppConseilDeClass.ListeAppreciations && !!lAppConseilDeClass.ListeAppreciations.GetNbrElements() && !!lAppConseilDeClass.Intitule && lAppConseilDeClass.Intitule !== "" && lAppConseilDeClass.ListeAppreciations.getTableauLibelles().join(', ') !== "") {
                            lAppConseilDeClass.ListeAppreciations.setTri([ObjetTri.init('Genre')]);
                            lAppConseilDeClass.ListeAppreciations.trier();
                            lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                                intituleDAppreciation: lAppConseilDeClass.Intitule,
                                contenuDAppreciation: lAppConseilDeClass.ListeAppreciations.getTableauLibelles().join(', '),
                                styleBlockIntitule: 'color : #616161;',
                                styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                            }));
                        }
                    }
                }
                if (!!aDonneesPiedDeBulletin.ListeAppreciations.cpe && !!aDonneesPiedDeBulletin.ListeAppreciations.cpe.GetNbrElements()) {
                    var lAppreciationsCpe = aDonneesPiedDeBulletin.ListeAppreciations.cpe;
                    var lNbrAppreciationsCpe;
                    for (i = 0, lNbrAppreciationsCpe = lAppreciationsCpe.GetNbrElements(); i < lNbrAppreciationsCpe; i++) {
                        var lAppCpe = lAppreciationsCpe.GetElement(i);
                        if (!!lAppCpe.ListeAppreciations && !!lAppCpe.ListeAppreciations.GetNbrElements() && !!lAppCpe.Intitule && lAppCpe.Intitule !== "" && lAppCpe.ListeAppreciations.getTableauLibelles().join(', ') !== "") {
                            lAppCpe.ListeAppreciations.setTri([ObjetTri.init('Genre')]);
                            lAppCpe.ListeAppreciations.trier();
                            lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                                intituleDAppreciation: lAppCpe.Intitule,
                                contenuDAppreciation: lAppCpe.ListeAppreciations.getTableauLibelles().join(', '),
                                styleBlockIntitule: 'color : #616161;',
                                styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                            }));
                        }
                    }
                }
                if (!!aDonneesPiedDeBulletin.ListeAppreciations.general && !!aDonneesPiedDeBulletin.ListeAppreciations.general.GetNbrElements()) {
                    var lAppreciationsGeneral = aDonneesPiedDeBulletin.ListeAppreciations.general;
                    var lNbrAppreciationsGeneral;
                    for (i = 0, lNbrAppreciationsGeneral = lAppreciationsGeneral.GetNbrElements(); i < lNbrAppreciationsGeneral; i++) {
                        var lAppGeneral = lAppreciationsGeneral.GetElement(i);
                        if (!!lAppGeneral.ListeAppreciations && !!lAppGeneral.ListeAppreciations.GetNbrElements() && !!lAppGeneral.Intitule && lAppGeneral.Intitule !== "" && lAppGeneral.ListeAppreciations.getTableauLibelles().join(', ') !== "") {
                            lAppGeneral.ListeAppreciations.setTri([ObjetTri.init('Genre')]);
                            lAppGeneral.ListeAppreciations.trier();
                            lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                                intituleDAppreciation: lAppCpe.Intitule,
                                contenuDAppreciation: lAppGeneral.ListeAppreciations.getTableauLibelles().join(', '),
                                styleBlockIntitule: 'color : #616161;',
                                styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                            }));
                        }
                    }
                }
            }
            return lHtml.join('');
        }

        function _construireParcoursEducatif(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin) {
                var lListeGenresParcoursPublies = new ObjetListeElements();
                if (!!aDonneesPiedDeBulletin.listeGenreParcours) {
                    aDonneesPiedDeBulletin.listeGenreParcours.parcourir(function(D) {
                        if (!!D && D.autorise) {
                            lListeGenresParcoursPublies.AddElement(D);
                        }
                    });
                }
                var lListeParcoursEducatifs = new ObjetListeElements();
                if (!!aDonneesPiedDeBulletin.listeEvntsParcoursPeda) {
                    aDonneesPiedDeBulletin.listeEvntsParcoursPeda.parcourir(function(D) {
                        if (!!D && !!D.Descr) {
                            lListeParcoursEducatifs.AddElement(D);
                        }
                    });
                }
                if (lListeParcoursEducatifs.GetNbrElements() > 0 && lListeGenresParcoursPublies.GetNbrElements() > 0) {
                    lHtml.push('<div>');
                    var lCumulGenreParcoursVide;
                    lListeGenresParcoursPublies.parcourir(function(aGenreParcoursEducatif) {
                        lCumulGenreParcoursVide = false;
                        lListeParcoursEducatifs.parcourir(function(aParcoursEducatif) {
                            if (aParcoursEducatif.GetGenre() === aGenreParcoursEducatif.GetGenre()) {
                                if (!lCumulGenreParcoursVide) {
                                    lHtml.push('<div class="Espace Gras">', TypeGenreParcoursEducatif.getLibelle(aGenreParcoursEducatif.GetGenre()), '</div>');
                                    lCumulGenreParcoursVide = true;
                                }
                                lHtml.push('<div class="Espace" style="background-color:#FFFFFF;">', '<div class="PetitEspaceHaut" style="color: #9C9C9C;">', GDate.FormatDate(aParcoursEducatif.Date, ' ' + GTraductions.getValeur('Le') + ' %JJ/%MM/%AA'), aParcoursEducatif.SuiviPar !== "" ? '&nbsp-&nbsp;' + GChaine.Format(GTraductions.getValeur('ParcoursPeda.colonne.suiviParS'), [aParcoursEducatif.SuiviPar]) : '', '</div>', '<div class="Espace" style="border: 1px solid #c4c4c4;">', aParcoursEducatif.Descr, '</div>', '</div>');
                            }
                        });
                    });
                    lHtml.push('</div>');
                }
            }
            return lHtml.join('');
        }

        function _construireBilanDeCycle(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.listePiliers && aDonneesPiedDeBulletin.listePiliers.GetNbrElements()) {
                lHtml.push('<div class="card" style="margin:0.5rem;">');
                lHtml.push('<div class="Espace Gras">' + GTraductions.getValeur('competences.BilansDeCycle') + '</div>');
                lHtml.push('<div class="card-content">');
                lHtml.push('<ul class="collection with-header">');
                aDonneesPiedDeBulletin.listePiliers.parcourir(function(aPilier) {
                    if (aPilier.GetGenre() === EGenreRessource.Pilier) {
                        var lNiveauDAcquisition = GParametres.listeNiveauxDAcquisitions.GetElementParElement(aPilier.niveauDAcquisition);
                        lHtml.push('<li class="collection-item">', '<div style="padding-right: 2.5rem;">', aPilier.GetLibelle(), '</div>', '<div class="secondary-content">', EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition), '</div>', '</li>');
                    } else {
                        lHtml.push('<li class="collection-header" style="border-bottom:#d1d1d1 1px solid;">', aPilier.GetLibelle(), '</li>');
                    }
                });
                lHtml.push('</ul>');
                lHtml.push('</div>');
                lHtml.push('</div>');
            }
            return lHtml.join('');
        }

        function _construireStages(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.listeStages) {
                aDonneesPiedDeBulletin.listeStages.parcourir(function(aStage) {
                    aStage.listeDemandeurs = new ObjetListeElements();
                    if (!!aStage.listeProfesseurs) {
                        aStage.listeDemandeurs.FusionnerListe(aStage.listeProfesseurs);
                    }
                    if (aStage.listeMaitresDeStage) {
                        aStage.listeDemandeurs.FusionnerListe(aStage.listeMaitresDeStage);
                    }
                    var lExisteDemandeurs = (!!aStage.listeDemandeurs && aStage.listeDemandeurs.GetNbrElements() > 0);
                    lHtml.push('<div class="Espace">');
                    if (!!aStage.session) {
                        lHtml.push('<div class="', (lExisteDemandeurs ? ' grey-text text-darken-2' : ''), '">', aStage.session, '</div>');
                    }
                    var lLibelleStage = [aStage.GetLibelle()];
                    if (!!aStage.dateInterruption) {
                        lLibelleStage.push(' - ', GTraductions.getValeur('stage.InterrompuLe'), ' ', GDate.FormatDate(aStage.dateInterruption, '%JJ/%MM/%AAAA'));
                    }
                    lHtml.push('<div class="', (lExisteDemandeurs ? ' grey-text text-darken-2' : ''), '">', lLibelleStage.join(''), '</div>');
                    if (lExisteDemandeurs) {
                        var existeAppreciations = false;
                        for (var i = 0, lNbrDemandeur = aStage.listeDemandeurs.GetNbrElements(); i < lNbrDemandeur; i++) {
                            var lDemandeur = aStage.listeDemandeurs.GetElement(i);
                            if ((!!lDemandeur.GetLibelle() || !!lDemandeur.appreciation) && !existeAppreciations) {
                                lHtml.push('<div class="Espace" style="border:1px solid #616161;">');
                                lHtml.push('<ul class="browser-default">');
                                existeAppreciations = true;
                            }
                            if (!!lDemandeur.GetLibelle() || !!lDemandeur.appreciation) {
                                lHtml.push('<li>');
                                lHtml.push('<div>', lDemandeur.GetLibelle(), '</div>');
                                lHtml.push('<div class="Gras">', lDemandeur.appreciation, '</div>');
                                lHtml.push('</li>');
                            }
                            if (i === aStage.listeDemandeurs.GetNbrElements() - 1 && !!existeAppreciations) {
                                lHtml.push('</ul>');
                                lHtml.push('</div>');
                            }
                        }
                    }
                    lHtml.push('</div>');
                });
            }
            return lHtml.join('');
        }

        function _construireOrientations(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin) {
                var lObjetOrientation = aDonneesPiedDeBulletin.Orientation;
                if (!!lObjetOrientation && !!lObjetOrientation.listeRubriques && lObjetOrientation.listeRubriques.GetNbrElements() > 0) {
                    lHtml.push('<div style="margin-top:10px;">');
                    var construitStrLibelleVoeuOrientation = function(aVoeuOrientation) {
                        var lStrOrientation = [];
                        if (!!aVoeuOrientation) {
                            if (!!aVoeuOrientation.orientation) {
                                lStrOrientation.push(aVoeuOrientation.orientation.GetLibelle());
                            } else if (!!aVoeuOrientation.commentaire) {
                                lStrOrientation.push(aVoeuOrientation.commentaire);
                            }
                            if (!!aVoeuOrientation.listeSpecialites) {
                                aVoeuOrientation.listeSpecialites.parcourir(function(aSpe) {
                                    if (!!aSpe && !!aSpe.code) {
                                        lStrOrientation.push(aSpe.code);
                                    }
                                });
                            }
                        }
                        return lStrOrientation.join(' - ');
                    };
                    lObjetOrientation.listeRubriques.parcourir(function(aRubrique) {
                        lHtml.push('<div>');
                        if (aRubrique.GetGenre() === TypeRubriqueOrientation.RO_IntentionFamille || aRubrique.GetGenre() === TypeRubriqueOrientation.RO_VoeuDefinitif) {
                            if (!!aRubrique.listeVoeux && aRubrique.listeVoeux.GetNbrElements() > 0) {
                                var lTitreBloc;
                                if (aRubrique.GetGenre() === TypeRubriqueOrientation.RO_IntentionFamille) {
                                    lTitreBloc = GTraductions.getValeur('Orientation.Ressources.IntentionsEtAvisProvisoire');
                                } else {
                                    lTitreBloc = GTraductions.getValeur('Orientation.Ressources.ChoixEtPropositions');
                                }
                                lHtml.push('<div class="Gras" style="color : #616161;">', lTitreBloc, '</div>');
                                aRubrique.listeVoeux.parcourir(function(aVoeu) {
                                    lHtml.push('<div><span class="Gras">', construitStrLibelleVoeuOrientation(aVoeu), '</span>');
                                    if (!!aVoeu.avecStagePasserelleFamille) {
                                        lHtml.push(' (', GTraductions.getValeur('Orientation.Ressources.DemandeStagePasserelle'), ')');
                                    }
                                    lHtml.push('</div>');
                                    if (!!aVoeu.reponseCC || !!aVoeu.motivation) {
                                        lHtml.push('<div>');
                                        if (!!aVoeu.reponseCC) {
                                            var lAvisLibelle = TypeAvisConseil.getLibelle(aVoeu.reponseCC);
                                            if (aRubrique.GetGenre() === TypeRubriqueOrientation.RO_VoeuDefinitif) {
                                                lAvisLibelle = TypeAvisConseil.getLibelleOuiNon(aVoeu.reponseCC);
                                            }
                                            lHtml.push('<span class="Bloc_TypeAvisConseil TypeAvis_', aVoeu.reponseCC, '" style="margin-right: 5px;">', (lAvisLibelle || ''), '</span>');
                                        }
                                        if (aVoeu.motivation) {
                                            lHtml.push(aVoeu.motivation);
                                        }
                                        if (aVoeu.avecStagePasserelleConseil) {
                                            lHtml.push(' (', GTraductions.getValeur('Orientation.Ressources.StagePasserellePropose'), ')');
                                        }
                                        lHtml.push('</div>');
                                    }
                                });
                            }
                        } else {
                            var lPremierVoeu = (!!aRubrique.listeVoeux && aRubrique.listeVoeux.GetNbrElements() > 0) ? aRubrique.listeVoeux.GetPremierElement() : null;
                            if (!!lPremierVoeu) {
                                lHtml.push('<b>', aRubrique.GetLibelle(), '</b> : ', construitStrLibelleVoeuOrientation(lPremierVoeu));
                                if (!!lPremierVoeu.avecStagePasserelleConseil) {
                                    lHtml.push(' - ', GTraductions.getValeur('Orientation.Ressources.StagePasserellePropose'));
                                }
                            }
                        }
                        lHtml.push('</div>');
                    });
                    lHtml.push('</div>');
                }
            }
            return lHtml.join('');
        }

        function _construireLegende(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.legende) {
                lHtml.push('<div class="Italique Espace">', aDonneesPiedDeBulletin.legende, '</div>');
            }
            return lHtml.join('');
        }

        function _construireProjets(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.ListeProjets) {
                lHtml.push('<div class="Espace">');
                if (aDonneesPiedDeBulletin.ListeProjets.GetNbrElements() > 0) {
                    lHtml.push(GTraductions.getValeur('BulletinEtReleve.Projets.Detail', [aDonneesPiedDeBulletin.ListeProjets.getTableauLibelles().join(', ')]));
                } else {
                    lHtml.push(GTraductions.getValeur('BulletinEtReleve.Projets.Aucun'));
                }
                lHtml.push('</div>');
            }
            return lHtml.join('');
        }

        function _construireCredits(aDonneesPiedDeBulletin) {
            var lHtml = [];
            if (!!aDonneesPiedDeBulletin && !!aDonneesPiedDeBulletin.listeCredits) {
                aDonneesPiedDeBulletin.listeCredits.parcourir(function(D) {
                    if (!!D && !!D.credits) {
                        lHtml.push('<div><span>', D.GetLibelle(), '</span> <span>', D.credits, '</span></div>');
                    }
                });
            }
            return lHtml.join('');
        }
        module.exports = PiedDeBulletinMobile;
    },
    fn: "pieddebulletinmobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeNote = require('TypeNote.js');
        var UtilitaireBulletinEtReleve_Mobile = require('UtilitaireBulletinEtReleve_Mobile.js');
        var EGenreEvolution = require('Enumere_Evolution.js');
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        var EGenreDirectionSlide = require('EGenreDirectionSlide.js');
        var PiedDeBulletinMobile = require('PiedDeBulletinMobile.js');
        var TypeContexteBulletin = require('TypeContexteBulletin.js');
        var TypeReleveBulletin = require('TypeReleveBulletin.js');
        var ObjetBoutonFlottant = require('ObjetBoutonFlottant.js');
        var GenerationPDF = require('utilitairegenerationpdf.js');
        var OptionsPdf = require('OptionsPDFSco.js');
        var TypeHttpGenerationPDFSco = require('TypeHttpGenerationPDFSco.js').TypeHttpGenerationPDFSco;
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        MethodesObjet.heritagePrototype(ObjetBulletin, ObjetIdentite_Mobile);

        function ObjetBulletin() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
            this.instancePiedDeBulletin = Identite.creerInstance(PiedDeBulletinMobile, {
                pere: this,
                evenement: null
            });
            this.instancePiedDeBulletin.setDonneesContexte({
                typeContexteBulletin: TypeContexteBulletin.CB_Eleve,
                avecSaisie: false,
                typeReleveBulletin: TypeReleveBulletin.BulletinNotes
            });
        }
        ObjetBulletin.prototype.getControleur = function(aInstance) {
            return {
                getIdentiteBouton: function() {
                    return {
                        class: ObjetBoutonFlottant,
                        pere: this,
                        init: function(aBtn) {
                            aInstance.identBtnFlottant = aBtn;
                            var lParam = {
                                listeBoutons: [{
                                    primaire: true,
                                    icone: "icon_pdf",
                                    callback: _genererPdf.bind(this, aInstance)
                                }]
                            };
                            aBtn.setOptionsBouton(lParam);
                        }
                    };
                }
            };
        };

        function _genererPdf(aInstance) {
            var lParametrageAffichage = {
                genreGenerationPDF: TypeHttpGenerationPDFSco.Bulletin,
                periode: aInstance.periodeCourante
            };
            GenerationPDF.genererPDF({
                paramPDF: lParametrageAffichage,
                optionsPDF: OptionsPdf.Bulletin
            });
        }
        ObjetBulletin.prototype.ConstruireAffichage = function() {
            this.listeRegroupements = new ObjetListeElements();
            this.listeServices = new ObjetListeElements();
            var lHtml = [];
            if (!!this.Message) {
                lHtml.push(this.composeAucuneDonnee(this.Message));
                if (!!this.identBtnFlottant) {
                    this.identBtnFlottant.SetVisible(false);
                }
            } else if (this.donneesRecues) {
                if (!!this.identBtnFlottant) {
                    this.identBtnFlottant.SetVisible(true);
                }
                lHtml.push('<div class="has-float-btn-bottom" id="', this.Nom, '_Bulletin">');
                if (this.ListeElements.GetNbrElements()) {
                    lHtml.push(this.composeCorpsDeBulletin());
                }
                lHtml.push('<div id="', this.instancePiedDeBulletin.GetNom(), '"></div>');
                lHtml.push('</div>');
                if (GApplication.droits.get(TypeDroits.autoriserImpression) && !this.identBtnFlottant) {
                    $("#" + GInterface.idZonePrincipale).IEHtmlAppend('<div class="is-sticky" ie-identite="getIdentiteBouton" ></div>', {
                        controleur: this.controleur,
                        avecCommentaireConstructeur: false
                    });
                }
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeCorpsDeBulletin = function() {
            var lHtml = [];
            var lNumeroRegroupement;
            lHtml.push('<ul class="collection with-header">');
            lNumeroRegroupement = this.ListeElements.GetElement(0).SurMatiere.GetNumero();
            for (var I = 0; this.ListeElements && (I < this.ListeElements.GetNbrElements()); I++) {
                var lService = this.ListeElements.GetElement(I);
                if (lService.estService) {
                    lHtml.push(this.composeService(lService, lNumeroRegroupement !== null && lService.SurMatiere.GetNumero() !== lNumeroRegroupement && lService.SurMatiere.GetLibelle() === ""));
                    lNumeroRegroupement = lService.SurMatiere.GetNumero();
                }
            }
            lHtml.push(this.composeMoyenneGenerale());
            lHtml.push('</ul>');
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeService = function(aService, aDoitSortirDeRegroupement) {
            var lHtml = [];
            var lDebutRegroupement = this.composeRegroupement({
                service: aService
            });
            lHtml.push(lDebutRegroupement);
            lHtml.push('<li class="collection-item with-action ', (aDoitSortirDeRegroupement ? 'break-group' : ''), '" onclick="', this.Nom, '.ouvrirPanel(\'', aService.GetNumero(), '\')" style="padding:3px 12px;">');
            var lLibelleService = aService.GetLibelle();
            this.listeServices.AddElement(aService);
            lHtml.push('<div style="border-left: 5px solid ' + (!!aService.couleur && aService.couleur !== "" ? aService.couleur : 'D4D4D4') + '; padding: 10px 5px;">');
            lHtml.push('<div class="left-align  InlineBlock" style="width:55%;">', lLibelleService, '</div>');
            lHtml.push('<div class="left-align  InlineBlock" style="width:31%; color:#9c9c9c;;">', this.getMoyenneClasse(aService), '</div>');
            lHtml.push('<div class="right-align InlineBlock" style="width:13%;">' + this.getNoteService(aService) + '</div>');
            if (aService.estService && aService.nbSousServicesTotal > 0) {
                lHtml.push('<ul class="collection" >');
                for (var J = 0; J < aService.nbSousServicesTotal; J++) {
                    var lSousService = aService.ListeElements.GetElement(J);
                    lHtml.push('<li class="collection-item with-action">');
                    var libelleSousService = (!!lSousService.Matiere && lSousService.Matiere.GetLibelle() !== "" ? lSousService.Matiere.GetLibelle() : '');
                    lHtml.push('<div class="left-align Italique  InlineBlock" style="width:55%;">');
                    if (!!libelleSousService && libelleSousService !== "") {
                        lHtml.push('<div>', libelleSousService, '</div>');
                    }
                    if (!!lSousService.ListeProfesseurs && !!lSousService.ListeProfesseurs.GetNbrElements()) {
                        lHtml.push('<div>', GChaine.ToHTML(lSousService.ListeProfesseurs.getTableauLibelles().join('<br>')), '</div>');
                    }
                    lHtml.push('</div>');
                    lHtml.push('<div class="left-align Italique  InlineBlock" style="width:31%; color:#9c9c9c;">', this.getMoyenneClasse(lSousService), '</div>');
                    lHtml.push('<div class="right-align Italique InlineBlock" style="width:13%;">' + this.getNoteService(lSousService) + '</div>');
                    lHtml.push('</li>');
                }
                lHtml.push('</ul>');
            }
            lHtml.push('</div>');
            lHtml.push('</li>');
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeRegroupement = function(aParam) {
            var lService = aParam.service.estService ? aParam.service : aParam.service.pere;
            var lHtml = [];
            if (lService.SurMatiere.existeNumero() && lService.estDebutRegroupement) {
                this.listeRegroupements.AddElement(lService);
                lHtml.push('<li class="collection-header collection-group with-action" onclick="', this.Nom, '.ouvrirPanel(\'', lService.GetNumero(), '\',', true, ')">');
                lHtml.push('<div class="title left-align InlineBlock" style="width:86%;">' + lService.SurMatiere.GetLibelle() + '</div>');
                var lMoyenneRegroupement = "";
                var lServiceDansRegroupement = this.tableauSurMatieres[lService.regroupement];
                if (lService.AvecMoyenneRegroupement) {
                    lMoyenneRegroupement = this.getNoteService(lServiceDansRegroupement);
                }
                lHtml.push('<div class="title right-align InlineBlock" style="width:13%;">', lMoyenneRegroupement, '</div>');
                lHtml.push('</li>');
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.SetDonnees = function(aListeElements, aPositionPeriode, aPositionMax, aTableauSurMatieres, aMoyenneGenerale, aDonneesAbsences, aPiedDePage, aAffichage, aPeriodeCourante) {
            if (aListeElements) {
                this.ListeElements = this.getListeDonneesLineaire(aListeElements);
                this.Affichage = aAffichage;
                this.donneesRecues = true;
                this.Message = false;
            }
            if (aTableauSurMatieres) {
                this.tableauSurMatieres = aTableauSurMatieres;
            }
            if (aMoyenneGenerale) {
                this.MoyenneGenerale = aMoyenneGenerale;
            }
            if (aDonneesAbsences) {
                this.donneesAbsences = aDonneesAbsences;
            }
            if (aPiedDePage) {
                this.PiedDePage = aPiedDePage;
            }
            this.periodeCourante = aPeriodeCourante;
            var lSensSlide;
            if (this.precedentePosition === aPositionMax && aPositionPeriode === 0) {
                lSensSlide = EGenreDirectionSlide.Droite;
            } else if (this.precedentePosition === 0 && aPositionPeriode > 1) {
                lSensSlide = EGenreDirectionSlide.Gauche;
            } else {
                lSensSlide = aPositionPeriode === this.precedentePosition ? EGenreDirectionSlide.Aucune : aPositionPeriode < this.precedentePosition ? EGenreDirectionSlide.Gauche : EGenreDirectionSlide.Droite;
            }
            this.precedentePosition = aPositionPeriode;
            this.Afficher(null, lSensSlide);
            this.instancePiedDeBulletin.setDonneesPiedDeBulletin(aPiedDePage, aDonneesAbsences);
            this.instancePiedDeBulletin.Afficher();
        };
        ObjetBulletin.prototype.SetMessage = function(aMessage) {
            this.Message = aMessage;
            this.Afficher();
        };
        ObjetBulletin.prototype.getListeDonneesLineaire = function(aListeElements) {
            var lService, lSousService, lCmpActifs, lIndiceDernier, lIndiceDernierActif, J, I, lNbr;
            var lListe = new ObjetListeElements();
            for (I = 0, lNbr = aListeElements.GetNbrElements(); I < lNbr; I++) {
                lService = aListeElements.GetElement(I);
                lService.estService = true;
                lService.nbSousServicesTotal = !!lService.ListeElements ? lService.ListeElements.GetNbrElements() : 0;
                lService.regroupement = lService.SurMatiere.GetNumero();
                lService.avecAppreciationParSousService = lService.AvecAppreciationParSousService;
                lCmpActifs = 0;
                lIndiceDernier = 0;
                lIndiceDernierActif = 0;
                for (J = 0; J < lService.nbSousServicesTotal; J++) {
                    if (lService.ListeElements.GetElement(J).Actif) {
                        lCmpActifs++;
                        lIndiceDernierActif = J;
                    }
                    lIndiceDernier = J;
                }
                lService.nbSousServicesActifs = lCmpActifs;
                lListe.AddElement(lService);
                for (J = 0; J < lService.nbSousServicesTotal; J++) {
                    lSousService = lService.ListeElements.GetElement(J);
                    lSousService.estService = false;
                    lSousService.estDernier = (J === lIndiceDernier);
                    lSousService.estDernierActif = (J === lIndiceDernierActif);
                    lSousService.regroupement = lService.regroupement;
                    lSousService.avecAppreciationParSousService = lService.avecAppreciationParSousService;
                    lListe.AddElement(lSousService);
                }
            }
            return lListe;
        };
        ObjetBulletin.prototype.calculerTotalECTS = function() {
            var lTotalECTS = 0;
            if (this.Affichage.avecECTS) {
                var lService;
                var lNombreServices = this.ListeElements.GetNbrElements();
                for (var I = 0; I < lNombreServices; I++) {
                    lService = this.ListeElements.GetElement(I);
                    if (lService.ECTS !== false) {
                        lTotalECTS += lService.ECTS;
                    }
                }
            }
            return lTotalECTS.toFixed(3);
        };
        ObjetBulletin.prototype.calculerNombrePointsEleve = function() {
            var lTotal = 0;
            if (this.Affichage.AvecNombrePointsEleve) {
                var lService;
                var lNombreService = this.ListeElements.GetNbrElements();
                for (var I = 0; I < lNombreService; I++) {
                    lService = this.ListeElements.GetElement(I);
                    if (lService.NombrePointsEleve) {
                        lTotal += lService.NombrePointsEleve.valeur;
                    }
                }
            }
            return new TypeNote(lTotal, 2);
        };
        ObjetBulletin.prototype.composeMoyenneGenerale = function() {
            var lHtml = [];
            if (this.Affichage && this.Affichage.AvecMoyenneGenerale) {
                lHtml.push('<li class="collection-item raised with-action break-group" onclick="', this.Nom, '.ouvrirPanel()">');
                lHtml.push('<div class="title left-align InlineBlock" style="width:86%;" >', GTraductions.getValeur('BulletinEtReleve.MoyGen'), '</div>');
                var lMoyenneGenerale = "";
                if (this.MoyenneGenerale) {
                    if (this.MoyenneGenerale.moyenneDeliberee && this.MoyenneGenerale.moyenneDeliberee.getNote() !== "") {
                        lMoyenneGenerale = this.MoyenneGenerale.moyenneDeliberee.getNote();
                    } else if (this.MoyenneGenerale.MoyenneEleve && this.MoyenneGenerale.MoyenneEleve.getNote() !== "") {
                        lMoyenneGenerale = this.MoyenneGenerale.MoyenneEleve.getNote();
                    }
                    lHtml.push('<div class="title right-align InlineBlock" style="width:13%;">', lMoyenneGenerale, '</div>');
                }
                lHtml.push('</li>');
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.ouvrirPanel = function(aNumeroService, aOuvrirePanelRegroupement) {
            var lService = this.ListeElements.GetElementParNumero(aNumeroService);
            if (!!lService) {
                if (!!aOuvrirePanelRegroupement) {
                    GInterface.openPanel(this.composePanelRegroupement(lService));
                } else {
                    GInterface.openPanel(this.composePanelService(lService));
                }
            } else {
                GInterface.openPanel(this.composePanelMoyenneGenerale(this.MoyenneGenerale));
            }
        };
        ObjetBulletin.prototype.composePanelRegroupement = function(aService) {
            var lHtml = [];
            if (aService) {
                lHtml.push('<div class="navheader">');
                lHtml.push('<div class="right">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="left">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aService.GetNumero(), '\',', false, ',', true, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aService.GetNumero(), '\',', true, ',', true, ')"><i class="material-icons icon_angle_right"></i></button>');
                lHtml.push('</div>');
                lHtml.push('</div>');
                lHtml.push('<div class="subheader">');
                lHtml.push('<div>');
                lHtml.push('<div class="left">', aService.SurMatiere.GetLibelle(), '</div>');
                var lMoyenneRegroupement = "";
                var lServiceDansRegroupement = this.tableauSurMatieres[aService.regroupement];
                if (aService.AvecMoyenneRegroupement) {
                    lMoyenneRegroupement = this.getNoteService(lServiceDansRegroupement);
                }
                lHtml.push('<div class="right">', lMoyenneRegroupement, '</div>');
                lHtml.push('</div>');
                lHtml.push('</div>');
                lHtml.push('</div>');
                if (!!this.composeDetails(lServiceDansRegroupement, false)) {
                    lHtml.push('<div class="Espace">');
                    lHtml.push(this.composeDetails(lServiceDansRegroupement, false));
                    lHtml.push('</div>');
                }
                lHtml.push('</div>');
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composePanelMoyenneGenerale = function(aMoyenneGenerale) {
            var lHtml = [];
            if (aMoyenneGenerale) {
                lHtml.push('<div class="navheader">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="subheader">');
                lHtml.push('<div>');
                lHtml.push('<div class="left">' + GTraductions.getValeur('BulletinEtReleve.MoyGen') + '</div>');
                if (this.Affichage.AvecMoyenneEleve && aMoyenneGenerale.MoyenneEleve && aMoyenneGenerale.MoyenneEleve.getNote() !== "") {
                    lHtml.push('<div class="right">', aMoyenneGenerale.MoyenneEleve.getNote(), '</div>');
                }
                lHtml.push('</div>');
                lHtml.push('</div>');
                if (!!this.composeDetails(aMoyenneGenerale, true)) {
                    lHtml.push('<div class="Espace">');
                    lHtml.push(this.composeDetails(aMoyenneGenerale, true));
                    lHtml.push('</div>');
                }
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composePanelService = function(aService) {
            var lHtml = [];
            if (aService) {
                lHtml.push('<div class="navheader">');
                lHtml.push('<div class="right">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="left">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aService.GetNumero(), '\',', false, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aService.GetNumero(), '\',', true, ')"><i class="material-icons icon_angle_right"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="clear"></div>');
                lHtml.push('</div>');
                lHtml.push(this.composeBandeauService(aService));
                if (!!this.composeDetails(aService, false)) {
                    lHtml.push('<div class="Espace">');
                    lHtml.push(this.composeDetails(aService, false));
                    lHtml.push('</div>');
                }
                lHtml.push(this.composeElementProgrammeBulletin(aService));
                lHtml.push(this.composeAppreciationsService(aService));
                if (aService.estService && aService.nbSousServicesTotal > 0) {
                    lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                    for (var J = 0; J < aService.nbSousServicesTotal; J++) {
                        var lSousService = aService.ListeElements.GetElement(J);
                        lHtml.push(this.composeSousService(lSousService));
                    }
                    lHtml.push('</ul>');
                }
                lHtml.push(this.composeLegende(aService));
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeBandeauService = function(aService) {
            var lHtml = [];
            lHtml.push('<div class="subheader">');
            lHtml.push('<div>');
            lHtml.push('<div class="left">');
            lHtml.push(aService.GetLibelle());
            var libelleProfesseur = this.getProfesseur(aService);
            if (libelleProfesseur !== "") {
                lHtml.push('&nbsp;-&nbsp;', libelleProfesseur);
            }
            lHtml.push('</div>');
            lHtml.push('<div class="right">');
            lHtml.push('<div class="right-align">', this.getNoteService(aService), '</div>');
            if (this.Affichage.avecECTS && aService.ECTS && aService.ECTS && aService.ECTS !== "") {
                lHtml.push('<div>');
                lHtml.push(GTraductions.getValeur('BulletinEtReleve.ECTS'), '&nbsp;', aService.ECTS);
                lHtml.push('</div>');
            }
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeSousService = function(aSousService) {
            var lHtml = [],
                lDetailSousService = this.composeDetails(aSousService, false),
                libelleSousService = (!!aSousService.Matiere && aSousService.Matiere.GetLibelle() !== "" ? aSousService.Matiere.GetLibelle() : '');
            lHtml.push('<li>');
            lHtml.push('<div class="collapsible-header', (lDetailSousService ? ' active' : ' empty-body'), '">');
            lHtml.push('<div>');
            lHtml.push('<div class="InlineBlock truncate" style="', (lDetailSousService ? 'width:69%;' : ''), '">');
            if (!!libelleSousService && libelleSousService !== "") {
                lHtml.push('<div>', libelleSousService, '</div>');
            }
            if (!!aSousService.ListeProfesseurs && !!aSousService.ListeProfesseurs.GetNbrElements()) {
                lHtml.push('<div>', GChaine.ToHTML(aSousService.ListeProfesseurs.getTableauLibelles().join('<br>')), '</div>');
            }
            lHtml.push('</div>');
            lHtml.push('<div class="InlineBlock" style="width:30%;', (!lDetailSousService ? 'float:right;' : ''), '">');
            lHtml.push('<div class="right-align Italique InlineBlock" style="width:100%;">', this.getNoteService(aSousService), '</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('<div class="collapsible-body">');
            lHtml.push((lDetailSousService || ''));
            lHtml.push(this.composeAppreciationsService(aSousService));
            lHtml.push('</div>');
            lHtml.push('</li>');
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeDetails = function(aParam, aEstMoyenneGenerale) {
            var lHtml = [];
            if (this.Affichage && !!aParam) {
                if (this.Affichage.AvecVolumeHoraire && !!aParam.VolumeHoraire && aParam.VolumeHoraire !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.VolH'), aParam.VolumeHoraire));
                }
                if (this.Affichage.AvecCoefficient && !!aParam.Coefficient && aParam.Coefficient.getNote() !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Coeff'), aParam.Coefficient.getNote()));
                }
                if (this.Affichage.AvecNombreDevoirs && !!aParam.NombreDevoirs && aParam.NombreDevoirs !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.NbrNotes'), aParam.NombreDevoirs));
                }
                if (this.Affichage.AvecClassementEleve && !!aParam.ClassementEleve && aParam.ClassementEleve !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Rang'), aParam.ClassementEleve));
                }
                if (this.Affichage.AvecEvolution && !!aParam.Evolution && aParam.Evolution.GetGenre() !== null && aParam.Evolution.GetGenre() !== EGenreEvolution.Aucune) {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Evol'), '<img src="images/evolution_' + aParam.Evolution.GetGenre() + '.gif"></img>'));
                }
                if (this.Affichage.AvecMoyenneAnnuelle && !!aParam.MoyenneAnnuelle && aParam.MoyenneAnnuelle.getNote() !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.MoyAnnee'), aParam.MoyenneAnnuelle.getNote()));
                }
                if (this.Affichage.AvecMoyennePeriode) {
                    for (var I = 0; I < this.Affichage.NombreMoyennesPeriodes; I++) {
                        if (aParam.ListeNiveauDAcquisitionPeriodes && aParam.ListeNiveauDAcquisitionPeriodes.GetNbrElements() && aParam.ListeNiveauDAcquisitionPeriodes.existeNumero(I)) {
                            var lNiveauDacquisition = GParametres.listeNiveauxDAcquisitions.GetElementParNumero(aParam.ListeNiveauDAcquisitionPeriodes.GetNumero(I));
                            lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(this.Affichage.listePeriodes.GetLibelle(I), EGenreNiveauDAcquisition.getImagePositionnement({
                                niveauDAcquisition: lNiveauDacquisition
                            })));
                        } else if (aParam.ListeMoyennesPeriodes && aParam.ListeMoyennesPeriodes[I] && aParam.ListeMoyennesPeriodes[I].getNote() !== "") {
                            lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(this.Affichage.listePeriodes.GetLibelle(I), aParam.ListeMoyennesPeriodes[I].getNote()));
                        }
                    }
                }
                if (aEstMoyenneGenerale) {
                    aParam.NombrePointsEleve = this.calculerNombrePointsEleve();
                    if (!!this.Affichage.AvecNombrePointsEleve && aParam.NombrePointsEleve.valeur !== 0) {
                        lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Pts'), aParam.NombrePointsEleve.getNote()));
                    }
                    aParam.TotalECTS = this.calculerTotalECTS();
                    if (!!this.Affichage.avecECTS && aParam.TotalECTS > 0) {
                        lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.ECTS'), aParam.TotalECTS));
                    }
                } else if (this.Affichage.AvecNombrePointsEleve && !!aParam.NombrePointsEleve && aParam.NombrePointsEleve.getNote() !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Pts'), aParam.NombrePointsEleve.getNote()));
                }
                if (this.Affichage.AvecMoyenneClasse && !!aParam.MoyenneClasse && aParam.MoyenneClasse.getNote() !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Classe'), aParam.MoyenneClasse.getNote()));
                }
                if (!!this.Affichage.AvecMoyenneInfSup && !!aParam.MoyenneInf && aParam.MoyenneInf.getNote() !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.MoyInf'), aParam.MoyenneInf.getNote()));
                }
                if (!!this.Affichage.AvecMoyenneInfSup && !!aParam.MoyenneSup && aParam.MoyenneSup.getNote() !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.MoySup'), aParam.MoyenneSup.getNote()));
                }
                if (this.Affichage.AvecDureeDesAbsenses && !!aParam.DureeDesAbsences && aParam.DureeDesAbsences !== "") {
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.RS_HAbs'), aParam.DureeDesAbsences));
                }
            }
            if (lHtml.length === 0) {
                return false;
            } else {
                return lHtml.join('');
            }
        };
        ObjetBulletin.prototype.composeLegende = function(aService) {
            var lHtml = [];
            if (aService.NiveauDAcquisition) {
                lHtml.push('<div class="', this.Nom, '_legende Espace">');
                lHtml.push(GTraductions.getValeur('BulletinEtReleve.Legende'));
                var lNiveauDAcquisition, lLibelle;
                for (var i = 0; i < GParametres.listeNiveauxDAcquisitions.GetNbrElements(); i++) {
                    lNiveauDAcquisition = GParametres.listeNiveauxDAcquisitions.GetElement(i);
                    lLibelle = EGenreNiveauDAcquisition.getLibellePositionnement({
                        niveauDAcquisition: lNiveauDAcquisition,
                        avecPositionnementVide: true
                    });
                    if (lLibelle && EGenreNiveauDAcquisition.getNombrePointsBrevet({
                            niveauDAcquisition: lNiveauDAcquisition
                        }).getValeur() > 0) {
                        lHtml.push('<div style="clear: both;">');
                        lHtml.push('<div style="float:left;">', EGenreNiveauDAcquisition.getImagePositionnement({
                            niveauDAcquisition: lNiveauDAcquisition
                        }), '</div>');
                        lHtml.push('<div style="float:left;">', lLibelle, '</div>');
                        lHtml.push('</div>');
                    }
                }
            }
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetBulletin.prototype.composeAppreciationsService = function(aService) {
            var lHtml = [];
            var lNombreAppreciationsSurService = aService.ListeAppreciations.GetNbrElements();
            for (var I = 0; I < lNombreAppreciationsSurService; I++) {
                var lAppreciationSurService = aService.ListeAppreciations.GetElement(I).GetLibelle();
                if (lAppreciationSurService !== "") {
                    var lIntituleAppreciation = this.Affichage.ListeIntitulesAppreciations.GetElement(I).GetLibelle();
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                        intituleDAppreciation: lIntituleAppreciation,
                        contenuDAppreciation: lAppreciationSurService,
                        styleBlockIntitule: 'color : #616161;',
                        styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                    }));
                }
            }
            return lHtml.join('');
        };
        ObjetBulletin.prototype.getNoteService = function(aService) {
            if (this.Affichage.AvecMoyenneDeliberee || this.Affichage.AvecMoyenneEleve) {
                if (aService.avisReligionPropose && aService.avisReligionPropose.GetLibelle() !== "") {
                    return aService.avisReligionPropose.GetLibelle();
                } else if (aService.avisReligionDelibere && aService.avisReligionDelibere.GetLibelle() !== "") {
                    return aService.avisReligionDelibere.GetLibelle();
                } else if (aService.moyenneDeliberee && aService.moyenneDeliberee.getNote() !== "") {
                    return aService.moyenneDeliberee.getNote();
                } else if (aService.NiveauDAcquisition && aService.NiveauDAcquisition.existeNumero()) {
                    var lNiveauDAcquisition = GParametres.listeNiveauxDAcquisitions.GetElementParNumero(aService.NiveauDAcquisition.GetNumero());
                    return '<div style="position: relative; float: right; top: 3px;">' + EGenreNiveauDAcquisition.getImagePositionnement({
                        niveauDAcquisition: lNiveauDAcquisition
                    }) + '</div>';
                } else if (aService.MoyenneEleve && aService.MoyenneEleve.getNote() !== "") {
                    return aService.MoyenneEleve.getNote();
                } else {
                    return "";
                }
            } else {
                return "";
            }
        };
        ObjetBulletin.prototype.getMoyenneClasse = function(aService) {
            if (this.Affichage.AvecMoyenneClasse && aService.MoyenneClasse && aService.MoyenneClasse.getNote() !== "") {
                return GTraductions.getValeur('BulletinEtReleve.Classe') + ':&nbsp;' + aService.MoyenneClasse.getNote();
            } else {
                return "&nbsp;";
            }
        };
        ObjetBulletin.prototype.getProfesseur = function(aService) {
            return (!!aService.ListeProfesseurs && aService.ListeProfesseurs.GetNbrElements() > 0 ? aService.ListeProfesseurs.GetLibelle(0) : "");
        };
        ObjetBulletin.prototype.getCoefficient = function(aService) {
            if (this.Affichage.AvecCoefficient && aService.Coefficient && aService.Coefficient.getNote() !== "") {
                return GTraductions.getValeur('BulletinEtReleve.Coeff') + aService.Coefficient.getNote();
            } else {
                return " ";
            }
        };
        ObjetBulletin.prototype.composeElementProgrammeBulletin = function(aService) {
            var lHtml = [];
            if (this.Affichage.avecElementProgramme && aService.ElementsProgrammeBulletin.GetNbrElements() > 0) {
                aService.ElementsProgrammeBulletin.setTri([ObjetTri.init('Libelle')]);
                aService.ElementsProgrammeBulletin.trier();
                lHtml.push('<ul class="browser-default">');
                for (var I = 0; I < aService.ElementsProgrammeBulletin.GetNbrElements(); I++) {
                    if (aService.ElementsProgrammeBulletin.GetElement(I).GetLibelle() !== "") {
                        lHtml.push('<li>', aService.ElementsProgrammeBulletin.GetElement(I).GetLibelle(), '</li>');
                    }
                }
                lHtml.push('</ul>');
                return UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                    intituleDAppreciation: this.Affichage.intituleElementProgramme,
                    contenuDAppreciation: lHtml,
                    styleBlockIntitule: 'color : #616161;',
                    styleBlockContenu: 'border:1px solid #616161;'
                });
            }
            return '';
        };
        ObjetBulletin.prototype.surClickProchainElement = function(aNumeroElement, aEstSuivant, aRegroupementSuivant) {
            var lIndiceElementActuel, lIndiceProchainElement, lProchainElement;
            if (!!aRegroupementSuivant) {
                lIndiceElementActuel = this.listeRegroupements.GetIndiceParNumeroEtGenre(aNumeroElement);
                if (!!aEstSuivant) {
                    lIndiceProchainElement = lIndiceElementActuel + 1 < this.listeRegroupements.GetNbrElements() ? lIndiceElementActuel + 1 : 0;
                } else {
                    lIndiceProchainElement = lIndiceElementActuel === 0 ? this.listeRegroupements.GetNbrElements() - 1 : lIndiceElementActuel - 1;
                }
                lProchainElement = this.listeRegroupements.GetElement(lIndiceProchainElement);
                GInterface.updatePanelContent(this.composePanelRegroupement(lProchainElement));
            } else {
                lIndiceElementActuel = this.listeServices.GetIndiceParNumeroEtGenre(aNumeroElement);
                if (!!aEstSuivant) {
                    lIndiceProchainElement = lIndiceElementActuel + 1 < this.listeServices.GetNbrElements() ? lIndiceElementActuel + 1 : 0;
                } else {
                    lIndiceProchainElement = lIndiceElementActuel === 0 ? this.listeServices.GetNbrElements() - 1 : lIndiceElementActuel - 1;
                }
                lProchainElement = this.listeServices.GetElement(lIndiceProchainElement);
                GInterface.updatePanelContent(this.composePanelService(lProchainElement));
            }
        };
        ObjetBulletin.prototype.free = function() {
            this.inherited('free', arguments);
            if (this.identBtnFlottant) {
                $('#' + this.identBtnFlottant.GetNom().escapeJQ()).remove();
            }
        };
        module.exports = ObjetBulletin;
    },
    fn: "mobile/script/pagebulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeNote = require('TypeNote.js');
        MethodesObjet.heritagePrototype(_ObjetRequeteResultat, ObjetRequeteConsultation);

        function _ObjetRequeteResultat() {
            this.inheritedCreate(arguments);
        }(function() {
            _ObjetRequeteResultat.prototype.CreerListeServices = function(aJSON) {
                function getCoefficient(T) {
                    var R = 0;
                    for (var I in T) {
                        if (T[I].Coefficient) {
                            var V = T[I].Coefficient.getValeur();
                            if (!isNaN(V)) {
                                R += V;
                            }
                        }
                    }
                    return new TypeNote(R);
                }

                function getMoyenne(T, aNom, aArrondi) {
                    var R = 0,
                        N = 0;
                    for (var I in T) {
                        var lExiste = T[I][aNom];
                        if (lExiste) {
                            var V = T[I][aNom].getValeur();
                            if (!isNaN(V)) {
                                R += T[I].Coefficient.getValeur() * V;
                                N += T[I].Coefficient.getValeur();
                            }
                        } else if (T[I].ListeElements && T[I].ListeElements.GetNbrElements() > 0) {
                            T[I].ListeElements.parcourir(function(aEle) {
                                var lExiste = aEle[aNom];
                                if (lExiste) {
                                    var V = aEle[aNom].getValeur();
                                    if (!isNaN(V)) {
                                        R += aEle.Coefficient.getValeur() * V;
                                        N += aEle.Coefficient.getValeur();
                                    }
                                }
                            });
                        }
                    }
                    var lNote = N > 0 ? new TypeNote(R / N) : new TypeNote('');
                    return aArrondi ? new TypeNote(aArrondi.arrondir(lNote.getValeur())) : lNote;
                }

                function getNombreDevoirs(T) {
                    var R1 = 0,
                        R2 = 0,
                        N = 0;
                    for (var I in T) {
                        if ((T[I]) && T[I].NombreDevoirs) {
                            R1 += parseInt(T[I].NombreDevoirs.split('/')[0]);
                            R2 += parseInt(T[I].NombreDevoirs.split('/')[1]);
                            N++;
                        }
                    }
                    return N > 0 ? R1 + (isNaN(R2) ? '' : '/' + R2) : '';
                }

                function getNombrePointsEleve(T) {
                    var R = 0;
                    for (var I in T) {
                        if ((T[I]) && T[I].NombrePointsEleve) {
                            R += T[I].NombrePointsEleve.getValeur();
                        }
                    }
                    return new TypeNote(R > 0 ? R : '');
                }

                function calculerEstDebutRegroupement(aListeElements, aTableauDebutRegroupement) {
                    for (var I = 0; I < aListeElements.GetNbrElements(); I++) {
                        var lElement = aListeElements.GetElement(I);
                        if (!!lElement.SurMatiere) {
                            var lNumeroSurMatiere = lElement.SurMatiere.GetNumero();
                            var lCleSurMatiere = lNumeroSurMatiere + '_' + lElement.OrdreRegroupement;
                            if (lElement.SurMatiere.existeNumero() && (lElement.OrdreDansRegroupement === aTableauDebutRegroupement[lCleSurMatiere])) {
                                lElement.estDebutRegroupement = true;
                            }
                        }
                        if (lElement.ListeElements) {
                            calculerEstDebutRegroupement(lElement.ListeElements, aTableauDebutRegroupement);
                        }
                    }
                }
                this.ServiceEditable = aJSON.Editable;
                this.ExisteDevoir = false;
                this.ExisteService = false;
                this.NbrMaxServices = 0;
                this.NbrMaxDevoirs = 0;
                this.tableauSurMatieres = [];
                this.tableauDebutRegroupement = [];
                var lThis = this;
                this.ListeElements = aJSON.ListeServices;
                if (!!this.ListeElements) {
                    this.ListeElements.parcourir(function(aService) {
                        _composeDonneesService.call(lThis, aJSON, aService);
                    });
                    _trierListeServices(this.ListeElements);
                }
                this.listeSurMatieres = aJSON.ListeSurMatieres;
                if (!!this.listeSurMatieres) {
                    this.listeSurMatieres.parcourir(function(aMatiere) {
                        var lNumeroSurMatiere = aMatiere.GetNumero();
                        if (lThis.tableauSurMatieres[lNumeroSurMatiere]) {
                            lThis.tableauSurMatieres[lNumeroSurMatiere].Arrondi = aMatiere.Arrondi;
                            lThis.tableauSurMatieres[lNumeroSurMatiere].MoyenneClasse = aMatiere.MoyenneClasse;
                            lThis.tableauSurMatieres[lNumeroSurMatiere].MoyenneInf = aMatiere.MoyenneInf;
                            lThis.tableauSurMatieres[lNumeroSurMatiere].MoyenneSup = aMatiere.MoyenneSup;
                        }
                    });
                }
                calculerEstDebutRegroupement(this.ListeElements, this.tableauDebutRegroupement);
                for (var lNumero in this.tableauSurMatieres) {
                    this.tableauSurMatieres[lNumero].Coefficient = getCoefficient(this.tableauSurMatieres[lNumero].tableauServices);
                    this.tableauSurMatieres[lNumero].NombreDevoirs = getNombreDevoirs(this.tableauSurMatieres[lNumero].tableauServices);
                    this.tableauSurMatieres[lNumero].NombrePointsEleve = getNombrePointsEleve(this.tableauSurMatieres[lNumero].tableauServices);
                    this.tableauSurMatieres[lNumero].MoyenneAnnuelle = null;
                    this.tableauSurMatieres[lNumero].MoyenneEleve = getMoyenne(this.tableauSurMatieres[lNumero].tableauServices, 'MoyenneEleve', this.tableauSurMatieres[lNumero].Arrondi);
                    this.tableauSurMatieres[lNumero].ListeMoyennesPeriodes = [];
                    for (var I = 0; I < aJSON.ParametresAffichages.NombreMoyennesPeriodes; I++) {
                        this.tableauSurMatieres[lNumero].ListeMoyennesPeriodes[I] = null;
                    }
                }
            };

            function _composeDonneesService(aJSON, aService, aEstSousService) {
                this.ExisteService = true;
                if (!aService.ListeNiveauDAcquisitionPeriodes) {
                    aService.ListeNiveauDAcquisitionPeriodes = new ObjetListeElements();
                }
                if (!aService.SurMatiere) {
                    aService.SurMatiere = new ObjetElement('', 0);
                }
                var lNouvelleListeMoyennePeriodes = [];
                if (!!aService.ListeMoyennesPeriodes) {
                    MethodesTableau.parcourir(aService.ListeMoyennesPeriodes, function(aMoyennePeriode) {
                        lNouvelleListeMoyennePeriodes.push(new TypeNote(aMoyennePeriode));
                    });
                }
                aService.ListeMoyennesPeriodes = lNouvelleListeMoyennePeriodes;
                if (!!aService.SurMatiere && aService.SurMatiere.existeNumero()) {
                    var lCleSurMatiere = aService.SurMatiere.GetNumero() + '_' + aService.OrdreRegroupement;
                    if ((this.tableauDebutRegroupement[lCleSurMatiere] === null || this.tableauDebutRegroupement[lCleSurMatiere] === undefined) || (aService.OrdreDansRegroupement < this.tableauDebutRegroupement[lCleSurMatiere])) {
                        this.tableauDebutRegroupement[lCleSurMatiere] = aService.OrdreDansRegroupement;
                    }
                    if (aService.AvecMoyenneRegroupement && !aEstSousService) {
                        var lNumeroSurMatiere = aService.SurMatiere.GetNumero();
                        if (this.tableauSurMatieres[lNumeroSurMatiere] === null || this.tableauSurMatieres[lNumeroSurMatiere] === undefined) {
                            this.tableauSurMatieres[lNumeroSurMatiere] = {};
                            this.tableauSurMatieres[lNumeroSurMatiere].tableauServices = [];
                        }
                        this.tableauSurMatieres[lNumeroSurMatiere].tableauServices.push(aService);
                    }
                }
                if (!!aService.ListeElements && aService.ListeElements.GetNbrElements() > 0) {
                    aJSON.ParametresAffichages.AvecSousService = true;
                    var lThis = this;
                    aService.ListeElements.parcourir(function(aSousService) {
                        _composeDonneesService.call(lThis, aJSON, aSousService, true);
                    });
                    _trierListeServices(aService.ListeElements);
                } else {
                    this.NbrMaxServices++;
                }
                if (!!aService.ListeDevoirs && aService.ListeDevoirs.GetNbrElements() > 0) {
                    this.ExisteDevoir = true;
                    aService.ListeDevoirs.parcourir(function(aDevoir) {
                        if (!!aDevoir.ExcecutionQCM) {
                            aDevoir.executionQCM = aDevoir.ExcecutionQCM;
                        }
                        if (!!aDevoir.ExecKiosque) {
                            aDevoir.execKiosque = aDevoir.ExecKiosque;
                        }
                    });
                    aService.ListeDevoirs.setTri([ObjetTri.init('Date', true), ObjetTri.init('Position')]);
                    aService.ListeDevoirs.trier();
                    if (!aService.ListeElements || aService.ListeElements.GetNbrElements() === 0) {
                        this.NbrMaxDevoirs = Math.max(this.NbrMaxDevoirs, aService.ListeDevoirs.GetNbrElements());
                    }
                }
            }

            function _trierListeServices(aListe) {
                if (!aListe) {
                    return;
                }
                aListe.setTri([
                    ObjetTri.init('OrdreRegroupement'), ObjetTri.init('OrdreDansRegroupement'), ObjetTri.init('Matiere.Libelle'), ObjetTri.init(function(D) {
                        return D.ListeProfesseurs && D.ListeProfesseurs.GetNbrElements() ? D.ListeProfesseurs.GetLibelle(0) : '';
                    })
                ]).trier();
            }
        }());
        module.exports = _ObjetRequeteResultat;
    },
    fn: "_objetrequeteresultat.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var MethodesTableau = require('MethodesTableau.js');

        function UtilitaireDeserialiserPiedBulletin() {}
        UtilitaireDeserialiserPiedBulletin.prototype.creerAbsences = function(aJSON) {
            return {
                strAbsences: !!aJSON.ListeAbsences ? (aJSON.ListeAbsences.strAbsences || '') : '',
                strRetards: !!aJSON.ListeAbsences ? (aJSON.ListeAbsences.strRetards || '') : '',
                strPunitions: !!aJSON.ListeAbsences ? (aJSON.ListeAbsences.strPunitions || '') : '',
                strSanctions: !!aJSON.ListeAbsences ? (aJSON.ListeAbsences.strSanctions || '') : ''
            };
        };
        UtilitaireDeserialiserPiedBulletin.prototype.creerPiedDePage = function(aJSON) {
            var lResult = {};
            if (aJSON && !!aJSON.ListeProjets) {
                lResult.ListeProjets = aJSON.ListeProjets;
            }
            if (aJSON && !!aJSON.Orientation) {
                lResult.Orientation = aJSON.Orientation;
            }
            if (aJSON && !!aJSON.ListeAttestations) {
                lResult.ListeAttestations = aJSON.ListeAttestations;
            }
            if (aJSON && !!aJSON.listeAttestationsEleve) {
                lResult.ListeAttestationsEleve = aJSON.listeAttestationsEleve;
                lResult.eleve = aJSON.eleve;
            }
            if (aJSON && !!aJSON.ObjetListeAppreciations) {
                lResult.ListeAppreciations = {
                    general: new ObjetListeElements(),
                    conseilDeClasse: new ObjetListeElements(),
                    commentaires: new ObjetListeElements(),
                    cpe: new ObjetListeElements(),
                    appreciationAnnuelle: new ObjetListeElements(),
                    generalAnnuelle: new ObjetListeElements(),
                    periodes: new ObjetListeElements()
                };
                lResult.avecSaisieAG = aJSON.ObjetListeAppreciations.Editable;
                lResult.periodeCloture = aJSON.ObjetListeAppreciations.Cloture;
                if (!!aJSON.ObjetListeAppreciations.ListeAppreciations) {
                    aJSON.ObjetListeAppreciations.ListeAppreciations.parcourir(function(D) {
                        var lElement = new ObjetElement();
                        lElement.Intitule = D.Intitule;
                        lElement.Editable = aJSON.ObjetListeAppreciations.Editable;
                        lElement.Cloture = aJSON.ObjetListeAppreciations.Cloture;
                        lElement.Genre = D.GetGenre();
                        lElement.ListeAppreciations = new ObjetListeElements();
                        lElement.ListeAppreciations.AddElement(D);
                        if (lElement.Genre === 0) {
                            lResult.ListeAppreciations.general.AddElement(lElement);
                        } else if (lElement.Genre === 1 || lElement.Genre === 2 || lElement.Genre === 3 || lElement.Genre === 8) {
                            lResult.ListeAppreciations.conseilDeClasse.AddElement(lElement);
                        } else if (lElement.Genre === 4 || lElement.Genre === 5 || lElement.Genre === 6) {
                            lResult.ListeAppreciations.commentaires.AddElement(lElement);
                        } else if (lElement.Genre === 7) {
                            lResult.ListeAppreciations.cpe.AddElement(lElement);
                        }
                    });
                }
                if (!!aJSON.ObjetListeAppreciations.listePeriodes) {
                    aJSON.ObjetListeAppreciations.listePeriodes.parcourir(function(D) {
                        lResult.ListeAppreciations.periodes.AddElement(D);
                    });
                    lResult.ListeAppreciations.appreciationAnnuelle = _formatListeAppreciationAnnuelle(aJSON.ObjetListeAppreciations.listePeriodes, false);
                    lResult.ListeAppreciations.generalAnnuelle = _formatListeAppreciationAnnuelle(aJSON.ObjetListeAppreciations.listePeriodes, true);
                }
            }
            if (aJSON && aJSON.listePiliers) {
                lResult.listePiliers = aJSON.listePiliers;
                lResult.avecValidationAuto = aJSON.avecValidationAuto;
            }
            if (aJSON) {
                lResult.listeMentions = aJSON.listeMentions;
            }
            if (aJSON && !!aJSON.ListeStages) {
                lResult.listeStages = aJSON.ListeStages;
            }
            if (aJSON && !!aJSON.ListeMentionsClasse) {
                lResult.ListeMentionsClasse = aJSON.ListeMentionsClasse;
            }
            if (aJSON && !!aJSON.ParcoursEducatif) {
                lResult.libelleUtilisateur = aJSON.ParcoursEducatif.libelleUtilisateur;
                lResult.listeEvntsParcoursPeda = aJSON.ParcoursEducatif.listeParcours;
                lResult.listeGenreParcours = aJSON.ParcoursEducatif.listeGenreParcours;
            }
            lResult.legende = aJSON.Legende;
            lResult.listeCredits = aJSON.listeCredits;
            return lResult;
        };

        function _formatListeAppreciationAnnuelle(aListePeriode, aGlobal) {
            var lAppreciations = new ObjetListeElements();
            var lGenreAppreciation = [];
            aListePeriode.parcourir(function(periode) {
                var lListeAppreciation = (aGlobal) ? periode.listeAppreciationsGenerales : periode.listeAppreciations;
                if (lListeAppreciation) {
                    lListeAppreciation.parcourir(function(D) {
                        if (MethodesTableau.existe(D.GetGenre(), lGenreAppreciation)) {
                            var lListeIntitule = lAppreciations.GetElementParGenre(D.GetGenre()).Intitule;
                            if (!MethodesTableau.existe(D.Intitule, lListeIntitule)) {
                                lAppreciations.GetElementParGenre(D.GetGenre()).Intitule.push(D.Intitule);
                            }
                        } else {
                            lGenreAppreciation.push(D.GetGenre());
                            var lElement = new ObjetElement();
                            lElement.Intitule = [D.Intitule];
                            lElement.Editable = D.Editable;
                            lElement.Cloture = D.cloture;
                            lElement.Genre = D.GetGenre();
                            lElement.global = aGlobal;
                            lAppreciations.AddElement(lElement);
                        }
                    });
                }
            });
            return lAppreciations;
        }
        module.exports = UtilitaireDeserialiserPiedBulletin;
    },
    fn: "utilitairedeserialiserpiedbulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var _ObjetRequeteResultat = require('_ObjetRequeteResultat.js');
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var UtilitaireDeserialiserPiedBulletin = require('UtilitaireDeserialiserPiedBulletin.js');

        function ObjetRequetePageBulletins() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageBulletins', ObjetRequetePageBulletins, _ObjetRequeteResultat);
        ObjetRequetePageBulletins.prototype.lancerRequete = function(aParam) {
            var lParam = {
                eleve: new ObjetElement(),
                classe: new ObjetElement(),
                periode: new ObjetElement()
            };
            $.extend(lParam, aParam);
            this.JSON = {
                eleve: lParam.eleve,
                periode: lParam.periode,
                classe: lParam.classe
            };
            return this.appelAsynchrone();
        };
        ObjetRequetePageBulletins.prototype.actionApresRequete = function() {
            var lParam = {
                aCopier: {},
                absences: {}
            };
            lParam.Message = this.JSONReponse.Message;
            if (!lParam.Message) {
                lParam.aCopier.classe = this.JSONReponse.Classe;
                lParam.aCopier.strInfoDatePublication = this.JSONReponse.strInfoDatePublication;
                if ((this.JSONReponse.NoteBareme !== null) && (this.JSONReponse.NoteBareme !== undefined)) {
                    lParam.aCopier.baremeNotationNiveau = this.JSONReponse.NoteBareme;
                }
                var lExisteServiceAvecNotes = this.JSONReponse.existeServiceAvecNotes;
                var lExisteServiceSansNotes = this.JSONReponse.existeServiceSansNotes;
                lParam.aCopier.Affichage = this.JSONReponse.ParametresAffichages;
                lParam.aCopier.Affichage.existeServiceAvecNotes = lExisteServiceAvecNotes;
                lParam.aCopier.Affichage.existeServiceSansNotes = lExisteServiceSansNotes;
                lParam.aCopier.Affichage.pourClasseAvecNotes = lExisteServiceAvecNotes && !lExisteServiceSansNotes;
                lParam.aCopier.Affichage.pourClasseSansNotes = !lExisteServiceAvecNotes && lExisteServiceSansNotes;
                if (lExisteServiceSansNotes) {
                    lParam.aCopier.Affichage.posClasse = this.JSONReponse.TypePositionnementClasse;
                }
                this.CreerListeServices(this.JSONReponse);
                lParam.aCopier.ServiceEditable = this.ServiceEditable;
                lParam.aCopier.ExisteDevoir = this.ExisteDevoir;
                lParam.aCopier.ExisteService = this.ExisteService;
                lParam.aCopier.NbrMaxServices = this.NbrMaxServices;
                lParam.aCopier.NbrMaxDevoirs = this.NbrMaxDevoirs;
                lParam.aCopier.tableauSurMatieres = this.tableauSurMatieres;
                lParam.aCopier.tableauDebutRegroupement = this.tableauDebutRegroupement;
                lParam.aCopier.ListeElements = this.ListeElements;
                lParam.aCopier.listeAnnotations = this.JSONReponse.listeAnnotations;
                lParam.aCopier.MoyenneGenerale = this.JSONReponse.General;
                lParam.aCopier.graph = this.JSONReponse.graphe;
                $.extend(lParam.absences, new UtilitaireDeserialiserPiedBulletin().creerAbsences(this.JSONReponse));
                lParam.aCopier.PiedDePage = new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(this.JSONReponse);
            }
            this.callbackReussite.appel(lParam);
        };
        module.exports = ObjetRequetePageBulletins;
    },
    fn: "objetrequetepagebulletins.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetBulletin = require('mobile/script/PageBulletin.js');
        var EGenreMessage = require('Enumere_Message.js');
        var ObjetRequetePageBulletins = require('ObjetRequetePageBulletins.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageBulletin, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageBulletin() {
            this.inheritedCreate(arguments);
            this.listePeriodes = new ObjetListeElements();
            this.periodeCourant = new ObjetElement();
            this.indiceParDefaut = 0;
            this.swipeActif = true;
        }
        ObjetAffichagePageBulletin.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, this.evenementSelection);
            this.identPage = this.Add(ObjetBulletin, null, function(aInstance) {
                aInstance.setSwipeActif = function(aActif) {
                    this.swipeActif = aActif;
                }.bind(this);
            });
            this.AddSurZone = [this.identSelection];
        };
        ObjetAffichagePageBulletin.prototype.DetruireInstances = function() {};
        ObjetAffichagePageBulletin.prototype.evenementSwipe = function(event) {
            if (this.swipeActif) {
                if (event.type === 'swiperight') {
                    this.GetInstance(this.identSelection).surPrecedent();
                } else {
                    this.GetInstance(this.identSelection).surSuivant();
                }
            }
        };
        ObjetAffichagePageBulletin.prototype.RecupererDonnees = function() {
            var lOngletInfosPeriodes = GEtatUtilisateur.getOngletInfosPeriodes();
            var lNrPeriodeParDefaut;
            if (lOngletInfosPeriodes.message) {
                this.GetInstance(this.identPage).SetMessage(lOngletInfosPeriodes.message);
            } else {
                this.listePeriodes = lOngletInfosPeriodes.listePeriodes;
                if (!(this.listePeriodes && this.listePeriodes.GetNbrElements())) {
                    var lGenreMessage = EGenreMessage.AucunBulletinPourEleve;
                    var lMessage = typeof(lGenreMessage) === 'number' ? GTraductions.getValeur('Message')[lGenreMessage] : lGenreMessage;
                    var lHtml = [];
                    lHtml.push(this.composeAucuneDonnee(lMessage));
                    GHtml.setHtml(this.Nom, lHtml);
                } else {
                    if (GEtatUtilisateur.getPeriodePourBulletin()) {
                        lNrPeriodeParDefaut = GEtatUtilisateur.getPeriodePourBulletin();
                    } else {
                        lNrPeriodeParDefaut = GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().periode ? GEtatUtilisateur.getPage().periode.GetNumero() : lOngletInfosPeriodes.periodeParDefaut.GetNumero();
                    }
                    this.indiceParDefaut = this.listePeriodes.GetIndiceParNumeroEtGenre(lNrPeriodeParDefaut);
                    if (!this.indiceParDefaut) {
                        this.indiceParDefaut = 0;
                    }
                    this.periodeCourant = this.listePeriodes.GetElement(this.indiceParDefaut);
                    this.GetInstance(this.identSelection).SetDonnees(this.listePeriodes, this.indiceParDefaut, this.GetInstance(this.identPage).GetNom(), '');
                    $('#' + this.GetInstance(this.identPage).GetNom().escapeJQ()).css('min-height', ((parseInt($('#' + this.Nom.escapeJQ()).css('min-height')) - $('#' + this.GetInstance(this.identSelection).GetNom().escapeJQ()).height()) * 0.9) + 'px');
                }
            }
            if (GEtatUtilisateur.getPeriodePourBulletin()) {
                GEtatUtilisateur.setPeriodePourBulletin(null);
            }
        };
        ObjetAffichagePageBulletin.prototype.RecupererDonneesBulletin = function() {
            new ObjetRequetePageBulletins(this, this.ActionSurRecupBulletin).lancerRequete({
                eleve: GEtatUtilisateur.getMembre(),
                periode: this.periodeCourant
            });
        };
        ObjetAffichagePageBulletin.prototype.ActionSurRecupBulletin = function(aParam) {
            this.graph = '';
            if (!!aParam.Message) {
                this.GetInstance(this.identPage).SetMessage(aParam.Message);
            } else {
                $.extend(this, aParam.aCopier);
                this.GetInstance(this.identPage).SetDonnees(this.ListeElements, this.positionPeriodeCourant, this.listePeriodes.GetNbrElements() - 1, this.tableauSurMatieres, this.MoyenneGenerale, aParam.absences, this.PiedDePage, this.Affichage, this.periodeCourant);
            }
            this.actionAppliMobile();
        };
        ObjetAffichagePageBulletin.prototype.actionAppliMobile = function() {};
        ObjetAffichagePageBulletin.prototype.evenementSelection = function(aGenreEvenement, aParam) {
            this.periodeCourant = aParam.element;
            this.positionPeriodeCourant = this.listePeriodes.GetIndiceParElement(this.periodeCourant);
            this.RecupererDonneesBulletin();
        };
        module.exports = ObjetAffichagePageBulletin;
    },
    fn: "interfacepagebulletin.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        MethodesObjet.heritagePrototype(ObjetAffichageDonneesListe_Mobile, ObjetIdentite_Mobile);

        function ObjetAffichageDonneesListe_Mobile() {
            this.inheritedCreate(arguments);
            this.listeHtml = new ObjetListeElements();
        }
        ObjetAffichageDonneesListe_Mobile.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            if (this.listeHtml && this.listeHtml.GetNbrElements()) {
                lHtml.push('<ul class="collection with-header">');
                this.listeHtml.parcourir((function(aEle) {
                    if (aEle.estUnDeploiement) {
                        lHtml.push('<li class="collection-header">' + aEle.GetLibelle() + '</li>');
                    } else {
                        var lResult = this.fonctionAffichage(aEle);
                        if (!!lResult) {
                            lHtml.push('<li class="collection-item" style="min-height: 4rem;">' + lResult + '</li>');
                        }
                    }
                }).bind(this));
                lHtml.push('</ul>');
            }
            return lHtml.join('');
        };
        ObjetAffichageDonneesListe_Mobile.prototype.SetDonnees = function(aListe, aFonction) {
            this.listeHtml = aListe;
            this.fonctionAffichage = aFonction;
            this.Afficher();
        };
        module.exports = ObjetAffichageDonneesListe_Mobile;
    },
    fn: "mobile/script/objetaffichagedonneesliste_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreRessource = require('Enumere_Ressource.js');

        function ObjetRequetePageEquipePedagogique() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageEquipePedagogique', ObjetRequetePageEquipePedagogique, ObjetRequeteConsultation);
        ObjetRequetePageEquipePedagogique.prototype.lancerRequete = function(aParametres) {
            $.extend(this.JSON, aParametres);
            return this.appelAsynchrone();
        };
        ObjetRequetePageEquipePedagogique.prototype.actionApresRequete = function() {
            var lCumul, lAvecEnseignant, lAvecEnseignantEnleve, lAvecPersonnel;
            var lListe = this.JSONReponse.liste;
            lListe.parcourir(function(aElement) {
                if ((aElement.GetGenre() === EGenreRessource.Enseignant) && !aElement.estEnleve) {
                    lAvecEnseignant = true;
                }
                if (aElement.GetGenre() === EGenreRessource.Enseignant && aElement.estEnleve) {
                    lAvecEnseignantEnleve = true;
                }
                if (aElement.GetGenre() === EGenreRessource.Personnel) {
                    lAvecPersonnel = true;
                }
                if (aElement.matieres) {
                    aElement.matieres.setTri([ObjetTri.init(function(D) {
                        return D.estUneSousMatiere ? D.libelleMatiere : D.GetLibelle();
                    }), ObjetTri.init(function(D) {
                        return !!D.estUneSousMatiere;
                    }), ObjetTri.init('Libelle')]);
                    aElement.matieres.trier();
                }
            });
            if (lAvecEnseignant && (lAvecEnseignantEnleve || lAvecPersonnel)) {
                lCumul = new ObjetElement(GTraductions.getValeur('EquipePedagogique.professeursDEquipe'));
                lCumul.Genre = EGenreRessource.Enseignant;
                lCumul.estUnDeploiement = true;
                lCumul.estDeploye = true;
                lListe.AddElement(lCumul);
            }
            if (lAvecEnseignantEnleve) {
                lCumul = new ObjetElement(GTraductions.getValeur('EquipePedagogique.autresProfesseursDEquipe'));
                lCumul.Genre = EGenreRessource.Enseignant;
                lCumul.estUnDeploiement = true;
                lCumul.estDeploye = true;
                lCumul.estEnleve = true;
                lListe.AddElement(lCumul);
            }
            if (lAvecPersonnel) {
                lCumul = new ObjetElement(GTraductions.getValeur('EquipePedagogique.personnelsDEquipe'));
                lCumul.Genre = EGenreRessource.Personnel;
                lCumul.estUnDeploiement = true;
                lCumul.estDeploye = true;
                lListe.AddElement(lCumul);
            }
            lListe.setTri([
                ObjetTri.init(function(D) {
                    return D.GetGenre() === EGenreRessource.Enseignant ? false : true;
                }), ObjetTri.init(function(D) {
                    return D.estEnleve ? true : false;
                }), ObjetTri.init(function(D) {
                    return D.Position;
                })
            ]);
            lListe.trier();
            this.callbackReussite.appel(lListe);
        };
        module.exports = ObjetRequetePageEquipePedagogique;
    },
    fn: "objetrequetepageequipepedagogique.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        MethodesObjet.heritagePrototype(ObjetTabs, ObjetIdentite_Mobile);

        function ObjetTabs() {
            this.inheritedCreate(arguments);
            this.listeTabs = new ObjetListeElements();
            this.options = {
                avecSwipe: false
            };
        }
        ObjetTabs.prototype.getControleur = function(aInstance) {
            return {
                estOngletsVisibles: function() {
                    return _avecOngletsAffiches.call(aInstance);
                }
            };
        };
        ObjetTabs.prototype.SetParametres = function(aOptions) {
            Object.assign(this.options, aOptions);
        };

        function _avecOngletsAffiches() {
            var lNbElementsActifs = this.listeTabs.getListeElements(function(ele) {
                return !!ele.Actif;
            }).GetNbrElements();
            return lNbElementsActifs > 1;
        }

        function _getNomDivWrapper(aNomDiv) {
            return aNomDiv + '_wrapper';
        }
        ObjetTabs.prototype.getOngletSelectionne = function() {
            var lTabSelectionne = null;
            var $tabActif = $('#' + this.Nom.escapeJQ()).find('.tabs li.tab').children('a.active');
            if (!!$tabActif && $tabActif.length > 0) {
                var lIdDivTabSelectionne = $tabActif.data('iddiv');
                this.listeTabs.parcourir(function(D) {
                    if (D.idDiv === lIdDivTabSelectionne) {
                        lTabSelectionne = D;
                        return false;
                    }
                });
            }
            return lTabSelectionne;
        };
        ObjetTabs.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            lHtml.push('<ul class="tabs" ie-display="estOngletsVisibles">');
            this.listeTabs.parcourir(function(D) {
                if (D.Actif) {
                    lHtml.push('<li class="tab">', '<a href="#', _getNomDivWrapper(D.idDiv), '" data-iddiv="', D.idDiv, '">', D.GetLibelle(), '</a>', '</li>');
                }
            });
            lHtml.push('</ul>');
            return lHtml.join('');
        };
        ObjetTabs.prototype.setDonnees = function(aListe) {
            if (_avecOngletsAffiches.call(this)) {
                this.destroy();
            }
            if (!!aListe) {
                var lListeTab = new ObjetListeElements();
                aListe.parcourir(function(ele) {
                    var lEle = new ObjetElement(ele.GetLibelle(), ele.GetNumero(), ele.GetGenre(), ele.Position, ele.Actif);
                    lEle.idDiv = ele.idDiv;
                    lListeTab.AddElement(lEle);
                });
                this.listeTabs = lListeTab;
                for (var i = 0; i < this.listeTabs.GetNbrElements(); i++) {
                    var lElem = this.listeTabs.GetElement(i);
                    if (lElem.Actif) {
                        if (!$('#' + lElem.idDiv.escapeJQ()).parent().is('#' + _getNomDivWrapper(lElem.idDiv.escapeJQ()))) {
                            $('#' + lElem.idDiv.escapeJQ()).show().wrap('<div id="' + _getNomDivWrapper(lElem.idDiv) + '"></div>');
                        } else {
                            $('#' + lElem.idDiv.escapeJQ()).show();
                        }
                    } else {
                        $('#' + lElem.idDiv.escapeJQ()).hide();
                    }
                }
            }
            this.Afficher();
        };
        ObjetTabs.prototype.destroy = function() {
            var lInstanceTabs = this.getInstanceTabs();
            if (!!lInstanceTabs) {
                lInstanceTabs.destroy();
            }
        };
        ObjetTabs.prototype.getInstanceTabs = function() {
            var $tabs = $('#' + this.Nom.escapeJQ()).find('.tabs');
            return M.Tabs.getInstance($tabs);
        };
        ObjetTabs.prototype.initialiseInstanceTabs = function() {
            var lThis = this;
            var $tabs = $('#' + this.Nom.escapeJQ()).find('.tabs');
            M.Tabs.init($tabs, {
                swipeable: this.options.avecSwipe,
                onShow: function(aElement) {
                    $(aElement).parent().scrollTop(0);
                    if (!!lThis.callback) {
                        var lTabSelectionne = lThis.getOngletSelectionne();
                        lThis.callback.appel(lTabSelectionne);
                    }
                }
            });
        };
        ObjetTabs.prototype.Afficher = function(aHtml, aDirectionSlide) {
            this.inherited('Afficher', aHtml, aDirectionSlide);
            if (_avecOngletsAffiches.call(this)) {
                if (!this.getInstanceTabs()) {
                    this.initialiseInstanceTabs();
                }
            }
        };
        module.exports = ObjetTabs;
    },
    fn: "objettabs.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetAffichageDonneesListe_Mobile = require('mobile/script/ObjetAffichageDonneesListe_Mobile.js');
        var ObjetRequetePageEquipePedagogique = require('ObjetRequetePageEquipePedagogique.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTabs = require('ObjetTabs.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreRessource = require('Enumere_Ressource.js');
        MethodesObjet.heritagePrototype(ObjetAffichageEquipePedagogique, ObjetInterfacePage_Mobile);

        function ObjetAffichageEquipePedagogique() {
            this.inheritedCreate(arguments);
            this.listeTabs = new ObjetListeElements();
        }
        ObjetAffichageEquipePedagogique.prototype.ConstruireInstances = function() {
            this.identTabs = this.Add(ObjetTabs, null, _initialiserObjetTabs);
            this.identObjetEquipePedaParNom = this.Add(ObjetAffichageDonneesListe_Mobile);
            var lElement = new ObjetElement(GTraductions.getValeur('EquipePedagogique.liste.titre.nom'), null, EGenreRessource.Personnel, null, false);
            lElement.idDiv = this.GetInstance(this.identObjetEquipePedaParNom).GetNom();
            this.listeTabs.AddElement(lElement);
            this.identObjetEquipePedaParMatiereFonction = this.Add(ObjetAffichageDonneesListe_Mobile);
            lElement = new ObjetElement(GTraductions.getValeur('EquipePedagogique.liste.titre.matiereFonction'), null, EGenreRessource.Specialite, null, false);
            lElement.idDiv = this.GetInstance(this.identObjetEquipePedaParMatiereFonction).GetNom();
            this.listeTabs.AddElement(lElement);
            this.AddSurZone = [this.identTabs];
        };
        ObjetAffichageEquipePedagogique.prototype.RecupererDonnees = function() {
            new ObjetRequetePageEquipePedagogique(this, this.actionSurRecupererDonnees).lancerRequete();
        };

        function formaterListeParMatiereEtFonction(aListeEquipePedagogique) {
            var lListe = new ObjetListeElements();
            if (!!aListeEquipePedagogique) {
                var lLibelleSansMatiere = GTraductions.getValeur('EquipePedagogique.sansMatiere');
                aListeEquipePedagogique.parcourir(function(D) {
                    if (D.estUnDeploiement) {
                        var lElement = MethodesObjet.dupliquer(D);
                        lElement.libelleTri = '';
                        lListe.AddElement(lElement);
                    } else {
                        switch (D.GetGenre()) {
                            case EGenreRessource.Enseignant:
                                if (!D.matieres || D.matieres.GetNbrElements() === 0) {
                                    lElement = lListe.GetElementParLibelle(lLibelleSansMatiere);
                                    if (!lElement) {
                                        lElement = new ObjetElement(lLibelleSansMatiere, null, EGenreRessource.Enseignant);
                                        lElement.libelleTri = lElement.GetLibelle();
                                        lElement.listeProfesseurs = new ObjetListeElements();
                                        lListe.AddElement(lElement);
                                    }
                                    lElement.listeProfesseurs.AddElement(D);
                                } else {
                                    D.matieres.parcourir(function(aMatiereDeProfesseur) {
                                        if (!aMatiereDeProfesseur.estUneSousMatiere) {
                                            lElement = null;
                                            lListe.parcourir(function(D2) {
                                                if (aMatiereDeProfesseur.GetLibelle() === D.GetLibelle()) {
                                                    if (!!D.estEnleve === !!D2.estEnleve) {
                                                        lElement = D;
                                                        return true;
                                                    }
                                                }
                                            });
                                            if (!lElement) {
                                                lElement = MethodesObjet.dupliquer(aMatiereDeProfesseur);
                                                lElement.Genre = EGenreRessource.Enseignant;
                                                lElement.estEnleve = D.estEnleve;
                                                lElement.libelleTri = lElement.GetLibelle();
                                                lElement.listeProfesseurs = new ObjetListeElements();
                                                lListe.AddElement(lElement);
                                            }
                                            D.volumeHoraire = aMatiereDeProfesseur.volumeHoraire;
                                            lElement.listeProfesseurs.AddElement(D);
                                            if (lElement.listeProfesseurs.GetNbrElements() > 1) {
                                                lElement.volumeHoraire = '';
                                            }
                                        }
                                    });
                                }
                                break;
                            case EGenreRessource.Personnel:
                                var lLibelleFonction = D.fonction ? D.fonction : GTraductions.getValeur('EquipePedagogique.fonctionInconnue');
                                lElement = lListe.GetElementParLibelle(lLibelleFonction);
                                if (!lElement) {
                                    lElement = new ObjetElement(lLibelleFonction, null, EGenreRessource.Personnel);
                                    lElement.libelleTri = lElement.GetLibelle();
                                    lElement.listePersonnel = new ObjetListeElements();
                                    lListe.AddElement(lElement);
                                }
                                lElement.listePersonnel.AddElement(D);
                                break;
                        }
                    }
                });
            }
            lListe.setTri([
                ObjetTri.init(function(D) {
                    return D.GetGenre() === EGenreRessource.Enseignant ? false : true;
                }), ObjetTri.init(function(D) {
                    return D.estEnleve ? true : false;
                }), ObjetTri.init(function(D) {
                    return D.libelleTri;
                })
            ]);
            lListe.trier();
            return lListe;
        }
        ObjetAffichageEquipePedagogique.prototype.actionSurRecupererDonnees = function(aListeEquipePedagogique) {
            if (!!aListeEquipePedagogique) {
                this.listeEquipeParNom = aListeEquipePedagogique;
                this.listeEquipeParMatiereEtFonction = formaterListeParMatiereEtFonction(aListeEquipePedagogique);
                this.listeTabs.GetElementParGenre(EGenreRessource.Personnel).Actif = true;
                this.listeTabs.GetElementParGenre(EGenreRessource.Specialite).Actif = true;
                this.AfficherDonnees();
                this.GetInstance(this.identTabs).setDonnees(this.listeTabs);
            }
        };

        function getArrayLibellesProfPrincipalEtTuteur(aProfesseur) {
            var lArrayStr = [];
            if (!!aProfesseur) {
                if (!!aProfesseur.estProfesseurPrincipal) {
                    lArrayStr.push(GTraductions.getValeur('EquipePedagogique.professeurPrincipal'));
                }
                if (!!aProfesseur.estTuteur) {
                    lArrayStr.push(GTraductions.getValeur('EquipePedagogique.tuteur'));
                }
            }
            return lArrayStr;
        }
        ObjetAffichageEquipePedagogique.prototype.AfficherDonnees = function() {
            var lLibelleProfesseur, lLibellesPPEtTuteur, lMail;
            this.GetInstance(this.identObjetEquipePedaParNom).SetDonnees(this.listeEquipeParNom, function(aElem) {
                var lHtml = [];
                if (aElem.GetGenre() === EGenreRessource.Enseignant) {
                    var lProf = aElem,
                        lNbrMatieres = lProf.matieres.GetNbrElements();
                    lMail = lProf.email;
                    lLibellesPPEtTuteur = getArrayLibellesProfPrincipalEtTuteur(lProf);
                    lLibelleProfesseur = lProf.GetLibelle();
                    if (lLibellesPPEtTuteur.length > 0) {
                        lHtml.push('<div class="right">', lLibellesPPEtTuteur.join('<br>'), '</div>');
                    }
                    lHtml.push('<div class="title">', lLibelleProfesseur, '</div>');
                    for (var m = 0; m < lNbrMatieres; m++) {
                        var lMatiere = lProf.matieres.GetElement(m),
                            lLibelleMatiere = lMatiere.GetLibelle(),
                            lVolumeHoraire = lMatiere.volumeHoraire ? '&nbsp;(' + lMatiere.volumeHoraire + ')' : '';
                        lHtml.push('<div style="', (lMatiere.estUneSousMatiere ? 'text-indent:15px;' : ''), '">', lLibelleMatiere + lVolumeHoraire, '</div>');
                    }
                    if (!!lMail) {
                        lHtml.push('<a class="link" href="mailto:' + lMail + '">', lMail, '</a>');
                    }
                } else if (aElem.GetGenre() === EGenreRessource.Personnel) {
                    var lPersonnel = aElem,
                        lLibellePersonnel = lPersonnel.GetLibelle(),
                        lFonction = lPersonnel.fonction;
                    lMail = lPersonnel.email, lHtml.push('<div class="title" >', lLibellePersonnel, '</div>');
                    lHtml.push('<div>', lFonction, '</div>');
                    if (!!lMail) {
                        lHtml.push('<a class="link" href="mailto:' + lMail + '">' + lMail, '</a>');
                    }
                }
                return lHtml.join('');
            });
            this.GetInstance(this.identObjetEquipePedaParMatiereFonction).SetDonnees(this.listeEquipeParMatiereEtFonction, function(aElem) {
                var lHtml = [];
                if (aElem.GetGenre() === EGenreRessource.Enseignant) {
                    var lService = aElem,
                        lListeProfesseurs = lService.listeProfesseurs,
                        lVolumeHoraire = lService.volumeHoraire ? '&nbsp;(' + lService.volumeHoraire + ')' : '';
                    lHtml.push('<div class="title">', lService.GetLibelle() + lVolumeHoraire, '</div>');
                    for (var p = 0, lNbrProfDuService = lListeProfesseurs.GetNbrElements(); p < lNbrProfDuService; p++) {
                        var lEstProfDeSousService = false,
                            lProfDeService = lListeProfesseurs.GetElement(p),
                            lListeServicesDuProf = lProfDeService.matieres;
                        for (var l = 0, lNbrServicesesDuProf = lListeServicesDuProf.GetNbrElements(); l < lNbrServicesesDuProf; l++) {
                            var lServiceDuProf = lListeServicesDuProf.GetElement(l);
                            if (lServiceDuProf.servicePere && lServiceDuProf.servicePere.GetNumero() === lService.GetNumero()) {
                                lEstProfDeSousService = true;
                            }
                        }
                        if (!lEstProfDeSousService) {
                            var lVolumeHoraireDuProf = '';
                            if (lNbrProfDuService !== 1) {
                                lVolumeHoraireDuProf = lProfDeService.volumeHoraire ? '&nbsp;(' + lProfDeService.volumeHoraire + ')' : '';
                            }
                            lHtml.push('<div>');
                            lLibellesPPEtTuteur = getArrayLibellesProfPrincipalEtTuteur(lProfDeService);
                            if (lLibellesPPEtTuteur.length > 0) {
                                lHtml.push('<div class="right">', lLibellesPPEtTuteur.join('<br>'), '</div>');
                            }
                            lHtml.push('<div>', lProfDeService.GetLibelle() + lVolumeHoraireDuProf, '</div>');
                            if (!!lProfDeService.eMail) {
                                lHtml.push('<a class="link" href="mailto:' + lProfDeService.email + '">' + lProfDeService.eMail + '</a>');
                            }
                            lHtml.push('</div>');
                        }
                    }
                    for (var j = 0, lNbProfesseursDeMatiere = lListeProfesseurs.GetNbrElements(); j < lNbProfesseursDeMatiere; j++) {
                        var lProfDeSousService = lListeProfesseurs.GetElement(j),
                            lListeSousServicesDuProf = lProfDeSousService.matieres;
                        lLibellesPPEtTuteur = getArrayLibellesProfPrincipalEtTuteur(lProfDeService);
                        for (var K = 0, lNbServicesesDuProf = lListeSousServicesDuProf.GetNbrElements(); K < lNbServicesesDuProf; K++) {
                            var lSousServiceDuProf = lListeSousServicesDuProf.GetElement(K);
                            if (lSousServiceDuProf.servicePere && lSousServiceDuProf.servicePere.GetNumero() === lService.GetNumero()) {
                                var lVolumeHoraireSousMatiereDuProf = lSousServiceDuProf.volumeHoraire ? '(' + lSousServiceDuProf.volumeHoraire + ')' : '';
                                lHtml.push('<div class="title">', lSousServiceDuProf.GetLibelle() + lVolumeHoraireSousMatiereDuProf, '</div>');
                                var lVolumeHoraireDuProfSousService = lProfDeSousService.volumeHoraire ? '&nbsp;(' + lProfDeSousService.volumeHoraire + ')' : '';
                                lHtml.push('<div>');
                                if (lLibellesPPEtTuteur.length > 0) {
                                    lHtml.push('<div class="right">', lLibellesPPEtTuteur.join('<br>'), '</div>');
                                }
                                lHtml.push('<div>', lProfDeSousService.GetLibelle() + lVolumeHoraireDuProfSousService, '</div>');
                                if (!!lProfDeSousService.eMail) {
                                    lHtml.push('<a class="link" href="mailto:' + lProfDeSousService.email + '">' + lProfDeSousService.eMail + '</a>');
                                }
                                lHtml.push('</div>');
                            }
                        }
                    }
                } else if (aElem.GetGenre() === EGenreRessource.Personnel) {
                    var lFonction = aElem;
                    lHtml.push('<div class="title">', lFonction.GetLibelle(), '</div>');
                    var lNrePersonnel = lFonction.listePersonnel.GetNbrElements();
                    for (var i = 0; i < lNrePersonnel; i++) {
                        var lPersonnel = lFonction.listePersonnel.GetElement(i),
                            lMail = lPersonnel.email;
                        lHtml.push('<div>', lPersonnel.GetLibelle(), '</div>');
                        if (!!lMail) {
                            lHtml.push('<a class="link" href="mailto:' + lMail + '">' + lMail + '</a>');
                        }
                    }
                }
                return lHtml.join('');
            });
        };

        function _initialiserObjetTabs(aInstance) {
            aInstance.SetParametres({
                avecSwipe: true
            });
        }
        module.exports = ObjetAffichageEquipePedagogique;
    },
    fn: "mobile/script/interfacepageequipepedagogique.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var UtilitaireBulletinEtReleve_Mobile = require('UtilitaireBulletinEtReleve_Mobile.js');
        var EGenreDirectionSlide = require('EGenreDirectionSlide.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var ObjetElement = require('ObjetElement.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var ObjetBoutonFlottant = require('ObjetBoutonFlottant.js');
        var TypeHttpGenerationPDFSco = require('TypeHttpGenerationPDFSco.js').TypeHttpGenerationPDFSco;
        var GenerationPDF = require('utilitairegenerationpdf.js');
        var OptionsPdf = require('OptionsPDFSco.js');
        MethodesObjet.heritagePrototype(ObjetReleveDeNotes, ObjetIdentite_Mobile);

        function ObjetReleveDeNotes() {
            this.inheritedCreate(arguments);
            this.tableauVisible = [];
            this.donneesRecues = false;
            this.donneesRecues = false;
        }
        ObjetReleveDeNotes.prototype.getControleur = function(aInstance) {
            return {
                getIdentiteBouton: function() {
                    return {
                        class: ObjetBoutonFlottant,
                        pere: this,
                        init: function(aBtn) {
                            aInstance.identBtnFlottant = aBtn;
                            var lParam = {
                                listeBoutons: [{
                                    primaire: true,
                                    icone: "icon_pdf",
                                    callback: _genererPdf.bind(this, aInstance)
                                }]
                            };
                            aBtn.setOptionsBouton(lParam);
                        }
                    };
                }
            };
        };

        function _genererPdf(aInstance) {
            var lParametrageAffichage = {
                genreGenerationPDF: TypeHttpGenerationPDFSco.ReleveDeNotes,
                periode: aInstance.periode
            };
            GenerationPDF.genererPDF({
                paramPDF: lParametrageAffichage,
                optionsPDF: OptionsPdf.ReleveDeNotes
            });
        }
        ObjetReleveDeNotes.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            if (!!this.message) {
                lHtml.push(this.composeAucuneDonnee(this.message));
                if (!!this.identBtnFlottant) {
                    this.identBtnFlottant.SetVisible(false);
                }
            } else if (this.donneesRecues) {
                if (!!this.identBtnFlottant) {
                    this.identBtnFlottant.SetVisible(true);
                }
                lHtml.push('<div class="has-float-btn-bottom">');
                lHtml.push(this.composeServices());
                lHtml.push('</div>');
                if (GApplication.droits.get(TypeDroits.autoriserImpression) && !this.identBtnFlottant) {
                    $("#" + GInterface.idZonePrincipale).IEHtmlAppend('<div class="is-sticky" ie-identite="getIdentiteBouton" ></div>', {
                        controleur: this.controleur,
                        avecCommentaireConstructeur: false
                    });
                }
            }
            return lHtml.join('');
        };
        ObjetReleveDeNotes.prototype.SetMessage = function(aMessage) {
            this.message = aMessage;
            this.Afficher();
        };
        ObjetReleveDeNotes.prototype.SetDonnees = function(aListeServices, aMoyenneGenerale, aDonneesAbsences, aPiedDePage, aAffichage, aPositionPeriode, aPositionMax, aPeriode) {
            this.listeServices = aListeServices;
            this.moyenneGenerale = aMoyenneGenerale;
            this.donneesAbsences = aDonneesAbsences;
            this.PiedDePage = aPiedDePage;
            this.Affichage = aAffichage;
            this.message = false;
            this.periode = aPeriode;
            var lSensSlide;
            this.donneesRecues = true;
            if (this.precedentePosition === aPositionMax && aPositionPeriode === 0) {
                lSensSlide = EGenreDirectionSlide.Droite;
            } else if (this.precedentePosition === 0 && aPositionPeriode > 1) {
                lSensSlide = EGenreDirectionSlide.Gauche;
            } else {
                lSensSlide = aPositionPeriode === this.precedentePosition ? EGenreDirectionSlide.Aucune : aPositionPeriode < this.precedentePosition ? EGenreDirectionSlide.Gauche : EGenreDirectionSlide.Droite;
            }
            this.precedentePosition = aPositionPeriode;
            this.Afficher(null, lSensSlide);
            this.donneesRecues = true;
        };
        ObjetReleveDeNotes.prototype.composeServices = function() {
            var lHtml = [];
            lHtml.push('<ul class="collection collection-thin with-header">');
            for (var I = 0; this.listeServices && (I < this.listeServices.GetNbrElements()); I++) {
                var lService = this.listeServices.GetElement(I),
                    lNbrSousServices = !!lService.ListeElements ? lService.ListeElements.GetNbrElements() : 0;
                if (lNbrSousServices === 0) {
                    var lDetailService = this.composeDetails(lService, false);
                    lHtml.push('<li class="collection-item">');
                    lHtml.push('<ul class="collapsible" data-collapsible="expandable">');
                    lHtml.push('<li', (lDetailService ? ' class="active"' : ''), '>');
                    lHtml.push('<div class="collapsible-header', (lDetailService ? '' : ' empty-body'), ' " style="' + (!lDetailService ? 'padding:0px; margin-left:20px;' : '') + '">' + '<div style="padding:0.2rem 0rem">' + '<div style="border-left: 5px solid ' + (!!lService.couleur && lService.couleur !== "" ? lService.couleur : "#D4D4D4") + '; padding-left: 0.4rem;">' + '<div style="' + (this.getLibelleProfesseur(lService) !== '' ? 'line-height:1.5rem;' : '') + ' font-weight:900;">' + this.getLibelleService(lService) + '</div>' + '<div style="line-height:1.5rem; font-weight:300;">' + this.getLibelleProfesseur(lService) + '</div>' + '</div>' + '</div>' + '</div>');
                    lHtml.push('<div class="collapsible-body">', (lDetailService || ''), '</div>');
                    lHtml.push('</li>');
                    lHtml.push('</ul>');
                    lHtml.push('</li>');
                } else {
                    lHtml.push('<li class="collection-item">');
                    lHtml.push('<ul class="collapsible" data-collapsible="expandable">');
                    lHtml.push('<li class="active">');
                    lHtml.push('<div class="collapsible-header">' + '<div style="padding:0.2rem 0rem">' + '<div style="border-left: 5px solid ' + (!!lService.couleur && lService.couleur !== "" ? lService.couleur : "#D4D4D4") + ';; padding-left: 0.4rem;">' + '<div style="' + (this.getLibelleProfesseur(lService) !== '' ? 'line-height:1.5rem;' : '') + ' font-weight:900;">' + this.getLibelleService(lService) + '</div>' + '<div style="line-height:1.5rem; font-weight:300;">' + this.getLibelleProfesseur(lService) + '</div>' + '</div>' + '</div>' + '</div>');
                    lHtml.push('<div class="collapsible-body" style="style="border: 1px solid #D1D1D1;"">');
                    if (this.Affichage.NombreAppreciations !== 0 && !this.Affichage.AvecAppreciationParSousService && lService.ListeAppreciations && lService.ListeAppreciations.GetLibelle(0) !== '') {
                        lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                            intituleDAppreciation: GTraductions.getValeur('Appreciation'),
                            contenuDAppreciation: lService.ListeAppreciations.GetLibelle(0),
                            styleBlockIntitule: 'color : #616161;',
                            styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                        }));
                    }
                    lHtml.push('<ul class="collection collection-thin with-header">');
                    for (var J = 0; J < lNbrSousServices; J++) {
                        var lSousService = lService.ListeElements.GetElement(J),
                            lDetailSousService = this.composeDetails(lSousService, true);
                        lHtml.push('<li class="collection-item">');
                        lHtml.push('<ul class="collapsible" data-collapsible="expandable" style="margin-left:19px;">');
                        lHtml.push('<li', (lDetailSousService ? ' class="active"' : ''), '>');
                        lHtml.push('<div class="collapsible-header', (lDetailSousService ? '' : ' empty-body'), '" style="' + (!lDetailSousService ? 'padding:0px;' : '') + '">' + '<div style="padding:0.2rem 0rem;">' + '<div style="border-left: 5px solid ' + (!!lService.couleur && lService.couleur !== "" ? lService.couleur : "#D4D4D4") + '; padding-left: 0.4rem;">', this.composeLibelleServiceEtProfesseur(lSousService), '</div>' + '</div>' + '</div>');
                        lHtml.push('<div class="collapsible-body" >', (lDetailSousService || ''), '</div>');
                        lHtml.push('</li>');
                        lHtml.push('</ul>');
                        lHtml.push('</li>');
                    }
                    lHtml.push('</ul>');
                    lHtml.push('</div>');
                    lHtml.push('</li>');
                    lHtml.push('</ul>');
                    lHtml.push('</li>');
                }
            }
            if (!!this.Affichage.AvecMoyenneGenerale) {
                if (!!this.Affichage.AvecMoyenneEleve && !!this.moyenneGenerale.MoyenneEleve && this.moyenneGenerale.MoyenneEleve.getNote() !== "" && !!this.Affichage.AvecMoyenneClasse && this.moyenneGenerale.MoyenneClasse && this.moyenneGenerale.MoyenneClasse.getNote() !== "") {
                    lHtml.push('<li class="collection-item raised">');
                    lHtml.push('<div class="Espace title">', GTraductions.getValeur('BulletinEtReleve.MoyGen'), '</div>');
                    lHtml.push('<div class="Espace">');
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('ReleveDeNotes.MoyEleve'), this.moyenneGenerale.MoyenneEleve.getNote()));
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Classe'), this.moyenneGenerale.MoyenneClasse.getNote()));
                    lHtml.push('</div>');
                    lHtml.push('</li>');
                } else {
                    if (!!this.Affichage.AvecMoyenneEleve && !!this.moyenneGenerale.MoyenneEleve && this.moyenneGenerale.MoyenneEleve.getNote() !== "") {
                        lHtml.push('<li class="collection-item raised">');
                        lHtml.push('<div class="left title">', GTraductions.getValeur('BulletinEtReleve.MoyGen'), '</div>');
                        lHtml.push('<div class="right title">');
                        lHtml.push(this.moyenneGenerale.MoyenneEleve.getNote());
                        lHtml.push('</div>');
                        lHtml.push('<div class="clear"></div>');
                        lHtml.push('</li>');
                    } else if (!!this.Affichage.AvecMoyenneClasse && this.moyenneGenerale.MoyenneClasse && this.moyenneGenerale.MoyenneClasse.getNote() !== "") {
                        lHtml.push('<li class="collection-item raised">');
                        lHtml.push('<div class="left title">', GTraductions.getValeur('BulletinEtReleve.MoyGen'), '</div>');
                        lHtml.push('<div class="right title">');
                        lHtml.push(this.moyenneGenerale.MoyenneClasse.getNote());
                        lHtml.push('</div>');
                        lHtml.push('<div class="clear"></div>');
                        lHtml.push('</li>');
                    }
                }
            }
            lHtml.push('</ul>');
            if (this.existeDonneesAbsence()) {
                lHtml.push('<div class="card" style="margin:0.5rem;">');
                lHtml.push('<div class="card-content">');
                lHtml.push('<div id="', this.Nom, '_vieScolaire" class="small">');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeVieScolaire(this.donneesAbsences));
                lHtml.push('</div>');
            }
            if (this.existeDonneesAppreciations()) {
                if (!this.existeDonneesAbsence()) {
                    lHtml.push('<div class="card" style="margin:0.5rem;">');
                    lHtml.push('<div class="card-content">');
                }
                lHtml.push('<div id="', this.Nom, '_appreciationGenerale" class="small">');
                var lIntitule = this.PiedDePage.ListeAppreciations.general.GetElement(0).Intitule;
                var lContenu = this.PiedDePage.ListeAppreciations.general.GetElement(0).ListeAppreciations.GetElement(0).GetLibelle();
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                    intituleDAppreciation: lIntitule,
                    contenuDAppreciation: lContenu,
                    styleBlockIntitule: 'color : #616161;',
                    styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                }));
                lHtml.push('</div>');
            }
            if (this.existeDonneesAbsence() || this.existeDonneesAppreciations()) {
                lHtml.push('</div>');
                lHtml.push('</div>');
            }
            return lHtml.join('');
        };
        ObjetReleveDeNotes.prototype.composeDetails = function(aService, aEstSousService) {
            var lHtml = [],
                J;
            var lNbrDevoirs = aService.ListeDevoirs.GetNbrElements();
            if (lNbrDevoirs !== 0) {
                lHtml.push('<div>');
                for (J = 0; J < lNbrDevoirs; J++) {
                    lHtml.push('<div style="' + (J < lNbrDevoirs - 1 ? 'border-bottom: 1px solid #C4C4C4;' : '') + ' padding-left:2.1rem;">', this.composeDevoir(aService.ListeDevoirs.GetElement(J)), '</div>');
                }
                lHtml.push('</div>');
            }
            var lExisteDetaille = false;
            if (this.Affichage.AvecMoyenneEleve && !!aService.MoyenneEleve && aService.MoyenneEleve.getNote() !== "") {
                lHtml.push('<div class="Espace">');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('ReleveDeNotes.MoyEleve'), aService.MoyenneEleve.getNote()));
                lExisteDetaille = true;
            }
            if (this.Affichage.AvecMoyenneClasse && !!aService.MoyenneClasse && aService.MoyenneClasse.getNote() !== "") {
                if (!lExisteDetaille) {
                    lHtml.push('<div class="Espace">');
                    lExisteDetaille = true;
                }
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Classe'), aService.MoyenneClasse.getNote()));
            }
            if (this.Affichage.AvecMoyenneInfSup) {
                if (!!aService.MoyenneInf && aService.MoyenneInf.getNote() !== "") {
                    if (!lExisteDetaille) {
                        lHtml.push('<div class="Espace">');
                        lExisteDetaille = true;
                    }
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.MoyInf'), aService.MoyenneInf.getNote()));
                }
                if (!!aService.MoyenneSup && aService.MoyenneSup.getNote() !== '') {
                    if (!lExisteDetaille) {
                        lHtml.push('<div class="Espace">');
                        lExisteDetaille = true;
                    }
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.MoySup'), aService.MoyenneSup.getNote()));
                }
            }
            if (lExisteDetaille) {
                lHtml.push('</div>');
            }
            if (aEstSousService && !!this.Affichage.AvecAppreciationParSousService && this.Affichage.NombreAppreciations !== 0 && aService.ListeAppreciations && aService.ListeAppreciations.GetLibelle(0) !== '') {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                    intituleDAppreciation: GTraductions.getValeur('Appreciation'),
                    contenuDAppreciation: aService.ListeAppreciations.GetLibelle(0),
                    styleBlockIntitule: 'color : #616161;',
                    styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                }));
            }
            if (!aEstSousService && this.Affichage.NombreAppreciations !== 0 && aService.ListeAppreciations && aService.ListeAppreciations.GetLibelle(0) !== '') {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                    intituleDAppreciation: GTraductions.getValeur('Appreciation'),
                    contenuDAppreciation: aService.ListeAppreciations.GetLibelle(0),
                    styleBlockIntitule: 'color : #616161;',
                    styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                }));
            }
            if (lHtml.length === 0) {
                return false;
            } else {
                return lHtml.join('');
            }
        };
        ObjetReleveDeNotes.prototype.composeDevoir = function(aDevoir) {
            var lEstBaremeParDefaut = !aDevoir.Bareme || !aDevoir.BaremeParDefaut || (aDevoir.Bareme.getValeur() === aDevoir.BaremeParDefaut.getValeur());
            var lHtml = [];
            lHtml.push('<div>');
            lHtml.push(aDevoir.Date ? '<span style="width:33.3%;display:inline-block;text-align:left">' + GDate.FormatDate(aDevoir.Date, '%JJ/%MM/%AA') + '</span>' : '');
            lHtml.push('<span style="width:33.3%;display:inline-block;text-align:center">');
            if (aDevoir.libelleCorrige) {
                var lDocumentJoint = new ObjetElement(aDevoir.libelleCorrige, aDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                lHtml.push(GChaine.composerUrlLienExterne({
                    libelle: aDevoir.libelleCorrige,
                    libelleEcran: aDevoir.Note.getNote(),
                    genreRessource: TypeFichierExterneHttpSco.DevoirCorrige,
                    documentJoint: lDocumentJoint
                }));
            } else {
                lHtml.push('<span class="Gras">', aDevoir.Note.getNote(), '</span>');
            }
            lHtml.push('<span>', lEstBaremeParDefaut ? '' : '&nbsp;/' + aDevoir.Bareme.getValeur(), '</span>');
            lHtml.push('</span>');
            lHtml.push('<span style="width:33.2%;display:inline-block;text-align:right">', !aDevoir.Coefficient || (aDevoir.Coefficient.getValeur() === 1) ? '&nbsp;' : '(x&nbsp;' + aDevoir.Coefficient + ')', '</span>');
            if (aDevoir.Commentaire) {
                lHtml.push('<br><span style="display:inline-block;text-align:left">', aDevoir.Commentaire, '</span>');
            }
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetReleveDeNotes.prototype.composeLibelleServiceEtProfesseur = function(aService) {
            var lHtml = [];
            var lLibelleProfesseur = this.getLibelleProfesseur(aService);
            var lLibelleService = this.getLibelleService(aService);
            if (lLibelleService !== '') {
                lHtml.push('<div>' + lLibelleService + '</div>');
            }
            if (lLibelleProfesseur !== '') {
                lHtml.push('<div style="font-weight:300;">' + lLibelleProfesseur + '</div>');
            }
            return lHtml.join('');
        };
        ObjetReleveDeNotes.prototype.getLibelleProfesseur = function(aService) {
            var lTableauProfesseurs = [],
                lNbProfesseur = !!aService.ListeProfesseurs ? aService.ListeProfesseurs.GetNbrElements() : 0;
            for (var J = 0; J < lNbProfesseur; J++) {
                lTableauProfesseurs.push(aService.ListeProfesseurs.GetLibelle(J));
            }
            return this.avecLibelleProfesseur(aService) ? lTableauProfesseurs.join(', ') + '' : '';
        };
        ObjetReleveDeNotes.prototype.getLibelleService = function(aService) {
            return !!aService.Matiere && !!aService.Matiere.GetLibelle() ? aService.Matiere.GetLibelle() : '';
        };
        ObjetReleveDeNotes.prototype.avecLibelleProfesseur = function(aService) {
            return (!!aService.ListeProfesseurs && !!aService.ListeProfesseurs.GetNbrElements());
        };
        ObjetReleveDeNotes.prototype.existeDonneesAbsence = function() {
            if ((!!this.donneesAbsences.strAbsences && this.donneesAbsences.strAbsences !== "") || (!!this.donneesAbsences.strPunitions && this.donneesAbsences.strPunitions !== "") || (!!this.donneesAbsences.strRetards && this.donneesAbsences.strRetards !== "") || (!!this.donneesAbsences.strSanctions && this.donneesAbsences.strSanctions !== "")) {
                return true;
            } else {
                return false;
            }
        };
        ObjetReleveDeNotes.prototype.existeDonneesAppreciations = function() {
            if (this.PiedDePage && this.PiedDePage.ListeAppreciations && this.PiedDePage.ListeAppreciations.general.GetElement(0).GetLibelle() !== "") {
                return true;
            } else {
                return false;
            }
        };
        ObjetReleveDeNotes.prototype.free = function() {
            this.inherited('free', arguments);
            if (this.identBtnFlottant) {
                $('#' + this.identBtnFlottant.GetNom().escapeJQ()).remove();
            }
        };
        module.exports = ObjetReleveDeNotes;
    },
    fn: "mobile/script/pagerelevedenotes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var _ObjetRequeteResultat = require('_ObjetRequeteResultat.js');
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var UtilitaireDeserialiserPiedBulletin = require('UtilitaireDeserialiserPiedBulletin.js');

        function ObjetRequetePageReleve() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageReleve', ObjetRequetePageReleve, _ObjetRequeteResultat);
        ObjetRequetePageReleve.prototype.lancerRequete = function(aParam) {
            var lParam = {
                numeroEleve: 0,
                numeroClasse: 0,
                genrePeriode: 0,
                numeroPeriode: 0
            };
            $.extend(lParam, aParam);
            this.JSON = {
                eleve: new ObjetElement('', lParam.numeroEleve),
                periode: new ObjetElement('', lParam.numeroPeriode, lParam.genrePeriode)
            };
            if (lParam.numeroClasse) {
                this.JSON.classe = new ObjetElement('', lParam.numeroClasse);
            }
            return this.appelAsynchrone();
        };
        ObjetRequetePageReleve.prototype.actionApresRequete = function() {
            var lParam = {
                aCopier: {},
                absences: {}
            };
            lParam.Message = this.JSONReponse.Message;
            if (!lParam.Message) {
                lParam.aCopier.classe = this.JSONReponse.Classe;
                lParam.aCopier.strInfoDatePublication = this.JSONReponse.strInfoDatePublication;
                var lExisteServiceAvecNotes = this.JSONReponse.existeServiceAvecNotes;
                var lExisteServiceSansNotes = this.JSONReponse.existeServiceSansNotes;
                lParam.aCopier.Affichage = this.JSONReponse.ParametresAffichages;
                lParam.aCopier.Affichage.existeServiceAvecNotes = lExisteServiceAvecNotes;
                lParam.aCopier.Affichage.existeServiceSansNotes = lExisteServiceSansNotes;
                lParam.aCopier.Affichage.pourClasseAvecNotes = lExisteServiceAvecNotes && !lExisteServiceSansNotes;
                lParam.aCopier.Affichage.pourClasseSansNotes = !lExisteServiceAvecNotes && lExisteServiceSansNotes;
                this.CreerListeServices(this.JSONReponse);
                lParam.aCopier.ServiceEditable = this.ServiceEditable;
                lParam.aCopier.ExisteDevoir = this.ExisteDevoir;
                lParam.aCopier.ExisteService = this.ExisteService;
                lParam.aCopier.NbrMaxServices = this.NbrMaxServices;
                lParam.aCopier.NbrMaxDevoirs = this.NbrMaxDevoirs;
                lParam.aCopier.tableauSurMatieres = this.tableauSurMatieres;
                lParam.aCopier.tableauDebutRegroupement = this.tableauDebutRegroupement;
                lParam.aCopier.ListeElements = this.ListeElements;
                lParam.aCopier.MoyenneGenerale = this.JSONReponse.General;
                $.extend(lParam.absences, new UtilitaireDeserialiserPiedBulletin().creerAbsences(this.JSONReponse));
                lParam.aCopier.PiedDePage = new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(this.JSONReponse);
            }
            this.callbackReussite.appel(lParam);
        };
        module.exports = ObjetRequetePageReleve;
    },
    fn: "objetrequetepagereleve.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetReleveDeNotes = require('mobile/script/PageReleveDeNotes.js');
        var ObjetRequetePageReleve = require('ObjetRequetePageReleve.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var GTraductions = require('ObjetTraduction.js');
        var EGenreMessage = require('Enumere_Message.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageReleveDeNotes, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageReleveDeNotes(aNom, aIdent, aPere, aEvenement) {
            this.inheritedCreate(arguments);
            this.listePeriodes = new ObjetListeElements();
            this.periodeCourant = new ObjetElement();
            this.indiceParDefaut = 0;
        }
        ObjetAffichagePageReleveDeNotes.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, this.evenementSelection);
            this.identPage = this.Add(ObjetReleveDeNotes);
            this.AddSurZone = [this.identSelection];
        };
        ObjetAffichagePageReleveDeNotes.prototype.DetruireInstances = function() {};
        ObjetAffichagePageReleveDeNotes.prototype.evenementSwipe = function(event) {
            if (event.type === 'swiperight') {
                this.GetInstance(this.identSelection).surPrecedent();
            } else {
                this.GetInstance(this.identSelection).surSuivant();
            }
        };
        ObjetAffichagePageReleveDeNotes.prototype.RecupererDonnees = function() {
            var lOngletInfosPeriodes = GEtatUtilisateur.getOngletInfosPeriodes();
            var lNrPeriodeParDefaut;
            if (!(lOngletInfosPeriodes.listePeriodes && lOngletInfosPeriodes.listePeriodes.GetNbrElements())) {
                var lGenreMessage = EGenreMessage.AucunRelevePourEleve;
                var lMessage = typeof(lGenreMessage) === 'number' ? GTraductions.getValeur('Message')[lGenreMessage] : lGenreMessage;
                GHtml.setHtml(this.Nom, this.composeAucuneDonnee(lMessage));
            } else {
                this.listePeriodes = lOngletInfosPeriodes.listePeriodes;
                if (GEtatUtilisateur.getPeriodePourReleve()) {
                    lNrPeriodeParDefaut = GEtatUtilisateur.getPeriodePourReleve();
                } else {
                    lNrPeriodeParDefaut = GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().periode ? GEtatUtilisateur.getPage().periode.GetNumero() : lOngletInfosPeriodes.periodeParDefaut.GetNumero();
                }
                this.indiceParDefaut = this.listePeriodes.GetIndiceParNumeroEtGenre(lNrPeriodeParDefaut);
                if (!this.indiceParDefaut) {
                    this.indiceParDefaut = 0;
                }
                this.periodeCourant = this.listePeriodes.GetElement(this.indiceParDefaut);
                this.GetInstance(this.identSelection).SetDonnees(this.listePeriodes, this.indiceParDefaut, this.GetInstance(this.identPage).GetNom(), '');
                $('#' + this.GetInstance(this.identPage).GetNom().escapeJQ()).css('min-height', ((parseInt($('#' + this.Nom.escapeJQ()).css('min-height')) - $('#' + this.GetInstance(this.identSelection).GetNom().escapeJQ()).height()) * 0.9) + 'px');
            }
            if (GEtatUtilisateur.getPeriodePourReleve()) {
                GEtatUtilisateur.setPeriodePourReleve(null);
            }
        };
        ObjetAffichagePageReleveDeNotes.prototype.RecupererDonneesReleve = function() {
            new ObjetRequetePageReleve(this, this.ActionSurRecupererReleve).lancerRequete({
                numeroEleve: GEtatUtilisateur.getMembre().GetNumero(),
                genrePeriode: this.periodeCourant.GetGenre(),
                numeroPeriode: this.periodeCourant.GetNumero()
            });
        };
        ObjetAffichagePageReleveDeNotes.prototype.ActionSurRecupererReleve = function(aParam) {
            $.extend(this, aParam.aCopier);
            this.donneesAbsences = aParam.absences;
            if (!!aParam.Message) {
                this.GetInstance(this.identPage).SetMessage(aParam.Message);
            } else if (!this.ExisteDevoir) {
                this.GetInstance(this.identPage).SetMessage(GTraductions.getValeur('Message')[9]);
            } else {
                this.GetInstance(this.identPage).SetDonnees(this.ListeElements, this.MoyenneGenerale, this.donneesAbsences, this.PiedDePage, this.Affichage, this.positionPeriodeCourant, this.listePeriodes.GetNbrElements() - 1, this.periodeCourant);
            }
        };
        ObjetAffichagePageReleveDeNotes.prototype.evenementSelection = function(aGenreEvenement, aParam) {
            this.periodeCourant = aParam.element;
            this.positionPeriodeCourant = this.listePeriodes.GetIndiceParElement(this.periodeCourant);
            this.RecupererDonneesReleve();
        };
        module.exports = ObjetAffichagePageReleveDeNotes;
    },
    fn: "interfacepagerelevedenotes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeOrigineCreationLabelAlimentaire = {
            OCLA_Utilisateur: 0,
            OCLA_Bio: 1,
            OCLA_FaitMaison: 2,
            OCLA_Assemble: 3,
            OCLA_Local: 4
        };
        module.exports.TypeOrigineCreationLabelAlimentaire = TypeOrigineCreationLabelAlimentaire;
    },
    fn: "typeoriginecreationlabelalimentaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('produit/css/general/Menu-cantine-mobile.css');
        var MethodesObjet = require('MethodesObjet.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreRepas = require('Enumere_Repas.js');
        var EGenreDirectionSlide = require('EGenreDirectionSlide.js');
        var TypeOrigineCreationLabelAlimentaire = require('TypeOrigineCreationLabelAlimentaire.js').TypeOrigineCreationLabelAlimentaire;
        MethodesObjet.heritagePrototype(ObjetMenus, ObjetIdentite_Mobile);

        function ObjetMenus() {
            this.inheritedCreate(arguments);
            this.idMenus = this.Nom + '_TableauMenu';
            this.avecMidi = false;
            this.avecSoir = false;
            this.donneesRecues = false;
            this.avecSlide = true;
            this.semainePrecedente = null;
            this.semaineCourante = null;
        }
        ObjetMenus.prototype.SetDonnees = function(aAvecMidi, aAvecSoir, aListeJours, aDateCourante) {
            this.semainePrecedente = this.semaineCourante;
            this.avecMidi = aAvecMidi;
            this.avecSoir = aAvecSoir;
            this.listeJours = aListeJours;
            this.semaineCourante = IE.Cycles.cycleDeLaDate(aDateCourante);
            this.donneesRecues = true;
            this.avecDonnees = false;
            for (var i = 0; i < this.listeJours.GetNbrElements() && !this.avecDonnees; i++) {
                var lJour = this.listeJours.GetElement(i);
                if (lJour.ListeRepas && lJour.ListeRepas.GetNbrElements() > 0) {
                    this.avecDonnees = true;
                }
            }
            this.Afficher(null, !this.semainePrecedente || this.semainePrecedente === this.semaineCourante ? EGenreDirectionSlide.Aucune : this.semainePrecedente > this.semaineCourante ? EGenreDirectionSlide.Droite : EGenreDirectionSlide.Gauche);
        };
        ObjetMenus.prototype.ConstruireAffichage = function() {
            if (!this.donneesRecues) {
                return '';
            }
            var lHtml = [],
                lActif = 0,
                lDateActif;
            if (IE.Cycles.cycleCourant() === this.semaineCourante) {
                if (GDate.getDateHeureCourante().getHours() > GDate.PlaceParJourEnDate(GParametres.PlaceDemiJournee)) {
                    lDateActif = GDate.GetJourSuivant(GDate.getDateCourante(), 1);
                } else {
                    lDateActif = GDate.getDateCourante();
                }
                this.listeJours.parcourir(function(ele, index) {
                    if (ele.Date >= lDateActif) {
                        lActif = index;
                        return false;
                    }
                });
            }
            if (this.listeJours.GetNbrElements() > 0) {
                lHtml.push('<ul class="collapsible" data-collapsible="expandable">');
                this.listeJours.parcourir(function(aJour, aIndexJour) {
                    if (aJour.ListeRepas && aJour.ListeRepas.GetNbrElements() > 0) {
                        lHtml.push('<li>', '<div class="collapsible-header', (lActif === aIndexJour ? ' active' : ''), '">', GDate.FormatDate(aJour.Date, '%JJJJ %JJ %MMMM %AAAA'), '</div>', '<div class="collapsible-body">', '<ul class="collection with-header">');
                        var lNbRepasDuJour = aJour.ListeRepas.GetNbrElements();
                        aJour.ListeRepas.parcourir(function(aRepas) {
                            var lLibelleRepas = '';
                            if (lNbRepasDuJour > 1) {
                                lLibelleRepas += (aRepas.GetGenre() === EGenreRepas.Soir ? GTraductions.getValeur('Menus.RepasSoir') : GTraductions.getValeur('Menus.RepasMidi'));
                            }
                            if (!!aRepas.GetLibelle()) {
                                if (lLibelleRepas.length > 0) {
                                    lLibelleRepas += ' : ';
                                }
                                lLibelleRepas += aRepas.GetLibelle();
                            }
                            if (lLibelleRepas.length > 0) {
                                lHtml.push('<li class="collection-header">', '<div style="text-align:center">', lLibelleRepas, '</div>', '</li>');
                            }
                            lHtml.push('<li class="collection-item menu-cantine">', _composeRepas(aRepas), '</li>');
                        });
                        lHtml.push('</ul>', '</div>', '</li>');
                    }
                });
                lHtml.push('</ul>');
            }
            if (!this.avecDonnees) {
                lHtml.push(this.composeAucuneDonnee(GTraductions.getValeur('mobile.aucunMenuSaisi')));
            }
            return lHtml.join('');
        };

        function _composePlat(aPlat) {
            var H = [];
            aPlat.ListeAliments.parcourir(function(aElement) {
                H.push('<span>' + aElement.GetLibelle());
                aElement.listeLabelsAlimentaires.parcourir(function(aElem) {
                    if (aElem.GetGenre() === TypeOrigineCreationLabelAlimentaire.OCLA_Utilisateur && !!aElem.icone) {
                        H.push('<img  class="label-alimentaire" src="data:image/png;base64,', aElem.icone, '" alt="" onerror="$(this).parent().remove();" title="', aElem.GetLibelle(), '"/>');
                    } else {
                        H.push('<i class="label-alimentaire icon ' + _getClassIcon(aElem.GetGenre()) + '" style="color:' + aElem.couleur + '" title="' + aElem.GetLibelle() + '"></i>');
                    }
                });
                H.push('</span>');
            });
            return H.join('');
        }

        function _composeRepas(aRepas) {
            var lHtml = [];
            if (!!aRepas && !!aRepas.ListePlats) {
                lHtml.push('<ul>');
                aRepas.ListePlats.parcourir(function(aPlat) {
                    lHtml.push('<li>' + _composePlat(aPlat) + '</li>');
                });
                lHtml.push('</ul>');
            }
            return lHtml.join('');
        }

        function _getClassIcon(aGenre) {
            var T = ['', ' icon_cantine_bio', ' icon_home', ' icon_cantine_assembler_place', ' icon_map_marker'];
            return T[aGenre];
        }
        module.exports = ObjetMenus;
    },
    fn: "pagemenus.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequetePageMenus() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageMenus', ObjetRequetePageMenus, ObjetRequeteConsultation);
        ObjetRequetePageMenus.prototype.lancerRequete = function(aDate) {
            this.JSON.date = aDate;
            return this.appelAsynchrone();
        };
        ObjetRequetePageMenus.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse.ListeJours, this.JSONReponse.DomaineDePresence, this.JSONReponse.AvecRepasMidi, this.JSONReponse.AvecRepasSoir);
        };
        module.exports = ObjetRequetePageMenus;
    },
    fn: "objetrequetepagemenus.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetCalendrierMobilePN = require('ObjetCalendrierPN.js');
        var ObjetMenus = require('PageMenus.js');
        var ObjetRequetePageMenus = require('ObjetRequetePageMenus.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageMenus_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageMenus_Mobile() {
            this.inheritedCreate(arguments);
        }
        ObjetAffichagePageMenus_Mobile.prototype.ConstruireInstances = function() {
            this.identCalendrier = this.Add(ObjetCalendrierMobilePN, this.evenementCalendrier, this.initialiserCalendrier);
            this.identPage = this.Add(ObjetMenus);
            this.AddSurZone = [this.identCalendrier];
            this.dateCourant = null;
        };
        ObjetAffichagePageMenus_Mobile.prototype.DetruireInstances = function() {};
        ObjetAffichagePageMenus_Mobile.prototype.evenementSwipe = function(event) {
            this.GetInstance(this.identCalendrier).incrementerJour(event.type === 'swiperight');
        };
        ObjetAffichagePageMenus_Mobile.prototype.RecupererDonnees = function() {
            this.dateCourant = GEtatUtilisateur.getDerniereDate();
            this.GetInstance(this.identCalendrier).SetDonnees(null, null, this.dateCourant);
        };
        ObjetAffichagePageMenus_Mobile.prototype.initialiserCalendrier = function(aInstance) {
            aInstance.estCalendrierAnnuel = true;
            aInstance.SetParametres({
                selectionPeriode: true
            });
            aInstance.setInstanceCycles(IE.Cycles);
        };
        ObjetAffichagePageMenus_Mobile.prototype.evenementCalendrier = function(aSelection) {
            this.dateCourant = aSelection;
            new ObjetRequetePageMenus(this, this.actionSurCalendrier).lancerRequete(IE.Cycles.dateDebutCycle(IE.Cycles.cycleDeLaDate(aSelection)));
        };
        ObjetAffichagePageMenus_Mobile.prototype.actionSurCalendrier = function(aListeJours, aDomainePresence, aAvecRepasMidi, aAvecRepasSoir) {
            this.GetInstance(this.identPage).SetDonnees(aAvecRepasMidi, aAvecRepasSoir, aListeJours, this.dateCourant);
        };
        module.exports = ObjetAffichagePageMenus_Mobile;
    },
    fn: "interfacepagemenus_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreExerciceDeQuestionnaire = {
            GEQ_Inconnu: 0,
            GEQ_SingleChoice: 1,
            GEQ_MultiChoice: 2,
            GEQ_TrueFalse: 3,
            GEQ_NumericalAnswer: 4,
            GEQ_ShortAnswer: 5,
            GEQ_SpellAnswer: 6,
            GEQ_Matching: 7,
            GEQ_ClozeField: 8,
            GEQ_ClozeFixed: 9,
            GEQ_ClozeVariable: 10,
            GEQ_Essay: 11
        };
        module.exports.TypeGenreExerciceDeQuestionnaire = TypeGenreExerciceDeQuestionnaire;
    },
    fn: "typegenreexercicedequestionnaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeQualificatifReponse = {
            qrBonne: 0,
            qrBonnePartielle: 1,
            qrFausse: 2,
            qrSansReponse: 3
        };
        module.exports.TypeQualificatifReponse = TypeQualificatifReponse;
    },
    fn: "typequalificatifreponse.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var TypeGenreExerciceDeQuestionnaire = require('TypeGenreExerciceDeQuestionnaire.js').TypeGenreExerciceDeQuestionnaire;
        var TypeModeCorrectionQCM = require('TypeModeCorrectionQCM.js').TypeModeCorrectionQCM;
        var TypeQualificatifReponse = require('TypeQualificatifReponse.js').TypeQualificatifReponse;
        var TUtilitaireDuree = require('UtilitaireDuree.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var ObjetListeElements = require('ObjetListeElements.js');
        require('Espace/Css/ObjetVisuEleveQCM.css');
        require('jIECheckbox.js');

        function ObjetVisuEleve(aNom, aIdent, aPere, aEvenement) {
            this.Nom = aNom;
            this.Pere = aPere;
            this.Evenement = aEvenement;
            this.modeProf = false;
            this.modeVisuQuestion = false;
            this.idContenu = null;
            this.numeroExecution = null;
            this.executionQCM = null;
            this.indiceQuestion = -1;
            this.listeQuestions = null;
            this.question = null;
            this.nbQuestions = null;
            this.typeNumerotation = null;
            this.etatCloture = null;
            this.start = null;
            this.affichageEnLigne = null;
            this.affichageUnePage = null;
            this.intervalChrono = null;
            this.evaluationNote = [];
            this.enActualisation = false;
            this.avecIECheckbox = true;
            this.idWrapperGlobal = this.Nom + '_WrapperGlobal';
            this.idWrapperAffichage = this.Nom + '_WrapperAffichage_';
            this.idValeurChrono = this.Nom + '_ValeurChrono';
            this.idWrapperBarreProgression = this.Nom + '_WrapperBarreProg';
            this.idRessenti = this.Nom + '_Ressenti';
            this.idTexteRessenti = this.Nom + '_TexteRessenti';
            this.idNbPoint = this.Nom + '_NbPoint_';
            this.idSlashNbPoint = this.Nom + '_SlashNbPoint_';
            this.idMp3Question = this.Nom + '_mp3question_';
            this.idMp3Control = this.Nom + '_control_mp3question_';
            this.idBoutonNext = this.Nom + '_boutonNext_';
            this.idBoutonSubmit = this.Nom + '_boutonSubmit_';
            this.idCartoucheCompetences = this.Nom + '_cartoucheCompetences';
            this.couleurNonVu = 'White';
            this.couleurNonRepondu = 'LightGray';
            this.couleurValidee = 'Gray ';
            this.couleurFaux = '#ec636a';
            this.couleurPartiel = 'Orange';
            this.couleurVrai = '#9fd647';
            this.couleurThemeQCM = '#62acc5';
        }
        ObjetVisuEleve.prototype.setParametres = function(aObjet) {
            this.idContenu = aObjet.idContenu;
            this.numeroExecution = aObjet.numeroExecution;
            this.modeProf = aObjet.modeProf;
            this.modeVisuQuestion = false;
            this.executionQCM = null;
            this.indiceQuestion = -1;
            this.listeQuestions = null;
            this.question = null;
            this.nbQuestions = null;
            this.typeNumerotation = null;
            this.etatCloture = null;
            this.start = null;
            this.affichageEnLigne = null;
            this.affichageUnePage = null;
            clearInterval(this.intervalChrono);
            this.intervalChrono = null;
            this.evaluationNote = [];
            this.enActualisation = false;
        };
        ObjetVisuEleve.prototype.actualiser = function() {
            var lThis;
            if (this.etatCloture && $.inArray(this.etatCloture, [TypeEtatExecutionQCMPourRepondant.EQR_EnCours, TypeEtatExecutionQCMPourRepondant.EQR_ARefaire]) === -1 && this.indiceQuestion > -1) {
                if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin || this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion || ((this.executionQCM.estLieADevoir || this.executionQCM.estLieAEvaluation) && this.executionQCM.publierCorrige)) {
                    this.composeCorrigeFin();
                    this.indiceQuestion = this.nbQuestions + Number(this.executionQCM.ressentiRepondant) + 1;
                } else if (!this.executionQCM.estLieADevoir && !this.executionQCM.estLieAEvaluation) {
                    this.composeCorrigeFin(true);
                } else {
                    this.composeCloture();
                }
                this.formaterLien();
                this.triggerFinActualisation();
                return;
            }
            if (!this.affichageEnLigne || $('#' + this.idWrapperAffichage.escapeJQ() + this.indiceQuestion).length === 0) {
                if ($('#' + this.idWrapperGlobal.escapeJQ()).length === 0) {
                    this.affichageEnLigne = null;
                }
                var lHtml = [];
                if (!this.affichageEnLigne) {
                    lHtml.push(this.composeOuvertureDivGlobal());
                }
                if (this.executionQCM && !this.executionQCM.message && this.estEnInitialisation() && !this.estEnCloture()) {
                    lHtml = lHtml.concat(this.composePageModalite());
                } else if (this.executionQCM && !this.executionQCM.message && this.estEnInitialisation() && this.estEnCloture()) {
                    if (this.executionQCM.estDemarre) {
                        lHtml = lHtml.concat(this.composePagePresCorrige());
                    } else {
                        lHtml = lHtml.concat(this.composePageNonDemarre());
                    }
                } else if (this.executionQCM && this.estEnCours() && this.question) {
                    this.evaluationNote[this.indiceQuestion] = {
                        validee: false
                    };
                    lHtml = lHtml.concat(this.composeAffichageQuestion());
                } else if (this.executionQCM && this.executionQCM.message) {
                    lHtml.push('<div class="InlineBlock" style="height:100%;vertical-align:middle;"></div><h1 class="InlineBlock" style="vertical-align:middle;text-align:center;font-size:25px;width:99%;border-bottom:', GCouleur.fond, ' 1px solid;margin:10px auto 100px;">' + this.executionQCM.message + '</h1>');
                } else if (this.executionQCM && this.estEnRessenti()) {
                    lHtml = lHtml.concat(this.composeAffichageRessenti());
                } else if (this.executionQCM && this.indiceQuestion >= this.nbQuestions) {
                    lHtml = lHtml.concat(this.composeAffichageFin());
                    this.interdireFermetureInterface();
                }
                if (!this.affichageEnLigne) {
                    lHtml.push(this.composeFermetureDivGlobal());
                }
                var lAsymetrie = false;
                if (this.question && this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                    var lReponses = [];
                    var i, lNbr, lReponse;
                    for (i = 0, lNbr = this.question.listeReponses.GetNbrElements(); i < lNbr; i++) {
                        lReponse = this.question.listeReponses.GetElement(i);
                        if ($.inArray(lReponse.association, lReponses) === -1) {
                            lReponses.push(lReponse.association);
                        } else {
                            lAsymetrie = true;
                            break;
                        }
                    }
                }
                if (!this.affichageEnLigne) {
                    $('#' + this.idContenu).IEHtml(lHtml.join(''));
                    if (this.executionQCM.autoriserLaNavigation) {
                        this.ajouterEvenementBarreProgression();
                    }
                    if (this.avecIECheckbox) {
                        $('#' + this.idContenu).find(':checkbox, :radio').jIECheckBox();
                    }
                    this.actualiserHauteurCartoucheCompetences();
                    this.ajouterEvenementQuestion(lAsymetrie);
                    if (this.question && this.question.reponsesRepondant) {
                        this.triggerFinActualisation();
                        this.majReponsesRepondant();
                        this.formaterLien();
                        this.triggerFinActualisation();
                        if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                            this.composeCorrige();
                        }
                    }
                    lThis = this;
                    $('[id^="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_div_r"]').each(function() {
                        lThis.actualiserHauteurReponse(this.id);
                    });
                    var lJqImg = $('#' + this.idWrapperAffichage.escapeJQ() + this.indiceQuestion).find('img');
                    if (lJqImg.length) {
                        lJqImg.on('load', this.actualiserHauteurQuestion.bind(this, this.indiceQuestion));
                    } else {
                        this.actualiserHauteurQuestion();
                    }
                    this.majChrono();
                    $('#' + this.idWrapperAffichage.escapeJQ() + this.indiceQuestion).find('div[id^="' + this.idMp3Control.escapeJQ() + '"]').on('click', {
                        lThis: this
                    }, this.playMp3);
                    $('#' + this.idWrapperAffichage.escapeJQ() + this.indiceQuestion).find('audio[id^="' + this.idMp3Question.escapeJQ() + '"]').on('ended', function() {
                        $('#' + this.id.replace('_mp3question_', '_control_mp3question_').escapeJQ()).trigger('click');
                    });
                    this.formaterLien();
                    this.triggerFinActualisation();
                    this.enActualisation = false;
                } else {
                    lThis = this;
                    $('#' + this.idWrapperGlobal.escapeJQ()).find('[id^="' + this.idWrapperAffichage.escapeJQ() + '"]:visible').fadeOut(200, function() {
                        $('#' + lThis.idWrapperGlobal.escapeJQ()).append(lHtml.join(''));
                        if (lThis.avecIECheckbox) {
                            $('#' + lThis.idWrapperGlobal.escapeJQ()).find(':checkbox, :radio').jIECheckBox();
                        }
                        lThis.ajouterEvenementQuestion(lAsymetrie);
                        if (lThis.question && lThis.question.reponsesRepondant) {
                            lThis.triggerFinActualisation();
                            lThis.majReponsesRepondant();
                            lThis.formaterLien();
                            lThis.triggerFinActualisation();
                            if (lThis.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                                lThis.composeCorrige();
                            }
                        }
                        $('#' + lThis.idWrapperAffichage.escapeJQ() + lThis.indiceQuestion).hide().fadeIn(200);
                        lThis.composeBarreProgression();
                        $('[id^="' + lThis.Nom.escapeJQ() + '_q' + lThis.indiceQuestion + '_div_r"]').each(function() {
                            lThis.actualiserHauteurReponse(this.id);
                        });
                        var lJqImg = $('#' + lThis.idWrapperAffichage.escapeJQ() + lThis.indiceQuestion).find('img');
                        if (lJqImg.length) {
                            lJqImg.on('load', lThis.actualiserHauteurQuestion.bind(lThis, lThis.indiceQuestion));
                        } else {
                            lThis.actualiserHauteurQuestion();
                        }
                        $('#' + lThis.idWrapperAffichage.escapeJQ() + lThis.indiceQuestion).find('div[id^="' + lThis.idMp3Control.escapeJQ() + '"]').on('click', {
                            lThis: lThis
                        }, lThis.playMp3);
                        $('#' + lThis.idWrapperAffichage.escapeJQ() + lThis.indiceQuestion).find('audio[id^="' + lThis.idMp3Question.escapeJQ() + '"]').on('ended', function() {
                            $('#' + this.id.replace('_mp3question_', '_control_mp3question_').escapeJQ()).trigger('click');
                        });
                        lThis.formaterLien();
                        lThis.triggerFinActualisation();
                        lThis.enActualisation = false;
                        if (lThis.estEnCours() && lThis.executionQCM.dureeMaxQCM) {
                            lThis.majChrono();
                        }
                    });
                }
                if (this.affichageEnLigne === null) {
                    this.affichageEnLigne = this.executionQCM && this.executionQCM.autoriserLaNavigation && !this.executionQCM.message;
                }
            } else {
                lThis = this;
                $('#' + this.idWrapperGlobal.escapeJQ()).find('[id^="' + this.idWrapperAffichage.escapeJQ() + '"]:visible').fadeOut(100, function() {
                    $('#' + lThis.idWrapperAffichage.escapeJQ() + lThis.indiceQuestion).fadeIn(100);
                    lThis.composeBarreProgression();
                    lThis.actualiserHauteurQuestion();
                    lThis.formaterLien();
                    lThis.triggerFinActualisation();
                    lThis.enActualisation = false;
                });
            }
            if (this.estEnCours() && this.executionQCM.dureeMaxQCM) {
                this.majChrono();
                if (!this.intervalChrono) {
                    this.intervalChrono = setInterval(this.majChrono.bind(this), 5000);
                }
            } else if (this.intervalChrono && !this.estEnCours()) {
                clearInterval(this.intervalChrono);
            }
        };
        ObjetVisuEleve.prototype.playMp3 = function(aEvent) {
            aEvent.stopImmediatePropagation();
            if (!$(this).data('play')) {
                $('#' + this.id.replace(/_control/, '').escapeJQ()).get(0).play();
                $(this).children('span').removeClass('Image_QCM_Son_Play').addClass('Image_QCM_Son_Pause');
                $(this).data('play', true);
            } else {
                $('#' + this.id.replace(/_control/, '').escapeJQ()).get(0).pause();
                $(this).children('span').removeClass('Image_QCM_Son_Pause').addClass('Image_QCM_Son_Play');
                $(this).data('play', false);
            }
        };
        ObjetVisuEleve.prototype._estUnIDevoir = function(aExecutionQCM) {
            return (aExecutionQCM.estLieADevoir || aExecutionQCM.estLieAEvaluation);
        };
        ObjetVisuEleve.prototype._getTitreExecutionQCM = function(aExecutionQCM) {
            var lTitre = '';
            if (!!aExecutionQCM) {
                if (this._estUnIDevoir(aExecutionQCM)) {
                    lTitre = GTraductions.getValeur('ExecutionQCM.typesQCM.IDevoir');
                } else if (aExecutionQCM.estUnTAF) {
                    lTitre = GTraductions.getValeur('ExecutionQCM.typesQCM.QCMDeTaf');
                } else {
                    lTitre = GTraductions.getValeur('ExecutionQCM.typesQCM.QCMDeContenu');
                }
            }
            return lTitre;
        };
        ObjetVisuEleve.prototype._getNomImageTypeExecutionQCM = function(aExecutionQCM) {
            var lNomImage;
            if (!!aExecutionQCM) {
                if (aExecutionQCM.estLieADevoir && aExecutionQCM.estLieAEvaluation) {
                    lNomImage = 'Image_QCM_evaluation_note';
                } else if (aExecutionQCM.estLieADevoir) {
                    lNomImage = 'Image_QCM_associe_devoir';
                } else if (aExecutionQCM.estLieAEvaluation) {
                    lNomImage = 'Image_QCM_evaluation';
                } else if (aExecutionQCM.estUnTAF) {
                    lNomImage = 'Image_QCM_entrainement';
                } else {
                    lNomImage = 'Image_QCM_revision';
                }
            }
            return lNomImage;
        };
        ObjetVisuEleve.prototype.triggerFinActualisation = function() {};
        ObjetVisuEleve.prototype.composeOuvertureDivGlobal = function() {
            return '';
        };
        ObjetVisuEleve.prototype.composeFermetureDivGlobal = function() {
            return '';
        };
        ObjetVisuEleve.prototype.composeTitre = function() {
            return '';
        };
        ObjetVisuEleve.prototype.composeAffichageQuestion = function() {
            return [];
        };
        ObjetVisuEleve.prototype.ajouterEvenementQuestion = function(aAsymetrie) {
            if (this.executionQCM && this.estEnCours() && this.question && this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                this.ajouterEvenementMatching(this.indiceQuestion, aAsymetrie);
            } else if (this.executionQCM && this.estEnCours() && this.question && (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice)) {
                this.ajouterEvenementSingleMultiChoice(this.indiceQuestion);
            } else if (this.executionQCM && this.estEnRessenti()) {
                this.ajouterEvenementRessenti();
            }
        };
        ObjetVisuEleve.prototype.ajouterEvenementMatching = function() {};
        ObjetVisuEleve.prototype.ajouterEvenementSingleMultiChoice = function() {};
        ObjetVisuEleve.prototype.composeAffichageRessenti = function() {
            return [];
        };
        ObjetVisuEleve.prototype.ajouterEvenementRessentiEtoile = function() {
            $('span[id^="' + this.idRessenti.escapeJQ() + '"]').on('mouseenter', {
                aObjet: this
            }, function(aEvent) {
                var lThis = aEvent.data.aObjet;
                var lRessentiTmp = this.id.match(/_([0-9]+)/i)[1];
                $(this).prevAll().addBack().removeClass('Image_QCM_Etoile_Off').addClass('Image_QCM_Etoile_On').end().end().nextAll().removeClass('Image_QCM_Etoile_On').addClass('Image_QCM_Etoile_Off');
                $('span#' + lThis.idTexteRessenti.escapeJQ()).text(GTraductions.getValeur('ExecutionQCM.valeurRessenti')[lRessentiTmp - 1]);
            }).on('mouseleave', {
                aObjet: this
            }, function(aEvent) {
                var lThis = aEvent.data.aObjet;
                $(this).siblings().addBack().removeClass('Image_QCM_Etoile_On').addClass('Image_QCM_Etoile_Off');
                $('span#' + lThis.idTexteRessenti.escapeJQ()).text('');
                if (lThis.ressenti > 0) {
                    $('span#' + lThis.idRessenti.escapeJQ() + '_' + lThis.ressenti).prevAll().addBack().removeClass('Image_QCM_Etoile_Off').addClass('Image_QCM_Etoile_On');
                    $('span#' + lThis.idTexteRessenti.escapeJQ()).text(GTraductions.getValeur('ExecutionQCM.valeurRessenti')[lThis.ressenti - 1]);
                }
            }).on('click', {
                aObjet: this
            }, function(aEvent) {
                var lThis = aEvent.data.aObjet;
                var lRessenti = this.id.match(/_([0-9]+)/i)[1];
                lThis.ressenti = parseInt(lRessenti);
                $('#' + lThis.idBoutonSubmit.escapeJQ() + lThis.indiceQuestion).show();
            });
        };
        ObjetVisuEleve.prototype.ajouterEvenementRessenti = function() {
            $('span[id^="' + this.idRessenti.escapeJQ() + '"]').on('mouseenter', {
                aObjet: this
            }, function() {
                $(this).css({
                    color: GCouleur.noir
                }).siblings('span').css({
                    color: GCouleur.grisClair
                });
            }).on('mouseleave', {
                aObjet: this
            }, function(aEvent) {
                var lThis = aEvent.data.aObjet;
                $(this).siblings('span').addBack().css({
                    color: GCouleur.grisClair
                });
                if (lThis.ressentiSelectionne) {
                    $('span#' + lThis.idRessenti.escapeJQ() + '_' + lThis.ressenti).css({
                        color: GCouleur.noir
                    });
                }
            }).on('click', {
                aObjet: this
            }, function(aEvent) {
                var lThis = aEvent.data.aObjet;
                lThis.ressentiSelectionne = true;
                var lRessenti = this.id.match(/_([0-9]+)/i)[1];
                lThis.ressenti = parseInt(lRessenti);
                $('#' + lThis.idBoutonSubmit.escapeJQ() + lThis.nbQuestions).show();
            });
        };
        ObjetVisuEleve.prototype.composeAffichageFin = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composePageNonDemarre = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composeCloture = function() {
            return [];
        };
        ObjetVisuEleve.prototype.formaterLien = function() {
            $('#' + this.idContenu).find('a[href]').each(function() {
                var lUrl = $(this).attr('href');
                if (lUrl.search(/^(ht|f)tp/gi) !== 0) {
                    lUrl = 'http://' + lUrl;
                    $(this).prop('href', lUrl);
                }
            });
        };
        ObjetVisuEleve.prototype.composeCorrigeFin = function(aSansCorrige) {
            this.affichageUnePage = true;
            $('#' + this.idContenu).IEHtml('');
            var lHtml = [];
            lHtml = lHtml.concat(this.composeAffichageCorrigeFin());
            $('#' + this.idContenu).IEHtml(lHtml.join(''));
            if (this.avecIECheckbox) {
                $('#' + this.idContenu).find(':checkbox, :radio').jIECheckBox();
            }
            this.formaterLien();
            this.triggerFinActualisation();
            this.nbImages = $('#' + this.idContenu).find('img').length;
            var lThis = this;
            $('[id^="' + this.idWrapperAffichage + '"]').each(function() {
                var lJqImg = $(this).find('img');
                if (lJqImg.length) {
                    var lId = parseInt(this.id.slice(lThis.idWrapperAffichage.length));
                    lJqImg.on('load', lThis.actualiserHauteurQuestion.bind(lThis, lId));
                }
            });
            var lBackupIndice = this.indiceQuestion;
            var aIndice, aNbr;
            aNbr = this.listeQuestions ? this.listeQuestions.GetNbrElements() : 0;
            for (aIndice = 0; aIndice < aNbr; aIndice++) {
                this.indiceQuestion = aIndice;
                this.question = this.listeQuestions.GetElement(aIndice);
                var lAsymetrie = false;
                if (this.question && this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                    var lReponses = [];
                    var i, lNbr, lReponse;
                    for (i = 0, lNbr = this.question.listeReponses.GetNbrElements(); i < lNbr; i++) {
                        lReponse = this.question.listeReponses.GetElement(i);
                        if ($.inArray(lReponse.association, lReponses) === -1) {
                            lReponses.push(lReponse.association);
                        } else {
                            lAsymetrie = true;
                            break;
                        }
                    }
                }
                this.ajouterEvenementQuestion(lAsymetrie);
                this.majReponsesRepondant();
                if (!aSansCorrige) {
                    this.composeCorrige();
                } else {
                    this.desactiveEvent();
                    $('#' + this.idBoutonNext.escapeJQ() + this.indiceQuestion).show();
                }
            }
            this.indiceQuestion = lBackupIndice;
            $('[id^="' + this.idWrapperAffichage + '"]').find('div[id^="' + this.idMp3Control.escapeJQ() + '"]').on('click', {
                lThis: this
            }, this.playMp3);
            $('[id^="' + this.idWrapperAffichage + '"]').find('audio[id^="' + this.idMp3Question.escapeJQ() + '"]').on('ended', function() {
                $('#' + this.id.replace('_mp3question_', '_control_mp3question_').escapeJQ()).trigger('click');
            });
            this.actualiserHauteurCorrige();
            this.enActualisation = false;
            this.autoriserFermetureInterface();
        };
        ObjetVisuEleve.prototype.autoriserFermetureInterface = function() {};
        ObjetVisuEleve.prototype.interdireFermetureInterface = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeFin = function() {
            return [];
        };
        ObjetVisuEleve.prototype.actualiserHauteurCartoucheCompetences = function() {};
        ObjetVisuEleve.prototype.actualiserHauteurCorrige = function() {};
        ObjetVisuEleve.prototype.actualiserHauteurQuestion = function() {};
        ObjetVisuEleve.prototype.actualiserHauteurReponse = function() {};
        ObjetVisuEleve.prototype.composePageModalite = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composePagePresCorrige = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composeChrono = function() {
            return [];
        };
        ObjetVisuEleve.prototype.majChrono = function() {
            if ($('#' + this.idValeurChrono.escapeJQ()).length === 0 && this.intervalChrono) {
                clearInterval(this.intervalChrono);
                return;
            }
            if (!this.executionQCM.dureeMaxQCM) {
                return;
            }
            var lMinRestantes = this.getMinutesChrono(),
                lTextTime = lMinRestantes,
                lLibelleTime = GTraductions.getValeur('ExecutionQCM.MinutesCourt');
            if (lMinRestantes < 1) {
                lTextTime = '&lt; 1';
                if (this.getMilliSecondesChrono() / 1000 <= 30) {
                    lTextTime = '&lt; 30';
                    lLibelleTime = GTraductions.getValeur('ExecutionQCM.SecondesCourt');
                }
            }
            this.composeMajChrono(lTextTime, lLibelleTime);
        };
        ObjetVisuEleve.prototype.composeMajChrono = function() {};
        ObjetVisuEleve.prototype.getMinutesChrono = function() {
            var lSecRestantes = this.getMilliSecondesChrono(),
                lTpsRestant = new Date(lSecRestantes > 0 ? lSecRestantes : 0),
                lMinutes = lTpsRestant.getUTCHours() * 60 + lTpsRestant.getUTCMinutes();
            return lMinutes;
        };
        ObjetVisuEleve.prototype.getMilliSecondesChrono = function() {
            var lSecRestantes = new Date(0).setUTCMinutes(TUtilitaireDuree.dureeEnMin(this.executionQCM.dureeMaxQCM)) - (new Date().getTime() - this.start);
            return lSecRestantes;
        };
        ObjetVisuEleve.prototype.composeBarreProgression = function() {
            var lHtml = [];
            lHtml = lHtml.concat(this.composeAffichageBarreProgression());
            if (this.affichageEnLigne) {
                $('#' + this.idWrapperBarreProgression.escapeJQ()).IEHtml(lHtml.join(''));
                this.composeMiseEnFormeBarreProgression();
            }
            return lHtml;
        };
        ObjetVisuEleve.prototype.composeAffichageBarreProgression = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composeMiseEnFormeBarreProgression = function() {};
        ObjetVisuEleve.prototype.getCouleurPointProgression = function(aIndice) {
            var lBackColor = this.couleurNonVu;
            if (this.evaluationNote[aIndice]) {
                if (this.evaluationNote[aIndice].nbBonnesReponses && this.evaluationNote[aIndice].nbReponsesJustes >= 0) {
                    if (this.evaluationNote[aIndice].nbReponsesJustes === 0) {
                        lBackColor = this.couleurFaux;
                    } else if (this.evaluationNote[aIndice].nbReponsesJustes === this.evaluationNote[aIndice].nbBonnesReponses) {
                        lBackColor = this.couleurVrai;
                    } else if (this.evaluationNote[aIndice].nbReponsesJustes < this.evaluationNote[aIndice].nbBonnesReponses) {
                        lBackColor = this.couleurPartiel;
                    }
                } else if (this.evaluationNote[aIndice].validee) {
                    lBackColor = this.couleurValidee;
                } else {
                    lBackColor = this.couleurNonRepondu;
                }
            }
            return lBackColor;
        };
        ObjetVisuEleve.prototype.ajouterEvenementBarreProgression = function() {};
        ObjetVisuEleve.prototype.composeRessentiEtoile = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composeRessenti = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composeNavigation = function() {
            return [];
        };
        ObjetVisuEleve.prototype.composeCorrige = function() {
            if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice) {
                this.composeCorrigeSingleMulti();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer) {
                this.composeCorrigeNumerique();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer) {
                this.composeCorrigeShort();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer) {
                this.composeCorrigeSpell();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                this.composeCorrigeMatching();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable) {
                this.composeCorrigeCloze();
            }
            var lSpanBonneReponse = '';
            var lEstUneBonneReponse = (!!this.question.noteEleve && this.question.qualif === TypeQualificatifReponse.qrBonne) || (this.evaluationNote[this.indiceQuestion].nbBonnesReponses === this.evaluationNote[this.indiceQuestion].nbReponsesJustes);
            if (lEstUneBonneReponse) {
                lSpanBonneReponse = '<span style="margin-right: 20px; color: ' + this.couleurVrai + ';">' + GTraductions.getValeur('ExecutionQCM.BonneReponse') + '</span>';
            }
            var lCouleurValeurReponse = (lEstUneBonneReponse ? this.couleurVrai : (this.question.qualif === TypeQualificatifReponse.qrBonnePartielle ? this.couleurPartiel : this.couleurFaux));
            var lSpanValeurReponse = '';
            if (!!this.question.noteEleve) {
                if (this.executionQCM.estLieADevoir || (this.executionQCM.estUnTAF && !!this.executionQCM.afficherResultatNote)) {
                    lSpanValeurReponse = '<span style="color: ' + lCouleurValeurReponse + ';">' + this.question.noteEleve.toString() + '</span>';
                    $('#' + this.idSlashNbPoint.escapeJQ() + this.indiceQuestion).show();
                } else {
                    lSpanValeurReponse = '<span class="InlineBlock" style="width: 15px; height: 15px; vertical-align: middle; background-color: ' + lCouleurValeurReponse + ';">&nbsp;</span>';
                }
            }
            if (lSpanBonneReponse || lSpanValeurReponse) {
                $('#' + this.idNbPoint.escapeJQ() + this.indiceQuestion).IEHtml(lSpanBonneReponse + lSpanValeurReponse).show();
            }
            this.formaterLien();
            this.triggerFinActualisation();
            this.actualiserHauteurQuestion();
            $('#' + this.idBoutonNext.escapeJQ() + this.indiceQuestion).show();
            $('#' + this.idBoutonSubmit.escapeJQ() + this.indiceQuestion).hide();
        };
        ObjetVisuEleve.prototype.composeCorrigeSingleMulti = function() {
            var lEvaluationNotePourQuestion = {
                nbBonnesReponses: this.question.listeReponses.getListeElements(function(aEle) {
                    return aEle.bonneReponse;
                }).GetNbrElements(),
                nbReponsesJustes: 0
            };
            var lThis = this,
                lForcerFaux = false;
            $('[id^="' + this.Nom + '_q' + this.indiceQuestion + '_r"]:checked').each(function() {
                var lIndice = this.id.match(/_r([0-9]+)$/i)[1];
                var lReponse = lThis.question.listeReponses.GetElement(lIndice);
                if (lReponse.bonneReponse) {
                    lEvaluationNotePourQuestion.nbReponsesJustes += 1;
                } else {
                    lForcerFaux = true;
                }
            });
            if (!this.executionQCM.acceptIncomplet && lEvaluationNotePourQuestion.nbReponsesJustes !== lEvaluationNotePourQuestion.nbBonnesReponses) {
                lEvaluationNotePourQuestion.nbReponsesJustes = 0;
            }
            if (!this.executionQCM.tolererFausses && lForcerFaux) {
                lEvaluationNotePourQuestion.nbReponsesJustes = 0;
            }
            for (var i = 0; i < this.question.listeReponses.GetNbrElements(); i++) {
                if (!$('[id="' + this.Nom + '_q' + this.indiceQuestion + '_r' + i + '"]').is(':checked')) {
                    var lReponse = this.question.listeReponses.GetElement(i);
                    if (lReponse && lReponse.Existe()) {
                        if (lReponse.bonneReponse) {
                            this.composeAffichageCorrigeSingleMultiVraiNonCoche('[id="' + this.Nom + '_q' + this.indiceQuestion + '_r' + i + '"]');
                        } else if (lEvaluationNotePourQuestion.nbReponsesJustes !== lEvaluationNotePourQuestion.nbBonnesReponses) {
                            this.composeAffichageCorrigeSingleMultiFauxNonCoche('[id="' + this.Nom + '_q' + this.indiceQuestion + '_r' + i + '"]');
                        }
                    }
                }
            }
            $('[id^="' + this.Nom + '_q' + this.indiceQuestion + '_r"]:checked').each(function() {
                var lIndice = this.id.match(/_r([0-9]+)$/i)[1];
                var lReponse = lThis.question.listeReponses.GetElement(lIndice);
                if (lEvaluationNotePourQuestion.nbReponsesJustes !== lEvaluationNotePourQuestion.nbBonnesReponses) {
                    if (lReponse.bonneReponse) {
                        lThis.composeAffichageCorrigeSingleMultiVraiCoche(this);
                    } else {
                        lThis.composeAffichageCorrigeSingleMultiFauxCoche(this);
                    }
                } else {
                    if (lReponse.bonneReponse) {
                        lThis.composeAffichageCorrigeSingleMultiVraiCoche(this, true);
                    }
                }
                if (lReponse.feedback) {
                    lThis.composeAffichageCorrigeSingleMultiFeedback('[id="' + lThis.Nom + '_q' + lThis.indiceQuestion + '_r' + lIndice + '"]', (lReponse.bonneReponse ? lThis.couleurVrai : lThis.couleurFaux), lReponse.feedback);
                }
            });
            this.evaluationNote[this.indiceQuestion] = lEvaluationNotePourQuestion;
            this.desactiveEventSingleMulti(this.indiceQuestion);
        };
        ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiVraiCoche = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiVraiNonCoche = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiFauxCoche = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiFauxNonCoche = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSingleMultiFeedback = function() {};
        ObjetVisuEleve.prototype.desactiveEventSingleMulti = function() {};
        ObjetVisuEleve.prototype.composeCorrigeShort = function() {
            this.evaluationNote[this.indiceQuestion] = {
                nbBonnesReponses: 1,
                nbReponsesJustes: 0
            };
            var lBonneReponses = new ObjetListeElements();
            var lJqInput = $('#' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r0');
            var lReponse = GChaine.ajouterEntites(lJqInput.val());
            lReponse = lReponse.replace(/^\s+/, '').replace(/\s+$/, '').replace(/\s+/gi, ' ');
            if (!this.question.casesensitive) {
                lReponse = GChaine.latinize(lReponse).toLowerCase();
            }
            if (!!this.question.listeReponses) {
                lBonneReponses = !this.question.casesensitive ? this.question.listeReponses.getListeElements(function(aEle) {
                    return GChaine.latinize(aEle.GetLibelle()).toLowerCase() === lReponse;
                }) : this.question.listeReponses.getListeElements(function(aEle) {
                    return aEle.GetLibelle() === lReponse;
                });
            } else {}
            if (lBonneReponses.GetNbrElements()) {
                this.evaluationNote[this.indiceQuestion].nbReponsesJustes = 1;
                this.composeAffichageCorrigeShortVrai(lJqInput.get(0));
                if (lBonneReponses.GetElement(0).feedback) {
                    this.composeAffichageCorrigeShortFeedback(lJqInput.get(0), this.couleurVrai, lBonneReponses.GetElement(0).feedback);
                }
            } else {
                if (!!this.question.listeReponses) {
                    this.composeAffichageCorrigeShortFaux(lJqInput.get(0), this.question.listeReponses.GetElement(0).GetLibelle());
                }
            }
            this.desactiveEventShort(this.indiceQuestion);
        };
        ObjetVisuEleve.prototype.composeCorrigeSpell = function() {
            this.evaluationNote[this.indiceQuestion] = {
                nbBonnesReponses: 1,
                nbReponsesJustes: 0
            };
            var lJqInput = $('[name="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r"]');
            var lReponse = '';
            lJqInput.each(function() {
                lReponse += $(this).val();
            });
            lReponse = GChaine.ajouterEntites(lReponse);
            lReponse = lReponse.replace(/^\s+/, '').replace(/\s+$/, '').replace(/\s+/gi, ' ');
            if (!this.question.casesensitive) {
                lReponse = GChaine.latinize(lReponse).toLowerCase();
            }
            var lBonneReponses = !this.question.casesensitive ? this.question.listeReponses.getListeElements(function(aEle) {
                return GChaine.latinize(aEle.GetLibelle()).toLowerCase() === lReponse;
            }) : this.question.listeReponses.getListeElements(function(aEle) {
                return aEle.GetLibelle() === lReponse;
            });
            if (lBonneReponses.GetNbrElements()) {
                this.evaluationNote[this.indiceQuestion].nbReponsesJustes = 1;
                this.composeAffichageCorrigeSpellVrai('[name="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r"]');
                if (lBonneReponses.GetElement(0).feedback) {
                    this.composeAffichageCorrigeSpellFeedback('[name="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r"]', this.couleurVrai, lBonneReponses.GetElement(0).feedback);
                }
            } else {
                this.composeAffichageCorrigeSpellFaux('[name="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r"]', this.question.listeReponses.GetElement(0).GetLibelle());
            }
            this.desactiveEventSpell(this.indiceQuestion);
        };
        ObjetVisuEleve.prototype.composeCorrigeNumerique = function() {
            this.evaluationNote[this.indiceQuestion] = {
                nbBonnesReponses: 1,
                nbReponsesJustes: 0
            };
            var lJqInput = $('#' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r0');
            var lReponse = lJqInput.val();
            lReponse = lReponse.replace(/\s+/gi, '');
            lReponse = lReponse.replace(/\./, ',').replace(/٫/gi, ',').replace(/²/gi, '2').replace(/³/gi, '3');
            lReponse = GChaine.latinize(lReponse).toLowerCase();
            lReponse = GChaine.ajouterEntites(lReponse);
            var lBonneReponses = this.question.listeReponses.getListeElements(function(aEle) {
                return GChaine.latinize(aEle.GetLibelle().replace(/\s+/gi, '').replace(/\./, ',').replace(/٫/gi, ',').replace(/²/gi, '2').replace(/³/gi, '3')).toLowerCase() === lReponse;
            });
            if (lBonneReponses.GetNbrElements()) {
                this.evaluationNote[this.indiceQuestion].nbReponsesJustes = 1;
                this.composeAffichageCorrigeShortVrai(lJqInput.get(0));
                if (lBonneReponses.GetElement(0).feedback) {
                    this.composeAffichageCorrigeShortFeedback(lJqInput.get(0), this.couleurVrai, lBonneReponses.GetElement(0).feedback);
                }
            } else {
                this.composeAffichageCorrigeShortFaux(lJqInput.get(0), this.question.listeReponses.GetElement(0).GetLibelle());
            }
            this.desactiveEventShort(this.indiceQuestion);
        };
        ObjetVisuEleve.prototype.composeAffichageCorrigeShortVrai = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeShortFaux = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeShortFeedback = function() {};
        ObjetVisuEleve.prototype.desactiveEventShort = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSpellVrai = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSpellFaux = function() {};
        ObjetVisuEleve.prototype.composeAffichageCorrigeSpellFeedback = function() {};
        ObjetVisuEleve.prototype.desactiveEventSpell = function() {};
        ObjetVisuEleve.prototype.composeCorrigeMatching = function() {
            this.evaluationNote[this.indiceQuestion] = {
                nbBonnesReponses: this.question.listeReponses.GetNbrElements(),
                nbReponsesJustes: 0
            };
            var lAsymetrie = false;
            var lReponses = [];
            var i, lNbr, lReponse;
            for (i = 0, lNbr = this.question.listeReponses.GetNbrElements(); i < lNbr; i++) {
                lReponse = this.question.listeReponses.GetElement(i);
                if ($.inArray(lReponse.association, lReponses) === -1) {
                    lReponses.push(lReponse.association);
                } else {
                    lAsymetrie = true;
                    break;
                }
            }
            var lThis = this;
            this.composeMiseEnFormeCorrigeMatching(lAsymetrie);
            $('[id^="' + this.Nom + '_q' + this.indiceQuestion + '_drop"]').each(function() {
                var lIndice = this.id.match(/_drop([0-9]+)$/i)[1];
                var lReponse = lThis.getReponseMatching(this);
                lReponse = GChaine.ajouterEntites(lReponse);
                var lBonneReponse = lThis.question.listeReponses.GetElement(lIndice).bonneReponse;
                if (lBonneReponse === lReponse) {
                    lThis.evaluationNote[lThis.indiceQuestion].nbReponsesJustes += 1;
                }
                lThis.composeAffichageReponseCorrigeMatching(this, lReponse !== '', lBonneReponse === lReponse ? lThis.couleurVrai : lThis.couleurFaux);
                lThis.composeCorrigeReponseCorrigeMatching('#' + lThis.idWrapperAffichage.escapeJQ() + lThis.indiceQuestion + ' .objetVisuEleveAssocCorriges', lThis.Nom + '_q' + lThis.indiceQuestion + '_c' + lIndice, lBonneReponse === lReponse, lBonneReponse, lBonneReponse === lReponse ? lThis.couleurVrai : lThis.couleurFaux);
                lThis.composeMiseEnFormeCorrigeReponseCorrigeMatching(this);
            });
            this.desactiveEventMatching(lAsymetrie);
        };
        ObjetVisuEleve.prototype.composeMiseEnFormeCorrigeMatching = function() {};
        ObjetVisuEleve.prototype.composeAffichageReponseCorrigeMatching = function() {};
        ObjetVisuEleve.prototype.composeCorrigeReponseCorrigeMatching = function() {};
        ObjetVisuEleve.prototype.composeMiseEnFormeCorrigeReponseCorrigeMatching = function() {};
        ObjetVisuEleve.prototype.desactiveEventMatching = function() {};
        ObjetVisuEleve.prototype.composeCorrigeCloze = function() {
            var lEnonceOriginel = this.question.enonceOriginel.replace(/&#039;/gi, '&apos;');
            var lReponses = lEnonceOriginel.match(/({[0-9]*:(?:ShortAnswer|MultiChoice):(?:~*(?:%[0-9]{1,3}%|=)?[^~%#{}]+#[^~%#{}]*)+})/gi);
            if (this.question.casesensitive === false) {
                lReponses = $.map(lReponses, function(aEle) {
                    return GChaine.latinize(aEle.toLowerCase());
                });
            }
            var lReponsesJustes = [];
            this.evaluationNote[this.indiceQuestion] = {
                nbBonnesReponses: lReponses ? lReponses.length : null,
                nbReponsesJustes: 0
            };
            var lThis = this;
            $('#' + this.idWrapperEnonce.escapeJQ() + this.indiceQuestion).find('select[id], input[id][type="text"]:not(.select-dropdown)').each(function(aIndex) {
                var lReponse = $(this).val();
                var lValRep = false;
                if (!!lReponse) {
                    if ($(this).is('input')) {
                        lReponse = lReponse.replace(/^\s+/, '').replace(/\s+$/, '').replace(/\s+/gi, ' ');
                    }
                    if (lThis.question.casesensitive === false) {
                        lValRep = lReponses[aIndex].match(new RegExp('(?::|~)(%[0-9]{1,3}%|=)?' + GChaine.latinize(lReponse.replace(/(\(|\)|\[|\]|\+|\*|\.|\^|\$|\?|\\|\{|\}|\|)/g, '\\$1')).toLowerCase() + '(#|~)', ''));
                    } else {
                        lValRep = lReponses[aIndex].match(new RegExp('(?::|~)(%[0-9]{1,3}%|=)?' + lReponse.replace(/(\(|\)|\[|\]|\+|\*|\.|\^|\$|\?|\\|\{|\}|\|)/g, '\\$1') + '(#|~)', ''));
                    }
                }
                lValRep = lValRep && lValRep[1] ? lValRep[1].replace(/%/gi, '').replace('=', '100') : '0';
                if (parseInt(lValRep) === 100) {
                    lThis.evaluationNote[lThis.indiceQuestion].nbReponsesJustes += 1;
                    lReponsesJustes[aIndex] = 1;
                }
                lThis.composeMiseEnFormeReponseCorrigeCloze(this, parseInt(lValRep) === 100 ? 'black' : lThis.couleurFaux, lReponse);
            });
            if (this.evaluationNote[this.indiceQuestion].nbBonnesReponses !== this.evaluationNote[this.indiceQuestion].nbReponsesJustes) {
                this.composeMiseEnFormeWrapperEnonceCloze('#' + this.idWrapperEnonce.escapeJQ() + this.indiceQuestion);
                var lInc = 0;
                this.composeMiseEnFormeWrapperCorrigeCloze('#' + this.idWrapperEnonce.escapeJQ() + this.indiceQuestion, lEnonceOriginel.replace(/({[0-9]*:(ShortAnswer|MultiChoice):.*?(~*(?:%100%|=)([^~%#{}]+)#[^~%#{}]*).*?})/gi, function(aMatch, aA, aB, aC, aD) {
                    return lThis.composeMiseEnFormeCorrectionCorrigeCloze(aD, (lReponsesJustes[lInc++] === 1 ? '' : 'color:' + lThis.couleurFaux + ';') + 'font-weight:bold;');
                }));
            }
            this.actualiserHauteurQuestion();
        };
        ObjetVisuEleve.prototype.composeMiseEnFormeReponseCorrigeCloze = function() {};
        ObjetVisuEleve.prototype.composeMiseEnFormeWrapperEnonceCloze = function() {};
        ObjetVisuEleve.prototype.composeMiseEnFormeWrapperCorrigeCloze = function() {};
        ObjetVisuEleve.prototype.composeMiseEnFormeCorrectionCorrigeCloze = function() {
            return '';
        };
        ObjetVisuEleve.prototype.desactiveEventCloze = function() {};
        ObjetVisuEleve.prototype.majReponsesRepondant = function() {
            if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice) {
                this.majReponsesSingleMulti();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer) {
                this.majReponsesShort();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer) {
                this.majReponsesSpell();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                this.majReponsesMatching();
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable) {
                this.majReponsesCloze();
            }
            $('#' + this.idBoutonNext.escapeJQ() + this.indiceQuestion).show();
        };
        ObjetVisuEleve.prototype.desactiveEvent = function() {
            if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice) {
                this.desactiveEventSingleMulti(this.indiceQuestion);
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer) {
                this.desactiveEventShort(this.indiceQuestion);
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer) {
                this.desactiveEventSpell(this.indiceQuestion);
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                var lAsymetrie = false;
                var lReponses = [];
                for (var i = 0; i < this.question.listeReponses.GetNbrElements(); i++) {
                    var lReponse = this.question.listeReponses.GetElement(i);
                    if ($.inArray(lReponse.association, lReponses) === -1) {
                        lReponses.push(lReponse.association);
                    } else {
                        lAsymetrie = true;
                        break;
                    }
                }
                this.desactiveEventMatching(lAsymetrie);
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable) {
                this.desactiveEventCloze(this.indiceQuestion);
            }
        };
        ObjetVisuEleve.prototype.majReponsesSingleMulti = function() {
            for (var x in this.question.reponsesRepondant) {
                if (this.question.reponsesRepondant[x] !== '') {
                    this.composeMajReponsesSingleMulti('#' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r' + (parseInt(this.question.reponsesRepondant[x]) - 1), true);
                }
            }
        };
        ObjetVisuEleve.prototype.majReponsesShort = function() {
            var lJqInput = $('#' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r0');
            if (this.question.reponsesRepondant && this.question.reponsesRepondant[0]) {
                this.composeMajReponsesShort(lJqInput, GChaine.enleverEntites(this.question.reponsesRepondant[0]));
            }
        };
        ObjetVisuEleve.prototype.majReponsesSpell = function() {
            if (this.question.reponsesRepondant && this.question.reponsesRepondant[0]) {
                this.composeMajReponsesSpell('[name="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r"]', GChaine.enleverEntites(this.question.reponsesRepondant[0]));
            }
        };
        ObjetVisuEleve.prototype.majReponsesMatching = function() {
            var lUsedDraggable = ['dummyID'];
            var lAsymetrie = false;
            if (this.question && this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                var lReponses = [];
                for (var i = 0; i < this.question.listeReponses.GetNbrElements(); i++) {
                    var lReponse = this.question.listeReponses.GetElement(i);
                    if ($.inArray(lReponse.association, lReponses) === -1) {
                        lReponses.push(lReponse.association);
                    } else {
                        lAsymetrie = true;
                        break;
                    }
                }
            }
            for (var x in this.question.reponsesRepondant) {
                if (this.question.reponsesRepondant[x] !== '') {
                    var lResult = this.composeMajReponsesMatching('#' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_drop' + x, this.Nom + '_q' + this.indiceQuestion + '_r', GChaine.enleverEntites(this.question.reponsesRepondant[x]), lUsedDraggable, lAsymetrie);
                    if (lResult) {
                        lUsedDraggable.push(lResult);
                    } else {}
                }
            }
        };
        ObjetVisuEleve.prototype.majReponsesCloze = function() {
            var lThis = this;
            $('#' + this.idWrapperEnonce.escapeJQ() + this.indiceQuestion).find('select, input[type="text"]:not(.select-dropdown)').each(function(aIndex) {
                if (lThis.question.reponsesRepondant && lThis.question.reponsesRepondant[aIndex] !== '') {
                    lThis.composeMajReponsesCloze(this, GChaine.enleverEntites(lThis.question.reponsesRepondant[aIndex]));
                }
            });
        };
        ObjetVisuEleve.prototype.composeMajReponsesSingleMulti = function() {};
        ObjetVisuEleve.prototype.composeMajReponsesShort = function() {};
        ObjetVisuEleve.prototype.composeMajReponsesSpell = function() {};
        ObjetVisuEleve.prototype.composeMajReponsesMatching = function() {
            return '';
        };
        ObjetVisuEleve.prototype.composeMajReponsesCloze = function() {};
        ObjetVisuEleve.prototype.recupererReponses = function() {
            var lReponses = [],
                lJqInput, lReponse;
            if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice) {
                $('[id^="' + this.Nom + '_q' + this.indiceQuestion + '_r"]:checked').each(function() {
                    var lIndice = this.id.match(/_r([0-9]+)$/i)[1];
                    lReponses.push(parseInt(lIndice) + 1);
                });
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer) {
                lJqInput = $('#' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r0');
                lReponse = lJqInput.val().replace(/^\s+/, '').replace(/\s+$/, '').replace(/\s+/gi, ' ');
                lReponses.push(lReponse);
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer) {
                lJqInput = $('input[name="' + this.Nom.escapeJQ() + '_q' + this.indiceQuestion + '_r"]');
                lReponse = '';
                lJqInput.each(function() {
                    lReponse += $(this).val();
                });
                lReponse = lReponse.replace(/^\s+/, '').replace(/\s+$/, '').replace(/\s+/gi, ' ');
                lReponses.push(lReponse);
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching) {
                var lThis = this;
                $('[id^="' + this.Nom + '_q' + this.indiceQuestion + '_drop"]').each(function() {
                    lReponses.push(lThis.getReponseMatching(this));
                });
            } else if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable) {
                $('#' + this.idWrapperEnonce.escapeJQ() + this.indiceQuestion).find('select, input[type="text"]:not(.select-dropdown)').each(function() {
                    lReponse = $(this).val();
                    if ($(this).is('input')) {
                        lReponse = lReponse.replace(/^\s+/, '').replace(/\s+$/, '').replace(/\s+/gi, ' ');
                    }
                    lReponses.push(lReponse);
                });
            }
            return lReponses;
        };
        ObjetVisuEleve.prototype.getReponseMatching = function() {};
        ObjetVisuEleve.prototype.setDonnees = function(aParam) {
            if (this.estEnInitialisation()) {
                this.executionQCM = aParam;
                this.nbQuestions = this.executionQCM.QCM && this.executionQCM.QCM.nbQuestion ? this.executionQCM.QCM.nbQuestion : this.executionQCM.nombreQuestionsSoumises ? this.executionQCM.nombreQuestionsSoumises : this.executionQCM.QCM && this.executionQCM.QCM.nbQuestionsTotal ? this.executionQCM.QCM.nbQuestionsTotal : this.executionQCM.nbQuestionsTotal;
                if (!!this.executionQCM.listeCompetences) {
                    this.executionQCM.listeCompetences.setTri([ObjetTri.init('Libelle')]);
                    this.executionQCM.listeCompetences.trier();
                }
            }
            if (aParam.message) {
                this.executionQCM.message = aParam.message;
            }
            if (this.typeNumerotation === undefined || this.typeNumerotation === null) {
                this.typeNumerotation = aParam.QCM && aParam.QCM.typeNumerotation !== undefined ? aParam.QCM.typeNumerotation : aParam.contenuQCM && aParam.contenuQCM.typeNumerotation !== undefined ? aParam.contenuQCM.typeNumerotation : aParam.typeNumerotation;
            }
            if (aParam && ((aParam.QCM && aParam.QCM.etatCloture >= 0) || aParam.etatCloture >= 0)) {
                this.etatCloture = aParam.etatCloture ? aParam.etatCloture : aParam.QCM.etatCloture;
            }
            if (aParam.QCM && aParam.modeVisuQuestion && aParam.modeVisuQuestion === true && $.isNumeric(aParam.questionEnVisu)) {
                this.indiceQuestion = aParam.questionEnVisu;
                this.modeVisuQuestion = aParam.modeVisuQuestion;
            } else {
                this.modeVisuQuestion = false;
            }
            if (aParam.QCM) {
                if (aParam.QCM.secEcoulees) {
                    this.start = new Date().getTime() - (aParam.QCM.secEcoulees * 1000);
                } else if (!this.start && !this.estEnInitialisation()) {
                    this.start = new Date().getTime();
                }
                if (aParam.QCM.listeQuestions && !this.modeProf && $.inArray(this.etatCloture, [TypeEtatExecutionQCMPourRepondant.EQR_EnCours, TypeEtatExecutionQCMPourRepondant.EQR_ARefaire]) > -1) {
                    this.question = aParam.QCM.listeQuestions.GetElement(0);
                } else if (aParam.QCM.listeQuestions) {
                    this.listeQuestions = aParam.QCM.listeQuestions;
                    this.question = aParam.QCM.listeQuestions.GetElement(this.indiceQuestion);
                }
            }
            if (this.estEnInitialisation() || !this.estEnCloture() || this.estEnCorrigeFin()) {
                this.actualiser();
            }
        };
        ObjetVisuEleve.prototype.setDonneesReponse = function(aParam) {
            this.etatCloture = aParam.etatCloture;
            if (aParam.etatCloture !== undefined && $.inArray(aParam.etatCloture, [TypeEtatExecutionQCMPourRepondant.EQR_EnCours, TypeEtatExecutionQCMPourRepondant.EQR_ARefaire]) === -1 && this.executionQCM.modeDiffusionCorrige !== TypeModeCorrectionQCM.FBQ_CorrigeALaFin) {
                this.composeCloture();
                if (aParam.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee) {
                    this.indiceQuestion = this.nbQuestions + Number(this.executionQCM.ressentiRepondant);
                }
            } else if (this.estEnRessenti() && this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                this.indiceQuestion++;
                this.actualiser();
            } else if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin && aParam && aParam.listeQuestions && aParam.listeQuestions.GetNbrElements() > 0) {
                this.listeQuestions = aParam.listeQuestions;
                if (aParam.etatCloture !== TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee) {
                    this.composeCorrigeFin();
                    this.indiceQuestion++;
                    this.enActualisation = false;
                } else {
                    this.composeCloture();
                    this.enActualisation = false;
                    this.indiceQuestion = this.nbQuestions + Number(this.executionQCM.ressentiRepondant);
                }
            } else if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion && aParam && aParam.listeQuestions && aParam.listeQuestions.GetNbrElements() === 1) {
                $.extend(true, this.question, aParam.listeQuestions.GetElement(0));
                this.composeCorrige();
                this.enActualisation = false;
            }
        };
        ObjetVisuEleve.prototype.surEvenement = function(aObjet) {
            if (this.enActualisation) {
                return;
            } else {
                this.enActualisation = true;
            }
            if (this.estEnCloture() && !this.estUnCorrigeVisibleApresCloture()) {
                this.fermetureFenetre();
                return;
            }
            if (this.modeProf) {
                this.surEvenementProf(aObjet);
            } else {
                this.surEvenementEleve(aObjet);
            }
        };
        ObjetVisuEleve.prototype.surEvenementProf = function(aObjet) {
            if (aObjet.action === 'submit' && this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                if (this.estEnCours()) {
                    this.composeCorrige();
                    this.enActualisation = false;
                } else if (this.estEnRessenti()) {
                    this.indiceQuestion++;
                    this.actualiser();
                    return;
                } else {
                    this.fermetureFenetre();
                }
                $('#' + this.idBoutonSubmit.escapeJQ() + this.indiceQuestion).hide();
            } else {
                if (this.modeVisuQuestion) {
                    this.fermetureFenetre();
                    return;
                }
                if (aObjet.action === 'prev') {
                    this.indiceQuestion--;
                } else {
                    if (aObjet.action === 'submit') {
                        if (this.estEnCours()) {
                            this.evaluationNote[this.indiceQuestion].validee = true;
                            this.question.reponsesRepondant = this.recupererReponses();
                        } else if (this.estEnRessenti()) {
                            $.noop();
                        } else if (this.estEnFin()) {
                            if (this.executionQCM.modeDiffusionCorrige !== TypeModeCorrectionQCM.FBQ_CorrigeALaFin || this.estEnCorrigeFin()) {
                                this.fermetureFenetre();
                            } else {
                                this.indiceQuestion++;
                                this.composeCorrigeFin();
                            }
                            return;
                        }
                    }
                    if (this.estEnCloture() && this.executionQCM.estRejouable && aObjet.action === 'restart') {
                        this.etatCloture = null;
                    }
                    if (this.estEnCloture()) {
                        this.indiceQuestion = this.nbQuestions + Number(this.executionQCM.ressentiRepondant) + 1;
                    } else {
                        this.indiceQuestion++;
                    }
                }
                this.recupererQuestionProf();
            }
        };
        ObjetVisuEleve.prototype.surEvenementEleve = function(aObjet) {
            if (aObjet.action === 'submit' && this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                this.surEvenementValidationEleve();
                $('#' + this.idBoutonSubmit.escapeJQ() + this.indiceQuestion).hide();
            } else {
                if (aObjet.action === 'prev') {
                    this.indiceQuestion--;
                } else {
                    if (aObjet.action === 'submit') {
                        if (!this.surEvenementValidationEleve()) {
                            return;
                        }
                    }
                    if (this.estEnCloture() && this.executionQCM.estRejouable && aObjet.action === 'restart') {
                        this.etatCloture = null;
                    }
                    if (this.estEnInitialisation() && this.estUneExecutionDejaCommencee()) {
                        this.indiceQuestion = this.executionQCM.indiceProchaineQuestion;
                    } else if (this.estEnCloture()) {
                        this.indiceQuestion = this.nbQuestions + Number(this.executionQCM.ressentiRepondant) + 1;
                    } else {
                        this.indiceQuestion++;
                    }
                }
                this.recupererQuestionEleve();
            }
        };
        ObjetVisuEleve.prototype.recupererQuestion = function() {
            if (this.modeProf) {
                this.recupererQuestionProf();
            } else {
                this.recupererQuestionEleve();
            }
        };
        ObjetVisuEleve.prototype.recupererQuestionProf = function() {
            if (this.listeQuestions && this.listeQuestions.GetNbrElements() > 0) {
                if (this.executionQCM.dureeMaxQCM && this.getMilliSecondesChrono() <= 0) {
                    this.etatCloture = TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee;
                }
                this.question = this.listeQuestions.GetElement(this.indiceQuestion);
                if (this.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee) {
                    this.composeCloture();
                    this.enActualisation = false;
                    this.indiceQuestion = this.nbQuestions + Number(this.executionQCM.ressentiRepondant);
                } else {
                    this.actualiser();
                }
            } else {
                var lParam = {
                    action: 'get',
                    indiceQuestion: this.indiceQuestion,
                    numeroExecution: this.numeroExecution,
                    element: this.executionQCM,
                    pourInitialisation: this.indiceQuestion === 0 && !this.estEnCloture()
                };
                this.Evenement.call(this.Pere, lParam);
            }
        };
        ObjetVisuEleve.prototype.recupererQuestionEleve = function() {
            var lParam = {
                action: 'get',
                indiceQuestion: this.indiceQuestion,
                numeroExecution: this.numeroExecution,
                element: this.executionQCM,
                pourInitialisation: this.indiceQuestion === 0 && !this.estEnCloture()
            };
            this.Evenement.call(this.Pere, lParam);
        };
        ObjetVisuEleve.prototype.surEvenementValidationEleve = function() {
            var lParam;
            if (this.estEnCours()) {
                this.evaluationNote[this.indiceQuestion].validee = true;
                lParam = {
                    action: 'set',
                    element: this.executionQCM,
                    indiceQuestion: this.indiceQuestion,
                    reponse: this.recupererReponses()
                };
                this.Evenement.call(this.Pere, lParam);
            } else if (this.estEnRessenti()) {
                lParam = {
                    action: 'set',
                    element: this.executionQCM,
                    ressenti: this.ressenti
                };
                this.Evenement.call(this.Pere, lParam);
            } else if (this.estEnFin()) {
                if (this.executionQCM.modeDiffusionCorrige !== TypeModeCorrectionQCM.FBQ_CorrigeALaFin || this.estEnCorrigeFin()) {
                    this.fermetureFenetre(this.executionQCM.modeDiffusionCorrige !== TypeModeCorrectionQCM.FBQ_CorrigeALaFin);
                } else {
                    lParam = {
                        action: 'set',
                        element: this.executionQCM,
                        pourCloture: true
                    };
                    this.Evenement.call(this.Pere, lParam);
                }
                return false;
            }
            return true;
        };
        ObjetVisuEleve.prototype.fermetureFenetre = function(aPourCloture) {
            var lParam = {
                action: 'close'
            };
            if (aPourCloture === true) {
                lParam.element = this.executionQCM;
                lParam.pourCloture = true;
            }
            this.Evenement.call(this.Pere, lParam);
        };
        ObjetVisuEleve.prototype.estEnInitialisation = function() {
            return this.indiceQuestion === -1;
        };
        ObjetVisuEleve.prototype.estEnRessenti = function() {
            return this.indiceQuestion === this.nbQuestions && this.executionQCM.ressentiRepondant;
        };
        ObjetVisuEleve.prototype.estEnFin = function() {
            return this.indiceQuestion >= this.nbQuestions && !this.estEnRessenti();
        };
        ObjetVisuEleve.prototype.estEnCorrigeFin = function() {
            return (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin || (this.estEnCloture() && this.estUnCorrigeVisibleApresCloture())) && this.indiceQuestion === this.nbQuestions + Number(this.executionQCM.ressentiRepondant) + 1;
        };
        ObjetVisuEleve.prototype.estEnCours = function() {
            return this.indiceQuestion > -1 && this.indiceQuestion < this.nbQuestions;
        };
        ObjetVisuEleve.prototype.estEnCloture = function() {
            return this.etatCloture !== undefined && this.etatCloture !== null && $.inArray(this.etatCloture, [TypeEtatExecutionQCMPourRepondant.EQR_EnCours, TypeEtatExecutionQCMPourRepondant.EQR_ARefaire]) === -1;
        };
        ObjetVisuEleve.prototype.estUneExecutionDejaCommencee = function() {
            return this.executionQCM.indiceProchaineQuestion >= 0 && this.executionQCM.indiceProchaineQuestion < this.nbQuestions;
        };
        ObjetVisuEleve.prototype.estUnCorrigeVisibleApresCloture = function() {
            return this.executionQCM.publierCorrige || this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin || this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion;
        };
        module.exports = ObjetVisuEleve;
    },
    fn: "objetvisueleveqcm.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetVisuEleve = require('ObjetVisuEleveQCM.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var TypeGenreExerciceDeQuestionnaire = require('TypeGenreExerciceDeQuestionnaire.js').TypeGenreExerciceDeQuestionnaire;
        var TypeModeCorrectionQCM = require('TypeModeCorrectionQCM.js').TypeModeCorrectionQCM;
        var TUtilitaireDuree = require('UtilitaireDuree.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var UtilitaireQCM = require('UtilitaireQCM.js').UtilitaireQCM;
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        MethodesObjet.heritagePrototype(ObjetVisuEleve_Mobile, ObjetVisuEleve);

        function ObjetVisuEleve_Mobile() {
            this.inheritedCreate(arguments);
            this.nbImages = 0;
            this.nbImagesChargees = 0;
            this.ressentiSelectionne = false;
            this.avecIECheckbox = false;
            this.idWrapperTitre = this.Nom + '_WrapperTitre_';
            this.idWrapperQuestion = this.Nom + '_WrapperQuestion_';
            this.idWrapperNavigation = this.Nom + '_WrapperNavigation_';
            this.idWrapperReponses = this.Nom + '_WrapperReponses_';
            this.idWrapperEnonce = this.Nom + '_WrapperEnonce_';
            this.idWrapperCorrigeQuest = this.Nom + '_WrapperCorrigeQuest_';
            this.idWrapperCorrige = this.Nom + '_WrapperCorrige';
            this.idWrapperBarreProgression = this.Nom + '_WrapperBarreProg';
            this.idProgression = this.Nom + '_idProgression_';
            this.idIndicateurProg = this.Nom + '_IndicateurProgression';
            this.idBoutonPrev = this.Nom + '_boutonPrev_';
            this.idBoutonStart = this.Nom + '_boutonStart';
            this.couleurThemeQCMFonce = '#428ca5';
        }
        ObjetVisuEleve_Mobile.prototype.triggerFinActualisation = function() {
            $('#' + this.Nom.escapeJQ()).find('select').formSelect({
                dropdownOptions: {
                    container: $('body').get(0)
                }
            });
            if (this.estEnCours()) {
                this.Evenement.call(this.Pere, {
                    action: 'afficherNavigation'
                });
            } else {
                this.Evenement.call(this.Pere, {
                    action: 'masquerNavigation'
                });
            }
            $("#div").scrollTop(0);
        };
        ObjetVisuEleve_Mobile.prototype.composeOuvertureDivGlobal = function() {
            return '<div style="margin:0.5rem;">';
        };
        ObjetVisuEleve_Mobile.prototype.composeFermetureDivGlobal = function() {
            return '</div>';
        };
        ObjetVisuEleve_Mobile.prototype.composeTitre = function() {
            var lHtmlTitle = [];
            if (this.executionQCM.GetLibelle()) {
                lHtmlTitle.push(this.executionQCM.GetLibelle());
            }
            lHtmlTitle.push(this._getTitreExecutionQCM(this.executionQCM));
            if (this.executionQCM.service && this.executionQCM.service.GetLibelle()) {
                lHtmlTitle.push(this.executionQCM.service.GetLibelle());
            }
            if (this.executionQCM.matiere && this.executionQCM.matiere.GetLibelle()) {
                lHtmlTitle.push(this.executionQCM.matiere.GetLibelle());
            }
            var lHtmlTitleProf = this.executionQCM.listeProfesseurs ? this.executionQCM.listeProfesseurs.getTableauLibelles().join(', ') : '';
            return GChaine.enleverEntites('<span class="Texte12">' + lHtmlTitle.join(' - ') + '</span><br /><span class="Texte12">' + lHtmlTitleProf + '</span>');
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageQuestion = function() {
            var lHtml = [];
            if (!this.affichageEnLigne) {
                lHtml.push('<div id="', this.idWrapperGlobal, '" style="margin:10px;text-align:center;">');
            }
            lHtml.push('<div id="', this.idWrapperAffichage, this.indiceQuestion, '" class="InlineBlock" style="position:relative;width:100%;text-align:left;">');
            lHtml = lHtml.concat(this.composeQuestion());
            lHtml = lHtml.concat(this.composeNavigation());
            lHtml.push('</div>');
            if (!this.affichageEnLigne) {
                lHtml.push('</div>');
                $('#' + this.idWrapperBarreProgression.escapeJQ()).html(this.composeBarreProgression().join(''));
            }
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.ajouterEvenementMatching = function(aIndiceQuestion, aAsymetrie) {
            var lWidth = $('[id^="' + this.Nom + '_q' + aIndiceQuestion + '_drop"]:first').width();
            $('select[id^="' + this.Nom + '_q' + aIndiceQuestion + '_r"]').each(function() {
                $(this).width(lWidth);
            });
            if (!aAsymetrie) {
                $('select[id^="' + this.Nom + '_q' + aIndiceQuestion + '_r"]').on('change', {
                    aObjet: this
                }, function() {
                    var lJqSelects = $(this).parent().parent().parent().siblings('div').addBack().find('select');
                    var lAssoc = [];
                    lJqSelects.each(function() {
                        lAssoc.push(this.selectedIndex);
                    });
                    lJqSelects.each(function() {
                        var lSelectedIndex = this.selectedIndex;
                        $(this).find('option').prop('disabled', function(index) {
                            return index !== 0 && index !== lSelectedIndex && $.inArray(index, lAssoc) > -1 ? true : false;
                        });
                    }).formSelect({
                        dropdownOptions: {
                            container: $('body').get(0)
                        }
                    });
                });
            }
        };
        ObjetVisuEleve_Mobile.prototype.ajouterEvenementSingleMultiChoice = function() {};
        ObjetVisuEleve_Mobile.prototype.composeAffichageRessenti = function() {
            var lHtml = [];
            if (!this.affichageEnLigne) {
                lHtml.push('<div id="', this.idWrapperGlobal, '" style="margin:10px;text-align:center;">');
            }
            lHtml.push('<div id="', this.idWrapperAffichage, this.indiceQuestion, '" class="InlineBlock" style="position:relative;width:100%;text-align:left;margin:0;">');
            lHtml = lHtml.concat(this.composeRessenti());
            lHtml = lHtml.concat(this.composeNavigation());
            lHtml.push('</div>');
            if (!this.affichageEnLigne) {
                lHtml.push('</div>');
            }
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageFin = function() {
            var lHtml = [];
            if (!this.affichageEnLigne) {
                lHtml.push('<div id="', this.idWrapperGlobal, '" style="margin:10px;text-align:center;">');
            }
            lHtml.push('<div id="', this.idWrapperAffichage, this.indiceQuestion, '" class="InlineBlock" style="position:relative;width:100%;text-align:left;margin:0;">');
            lHtml.push('<div class="card">');
            lHtml.push('<div class="card-content">');
            var lEstUnIDevoir = this._estUnIDevoir(this.executionQCM);
            var lCleTraductionPhraseFin;
            if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin) {
                lCleTraductionPhraseFin = (lEstUnIDevoir ? 'ExecutionQCM.phraseFinAvantCorrige' : 'ExecutionQCM.phraseFinQCMAvantCorrige');
            } else {
                lCleTraductionPhraseFin = (lEstUnIDevoir ? 'ExecutionQCM.phraseFin' : 'ExecutionQCM.phraseFinQCM');
            }
            lHtml.push('<span class="card-title">', GTraductions.getValeur(lCleTraductionPhraseFin), '</span>');
            lHtml.push('</div>');
            lHtml.push('<div id="', this.idWrapperNavigation, this.indiceQuestion, '" class="card-action">');
            lHtml.push('<button id="', this.idBoutonSubmit, this.indiceQuestion, '" class="btn waves-effect waves-light" style="', (this.estEnRessenti() ? 'display:none;' : ''), '" onclick="' + this.Nom + '.surEvenement({action: \'submit\'});" tabIndex="0">');
            lHtml.push(this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin ? GTraductions.getValeur('ExecutionQCM.presentationCorrige.VisualiserCorrige') : GTraductions.getValeur('ExecutionQCM.Terminer'));
            lHtml.push('</button>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            if (!this.affichageEnLigne) {
                lHtml.push('</div>');
            }
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeCloture = function() {
            $('#' + this.idContenu).html('');
            var lHtml = [];
            lHtml.push('<div id="', this.idWrapperGlobal, '" style="margin:10px;text-align:center;">');
            lHtml.push('<div class="InlineBlock" style="position:relative;width:100%;text-align:left;margin:0;">');
            lHtml.push('<div style="background-color:#fff;color:#000;border:#ccc 1px solid;font-size:20px;padding:10px;margin:0 0 15px;">');
            var lEstUnIDevoir = this._estUnIDevoir(this.executionQCM);
            var lCleTraductionPhraseCloture;
            if (this.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_DureeMaxDepassee) {
                lCleTraductionPhraseCloture = (lEstUnIDevoir ? 'ExecutionQCM.PhraseClotureDelaiMax' : 'ExecutionQCM.PhraseClotureQCMDelaiMax');
            } else {
                lCleTraductionPhraseCloture = (lEstUnIDevoir ? 'ExecutionQCM.PhraseCloture' : 'ExecutionQCM.PhraseClotureQCM');
            }
            lHtml.push('<h1 style="text-align:center;font-size:25px;">', GTraductions.getValeur(lCleTraductionPhraseCloture), '</h1>');
            lHtml.push('</div>');
            lHtml.push('<table id="', this.idWrapperNavigation, this.indiceQuestion, '" style="width:100%;"><tr>');
            lHtml.push('<td style="width:100%;">');
            lHtml.push('<button id="', this.idBoutonSubmit, this.indiceQuestion, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.surEvenement({action: \'submit\'});" tabIndex="0">' + GTraductions.getValeur('ExecutionQCM.Terminer') + '</button>');
            lHtml.push('</td>');
            lHtml.push('</tr></table>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            $('#' + this.idContenu).html(lHtml.join(''));
            this.actualiserHauteurQuestion();
            this.enActualisation = false;
        };
        ObjetVisuEleve_Mobile.prototype.composePageNonDemarre = function() {
            var lHtml = [];
            lHtml.push('<div style="text-align:center;background-color:#fff;color:#000;font-size:20px;padding:10px;margin:10px;">');
            lHtml.push('<div class="InlineBlock" style="text-align:left;">');
            lHtml.push('<h1 style="text-align:center;font-size:25px;margin:0 auto 50px;">');
            lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseClotureNonDemarre'));
            lHtml.push('</h1>');
            lHtml.push('<div style="text-align:center;">');
            lHtml.push('<button id="', this.idBoutonStart, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.fermetureFenetre();" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.Terminer'), '</button>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeFin = function() {
            var lHtml = [];
            lHtml.push('<div id="', this.idWrapperGlobal, '" style="margin:10px;text-align:center;">');
            lHtml.push('<div id="', this.idWrapperCorrige, '" class="InlineBlock" style="position:relative;width:100%;text-align:left;margin:0;">');
            var lBackupIndice = this.indiceQuestion;
            for (var i = 0; i < this.listeQuestions.GetNbrElements(); i++) {
                this.indiceQuestion = i;
                this.question = this.listeQuestions.GetElement(i);
                lHtml.push('<div id="', this.idWrapperAffichage, this.indiceQuestion, '" style="margin-bottom:15px;">');
                lHtml = lHtml.concat(this.composeQuestion());
                lHtml.push('</div>');
            }
            this.indiceQuestion = lBackupIndice;
            lHtml.push('<table id="', this.idWrapperNavigation, this.indiceQuestion, '" style="width:100%;"><tr>');
            lHtml.push('<td style="width:100%;text-align:center;">');
            lHtml.push('<button id="', this.idBoutonSubmit, this.indiceQuestion, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.surEvenement({action: \'submit\'});" tabIndex="0">' + GTraductions.getValeur('ExecutionQCM.Terminer') + '</button>');
            lHtml.push('</td>');
            lHtml.push('</tr></table>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.autoriserFermetureInterface = function() {
            this.Evenement.call(this.Pere, {
                action: 'afficherCroix'
            });
        };
        ObjetVisuEleve_Mobile.prototype.interdireFermetureInterface = function() {
            this.Evenement.call(this.Pere, {
                action: 'masquerCroix'
            });
        };
        ObjetVisuEleve_Mobile.prototype.actualiserHauteurCartoucheCompetences = function() {};
        ObjetVisuEleve_Mobile.prototype.actualiserHauteurCorrige = function() {};
        ObjetVisuEleve_Mobile.prototype.actualiserHauteurQuestion = function() {};
        ObjetVisuEleve_Mobile.prototype.actualiserHauteurReponse = function() {};
        ObjetVisuEleve_Mobile.prototype.composePageModalite = function() {
            var lHtml = [];
            lHtml.push('<div class="card">');
            lHtml.push('<div class="card-content">');
            lHtml.push('<div class="card-title">', GTraductions.getValeur('ExecutionQCM.LisezIndications'), '</div>');
            var lTrad = '';
            var lImage = '';
            lHtml.push('<table cellpadding="0" cellspacing="0" style="">');
            if (this.executionQCM.estLieADevoir && this.executionQCM.estLieAEvaluation) {
                lTrad = 'ExecutionQCM.notation.evaluationEtDevoir';
            } else if (this.executionQCM.estLieADevoir) {
                lTrad = 'ExecutionQCM.notation.devoir';
            } else if (this.executionQCM.estLieAEvaluation) {
                lTrad = 'ExecutionQCM.notation.evaluation';
            } else if (this.executionQCM.estUnTAF) {
                lTrad = 'ExecutionQCM.notation.taf';
            } else {
                lTrad = 'ExecutionQCM.notation.contenuCours';
            }
            if (lTrad !== '') {
                lImage = this._getNomImageTypeExecutionQCM(this.executionQCM);
                lHtml.push('<tr><td><div class="InlineBlock ', lImage, '">&nbsp;</div></td><td>', GTraductions.getValeur(lTrad, [this.executionQCM.nombreDePoints]) + '</td></tr>');
            }
            if (this.executionQCM.dureeMaxQCM) {
                lTrad = 'ExecutionQCM.presentation.limite_temps';
                lImage = 'Image_QCM_limite_temps';
            } else {
                lTrad = 'ExecutionQCM.presentation.sans_limite_temps';
                lImage = 'Image_QCM_sans_limite_temps';
            }
            if (lTrad !== '') {
                lHtml.push('<tr><td><div class="InlineBlock ', lImage, '">&nbsp;</div></td><td>', GTraductions.getValeur(lTrad, [TUtilitaireDuree.dureeEnMin(this.executionQCM.dureeMaxQCM)]), (this.executionQCM.dureeMaxQCM ? ' ' + GTraductions.getValeur('ExecutionQCM.Minutes') : ''), '</td></tr>');
            }
            var lAvecNavigationPossible = this.executionQCM.autoriserLaNavigation;
            if (!lAvecNavigationPossible) {
                lTrad = 'ExecutionQCM.presentation.sans_retour_precedent';
                lImage = 'Image_QCM_sans_retour_precedent';
            } else {
                lTrad = 'ExecutionQCM.presentation.retour_precedent';
                lImage = 'Image_QCM_retour_precedent';
            }
            if (lTrad !== '') {
                lHtml.push('<tr><td><div class="InlineBlock ', lImage, '">&nbsp;</div></td><td>', GTraductions.getValeur(lTrad), '</td></tr>');
                if (lAvecNavigationPossible) {
                    lHtml.push('<tr><td></td><td class="Italique" style="color: red;">', GTraductions.getValeur('ExecutionQCM.presentation.RS_IlFautCliquerSurValider'), '</td></tr>');
                }
            }
            if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeSans) {
                lTrad = 'ExecutionQCM.corrige.aucun';
                lImage = 'Image_QCM_corrige_aucun';
            } else if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                lTrad = 'ExecutionQCM.corrige.chaque_question';
                lImage = 'Image_QCM_corrige_chaque_question';
            } else if (this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeALaFin) {
                lTrad = 'ExecutionQCM.corrige.fin_qcm';
                lImage = 'Image_QCM_corrige_fin_qcm';
            }
            if (lTrad !== '') {
                lHtml.push('<tr><td><div class="InlineBlock ', lImage, '">&nbsp;</div></td><td>', GTraductions.getValeur(lTrad), '</td></tr>');
            }
            lHtml.push('</table>');
            lHtml.push('<div class="card-action">');
            lHtml.push('<button id="', this.idBoutonStart, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.surEvenement({action: \'start\'});" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.CommencerQCM'), '</button>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composePagePresCorrige = function() {
            var lHtml = [];
            lHtml.push('<div class="card">');
            lHtml.push('<div class="card-content">');
            lHtml.push('<div class="card-title">');
            if (this._estUnIDevoir(this.executionQCM)) {
                lHtml.push(GTraductions.getValeur('ExecutionQCM.presentationCorrige.CorrigeIdevoirExecute'));
            } else {
                lHtml.push(GTraductions.getValeur('ExecutionQCM.presentationCorrige.CorrigeQCMExecute'));
            }
            lHtml.push('</div>');
            var lTrad = '';
            var lImage = '';
            var lNbQuestionsTotal = this.nbQuestions || (!!this.executionQCM.QCM ? this.executionQCM.QCM.nbQuestionsTotal : 0);
            if (!lNbQuestionsTotal) {
                lNbQuestionsTotal = this.executionQCM.nbQuestRepondues;
            }
            var lNbReponsesDonnees = GTraductions.getValeur('ExecutionQCM.presentationCorrige.reponsesDonnees', [this.executionQCM.nbQuestRepondues, lNbQuestionsTotal, this.executionQCM.nbQuestBonnes]);
            var lNoteObtenue = [];
            if (this.executionQCM.estLieADevoir || (this.executionQCM.estUnTAF && !!this.executionQCM.afficherResultatNote)) {
                lNoteObtenue.push('<div>', GTraductions.getValeur('ExecutionQCM.presentationCorrige.noteObtenue', [this.executionQCM.noteQCM ? this.executionQCM.noteQCM.toString() : '', this.executionQCM.nombreDePoints]), '</div>');
            }
            var lCartoucheCompetences = [];
            if (this.executionQCM.estLieAEvaluation || (this.executionQCM.estUnTAF && !!this.executionQCM.afficherResultatNiveauMaitrise)) {
                if (!!this.executionQCM.listeCompetences && this.executionQCM.listeCompetences.GetNbrElements() > 0) {
                    lCartoucheCompetences.push('<div style="display: inline-block;border: solid 1px #AAA;">');
                    this.executionQCM.listeCompetences.parcourir(function(D) {
                        var lPastilleNiveauAcqui;
                        if (!!D.niveauAcqui) {
                            var lNiveauGlobal = !!GParametres.listeNiveauxDAcquisitions ? GParametres.listeNiveauxDAcquisitions.GetElementParGenre(D.niveauAcqui.GetGenre()) : null;
                            if (!!lNiveauGlobal) {
                                lPastilleNiveauAcqui = EGenreNiveauDAcquisition.getImage(lNiveauGlobal);
                            }
                        }
                        lCartoucheCompetences.push('<div style="padding: 0.2em 0;">', '<span class="InlineBlock AlignementHaut AlignementMilieu" style="width: 50px;">', (lPastilleNiveauAcqui || ''), '</span>', '<span class="InlineBlock AlignementHaut" style="width: calc(100% - 150px);">', D.GetLibelle(), '</span>', '<span class="InlineBlock AlignementHaut" style="width: 100px;">', (D.strPrefixes || ''), '</span>', '</div>');
                    });
                    lCartoucheCompetences.push('</div>');
                }
            }
            lHtml.push('<div style="margin:0 auto 35px">', '<div class="', this._getNomImageTypeExecutionQCM(this.executionQCM), '" style="vertical-align:middle;float:left;">&nbsp;</div>', '<div style="vertical-align:middle;">', lNoteObtenue.join(''), lCartoucheCompetences.join(''), '<div>', lNbReponsesDonnees, '</div>', '</div>', '</div>');
            if (this.executionQCM.dureeMaxQCM) {
                lTrad = 'ExecutionQCM.presentationCorrige.limite_temps';
                lImage = 'Image_QCM_limite_temps';
            } else {
                lTrad = 'ExecutionQCM.presentationCorrige.sans_limite_temps';
                lImage = 'Image_QCM_sans_limite_temps';
            }
            if (lTrad !== '') {
                lHtml.push('<div style="margin:0 auto 35px"><div class="', lImage, '" style="vertical-align:middle;float:left;">&nbsp;</div><div style="vertical-align:middle;">', GTraductions.getValeur(lTrad, [TUtilitaireDuree.dureeEnMin(this.executionQCM.dureeMaxQCM)]), (this.executionQCM.dureeMaxQCM ? ' ' + GTraductions.getValeur('ExecutionQCM.Minutes') : ''), '</div></div>');
            }
            lHtml.push('<div class="card-action">');
            if (!this.executionQCM.estRejouable || GEtatUtilisateur.GenreEspace !== EGenreEspace.Mobile_Eleve) {
                lHtml.push('<button id="', this.idBoutonStart, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.surEvenement({action: \'start\'});" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.presentationCorrige.VisualiserCorrige'), '</button>');
            } else {
                lHtml.push('<button id="', this.idBoutonStart, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.surEvenement({action: \'start\'});" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.presentationCorrige.VisualiserCorrige'), '</button>');
                lHtml.push('<button id="', this.idBoutonNext, '" class="btn waves-effect waves-light" onclick="' + this.Nom + '.surEvenement({action: \'restart\'});" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.presentationCorrige.RecommencerQCM'), '</button>');
            }
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeChrono = function() {
            var lHtml = [];
            lHtml.push('<div id="', this.idValeurChrono, '"></div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeMajChrono = function(aTextTime, aLibelleTime) {
            $('#' + this.idValeurChrono.escapeJQ()).html(aTextTime + '&nbsp;' + aLibelleTime);
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageBarreProgression = function() {
            var lHtml = [];
            lHtml.push('<div class="subheader">', GTraductions.getValeur('ExecutionQCM.Navigation'), '</div>');
            lHtml.push('<ul class="collection" style="overflow:auto">');
            for (var i = 0; i < this.nbQuestions; i++) {
                var lBackColor = this.getCouleurPointProgression(i);
                lHtml.push('<li id="' + this.idProgression + i + '" class="collection-item">', (this.executionQCM.autoriserLaNavigation ? '<a>' : ''), '<span style="background-color:' + lBackColor + ';width:10px;height:10px;margin-right:15px;" class="InlineBlock AlignementMilieuVertical">&nbsp;</span>', GTraductions.getValeur('ExecutionQCM.QuestionXSurY', [UtilitaireQCM.composeNumerotation(this.typeNumerotation, i + 1), UtilitaireQCM.composeNumerotation(this.typeNumerotation, this.nbQuestions)]), (this.executionQCM.autoriserLaNavigation ? '</a>' : ''), '</li>');
            }
            lHtml.push('</ul>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeBarreProgression = function() {};
        ObjetVisuEleve_Mobile.prototype.ajouterEvenementBarreProgression = function() {
            $('#' + this.idWrapperBarreProgression.escapeJQ() + ' li[id^="' + this.idProgression + '"]').addClass('AvecMain');
            $('#' + this.idWrapperBarreProgression.escapeJQ()).off('click');
            $('#' + this.idWrapperBarreProgression.escapeJQ()).on('click', 'li[id^="' + this.idProgression + '"]', {
                aObjet: this
            }, function(event) {
                var lIndice = this.id.match(/_([0-9]+)$/i)[1],
                    lThis = event.data.aObjet;
                lThis.indiceQuestion = parseInt(lIndice);
                lThis.recupererQuestion();
                var lParam = {
                    action: 'fermerNavigation'
                };
                lThis.Evenement.call(lThis.Pere, lParam);
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeQuestion = function() {
            this.evaluationNote[this.indiceQuestion] = {
                validee: false
            };
            var lAvecAffichageNbPoints = (this.executionQCM.estLieADevoir || (this.executionQCM.estUnTAF && this.executionQCM.afficherResultatNote));
            var lHtml = [];
            lHtml.push('<div class="card">');
            lHtml.push('<div class="card-content">');
            lHtml.push('<div id="', this.idWrapperTitre, this.indiceQuestion, '" class="card-title">', '<table cellpadding="0" cellspacing="0" style="border:0;width:100%"><tr>', '<td style="vertical-align: top; white-space: nowrap;font-size:15px;font-style:normal;">', '<span id="', this.idNbPoint, this.indiceQuestion, '" style="display:none;"></span>', (!lAvecAffichageNbPoints ? '' : ('<span id="' + this.idSlashNbPoint + this.indiceQuestion + '" style="display:none;">/</span><span style="">' + this.question.note + ' ' + (parseInt(this.question.note) === 1 ? GTraductions.getValeur('ExecutionQCM.Point') : GTraductions.getValeur('ExecutionQCM.Points')) + '</span>')), '</td>', '<td style="vertical-align: top;width:100%;text-align:right;">', (this.executionQCM.dureeMaxQCM ? this.composeChrono().join('') : ''), '</td>', '</tr><tr>', '<td style="vertical-align: top; white-space: nowrap;text-align:left;">', GTraductions.getValeur('QCM.QuestionLibelle'), ' ', UtilitaireQCM.composeNumerotation(this.typeNumerotation, this.indiceQuestion + 1), '&nbsp;:&nbsp;</td>', '<td style="vertical-align: top;width:100%;text-align:left;">', this.question.GetLibelle(), '</td>', '</tr></table>', '</div>');
            lHtml.push('<div id="', this.idWrapperQuestion, this.indiceQuestion, '" style="padding:0.5rem;' + (this.affichageUnePage ? '' : 'overflow:auto;') + '">');
            lHtml.push('<div id="', this.idWrapperEnonce, this.indiceQuestion, '" class="GrandEspaceBas" style="overflow:auto;line-height:110%;">', this.composeEnonce(this, this.question));
            if (this.question.image) {
                lHtml.push('<div class="GrandEspaceHaut GrandEspaceBas"><img alt="" style="width:100%;" src="data:image/png;base64,', this.question.image, '" onerror="$(this).parent().html(GTraductions.getValeur(\'ExecutionQCM.ImageNonSupportee\'));" /></div>');
            }
            if (this.question.mp3name && this.question.mp3name !== '' && this.question.mp3 && this.question.mp3 !== '') {
                lHtml.push('<audio onclick="event.stopImmediatePropagation()" id="', this.idMp3Question, this.indiceQuestion, '" style="padding:3px;" src="data:audio/mp3;base64,', this.question.mp3, '">' + GTraductions.getValeur('ExecutionQCM.AudioNonSupporte') + '</audio>');
                lHtml.push('<div id="', this.idMp3Control, this.indiceQuestion, '"  style="" class="InlineBlock"><span class="InlineBlock Image_QCM_Son_Play"></span> ', this.question.mp3name, '</div>');
            }
            if (this.question.url && this.question.url !== '') {
                lHtml.push('<div style=""><div class="Image_QCM_Site InlineBlock AlignementMilieuVertical" style="width:18px;height:18px;"></div><a class="AlignementMilieuVertical" href="' + this.question.url + '" target="_blank">' + this.question.url + '</a></div>');
            }
            lHtml.push('</div>');
            lHtml.push('<div id="', this.idWrapperReponses, this.indiceQuestion, '" class="">');
            lHtml = lHtml.concat(this.composeReponses(this, this.question));
            lHtml.push('</div>');
            if (this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer || this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer) {
                lHtml.push('<div id="', this.idWrapperCorrigeQuest, this.indiceQuestion, '" class="" style="margin-top:10px;">');
                lHtml.push('<div class="card-title" style="display:none;">' + GTraductions.getValeur('ExecutionQCM.LabelCorrige') + '</div>');
                lHtml.push('</div>');
            }
            if (this.question.editeur && this.question.editeur.existeNumero()) {
                lHtml.push('<div class="" style="font-size:70%;text-align:right;color:' + GCouleur.fenetre.texte + ';">' + GTraductions.getValeur('ExecutionQCM.CopyRightEditeur2013', [this.question.editeur.GetLibelle()]) + '</div>');
            }
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeRessentiEtoile = function() {
            var lHtml = [],
                i;
            lHtml.push('<div class="card">');
            lHtml.push('<div class="card-content">');
            lHtml.push('<div id="', this.idWrapperTitre, this.indiceQuestion, '" class="card-title">' + GTraductions.getValeur('ExecutionQCM.TitreRessenti') + '</div>');
            lHtml.push('<div id="', this.idWrapperQuestion, this.indiceQuestion, '" style="overflow:auto;">');
            lHtml.push('<div id="', this.idWrapperEnonce, this.indiceQuestion, '" class="Texte12" style="overflow:auto;">');
            lHtml.push('<div style="font-size:50px;text-align:center;height:50px;line-height:50px;padding:10px;">');
            for (i = 1; i <= 5; i++) {
                lHtml.push('<span class="AvecMain InlineBlock Image_QCM_Etoile_Off" id="', this.idRessenti, '_', i, '">&nbsp;</span>');
            }
            lHtml.push('</div>');
            lHtml.push('<div class="Texte24" style="text-align:center;padding:10px;">');
            var lLargMax = 0;
            for (i = 1; i <= 5; i++) {
                lLargMax = Math.max(lLargMax, GChaine.GetLongueurChaineDansDiv(GTraductions.getValeur('ExecutionQCM.valeurRessenti')[i - 1], 24));
            }
            lHtml.push(GTraductions.getValeur('ExecutionQCM.phraseRessenti'));
            lHtml.push('<span id="', this.idTexteRessenti, '" class="InlineBlock AlignementGauche" style="width:', lLargMax, 'px;"></span>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeRessenti = function() {
            var lHtml = [];
            lHtml.push('<div class="card">');
            lHtml.push('<div class="card-content">');
            lHtml.push('<div id="', this.idWrapperTitre, this.indiceQuestion, '" class="card-title">' + GTraductions.getValeur('ExecutionQCM.TitreRessenti') + '</div>');
            lHtml.push('<div id="', this.idWrapperQuestion, this.indiceQuestion, '" style="overflow:auto;">');
            lHtml.push('<div id="', this.idWrapperEnonce, this.indiceQuestion, '" class="" style="overflow:auto;">');
            lHtml.push('<div style="font-size:200%;text-align:center;padding:20px 0;">');
            lHtml.push('<div class="AlignementMilieuVertical" style="height:100%;">', GTraductions.getValeur('ExecutionQCM.phraseRessenti'), '</div>');
            lHtml.push('<span class="AvecMain InlineBlock AlignementMilieuVertical" id="', this.idRessenti, '_0" style="text-align:center;color:', GCouleur.grisFonce, ';margin-right:10px;">', GTraductions.getValeur('ExecutionQCM.valeurRessenti')[3], '</span>');
            lHtml.push('<span class="AvecMain InlineBlock AlignementMilieuVertical" id="', this.idRessenti, '_1" style="text-align:center;color:', GCouleur.grisFonce, ';margin-left:10px;">', GTraductions.getValeur('ExecutionQCM.valeurRessenti')[1], '</span>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeNavigation = function() {
            var lAvecAffichagePrecedent = (this.executionQCM.autoriserLaNavigation && this.indiceQuestion > 0);
            var lAvecAffichageSuivant = false;
            if ((this.executionQCM.autoriserLaNavigation && this.estEnCours()) || this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) {
                lAvecAffichageSuivant = true;
            }
            var lHtml = [];
            lHtml.push('<div><table id="', this.idWrapperNavigation, this.indiceQuestion, '" style="width:100%;height:100%;"><tr>');
            lHtml.push('<td>');
            if (lAvecAffichagePrecedent) {
                lHtml.push('<button id="', this.idBoutonPrev, this.indiceQuestion, '" class="btn waves-effect waves-light" style="width: 120px;" onclick="' + this.Nom + '.surEvenement({action: \'prev\'});" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.JeReviens'), '</button>');
            } else {
                lHtml.push('<div style="width:50px;">&nbsp;</div>');
            }
            lHtml.push('</td>');
            lHtml.push('<td style="width:100%; text-align:center;">');
            lHtml.push('<button id="', this.idBoutonSubmit, this.indiceQuestion, '" class="btn waves-effect waves-light" style="', (this.estEnRessenti() ? 'display:none;' : ''), '" onclick="' + this.Nom + '.surEvenement({action: \'submit\'});" tabIndex="0">' + (this.estEnCours() ? GTraductions.getValeur('ExecutionQCM.Valider') : GTraductions.getValeur('ExecutionQCM.Terminer')) + '</button>');
            lHtml.push('</td>');
            lHtml.push('<td>');
            if (lAvecAffichageSuivant) {
                var lMasquerSuivant = (!this.executionQCM.autoriserLaNavigation && this.executionQCM.modeDiffusionCorrige === TypeModeCorrectionQCM.FBQ_CorrigeApresQuestion) || (this.executionQCM && this.indiceQuestion >= this.nbQuestions);
                lHtml.push('<button id="', this.idBoutonNext, this.indiceQuestion, '" class="btn waves-effect waves-light" style="width: 120px;', (lMasquerSuivant ? 'display:none;' : ''), '" onclick="' + this.Nom + '.surEvenement({action: \'next\'});" tabIndex="0">', GTraductions.getValeur('ExecutionQCM.JePasse'), '</button>');
            } else {
                lHtml.push('<div style="width:50px;">&nbsp;</div>');
            }
            lHtml.push('</td>');
            lHtml.push('</tr></table></div>');
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSingleMultiVraiCoche = function(aSelecteur, aSansCorrige) {
            $('#' + $(aSelecteur).attr('id').replace('_r', '_div_r').escapeJQ()).addClass('Image_QCM_CocheVerte').css({
                backgroundPosition: 'right top',
                width: '100%',
                height: 'auto'
            });
            if (!aSansCorrige) {
                var lMatch = $(aSelecteur).attr('id').match(/_q([0-9]+)_r([0-9]+)$/i);
                var lNumQuest = lMatch[1];
                var lNumRep = lMatch[2];
                $('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()).children('div:first').show().end().append(this.composeSingleMulti(this, this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice ? 'radio' : 'checkbox', this.question.listeReponses.GetElement(lNumRep), lNumRep, true, false, true).join(''));
                var lJqDivs = $('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()).children('div:gt(0)');
                lJqDivs.sort(function(a, b) {
                    if (a.id === b.id) {
                        return 0;
                    } else if (parseInt(a.id.match(/_r([0-9]+)$/i)[1]) < parseInt(b.id.match(/_r([0-9]+)$/i)[1])) {
                        return -1;
                    } else {
                        return 1;
                    }
                });
                lJqDivs.detach().appendTo($('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()));
            }
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSingleMultiFauxNonCoche = function() {};
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSingleMultiVraiNonCoche = function(aSelecteur) {
            var lMatch = $(aSelecteur).attr('id').match(/_q([0-9]+)_r([0-9]+)$/i);
            var lNumQuest = lMatch[1];
            var lNumRep = lMatch[2];
            $('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()).children('div:first').show().end().append(this.composeSingleMulti(this, this.question.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice ? 'radio' : 'checkbox', this.question.listeReponses.GetElement(lNumRep), lNumRep, true, false, true).join(''));
            var lJqDivs = $('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()).children('div:gt(0)');
            lJqDivs.sort(function(a, b) {
                if (a.id === b.id) {
                    return 0;
                } else if (parseInt(a.id.match(/_r([0-9]+)$/i)[1]) < parseInt(b.id.match(/_r([0-9]+)$/i)[1])) {
                    return -1;
                } else {
                    return 1;
                }
            });
            lJqDivs.detach().appendTo($('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()));
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSingleMultiFauxCoche = function(aSelecteur) {
            $('#' + $(aSelecteur).attr('id').replace('_r', '_div_r').escapeJQ()).addClass('Image_QCM_CocheRouge').css({
                backgroundPosition: 'right top',
                width: '100%',
                height: 'auto'
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSingleMultiFeedback = function(aSelecteur, aCouleur, aFeedback) {
            $(aSelecteur).next().after('<span class="GrandEspaceGauche Italique" style="color:' + aCouleur + ';">&rarr;&nbsp;' + aFeedback + '</span>');
        };
        ObjetVisuEleve_Mobile.prototype.desactiveEventSingleMulti = function(aIndiceQuestion) {
            $('[id^="' + this.Nom + '_q' + aIndiceQuestion + '_r"]').each(function() {
                $(this).attr('disabled', 'disabled');
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeShortVrai = function(aSelecteur) {
            $(aSelecteur).addClass('Image_QCM_CocheVerte').css({
                backgroundPosition: 'right center',
                width: '100%',
                height: 'auto'
            }).prop('readonly', true);
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeShortFaux = function(aSelecteur, aReponse) {
            $(aSelecteur).addClass('Image_QCM_CocheRouge').css({
                backgroundPosition: 'right center',
                width: '100%',
                height: 'auto'
            }).prop('readonly', true);
            var lMatch = $(aSelecteur).attr('id').match(/_q([0-9]+)_r([0-9]+)$/i);
            var lNumQuest = lMatch[1];
            $('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()).children('div:first').show().end().append('<div>' + aReponse + '</div>');
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeShortFeedback = function(aSelecteur, aCouleur, aFeedback) {
            $(aSelecteur).parent().after('<span class="GrandEspaceGauche Italique Texte12" style="color:' + aCouleur + ';">' + aFeedback + '</span>');
        };
        ObjetVisuEleve_Mobile.prototype.desactiveEventShort = function(aIndiceQuestion) {
            var lJqInput = $('#' + this.Nom.escapeJQ() + '_q' + aIndiceQuestion + '_r0');
            lJqInput.on('click focus', function(aEvent) {
                $(this).blur();
                aEvent.preventDefault();
                aEvent.stopImmediatePropagation();
                return false;
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSpellVrai = function(aSelecteur) {
            $(aSelecteur).last().parent().parent().append('&nbsp;<span class="InlineBlock AlignementMilieuVertical Image_QCM_CocheVerte"></span>');
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSpellFaux = function(aSelecteur, aBonneReponse) {
            $(aSelecteur).last().parent().parent().append('&nbsp;<span class="InlineBlock AlignementMilieuVertical Image_QCM_CocheRouge"></span>');
            var lMatch = $(aSelecteur).attr('name').match(/_q([0-9]+)_r$/i);
            var lNumQuest = lMatch[1];
            $('#' + (this.idWrapperCorrigeQuest + lNumQuest).escapeJQ()).children('div:first').show().end().append('<div>' + aBonneReponse + '</div>');
        };
        ObjetVisuEleve_Mobile.prototype.composeAffichageCorrigeSpellFeedback = function(aSelecteur, aCouleur, aFeedback) {
            $(aSelecteur).last().parent().parent().append('<span class="GrandEspaceGauche Italique" style="color:' + aCouleur + ';">' + aFeedback + '</span>');
        };
        ObjetVisuEleve_Mobile.prototype.desactiveEventSpell = function(aIndiceQuestion) {
            $('#' + this.idWrapperReponses.escapeJQ() + aIndiceQuestion).find('input[type="text"]').on('click focus', function(aEvent) {
                $(this).blur();
                aEvent.preventDefault();
                aEvent.stopImmediatePropagation();
                return false;
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeCorrigeMatching = function() {};
        ObjetVisuEleve_Mobile.prototype.composeAffichageReponseCorrigeMatching = function() {};
        ObjetVisuEleve_Mobile.prototype.composeCorrigeReponseCorrigeMatching = function(aSelecteur, aId, aBonneReponse, aCorrige, aCouleur) {
            var lJqSelect = $('#' + aId.replace('_c', '_drop').escapeJQ()).find('select');
            var lTexte = lJqSelect.val();
            lJqSelect.formSelect('destroy');
            lJqSelect.replaceWith('<input class="' + (aBonneReponse ? 'Image_QCM_CocheVerte' : 'Image_QCM_CocheRouge') + '" style="background-position:right center;width:100%;height:auto;" readonly value="' + lTexte + '" />');
            if (!aBonneReponse) {
                $('#' + aId.escapeJQ()).append('<div class="InlineBlock" style="vertical-align: top;color:' + aCouleur + ';">' + aCorrige + '</div>');
            }
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeCorrigeReponseCorrigeMatching = function() {};
        ObjetVisuEleve_Mobile.prototype.desactiveEventMatching = function() {
            $('[id^="' + this.Nom + '_q' + this.indiceQuestion + '_drop"]').each(function() {
                $(this).children('select').attr('disabled', 'disabled').formSelect();
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeReponseCorrigeCloze = function(aSelecteur, aCouleur, aTexte) {
            if ($(aSelecteur).is('input')) {
                $(aSelecteur).addClass(aCouleur === this.couleurFaux ? 'Image_QCM_CocheRouge' : 'Image_QCM_CocheVerte').css({
                    backgroundPosition: 'right center',
                    width: '100%',
                    height: 'auto'
                }).prop('readonly', true);
            } else if ($(aSelecteur).is('select')) {
                $(aSelecteur).formSelect('destroy');
                $(aSelecteur).replaceWith('<input class="' + (aCouleur === this.couleurFaux ? 'Image_QCM_CocheRouge' : 'Image_QCM_CocheVerte') + '" style="background-position:right center;width:100%;height:auto;" readonly value="' + aTexte + '" />');
            }
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeWrapperEnonceCloze = function(aSelecteur) {
            $(aSelecteur).wrapInner('<div style="padding-bottom:15px;margin-bottom:15px;"></div>');
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeWrapperCorrigeCloze = function(aSelecteur, aTexte) {
            $(aSelecteur).append('<div><div class="card-title">' + GTraductions.getValeur('ExecutionQCM.LabelCorrige') + '</div><div>' + aTexte + '</div></div>');
        };
        ObjetVisuEleve_Mobile.prototype.composeMiseEnFormeCorrectionCorrigeCloze = function(aTexte, aStyle) {
            return '<span style="' + aStyle + '">' + aTexte + '</span>';
        };
        ObjetVisuEleve_Mobile.prototype.desactiveEventCloze = function(aIndiceQuestion) {
            $('#' + this.idWrapperEnonce.escapeJQ() + aIndiceQuestion).find('select, input[type="text"]').on('click focus', function(aEvent) {
                $(this).blur();
                aEvent.preventDefault();
                aEvent.stopImmediatePropagation();
                return false;
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeMajReponsesSingleMulti = function(aSelecteur, aSelected) {
            $(aSelecteur).attr('checked', aSelected);
        };
        ObjetVisuEleve_Mobile.prototype.composeMajReponsesShort = function(aSelecteur, aTexte) {
            $(aSelecteur).val(GChaine.enleverEntites(aTexte));
        };
        ObjetVisuEleve_Mobile.prototype.composeMajReponsesSpell = function(aSelecteur, aTexte) {
            $(aSelecteur).each(function(lIndex) {
                $(this).val(GChaine.enleverEntites(aTexte[lIndex] || ''));
            });
        };
        ObjetVisuEleve_Mobile.prototype.composeMajReponsesMatching = function(aSelDrop, aBaseSelDrag, aReponse, aUsedIndex, aAsymetrie) {
            var lJqDrop = $(aSelDrop);
            if (aAsymetrie) {
                lJqDrop.find('select').val(aReponse);
                lJqDrop.find('select').formSelect();
            } else {
                var lOptions = lJqDrop.find('select').get(0).options;
                for (var x in lOptions) {
                    if ($.inArray(x, aUsedIndex) === -1) {
                        if (lOptions[x].value === aReponse) {
                            lJqDrop.find('select').get(0).selectedIndex = x;
                            lJqDrop.find('select').formSelect();
                            return x;
                        }
                    }
                }
            }
        };
        ObjetVisuEleve_Mobile.prototype.composeMajReponsesCloze = function(aSelecteur, aReponse) {
            $(aSelecteur).val(aReponse);
        };
        ObjetVisuEleve_Mobile.prototype.getReponseMatching = function(aSelecteur) {
            return $(aSelecteur).find('select').val();
        };
        ObjetVisuEleve_Mobile.prototype.composeEnonce = function(aThis, aQuestion) {
            var lEnonceHtml = aQuestion.enonce;
            var lIndice = 0,
                lResponse;
            if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField || aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeFixed || aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeVariable) {
                lEnonceHtml = lEnonceHtml.replace(/&#039;/gi, '&apos;');
                if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ClozeField && aQuestion.enonce.match(/{#}/gi)) {
                    lEnonceHtml = lEnonceHtml.replace(/{#}/gi, '<input type="text" id="' + aThis.Nom + '_q' + aThis.indiceQuestion + '_r' + (lIndice++) + '" />');
                } else if (aQuestion.listeReponses && aQuestion.listeReponses.GetNbrElements() && aQuestion.listeReponses.GetNbrElements() === aQuestion.enonce.match(/{#}/gi).length) {
                    for (var i = 0; i < aQuestion.listeReponses.GetNbrElements(); i++) {
                        lEnonceHtml = lEnonceHtml.replace('{#}', '<select id="' + aThis.Nom + '_q' + aThis.indiceQuestion + '_r' + i + '"><option value=""></option>' + $.map(aQuestion.listeReponses.GetElement(i).listeChoix, function(val) {
                            return '<option value="' + val + '">' + val + '</option>';
                        }).join('') + '</select>');
                    }
                } else {
                    var lThis = this;
                    lEnonceHtml = lEnonceHtml.replace(/{[0-9]*:(ShortAnswer|MultiChoice):(~*(%[0-9]{1,3}%|=)?[^~%#{}]+#?[^~%#{}]*)+}/gi, function(ele) {
                        var lHtml = '';
                        var lSpans = [];
                        if (ele.search(/:multichoice:/gi) > -1) {
                            lHtml = '<span style="border:' + GCouleur.noir + ' 1px solid;">';
                            var lResponses = ele.match(/((multichoice:|shortanswer:|~)(%[0-9]{1,3}%|=)?[^~%#{}]+#?[^~%#{}]*)/gi);
                            for (var x in lResponses) {
                                if (!$.isNumeric(x)) {
                                    continue;
                                }
                                lResponses[x] = lResponses[x].replace(/^(multichoice:|shortanswer:)/i, '');
                                lResponses[x] = lResponses[x].replace(/^(:|~)?=/, '%100%');
                                lResponses[x] = lResponses[x].replace(/^(:|~)?([^~%#{}])/, '%0%$2');
                                lResponse = lResponses[x].split('%');
                                lResponse.splice(2, 1, lResponse[2].split('#')[0], lResponse[2].split('#')[1]);
                                lSpans.push('<span style="color:' + (lResponse[1] === '100' ? lThis.couleurBonneReponse : lThis.couleurFausseReponse) + ';">' + lResponse[2] + '</span>');
                            }
                            lHtml += lSpans.join(' | ');
                            lHtml += '</span>';
                        } else {
                            lResponse = ele.match(/(?:multichoice:|shortanswer:|~)(?:%100%|=)([^~%#{}]+)#?[^~%#{}]*/i);
                            lHtml = '<span style="color:' + lThis.couleurBonneReponse + ';border:' + lThis.couleurBonneReponse + ' 1px solid;">' + lResponse[1] + '</span>';
                        }
                        return lHtml;
                    });
                }
            }
            return lEnonceHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeReponses = function(aThis, aQuestion, aAvecReponse, aAvecFeedback) {
            var lHtml = [],
                lReponse, i;
            if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice || aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_MultiChoice) {
                var lType = 'checkbox';
                if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SingleChoice) {
                    lType = 'radio';
                }
                for (i = 0; i < aQuestion.listeReponses.GetNbrElements(); i++) {
                    lReponse = aQuestion.listeReponses.GetElement(i);
                    if (!lReponse.Existe()) {
                        continue;
                    }
                    lHtml = lHtml.concat(this.composeSingleMulti(aThis, lType, lReponse, i, aAvecReponse, aAvecFeedback, false));
                }
            } else if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_ShortAnswer || aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_NumericalAnswer) {
                if (aAvecReponse && aQuestion.listeReponses.GetNbrElements()) {
                    lHtml.push('<ul>');
                    for (i = 0; i < aQuestion.listeReponses.GetNbrElements(); i++) {
                        lReponse = aQuestion.listeReponses.GetElement(i);
                        if (!lReponse.Existe()) {
                            continue;
                        }
                        lHtml.push('<li>');
                        lHtml.push(lReponse.GetLibelle());
                        if (aAvecFeedback && lReponse.feedback !== '') {
                            lHtml.push('<span style="color:' + (lReponse.bonneReponse ? this.couleurBonneReponse : this.couleurFausseReponse) + ';" class="EspaceGauche">&#x27AA;&nbsp;' + lReponse.feedback + '</span>');
                        }
                        lHtml.push('</li>');
                    }
                    lHtml.push('</ul>');
                } else {
                    lHtml.push('<input type="text" id="', aThis.Nom, '_q', aThis.indiceQuestion, '_r0" style="width:50%;" maxlength="35"/>');
                }
            } else if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_Matching && !aAvecReponse) {
                var lProp = [];
                var lAnswer = [];
                var lReponses = [];
                lAnswer.push('<option value=""></option>');
                for (i = 0; i < this.question.listeReponses.GetNbrElements(); i++) {
                    lReponse = this.question.listeReponses.GetElement(i);
                    lProp.push('<div id="' + this.Nom + '_q' + this.indiceQuestion + '_assoc' + i + '" style="padding:5px 10px;border:#ccc 1px solid;margin:5px;">' + '<div id="' + this.Nom + '_q' + this.indiceQuestion + '_assoc' + i + '" style="">' + lReponse.GetLibelle() + '</div>' + '<div id="' + this.Nom + '_q' + this.indiceQuestion + '_drop' + i + '" style=""><select id="' + this.Nom + '_q' + this.indiceQuestion + '_r' + i + '">');
                    if ($.inArray(lReponse.association, lReponses) === -1) {
                        lAnswer.push('<option value="', lReponse.association, '">', lReponse.association, '</option>');
                        lReponses.push(lReponse.association);
                    }
                }
                for (i = 0; i < this.question.listeReponses.GetNbrElements(); i++) {
                    lProp[i] += lAnswer.join('') + '</select></div><div id="' + this.Nom + '_q' + this.indiceQuestion + '_c' + i + '"></div></div>';
                }
                lHtml = lHtml.concat(['<div>'], lProp, ['</div>']);
            } else if (aQuestion.GetGenre() === TypeGenreExerciceDeQuestionnaire.GEQ_SpellAnswer) {
                lReponse = aQuestion.listeReponses.GetElement(0);
                if (lReponse && aAvecReponse) {
                    lHtml.push($.map(lReponse.GetLibelle().split(''), function(aVal) {
                        return '<span class="Texte10 EspaceDroit InlineBlock" style="width:9px;text-align:center;border:0;border-bottom:1px #000 solid;margin-right:5px;padding:0;">' + aVal + '</span>';
                    }).join(''));
                    if (aAvecFeedback && lReponse.feedback !== '') {
                        lHtml.push('<span style="color:' + (this.couleurBonneReponse) + ';" class="EspaceGauche">&#x27AA;&nbsp;' + lReponse.feedback + '</span>');
                    }
                } else if (lReponse) {
                    lHtml.push($.map(lReponse.GetLibelle().split(''), function() {
                        return '<input name="' + aThis.Nom + '_q' + aThis.indiceQuestion + '_r" type="text" maxLength="1" size="1"' + ' style="text-align: center; width:22px;"' + ' onkeyup="if($(this).val() !== \'\' && $(this).next(\'input\')) $(this).next(\'input\').focus();"' + ' onkeydown="if(event.keyCode === require(\'ToucheClavier.js\').Backspace && $(this).val() === \'\' && $(this).prev(\'input\')) $(this).prev(\'input\').focus().val(\'\');"' + ' />';
                    }).join('&nbsp;'));
                }
            }
            return lHtml;
        };
        ObjetVisuEleve_Mobile.prototype.composeSingleMulti = function(aThis, aType, aReponse, aIndiceReponse, aAvecReponse, aAvecFeedback, aPourCorrige) {
            var lHtml = [];
            lHtml.push('<div class="" id="', aThis.Nom, '_q', aThis.indiceQuestion, '_div_r', aIndiceReponse, '">');
            var lChecked = (aAvecReponse && aReponse.bonneReponse ? ' checked="checked"' : '') + (aPourCorrige ? ' disabled="disabled"' : '');
            lHtml.push('<div>');
            var lIdInput = aThis.Nom + '_q' + aThis.indiceQuestion + '_r' + aIndiceReponse;
            var lNameInput = aThis.Nom + '_q' + aThis.indiceQuestion;
            lHtml.push('<label>', '<input type="', aType, '" class="with-gap" ', (!aPourCorrige ? 'id="' + lIdInput + '" name="' + lNameInput + '"' : ''), lChecked, ' />', (!aReponse.editionAvancee ? ('<span' + (!aPourCorrige ? ' for="' + lIdInput + '"' : '') + '>' + aReponse.GetLibelle() + '</span>') : '<span>&nbsp;</span>'), '</label>');
            if (!!aReponse.editionAvancee) {
                lHtml.push('<div>', aReponse.libelleHtml, '</div>');
            }
            if (aAvecFeedback && aReponse.feedback !== '') {
                lHtml.push(' <span style="color:' + (aReponse.bonneReponse ? this.couleurBonneReponse : this.couleurFausseReponse) + ';" class="EspaceGauche">&#x27AA;&nbsp;' + aReponse.feedback + '</span>');
            }
            if (aReponse.image) {
                lHtml.push('<div style="padding:3px;"><img src="data:image/png;base64,' + aReponse.image + '" style="width:100%;" onerror="$(this).parent().html(GTraductions.getValeur(\'ExecutionQCM.ImageNonSupportee\'));"', (aThis.actualiserHauteurReponse ? 'onload="' + aThis.Nom + '.actualiserHauteurReponse(\'' + aThis.Nom + '_q' + aThis.indiceQuestion + '_div_r' + aIndiceReponse + '\');"' : ''), ' /></div>');
            }
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml;
        };
        module.exports = ObjetVisuEleve_Mobile;
    },
    fn: "mobile/script/pageqcm.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');

        function ObjetRequeteQCMQuestions() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('ListeQCMQuestions', ObjetRequeteQCMQuestions, ObjetRequeteConsultation);
        ObjetRequeteQCMQuestions.prototype.lancerRequete = function(aParam) {
            this.JSON = {
                element: aParam.element,
                indiceQuestion: aParam.indiceQuestion,
                eleve: aParam.eleve,
                verrouUniquement: ((aParam.verrouUniquement !== null) && (aParam.verrouUniquement !== undefined)) ? aParam.verrouUniquement : false,
                pourSelectionQuestions: ((aParam.pourSelectionQuestions !== null) && (aParam.pourSelectionQuestions !== undefined)) ? aParam.pourSelectionQuestions : false
            };
            return this.appelAsynchrone();
        };
        ObjetRequeteQCMQuestions.prototype.actionApresRequete = function() {
            var lParam = {};
            if (this.JSONReponse.message) {
                lParam.message = this.JSONReponse.message;
            } else {
                lParam.QCM = new ObjetElement().fromJSON(this.JSONReponse.QCM);
                lParam.QCM.copieJSON(this.JSONReponse.QCM);
                lParam.QCM.listeQuestions = new ObjetListeElements().fromJSON(this.JSONReponse.QCM.listeQuestions, this._ajouterQuestion.bind(this));
            }
            this.callbackReussite.appel(lParam);
        };
        ObjetRequeteQCMQuestions.prototype._ajouterQuestion = function(aJSON, aElement) {
            aElement.copieJSON(aJSON);
            aElement.nouvellePosition = aElement.position;
            if (aJSON.listeReponses) {
                aElement.listeReponses = new ObjetListeElements().fromJSON(aJSON.listeReponses, this._ajouterReponse.bind(this));
            }
        };
        ObjetRequeteQCMQuestions.prototype._ajouterReponse = function(aJSON, aElement) {
            aElement.copieJSON(aJSON);
        };
        module.exports = ObjetRequeteQCMQuestions;
    },
    fn: "objetrequeteqcmquestions.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');
        var ObjetListeElements = require('ObjetListeElements.js');

        function ObjetRequeteSaisieQCMReponses() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieQCMReponses', ObjetRequeteSaisieQCMReponses, ObjetRequeteSaisie);
        ObjetRequeteSaisieQCMReponses.prototype.lancerRequete = function(aParam) {
            this.JSON = {
                executionQCM: aParam.element,
                indiceQuestion: aParam.indiceQuestion,
                reponse: aParam.reponse,
                ressenti: aParam.ressenti,
                pourInitialisation: aParam.pourInitialisation,
                pourCloture: aParam.pourCloture
            };
            return this.appelAsynchrone();
        };
        ObjetRequeteSaisieQCMReponses.prototype.actionApresRequete = function() {
            var lParam = {};
            if (this.JSONReponse.etatCloture !== undefined) {
                lParam.etatCloture = this.JSONReponse.etatCloture;
            }
            if (this.JSONReponse.listeQuestions) {
                lParam.listeQuestions = new ObjetListeElements().fromJSON(this.JSONReponse.listeQuestions, this._ajouterQuestion.bind(this));
            }
            this.callbackReussite.appel(lParam);
        };
        ObjetRequeteSaisieQCMReponses.prototype._ajouterQuestion = function(aJSON, aElement) {
            aElement.copieJSON(aJSON);
            if (aJSON.listeReponses) {
                aElement.listeReponses = new ObjetListeElements().fromJSON(aJSON.listeReponses, this._ajouterReponse.bind(this));
            }
        };
        ObjetRequeteSaisieQCMReponses.prototype._ajouterReponse = function(aJSON, aElement) {
            aElement.copieJSON(aJSON);
        };
        module.exports = ObjetRequeteSaisieQCMReponses;
    },
    fn: "objetrequetesaisieqcmreponses.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetVisuEleve_Mobile = require('mobile/script/PageQCM.js');
        var ObjetRequeteQCMQuestions = require('ObjetRequeteQCMQuestions.js');
        var MethodesObjet = require('MethodesObjet.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetRequeteSaisieQCMReponses = require('ObjetRequeteSaisieQCMReponses.js');
        var ZoneFenetre = require('IEZoneFenetre.js');
        var GHtml = require('GHtml.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageQCM, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageQCM() {
            this.inheritedCreate(arguments);
            this.idBandeau = this.Nom + '.bandeau';
            this.idTitreQCM = this.Nom + '.titreQCM';
            this.idBoutonsQCM = this.Nom + '.boutonsQCM';
            this.idBoutonBack = this.Nom + '.boutonBack';
            this.idBoutonNav = this.Nom + '.boutonNav';
            this.idSideNav = this.Nom + '_idSideNav';
            this.idVisuEleve = this.Nom + '.objetVisuEleve';
            this.objetVisuEleve = new ObjetVisuEleve_Mobile(this.idVisuEleve, null, this, this.evenementQCM);
            this.objetVisuEleve.setParametres({
                idContenu: this.idVisuEleve.escapeJQ()
            });
            this.objetVisuEleve.idWrapperBarreProgression = this.idSideNav;
            this.ongletPrec = null;
            this.couleurThemeQCM = '#62acc5';
            this.couleurThemeQCMFonce = '#428ca5';
        }
        ObjetAffichagePageQCM.prototype.ConstruireInstances = function() {
            this.GenreStructure = EStructureAffichage.Autre;
        };
        ObjetAffichagePageQCM.prototype.getControleur = function(aInstance) {
            return {
                getNodeAffichage: function() {
                    GHtml.addHtml(ZoneFenetre.getElementZoneFenetre(), ['<div id="', aInstance.idSideNav, '" class="sidenav"></div>'].join(''));
                    var lSelec = '#' + aInstance.idSideNav.escapeJQ();
                    $(lSelec).sidenav({
                        edge: 'right',
                        closeOnClick: false,
                        draggable: true
                    });
                    $(this.node).on('destroyed', function() {
                        $(lSelec).remove();
                    });
                }
            };
        };
        ObjetAffichagePageQCM.prototype.ConstruireStructureAffichageAutre = function() {
            var lHtml = [];
            lHtml.push('<div style="position:relative;width:100%;" ie-node="getNodeAffichage">');
            lHtml.push('<div id="' + this.idBandeau + '" class="navbar-fixed">');
            lHtml.push('<nav>');
            lHtml.push('<div class="nav-wrapper">');
            lHtml.push('<div><div><div id="' + this.idTitreQCM + '"></div></div></div>');
            lHtml.push('<ul>');
            lHtml.push('<li><a id="' + this.idBoutonBack + '" onclick="', this.Nom, '.fermer();"><i class="ico-mobile icon_retour_mobile" style="line-height:56px;"></i></a></li>');
            lHtml.push('<li><a id="' + this.idBoutonNav + '" onclick="', this.Nom, '.ouvrirNavigation();"><i class="material-icons icon_list_alt"></i></a></li>');
            lHtml.push('</ul>');
            lHtml.push('</div>');
            lHtml.push('</nav>');
            lHtml.push('</div>');
            lHtml.push('<div id="' + this.idVisuEleve + '" style="position:relative;"></div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetAffichagePageQCM.prototype.setDonnees = function(aObjet, aOngletPrec) {
            $('#' + GInterface.GetInstance(GInterface.identEnteteMobile).GetNom().escapeJQ()).hide();
            $('#' + GInterface.idZoneSelection.escapeJQ()).hide();
            this.objetVisuEleve.setParametres({
                idContenu: this.idVisuEleve.escapeJQ(),
                modeProf: GApplication.getDemo() || (((GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent) || (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Accompagnant)) && (aObjet.executionQCM.etatCloture === undefined || aObjet.executionQCM.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_EnCours))
            });
            this.objetVisuEleve.setDonnees(aObjet.executionQCM);
            $('#' + this.idTitreQCM.escapeJQ()).html(this.objetVisuEleve.composeTitre());
            this.ongletPrec = aOngletPrec;
        };
        ObjetAffichagePageQCM.prototype.ouvrirNavigation = function() {
            $('#' + this.idSideNav.escapeJQ()).sidenav('open');
        };
        ObjetAffichagePageQCM.prototype.fermer = function() {
            $('#' + GInterface.GetInstance(GInterface.identEnteteMobile).GetNom().escapeJQ()).show();
            $('#' + GInterface.idZoneSelection.escapeJQ()).show();
            GInterface.evenementSurOnglet(this.ongletPrec);
        };
        ObjetAffichagePageQCM.prototype.masquerCroix = function() {
            $('#' + this.idBoutonBack.escapeJQ()).hide();
        };
        ObjetAffichagePageQCM.prototype.afficherCroix = function() {
            $('#' + this.idBoutonBack.escapeJQ()).show();
        };
        ObjetAffichagePageQCM.prototype.evenementQCM = function(aParam) {
            if (aParam === undefined) {
                return;
            }
            this.param = aParam;
            if (this.param.action === 'get') {
                if (GEtatUtilisateur.estEspaceEleve() && aParam.pourInitialisation) {
                    new ObjetRequeteSaisieQCMReponses(this, this.actionSurQCMInitialisation.bind(this, true)).lancerRequete(this.param);
                } else {
                    this.actionSurQCMInitialisation();
                }
            } else if (this.param.action === 'set') {
                new ObjetRequeteSaisieQCMReponses(this, this.actionSurSaisieReponses).lancerRequete(this.param);
            } else if (this.param.action === 'close') {
                if (this.param.pourCloture && GEtatUtilisateur.estEspaceEleve()) {
                    new ObjetRequeteSaisieQCMReponses(this, this.actionSurSaisieReponses).lancerRequete(this.param);
                    this.callback.appel({
                        genreOnglet: EGenreOnglet.QCM_Reponse,
                        genreOngletPrec: this.ongletPrec
                    });
                }
                this.fermer();
            } else if (this.param.action === 'croixFermeture') {
                this.fermer();
            } else if (this.param.action === 'masquerCroix') {
                this.masquerCroix();
            } else if (this.param.action === 'afficherCroix') {
                this.afficherCroix();
            } else if (this.param.action === 'masquerNavigation') {
                $('#' + this.idBoutonNav.escapeJQ()).hide();
            } else if (this.param.action === 'afficherNavigation') {
                $('#' + this.idBoutonNav.escapeJQ()).show();
            } else if (this.param.action === 'fermerNavigation') {
                $('#' + this.idSideNav.escapeJQ()).sidenav('close');
            }
        };
        ObjetAffichagePageQCM.prototype.actionSurQCMInitialisation = function() {
            new ObjetRequeteQCMQuestions(this, this.actionSurSaisieQCMQuestions).lancerRequete(this.param);
        };
        ObjetAffichagePageQCM.prototype.actionSurSaisieQCMQuestions = function(aParam) {
            this.objetVisuEleve.setDonnees(aParam);
        };
        ObjetAffichagePageQCM.prototype.actionSurSaisieReponses = function(aParam) {
            this.objetVisuEleve.setDonneesReponse(aParam);
        };
        module.exports = ObjetAffichagePageQCM;
    },
    fn: "interfacepageqcm.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var TypeChampsJSON = require('Enumere_ChampsJSON.js');
        var TypeHttpVariable = require('TypeHttpVariable.js').TypeHttpVariable;

        function TypeChaineBrute(aChaineBrute) {
            this.chaineBrute = MethodesObjet.isString(aChaineBrute) ? aChaineBrute : '';
        }
        TypeChaineBrute.prototype.toJSON = function() {
            var lJSON = {};
            lJSON[TypeChampsJSON.type] = TypeHttpVariable.TypeHttpChaineBrute;
            lJSON[TypeChampsJSON.valeur] = this.chaineBrute;
            return lJSON;
        };
        module.exports = TypeChaineBrute;
    },
    fn: "typechainebrute.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var GChaine = require('GChaine.js');
        var Requetes = require('CollectionRequetes.js');
        var TypeChaineBrute = require('TypeChaineBrute.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreRessource = require('Enumere_Ressource.js');

        function ObjetRequeteSaisieActualites() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieActualites', ObjetRequeteSaisieActualites, ObjetRequeteSaisie);
        ObjetRequeteSaisieActualites.prototype.lancerRequete = function(aParam) {
            this.validationDirecte = aParam.validationDirecte || false;
            this.saisieActualite = aParam.saisieActualite;
            this.genresAffDestinataire = aParam.genresAffDestinataire;
            this.genreAffDestinataire = aParam.genreAffDestinataire;
            aParam.listeActualite.setSerialisateurJSON({
                methodeSerialisation: _serialiser_Actualite.bind(this),
                ignorerEtatsElements: this.validationDirecte
            });
            this.JSON.listeActualites = aParam.listeActualite;
            this.JSON.saisieActualite = this.saisieActualite;
            if (aParam.listeDocuments) {
                aParam.listeDocuments.setSerialisateurJSON({
                    methodeSerialisation: _serialiser_Document.bind(this)
                });
                this.JSON.listeDocuments = aParam.listeDocuments;
            }
            if (aParam.punition) {
                this.JSON.punition = aParam.punition;
            }
            if (aParam.incident) {
                this.JSON.incident = aParam.incident;
            }
            return this.appelAsynchrone();
        };

        function _serialiser_Actualite(aActualite, aJSON) {
            if (!!aActualite.estUneDiffusionDeResultatsSondage && aActualite.Etat === EGenreEtat.Creation) {
                if (!!aActualite.listeQuestions) {
                    aActualite.listeQuestions.parcourir(function(aQuestion) {
                        if (!!aQuestion && aQuestion.listePiecesJointes) {
                            aQuestion.listePiecesJointes.parcourir(function(aPJ) {
                                aPJ.SetEtat(EGenreEtat.Creation);
                            });
                        }
                    });
                }
            }
            if (aActualite.estADupliquer === true) {
                aJSON.estADupliquer = true;
                aJSON.dupliquerPublic = (aActualite.dupliquerPublic === true);
                return;
            }
            aJSON.validationDirecte = this.validationDirecte;
            aJSON.estPartageBiblioEtablissement = aActualite.estPartageBiblioEtablissement;
            if (!!aActualite.changePartageBiblioEtablissementSeulement) {
                aJSON.changePartageBiblioEtablissementSeulement = true;
                return;
            }
            aJSON.genrePublic = aActualite.genrePublic;
            aJSON.public = aActualite.public;
            aJSON.lue = aActualite.lue;
            aJSON.supprimee = !!aActualite.supprimee;
            aJSON.marqueLueSeulement = aActualite.marqueLueSeulement ? aActualite.marqueLueSeulement : false;
            aJSON.saisieActualite = this.saisieActualite;
            aActualite.listeQuestions.setSerialisateurJSON({
                methodeSerialisation: _serialiser_ListeQuestions.bind(this),
                ignorerEtatsElements: this.saisieActualite
            });
            aJSON.listeQuestions = aActualite.listeQuestions;
            if (this.saisieActualite) {
                aJSON.publie = aActualite.publie;
                aJSON.categorie = aActualite.categorie;
                aJSON.dateDebut = aActualite.dateDebut;
                aJSON.dateFin = aActualite.dateFin;
                aJSON.genreReponse = aActualite.genreReponse;
                aJSON.tailleReponse = aActualite.tailleReponse;
                aJSON.reponseAnonyme = aActualite.reponseAnonyme;
                if (!!aActualite.listeIndividusPartage) {
                    aActualite.listeIndividusPartage.setSerialisateurJSON({
                        ignorerEtatsElements: true
                    });
                    aJSON.listeIndividusPartage = aActualite.listeIndividusPartage;
                }
                if (aActualite.avecModificationPublic) {
                    aJSON.avecModificationPublic = true;
                    aJSON.avecElevesRattaches = aActualite.avecElevesRattaches;
                    if ($.inArray(EGenreRessource.Eleve, this.genresAffDestinataire) > -1) {
                        aJSON.avecEleve = aActualite.avecEleve;
                        aJSON.avecResp1 = aActualite.avecResp1;
                        aJSON.avecResp2 = aActualite.avecResp2;
                        aJSON.avecProfsPrincipaux = aActualite.avecProfsPrincipaux;
                        aJSON.avecTuteurs = aActualite.avecTuteurs;
                    }
                    aJSON.genresPublicEntite = aActualite.genresPublicEntite;
                    aJSON.avecDirecteur = aActualite.avecDirecteur;
                    aActualite.listePublicEntite.setSerialisateurJSON({
                        methodeSerialisation: null,
                        ignorerEtatsElements: true
                    });
                    aJSON.listePublicEntite = aActualite.listePublicEntite;
                    aActualite.listePublicIndividu.setSerialisateurJSON({
                        methodeSerialisation: _serialiser_Individu.bind(this),
                        ignorerEtatsElements: true
                    });
                    aJSON.listePublicIndividu = aActualite.listePublicIndividu;
                }
            }
        }

        function _serialiser_ListeQuestions(aQuestion, aJSON) {
            if (this.saisieActualite) {
                $.extend(aJSON, aQuestion.copieToJSON());
                aJSON.texte = new TypeChaineBrute(aQuestion.texte);
                aQuestion.listeChoix.setSerialisateurJSON({
                    methodeSerialisation: _serialiser_Choix.bind(this),
                    ignorerEtatsElements: false,
                    nePasTrierPourValidation: true
                });
                aJSON.listeChoix = aQuestion.listeChoix;
                aQuestion.listePiecesJointes.setSerialisateurJSON({
                    methodeSerialisation: _serialiser_Document.bind(this),
                    ignorerEtatsElements: false
                });
                aJSON.listePiecesJointes = aQuestion.listePiecesJointes;
            } else {
                aJSON.genreReponse = aQuestion.genreReponse;
                aJSON.reponse = aQuestion.reponse.toJSON();
                $.extend(aJSON.reponse, aQuestion.reponse.copieToJSON());
            }
        }

        function _serialiser_Document(aDocument, aJSON) {
            var lIdFichier = aDocument.idFichier !== undefined ? aDocument.idFichier : (aDocument.Fichier !== undefined ? aDocument.Fichier.idFichier : null);
            if (lIdFichier !== null) {
                aJSON.idFichier = GChaine.CardinalToStr(lIdFichier);
            }
            aJSON.nomFichier = aDocument.nomFichier;
            aJSON.url = aDocument.url;
        }

        function _serialiser_Individu(aIndividu, aJSON) {
            aJSON.N = aIndividu.GetNumero();
            aJSON.G = aIndividu.GetGenre();
            aJSON.E = undefined;
            aJSON.L = undefined;
        }

        function _serialiser_Choix(aChoix, aJSON) {
            aJSON.rang = aChoix.rang;
        }
        ObjetRequeteSaisieActualites.prototype.actionApresRequete = function(aXml, aGenreReponse) {
            this.callbackReussite.appel(aXml, aGenreReponse, this.JSONRapportSaisie);
        };
        module.exports = ObjetRequeteSaisieActualites;
    },
    fn: "objetrequetesaisieactualites.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var GChaine = require('GChaine.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetRequeteSaisieActualites = require('ObjetRequeteSaisieActualites.js');
        var TypeGenreReponseInternetActualite = require('TypeGenreReponseInternetActualite.js').TypeGenreReponseInternetActualite;
        var FenetrePopUp_Mobile = require('FenetrePopUp_Mobile.js');
        var GDate = require('ObjetDate.js').GDate;
        MethodesObjet.heritagePrototype(ObjetFicheActualite_Mobile, ObjetAbstraitInterface);

        function ObjetFicheActualite_Mobile() {
            this.inheritedCreate(arguments);
            this.classeFenetre = 'FicheActualite';
            this.modaleActualite = null;
            this.donnees = {
                actualite: null,
                enLectureSeule: false
            };
        }
        ObjetFicheActualite_Mobile.prototype.getControleur = function(aInstance) {
            return {
                surSaisieTexteReponse: function(aNumeroQuestion, aEvent) {
                    if (!!aInstance.donnees.actualite && !!aInstance.donnees.actualite.listeQuestions) {
                        var lQuestionConcernee = aInstance.donnees.actualite.listeQuestions.GetElementParNumero(aNumeroQuestion);
                        if (!!lQuestionConcernee) {
                            var lValeurSaisie = $(aEvent.target).val();
                            lQuestionConcernee.reponse.valeurReponse = lValeurSaisie;
                            lQuestionConcernee.reponse.avecReponse = true;
                            lQuestionConcernee.reponse.SetEtat(EGenreEtat.Modification);
                            lQuestionConcernee.SetEtat(EGenreEtat.Modification);
                            aInstance.donnees.actualite.SetEtat(EGenreEtat.FilsModification);
                        }
                    }
                },
                surSaisieChoixReponse: function(aNumeroQuestion, aEvent) {
                    var lQuestionConcernee = aInstance.donnees.actualite.listeQuestions.GetElementParNumero(aNumeroQuestion);
                    if (!!lQuestionConcernee) {
                        if (lQuestionConcernee.genreReponse === TypeGenreReponseInternetActualite.ChoixUnique) {
                            lQuestionConcernee.reponse.valeurReponse.Vider();
                        }
                        var lValeurReponse = $(aEvent.target).val();
                        var lEstCoche = $(aEvent.target).is(':checked');
                        var lChoix;
                        lQuestionConcernee.reponse.valeurReponse.SetValeur(lEstCoche, lValeurReponse);
                        lQuestionConcernee.reponse.avecReponse = true;
                        lQuestionConcernee.reponse.SetEtat(EGenreEtat.Modification);
                        lQuestionConcernee.SetEtat(EGenreEtat.Modification);
                        aInstance.donnees.actualite.SetEtat(EGenreEtat.FilsModification);
                        if (lQuestionConcernee.genreReponse === TypeGenreReponseInternetActualite.ChoixMultiple && lQuestionConcernee.avecMaximum) {
                            var lNombreCoche = lQuestionConcernee.reponse.valeurReponse.GetNbrValeurs();
                            var I, lID;
                            if (lNombreCoche < lQuestionConcernee.nombreReponsesMax) {
                                for (I = 0; I < lQuestionConcernee.listeChoix.GetNbrElements(); I++) {
                                    lChoix = lQuestionConcernee.listeChoix.GetElement(I);
                                    lID = 'FicheActualiteReponseText_' + lQuestionConcernee.GetNumero() + '_' + lChoix.rang;
                                    $('#' + lID.escapeJQ()).inputDisabled(false);
                                }
                            } else {
                                for (I = 0; I < lQuestionConcernee.listeChoix.GetNbrElements(); I++) {
                                    lChoix = lQuestionConcernee.listeChoix.GetElement(I);
                                    lID = 'FicheActualiteReponseText_' + lQuestionConcernee.GetNumero() + '_' + lChoix.rang;
                                    var lValue = lQuestionConcernee.reponse.valeurReponse.GetValeur(I + 1);
                                    $('#' + lID.escapeJQ()).inputDisabled(!lValue);
                                }
                            }
                        }
                    }
                },
                surClickAccuseDeReception: function() {
                    var lQuestionConcernee = aInstance.donnees.actualite.listeQuestions.GetPremierElement();
                    if (!!lQuestionConcernee) {
                        lQuestionConcernee.reponse.avecReponse = true;
                        lQuestionConcernee.reponse.SetEtat(EGenreEtat.Modification);
                        lQuestionConcernee.SetEtat(EGenreEtat.Modification);
                        aInstance.donnees.actualite.SetEtat(EGenreEtat.Modification);
                        var lCallbackSaisieAR = function() {
                            aInstance.modaleActualite.closePopup();
                        };
                        var lParamsRequete = {
                            listeActualite: new ObjetListeElements().AddElement(aInstance.donnees.actualite),
                            validationDirecte: true,
                            saisieActualite: false
                        };
                        new ObjetRequeteSaisieActualites(this, lCallbackSaisieAR).lancerRequete(lParamsRequete);
                    }
                }
            };
        };
        ObjetFicheActualite_Mobile.prototype.SetDonnees = function(aDonnees) {
            this.donnees.actualite = aDonnees.actualite;
            this.donnees.enLectureSeule = aDonnees.enLectureSeule;
            var lTitreFenetre = this.donnees.actualite.GetLibelle();
            if (!!this.donnees.actualite.categorie) {
                lTitreFenetre += ' (' + this.donnees.actualite.categorie.GetLibelle() + ')';
            }
            if (!!this.donnees.actualite.elmauteur) {
                lTitreFenetre += ' - ' + this.donnees.actualite.elmauteur.GetLibelle();
            }
            this.Afficher(lTitreFenetre);
        };

        function _composePJ(aListePJ) {
            var H = [];
            if (!!aListePJ) {
                aListePJ.parcourir(function(D) {
                    H.push(GChaine.composerUrlLienExterne({
                        documentJoint: D,
                        genreRessource: EGenreRessource.DocJointEtablissement
                    }));
                });
            }
            return H.join('<br/>');
        }

        function _composeContenuInformation(aActualite, aAvecEdition) {
            var H = [];
            if (!!aActualite && !!aActualite.listeQuestions) {
                var lQuestion = aActualite.listeQuestions.GetPremierElement();
                if (!!lQuestion) {
                    H.push('<div>', (lQuestion.texte || ''), '</div>');
                    if (!!lQuestion.listePiecesJointes && lQuestion.listePiecesJointes.GetNbrElements() > 0) {
                        H.push('<div>', _composePJ(lQuestion.listePiecesJointes) + '</div>');
                    }
                    var lAvecAccuseDeReception = (lQuestion.genreReponse === TypeGenreReponseInternetActualite.AvecAR) && aAvecEdition;
                    if (lAvecAccuseDeReception) {
                        var lAvecReponse = (lQuestion.reponse && lQuestion.reponse.avecReponse);
                        H.push('<div style="padding: 1rem 0 0 1rem;">', '<label>', '<input id="FicheActualite_AR" type="checkbox" ie-event="click->surClickAccuseDeReception()" ', (lAvecReponse ? ' checked=checked' : ''), (lAvecReponse ? ' disabled' : ''), '>', '<span>', GTraductions.getValeur('actualites.PrisConnaissance'), '</span>', '</label>', '</div>');
                    }
                }
            }
            return H.join('');
        }

        function _composeReponseTextuelle(aQuestion, aAvecEdition) {
            var lIdTextarea = 'FicheActualiteReponseText_' + aQuestion.GetNumero();
            var lTailleMaxReponse = (aQuestion ? aQuestion.tailleReponse : 0);
            var lReponseSaisie = (aQuestion.reponse ? (aQuestion.reponse.valeurReponse || '') : '');
            var H = [];
            H.push('<div class="input-field">', '<textarea id="', lIdTextarea, '" class="materialize-textarea"', (!aAvecEdition ? ' readonly' : ''), (lTailleMaxReponse > 0 ? ' data-length="' + lTailleMaxReponse + '" maxlength="' + lTailleMaxReponse + '"' : ''), ' ie-event="keyup->surSaisieTexteReponse(\'', aQuestion.GetNumero(), '\')"', '>', lReponseSaisie, '</textarea>', '<label for="', lIdTextarea, '"', (lReponseSaisie.length > 0 ? ' class="active"' : ''), '>', GTraductions.getValeur('actualites.SaisirReponse'), '</label>', '</div>');
            return H.join('');
        }

        function _composeReponseChoix(aQuestion, aAvecEdition) {
            var lInputId;
            var lInputType = aQuestion.genreReponse === TypeGenreReponseInternetActualite.ChoixUnique ? 'radio' : 'checkbox';
            var lNameGroupeChoix = 'groupeCoches_' + aQuestion.GetNumero();
            var H = [];
            aQuestion.listeChoix.parcourir(function(D) {
                lInputId = 'FicheActualiteReponseText_' + aQuestion.GetNumero() + '_' + D.rang;
                var lIsChecked = (aQuestion.reponse && aQuestion.reponse.valeurReponse.GetValeur(D.rang));
                H.push('<div>', '<label>', '<input type="', lInputType, '"', ' ie-event="click->surSaisieChoixReponse(\'', aQuestion.GetNumero(), '\')"', ' value="', D.rang, '" name="', lNameGroupeChoix, '" id="', lInputId, '"', (lIsChecked ? ' checked=checked' : ''), (!aAvecEdition ? ' disabled="disabled"' : ''), '>', '<span for="', lInputId, '">', D.Libelle, '</span>', '</label>', '</div>');
            });
            return H.join('');
        }

        function _composeContenuSondage(aActualite, aAvecEdition) {
            var H = [];
            if (!!aActualite && !!aActualite.listeQuestions) {
                var lNbQuestions = aActualite.listeQuestions.GetNbrElements();
                aActualite.listeQuestions.parcourir(function(D, aIndex) {
                    H.push('<div', (aIndex > 0 ? ' style="padding-top: 1rem;"' : ''), '>');
                    if (lNbQuestions > 1) {
                        H.push('<div class="Texte11 Gras Souligne">' + D.GetLibelle() + '</div>');
                    }
                    H.push('<div>' + (D.texte || '') + '</div>');
                    switch (D.genreReponse) {
                        case TypeGenreReponseInternetActualite.Textuelle:
                            H.push(_composeReponseTextuelle(D, aAvecEdition));
                            break;
                        case TypeGenreReponseInternetActualite.ChoixUnique:
                            H.push(_composeReponseChoix(D, aAvecEdition));
                            break;
                        case TypeGenreReponseInternetActualite.ChoixMultiple:
                            H.push(_composeReponseChoix(D, aAvecEdition));
                            break;
                    }
                    if (!!D.listePiecesJointes && D.listePiecesJointes.GetNbrElements() > 0) {
                        H.push('<div>', _composePJ(D.listePiecesJointes), '</div>');
                    }
                    H.push('</div>');
                });
            }
            return H.join('');
        }

        function _composeContenuFiche() {
            var H = [];
            H.push('<div class="', this.classeFenetre, '" style="padding: 0.5rem;">');
            if (!!this.donnees.actualite) {
                if (this.donnees.actualite.estInformation) {
                    H.push(_composeContenuInformation(this.donnees.actualite, !this.donnees.enLectureSeule));
                } else {
                    H.push(_composeContenuSondage(this.donnees.actualite, !this.donnees.enLectureSeule));
                }
                if (!!this.donnees.actualite.dateDebut) {
                    H.push('<div style="text-align: right; font-style: italic;font-size: .9rem;">', GTraductions.getValeur('Le'), ' ', GDate.FormatDate(this.donnees.actualite.dateDebut, '%JJ/%MM/%AAAA'), '</div>');
                }
            }
            H.push('</div>');
            return H.join('');
        }

        function _composePopupFooter() {
            var result;
            if (!!this.donnees.actualite) {
                result = [];
                if (this.donnees.actualite.estInformation || this.donnees.enLectureSeule) {
                    result.push({
                        libelle: GTraductions.getValeur('Fermer'),
                        attrSuppl: 'ie-event="click->surBoutonAnnuler"'
                    });
                } else {
                    result.push({
                        libelle: GTraductions.getValeur('Annuler'),
                        attrSuppl: 'ie-event="click->surBoutonAnnuler"'
                    });
                    result.push({
                        libelle: GTraductions.getValeur('Valider'),
                        attrSuppl: 'ie-event="click->surBoutonValiderSondage"'
                    });
                }
            }
            return result;
        }
        ObjetFicheActualite_Mobile.prototype.Afficher = function(aTitreFenetre) {
            var lThis = this;
            this.modaleActualite = new FenetrePopUp_Mobile();
            var lFooterControleur = {
                surBoutonAnnuler: function() {
                    lThis.modaleActualite.closePopup();
                },
                surBoutonValiderSondage: function() {
                    if (lThis.donnees.actualite.aToutRepondu()) {
                        lThis.donnees.actualite.lue = true;
                    }
                    var lCallbackValiderSondage = function() {
                        lThis.modaleActualite.closePopup();
                    };
                    var lParamsRequete = {
                        listeActualite: new ObjetListeElements().AddElement(lThis.donnees.actualite),
                        validationDirecte: true,
                        saisieActualite: false
                    };
                    new ObjetRequeteSaisieActualites(this, lCallbackValiderSondage).lancerRequete(lParamsRequete);
                }
            };
            this.modaleActualite.setOptionsPopup({
                noClose: true
            });
            this.modaleActualite.openPopup({
                titre: '<h1>' + aTitreFenetre + '</h1>',
                contenu: _composeContenuFiche.call(this),
                contenuControleur: this.controleur,
                footer: _composePopupFooter.call(this),
                footerControleur: lFooterControleur
            });
        };
        module.exports = ObjetFicheActualite_Mobile;
    },
    fn: "objetficheactualite_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisieActualites = require('ObjetRequeteSaisieActualites.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeGenreReponseInternetActualite = require('TypeGenreReponseInternetActualite.js').TypeGenreReponseInternetActualite;
        var Identite = require('ObjetIdentite.js');
        var ObjetFicheActualite_Mobile = require('ObjetFicheActualite_Mobile.js');
        var GDate = require('ObjetDate.js').GDate;
        MethodesObjet.heritagePrototype(ObjetActualites, ObjetIdentite_Mobile);

        function ObjetActualites() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
            this.listeActualites = null;
            this.IdZoneChk = this.Nom + '_zoneChk';
            this.toggleNonLues = this.Nom + '_toggleNonLues';
            this.idActus = this.Nom + '_Actus';
            this.uniquementNonLues = true;
        }
        ObjetActualites.prototype.evenementActualiteLue = function(aActu) {
            aActu.marqueLueSeulement = true;
            aActu.lue = true;
            var lListeActualites = new ObjetListeElements();
            lListeActualites.AddElement(aActu);
            var lObjetSaisie = {
                listeActualite: lListeActualites,
                validationDirecte: true,
                saisieActualite: false
            };
            new ObjetRequeteSaisieActualites(this, _callbackActuLue.bind(this, aActu)).lancerRequete(lObjetSaisie);
        };

        function _callbackActuLue(aActualite) {
            var lNumero = aActualite.GetNumero();
            var lPublic = aActualite.public ? aActualite.public.GetNumero() : '';
            $("#" + (this.Nom + '_Actu_' + lNumero + '_Public_' + lPublic).escapeJQ()).removeClass('Gras');
            aActualite.marqueLueSeulement = false;
        }
        ObjetActualites.prototype.SetDonnees = function(aListeActu) {
            this.listeActualites = aListeActu;
            this.donneesRecues = true;
            this.Afficher();
        };
        ObjetActualites.prototype.afficherInfo = function(aNumero, aPublic) {
            var lListeActu = this.listeActualites.getListeElements(function(aEle) {
                    return aEle.GetNumero() === aNumero && (aEle.public ? aEle.public.GetNumero() === aPublic : true);
                }),
                lActu = lListeActu.GetElement(0);
            var lInstance = Identite.creerInstance(ObjetFicheActualite_Mobile, {
                pere: this
            });
            lInstance.Initialiser();
            lInstance.SetDonnees({
                actualite: lActu
            });
            if ((lActu.avecReponse || lActu.genreReponse === TypeGenreReponseInternetActualite.SansAR) && (lActu.lue === false)) {
                this.evenementActualiteLue(lActu);
            }
        };
        ObjetActualites.prototype.toggleLues = function() {
            this.uniquementNonLues = !this.uniquementNonLues;
            GHtml.setHtml(this.idActus, _composeActualites.call(this, this.uniquementNonLues));
        };
        ObjetActualites.prototype.ConstruireAffichage = function() {
            if (!this.donneesRecues) {
                return '';
            }
            var lHtml = [];
            var lCoche = (this.uniquementNonLues ? 'checked' : '');
            lHtml.push('<div class="Espace" style="float: right">', '<label for="', this.IdZoneChk, '" class="Gras AlignementMilieuVertical " style="display:block;">', GTraductions.getValeur('actualites.UniquementNonLues'), '</label>', '<div class="switch" style="float:right;"><label>', GTraductions.getValeur('Non'), '<input name="', this.IdZoneChk, '" id="', this.IdZoneChk, '" type="checkbox" tabindex="0" ', lCoche, ' onchange="', this.Nom, '.toggleLues()"><span class="lever"></span>', GTraductions.getValeur('Oui'), '</label></div>', '</div>');
            lHtml.push('<div>');
            lHtml.push('<div style="clear:both;" id ="', this.idActus, '">');
            lHtml.push(_composeActualites.call(this, this.uniquementNonLues));
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };

        function _composeActualites(aUniquementLues) {
            var lHtml = [];
            if (!!this.listeActualites) {
                var lListeActusAAfficher = this.listeActualites.getListeElements(function(aElement) {
                    return !aUniquementLues || !aElement.lue;
                });
                var lNbActusNonDeploiement = lListeActusAAfficher.getListeElements(function(ele) {
                    return !ele.estUnDeploiement;
                }).GetNbrElements();
                if (lNbActusNonDeploiement === 0) {
                    lHtml.push(this.composeAucuneDonnee(GTraductions.getValeur('actualites.AucuneActu')));
                } else {
                    var lNbActusDeploiement = lListeActusAAfficher.getListeElements(function(ele) {
                        return ele.estUnDeploiement;
                    }).GetNbrElements();
                    var lThis = this;
                    lHtml.push('<ul class="collection', (lNbActusDeploiement > 0 ? ' with-header' : ''), '">');
                    lListeActusAAfficher.parcourir(function(aActu) {
                        lHtml.push(_composeActualite.call(lThis, aActu));
                    });
                    lHtml.push('</ul>');
                }
            }
            return lHtml.join('');
        }

        function _composeActualite(aActu) {
            var H = [];
            var lIdLi = this.Nom + '_Actu_' + aActu.GetNumero() + '_Public_' + (aActu.public ? aActu.public.GetNumero() : '');
            var lLibelleActualite = aActu.GetLibelle();
            if (!aActu.estUnDeploiement) {
                if (!!aActu.categorie) {
                    lLibelleActualite += ' (' + aActu.categorie.GetLibelle() + ')';
                }
                if (!!aActu.auteur) {
                    lLibelleActualite += ' - ' + aActu.auteur;
                }
            }
            if (aActu.estUnDeploiement) {
                H.push('<li class="collection-header" id="', lIdLi, '">', lLibelleActualite, '</li>');
            } else {
                var lIconClass = aActu.estInformation ? 'Image_ActuInfo' : 'Image_ActuQuestion';
                H.push('<li style="display:flex;" id="', lIdLi, '" class="collection-item with-action ' + (!aActu.lue ? 'Gras' : '') + '" onclick="' + this.Nom + '.afficherInfo(\'' + aActu.GetNumero() + '\', \'' + (aActu.public ? aActu.public.GetNumero() : '') + '\');' + '">', '<i class="material-icon ' + lIconClass + ' circle InlineBlock AlignementMilieuVertical" style="width:33px;height:33px; background-color: #cfd8dc;"></i>', '<div style="display:flex; flex-direction: column">', '<span class="EspaceGauche AlignementMilieuVertical">', lLibelleActualite, '</span>', '<span class="EspaceGauche AlignementMilieuVertical Maigre">', GTraductions.getValeur('Le'), ' ', GDate.FormatDate(aActu.dateDebut, '%JJ/%MM/%AAAA'), '</span>', '</div>', '</li>');
            }
            return H.join('');
        }
        module.exports = ObjetActualites;
    },
    fn: "mobile/script/pageactualites.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;

        function ObjetRequetePageActualites() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageActualites', ObjetRequetePageActualites, ObjetRequeteConsultation);
        ObjetRequetePageActualites.prototype.lancerRequete = function(aParametres) {
            $.extend(this.JSON, aParametres);
            return this.appelAsynchrone();
        };
        ObjetRequetePageActualites.prototype.actionApresRequete = function() {
            var lListeCategories = this.JSONReponse.listeCategories;
            var lCategorie = new ObjetElement(GTraductions.getValeur('actualites.ToutesCategories'), 0);
            lCategorie.toutesLesCategories = true;
            lListeCategories.AddElement(lCategorie);
            lListeCategories.setTri([ObjetTri.init(function(D) {
                return !D.toutesLesCategories;
            }), ObjetTri.init('Libelle')]);
            lListeCategories.trier();
            var lListeActualites = this.JSONReponse.listeActualites;
            this.callbackReussite.appel({
                listeCategories: lListeCategories,
                listeActualites: lListeActualites,
                avecElementsSaisie: this.JSONReponse.avecElementsSaisie
            });
        };
        module.exports = ObjetRequetePageActualites;
    },
    fn: "objetrequetepageactualites.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetActualites = require('mobile/script/PageActualites.js');
        var ObjetRequetePageActualites = require('ObjetRequetePageActualites.js');
        var MethodesObjet = require('MethodesObjet.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TUtilitaireInformations = require('UtilitaireInformations.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageActualites_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageActualites_Mobile(aNom, aIdent, aPere, aEvenement) {
            this.inheritedCreate(arguments);
            this.modeAuteur = false;
        }
        ObjetAffichagePageActualites_Mobile.prototype.ConstruireInstances = function() {
            this.identPage = this.Add(ObjetActualites, this._eventActualites, null);
        };
        ObjetAffichagePageActualites_Mobile.prototype._eventActualites = function() {
            this.ActualiserDonnees();
        };
        ObjetAffichagePageActualites_Mobile.prototype.RecupererDonnees = function() {
            this.ActualiserDonnees();
        };
        ObjetAffichagePageActualites_Mobile.prototype.ActualiserDonnees = function() {
            new ObjetRequetePageActualites(this, this._actionSurRecupererDonnees.bind(this)).lancerRequete({
                estAuteur: this.modeAuteur
            });
        };
        ObjetAffichagePageActualites_Mobile.prototype._actionSurRecupererDonnees = function(aDonnees) {
            aDonnees.listeActualites.parcourir(function(aElement) {
                aElement.avecReponse = TUtilitaireInformations.avecReponse.bind(aElement);
                aElement.aToutRepondu = TUtilitaireInformations.aToutRepondu.bind(aElement);
            });
            var lAvecCumul = TUtilitaireInformations.avecCumul(aDonnees.listeActualites);
            if (lAvecCumul) {
                TUtilitaireInformations.formaterListePourCumul(aDonnees.listeActualites);
            } else {
                aDonnees.listeActualites.setTri([
                    ObjetTri.init('dateDebut', EGenreTriElement.Decroissant), ObjetTri.init('dateFin'), ObjetTri.init('Libelle')
                ]);
                aDonnees.listeActualites.trier();
            }
            this.GetInstance(this.identPage).SetDonnees(aDonnees.listeActualites, aDonnees.avecElementSaisie);
            $('#' + this.GetInstance(this.identPage).GetNom().escapeJQ()).css('min-height', $('#' + this.Nom.escapeJQ()).height() + 'px');
        };
        module.exports = ObjetAffichagePageActualites_Mobile;
    },
    fn: "mobile/script/interfacepageactualites.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var TypeOrigineCreationEtiquetteMessage = require('TypeOrigineCreationEtiquetteMessage.js').TypeOrigineCreationEtiquetteMessage;
        var EGenreEspace = require('Enumere_Espace.js');

        function ObjetRequeteListeMessagerie() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('ListeMessagerie', ObjetRequeteListeMessagerie, ObjetRequeteConsultation);
        ObjetRequeteListeMessagerie.prototype.lancerRequete = function(aParametres) {
            var lParametres = $.extend({}, aParametres);
            $.extend(this.JSON, lParametres);
            if (!!this.JSON.listeRessources) {
                this.JSON.listeRessources.setSerialisateurJSON({
                    ignorerEtatsElements: true
                });
            }
            return this.appelAsynchrone();
        };
        ObjetRequeteListeMessagerie.prototype.actionApresRequete = function() {
            var lTriEtiquette = [
                ObjetTri.init(function(D) {
                    switch (D.GetGenre()) {
                        case 1000:
                            return -1;
                        case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Archive:
                            return 1;
                        case TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Brouillon:
                            return 2;
                        default:
                            return 100;
                    }
                }), ObjetTri.init('Libelle')
            ];
            this.JSONReponse.listeEtiquettes.setTri(lTriEtiquette).trier();
            for (var I = 0; I < this.JSONReponse.listeMessagerie.GetNbrElements(); I++) {
                var lLigne = this.JSONReponse.listeMessagerie.GetElement(I);
                lLigne.indice = I;
                if (lLigne.indicePere >= 0) {
                    lLigne.pere = this.JSONReponse.listeMessagerie.GetElement(lLigne.indicePere);
                    if (!!lLigne.contexte && (!!lLigne.pere && !lLigne.pere.contexte)) {
                        lLigne.pere.contexte = lLigne.contexte;
                    }
                }
                lLigne.estDeploye = false;
                lLigne.estUneDiscussion = lLigne.estUneDiscussion ? true : false;
                if (this.JSONReponse.listeEtiquettes) {
                    if (!lLigne.listeEtiquettes) {
                        lLigne.listeEtiquettes = new ObjetListeElements();
                    } else {
                        lLigne.listeEtiquettes.parcourir(function(aEtiquette) {
                            var lTrouve = this.JSONReponse.listeEtiquettes.GetElementParNumero(aEtiquette.GetNumero());
                            Object.assign(aEtiquette, lTrouve);
                            if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Archive) {
                                lLigne.archive = true;
                            } else if (aEtiquette.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_Poubelle) {
                                lLigne.poubelle = true;
                            }
                        }.bind(this));
                    }
                    lLigne.listeEtiquettes.setTri(lTriEtiquette).trier();
                }
            }
            if (GEtatUtilisateur.GenreEspace === EGenreEspace.PrimParent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent) {
                var lFuncChangerNumero = function(aEtiquette, aContexte) {
                    if (!!aContexte) {
                        aEtiquette.Numero = aEtiquette.Numero + '_' + aContexte.GetNumero();
                    }
                };
                this.JSONReponse.listeEtiquettes.parcourir(function(D) {
                    if (D.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison) {
                        lFuncChangerNumero(D, D.contexte);
                    }
                });
                this.JSONReponse.listeMessagerie.parcourir(function(aMessage) {
                    if (!!aMessage.listeEtiquettes) {
                        aMessage.listeEtiquettes.parcourir(function(D) {
                            if (D.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison) {
                                lFuncChangerNumero(D, aMessage.contexte);
                            }
                        });
                    }
                });
            }
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequeteListeMessagerie;
    },
    fn: "objetrequetelistemessagerie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var Support = require('ObjetSupport.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var ObjetRequeteListeMessagerie = require('ObjetRequeteListeMessagerie.js');
        var ObjetRequeteListeMessages = require('ObjetRequeteListeMessages.js');
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');
        var ObjetDiscussion_Mobile = require('ObjetDiscussion_Mobile.js');
        var Identite = require('ObjetIdentite.js');
        var GHtml = require('GHtml.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var ObjetBoutonFlottant = require('ObjetBoutonFlottant.js');
        var TypeOrigineCreationEtiquetteMessage = require('TypeOrigineCreationEtiquetteMessage.js').TypeOrigineCreationEtiquetteMessage;
        MethodesObjet.heritagePrototype(ObjetMessagerie, ObjetIdentite_Mobile);

        function ObjetMessagerie() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
            this.listeMessagerie = null;
            this.nbNonLues = this.Nom + '_NonLues';
            this.idDiscussions = this.Nom + '_Convers';
            this.idListeDiscussions = this.Nom + '_ConversList';
            this.idFenetreConversation = this.Nom + '_FenetreConvers';
            this.idFenetreCreation = this.Nom + '_Creation';
            this.idBoutonPlus = this.Nom + '_boutonPlus';
            this.listesDiffusion = null;
            this.avecPJ = Support.avecSupportFileUpload && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Administrateur, EGenreEspace.Mobile_PrimProfesseur]);
            this.message = null;
            this.indiceMessage = null;
            this.avecHtml = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Administrateur, EGenreEspace.Mobile_PrimProfesseur]);
            this.setOptions({
                surChangementMessage: null
            });
            this.pageDiscussion = Identite.creerInstance(ObjetDiscussion_Mobile, {
                pere: this
            });
            this.pageDiscussion.setOptions({
                estChat: false,
                estDiscussionResponsables: GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent,
                callbackFermeture: function() {
                    this.retourListe();
                }.bind(this),
                callbackNavigation: function(aPrecedent) {
                    this.changeMessage(!aPrecedent);
                }.bind(this),
                callbackEnvoyer: function(aParams) {
                    if (aParams && aParams.creationDiscussion) {
                        if (aParams.message) {
                            this.message = MethodesObjet.dupliquer(aParams.message);
                        }
                        this.pageDiscussion.masquer();
                    } else {
                        this._evenementSurSaisieMessage();
                    }
                }.bind(this)
            });
            Invocateur.abonner('actualiserListeDiscussion_mobile', this.retourListe, this);
        }
        ObjetMessagerie.prototype.getControleur = function(aInstance) {
            return {
                getNodeDiscussion: function() {
                    $("#" + GInterface.idZonePrincipale).IEHtmlAppend('<div class="is-sticky" ie-identite="getIdentiteBouton" ></div>', {
                        controleur: this.controleur,
                        avecCommentaireConstructeur: false
                    });
                    $(this.node).on('destroyed', function() {
                        $("#" + aInstance.identBtnFlottant.GetNom().escapeJQ()).remove();
                    });
                },
                getNodeDest: function(aNumeroMessage) {
                    $(this.node).on('click', function(aEvent) {
                        aEvent.stopPropagation();
                        _popupListeDestinataires.call(aInstance, aNumeroMessage, true);
                    });
                },
                getIdentiteBouton: function() {
                    return {
                        class: ObjetBoutonFlottant,
                        pere: this,
                        init: function(aBtn) {
                            aInstance.identBtnFlottant = aBtn;
                            var lParam = {
                                listeBoutons: [{
                                    primaire: true,
                                    icone: "icon_plus",
                                    callback: _ouvrirFenetreCreation.bind(this, aInstance)
                                }]
                            };
                            aBtn.setOptionsBouton(lParam);
                        }
                    };
                }
            };
        };
        ObjetMessagerie.prototype.ConstruireAffichage = function() {
            if (!this.donneesRecues) {
                return '';
            }
            return this.composeListeDiscussions() + this.composeConversation();
        };

        function _setListeMessagerie(aListeMessagerie) {
            this.listeMessagerie = new ObjetListeElements();
            if (aListeMessagerie) {
                aListeMessagerie.parcourir(function(aMessage) {
                    if (TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette(aMessage, this.etiquetteSelectionnee)) {
                        this.listeMessagerie.AddElement(aMessage);
                    }
                }.bind(this));
            }
        }
        ObjetMessagerie.prototype.SetDonnees = function(aEtiquetteSelectionnee) {
            this.etiquetteSelectionnee = aEtiquetteSelectionnee;
            _setListeMessagerie.call(this, this.listeMessagerie_TOUTES);
            this.donneesRecues = true;
            this.Afficher();
        };
        ObjetMessagerie.prototype.getNbMsgNonLus = function() {
            var lNb = 0;
            for (var i = 0; i < this.listeMessagerie.GetNbrElements(); i++) {
                if (this.listeMessagerie.GetElement(i).lu === false) {
                    lNb++;
                }
            }
            return lNb;
        };
        ObjetMessagerie.prototype.getLibellePourListe = function(aMsg) {
            var H = [],
                lClass = [aMsg.lu ? 'grey-text text-darken-1' : '', aMsg.profondeur ? 'Italique' : ''],
                lAvecDest = false,
                lDestMultiple = false;
            lAvecDest = aMsg.nbPublic > 0 || aMsg.public;
            lDestMultiple = aMsg.nbPublic > 1;
            var lLargeurDest = '7rem';
            H.push('<div', lClass.length ? ' class="title ' + lClass.join(' ') + '"' : '', ' style="overflow-wrap: anywhere; margin-left: ' + 10 * aMsg.profondeur + 'px; ' + ((lAvecDest && lDestMultiple ? 'padding-right:1.5rem;' : 'padding-right:' + lLargeurDest + ';')) + ' "', '>');
            H.push((aMsg.profondeur ? '' : aMsg.objet + '&nbsp;') + '(' + aMsg.nombreMessages + ')');
            if (aMsg.nbBrouillons) {
                if (aMsg.nbBrouillons === 1) {
                    H.push('&nbsp;[' + GTraductions.getValeur('Messagerie.UnBrouillon') + ']');
                } else {
                    H.push('&nbsp;[' + GTraductions.getValeur('Messagerie.NBrouillons', [aMsg.nbBrouillons]) + ']');
                }
            }
            H.push('</div>');
            H.push('<div style="display:flex">');
            H.push('<div class="grey-text text-darken-1 truncate" style="flex: 1 1 auto">', aMsg.documentsJoints ? '<i class="icon_paper_clip" style="font-size:1.3rem"></i>&nbsp;-&nbsp;' : '', aMsg.libelleDate, '</div>');
            if (GApplication.droits.get(TypeDroits.communication.avecDiscussionAvancee) && aMsg.listeEtiquettes && aMsg.listeEtiquettes.GetNbrElements() > 0) {
                H.push('<div style="flex: none; display:flex; justify-content:flex-end;">', TUtilitaireMessagerie.dessinListeEtiquettes(aMsg.listeEtiquettes), '</div>');
            }
            H.push('</div>');
            var lMessage = aMsg.ferme ? GTraductions.getValeur('Messagerie.HintDiscussionTerminee') : aMsg.estSignalantContenu ? GTraductions.getValeur('Messagerie.HintSignalementContenu') : aMsg.estSignalantPourSuppr ? GTraductions.getValeur('Messagerie.HintSignalementPourSuppr') : aMsg.estSorti ? GTraductions.getValeur('Messagerie.HintDiscussionSorti') : '';
            if (lMessage) {
                H.push('<div style="color:red;">', lMessage, '</div>');
            }
            H.push('<div class="secondary-content AvecMain ' + (lAvecDest && lDestMultiple ? 'Image_Messagerie_Groupe' : ' truncate') + '" style="max-width:', lLargeurDest, ';" ' + (lAvecDest && lDestMultiple && aMsg.messagePourParticipants ? GHtml.composeAttr('ie-node', 'getNodeDest', [aMsg.messagePourParticipants.GetNumero()]) : ''), '>', lAvecDest && !lDestMultiple ? aMsg.public : '', '</div>');
            return H.join('');
        };

        function _popupListeDestinataires(aNumeroMessage, aEstPublicParticipant, aEstDestinatairesReponse) {
            TUtilitaireMessagerie.getListePublicMessage_promise(this, aNumeroMessage, aEstPublicParticipant, aEstDestinatairesReponse).then(function(aListeDest) {
                if (!aListeDest || aListeDest.GetNbrElements() === 0) {
                    return;
                }
                var lHtml = [];
                lHtml.push('<ul class="collection" style="margin:0;">');
                aListeDest.parcourir(function(aDest) {
                    var lLibelleSupp = aDest.estSorti ? '&nbsp;<i class="icon_sortir_reintegrer_conversation"></i>&nbsp;' + GTraductions.getValeur('Messagerie.Retire') : '';
                    lHtml.push('<li class="collection-item">', aListeDest.avecConnection ? TUtilitaireMessagerie.contruirePublicConnecte(aDest, lLibelleSupp) : aDest.GetLibelle() + lLibelleSupp, '</li>');
                });
                lHtml.push('</ul>');
                GInterface.setPopupHeader('<h1 class="truncate">' + GTraductions.getValeur('Messagerie.ListeDestinataires') + '</h1>');
                GInterface.setPopupFooter('');
                GInterface.setPopupContent(lHtml.join(''));
                GInterface.openPopup();
            });
        }
        ObjetMessagerie.prototype.changeMessage = function(aCroissant) {
            if (!!this.listeMessagerie && this.listeMessagerie.GetNbrElements() > 0) {
                var lNewIndice = this.indiceMessage + (aCroissant ? 1 : -1);
                if (lNewIndice < 0) {
                    lNewIndice = this.listeMessagerie.GetNbrElements() - 1;
                } else if (lNewIndice > this.listeMessagerie.GetNbrElements() - 1) {
                    lNewIndice = 0;
                }
                if (this.indiceMessage !== lNewIndice) {
                    this.surClicConversation(lNewIndice);
                }
            }
        };
        ObjetMessagerie.prototype.surClicConversation = function(aNb) {
            this.indiceMessage = aNb;
            this.message = this.listeMessagerie.GetElement(aNb);
            _requeteListeMessages.call(this, {
                message: this.message,
                indice: aNb
            });
            $("body").scrollTop(0);
        };

        function _requeteListeMessages(aParams) {
            new ObjetRequeteListeMessages(this, this.composeListeMessages.bind(this, {
                indice: aParams.indice,
                messageListe: aParams.message
            })).lancerRequete({
                message: aParams.message,
                marquerCommeLu: true,
                nbMessagesVus: TUtilitaireMessagerie.palierNbMessages
            });
        }
        ObjetMessagerie.prototype.retourListe = function() {
            $("#" + this.idFenetreConversation.escapeJQ()).hide();
            $("#" + this.idDiscussions.escapeJQ()).show();
            this.identBtnFlottant.SetVisible(true);
            $(".ui-content").css('height', 'auto');
            this.options.surChangementMessage(true);
            _requeteListe_promise.call(this).then(function() {}.bind(this));
        };
        ObjetMessagerie.prototype.composeListeMessages = function(aParamsBind, aParam) {
            $("#" + this.idDiscussions.escapeJQ()).hide();
            this.identBtnFlottant.SetVisible(false);
            $("#" + this.idFenetreConversation.escapeJQ()).show();
            this.options.surChangementMessage(false);
            this.pageDiscussion.setOptions({
                callbackPopupListeDest: _popupListeDestinataires.bind(this),
                strSuperUtilisateurs: this.strSuperUtilisateurs,
                listeEtiquettes: this.listeEtiquettes,
                listeMessagerie: this.listeMessagerie_TOUTES
            }).setDonnees({
                message: this.message,
                brouillon: aParam.brouillon,
                messagePourReponse: aParam.messagePourReponse,
                listeBoutons: aParam.listeBoutons,
                listeMessages: aParam.listeMessages,
                destinataires: aParam.destinataires,
                nbPossessionsMessageListe: aParam.nbPossessionsMessage
            });
        };
        ObjetMessagerie.prototype.recupererDonnees = function() {
            _requeteListe_promise.call(this).then(function() {
                if (GEtatUtilisateur.message) {
                    this.message = null;
                    this.indiceMessage = null;
                    this.listeMessagerie_TOUTES.parcourir(function(aMessage, aIndex) {
                        if (TUtilitaireMessagerie.avecPossessionPartageeEntreMessages(aMessage, GEtatUtilisateur.message)) {
                            this.message = aMessage;
                            this.indiceMessage = aIndex;
                            return false;
                        }
                    }.bind(this));
                    delete GEtatUtilisateur.message;
                    if (this.message) {
                        _requeteListeMessages.call(this, {
                            message: this.message,
                            indice: this.indiceMessage
                        });
                    }
                }
            }.bind(this));
        };

        function _requeteListe_promise(aIgnorerRecuperationEtiquettes) {
            return new ObjetRequeteListeMessagerie(this).lancerRequete({
                avecMessage: false,
                avecLu: true
            }).then(function(aParam) {
                this.listeMessagerie_TOUTES = aParam.listeMessagerie;
                this.strSuperUtilisateurs = aParam.strSuperUtilisateurs;
                this.listeEtiquettes = aParam.listeEtiquettes;
                this.listeDestinatairesCarnetLiaison = aParam.destinatairesCarnetLiaison;
                _setListeMessagerie.call(this, aParam.listeMessagerie);
                if (!aIgnorerRecuperationEtiquettes && this.options.surRequeteMessagerie) {
                    this.options.surRequeteMessagerie(this.listeMessagerie_TOUTES, aParam.listeEtiquettes);
                }
                return aParam;
            }.bind(this));
        }
        ObjetMessagerie.prototype._actionSurRecupererListe = function() {
            this.rechargerListeDiscussions();
            var lIndice = TUtilitaireMessagerie.getIndiceDiscussion(this.listeMessagerie_TOUTES, this.message);
            if (this.listeMessagerie_TOUTES.GetElement(lIndice) && (this.listeMessagerie_TOUTES.GetElement(lIndice).nbPublic || this.listeMessagerie_TOUTES.GetElement(lIndice).public)) {
                var lIndiceMessage = MethodesObjet.isNumber(this.indiceMessage) ? this.indiceMessage : -1;
                _requeteListeMessages.call(this, {
                    message: this.listeMessagerie_TOUTES.GetElement(lIndice),
                    indice: lIndiceMessage
                });
            }
        };
        ObjetMessagerie.prototype._evenementSurSaisieMessage = function() {
            _requeteListe_promise.call(this, true).then(this._actionSurRecupererListe.bind(this));
        };
        ObjetMessagerie.prototype.traiterContenu = function(aTabNodes) {
            return $(aTabNodes).map(function(aIndex) {
                return this.nodeName.toLowerCase() === 'br' ? '\n' : aIndex < aTabNodes.length - 1 ? $(this).text() + '\n' : $(this).text();
            }).get().join('');
        };
        ObjetMessagerie.prototype.composeConversation = function() {
            var lHtml = [];
            lHtml.push('<div id="' + this.pageDiscussion.Nom + '" style="display:none;"></div>');
            lHtml.push('<div id="' + this.idFenetreConversation + '" style="display:none;">');
            return lHtml.join('');
        };
        ObjetMessagerie.prototype.rechargerListeDiscussions = function() {
            $("#" + this.idListeDiscussions.escapeJQ()).IEHtml(_composeListe.call(this), {
                controleur: this.controleur
            });
        };

        function _ouvrirFenetreCreation(aInstance) {
            $("#" + aInstance.idDiscussions.escapeJQ()).hide();
            aInstance.identBtnFlottant.SetVisible(false);
            $("#" + aInstance.idFenetreConversation.escapeJQ()).show();
            aInstance.options.surChangementMessage(false);
            var lEstPrimParentSurEtiquetteCL = GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent && aInstance.etiquetteSelectionnee && aInstance.etiquetteSelectionnee.GetGenre() === TypeOrigineCreationEtiquetteMessage.OCEM_Pre_CarnetLiaison && aInstance.etiquetteSelectionnee.contexte && aInstance.etiquetteSelectionnee.contexte.GetNumero();
            var lListeDestCarnetLiaison = null;
            var lEleveCarnetLiaison = null;
            if (lEstPrimParentSurEtiquetteCL) {
                lEleveCarnetLiaison = aInstance.etiquetteSelectionnee.contexte;
                lListeDestCarnetLiaison = TUtilitaireMessagerie.getListeDestCarnetLiaisonDEleve_PrimParent(lEleveCarnetLiaison.GetNumero());
            }
            aInstance.pageDiscussion.setDonnees({
                message: aInstance.message,
                creationDiscussion: true,
                estPrimParentSurEtiquetteCL: lEstPrimParentSurEtiquetteCL,
                listeDestinatairesCarnetLiaison: lListeDestCarnetLiaison,
                eleveCarnetLiaison: lEleveCarnetLiaison,
                titre: lEstPrimParentSurEtiquetteCL ? GTraductions.getValeur('MessagerieCarnetLiaison.TitreFenetreNouveauPourVotreEnfant') : ''
            });
            aInstance.$refreshSelf();
        }

        function _composeListe() {
            var H = [];
            if (this.listeMessagerie.GetNbrElements() > 0) {
                H.push('<ul class="collection">');
                for (var i = 0; i < this.listeMessagerie.GetNbrElements(); i++) {
                    var lMsg = this.listeMessagerie.GetElement(i);
                    H.push('<li class="collection-item with-action" onclick="' + this.Nom + '.surClicConversation(' + i + ')">', this.getLibellePourListe(lMsg, i), '</li>');
                }
                H.push('</ul>');
            } else {
                H.push(this.composeAucuneDonnee(GTraductions.getValeur('Messagerie.AucuneDiscussion')));
            }
            return H.join('');
        }
        ObjetMessagerie.prototype.composeListeDiscussions = function() {
            var lHtml = [];
            lHtml.push('<div id="' + this.idDiscussions + '" style="margin-top:1em" ie-node="getNodeDiscussion">');
            lHtml.push('<div id="' + this.idListeDiscussions + '">');
            lHtml.push(_composeListe.call(this));
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        module.exports = ObjetMessagerie;
    },
    fn: "mobile/script/pagemessagerie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetMessagerie = require('mobile/script/PageMessagerie.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var TUtilitaireMessagerie = require('UtilitaireMessagerie.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageMessagerie_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageMessagerie_Mobile() {
            this.inheritedCreate(arguments);
            this.modeAuteur = false;
            this._etiquetteSelectionne = null;
        }
        ObjetAffichagePageMessagerie_Mobile.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, _evenementSelection, function(aInstance) {
                aInstance.SetParametres({
                    avecBoutonsPrecedentSuivant: false,
                    icone: null,
                    getTitre: function(aElement) {
                        return aElement.libelleHtml;
                    }
                });
            });
            this.AddSurZone = [this.identSelection];
            this.identPage = this.Add(ObjetMessagerie, null, function(aInstance) {
                aInstance.setOptions({
                    surChangementMessage: function(aEstListeVisible) {
                        this.GetInstance(this.identSelection).SetVisible(aEstListeVisible);
                    }.bind(this),
                    surRequeteMessagerie: _surRequeteMessagerie.bind(this)
                });
            });
        };

        function _surRequeteMessagerie(aListeMessageries, aListeEtiquettes) {
            TUtilitaireMessagerie.traiterListeEtiquette(aListeEtiquettes, false);
            aListeEtiquettes.parcourir(function(aEtiquette) {
                var lResultImageEtiquette = TUtilitaireMessagerie.contruireImageEtiquette(aEtiquette);
                var lCompteurMessages = 0;
                var lCompteurMessagesNonLues = 0;
                aListeMessageries.parcourir(function(aMessage) {
                    if (TUtilitaireMessagerie.estDiscussionVisibleSelonEtiquette(aMessage, aEtiquette)) {
                        lCompteurMessages += aMessage.nombreMessages > 0 ? aMessage.nombreMessages : 0;
                        lCompteurMessagesNonLues += aMessage.nbNonLus > 0 ? aMessage.nbNonLus : 0;
                    }
                });
                var lCompteur = lResultImageEtiquette.avecCompteurNonLu ? lCompteurMessagesNonLues : lCompteurMessages;
                var lLibelleCompteur = '';
                if (lCompteur > 0) {
                    lLibelleCompteur = '<div class="PetitEspaceGauche' + (lResultImageEtiquette.avecCompteurNonLu ? ' Gras' : '') + '">(' + lCompteur + ')</div>';
                }
                aEtiquette.libelleHtml = ['<div style="display:flex; align-items:center;">', '<div style="font-size: 1.3rem; margin-right:.4rem">', lResultImageEtiquette.icone, '</div>', aEtiquette.GetLibelle(), lLibelleCompteur, '</div>'].join('');
            }.bind(this));
            var lIndice = 0;
            var lMessage = null;
            if (GEtatUtilisateur.message) {
                lMessage = aListeMessageries.GetElement(TUtilitaireMessagerie.getIndiceDiscussion(aListeMessageries, GEtatUtilisateur.message));
            }
            this._etiquetteSelectionne = TUtilitaireMessagerie.getEtiquetteInitSelonMessage(aListeEtiquettes, this._etiquetteSelectionne, true, lMessage);
            if (this._etiquetteSelectionne) {
                lIndice = aListeEtiquettes.GetIndiceParElement(this._etiquetteSelectionne);
            }
            this.GetInstance(this.identSelection).SetDonnees(aListeEtiquettes, lIndice, '', '');
        }

        function _evenementSelection(aGenreEvenement, aParam) {
            this._etiquetteSelectionne = aParam.element;
            this.GetInstance(this.identPage).SetDonnees(this._etiquetteSelectionne);
        }
        ObjetAffichagePageMessagerie_Mobile.prototype.RecupererDonnees = function() {
            this.GetInstance(this.identPage).recupererDonnees();
        };
        module.exports = ObjetAffichagePageMessagerie_Mobile;
    },
    fn: "mobile/script/interfacepagemessagerie.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequetePageInfosPerso() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageInfosPerso', ObjetRequetePageInfosPerso, ObjetRequeteConsultation);
        ObjetRequetePageInfosPerso.prototype.lancerRequete = function() {
            return this.appelAsynchrone();
        };
        ObjetRequetePageInfosPerso.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequetePageInfosPerso;
    },
    fn: "objetrequetepageinfosperso.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetElement = require('ObjetElement.js');
        var GTraductions = require('ObjetTraduction.js');
        module.exports.TypeFiltreAffichage = {
            securisation: 'securisation',
            coords: 'coords',
            communication: 'communication',
            notification: 'notification',
            droitImage: 'droitImage'
        };
        var EGenreTypeContenu = {
            Notifications: 0,
            Autorisations: 1,
            DroitImage: 2,
            DerniereConnexion: 3,
            MotDePasse: 4,
            Identifiant: 5,
            Informations: 6,
            InfosCompteEnfant: 7,
            INE: 8,
            AutorisationSortie: 9,
            ProjetsAccompagnement: 10,
            InformationsMedicales: 11,
            RestrictionsAlimentaires: 12,
            Coordonnees: 13,
            PreferencesContact: 14,
            AutorisationsSupplementaires: 15,
            Interlocuteurs: 16,
            AutorisationsMessages: 17,
            DepotDocuments: 18,
            CommunicationParents: 19,
            ContenuCommunicationParents: 20,
            Medecin: 21,
            Allergies: 22,
            sourcesConnexions: 'sourcesConnexions'
        };
        module.exports.EGenreTypeContenu = EGenreTypeContenu;
        var EGenreTelephone = {
            mail: 1,
            telFixe: 2,
            telPort: 3,
            fax: 4
        };
        module.exports.EGenreTelephone = EGenreTelephone;
        var ETypeDelai = {
            min15: new ObjetElement(GTraductions.getValeur('PreferencesNotifications.15min'), 15),
            min30: new ObjetElement(GTraductions.getValeur('PreferencesNotifications.30min'), 30),
            h1: new ObjetElement(GTraductions.getValeur('PreferencesNotifications.1h'), 60),
            h4: new ObjetElement(GTraductions.getValeur('PreferencesNotifications.4h'), 240),
            h12: new ObjetElement(GTraductions.getValeur('PreferencesNotifications.12h'), 720),
            h24: new ObjetElement(GTraductions.getValeur('PreferencesNotifications.24h'), 1440)
        };
        module.exports.ETypeDelai = ETypeDelai;
        var EListeIds = {
            identifiant: '_ident',
            mdp: '_mdp',
            email: '_email',
            cbSMS: 'cbSMS',
            cbMail: 'cbMail',
            cbMailEtab: 'cbMailEtab',
            cbParent: 'cbParent',
            cbCourrier: 'cbCourrier',
            cbMsgParent: 'cbMsgParent',
            cbMsgEleve: 'cbMsgEleve',
            cbMsgProfsPerso: 'cbMsgProfsPerso',
            cbMsgContactVS: 'cbMsgContactVS',
            cbNotifs: 'cbNotif',
            comboDelai: 'comboNotif',
            cbNotifsTravaux: 'cbNotifTravaux',
            comboDelaiTravaux: 'comboNotifTravaux',
            cbDroitImage: 'cbDroitImage',
            cbExposerDossierMedical: 'cbExposerDosierMedical',
            cbAutoriserHospitalisation: 'cbAutoriserHospitalisation',
            cbDestinataireBulletin: 'cbDestinataireBulletin',
            cbDestinataireInfosEleve: 'cbDestinataireInfosEleve',
            cbDestinataireInfosProf: 'cbDestinataireInfosProf',
            cbDestinataireInfosGen: 'cbDestinataireInfosGen',
            mdpEnfant: 'mdp_enfant',
            sideNav: '_idSideNav',
            sideInterlocuteurs: '_idSideNavInterlocuteurs',
            sidePreferences: '_idSideNavPreferences',
            sideInformations: '_idSideNavInformations',
            sideCommunicationParents: 'idsideCommunicationParents'
        };
        module.exports.EListeIds = EListeIds;
        var EGenreDestinataire = {
            SMS: 1,
            Email: 2,
            Courrier: 3
        };
        module.exports.EGenreDestinataire = EGenreDestinataire;
        var ETypeSwitch = {
            Bulletin: 1,
            InfosEleve: 2,
            InfosProfesseur: 3,
            InfosGenerales: 4
        };
        module.exports.ETypeSwitch = ETypeSwitch;
    },
    fn: "enumere_donneespersonnelles.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');

        function UtilitaireProjetAccompagnement() {
            this.theme = {
                normal: 'normal',
                bloc: 'bloc'
            };
        }

        function _construireProjetsAccompagnementNormal(aProjetAccompagnement) {
            var H = [];
            H.push('<b>');
            H.push(aProjetAccompagnement.GetLibelle());
            if (aProjetAccompagnement.motifs && aProjetAccompagnement.motifs.length > 0) {
                H.push('<span>', ' (', aProjetAccompagnement.motifs, ')', '</span>');
            }
            H.push('</b>');
            if (!!aProjetAccompagnement.dateDebut || !!aProjetAccompagnement.dateFin) {
                var lLibelleDate;
                if (!!aProjetAccompagnement.dateDebut && !!aProjetAccompagnement.dateFin) {
                    lLibelleDate = GTraductions.getValeur('Du') + ' ' + aProjetAccompagnement.dateDebut + ' ' + GTraductions.getValeur('Au') + ' ' + aProjetAccompagnement.dateFin;
                } else {
                    lLibelleDate = (!!aProjetAccompagnement.dateDebut) ? GTraductions.getValeur('aPartirDu') + ' ' + aProjetAccompagnement.dateDebut : GTraductions.getValeur('jusquAu') + ' ' + aProjetAccompagnement.dateFin;
                }
                H.push(' - ', lLibelleDate);
            }
            if (aProjetAccompagnement.commentaire && aProjetAccompagnement.commentaire.length > 0) {
                H.push('<div>', aProjetAccompagnement.commentaire, '</div>');
            }
            if (aProjetAccompagnement.docJoints && aProjetAccompagnement.docJoints.GetNbrElements() > 0) {
                var lListeDocJoints = [],
                    lLienDocJoint;
                aProjetAccompagnement.docJoints.parcourir(function(D) {
                    lLienDocJoint = GChaine.composerUrlLienExterne({
                        documentJoint: D
                    });
                    lListeDocJoints.push(lLienDocJoint);
                });
                H.push('<div>', lListeDocJoints.join(' - '), '</div>');
            }
            return H.join('');
        }

        function _construireProjetsAccompagnementTitreWidget(aProjetAccompagnement) {
            var H = [];
            H.push('<b>');
            H.push(aProjetAccompagnement.GetLibelle());
            if (!!aProjetAccompagnement.dateDebut || !!aProjetAccompagnement.dateFin) {
                var lLibelleDate;
                if (!!aProjetAccompagnement.dateDebut && !!aProjetAccompagnement.dateFin) {
                    lLibelleDate = GTraductions.getValeur('Du') + ' ' + aProjetAccompagnement.dateDebut + ' ' + GTraductions.getValeur('Au') + ' ' + aProjetAccompagnement.dateFin;
                } else {
                    lLibelleDate = (!!aProjetAccompagnement.dateDebut) ? GTraductions.getValeur('aPartirDu') + ' ' + aProjetAccompagnement.dateDebut : GTraductions.getValeur('jusquAu') + ' ' + aProjetAccompagnement.dateFin;
                }
                H.push(' - ', lLibelleDate);
            }
            H.push('</b>');
            return H.join('');
        }

        function _construireProjetsAccompagnementContenuWidget(aProjetAccompagnement, aParams) {
            var H = [];
            H.push('<div class="Espace">');
            if (aProjetAccompagnement.motifs && aProjetAccompagnement.motifs.length > 0) {
                H.push('<div class="EspaceBas">', aProjetAccompagnement.motifs, '</div>');
            }
            if (aProjetAccompagnement.commentaire && aProjetAccompagnement.commentaire.length > 0) {
                H.push('<div class="EspaceBas">', aProjetAccompagnement.commentaire, '</div>');
            }
            if (aProjetAccompagnement.docJoints && aProjetAccompagnement.docJoints.GetNbrElements() > 0) {
                var lListeDocJoints = [],
                    lLienDocJoint;
                aProjetAccompagnement.docJoints.parcourir(function(D) {
                    lLienDocJoint = GChaine.composerUrlLienExterne({
                        documentJoint: D
                    });
                    lListeDocJoints.push(lLienDocJoint);
                });
                H.push('<div class="EspaceBas">', lListeDocJoints.join(' - '), '</div>');
            }
            if (aParams.avecConsultationEquipePeda) {
                H.push('<div>', (aProjetAccompagnement.estConsultableEquipePeda ? GTraductions.getValeur('PageCompte.ProjetConsultable') : GTraductions.getValeur('PageCompte.ProjetNonConsultable')), '</div>');
            }
            H.push('</div>');
            return H.join('');
        }
        UtilitaireProjetAccompagnement.prototype.composeProjetAccompagnement = function(aProjetAccompagnement, aParams) {
            if (!aParams) {
                aParams = {};
            }
            var lParams = {
                avecConsultationEquipePeda: aParams.avecConsultationEquipePeda
            };
            var lHtml = [];
            switch (aParams.theme) {
                case this.theme.normal:
                    lHtml.push(_construireProjetsAccompagnementNormal(aProjetAccompagnement));
                    break;
                default:
                    lHtml.push('<div>', _construireProjetsAccompagnementTitreWidget(aProjetAccompagnement), '</div>');
                    lHtml.push('<div>', _construireProjetsAccompagnementContenuWidget(aProjetAccompagnement, lParams), '</div>');
                    break;
            }
            return lHtml.join('');
        };
        UtilitaireProjetAccompagnement.prototype.composeListeProjetsAccompagnement = function(aListeProjets, aParams) {
            if (!aParams) {
                aParams = {};
            }
            var lParams = {
                avecConsultationEquipePeda: aParams.avecConsultationEquipePeda,
                theme: aParams.theme
            };
            var lHtml = [];
            if (!!aListeProjets && aListeProjets.GetNbrElements() > 0) {
                var lThis = this;
                aListeProjets.parcourir(function(aProjetAcc, aIndex) {
                    var lMarginTop = aIndex === 0 ? '' : 'margin-top: 10px;';
                    if (aProjetAcc.estConsultableEquipePeda) {
                        lHtml.push('<div style="', lMarginTop, '">', lThis.composeProjetAccompagnement(aProjetAcc, lParams), '</div>');
                    }
                });
            }
            return lHtml.join('');
        };
        module.exports = new UtilitaireProjetAccompagnement();
    },
    fn: "utilitaireprojetaccompagnement.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetSaisieMotDePasseCP = require('ObjetSaisieMotDePasseCP.js');
        var GChaine = require('GChaine.js');

        function ObjetFenetre_SaisieMdpCP() {
            this.inheritedCreate(arguments);
            this.setOptionsFenetre({
                titre: GChaine.Insecable(GTraductions.getValeur('saisieMDP.TitreFenetre')),
                listeBoutons: [
                    GTraductions.getValeur('Annuler'), {
                        valider: true,
                        libelle: GTraductions.getValeur('Valider')
                    }
                ],
                avecTailleSelonContenu: true,
                largeur: 300,
                optionsMDP: {
                    forcerModificationMdp: false
                }
            });
        }
        MethodesObjet.heritagePrototype(ObjetFenetre_SaisieMdpCP, ObjetFenetre);
        ObjetFenetre_SaisieMdpCP.prototype.ConstruireInstances = function() {
            this.identMDP = this.Add(ObjetSaisieMotDePasseCP);
        };
        ObjetFenetre_SaisieMdpCP.prototype.ComposeContenu = function() {
            return ['<div id="', this.GetInstance(this.identMDP).GetNom(), '"></div>'].join('');
        };
        ObjetFenetre_SaisieMdpCP.prototype.SetDonnees = function(aDonneesReglesMdp) {
            this.Afficher();
            this.GetInstance(this.identMDP).setOptions(Object.assign(this.optionsFenetre.optionsMDP || {}, {
                donneesReglesMdp: aDonneesReglesMdp,
                callbackFocusValidation: function() {
                    this.setBoutonFocus({
                        valider: true
                    });
                }.bind(this),
                callbackApresValidation: function(aParams) {
                    if (aParams) {
                        this.Fermer();
                        this.callback.appel(!aParams.avecErreur, aParams);
                    }
                }.bind(this)
            })).SetDonnees();
            this.positionnerFenetre();
        };
        ObjetFenetre_SaisieMdpCP.prototype.getControleur = function(aInstance) {
            return {
                fenetreBtn: {
                    getDisabled: function(aBoutonRepeat) {
                        return aBoutonRepeat.element.valider ? !aInstance.GetInstance(aInstance.identMDP).avecValidationPossible() : false;
                    }
                }
            };
        };
        ObjetFenetre_SaisieMdpCP.prototype.SurValidation = function(ANumeroBouton) {
            var lBouton = this.getBoutonNumero(ANumeroBouton);
            if (lBouton && lBouton.valider) {
                this.GetInstance(this.identMDP).valider();
            } else {
                this.Fermer();
                this.callback.appel(false);
            }
        };
        module.exports = ObjetFenetre_SaisieMdpCP;
    },
    fn: "objetfenetre_saisiemdpcp.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetFenetre_SaisieMdpCP = require('ObjetFenetre_SaisieMdpCP.js');
        var ObjetSaisieMotDePasseCP = require('ObjetSaisieMotDePasseCP.js');

        function ObjetFenetre_ModificationIdentifiantMDP() {
            this.inheritedCreate(arguments);
            this.changementMDP = true;
            this.changementMDPEleve = false;
        }
        MethodesObjet.heritagePrototype(ObjetFenetre_ModificationIdentifiantMDP, ObjetFenetre_SaisieMdpCP);
        ObjetFenetre_ModificationIdentifiantMDP.prototype.SetDonnees = function() {
            this.setOptionsFenetre({
                titre: GChaine.Insecable(this.changementMDPEleve ? GTraductions.getValeur('PageCompte.titreEcranMotDePasseEnfant') : this.changementMDP ? GTraductions.getValeur('PageCompte.titreEcranMotDePasse') : GTraductions.getValeur('PageCompte.titreEcranIdentifiant'))
            });
            var lOptions = {
                avecMDPActuel: !this.changementMDPEleve,
                avecReglesMDP: this.changementMDP,
                avecMdpNouveauDifferentDeActuel: this.changementMDP && !this.changementMDPEleve,
                setReglesMDP: function(aJSON) {
                    GEtatUtilisateur.setReglesSaisieMotDePasse(aJSON);
                },
                avecMessageReussiteModif: true,
                libelleMDPActuel: this.changementMDP ? GTraductions.getValeur('PageCompte.libelle1EcranMotDePasse') : GTraductions.getValeur('PageCompte.libelle1EcranIdentifiant'),
                libelleNewMDP: this.changementMDP ? this.changementMDPEleve ? GTraductions.getValeur('PageCompte.libelle1EcranMotDePasseEleve') : GTraductions.getValeur('PageCompte.libelle2EcranMotDePasse') : GTraductions.getValeur('PageCompte.libelle2EcranIdentifiant') + '<br/>' + GChaine.Format(GTraductions.getValeur('PageCompte.conseil2EcranIdentifiant'), [ObjetSaisieMotDePasseCP.C_TailleMinLogin]),
                libelleConfirmNewMDP: this.changementMDPEleve ? GTraductions.getValeur('PageCompte.libelle2EcranMotDePasseEleve') : this.changementMDP ? GTraductions.getValeur('PageCompte.libelle3EcranMotDePasse') : GTraductions.getValeur('PageCompte.libelle3EcranIdentifiant'),
                libelleEchecModification: GTraductions.getValeur('saisieMDP.EchecModification'),
                libelleReussiteModification: GTraductions.getValeur('saisieMDP.ReussiteModification'),
                libelleConfirmationIncorrecte: this.changementMDP ? GTraductions.getValeur('saisieMDP.ConfirmationIncorrecte') : GTraductions.getValeur('PageCompte.message3Identifiant')
            };
            if (!this.changementMDP) {
                lOptions.attrInputNouveau = 'type="text" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" ie-textbrut';
            }
            this.GetInstance(this.identMDP).setOptions(lOptions);
            this.inherited('SetDonnees', arguments);
        };
        module.exports = ObjetFenetre_ModificationIdentifiantMDP;
    },
    fn: "objetfenetre_modificationidentifiantmdp.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GStyle = require('GStyle.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreTypeContenu = require('Enumere_DonneesPersonnelles.js').EGenreTypeContenu;
        var EGenreTelephone = require('Enumere_DonneesPersonnelles.js').EGenreTelephone;
        var EListeIds = require('Enumere_DonneesPersonnelles.js').EListeIds;
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var GDate = require('ObjetDate.js').GDate;
        var EGenreCryptage = require('Enumere_Cryptage.js');
        var GCryptage = require('ObjetCryptage.js');
        var EGenreDestinataire = require('Enumere_DonneesPersonnelles.js').EGenreDestinataire;
        var ETypeSwitch = require('Enumere_DonneesPersonnelles.js').ETypeSwitch;
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var UtilitaireProjetAccompagnement = require('UtilitaireProjetAccompagnement.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var EGenreEvenementObjetSaisie = require('Enumere_EvenementObjetSaisie.js');
        var EGenreSaisie = require('Enumere_Saisie.js');
        var ObjetRequeteSecurisationComptePreference = require('ObjetRequeteSecurisationCompte.js').ObjetRequeteSecurisationComptePreference;
        var TypeCommandeSecurisationCompteHttp = require('TypeSecurisationCompte.js').TypeCommandeSecurisationCompteHttp;
        var ObjetFenetre_ModificationIdentifiantMDP = require('ObjetFenetre_ModificationIdentifiantMDP.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetElement = require('ObjetElement.js');
        var TypeFiltreAffichage = require('Enumere_DonneesPersonnelles.js').TypeFiltreAffichage;
        require('espace/css/UtilitairePageDonneesPersonnelles.css');

        function UtilitairePageDonneesPersonnelles() {}
        UtilitairePageDonneesPersonnelles.construireZone = function(aTitre, aContenu) {
            var H = [];
            var lLargeurGauche = 160;
            H.push('<div class="NoWrap EspaceGauche GrandEspaceHaut GrandEspaceBas CarteCompteZoneGenerique">');
            if (!!aTitre) {
                H.push('<div class="WhiteSpaceNormal InlineBlock Gras AlignementHaut"', ' style="', GStyle.composeWidth(lLargeurGauche), GStyle.composeCouleurTexte(GCouleur.texte), '">', '<span class="GrandEspaceDroit CarteCompteZoneGenerique_Title">', aTitre, '</span>', '</div>');
            }
            H.push(aContenu);
            H.push('</div>');
            return H.join('');
        };
        UtilitairePageDonneesPersonnelles.construireZoneGenerique = function(aTitre, aTypeContenu, aParams) {
            var H = [];
            var lLargeurGauche = GEtatUtilisateur.estEspaceMobile() ? '100%' : 160;
            H.push('<div ', (GEtatUtilisateur.estEspaceMobile() ? '' : 'style="display:flex;"'), 'class="CarteCompteZoneGenerique">');
            if (!!aTitre) {
                H.push('<div class="WhiteSpaceNormal', GEtatUtilisateur.estEspaceMobile() ? '' : ' InlineBlock', ' Gras AlignementHaut"', ' style="', (GEtatUtilisateur.estEspaceMobile() ? '' : 'flex:0 0 auto;'), GStyle.composeWidth(lLargeurGauche), GStyle.composeCouleurTexte(GCouleur.texte), '">', '<span class="GrandEspaceDroit ', GEtatUtilisateur.estEspaceMobile() ? '' : 'CarteCompteZoneGenerique_Title', '">', aTitre, '</span>', '</div>');
            }
            if (GEtatUtilisateur.estEspaceMobile()) {
                H.push('<div style="width:100%">');
            }
            H.push('<div class="InlineBlock"', GEtatUtilisateur.estEspaceMobile() ? '' : 'style="flex:1 1 auto;max-width:840px;"', '>');
            switch (aTypeContenu) {
                case EGenreTypeContenu.Notifications:
                    H.push(_construireNotifications(aParams.envoiMail, aParams.notificationMail, aParams.notificationMailTravaux));
                    break;
                case EGenreTypeContenu.DroitImage:
                    H.push(_construireDroitImage(aParams));
                    break;
                case EGenreTypeContenu.Autorisations:
                    H.push(_construireAutorisations(aParams));
                    break;
                case EGenreTypeContenu.DerniereConnexion:
                    H.push(_construireDerniereConnexion());
                    break;
                case EGenreTypeContenu.MotDePasse:
                    H.push(_construireMotDePasse(aParams));
                    break;
                case EGenreTypeContenu.Identifiant:
                    H.push(_construireIdentifiant(aParams));
                    break;
                case EGenreTypeContenu.Coordonnees:
                    H.push(_construireCoordonnees(aParams));
                    break;
                case EGenreTypeContenu.InfosCompteEnfant:
                    H.push(_construireInformationsCompteEnfant(aParams));
                    break;
                case EGenreTypeContenu.INE:
                    H.push(aParams.numeroINE);
                    break;
                case EGenreTypeContenu.AutorisationSortie:
                    if (!GEtatUtilisateur.estEspaceMobile()) {
                        H.push('<div class="WhiteSpaceNormal InlineBlock" id="' + aParams.identiteAutorisations + '"></div>');
                    } else {
                        H.push(_construireAutorisationSortie(aParams));
                    }
                    break;
                case EGenreTypeContenu.ProjetsAccompagnement:
                    H.push(_construireProjetsAccompagnement(aParams));
                    break;
                case EGenreTypeContenu.InformationsMedicales:
                    if (!GEtatUtilisateur.estEspaceMobile()) {
                        H.push('<div class="WhiteSpaceNormal InlineBlock" style="', GStyle.composeWidth(500), '" id="' + aParams.identiteInfosMedicales + '"></div>');
                    } else {
                        H.push(_construireInformationsMedicales(aParams));
                    }
                    break;
                case EGenreTypeContenu.RestrictionsAlimentaires:
                    if (!GEtatUtilisateur.estEspaceMobile()) {
                        H.push('<div class="WhiteSpaceNormal InlineBlock" style="', GStyle.composeWidth(500) + GStyle.composeHeight(100), '" id="' + aParams.identiteRestrictionsAlimentaires + '"></div>');
                    } else {
                        H.push(_construireRestrictionsAlimentaires(aParams));
                    }
                    break;
                case EGenreTypeContenu.Medecin:
                    H.push(this.composeMedecin(aParams));
                    break;
                case EGenreTypeContenu.Allergies:
                    if (!GEtatUtilisateur.estEspaceMobile()) {
                        H.push('<div class="WhiteSpaceNormal InlineBlock" style="', GStyle.composeWidth(500), '" id="' + aParams.identiteInfosAllergies + '"></div>');
                    }
                    break;
                case EGenreTypeContenu.Informations:
                    H.push(_construireInformations(aParams));
                    break;
                case EGenreTypeContenu.PreferencesContact:
                    H.push(_construirePreferencesContact(aParams));
                    break;
                case EGenreTypeContenu.AutorisationsSupplementaires:
                    H.push(_construireAutorisationsSupp(aParams));
                    break;
                case EGenreTypeContenu.Interlocuteurs:
                    H.push(_construireInterlocuteurs(aParams));
                    break;
                case EGenreTypeContenu.AutorisationsMessages:
                    H.push(_construireAutorisationsMessages(aParams));
                    break;
                case EGenreTypeContenu.CommunicationParents:
                    H.push(_construireCommunicationsParents(aParams));
                    break;
                case EGenreTypeContenu.ContenuCommunicationParents:
                    H.push(_construireContenuCommunicationsParents(aParams));
                    break;
                case EGenreTypeContenu.DepotDocuments:
                    H.push('<div class="WhiteSpaceNormal InlineBlock" id="' + aParams.identListeDocumentsAFournir + '"></div>');
                    break;
                case EGenreTypeContenu.sourcesConnexions:
                    H.push('<div class="WhiteSpaceNormal InlineBlock" id="', aParams.idSourcesConnexions, '"></div>');
                    break;
            }
            H.push('</div>');
            H.push('</div>');
            if (GEtatUtilisateur.estEspaceMobile()) {
                H.push('</div>');
            }
            return H.join('');
        };
        UtilitairePageDonneesPersonnelles.getControleur = function() {
            var avecSaisieCoordonnees = GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoCoordonnees);
            var lControleur = {
                tel: {
                    getValue: function(aChamp) {
                        return this.instance.donnees.Informations[aChamp];
                    },
                    setValue: function(aChamp, aValue) {
                        this.instance.donnees.Informations[aChamp] = aValue;
                        if (aChamp === 'telephonePortable') {
                            this.instance.donnees.Autorisations.SMSAutorise = (aValue !== '') && this.instance.donnees.Autorisations.SMSAutorise;
                        }
                    },
                    getDisabled: function() {
                        return !GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoCoordonnees);
                    }
                },
                CBDiscussionAvecParents: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.optionCommunicationActivationdiscussion;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.optionCommunicationActivationdiscussion = aValue;
                        GEtatUtilisateur.Identification.ressource.avecDiscussionResponsables = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return (false);
                    }
                },
                CBCommuniquerMail: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.optionCommunicationPublicationMail;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.optionCommunicationPublicationMail = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return (false);
                    }
                },
                indFixeMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['indFixe'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['indFixe'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                telFixeMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['telFixe'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['telFixe'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                indPortMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['indMobile'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['indMobile'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                telPortMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['telMobile'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['telMobile'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                nomMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['nomMedecin'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['nomMedecin'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                adresse1Medecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['adresse1'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['adresse1'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                adresse2Medecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['adresse2'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['adresse2'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                CPMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['codePostal'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['codePostal'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                VilleMedecin: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.medecin['libellePostal'];
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.medecin['libellePostal'] = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                libellePreferencesContact: {
                    getLibelle: function() {
                        var libelle = [];
                        if (this.instance.donnees.Autorisations.SMSAutorise) {
                            libelle.push(GTraductions.getValeur('infosperso.SMS'));
                        }
                        if (this.instance.donnees.Autorisations.emailAutorise) {
                            var lTexteEmail = GTraductions.getValeur('infosperso.Email');
                        }
                        if (this.instance.donnees.Autorisations.eMailEtablissementAutorise !== null && this.instance.donnees.Autorisations.eMailParentAutorise !== null && ((GEtatUtilisateur.GenreEspace !== EGenreEspace.Parent) && (GEtatUtilisateur.GenreEspace !== EGenreEspace.Mobile_Parent))) {
                            var libelleDetails = [];
                            if (this.instance.donnees.Autorisations.eMailEtablissementAutorise) {
                                libelleDetails.push(GTraductions.getValeur('infosperso.EmailEtablissement').toLowerCase());
                            }
                            if (this.instance.donnees.Autorisations.eMailParentAutorise) {
                                libelleDetails.push(GTraductions.getValeur('infosperso.EMailParents').toLowerCase());
                            }
                            if (this.instance.donnees.Autorisations.eMailEtablissementAutorise || this.instance.donnees.Autorisations.eMailParentAutorise) {
                                lTexteEmail += (' (' + libelleDetails.join(', ') + ')');
                            }
                        }
                        if (this.instance.donnees.Autorisations.emailAutorise) {
                            libelle.push(lTexteEmail);
                        }
                        if (this.instance.donnees.Autorisations.courrierPapierAutorise) {
                            libelle.push(GTraductions.getValeur('infosperso.Papier'));
                        }
                        return libelle.join(', ');
                    }
                },
                libelleInterlocuteurs: {
                    getLibelle: function() {
                        var libelle = [];
                        if (this.instance.donnees.Autorisations.msgParent) {
                            libelle.push(GTraductions.getValeur('infosperso.DiscussionsParents'));
                        }
                        if (this.instance.donnees.Autorisations.msgEleve) {
                            libelle.push(GTraductions.getValeur('infosperso.DiscussionsEleves'));
                        }
                        libelle.push(GTraductions.getValeur('infosperso.DiscussionsProfsPersos'));
                        return libelle.join(', ');
                    }
                },
                libelleCommunicationParents: {
                    getLibelle: function() {
                        var libelle = [];
                        if (this.instance.donnees.Autorisations.optionCommunicationActivationdiscussion) {
                            libelle.push(GTraductions.getValeur('infosperso.communiquerEmail'));
                        }
                        if (this.instance.donnees.Autorisations.optionCommunicationPublicationMail) {
                            libelle.push(GTraductions.getValeur('infosperso.discussionsAvecParents'));
                        }
                        return libelle.join(', ');
                    }
                },
                libelleInformations: {
                    getLibelle: function() {
                        var libelle = [];
                        if (this.instance.donnees.Autorisations.estDestinataireInfosGenerales) {
                            libelle.push(GTraductions.getValeur('infosperso.titreInfosGen'));
                        }
                        for (var i = 0; i < this.instance.donnees.Autorisations.listeEleves.GetNbrElements(); i++) {
                            var lEleve = this.instance.donnees.Autorisations.listeEleves.GetElement(i);
                            var libellesEleve = [];
                            libelle.push('<div> ');
                            libelle.push(lEleve.GetLibelle() + ' : ');
                            if (lEleve.estDestinataireBulletin) {
                                libellesEleve.push(GTraductions.getValeur('infosperso.titreBulletin'));
                            }
                            if (lEleve.estDestinataireInfosEleve) {
                                libellesEleve.push(GTraductions.getValeur('infosperso.titreInfosEleve'));
                            }
                            if (lEleve.estDestinataireInfosProfesseur) {
                                libellesEleve.push(GTraductions.getValeur('infosperso.titreInfosProf'));
                            }
                            libelle.push(libellesEleve.join(', '));
                            libelle.push('</div>');
                        }
                        return libelle.join('');
                    }
                },
                eMail: {
                    getValue: function() {
                        return this.instance.donnees.Informations.eMail;
                    },
                    setValue: function(aChamp, aValue) {
                        this.instance.donnees.Informations.eMail = aValue.value;
                        this.instance.donnees.Autorisations.emailAutorise = (aValue.value !== '');
                        this.instance.SetEtatSaisie(true);
                    }
                },
                switchNotification: {
                    getValue: function() {
                        return this.instance.donnees.notifications.notificationMail;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.notifications.notificationMail = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                switchNotificationTravaux: {
                    getValue: function() {
                        return this.instance.donnees.notifications.notificationMailTravaux;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.notifications.notificationMailTravaux = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                switchAutoriserImage: {
                    getValue: function() {
                        return !this.instance.donnees.droitImage.autoriser;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.droitImage.autoriser = !aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                switchSMSAutorise: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.SMSAutorise;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.SMSAutorise = aValue;
                        this.instance.SetEtatSaisie(true);
                        UtilitairePageDonneesPersonnelles.swapImage(EGenreDestinataire.SMS, aValue);
                    },
                    getDisabled: function() {
                        return !(this.instance.donnees.Informations['telephonePortable'] && avecSaisieCoordonnees);
                    }
                },
                switchEmailAutorise: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.emailAutorise;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.emailAutorise = aValue;
                        if (!aValue) {
                            this.instance.donnees.Autorisations.eMailEtablissementAutorise = false;
                            this.instance.donnees.Autorisations.eMailParentAutorise = false;
                        }
                        this.instance.SetEtatSaisie(true);
                        UtilitairePageDonneesPersonnelles.swapImage(EGenreDestinataire.Email, aValue);
                    },
                    getDisabled: function() {
                        return !avecSaisieCoordonnees || !this.instance.donnees.Informations.eMail;
                    }
                },
                switchEmailEtablissementAutorise: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.eMailEtablissementAutorise;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.eMailEtablissementAutorise = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return !(this.instance.donnees.Autorisations.emailAutorise && avecSaisieCoordonnees);
                    }
                },
                switchEmailParentAutorise: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.eMailParentAutorise;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.eMailParentAutorise = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return !(this.instance.donnees.Autorisations.emailAutorise && avecSaisieCoordonnees);
                    }
                },
                switchCourrierPapierAutorise: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.courrierPapierAutorise;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.courrierPapierAutorise = aValue;
                        this.instance.SetEtatSaisie(true);
                        UtilitairePageDonneesPersonnelles.swapImage(EGenreDestinataire.Courrier, aValue);
                    },
                    getDisabled: function() {
                        return !avecSaisieCoordonnees;
                    }
                },
                switchMsgParent: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.msgParent;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.msgParent = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return !avecSaisieCoordonnees;
                    }
                },
                switchMsgProfPerso: {
                    getValue: function() {
                        return true;
                    },
                    getDisabled: function() {
                        return !avecSaisieCoordonnees;
                    }
                },
                switchMsgEleve: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.msgEleve;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.msgEleve = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return !avecSaisieCoordonnees;
                    }
                },
                switchMsgVieScolaire: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.estContactVS;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.estContactVS = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                switchBulletin: {
                    getValue: function(aChamp) {
                        return this.instance.donnees.Autorisations.listeEleves.GetElement(aChamp).estDestinataireBulletin;
                    },
                    setValue: function(aChamp, aValue) {
                        this.instance.donnees.Autorisations.listeEleves.GetElement(aChamp).estDestinataireBulletin = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return (!this.instance.donnees.Autorisations.emailAutorise && !this.instance.donnees.Autorisations.courrierPapierAutorise);
                    }
                },
                switchInfosEleve: {
                    getValue: function(aChamp) {
                        return this.instance.donnees.Autorisations.listeEleves.GetElement(aChamp).estDestinataireInfosEleve;
                    },
                    setValue: function(aChamp, aValue) {
                        this.instance.donnees.Autorisations.listeEleves.GetElement(aChamp).estDestinataireInfosEleve = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return (!this.instance.donnees.Autorisations.emailAutorise &&
                            !this.instance.donnees.Autorisations.SMSAutorise &&
                            !this.instance.donnees.Autorisations.courrierPapierAutorise);
                    }
                },
                switchInfosProfs: {
                    getValue: function(aChamp) {
                        return this.instance.donnees.Autorisations.listeEleves.GetElement(aChamp).estDestinataireInfosProfesseur;
                    },
                    setValue: function(aChamp, aValue) {
                        this.instance.donnees.Autorisations.listeEleves.GetElement(aChamp).estDestinataireInfosProfesseur = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return (!this.instance.donnees.Autorisations.emailAutorise);
                    }
                },
                switchInfosGen: {
                    getValue: function() {
                        return this.instance.donnees.Autorisations.estDestinataireInfosGenerales;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.Autorisations.estDestinataireInfosGenerales = aValue;
                        this.instance.SetEtatSaisie(true);
                    },
                    getDisabled: function() {
                        return (!this.instance.donnees.Autorisations.emailAutorise &&
                            !this.instance.donnees.Autorisations.SMSAutorise &&
                            !this.instance.donnees.Autorisations.courrierPapierAutorise);
                    }
                },
                delaiNotif: {
                    init: function(aCombo) {
                        aCombo.setOptions_ObjetSaisie({
                            mode: EGenreSaisie.Combo,
                            longueur: 133,
                            hauteur: 17,
                            classTexte: '',
                            accepterUnElement: true
                        });
                        this.instance.combo = aCombo;
                    },
                    getDonnees: function() {
                        return this.instance.listeDelais;
                    },
                    getIndiceSelection: function() {
                        var indice = 0;
                        for (var i = 0; i < this.instance.listeDelais.GetNbrElements(); i++) {
                            if (this.instance.listeDelais.GetElement(i).Numero === this.instance.donnees.notifications.delaiNotification) {
                                indice = i;
                            }
                        }
                        return indice;
                    },
                    event: function(aParametres) {
                        if (aParametres.genreEvenement === EGenreEvenementObjetSaisie.selection) {
                            if (this.instance.donnees.notifications.delaiNotification !== this.instance.listeDelais.GetElement(aParametres.indice).Numero) {
                                this.instance.SetEtatSaisie(true);
                            }
                            this.instance.donnees.notifications.delaiNotification = this.instance.listeDelais.GetElement(aParametres.indice).Numero;
                        }
                    }
                },
                estConsultable: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.estConsultable;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.estConsultable = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                autoriseHospitalisation: {
                    getValue: function() {
                        return this.instance.donnees.infosMedicales.autoriseHospitalisation;
                    },
                    setValue: function(aValue) {
                        this.instance.donnees.infosMedicales.autoriseHospitalisation = aValue;
                        this.instance.SetEtatSaisie(true);
                    }
                },
                delaiNotifTravaux: {
                    init: function(aCombo) {
                        aCombo.setOptions_ObjetSaisie({
                            mode: EGenreSaisie.Combo,
                            longueur: 133,
                            hauteur: 17,
                            classTexte: '',
                            accepterUnElement: true
                        });
                        this.instance.combo = aCombo;
                    },
                    getDonnees: function() {
                        return this.instance.listeDelais;
                    },
                    getIndiceSelection: function() {
                        var indice = 0;
                        for (var i = 0; i < this.instance.listeDelais.GetNbrElements(); i++) {
                            if (this.instance.listeDelais.GetElement(i).Numero === this.instance.donnees.notifications.delaiNotificationTravaux) {
                                indice = i;
                            }
                        }
                        return indice;
                    },
                    event: function(aParametres) {
                        if (aParametres.genreEvenement === EGenreEvenementObjetSaisie.selection) {
                            if (this.instance.donnees.notifications.delaiNotificationTravaux !== this.instance.listeDelais.GetElement(aParametres.indice).Numero) {
                                this.instance.SetEtatSaisie(true);
                            }
                            this.instance.donnees.notifications.delaiNotificationTravaux = this.instance.listeDelais.GetElement(aParametres.indice).Numero;
                        }
                    }
                }
            };
            return lControleur;
        };

        function _construireProjetsAccompagnement(aParams) {
            var H = [];
            var lWidthWidget = aParams.largeurMessageCompteEnfant;
            H.push('<div class="WhiteSpaceNormal InlineBlock" style="', GStyle.composeWidth(lWidthWidget), '">');
            if (!!aParams.listeProjets) {
                aParams.listeProjets.setTri([ObjetTri.init('estActif')]);
                aParams.listeProjets.trier(EGenreTriElement.Decroissant);
                H.push(UtilitaireProjetAccompagnement.composeListeProjetsAccompagnement(aParams.listeProjets, {
                    avecConsultationEquipePeda: true
                }));
            }
            H.push('</div>');
            return H.join('');
        }

        function _construirePreferencesContact(aParams) {
            var H = [];
            H.push('<div id="', aParams.id, '" class="WhiteSpaceNormal InlineBlock">');
            H.push('<div ie-model="libellePreferencesContact" class="Texte9" ie-html="getLibelle"></div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireInterlocuteurs(aParams) {
            var H = [];
            H.push('<div id="', aParams.id, '" class="WhiteSpaceNormal InlineBlock">');
            H.push('<div ie-model="libelleInterlocuteurs" class="Texte9" ie-html="getLibelle"></div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireInformations(aParams) {
            var H = [];
            H.push('<div id="', aParams.id, '" class="WhiteSpaceNormal InlineBlock">');
            H.push('<div ie-model="libelleInformations" class="Texte9" ie-html="getLibelle"></div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireContenuCommunicationsParents(aParams) {
            var H = [];
            H.push('<div id="', aParams.id, '" class="WhiteSpaceNormal InlineBlock">');
            H.push('<div ie-model="libelleCommunicationParents" class="Texte9" ie-html="getLibelle"></div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireAutorisationSortie(aParams) {
            var H = [];
            var lAutorisations = aParams.autorisationsSortie;
            var lAutorisation = lAutorisations.listeAutorisationsSortie.GetElementParNumeroEtGenre(lAutorisations.selectionEleve.GetNumero());
            var lDescriptif = lAutorisation.descriptif ? lAutorisation.descriptif : lAutorisation.GetLibelle();
            if (lAutorisation.listeDetailHoraires.length > 0) {
                lDescriptif += '<br>' + lAutorisation.listeDetailHoraires.join(' / ');
            }
            H.push('<div>');
            H.push(GTraductions.getValeur('AutorisationSortie.fixee'));
            H.push('</div>');
            H.push('<div class="GrandEspaceHaut">', lDescriptif, '</div>');
            return H.join('');
        }

        function _construireInformationsMedicales(aParams) {
            var lHTML = [];
            var lListeAllergenes = aParams.dossierMedical.listeAllergenes.getListeElements(function(D) {
                return D.Actif === true;
            });
            lHTML.push(UtilitairePageDonneesPersonnelles.composeMedecin(aParams));
            lHTML.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbAutoriserHospitalisation, GTraductions.getValeur('infosperso.autoriserHospitalisation'), true, 'autoriseHospitalisation'));
            lHTML.push('<div class="Gras">', GTraductions.getValeur('InfosMedicales.AllergiesAutres'), '</div>');
            lHTML.push('<div>', aParams.dossierMedical.commentaire, '</div>');
            lHTML.push(GTraductions.getValeur('infosperso.infosMedicalesTitre'));
            lHTML.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbExposerDossierMedical, GTraductions.getValeur('infosperso.infosMedicalesConsultables'), true, 'estConsultable'));
            lHTML.push('<div class="Gras">', GTraductions.getValeur('InfosMedicales.Allergies'), '</div>');
            lHTML.push('<span>', GTraductions.getValeur('infosperso.infosImperieusesTitre'), '</span>');
            lHTML.push('<div>', GTraductions.getValeur('InfosMedicales.TitreAllergiesMobile'), '</div>');
            lHTML.push('<ul>');
            for (var i = 0; i < lListeAllergenes.GetNbrElements(); i++) {
                lHTML.push('<li>');
                lHTML.push('- ' + lListeAllergenes.GetElement(i).GetLibelle());
                lHTML.push('</li>');
            }
            lHTML.push('</ul>');
            return lHTML.join('');
        }

        function _construireRestrictionsAlimentaires(aParams) {
            var lHTML = [];
            var lListeRestrictions = aParams.restrictions.getListeElements(function(D) {
                return D.Actif === true;
            });
            lHTML.push('<div>', GTraductions.getValeur('InfosMedicales.TitreAllergiesMobile'), '</div>');
            lHTML.push('<ul>');
            for (var i = 0; i < lListeRestrictions.GetNbrElements(); i++) {
                lHTML.push('<li>');
                lHTML.push('- ' + lListeRestrictions.GetElement(i).GetLibelle());
                lHTML.push('</li>');
            }
            lHTML.push('</ul>');
            return lHTML.join('');
        }
        UtilitairePageDonneesPersonnelles.composeMedecin = function() {
            var lLargeurPremiereColonne = 90,
                lLargeurIndicatif = 36,
                lLargeurTel = 110;
            var lHTML = [];
            lHTML.push('<div ', GEtatUtilisateur.estEspaceMobile() ? '' : 'style="width:450px;"', '>', GEtatUtilisateur.estEspaceMobile() ? '' : '<fieldset>', '<legend>', GTraductions.getValeur('InfosMedicales.MedecinTraitant'), '</legend>', '<table border="0" cellpadding="0" cellspacing="0">', '<tr><td class="AlignementDroit EspaceDroit10" style="' + GStyle.composeWidth(lLargeurPremiereColonne) + '">', '  <label for="idNom" class="Texte10">', GTraductions.getValeur('InfosMedicales.NomMedecin'), '</label>', '</td>', '<td colspan="5">', '<input type="text" id=""idNom"', ' name="idNom"', '" title="', GTraductions.getValeur('InfosMedicales.TitreNom'), '" ', ' placeholder="', GTraductions.getValeur('InfosMedicales.TitreNom'), '" ', ' style="', GStyle.composeCouleurBordure(GCouleur.bordure), GEtatUtilisateur.estEspaceMobile() ? ' font-size:12px;' : '', GStyle.composeWidth(100, '%'), '"', ' ie-model="nomMedecin" size="50" maxlength="50" class="Texte10 EspaceInput" tabIndex="0">', '</td></tr>', '<tr>', '<td class="AlignementDroit EspaceDroit10" style="' + GStyle.composeWidth(lLargeurPremiereColonne) + '">', '  <label for="idAdresse1" class="Texte10">', GTraductions.getValeur('InfosMedicales.adresse1'), '</label>', '</td>', '<td colspan="4" class="PetitEspaceHaut">', '  <input id="idAdresse1" ie-model="adresse1Medecin" class="EspaceInput Texte10"', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' title="', GTraductions.getValeur('InfosMedicales.adresse1'), '"', ' tabIndex="0"', '/>', '</td>', '</tr>', '<tr>', '<td class="AlignementDroit EspaceDroit10" style="' + GStyle.composeWidth(lLargeurPremiereColonne) + '">', '  <label for="idAdresse2" class="Texte10">', GTraductions.getValeur('InfosMedicales.adresse2'), '</label>', '</td>', '<td colspan="4" class="PetitEspaceHaut">', '  <input id="idAdresse2" ie-model="adresse2Medecin" class="EspaceInput Texte10"', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' title="', GTraductions.getValeur('InfosMedicales.adresse2'), '"', ' tabIndex="0"', '/>', '</td>', '</tr>', '<tr>', '<td class="PetitEspaceHaut AlignementDroit AlignementBas EspaceDroit10">', '<label for="idCpMedecin" class="Texte10">', GTraductions.getValeur('InfosMedicales.cpVille'), '</label>', '</td>', '<td class="PetitEspaceHaut" style="', GStyle.composeWidth(lLargeurIndicatif), '">', '  <input id="idCpMedecin" ie-model="CPMedecin" class="EspaceInput Texte10"', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' tabIndex="0"', '/>', '</td>', '<td class="PetitEspaceHaut PetitEspaceGauche" style="', GStyle.composeWidth(lLargeurTel), '">', '  <input type="text" ie-model="VilleMedecin"  ', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' class="Texte10 EspaceInput" tabIndex="0">', '</td>', '</tr>', '<tr>', '<td class="PetitEspaceHaut AlignementDroit AlignementBas EspaceDroit10">', '<div class="Image_Dll_TelMaison InlineBlock" title="', GTraductions.getValeur('InfosMedicales.Telephone'), '"></div>', '</td>', '<td class="PetitEspaceHaut" style="', GStyle.composeWidth(lLargeurIndicatif), '">', '  <input ie-model="indFixeMedecin" class="EspaceInput Texte10"', ' ie-indicatiftel ', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' title="', GTraductions.getValeur('InfosMedicales.TitreTelephone'), '"', ' tabIndex="0"', '/>', '</td>', '<td class="PetitEspaceHaut PetitEspaceGauche" style="', GStyle.composeWidth(lLargeurTel), '">', '  <input type="text" ie-model="telFixeMedecin" ie-telephone ', '" title="', GTraductions.getValeur('InfosMedicales.TitreTelephone'), '" ', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' class="Texte10 EspaceInput" tabIndex="0">', '</td>', '</tr>', '<tr>', '<td class="PetitEspaceHaut AlignementDroit AlignementBas EspaceDroit10">', '<div class="Image_DestinatairesSMS_Actif InlineBlock" title="', GTraductions.getValeur('infosperso.SMS'), '"></div>', '</td>', '<td class="PetitEspaceHaut" style="', GStyle.composeWidth(lLargeurIndicatif), '">', '  <input ie-model="indPortMedecin" class="EspaceInput Texte10"', ' ie-indicatiftel ', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' title="', GTraductions.getValeur('infosperso.SMS'), '"', ' tabIndex="0"', '/>', '</td>', '<td class="PetitEspaceHaut PetitEspaceGauche" style="', GStyle.composeWidth(lLargeurTel), '">', '  <input type="text" ie-model="telPortMedecin" ie-telephone ', '" title="', GTraductions.getValeur('infosperso.SMS'), '" ', ' style="', GStyle.composeWidth(100, '%'), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' class="Texte10 EspaceInput" tabIndex="0">', '</td>', '</tr>', '</table>', GEtatUtilisateur.estEspaceMobile() ? '' : '</fieldset>', '</div>');
            return lHTML.join('');
        };

        function _construireCoordonnees(aParams) {
            var H = [],
                lTab;
            H.push('<div class="WhiteSpaceNormal InlineBlock">');
            lTab = [];
            if (aParams.civilite) {
                lTab.push(aParams.civilite);
            }
            if (aParams.nom) {
                lTab.push(aParams.nom);
            }
            if (aParams.prenoms) {
                lTab.push(aParams.prenoms);
            }
            if (lTab.length > 0) {
                H.push('<div class="Gras">', lTab.join(' '), '</div>');
            }
            if (aParams.avecInfosEntreprise) {
                if (aParams.entreprise) {
                    H.push('<div class="Gras">', aParams.entreprise.GetLibelle(), '</div>');
                }
                if (aParams.fonction) {
                    H.push(aParams.fonction.GetLibelle());
                }
            }
            lTab = [];
            if (aParams.adresse1) {
                lTab.push(aParams.adresse1);
            }
            if (aParams.adresse2) {
                lTab.push(aParams.adresse2);
            }
            if (aParams.adresse3) {
                lTab.push(aParams.adresse3);
            }
            if (aParams.adresse4) {
                lTab.push(aParams.adresse4);
            }
            if (aParams.codePostal || aParams.ville) {
                lTab.push(aParams.codePostal + ' ' + aParams.ville);
            }
            if (aParams.province) {
                lTab.push(aParams.province);
            }
            if (aParams.pays) {
                lTab.push(aParams.pays);
            }
            H.push('<div>', lTab.join('<br/>'), '</div>');
            H.push(_composeZoneTelephone.bind(this)(aParams));
            H.push('</div>');
            return H.join('');
        }

        function _composeZoneTelephone(aParams) {
            var H = [];
            H.push('<div class="EspaceHaut">');
            H.push(_composeEmail.bind(this)(aParams));
            if (aParams.avecTelFixe) {
                H.push(_composeTelephone.bind(this)(aParams, EGenreTelephone.telFixe));
            }
            H.push(_composeTelephone.bind(this)(aParams, EGenreTelephone.telPort));
            if (aParams.avecTelFax) {
                H.push(_composeTelephone.bind(this)(aParams, EGenreTelephone.fax));
            }
            H.push('</div>');
            return H.join('');
        }

        function _composeTelephone(aParams, aGenre) {
            var H = [],
                lImageTitre = '',
                lIndicatif = '',
                lTel = '',
                lTitleImage, lTitle;
            switch (aGenre) {
                case EGenreTelephone.telFixe:
                    lTel = 'telephoneFixe';
                    lIndicatif = 'indicatifFixe';
                    lTitle = '';
                    lImageTitre = 'Image_Dll_TelMaison';
                    lTitleImage = GTraductions.getValeur('infosperso.telephoneFixe');
                    break;
                case EGenreTelephone.telPort:
                    lTel = 'telephonePortable';
                    lIndicatif = 'indicatifTel';
                    lImageTitre = 'Image_DestinatairesSMS_Actif';
                    lTitleImage = GTraductions.getValeur('infosperso.SMS');
                    break;
                case EGenreTelephone.fax:
                    lTel = 'fax';
                    lIndicatif = 'indicatifFax';
                    lTitle = '';
                    lImageTitre = 'Image_Dll_TelTravail';
                    lTitleImage = GTraductions.getValeur('infosperso.fax');
                    break;
            }
            if (!GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoCoordonnees) && !lIndicatif && !lTel) {
                return;
            }
            H.push('<div class="NoWrap PetitEspaceBas">');
            H.push('<div class="InlineBlock AlignementMilieuVertical" style="', GStyle.composeWidth(aParams.largeurLibelleInput), '">');
            H.push('<div class="', lImageTitre, '" title="', lTitleImage, '"></div>');
            H.push('</div>');
            H.push('<div class="InlineBlock AlignementMilieuVertical">', '<input ie-model="tel (\'', lIndicatif, '\')" class="CelluleTexte Texte10"', ' ie-indicatiftel ie-etatsaisie ', ' style="', GStyle.composeWidth(aParams.largeurIndicatif), GStyle.composeHeight(aParams.hauteurInput), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' title="', lTitle, '"', ' tabIndex="0"', '/>', '</div>');
            H.push('<div class="InlineBlock AlignementMilieuVertical PetitEspaceGauche">', '<input ie-model="tel (\'', lTel, '\')" class="CelluleTexte Texte10"', ' ie-telephone ie-etatsaisie ', ' style="', GStyle.composeWidth(aParams.largeurTel), GStyle.composeHeight(aParams.hauteurInput), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', lTitle ? ' placeholder="' + lTitle + '"' : '', lTitle ? ' title="' + lTitle + '"' : '', ' tabIndex="0"', '/>', '</div>');
            H.push('</div>');
            return H.join('');
        }

        function _composeEmail(aParams) {
            var H = [];
            if (!GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoCoordonnees) && !aParams.eMail) {
                return;
            }
            H.push('<div class="NoWrap PetitEspaceBas">');
            H.push('<div class="InlineBlock AlignementMilieuVertical" style="', GStyle.composeWidth(aParams.largeurLibelleInput), '">');
            H.push('<div class="Image_Destinataire_Email_Actif"></div>');
            H.push('</div>');
            if (GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoCoordonnees)) {
                H.push('<div class="InlineBlock AlignementMilieuVertical">', '<input class="EspaceInput Texte10"  style="', GStyle.composeWidth(aParams.largeurEmail), GStyle.composeHeight(aParams.hauteurInput), GStyle.composeCouleurBordure(GCouleur.bordure), '"', ' type="text"', ' ie-model="eMail"', ' maxlength="255"', ' id="', EListeIds.email, '"', ' placeholder="', GTraductions.getValeur('infosperso.infoEmail'), '"', ' value="', aParams.eMail || '', '"', ' title="', GTraductions.getValeur('infosperso.infoEmail'), '"', ' tabIndex="0"', '/>', '</div>');
            } else {
                if (aParams.eMail) {
                    H.push('<div class="InlineBlock AlignementMilieuVertical">', aParams.eMail || '', '</div>');
                }
            }
            H.push('</div>');
            return H.join('');
        }

        function _construireInformationsCompteEnfant(aParams) {
            var H = [];
            H.push('<div class="InlineBlock">');
            H.push('<div class="WhiteSpaceNormal GrandEspaceBas" style="', GStyle.composeWidth(aParams.largeurMessageCompteEnfant), '">', '<span>', GTraductions.getValeur('PageCompte.MsgEnfant1'), '</span>', '<br />', '<br />', '<span>', GTraductions.getValeur('PageCompte.MsgEnfant2'), '</span>', '</div>');
            H.push('<div class="NoWrap GrandEspaceBas">');
            H.push('<div class="InlineBlock Gras" style="', GStyle.composeWidth(aParams.largeurIdentifiantCompteEnfant), '">', GTraductions.getValeur('PageCompte.Identifiant') + ' :', '</div>');
            H.push('<div class="InlineBlock Gras ">', aParams.identifiant, '</div>');
            H.push('</div>');
            H.push('<div class="NoWrap">');
            H.push('<div class="InlineBlock Gras" style="', GStyle.composeWidth(aParams.largeurIdentifiantCompteEnfant), '">', GTraductions.getValeur('PageCompte.MotDePasse') + ' :', '</div>');
            H.push('<div class="WhiteSpaceNormal InlineBlock Gras GrandEspaceDroit">', aParams.informationsCompteMotDePasse, '</div>');
            H.push('<div id="', EListeIds.mdpEnfant, '" tabindex="0" class="WhiteSpaceNormal InlineBlock Souligne AvecMain OmbreFocus"', ' style="', GStyle.composeCouleurTexte(GCouleur.texte), '">', GTraductions.getValeur('PageCompte.Modifier'), '</div>');
            H.push('</div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireNotifications(aMailActif, aNotificationMail, aNotificationMailTravaux) {
            var H = [];
            if (aMailActif) {
                H.push('<div class="WhiteSpaceNormal InlineBlock">');
                var lGenreEspaceConcernes = [EGenreEspace.Etablissement, EGenreEspace.Mobile_Etablissement, EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur, EGenreEspace.Professeur, EGenreEspace.PrimProfesseur, EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_PrimProfesseur, EGenreEspace.Accompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant];
                var lGenreEspacesAccompagnants = [EGenreEspace.Accompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant];
                if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, lGenreEspaceConcernes)) {
                    H.push('<div class="AlignementHaut">');
                    H.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbNotifs, GTraductions.getValeur('PreferencesNotifications.etreNotifieParEmail'), aNotificationMail, 'switchNotification'));
                    H.push('</div>');
                    if (!GEtatUtilisateur.estEspaceMobile()) {
                        H.push('<div style="display:inline-flex">');
                        H.push('<div class="PetitEspace">', GTraductions.getValeur('PreferencesNotifications.delaiTemporisation'), '</div>');
                        H.push('<ie-combo ie-model="delaiNotif"></ie-combo>');
                        H.push('</div>');
                    }
                    if ((!GEtatUtilisateur.pourPrimaire()) && (!MethodesTableau.existe(GEtatUtilisateur.GenreEspace, lGenreEspacesAccompagnants))) {
                        H.push('<div class="AlignementHaut">');
                        H.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbNotifsTravaux, GTraductions.getValeur('PreferencesNotifications.etreNotifieEmailTravaux'), aNotificationMailTravaux, 'switchNotificationTravaux'));
                        H.push('</div>');
                        if (!GEtatUtilisateur.estEspaceMobile()) {
                            H.push('<div style="display:inline-flex">');
                            H.push('<div class="PetitEspace">', GTraductions.getValeur('PreferencesNotifications.delaiTemporisation'), '</div>');
                            H.push('<ie-combo ie-model="delaiNotifTravaux"></ie-combo>');
                            H.push('</div>');
                        }
                    }
                }
                H.push('</div>');
            } else {
                H.push(GTraductions.getValeur('PreferencesNotifications.serveurNonConfigureNotif'));
            }
            return H.join('');
        }

        function _construireDerniereConnexion() {
            var H = [];
            H.push(GDate.FormatDate(GEtatUtilisateur.derniereConnexion, '%JJ/%MM/%AA %hh:%mm'));
            return H.join('');
        }

        function _construireMotDePasse(aParams) {
            var H = [];
            H.push('<div class="WhiteSpaceNormal InlineBlock GrandEspaceDroit">', aParams.maskMdp, '</div>');
            H.push('<div id="', EListeIds.mdp, '" tabindex="0" class="WhiteSpaceNormal InlineBlock Souligne AvecMain OmbreFocus GrasSurvol"', ' style="', GStyle.composeCouleurTexte(GCouleur.texte), '">', GTraductions.getValeur('PageCompte.Modifier'), '</div>');
            return H.join('');
        }

        function _construireIdentifiant(aParams) {
            var H = [];
            H.push('<div class="WhiteSpaceNormal InlineBlock GrandEspaceDroit">', GEtatUtilisateur.estEspaceMobile() ? aParams.chaine : GChaine.ajouterEntites(GCryptage.decrypter({
                genreCryptage: EGenreCryptage.AES,
                chaine: aParams.chaine,
                cle: GApplication.getCommunication().cleAES,
                iv: GApplication.getCommunication().ivAES
            })), '</div>');
            if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.Mobile_Professeur, EGenreEspace.PrimProfesseur])) {
                H.push('<div id="', EListeIds.identifiant, '" tabindex="0" class="WhiteSpaceNormal InlineBlock Souligne AvecMain OmbreFocus GrasSurvol"', ' style="', GStyle.composeCouleurTexte(GCouleur.texte), '">', GTraductions.getValeur('PageCompte.Modifier'), '</div>');
            }
            return H.join('');
        }

        function _construireDroitImage(aParams) {
            var H = [];
            H.push('<div class="WhiteSpaceNormal InlineBlock">');
            H.push('<div class="AlignementHaut">');
            H.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbDroitImage, MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.Mobile_Professeur, EGenreEspace.PrimProfesseur, EGenreEspace.Accompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.PrimAccompagnant, EGenreEspace.Mobile_PrimAccompagnant, EGenreEspace.Etablissement, EGenreEspace.Mobile_Etablissement, EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur]) ? GTraductions.getValeur('infosperso.autoriserImage') : GTraductions.getValeur('infosperso.autoriserImageParents', [GEtatUtilisateur.getMembre().GetLibelle()]), aParams.avecImage, 'switchAutoriserImage'));
            H.push('</div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireAutorisations(aParams) {
            var H = [];
            var switchOuCheckbox = !!aParams.avecSwitch ? UtilitairePageDonneesPersonnelles.composerSwitch.bind() : UtilitairePageDonneesPersonnelles.composerCheckbox.bind();
            H.push('<div class="WhiteSpaceNormal InlineBlock">');
            if (!GEtatUtilisateur.estEspaceMobile()) {
                H.push('<div class="Gras Texte10 EspaceBas">', aParams.avecSaisie ? GTraductions.getValeur('infosperso.titreDestinataire') : GTraductions.getValeur('infosperso.titreDestinataireConsultation'), '</div>');
            }
            H.push('<div class="EspaceGauche">');
            if (aParams.avecSMS && aParams.SMSAutorise !== null) {
                H.push(switchOuCheckbox(EListeIds.cbSMS, GTraductions.getValeur('infosperso.SMS'), aParams.SMSAutorise, 'switchSMSAutorise', aParams.SMSAutoriseDisabled));
            }
            if (aParams.emailAutorise !== null) {
                H.push(switchOuCheckbox(EListeIds.cbMail, GTraductions.getValeur('infosperso.Email'), aParams.emailAutorise, 'switchEmailAutorise', aParams.emailAutoriseDisabled));
                if (aParams.eMailEtablissementAutorise !== null && aParams.eMailParentAutorise !== null && ((GEtatUtilisateur.GenreEspace !== EGenreEspace.Parent) && (GEtatUtilisateur.GenreEspace !== EGenreEspace.Mobile_Parent))) {
                    H.push('<div class="GrandEspaceGauche">');
                    H.push(switchOuCheckbox(EListeIds.cbMailEtab, GTraductions.getValeur('infosperso.EmailEtablissement'), aParams.eMailEtablissementAutorise, 'switchEmailEtablissementAutorise', aParams.emailAutorise), switchOuCheckbox(EListeIds.cbParent, GTraductions.getValeur('infosperso.EMailParents'), aParams.eMailParentAutorise, 'switchEmailParentAutorise', aParams.emailAutorise));
                    H.push('</div>');
                }
            }
            if (aParams.courrierPapierAutorise !== null) {
                H.push(switchOuCheckbox(EListeIds.cbCourrier, GTraductions.getValeur('infosperso.Papier'), aParams.courrierPapierAutorise, 'switchCourrierPapierAutorise', !aParams.avecSaisie));
            }
            H.push('</div>');
            if (aParams.msgParent !== null && aParams.msgEleve !== null) {
                H.push(_construireAutorisationsMessages(aParams));
            }
            if (aParams.construireAutorisationsSupp) {
                H.push(_construireAutorisationsSupp(aParams));
            }
            H.push('</div>');
            return H.join('');
        }

        function _construireCommunicationsParents(aParams) {
            var H = [];
            var lTexteAccepte, lTexteDiffuse;
            lTexteAccepte = aParams.estDelegue ? aParams.nbClasses === 1 ? GTraductions.getValeur('infosperso.avecLesResponsablesDeLaClasse', [aParams.delegueDesClasses]) : GTraductions.getValeur('infosperso.avecLesResponsablesDesClasses', [aParams.delegueDesClasses]) : aParams.nbClasses === 1 ? GTraductions.getValeur('infosperso.avecRespDeleguesClasse', [aParams.delegueDesClasses]) : GTraductions.getValeur('infosperso.avecRespDeleguesClasses', [aParams.delegueDesClasses]);
            lTexteDiffuse = aParams.estMembreCA ? GTraductions.getValeur('infosperso.avecTousResponsables', [aParams.delegueDesClasses]) : aParams.estDelegue ? lTexteAccepte : '';
            H.push('<div class="WhiteSpaceNormal InlineBlock">');
            H.push('<div>');
            H.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbMsgParent, GTraductions.getValeur('infosperso.discussionsAvecParents'), true, 'CBDiscussionAvecParents', true));
            H.push('<div class="GrandEspaceGauche Italique">', lTexteAccepte, '</div>');
            if (aParams.estDelegue || aParams.estMembreCA) {
                {
                    H.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbMsgProfsPerso, GTraductions.getValeur('infosperso.communiquerEmail'), true, 'CBCommuniquerMail', true));
                }
                H.push('<div class="GrandEspaceGauche Italique">', lTexteDiffuse, '</div>');
            }
            H.push('</div>');
            H.push('</div>');
            return H.join('');
        }

        function _construireAutorisationsMessages(aParams) {
            var H = [];
            var switchOuCheckbox = !!aParams.avecSwitch ? UtilitairePageDonneesPersonnelles.composerSwitch.bind() : UtilitairePageDonneesPersonnelles.composerCheckbox.bind();
            if (aParams.msgParent !== null && aParams.msgEleve !== null) {
                H.push('<div class="EspaceGauche">');
                H.push('<div class="NoWrap PetitEspaceBas">');
                H.push('<div class="InlineBlock AlignementMilieuVertical WhiteSpaceNormal Gras">', GTraductions.getValeur('infosperso.AccepteDiscussionAvec'), '</div>');
                H.push('</div>');
                H.push('<div class="GrandEspaceGauche">');
                H.push(switchOuCheckbox(EListeIds.cbMsgParent, GTraductions.getValeur('infosperso.DiscussionsParents'), aParams.msgParent, 'switchMsgParent', !aParams.avecSaisie));
                H.push(switchOuCheckbox(EListeIds.cbMsgEleve, GTraductions.getValeur('infosperso.DiscussionsEleves'), aParams.msgEleve, 'switchMsgEleve', !aParams.avecSaisie));
                H.push(switchOuCheckbox(EListeIds.cbMsgProfsPerso, GTraductions.getValeur('infosperso.DiscussionsProfsPersos'), true, 'switchMsgProfPerso', true));
                H.push('</div>');
                if (aParams.estContactVS !== null && aParams.estContactVS !== undefined) {
                    H.push(switchOuCheckbox(EListeIds.cbMsgContactVS, GTraductions.getValeur('infosperso.EstContactVS'), aParams.estContactVS, 'switchMsgVieScolaire', aParams.avecSaisie));
                }
                H.push('</div>');
            }
            return H.join('');
        }

        function _getClassImageDeDestinataire(aGenre, aActif) {
            switch (aGenre) {
                case EGenreDestinataire.SMS:
                    return aActif ? 'Image_DestinatairesSMS_Actif' : 'Image_DestinatairesSMS_Inactif';
                case EGenreDestinataire.Email:
                    return aActif ? 'Image_Destinataire_Email_Actif' : 'Image_Destinataire_Email_Inactif';
                case EGenreDestinataire.Courrier:
                    return aActif ? 'Image_Destinataire_Papier_Actif' : 'Image_Destinataire_Papier_Inactif';
            }
            return '';
        }

        function _construireTitreAvecImages(aTitre, aGenre, aParams) {
            var lImagesBulletin = [];
            lImagesBulletin.push('<div>');
            lImagesBulletin.push('  <div class="InlineBlock" ', (GEtatUtilisateur.estEspaceMobile() ? '' : 'style="width:200px;"'), '>');
            lImagesBulletin.push(aTitre);
            lImagesBulletin.push('  </div>');
            lImagesBulletin.push('<div>');
            if (MethodesTableau.existe(aGenre, [ETypeSwitch.InfosEleve, ETypeSwitch.InfosGenerales])) {
                lImagesBulletin.push('  <div class="InlineBlock ', _getClassImageDeDestinataire(EGenreDestinataire.SMS, aParams.SMSAutorise), '">');
                lImagesBulletin.push('  </div>');
            }
            lImagesBulletin.push('  <div class="InlineBlock ', _getClassImageDeDestinataire(EGenreDestinataire.Email, aParams.emailAutorise), '">');
            lImagesBulletin.push('  </div>');
            if (MethodesTableau.existe(aGenre, [ETypeSwitch.Bulletin, ETypeSwitch.InfosEleve, ETypeSwitch.InfosGenerales])) {
                lImagesBulletin.push('  <div class="InlineBlock ', _getClassImageDeDestinataire(EGenreDestinataire.Courrier, aParams.courrierPapierAutorise), '">');
                lImagesBulletin.push('  </div>');
            }
            lImagesBulletin.push('</div>');
            lImagesBulletin.push('</div>');
            return lImagesBulletin.join('');
        }

        function _construireAutorisationsSupp(aParams) {
            var lHtml = [];
            if (aParams.listeEleves.GetNbrElements() > 0) {
                lHtml.push('<div class="Gras Texte10 EspaceHaut" style="clear:both;">', GTraductions.getValeur('infosperso.titreRecevoir'), '</div>');
                lHtml.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbDestinataireInfosGen, _construireTitreAvecImages(GTraductions.getValeur('infosperso.titreInfosGen'), ETypeSwitch.InfosGenerales, aParams), aParams.estDestinataireInfosGenerales, 'switchInfosGen', aParams.avecSaisie));
                for (var i = 0; i < aParams.listeEleves.GetNbrElements(); i++) {
                    var lEleve = aParams.listeEleves.GetElement(i);
                    lHtml.push('<div class="Espace">');
                    lHtml.push(lEleve.GetLibelle());
                    lHtml.push('</div>');
                    lHtml.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbDestinataireBulletin, _construireTitreAvecImages(GTraductions.getValeur('infosperso.titreBulletin'), ETypeSwitch.Bulletin, aParams), lEleve.estDestinataireBulletin, 'switchBulletin(' + i + ')', aParams.avecSaisie));
                    lHtml.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbDestinataireInfosEleve, _construireTitreAvecImages(GTraductions.getValeur('infosperso.titreInfosEleve'), ETypeSwitch.InfosEleve, aParams), lEleve.estDestinataireInfosEleve, 'switchInfosEleve(' + i + ')', aParams.avecSaisie));
                    lHtml.push(UtilitairePageDonneesPersonnelles.composerSwitch(EListeIds.cbDestinataireInfosProf, _construireTitreAvecImages(GTraductions.getValeur('infosperso.titreInfosProf'), ETypeSwitch.InfosProfesseur, aParams), lEleve.estDestinataireInfosProfesseur, 'switchInfosProfs(' + i + ')', aParams.avecSaisie));
                }
            }
            return lHtml.join('');
        }
        UtilitairePageDonneesPersonnelles.composerSwitch = function(aID, aLibelle, aCheck, aModel) {
            var lHtml = [];
            lHtml.push('<ie-switch name="', aID, '" id="', aID, '" ie-model="', aModel, '" class="Espace" style="min-width:240px; max-width:500px;">', aLibelle, '</ie-switch>');
            return lHtml.join('');
        };
        UtilitairePageDonneesPersonnelles.composerCheckbox = function(aID, aLibelle, aCheck, aModel) {
            var lHtml = [];
            lHtml.push('<div class="Espace" style="display:flex;max-width:500px;">');
            lHtml.push('<div class="InlineBlock PetitEspaceGauche">');
            lHtml.push('<ie-checkbox ie-model="', aModel, '" tabIndex="0">');
            lHtml.push(aLibelle);
            lHtml.push('</ie-checkbox>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        UtilitairePageDonneesPersonnelles.swapImage = function(aTypeImage, aActif) {
            switch (aTypeImage) {
                case EGenreDestinataire.SMS:
                    var lPrefixe = 'Image_DestinatairesSMS_';
                    break;
                case EGenreDestinataire.Email:
                    lPrefixe = 'Image_Destinataire_Email_';
                    break;
                case EGenreDestinataire.Courrier:
                    lPrefixe = 'Image_Destinataire_Papier_';
                    break;
            }
            var lSuffixeTrue = (aActif ? 'Inactif' : 'Actif');
            var lSuffixeFalse = (aActif ? 'Actif' : 'Inactif');
            var lListeImages = $('.' + lPrefixe + lSuffixeTrue);
            lListeImages.each(function() {
                this.classList.remove(lPrefixe + lSuffixeTrue);
                this.classList.add(lPrefixe + lSuffixeFalse);
            });
        };
        UtilitairePageDonneesPersonnelles.fenetreModificationMDP = function(aInstancePere) {
            ObjetFenetre.creerInstance(ObjetFenetre_ModificationIdentifiantMDP, {
                pere: aInstancePere
            }, {
                optionsMDP: {
                    classRequeteSecurisation: ObjetRequeteSecurisationComptePreference,
                    actionRequeteSecurisation: TypeCommandeSecurisationCompteHttp.csch_AffecterMotDePassePersonnalise
                }
            }).SetDonnees(GEtatUtilisateur.reglesSaisieMotDePasse);
        };
        UtilitairePageDonneesPersonnelles.fenetreModificationIdentifiant = function(aInstancePere, aCallbackReussite) {
            if (!GApplication.droits.get(TypeDroits.compte.avecSaisieIdentifiant)) {
                return;
            }
            ObjetFenetre.creerInstance(ObjetFenetre_ModificationIdentifiantMDP, {
                pere: aInstancePere,
                evenement: function(aReussiteModificationIdentification) {
                    if (aReussiteModificationIdentification) {
                        aCallbackReussite();
                    }
                },
                initialiser: function(aInstance) {
                    aInstance.changementMDP = false;
                }
            }, {
                optionsMDP: {
                    classRequeteSecurisation: ObjetRequeteSecurisationComptePreference,
                    actionRequeteSecurisation: TypeCommandeSecurisationCompteHttp.csch_ModifierLogin
                }
            }).SetDonnees();
        };
        UtilitairePageDonneesPersonnelles.getDonneesDefaut = function() {
            return {
                AvecSMS: true,
                Informations: {
                    nom: '',
                    prenoms: '',
                    civilite: '',
                    adresse1: '',
                    adresse2: '',
                    adresse3: '',
                    adresse4: '',
                    codePostal: '',
                    ville: '',
                    pays: '',
                    eMail: null,
                    telephonePortable: null,
                    indicatifTel: null,
                    numeroINE: '',
                    telephoneFixe: null,
                    fax: null,
                    entreprise: null,
                    fonction: null
                },
                Autorisations: {
                    SMSAutorise: null,
                    emailAutorise: null,
                    eMailEtablissementAutorise: null,
                    eMailParentAutorise: null,
                    courrierPapierAutorise: null,
                    estDestinataireInfosGenerales: false,
                    listeEleves: new ObjetListeElements(),
                    msgParent: null,
                    msgEleve: null,
                    estContactVS: null
                },
                O365: {
                    listeEntites: new ObjetListeElements()
                }
            };
        };
        UtilitairePageDonneesPersonnelles.avecNotifications = function(aDonnes) {
            return aDonnes.notifications && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Etablissement, EGenreEspace.Mobile_Etablissement, EGenreEspace.Administrateur, EGenreEspace.Mobile_Administrateur, EGenreEspace.Professeur, EGenreEspace.Mobile_Professeur, EGenreEspace.PrimProfesseur, EGenreEspace.Mobile_PrimProfesseur, EGenreEspace.Accompagnant, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]);
        };
        UtilitairePageDonneesPersonnelles.getListeFiltresAff = function(aDonnes, aParametres) {
            var lListe = new ObjetListeElements();
            if (GEtatUtilisateur.derniereConnexion || GApplication.droits.get(TypeDroits.compte.avecSaisieIdentifiant) || GApplication.droits.get(TypeDroits.compte.avecSaisieMotDePasse) || aDonnes.securisation || aParametres.avecNumeroINE) {
                lListe.add(new ObjetElement(GTraductions.getValeur('infosperso.Liste_SecurisationCompte'), 0, TypeFiltreAffichage.securisation));
            }
            if (GApplication.droits.get(TypeDroits.compte.avecInformationsPersonnelles)) {
                lListe.add(new ObjetElement(GTraductions.getValeur('infosperso.Liste_Coordonnees'), 0, TypeFiltreAffichage.coords));
            }
            if (aParametres.avecInfosAutorisations || aParametres.avecInfosO365) {
                lListe.add(new ObjetElement(GTraductions.getValeur('infosperso.Liste_InfosComm'), 0, TypeFiltreAffichage.communication));
            }
            if (UtilitairePageDonneesPersonnelles.avecNotifications(aDonnes)) {
                lListe.add(new ObjetElement(GTraductions.getValeur('infosperso.Liste_Notification'), 0, TypeFiltreAffichage.notification));
            }
            if (aDonnes.droitImage) {
                lListe.add(new ObjetElement(GTraductions.getValeur('infosperso.Liste_DroitImage'), 0, TypeFiltreAffichage.droitImage));
            }
            return lListe;
        };
        module.exports = UtilitairePageDonneesPersonnelles;
    },
    fn: "utilitairepagedonneespersonnelles.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var UtilitaireChangementLangue = require('UtilitaireChangementLangue.js');
        var ObjetRequetePageInfosPerso = require('ObjetRequetePageInfosPerso.js');
        var UtilitairePageDonneesPersonnelles = require('UtilitairePageDonneesPersonnelles.js');
        var GHtml = require('GHtml.js');
        MethodesObjet.heritagePrototype(ObjetPageParametres, ObjetIdentite_Mobile);

        function ObjetPageParametres() {
            this.inheritedCreate(arguments);
            this.IdZoneChk = '_zoneChk';
        }

        function _construirePage() {
            var lHtml = [];
            if (UtilitaireChangementLangue.avecChoixLangues()) {
                lHtml.push('<div class="FondBlanc Espace"  style="border-bottom: 1px solid #c4c4c4;">', '<div class="left Gras">', GTraductions.getValeur('mobile.langue'), ' : ', '</div>', '<div class="right" style="margin-right:44px;">', UtilitaireChangementLangue.construire(this.controleur), '</div>', '<div class="clear"></div>', '</div>');
            }
            return lHtml.join('');
        }
        ObjetPageParametres.prototype.getControleur = function() {
            var lControleur = UtilitairePageDonneesPersonnelles.getControleur();
            return lControleur;
        };

        function _surReponseRequetePageInfosPerso(aDonnees) {
            this.donnees = aDonnees;
            GHtml.setHtml(this.Nom, _construirePage.bind(this)(), {
                controleur: this.controleur
            });
        }
        ObjetPageParametres.prototype.RecupererDonnees = function() {
            new ObjetRequetePageInfosPerso(this, _surReponseRequetePageInfosPerso.bind(this)).lancerRequete();
        };
        module.exports = ObjetPageParametres;
    },
    fn: "mobile/script/pageparametres.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetPageParametres = require('mobile/script/PageParametres.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetRequeteSaisieInformations = require('ObjetRequeteSaisieInformations.js');

        function ObjetAffichagePageParametres_Mobile() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(ObjetAffichagePageParametres_Mobile, ObjetInterfacePage_Mobile);
        ObjetAffichagePageParametres_Mobile.prototype.ConstruireInstances = function() {
            this.identPage = this.Add(ObjetPageParametres, null, null);
        };
        ObjetAffichagePageParametres_Mobile.prototype.ComposeContenu = function() {};
        ObjetAffichagePageParametres_Mobile.prototype.Valider = function() {
            var lStructure = {};
            if (this.GetInstance(this.identPage).getStructurePourValidation(lStructure)) {
                this.SetEtatSaisie(false);
                new ObjetRequeteSaisieInformations(this, this.ActionSurValidation).lancerRequete(lStructure);
            }
        };
        module.exports = ObjetAffichagePageParametres_Mobile;
    },
    fn: "mobile/script/interfacepageparametres.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var GChaine = require('GChaine.js');
        var Requetes = require('CollectionRequetes.js');
        var EGenreCryptage = require('Enumere_Cryptage.js');
        var GCryptage = require('ObjetCryptage.js');

        function ObjetRequetePageMesEnfants() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageMesEnfants', ObjetRequetePageMesEnfants, ObjetRequeteConsultation);
        ObjetRequetePageMesEnfants.prototype.lancerRequete = function() {
            return this.appelAsynchrone();
        };
        ObjetRequetePageMesEnfants.prototype.actionApresRequete = function() {
            if (!!this.JSONReponse.informationsCompte) {
                var LAvecMotDePasseEnClair = !!this.JSONReponse.informationsCompte.MotDePasse;
                this.JSONReponse.informationsCompte.MotDePasse = LAvecMotDePasseEnClair ? GChaine.ajouterEntites(GCryptage.decrypter({
                    genreCryptage: EGenreCryptage.AES,
                    chaine: this.JSONReponse.informationsCompte.MotDePasse,
                    cle: GApplication.getCommunication().cleAES,
                    iv: GApplication.getCommunication().ivAES
                })) : '*****';
                this.JSONReponse.informationsCompte.Identifiant = GChaine.ajouterEntites(GCryptage.decrypter({
                    genreCryptage: EGenreCryptage.AES,
                    chaine: this.JSONReponse.informationsCompte.Identifiant,
                    cle: GApplication.getCommunication().cleAES,
                    iv: GApplication.getCommunication().ivAES
                }));
                this.JSONReponse.informationsCompte.MotDePasseEnClair = LAvecMotDePasseEnClair;
            }
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequetePageMesEnfants;
    },
    fn: "objetrequetepagemesenfants.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieMotDePasseEleve() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieMotDePasseEleve', ObjetRequeteSaisieMotDePasseEleve, ObjetRequeteSaisie);
        ObjetRequeteSaisieMotDePasseEleve.prototype.lancerRequete = function(aParams) {
            this.JSON = {
                motDePasse: GApplication.getCommunication().getChaineChiffreeAES(aParams.nouveauMDP)
            };
            return this.appelAsynchrone();
        };
        ObjetRequeteSaisieMotDePasseEleve.prototype.traiterReponseSaisieMessageErreur = function() {};
        ObjetRequeteSaisieMotDePasseEleve.prototype.actionApresRequete = function() {
            this.callbackReussite.appel({
                avecErreur: this.reponseEnErreur(),
                JSON: this.JSONReponse
            });
        };
        module.exports = ObjetRequeteSaisieMotDePasseEleve;
    },
    fn: "objetrequetesaisiemotdepasseeleve.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var UtilitairePageDonneesPersonnelles = require('UtilitairePageDonneesPersonnelles.js');
        var EGenreTypeContenu = require('Enumere_DonneesPersonnelles.js').EGenreTypeContenu;
        var GHtml = require('GHtml.js');
        var EListeIds = require('Enumere_DonneesPersonnelles.js').EListeIds;
        var ObjetRequetePageMesEnfants = require('ObjetRequetePageMesEnfants.js');
        var ObjetFenetre_ModificationIdentifiantMDP = require('ObjetFenetre_ModificationIdentifiantMDP.js');
        var ObjetFenetre = require('ObjetFenetre.js');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        MethodesObjet.heritagePrototype(ObjetPageParametresEnfants, ObjetIdentite_Mobile);

        function ObjetPageParametresEnfants() {
            this.inheritedCreate(arguments);
            this.parametres = {
                maskMDP: '*********',
                largeurMessageCompteEnfant: 400
            };
        }
        ObjetPageParametresEnfants.prototype.ConstruirePage = function() {
            var lParams = {
                largeurMessageCompteEnfant: this.parametres.largeurMessageCompteEnfant,
                listeProjets: this.donnees.listeProjets
            };
            var lHtml = [];
            if (GApplication.droits.get(TypeDroits.compte.avecSaisieMotDePasseEleve)) {
                lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.Identifiant'), EGenreTypeContenu.Identifiant, {
                    chaine: this.donnees.informationsCompte.Identifiant
                }));
                lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.MotDePasse'), EGenreTypeContenu.MotDePasse, {
                    maskMdp: this.parametres.maskMDP
                }));
            }
            if (!!this.donnees.listeNaturesDocumentsAFournir && this.donnees.listeNaturesDocumentsAFournir.GetNbrElements() > 0) {
                var lStrEnfant = GEtatUtilisateur.getMembre().GetLibelle();
                lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('infosperso.DocumentAFournir', [lStrEnfant]), EGenreTypeContenu.DepotDocuments, {
                    identListeDocumentsAFournir: this.Pere.GetNomInstance(this.Pere.identListeDocumentsAFournir)
                }));
            }
            if (!!this.donnees.infosMedicales) {
                lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('InfosMedicales.Titre'), EGenreTypeContenu.InformationsMedicales, {
                    dossierMedical: this.donnees.infosMedicales
                }));
            }
            if (!!this.donnees.restrictionsAlimentaires && this.donnees.mangeALaCantine === true) {
                lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.DemiPension'), EGenreTypeContenu.RestrictionsAlimentaires, {
                    restrictions: this.donnees.restrictionsAlimentaires
                }));
            }
            if (!!this.donnees.listeProjets && this.donnees.listeProjets.GetNbrElements() > 0) {
                lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.ProjetsAccompagnement'), EGenreTypeContenu.ProjetsAccompagnement, lParams));
            }
            lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.autorisationsSortie'), EGenreTypeContenu.AutorisationSortie, {
                autorisationsSortie: this.donnees.autorisationSortie
            }));
            lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('infosperso.droitImage'), EGenreTypeContenu.DroitImage, {}));
            lHtml.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.NumeroINE'), EGenreTypeContenu.INE, {
                numeroINE: this.donnees.numeroINE
            }));
            return lHtml.join('');
        };

        function _afficherPopUp() {
            var lFenetreModificationMdp = ObjetFenetre.creerInstance(ObjetFenetre_ModificationIdentifiantMDP, {
                pere: this,
                initialiser: function(aInstance) {
                    aInstance.changementMDP = true;
                    aInstance.changementMDPEleve = true;
                    aInstance.setOptionsFenetre({
                        optionsMDP: {
                            classRequeteSaisie: require('ObjetRequeteSaisieMotDePasseEleve.js')
                        }
                    });
                }
            });
            lFenetreModificationMdp.SetDonnees(GEtatUtilisateur.reglesSaisieMotDePasse);
        }

        function _surReponseRequetePageInfosPerso(aDonnees) {
            this.donnees = aDonnees;
            if (!!aDonnees.message) {
                GHtml.setHtml(this.Nom, this.composeAucuneDonnee(aDonnees.message));
            } else {
                GHtml.setHtml(this.Nom, this.ConstruirePage(), {
                    controleur: this.controleur
                });
                $('#' + EListeIds.mdp.escapeJQ()).on({
                    mouseup: function() {
                        _afficherPopUp.call(this);
                    },
                    keyup: function() {
                        if (GNavigateur.IsToucheSelection()) {
                            _afficherPopUp.call(this);
                        }
                    }
                });
                var lIdentListeDocumentsAFournir = this.Pere.GetInstance(this.Pere.identListeDocumentsAFournir);
                lIdentListeDocumentsAFournir.SetDonnees({
                    listeNaturesDocument: this.donnees.listeNaturesDocumentsAFournir
                });
            }
        }
        ObjetPageParametresEnfants.prototype.getControleur = function() {
            var lControleur = UtilitairePageDonneesPersonnelles.getControleur();
            return lControleur;
        };
        ObjetPageParametresEnfants.prototype.RecupererDonnees = function() {
            new ObjetRequetePageMesEnfants(this, _surReponseRequetePageInfosPerso).lancerRequete();
        };
        ObjetPageParametresEnfants.prototype.getStructurePourValidation = function(aStructure) {
            aStructure.informationsMedicales = this.donnees.infosMedicales;
            if (this.donnees.droitImage) {
                aStructure.autorisationImage = !this.donnees.droitImage.autoriser;
            }
            aStructure.listeNaturesDocumentsAFournir = this.donnees.listeNaturesDocumentsAFournir;
            return true;
        };
        module.exports = ObjetPageParametresEnfants;
    },
    fn: "mobile/script/pageparametresenfants.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        var EGenreOrientationAffichage = require('enumere_orientationaffichage.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var TypeDomaine = require('TypeDomaine.js');
        MethodesObjet.heritagePrototype(ObjetCheckBox, Identite);

        function ObjetCheckBox() {
            this.inheritedCreate(arguments);
            this._options = {
                estRB: false,
                orientation: EGenreOrientationAffichage.Vertical,
                liste: new ObjetListeElements(),
                Selection: new TypeDomaine(),
                labelGroup: '',
                labelledby: '',
                classCss: '',
                style: null,
                styleTable: null,
                forcerSecable: false
            };
        }
        ObjetCheckBox.prototype.setOptions_ObjetCheckBox = function(aOptions) {
            $.extend(this._options, aOptions);
        };
        ObjetCheckBox.prototype.ConstruireAffichage = function() {
            var I, lNb = this._options.liste.GetNbrElements();
            if (this._options.orientation !== EGenreOrientationAffichage.Horizontal && this._options.orientation !== EGenreOrientationAffichage.Vertical) {
                for (I = 0; I < lNb; I++) {
                    GHtml.setHtml(this.GetNom(I), this.Compose_CheckBox(I));
                }
            } else {
                var H = [];
                H.push('<table border="0" cellspacing="0" cellpadding="0" ' + (this._options.styleTable ? 'style="' + this._options.styleTable + '"' : '') + '>');
                if (this._options.orientation === EGenreOrientationAffichage.Horizontal) {
                    H.push('<tr>');
                    for (I = 0; I < lNb; I++) {
                        H.push('<td>' + this.Compose_CheckBox(I) + '</td>');
                    }
                    H.push('</tr>');
                } else {
                    for (I = 0; I < lNb; I++) {
                        H.push('<tr><td>' + this.Compose_CheckBox(I) + '</td></tr>');
                    }
                }
                H.push('</table>');
                return H.join('');
            }
        };
        ObjetCheckBox.prototype.RecupererDonnees = function() {
            var I, lNb = this._options.liste.GetNbrElements();
            for (I = 0; I < lNb; I++) {
                $('#' + this.GetIdInput(I).escapeJQ()).jIECheckBox({
                    marginRightMin: 0
                });
            }
        };
        ObjetCheckBox.prototype.Compose_CheckBox = function(I) {
            var LTypeBouton = this._options.estRB ? 'radio' : 'checkbox';
            var LTabIndex = I ? -1 : 0;
            var lClassEtStlyle = '';
            if (this._options.classCss) {
                lClassEtStlyle += ' class="' + this._options.classCss + '"';
            }
            if (this._options.style) {
                lClassEtStlyle += ' style="' + this._options.style + '"';
            }
            var H = [];
            H.push('<table border="0" cellspacing="0" cellpadding="0" style="margin:2px;">');
            H.push('<tr class="AvecMain EspaceDroit Texte10">');
            if (this._options.labelGroup) {
                H.push(GObjetWAI.composeSpan(this._options.labelGroup + ' : ' + (I + 1) + GTraductions.getValeur('WAI.Sur') + ' ' + this._options.liste.GetNbrElements(), this.Nom + '_labelGroup' + I));
            }
            H.push('<td class="PetitEspaceDroit cocheCB" onkeyup="' + this.Nom + '.SurKeyUp (true, ' + I + ')" onclick="' + this.Nom + '.SurSelection (true, ' + I + ')">', '<input type="' + LTypeBouton + '" tabindex="' + LTabIndex + '"', GObjetWAI.composeAttribut({
                genre: EGenreAttribut.describedby,
                valeur: this.Nom + '_labelGroup' + I + ' ' + this.GetIdLibelle(I)
            }), ' ', this._options.labelledby ? GObjetWAI.composeAttribut({
                genre: EGenreAttribut.labelledby,
                valeur: this._options.labelledby
            }) : '', ' ', ' id="' + this.GetIdInput(I) + '" class="AvecMain" style="pointer-events: none; padding:0px; margin:0px;" ' + (this._options.Selection.GetValeur(I + 1) ? ' checked' : '') + '></input>');
            H.push('<td', lClassEtStlyle, ' id="' + this.GetIdLibelle(I) + '" onclick="' + this.Nom + '.SurSelection (true, ' + I + ')">' + (this._options.forcerSecable === true ? this._options.liste.GetLibelle(I) : GChaine.Insecable(this._options.liste.GetLibelle(I))) + '</td>');
            H.push('</tr>');
            H.push('</table>');
            return H.join('');
        };
        ObjetCheckBox.prototype.GetNom = function(I) {
            return I === null || I === undefined ? this.Nom : this.Nom + '_' + I;
        };
        ObjetCheckBox.prototype.GetIdInput = function(I) {
            return this.Nom + '_Input_' + I;
        };
        ObjetCheckBox.prototype.GetIdLibelle = function(I) {
            return this.Nom + '_Libelle_' + I;
        };
        ObjetCheckBox.prototype.SurKeyUp = function(AInteractionUtilisateur, I, AValeur) {
            if (GNavigateur.IsToucheSelection()) {
                this.SurSelection(AInteractionUtilisateur, I, AValeur);
            } else if ((GNavigateur.IsToucheFlecheDroite() || GNavigateur.IsToucheFlecheBas()) && I < this._options.liste.GetNbrElements() - 1) {
                GHtml.setFocus(this.GetIdInput(I + 1));
            } else if ((GNavigateur.IsToucheFlecheGauche() || GNavigateur.IsToucheFlecheHaut()) && I > 0) {
                GHtml.setFocus(this.GetIdInput(I - 1));
            }
        };
        ObjetCheckBox.prototype.SurSelection = function(AInteractionUtilisateur, I, AValeur) {
            this.InteractionUtilisateur = AInteractionUtilisateur;
            if (!(!this.Actif && this.InteractionUtilisateur)) {
                if (this._options.estRB) {
                    this._options.Selection = new TypeDomaine();
                }
                if (!this._options.Selection) {
                    return;
                }
                this._options.Selection.SetValeur(AValeur === null || AValeur === undefined ? !this._options.Selection.GetValeur(I + 1) : AValeur, I + 1);
                if (this._options.estRB) {
                    if (this._options.Selection.GetNbrValeurs(true) === 0) {
                        this._options.Selection.SetValeur(true, I + 1);
                    }
                }
                var i, lNb = this._options.liste.GetNbrElements();
                for (i = 0; i < lNb; i++) {
                    var lChecked = this._options.Selection.GetValeur(i + 1),
                        lJInput = $('#' + this.GetIdInput(i).escapeJQ());
                    if (lJInput.inputChecked() !== lChecked) {
                        lJInput.inputChecked(lChecked);
                    }
                    lJInput = null;
                }
                if (this._options.Selection) {
                    this.callback.appel(this._options.Selection, this.InteractionUtilisateur);
                }
            }
        };
        ObjetCheckBox.prototype.SetActif = function(AActif, I) {
            this.Actif = AActif;
            GHtml.setDisabled(this.GetIdInput(I === null || I === undefined ? 0 : I), !this.Actif);
        };
        ObjetCheckBox.prototype.setVisible = function(aVisible, I) {
            GStyle.setVisible(GHtml.getParent(this.GetIdInput(I === null || I === undefined ? 0 : I)), aVisible);
            GStyle.setVisible(GHtml.getParent(this.GetIdLibelle(I === null || I === undefined ? 0 : I)), aVisible);
        };
        ObjetCheckBox.prototype.setLibelle = function(aLibelle, I) {
            GHtml.setHtml(this.GetIdLibelle(I === null || I === undefined ? 0 : I), aLibelle);
        };
        ObjetCheckBox.prototype.SetSelection = function(AValeur, I) {
            this.SurSelection(false, I = I === null || I === undefined ? 0 : I, AValeur);
        };
        ObjetCheckBox.prototype.SetSelectionParNumeroEtGenre = function(AValeur, ANumero, AGenre) {
            this.SetSelection(AValeur, this._options.liste.GetIndiceParNumeroEtGenre(ANumero, AGenre));
        };
        ObjetCheckBox.prototype.setParametres_Affichage = function(aClass, aStyle, aStyleTable) {
            this.setOptions_ObjetCheckBox({
                classCss: aClass,
                style: aStyle,
                styleTable: aStyleTable
            });
        };
        module.exports = ObjetCheckBox;
    },
    fn: "objetcheckbox.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GUID = require('GUID.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var GStyle = require('GStyle.js');
        var ObjetCheckBox = require('ObjetCheckBox.js');
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        MethodesObjet.heritagePrototype(_ObjetInterfacePage, ObjetAbstraitInterface);

        function _ObjetInterfacePage() {
            this.inheritedCreate(arguments);
            this._idAddZoneBandeau = GUID.getId();
        }
        _ObjetInterfacePage.prototype.getPrioriteAffichageBandeauLargeur = function() {
            return [];
        };

        function _getInfosSurZone(aIndice) {
            var lElement = this.AddSurZone[aIndice];
            return $.extend({
                ident: lElement && (lElement.html || lElement.separateur) ? null : lElement,
                html: null,
                controleur: null,
                getDisplay: null,
                alignementDroite: false,
                separateur: false
            }, lElement);
        }
        _ObjetInterfacePage.prototype.ConstruireStructureAffichageBandeau = function() {
            var lHTML = [];
            var lGenre, lGenrePourLargeurComplete;
            var lAlignementDroite = true;
            var lExisteGenre = [];
            var I, lInfos, lInfosSurZone = [];
            for (I = 0; I < this.AddSurZone.length; I++) {
                lInfosSurZone.push(_getInfosSurZone.call(this, I));
            }
            for (I = 0; I < this.AddSurZone.length; I++) {
                lInfos = lInfosSurZone[I];
                if (lInfos.ident !== undefined && lInfos.ident !== null) {
                    lGenre = this.GenreAffichage[lInfos.ident];
                    lExisteGenre[lGenre] = true;
                }
                lAlignementDroite = lAlignementDroite && lInfos.alignementDroite;
            }
            var lOrdreGenre = this.getPrioriteAffichageBandeauLargeur();
            for (I in lOrdreGenre) {
                lGenre = lOrdreGenre[I];
                if ((lGenrePourLargeurComplete === null || lGenrePourLargeurComplete === undefined) && lExisteGenre[lGenre]) {
                    lGenrePourLargeurComplete = lGenre;
                }
            }
            if (lAlignementDroite && this.AddSurZone.length > 0) {
                lHTML.push('<div class="objetBandeauEntete_fullsize"></div>');
                if (lGenrePourLargeurComplete === undefined) {
                    lGenrePourLargeurComplete = true;
                }
            }
            var lCptBloc = 0;
            for (I = 0; I < this.AddSurZone.length; I++) {
                lInfos = lInfosSurZone[I];
                lGenre = lInfos.ident !== undefined && lInfos.ident !== null ? this.GenreAffichage[lInfos.ident] : null;
                if (lInfos.blocGauche) {
                    lHTML.push('<div class="objetBandeauEntete_AddSurZone_wrapper">');
                    lCptBloc += 1;
                } else if (lInfos.blocDroit) {
                    lHTML.push('</div>');
                    lCptBloc -= 1;
                } else if (lInfos.separateur) {
                    lHTML.push('<div class="objetBandeauEntete_fullsize"></div>');
                    if (lGenrePourLargeurComplete === undefined) {
                        lGenrePourLargeurComplete = true;
                    }
                } else if (this.Instances[lInfos.ident] || lInfos.html) {
                    lHTML.push('<div id="', (lInfos.html ? this._idAddZoneBandeau + I : this.Instances[lInfos.ident].GetNom()), '"', (lInfos.getDisplay ? ' ie-display="' + lInfos.getDisplay + '"' : ''), ' class="PetitEspaceDroit ' + (lGenre === ObjetCheckBox ? 'AlignementMilieu' : 'AlignementGauche') + '">', lInfos.html && !lInfos.controleur ? lInfos.html : '', '</div>');
                }
                if (lGenre === ObjetCheckBox) {
                    this.GetInstance(lInfos.ident).setParametres_Affichage('Texte10 Gras', null, 'margin:auto;');
                }
            };
            if (lGenrePourLargeurComplete === undefined) {
                lHTML.push('<div class="objetBandeauEntete_fullsize"></div>');
            }
            lHTML.push('</div>');
            GHtml.setDisplay(GApplication.idLigneBandeau, true);
            GHtml.addHtml(GApplication.idLigneBandeau, lHTML.join(''), {
                controleur: this.controleur
            });
            for (I = 0; I < this.AddSurZone.length; I++) {
                lInfos = lInfosSurZone[I];
                if (lInfos.controleur) {
                    GHtml.setHtml(this._idAddZoneBandeau + I, lInfos.html, {
                        controleur: lInfos.controleur
                    });
                }
            }
            if (this.Pere && this.Pere.surResizeInterface) {
                this.Pere.surResizeInterface();
            }
            this.surResizeInterface();
            return '';
        };
        _ObjetInterfacePage.prototype.setBandeau = function(aHtml) {
            GHtml.setDisplay(GApplication.idLigneBandeau, true);
            GHtml.addHtml(GApplication.idLigneBandeau, aHtml, {
                controleur: this.controleur
            });
            if (this.Pere && this.Pere.surResizeInterface) {
                this.Pere.surResizeInterface();
            }
            this.surResizeInterface();
        };
        _ObjetInterfacePage.prototype.afficherBandeau = function(aAfficher) {
            var lIdent, lInfos;
            for (var I in this.AddSurZone) {
                lInfos = _getInfosSurZone.call(this, I);
                if (!lInfos.getDisplay) {
                    lIdent = lInfos.ident !== undefined && lInfos.ident !== null ? lInfos.ident : null;
                    if (lInfos.html) {
                        GStyle.setVisible(this._idAddZoneBandeau + I, aAfficher);
                    } else if (this.conditionSuppAfficherBandeau(lIdent)) {
                        GStyle.setVisible(this.Instances[lIdent].GetNom(), aAfficher);
                    }
                }
            }
        };
        _ObjetInterfacePage.prototype.EvenementAfficherMessage = function() {};
        _ObjetInterfacePage.prototype.conditionSuppAfficherBandeau = function() {
            return false;
        };
        module.exports = _ObjetInterfacePage;
    },
    fn: "_interfacepage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreImpression = {
            Aucune: 0,
            Normale: 1,
            Format: 2,
            Proportion: 3,
            ProportionTempSaisieNotes: 4,
            GenerationPDF: 5
        };
        module.exports = EGenreImpression;
    },
    fn: "enumere_genreimpression.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        MethodesObjet.heritagePrototype(ObjetBandeau, Identite);

        function ObjetBandeau() {
            this.inheritedCreate(arguments);
            this.Libelle = '';
            this.focusable = false;
        }
        ObjetBandeau.prototype.getControleur = function() {
            return {
                getLibelle: function() {
                    return this.instance.Libelle;
                },
                getInfosBulle: function() {
                    return this.instance.title || '';
                }
            };
        };
        ObjetBandeau.prototype.ConstruireAffichage = function() {
            var H = [];
            H.push('<span id="' + this.Nom + '_Libelle" class="Texte10 Gras Insecable" ie-html="getLibelle" ie-hint="getInfosBulle"></span>');
            return H.join('');
        };
        ObjetBandeau.prototype.SetParametres = function(ALibelle) {
            this.Libelle = '' + ALibelle;
            if (this.Libelle) {
                this.activerFocusable();
            } else {
                this.desactiverFocusable();
            }
            this.$refreshSelf();
        };
        ObjetBandeau.prototype.SetLibelle = function(ALibelle, aAvecSeparateur) {
            this.SetParametres((ALibelle && aAvecSeparateur ? ' - ' : '') + ALibelle);
        };
        ObjetBandeau.prototype.setInfoBulle = function(ALibelle) {
            this.title = ALibelle;
            this.$refreshSelf();
        };
        module.exports = ObjetBandeau;
    },
    fn: "objetbandeau.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('ObjetBoutonBandeau.css');
        var GLog = require('IELog.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var GPosition = require('GPosition.js');
        var GStyle = require('GStyle.js');
        var ControleSaisieEvenement = require('ControleSaisieEvenement.js');
        var Identite = require('ObjetIdentite.js');
        var GObjetWAI = require('ObjetWAI.js').GObjetWAI;
        var EGenreRole = require('ObjetWAI.js').EGenreRole;
        var EGenreAttribut = require('ObjetWAI.js').EGenreAttribut;
        var EGenreBoutonBandeau = {
            NonSelectionne: 0,
            Inactif: 1,
            NonSelectionne2: 2,
            Selectionne: 3,
            SurvolNonSelectionne: 4,
            SurvolSelectionne: 5
        };

        function ObjetBoutonBandeau() {
            this.inheritedCreate(arguments);
            this.withTabulation = true;
            this.idBouton = this.Nom + '_Bouton';
            this.IdPremierElement = this.idBouton;
            this.selection = false;
            this.genreLibelle = {
                actifSelection: 0,
                deselectionne: 1,
                inactif: 2
            };
            this._options = {
                nomClass: '',
                nomIcone: '',
                avecEtat: false,
                actif: true,
                taille: 20,
                tableauLibelles: null,
                avecSelection: true,
                avecEspaceGauche: true,
                raccourciClavier: '',
                describedby: '',
                roleWAI: '',
                labelWAI: '',
                attributWAI: ''
            };
        }
        MethodesObjet.heritagePrototype(ObjetBoutonBandeau, Identite);
        ObjetBoutonBandeau.prototype.setOptions_ObjetBoutonBandeau = function(aOptions) {
            var lTaille = this._options.taille;
            $.extend(this._options, aOptions);
            if (!this._options.tableauLibelles || this._options.tableauLibelles.length !== 3 || this._options.tableauLibelles[2] === '') {
                GLog.addLog(this.Nom + ' : un des libellés est vide ou manquant -> problème pour l\'accessibilité', '', GLog.genre.Avertissement);
                if (this._options.tableauLibelles) {
                    if (this._options.tableauLibelles.length === 3 && this._options.tableauLibelles[2] === '') {
                        this._options.tableauLibelles[2] = this._options.tableauLibelles[1];
                    }
                    if (this._options.tableauLibelles.length === 2 && !this._options.avecEtat) {
                        this._options.tableauLibelles.splice(1, 0, '');
                    }
                    if (this._options.tableauLibelles.length === 1 && !this._options.avecEtat) {
                        this._options.tableauLibelles.push(['', this._options.tableauLibelles[0]]);
                    }
                }
            }
            if (lTaille !== this._options.taille) {
                var lElement = GHtml.getElement(this.idBouton);
                if (lElement) {
                    GPosition.setWidth(lElement, this._options.taille);
                }
            }
        };
        ObjetBoutonBandeau.prototype.ConstruireAffichage = function() {
            var H = [];
            H.push('<div', this._options.avecEspaceGauche ? ' class="EspaceGauche"' : '', '>');
            H.push('<' + (this._options.nomIcone ? 'i' : 'div') + ' id="', this.idBouton, '"', ' style="outline: 0;', GStyle.composeWidth(this._options.taille), (this._options.nomIcone ? 'color:' + this._options.colorIcone + ';' : ''), '"', ' class="AvecMain ', (this._options.nomClass || this._options.nomIcone), (this._options.nomIcone ? ' ObjetBoutonBandeau_icone' : ' icon'), '"', ' tabIndex="0"', this._options.roleWAI ? GObjetWAI.composeRole(this._options.roleWAI) : GObjetWAI.composeRole(EGenreRole.Button), ' ', this._options.labelWAI ? GObjetWAI.composeAttribut({
                genre: EGenreAttribut.label,
                valeur: this._options.labelWAI
            }) + ' ' : '', this._options.attributWAI ? GObjetWAI.composeAttribut(this._options.attributWAI) : '', (this._options.actif && this.withTabulation && this._options.describedby) ? GObjetWAI.composeAttribut({
                genre: EGenreAttribut.describedby,
                valeur: this._options.describedby
            }) : '', GObjetWAI.composeAttribut({
                genre: EGenreAttribut.disabled,
                valeur: '' + !this._options.actif
            }), '></' + (this._options.nomIcone ? 'i' : 'div') + '>');
            H.push('</div>');
            return H.join('');
        };

        function _surKeyUp(event) {
            if (GNavigateur.IsToucheSelection()) {
                event.data.instance.surSelection(true);
            }
        }

        function _surClick(event) {
            event.data.instance.surSelection(true);
        }
        ObjetBoutonBandeau.prototype.RecupererDonnees = function() {
            $('#' + this.idBouton.escapeJQ()).on('focusin mouseover', {
                aObjet: this,
                aSurvol: true
            }, _surSurvolJQ).on('focusout mouseout', {
                aObjet: this,
                aSurvol: false
            }, _surSurvolJQ).on({
                keyup: _surKeyUp,
                click: _surClick
            }, {
                instance: this
            });
            this.actualiser();
        };
        ObjetBoutonBandeau.prototype.SetParametres = function(aNomClass, aAvecEtat, aSelection, aActif, aTableauLibelles, aTaille, aAvecSelection, aAvecEspaceGauche, aRaccourciClavier) {
            this.setOptions_ObjetBoutonBandeau({
                nomClass: aNomClass,
                avecEtat: aAvecEtat,
                actif: aActif,
                tableauLibelles: aTableauLibelles,
                taille: aTaille ? aTaille : undefined,
                avecSelection: aAvecSelection !== null && aAvecSelection !== undefined ? aAvecSelection : undefined,
                avecEspaceGauche: aAvecEspaceGauche !== null && aAvecEspaceGauche !== undefined ? aAvecEspaceGauche : undefined,
                raccourciClavier: aRaccourciClavier ? aRaccourciClavier : undefined
            });
            this.selection = aSelection;
        };
        ObjetBoutonBandeau.prototype.getPosition = function(aGenre) {
            return this._options.avecEtat ? -1 * this._options.taille * aGenre : 0;
        };
        ObjetBoutonBandeau.prototype.getGenreLibelle = function() {
            if (!this._options.actif) {
                return this.genreLibelle.inactif;
            } else {
                if (!this._options.avecEtat || this.selection) {
                    return this.genreLibelle.actifSelection;
                } else {
                    return this.genreLibelle.deselectionne;
                }
            }
        };
        ObjetBoutonBandeau.prototype.getLibelle = function() {
            var lResult = this._options.tableauLibelles ? this._options.tableauLibelles[this.getGenreLibelle()] : '';
            if (lResult && this._options.raccourciClavier && this._options.actif) {
                lResult = lResult + ' - ';
            }
            if (this._options.actif && this._options.raccourciClavier) {
                lResult = lResult + this._options.raccourciClavier;
            }
            return lResult || '';
        };
        ObjetBoutonBandeau.prototype.actualiser = function() {
            var lGenre, lBouton = $('#' + this.idBouton.escapeJQ());
            if (this._options.actif) {
                lGenre = this.selection ? (this.survol ? EGenreBoutonBandeau.SurvolSelectionne : EGenreBoutonBandeau.Selectionne) : (this.survol ? EGenreBoutonBandeau.SurvolNonSelectionne : EGenreBoutonBandeau.NonSelectionne);
            } else {
                lGenre = EGenreBoutonBandeau.Inactif;
            }
            GPosition.setBackgroundPosition(this.idBouton, this.getPosition(lGenre));
            GHtml.setTitle(this.idBouton, this.getLibelle());
            lBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.label], this._options.labelWAI || this.getLibelle());
            this.getGenreLibelle() === 1 ? (!lBouton.hasClass('bt-inactive') ? lBouton.addClass('bt-inactive') : '') : (lBouton.hasClass('bt-inactive') ? lBouton.removeClass('bt-inactive') : '');
        };

        function _surSurvolJQ(event) {
            var lThis = event.data.aObjet;
            var lSurvol = event.data.aSurvol;
            if (!GNavigateur.isTactile) {
                lThis.survol = lSurvol;
                lThis.actualiser();
                if (!lThis._options.avecEtat) {
                    if (lThis.survol) {
                        $('#' + lThis.idBouton.escapeJQ()).css('box-shadow', '0 0 5px -1px ' + GCouleur.noir);
                    } else {
                        $('#' + lThis.idBouton.escapeJQ()).css('box-shadow', 'none');
                    }
                }
            }
        }
        ObjetBoutonBandeau.prototype.surSelection = function(aInteractionUtilisateur, aSelection) {
            if (this._options.actif) {
                if (this._options.avecSelection) {
                    this.selection = aSelection === null || aSelection === undefined ? !this.selection : aSelection;
                }
                this.actualiser();
                this.InteractionUtilisateur = aInteractionUtilisateur;
                ControleSaisieEvenement(function() {
                    this.callback.appel(this.Genre, this.selection, this.InteractionUtilisateur);
                    if (this.Pere && this.Pere.$refreshSelf) {
                        this.Pere.$refreshSelf();
                    }
                }.bind(this), !this.ControleNavigation || !this.InteractionUtilisateur);
            }
        };
        ObjetBoutonBandeau.prototype.setSelection = function(aSelection) {
            this.surSelection(false, aSelection);
        };
        ObjetBoutonBandeau.prototype.setActif = function(aActif) {
            this._options.actif = aActif;
            var lJqBouton = $('#' + this.idBouton.escapeJQ());
            if (this._options.actif) {
                lJqBouton.removeClass('SansMain').addClass('AvecMain');
            } else {
                lJqBouton.removeClass('AvecMain').addClass('SansMain');
            }
            if (this.withTabulation) {
                lJqBouton.attr('tabIndex', 0);
            }
            lJqBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.disabled], '' + !this._options.actif);
            if (this._options.nomIcone) {
                if (!this._options.actif) {
                    lJqBouton.addClass('ObjetBoutonBandeau_iconeInactive');
                } else {
                    lJqBouton.removeClass('ObjetBoutonBandeau_iconeInactive');
                }
            }
            this.actualiser();
        };
        ObjetBoutonBandeau.prototype.getActif = function() {
            return this._options.actif;
        };
        ObjetBoutonBandeau.prototype.setLibelles = function(aTableauLibelles) {
            this.setOptions_ObjetBoutonBandeau({
                tableauLibelles: aTableauLibelles
            });
            this.actualiser();
        };
        ObjetBoutonBandeau.prototype.setNomClass = function(aNomClass) {
            this.nomClass = aNomClass;
            GHtml.setClass(this.idBouton, this.nomClass);
            this.actualiser();
        };
        module.exports = ObjetBoutonBandeau;
    },
    fn: "objetboutonbandeau.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreEvntMenusDeroulants = {
            surOuvertureCombo: 0,
            ressourceNonTrouve: 1
        };
        module.exports = EGenreEvntMenusDeroulants;
    },
    fn: "enumere_evntmenusderoulants.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSaisie = require('ObjetSaisie.js');
        MethodesObjet.heritagePrototype(ObjetSaisiePN, ObjetSaisie);

        function ObjetSaisiePN() {
            this.inheritedCreate(arguments);
            this.largeurBouton = 17;
            this.ListeElements = new ObjetListeElements();
        }
        ObjetSaisiePN.prototype.initialiserOptions_ObjetSaisie = function() {
            this.inherited('initialiserOptions_ObjetSaisie');
            $.extend(this._options, {
                avecEventSurFermetureListe: true,
                forcerBoutonDeploiement: false
            });
        };
        ObjetSaisiePN.prototype.SetParametres = function(AAvecTri, AAvecLigneVide, ALongueur, aAvecStyleSite, aForcerBoutonDeploiement, aLargeurListe, aHauteurCombo, aContenuHtml) {
            require('IELog.js').addLog('! ObjetSaisiePN.prototype.SetParametres déprécié !');
            this.setOptions_ObjetSaisie({
                longueur: ALongueur === null || ALongueur === undefined ? 150 - this.largeurBouton : ALongueur,
                hauteur: aHauteurCombo ? aHauteurCombo : undefined,
                largeurListe: aLargeurListe ? aHauteurCombo : undefined,
                celluleAvecTexteHtml: aContenuHtml === null || aContenuHtml === undefined ? false : aContenuHtml,
                forcerBoutonDeploiement: aForcerBoutonDeploiement === null || aForcerBoutonDeploiement === undefined ? false : aForcerBoutonDeploiement,
                avecTriListeElements: AAvecTri === null || AAvecTri === undefined ? false : AAvecTri
            });
        };
        ObjetSaisiePN.prototype.SetDonnees = function(AListeElements, ASelection, aSansSelection) {
            if (this.listeDeroulee) {
                this.FermerListe(false);
            }
            this.ListeElements = AListeElements ? AListeElements : new ObjetListeElements();
            if (this._options.avecTriListeElements) {
                this.ListeElements.trier();
            }
            this.listeDeroulee = false;
            this.cache.heightScroll = 0;
            this._remplirListe();
            var LLibelle = '&nbsp;';
            if (this._options.avecGestionUnElement && !this._options.multiSelection) {
                if (this.ListeElements && this.ListeElements.GetNbrElements() === 1) {
                    var lElement = this.ListeElements.GetElement(0);
                    if (lElement.Existe() && lElement.GetLibelle() && lElement.GetLibelle().length) {
                        ASelection = this.Selection = 0;
                        LLibelle = this.ListeElements.GetLibelle(this.Selection);
                    } else {
                        this.Selection = -1;
                    }
                }
                if (this._options.celluleAvecTexteHtml) {
                    this.bouton.setLibelleHtml(LLibelle);
                } else {
                    this.bouton.setLibelle(LLibelle);
                }
            }
            if (!aSansSelection) {
                this._surSetDonnnes = true;
                this.SetSelection(ASelection);
            }
            var lNbElements = this.ListeElements ? this.ListeElements.GetNbrElementsExistes() : 0;
            if (lNbElements > 1 ||
                this._options.forcerBoutonDeploiement) {
                this.bouton.setAvecBouton(true);
                this.bouton.SetActif(true);
            } else {
                this.bouton.setAvecBouton(false);
                this.bouton.SetActif(false);
            }
        };
        module.exports = ObjetSaisiePN;
    },
    fn: "objetsaisiepn.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var GUID = require('GUID.js');
        var ObjetInvocateur = require('Invocateur.js').ObjetInvocateur;
        var Invocateur = require('Invocateur.js').Invocateur;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var _ObjetInterfacePage = require('_InterfacePage.js');
        var GHtml = require('GHtml.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreImpression = require('Enumere_Genreimpression.js');
        var ObjetBandeau = require('ObjetBandeau.js');
        var ObjetBoutonBandeau = require('ObjetBoutonBandeau.js');
        var ObjetCheckBox = require('ObjetCheckBox.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreEvntMenusDeroulants = require('Enumere_EvntMenusDeroulants.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetAffichagePageAvecMenusDeroulants = require('InterfacePageAvecMenusDeroulants.js');
        var ObjetSaisiePN = require('ObjetSaisiePN.js');
        var ObjetFenetre_FicheEleve = require('ObjetFenetre_FicheEleve.js');
        var GChaine = require('GChaine.js');
        MethodesObjet.heritagePrototype(ObjetInterfacePage, _ObjetInterfacePage);

        function ObjetInterfacePage() {
            this.inheritedCreate(arguments);
            this._idAddZoneBandeau = GUID.getId();
        }
        ObjetInterfacePage.prototype.getPrioriteAffichageBandeauLargeur = function() {
            return [ObjetCheckBox, ObjetBandeau, ObjetAffichagePageAvecMenusDeroulants];
        };
        ObjetInterfacePage.prototype.conditionSuppAfficherBandeau = function(aIdent) {
            return this.Instances[aIdent] && (!MethodesTableau.existe(this.GenreAffichage[aIdent], [ObjetAffichagePageAvecMenusDeroulants, ObjetSaisiePN]));
        };
        ObjetInterfacePage.prototype.afficherMessage = function(aMessage) {
            GHtml.setHtml(this.idPage, this.composeMessage(aMessage));
        };
        ObjetInterfacePage.prototype._EvenementAfficherMessage = function(AGenreMessage) {
            this.afficherBandeau(false);
            if (this.Instances[this.IdentZoneAlClient]) {
                var LMessage = typeof(AGenreMessage) === 'number' ? GTraductions.getValeur('Message')[AGenreMessage] : AGenreMessage;
                this.Instances[this.IdentZoneAlClient].effacer(this.composeMessage(LMessage));
                this.Instances[this.IdentZoneAlClient].IdPremierElement = this.idMessageActionRequise;
            }
        };
        ObjetInterfacePage.prototype.EvenementAfficherMessage = function(aGenreMessage) {
            Invocateur.evenement(ObjetInvocateur.events.activationImpression, EGenreImpression.Aucune);
            this._EvenementAfficherMessage(aGenreMessage);
        };
        ObjetInterfacePage.prototype.construireFicheEleveEtFichePhoto = function() {
            if (this.avecFicheEleve()) {
                this.identBtnFicheEleve = this.Add(ObjetBoutonBandeau, this.evtSurBtnFicheEleve, this.initialiserBtnFicheEleve);
                if (ObjetFenetre_FicheEleve) {
                    this.identFenetreFicheEleve = this.Add(ObjetFenetre_FicheEleve, null, this.initialiserFenetreFicheEleve);
                }
                if (GApplication.droits.get(TypeDroits.eleves.consulterPhotosEleves)) {
                    this.identBtnFichePhoto = this.Add(ObjetBoutonBandeau, this.evtSurBtnFichePhoto, this.initialiserBtnPhotoEleve);
                    var ObjetFichePhotos = require('ObjetFichePhotos.js');
                    if (ObjetFichePhotos) {
                        this.identFichePhoto = this.Add(ObjetFichePhotos);
                    }
                }
            }
        };
        ObjetInterfacePage.prototype.estUnOngletAvecFicheEleve = function(aOnglet) {
            var lListeOngletsAvecFicheEleve = [
                EGenreOnglet.Bulletins, EGenreOnglet.Dossiers, EGenreOnglet.FicheBrevet, EGenreOnglet.FicheScolaire, EGenreOnglet.LivretScolaire_Fiche, EGenreOnglet.Releve, EGenreOnglet.SaisieAbsences_AppelEtSuivi, EGenreOnglet.SaisieAbsences_Appel, EGenreOnglet.SaisieAbsences_Appel_Professeur, EGenreOnglet.SaisieAppreciationsBulletin, EGenreOnglet.SaisieAppreciationsGenerales, EGenreOnglet.SaisieAppreciationsGenerales_Competences, EGenreOnglet.SaisieAppreciationsReleve, EGenreOnglet.SaisieNotes, EGenreOnglet.SaisieAppreciationDeFinDeStage, EGenreOnglet.SuivisAbsenceRetard, EGenreOnglet.ListeEleves, EGenreOnglet.AbsencesGrille, EGenreOnglet.SaisieOrientation, EGenreOnglet.ReleveEvaluationsParService, EGenreOnglet.ReleveEvaluationsParClasse, EGenreOnglet.BulletinCompetences, EGenreOnglet.ReleveDeCompetences, EGenreOnglet.AppreciationsBulletinParEleve, EGenreOnglet.Evaluation, EGenreOnglet.ListeEvaluation, EGenreOnglet.SaisieAvisProfesseur
            ];
            return MethodesTableau.existe(aOnglet, lListeOngletsAvecFicheEleve);
        };
        ObjetInterfacePage.prototype.estUnEspaceAvecFicheEleve = function(aEspace) {
            var lListeEspacesAvecFicheEleve = [
                EGenreEspace.Professeur, EGenreEspace.Etablissement, EGenreEspace.PrimProfesseur
            ];
            return MethodesTableau.existe(aEspace, lListeEspacesAvecFicheEleve);
        };
        ObjetInterfacePage.prototype.avecFicheEleve = function() {
            return this.estUnEspaceAvecFicheEleve(GEtatUtilisateur.GenreEspace) &&
                this.estUnOngletAvecFicheEleve(GEtatUtilisateur.getGenreOnglet()) && (GApplication.droits.get(TypeDroits.eleves.consulterIdentiteEleve) || GApplication.droits.get(TypeDroits.eleves.consulterFichesResponsables));
        };
        ObjetInterfacePage.prototype.evtSurBtnFicheEleve = function() {
            this._objGestionFocus_apresFenetreFicheEleve = {
                id: this.GetInstance(this.identBtnFicheEleve).getPremierElement()
            };
            if (this.identFenetreFicheEleve) {
                var lFenetre = this.GetInstance(this.identFenetreFicheEleve);
                lFenetre.SetDonnees();
            }
        };
        ObjetInterfacePage.prototype.evtSurBtnFichePhoto = function(aGenre, aBloquerFocus) {
            this._objGestionFocus_apresFenetreFichePhoto = {
                id: this.GetInstance(this.identBtnFichePhoto).getPremierElement()
            };
            if (this.identFichePhoto) {
                var lRessource = (aGenre !== undefined) ? GEtatUtilisateur.Navigation.GetRessource(aGenre) : null;
                if (!!lRessource && lRessource.existeNumero()) {
                    var lUrl = GChaine.composerUrlLienExterne({
                        documentJoint: lRessource,
                        libelleEcran: 'photo.jpg',
                        genreRessource: aGenre,
                        brut: true
                    });
                    this.GetInstance(this.identFichePhoto).SetDonnees(null, lUrl, null, aBloquerFocus);
                } else {
                    this.GetInstance(this.identFichePhoto).SetDonnees(null, '', null, aBloquerFocus);
                }
            }
        };
        ObjetInterfacePage.prototype.setGraphe = function(aGraphe, aParamGraphe) {
            this._graphe = aGraphe;
            this._paramGraphe = aParamGraphe;
        };
        ObjetInterfacePage.prototype.evtSurBtnFicheGraphe = function() {
            if (this.GetInstance(this.identFicheGraphe)) {
                if (this._graphe.image[0]) {
                    this.GetInstance(this.identFicheGraphe).SetDonnees(this._graphe, this._paramGraphe);
                } else {
                    GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Information,
                        titre: null,
                        message: this._graphe.message,
                        callback: null,
                        avecDecalageFocusBouton: true
                    });
                }
            }
        };
        ObjetInterfacePage.prototype.actualiserFicheGraphe = function() {
            if (this.GetInstance(this.identFicheGraphe) && this.GetInstance(this.identFicheGraphe).EnAffichage) {
                this.GetInstance(this.identFicheGraphe).SetDonnees(this._graphe, this._paramGraphe);
            }
        };
        ObjetInterfacePage.prototype.initialiserBtnFicheEleve = function(aInstance) {
            aInstance.SetParametres('Image_ContactsPourBandeauTitre', true, false, false, [GTraductions.getValeur('FicheRenseignement'), GTraductions.getValeur('FicheRenseignement'), GTraductions.getValeur('FicheRenseignement')], 20, false);
        };
        ObjetInterfacePage.prototype.initialiserBtnPhotoEleve = function(aInstance) {
            aInstance.SetParametres('Image_PhotoPourBandeau', true, false, false, new Array(GTraductions.getValeur('VoirPhotoEleve'), GTraductions.getValeur('VoirPhotoEleve'), GTraductions.getValeur('VoirPhotoEleve')), 20, false);
            aInstance.SetGenre(EGenreRessource.Eleve);
        };
        ObjetInterfacePage.prototype.initialiserBtnGraphe = function(aInstance) {
            aInstance.SetParametres('Image_GrapheAraignee', true, false, true, [GTraductions.getValeur('competences.GrapheAraignee'), GTraductions.getValeur('competences.GrapheAraignee'), GTraductions.getValeur('competences.GrapheAraignee')], 20, false);
            aInstance.SetGenre(EGenreRessource.Eleve);
        };
        ObjetInterfacePage.prototype.initialiserFenetreFicheEleve = function(aInstance) {
            aInstance.SetParametres_Fenetre('', 850, 400, [GTraductions.getValeur('Fermer')], false);
            aInstance.setOngletsVisibles({
                projets: false,
                attestations: false
            });
        };
        ObjetInterfacePage.prototype.fermerFenetreFicheEleve = function() {
            if (this.fenetreFicheEleveEstAffiche()) {
                var lFenetre = this.GetInstance(this.identFenetreFicheEleve);
                lFenetre.Fermer();
            }
        };
        ObjetInterfacePage.prototype.fermerPhotoEleve = function() {
            if (this.fenetrePhotoEleveEstAffiche()) {
                var lFenetre = this.GetInstance(this.identFichePhoto);
                lFenetre.Fermer();
            }
        };
        ObjetInterfacePage.prototype.fenetreFicheEleveEstAffiche = function() {
            if (this.identFenetreFicheEleve) {
                var lFenetre = this.GetInstance(this.identFenetreFicheEleve);
                return lFenetre.EstAffiche();
            } else {
                return false;
            }
        };
        ObjetInterfacePage.prototype.fenetrePhotoEleveEstAffiche = function() {
            if (this.identFichePhoto) {
                var lFenetre = this.GetInstance(this.identFichePhoto);
                return lFenetre.EstAffiche();
            } else {
                return false;
            }
        };
        ObjetInterfacePage.prototype.surSelectionEleve = function() {
            this.activerFichesEleve(true);
            if (this.fenetreFicheEleveEstAffiche()) {
                var lFenetre = this.GetInstance(this.identFenetreFicheEleve);
                if (GEtatUtilisateur.estModeAccessible()) {
                    lFenetre.Fermer();
                } else {
                    lFenetre.SetDonnees(null, true);
                }
            }
            if (this.fenetrePhotoEleveEstAffiche()) {
                if (GEtatUtilisateur.estModeAccessible()) {
                    this.GetInstance(this.identFichePhoto).Fermer();
                } else {
                    this.evtSurBtnFichePhoto(EGenreRessource.Eleve, true);
                }
            }
        };
        ObjetInterfacePage.prototype.activerFichesEleve = function(aActiver) {
            if (this.identBtnFicheEleve) {
                this.GetInstance(this.identBtnFicheEleve).setActif(aActiver);
            }
            if (this.identBtnFichePhoto) {
                this.GetInstance(this.identBtnFichePhoto).setActif(aActiver);
            }
            if (!aActiver) {
                this.fermerFenetreFicheEleve();
                this.fermerPhotoEleve();
            }
        };
        ObjetInterfacePage.prototype.selectionneEleveAutoDansPage = function(aIdentPage) {
            var lTrouve = this.GetInstance(aIdentPage).selectionnerEleveCourant();
            this.activerFichesEleve(lTrouve);
        };
        ObjetInterfacePage.prototype.surEvntMenusDeroulants = function(aParam) {
            switch (aParam.genreEvenement) {
                case EGenreEvntMenusDeroulants.ressourceNonTrouve:
                    this.surRessourceCouranteNonTrouveeDansCombo(aParam);
                    break;
            }
        };
        ObjetInterfacePage.prototype.surRessourceCouranteNonTrouveeDansCombo = function(aParam) {
            this.activerFichesEleve(false);
        };
        ObjetInterfacePage.prototype._gestionFocus_apresFenetreFicheEleve = function() {
            if (this._objGestionFocus_apresFenetreFicheEleve && this._objGestionFocus_apresFenetreFicheEleve.id) {
                GHtml.setFocus(this._objGestionFocus_apresFenetreFicheEleve.id);
            }
            this._objGestionFocus_apresFenetreFicheEleve = null;
        };
        ObjetInterfacePage.prototype._gestionFocus_apresFenetreFichePhoto = function() {
            if (this._objGestionFocus_apresFenetreFichePhoto && this._objGestionFocus_apresFenetreFichePhoto.id) {
                GHtml.setFocus(this._objGestionFocus_apresFenetreFichePhoto.id);
            }
            this._objGestionFocus_apresFenetreFichePhoto = null;
        };
        module.exports = ObjetInterfacePage;
    },
    fn: "interfacepage.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('_ObjetHtml.js').GHtml;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetInterfacePage = require('InterfacePage.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var EGenreEtat = require('Enumere_Etat.js');
        var TUtilitaireUrl = require('UtilitaireUrl.js');
        var GUID = require('GUID.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreAction = require('Enumere_Action.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetFenetre_UploadFichiers = require('ObjetFenetre_UploadFichiers.js');

        function InterfaceDocumentsAFournir() {
            this.inheritedCreate(arguments);
            this.idLibelle = GUID.getId();
            this.idPiecesJointes = GUID.getId();
            this.idBoutonPJ = GUID.getId();
            this.donnees = {
                listeNaturesDocument: null
            };
        }
        MethodesObjet.heritagePrototype(InterfaceDocumentsAFournir, ObjetInterfacePage);
        InterfaceDocumentsAFournir.prototype.getNatureDocument = function(aNumeroNatureDocument) {
            var lNatureDocument = null;
            if (!!this.donnees.listeNaturesDocument) {
                lNatureDocument = this.donnees.listeNaturesDocument.GetElementParNumero(aNumeroNatureDocument);
            }
            return lNatureDocument;
        };
        InterfaceDocumentsAFournir.prototype.getControleur = function(aInstance) {
            return {
                btnAjoutDocument: {
                    getDisabled: function(aNumeroNatureDocument) {
                        var lNatureDoc = aInstance.getNatureDocument(aNumeroNatureDocument);
                        return !lNatureDoc || !lNatureDoc.avecDepotAutorise || (!!lNatureDoc.listePJ && lNatureDoc.listePJ.GetNbrElementsExistes() === 1);
                    },
                    event: function(aNumeroNatureDocument) {
                        afficherFenetreAjoutFichier.call(aInstance, aNumeroNatureDocument);
                    }
                },
                getHtmlListeDocuments: function(aNumeroNatureDocument) {
                    var lDisplayPJ = [];
                    var lNatureDoc = aInstance.getNatureDocument(aNumeroNatureDocument);
                    if (!!lNatureDoc && !!lNatureDoc.listePJ && lNatureDoc.listePJ.GetNbrElements() > 0) {
                        lDisplayPJ.push(TUtilitaireUrl.construireListeUrls({
                            liste: lNatureDoc.listePJ,
                            genreRessource: EGenreRessource.DocJointEleve,
                            IEModelBtnSupp: (!!lNatureDoc.avecDepotAutorise ? 'btnSupprimerPJ' : ''),
                            argsControleur: [lNatureDoc.GetNumero()]
                        }));
                    } else {
                        lDisplayPJ.push('<span class="AucunDocument">', GTraductions.getValeur('PageCompte.AucunFichierNAEteJoint'), '</span>');
                    }
                    return lDisplayPJ.join('');
                },
                btnSupprimerPJ: {
                    event: function(aIndice, aNumeroNatureDocument) {
                        var lNatureDoc = aInstance.getNatureDocument(aNumeroNatureDocument);
                        if (!!lNatureDoc && !!lNatureDoc.listePJ) {
                            var lDocumentJointASupp = lNatureDoc.listePJ.GetElement(aIndice);
                            if (!!lDocumentJointASupp) {
                                GApplication.getMessage().afficher({
                                    type: EGenreBoiteMessage.Confirmation,
                                    message: GTraductions.getValeur('PageCompte.ConfirmationSuppression'),
                                    callback: function(aGenreAction) {
                                        if (aGenreAction === EGenreAction.Valider) {
                                            lDocumentJointASupp.SetEtat(EGenreEtat.Suppression);
                                            lNatureDoc.SetEtat(EGenreEtat.Modification);
                                            aInstance.SetEtatSaisie(true);
                                        }
                                    }
                                });
                            }
                        }
                    }
                }
            };
        };

        function afficherFenetreAjoutFichier(aNumeroNatureDocument) {
            var lNatureDoc = this.getNatureDocument(aNumeroNatureDocument);
            if (!!lNatureDoc) {
                var lThis = this;
                var lObjetFenetreAjoutMultiple = ObjetFenetre.creerInstance(ObjetFenetre_UploadFichiers, {
                    pere: lThis,
                    evenement: function(aGenreBouton, aListeFichiers) {
                        if (aGenreBouton === EGenreAction.Valider) {
                            if (!lNatureDoc.listePJ) {
                                lNatureDoc.listePJ = new ObjetListeElements();
                            }
                            if (!!aListeFichiers && aListeFichiers.GetNbrElements() > 0) {
                                lNatureDoc.listePJ.AddElement(aListeFichiers.GetPremierElement());
                                lNatureDoc.SetEtat(EGenreEtat.Modification);
                                lThis.SetEtatSaisie(true);
                            }
                        }
                        lObjetFenetreAjoutMultiple.Fermer();
                    }
                });
                lObjetFenetreAjoutMultiple.setDonnees(EGenreRessource.DocumentJoint, {
                    tailleMaxUploadFichier: GApplication.droits.get(TypeDroits.tailleMaxDocJointEtablissement),
                    functionGetNomPdfGenere: function() {
                        var lLibelleUtilisateur = GEtatUtilisateur.getMembre().GetLibelle();
                        return lLibelleUtilisateur + '_' + GDate.FormatDate(GDate.getDateHeureCourante(), '%JJ%MM%AAAA_%hh%mm%ss') + '.pdf';
                    }
                });
                lObjetFenetreAjoutMultiple.afficher();
            }
        }

        function _construitBlocNatureDocuments(aNatureDocument) {
            var H = [];
            if (!!aNatureDocument) {
                var lLibelleNatureDocument = [aNatureDocument.GetLibelle()];
                if (!!aNatureDocument.avecDepotAutorise && !!aNatureDocument.dateLimiteDepot) {
                    var lStrDate = GDate.FormatDate(aNatureDocument.dateLimiteDepot, '%JJ/%MM/%AAAA');
                    lLibelleNatureDocument.push(' (', GTraductions.getValeur('PageCompte.aJoindreJusquau', [lStrDate]), ')');
                }
                H.push('<div class="BlocNatureDocumentEleve">');
                H.push('<div class="LibelleNatureDocumentEleve">', lLibelleNatureDocument.join(''), '</div>');
                H.push('<div class="BlocListeDocuments" ie-html="getHtmlListeDocuments(\'', aNatureDocument.GetNumero(), '\')"></div>');
                if (!!aNatureDocument.avecDepotAutorise) {
                    H.push('<ie-bouton class="BoutonAjouterDocument" ie-model="btnAjoutDocument(\'', aNatureDocument.GetNumero(), '\')">', '<i class="material-icons icon_download_alt"></i>', '<span>', GTraductions.getValeur('PageCompte.JoindreUnFichier'), '</span>', '</ie-bouton>');
                }
                H.push('</div>');
            }
            return H.join('');
        }
        InterfaceDocumentsAFournir.prototype.ConstruireAffichage = function() {
            var H = [];
            if (!!this.donnees.listeNaturesDocument && this.donnees.listeNaturesDocument.GetNbrElements() > 0) {
                H.push('<div class="ZoneListeDocumentsAFournir">');
                this.donnees.listeNaturesDocument.parcourir(function(aNatureDoc) {
                    H.push(_construitBlocNatureDocuments(aNatureDoc));
                });
                H.push('</div>');
            }
            return H.join('');
        };
        InterfaceDocumentsAFournir.prototype.getListeFichiersAUpload = function() {
            var lListeFichiersAFournir = null;
            if (!!this.donnees.listeNaturesDocument && this.donnees.listeNaturesDocument.existeElementPourValidation()) {
                this.donnees.listeNaturesDocument.parcourir(function(aNatureDoc) {
                    if (!!aNatureDoc && aNatureDoc.PourValidation() && !!aNatureDoc.listePJ && aNatureDoc.listePJ.existeElementPourValidation()) {
                        aNatureDoc.listePJ.parcourir(function(aDocumentEleve) {
                            if (!!aDocumentEleve && aDocumentEleve.Etat === EGenreEtat.Creation) {
                                if (!lListeFichiersAFournir) {
                                    lListeFichiersAFournir = new ObjetListeElements();
                                }
                                lListeFichiersAFournir.AddElement(aDocumentEleve);
                            }
                        });
                    }
                });
            }
            return lListeFichiersAFournir;
        };
        InterfaceDocumentsAFournir.prototype.SetDonnees = function(aDonnees) {
            this.donnees = aDonnees;
            GHtml.setHtml(this.Nom, this.ConstruireAffichage(), {
                controleur: this.controleur
            });
        };
        module.exports = InterfaceDocumentsAFournir;
    },
    fn: "interfacedocumentsafournir.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetPageParametresEnfants = require('mobile/script/PageParametresEnfants.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var InterfaceDocumentsAFournir = require('InterfaceDocumentsAFournir.js');
        var ObjetRequeteSaisieCompteEnfant = require('ObjetRequeteSaisieCompteEnfant.js');

        function ObjetAffichagePageParametresEnfants_Mobile() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(ObjetAffichagePageParametresEnfants_Mobile, ObjetInterfacePage_Mobile);
        ObjetAffichagePageParametresEnfants_Mobile.prototype.ConstruireInstances = function() {
            this.identPage = this.Add(ObjetPageParametresEnfants);
            this.identListeDocumentsAFournir = this.Add(InterfaceDocumentsAFournir);
        };
        ObjetAffichagePageParametresEnfants_Mobile.prototype.SetParametresGeneraux = function() {
            this.GenreStructure = EStructureAffichage.Autre;
        };
        ObjetAffichagePageParametresEnfants_Mobile.prototype.ConstruireStructureAffichageAutre = function() {
            var H = [];
            H.push('<div id="', this.GetInstance(this.identPage).GetNom(), '"></div>');
            return H.join('');
        };
        ObjetAffichagePageParametresEnfants_Mobile.prototype.ActionSurValidation = function() {
            this.inherited('ActionSurValidation');
            this.GetInstance(this.identPage).RecupererDonnees();
        };
        ObjetAffichagePageParametresEnfants_Mobile.prototype.Valider = function() {
            var lStructure = {};
            if (this.GetInstance(this.identPage).getStructurePourValidation(lStructure)) {
                this.SetEtatSaisie(false);
                this.lListeActuellePJ = this.GetInstance(this.identListeDocumentsAFournir).getListeFichiersAUpload();
                new ObjetRequeteSaisieCompteEnfant(this, this.ActionSurValidation).addUpload({
                    listeFichiers: this.lListeActuellePJ
                }).lancerRequete(lStructure);
            }
        };
        module.exports = ObjetAffichagePageParametresEnfants_Mobile;
    },
    fn: "mobile/script/interfacepageparametresenfants.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieNotifications() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisiePreferencesNotifications', ObjetRequeteSaisieNotifications, ObjetRequeteSaisie);
        ObjetRequeteSaisieNotifications.prototype.lancerRequete = function(aParam) {
            this.JSON = $.extend({}, aParam);
            return this.appelAsynchrone();
        };
        ObjetRequeteSaisieNotifications.prototype.actionApresRequete = function(aXml, aGenreReponse) {
            this.callbackReussite.appel(aXml, aGenreReponse, this.JSONRapportSaisie);
        };
        module.exports = ObjetRequeteSaisieNotifications;
    },
    fn: "objetrequetesaisienotifications.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetDonneesListe = require('ObjetDonneesListe.js');
        var TypeGenreSourceConnexion = require('TypeSecurisationCompte.js').TypeGenreSourceConnexion;
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreTriElement = require('Enumere_TriElement.js');

        function DonneesListe_SourcesConnexions(aDonnees) {
            this.inheritedCreate(aDonnees);
            this.setOptions({
                avecSelection: true,
                avecEvnt_ApresEdition: true,
                avecActualisation_ApresEdition: false,
                avecEvnt_Suppression: true,
                avecEtatSaisie: false
            });
        }
        MethodesObjet.heritagePrototype(DonneesListe_SourcesConnexions, ObjetDonneesListe);
        DonneesListe_SourcesConnexions.colonnes = {
            libelle: 'libelle',
            appareil: 'appareil',
            derniereCo: 'derniereCo',
            genre: 'genre'
        };
        DonneesListe_SourcesConnexions.prototype.GetTypeValeur = function(aParams) {
            switch (aParams.idColonne) {
                case DonneesListe_SourcesConnexions.colonnes.derniereCo:
                    return ObjetDonneesListe.ETypeCellule.Date;
                case DonneesListe_SourcesConnexions.colonnes.genre:
                    return ObjetDonneesListe.ETypeCellule.Html;
            }
        };
        DonneesListe_SourcesConnexions.prototype.GetValeur = function(I, D, aParams) {
            switch (aParams.idColonne) {
                case DonneesListe_SourcesConnexions.colonnes.libelle:
                    return aParams.article.GetLibelle();
                case DonneesListe_SourcesConnexions.colonnes.appareil:
                    return aParams.article.libelleSysteme;
                case DonneesListe_SourcesConnexions.colonnes.derniereCo:
                    return aParams.article.dateDerniereConnexion;
                case DonneesListe_SourcesConnexions.colonnes.genre:
                    var lImage = '';
                    switch (aParams.article.GetGenre()) {
                        case TypeGenreSourceConnexion.GSC_ClientLourd:
                            lImage = 'icon_laptop';
                            break;
                        case TypeGenreSourceConnexion.GSC_ApplicationMobile:
                            lImage = 'icon_mobile_phone';
                            break;
                        case TypeGenreSourceConnexion.GSC_Navigateur:
                            lImage = 'icon_globe';
                            break;
                        default:
                            ;
                    }
                    return '<i class="' + lImage + '" style="font-size:1.4rem;"></i>';
                default:
                    break;
            }
        };
        DonneesListe_SourcesConnexions.prototype.getChaineDeDate = function(aDate) {
            return MethodesObjet.isDate(aDate) ? GDate.FormatDate(aDate, '%JJ/%MM/%AAAA') : '';
        };
        DonneesListe_SourcesConnexions.prototype.AvecEdition = function(aColonne, aArticle, aParams) {
            return aParams.idColonne === DonneesListe_SourcesConnexions.colonnes.libelle;
        };
        DonneesListe_SourcesConnexions.prototype.SurEdition = function(aParams, I, D, V) {
            aParams.article.Libelle = V;
        };
        DonneesListe_SourcesConnexions.prototype.GetMessage_Suppression_Confirmation = function() {
            return GTraductions.getValeur('DoubleAuth.PrefConfirmerSupprimer');
        };
        DonneesListe_SourcesConnexions.prototype.getClass = function(aParams) {
            return aParams.idColonne === DonneesListe_SourcesConnexions.colonnes.genre ? 'AlignementMilieu' : '';
        };
        DonneesListe_SourcesConnexions.prototype.getTri = function() {
            return [
                ObjetTri.init('dateDerniereConnexion', EGenreTriElement.Decroissant), ObjetTri.init('libelleSysteme'), ObjetTri.init('Libelle')
            ];
        };
        module.exports = DonneesListe_SourcesConnexions;
    },
    fn: "donneesliste_sourcesconnexions.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetListe = require('ObjetListe.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetAbstraitInterface = require('ObjetInterface.js');
        var DonneesListe_SourcesConnexions = require('DonneesListe_SourcesConnexions.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreEvenementListe = require('Enumere_EvenementListe.js');
        var ObjetRequeteSecurisationComptePreference = require('ObjetRequeteSecurisationCompte.js').ObjetRequeteSecurisationComptePreference;
        var TypeCommandeSecurisationCompteHttp = require('TypeSecurisationCompte.js').TypeCommandeSecurisationCompteHttp;

        function InterfaceParamListeSourcesConnexions() {
            this.inheritedCreate(arguments);
            this.GenreStructure = EStructureAffichage.Autre;
        }
        MethodesObjet.heritagePrototype(InterfaceParamListeSourcesConnexions, ObjetAbstraitInterface);
        InterfaceParamListeSourcesConnexions.prototype.ConstruireInstances = function() {
            this.identListe = this.Add(ObjetListe, _evenementListe);
        };

        function _evenementListe(aParametres) {
            switch (aParametres.genreEvenement) {
                case EGenreEvenementListe.Suppression:
                    new ObjetRequeteSecurisationComptePreference(this).lancerRequete({
                        action: TypeCommandeSecurisationCompteHttp.csch_SupprimerSourceConnexionConnue,
                        identifiantSysteme: aParametres.article.identifiantSysteme,
                        genreSource: aParametres.article.GetGenre()
                    }).then(function() {
                        this.callback.appel({
                            actualiser: true
                        });
                    }.bind(this));
                    break;
                case EGenreEvenementListe.ApresEdition:
                    if (aParametres.article.GetLibelle()) {
                        new ObjetRequeteSecurisationComptePreference(this).setOptions({
                            gererMessageErreur: false
                        }).lancerRequete({
                            action: TypeCommandeSecurisationCompteHttp.csch_RenommerSourceConnexionConnue,
                            identifiantSysteme: aParametres.article.identifiantSysteme,
                            genreSource: aParametres.article.GetGenre(),
                            libelleSaisi: aParametres.article.GetLibelle()
                        }).catch(function() {}).then(function() {
                            this.callback.appel({
                                actualiser: true
                            });
                        }.bind(this));
                    }
                    break;
            }
        }
        InterfaceParamListeSourcesConnexions.prototype.setDonnees = function(aDonnees) {
            this.Initialiser();
            this.donnees = aDonnees;
            this.GetInstance(this.identListe).setOptionsListe({
                colonnes: [{
                    id: DonneesListe_SourcesConnexions.colonnes.libelle,
                    taille: IE.estMobile ? ObjetListe.initColonne(100, '6rem') : '12rem',
                    titre: GTraductions.getValeur('DoubleAuth.PrefListeLibelle')
                }, {
                    id: DonneesListe_SourcesConnexions.colonnes.appareil,
                    taille: IE.estMobile ? ObjetListe.initColonne(50, '6rem') : '20rem',
                    titre: GTraductions.getValeur('DoubleAuth.PrefListeAppareil')
                }, {
                    id: DonneesListe_SourcesConnexions.colonnes.derniereCo,
                    taille: IE.estMobile ? '6.5rem' : '8rem',
                    titre: IE.estMobile ? GTraductions.getValeur('DoubleAuth.PrefListeDate_Court') : GTraductions.getValeur('DoubleAuth.PrefListeDate')
                }, {
                    id: DonneesListe_SourcesConnexions.colonnes.genre,
                    taille: '4rem',
                    titre: GTraductions.getValeur('DoubleAuth.PrefListeIcone')
                }],
                hauteurAdapteContenu: true,
                hauteurMaxAdapteContenu: 200,
                boutons: [{
                    genre: ObjetListe.typeBouton.supprimer
                }],
                nonEditable: !!this.donnees.nonEditable
            }).SetDonnees(new DonneesListe_SourcesConnexions(this.donnees.listeSourcesConnexions));
        };
        InterfaceParamListeSourcesConnexions.prototype.ConstruireStructureAffichageAutre = function() {
            var H = [];
            var lLegendes = [
                GTraductions.getValeur('DoubleAuth.PrefChoisirDEnregistrer'), GTraductions.getValeur('DoubleAuth.PersonnesConfiance'), GTraductions.getValeur('DoubleAuth.PrefPensezASupprimer')
            ];
            var lNomListe = this.GetInstance(this.identListe).Nom;
            if (IE.estMobile) {
                H.push('<div>', '<label style="display: inline-block; line-height: 1.1rem; font-size: 1rem;">', lLegendes.join('<br>'), '</label>', '<div id="', lNomListe, '" style="margin-top:0.4rem;"></div>', '</div>');
            } else {
                H.push('<div style="display:flex; flex-wrap: wrap;">', '<div id="', lNomListe, '"></div>', '<div style="flex: 1 1 auto; margin-left:0.6rem; max-width:350px">', lLegendes.join('<br><br>'), '</div>', '</div>');
            }
            return H.join('');
        };
        module.exports = InterfaceParamListeSourcesConnexions;
    },
    fn: "interfaceparamlistesourcesconnexions.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var GTraductions = require('ObjetTraduction.js');
        var SecurisationCompte = require('TypeSecurisationCompte.js');
        var TypeModeGestionDoubleAuthentification = SecurisationCompte.TypeModeGestionDoubleAuthentification;
        var TypeCommandeSecurisationCompteHttp = SecurisationCompte.TypeCommandeSecurisationCompteHttp;
        var ObjetRequeteSecurisationComptePreference = require('ObjetRequeteSecurisationCompte.js').ObjetRequeteSecurisationComptePreference;
        var ObjetFenetre = require('ObjetFenetre.js');
        var ObjetSaisieCodePIN = require('ObjetSaisieCodePIN.js');
        var ObjetChoixStrategieSecurisation = require('ObjetChoixStrategieSecurisation.js');

        function ObjetParamChoixStrategieSecurisation() {
            this.inheritedCreate(arguments);
            this.instanceChoix = Identite.creerInstance(ObjetChoixStrategieSecurisation, {
                pere: this
            });
        }
        MethodesObjet.heritagePrototype(ObjetParamChoixStrategieSecurisation, Identite);
        ObjetParamChoixStrategieSecurisation.prototype.setDonnees = function(aDonnees) {
            this.donnees = aDonnees;
            this.Afficher('<div id="' + this.instanceChoix.Nom + '"></div>');
            this.instanceChoix.setOptions({
                modeAffichage: ObjetChoixStrategieSecurisation.typeAffichage.prefUtilisateur,
                modesPossibles: aDonnees.modesPossibles,
                callbackChoix: function(aGenre) {
                    _affecterChoix(this, aGenre);
                }.bind(this)
            }).setDonnees(aDonnees);
        };

        function _ouvrirFenetrePIN_promise(aInstance, aVerifierPIN) {
            return new Promise(function(aResolve, aReject) {
                var lOptionsPIN = {
                    classeRequete: ObjetRequeteSecurisationComptePreference,
                    modePIN: aVerifierPIN ? ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN : ObjetSaisieCodePIN.ModeSaisieValiderPIN.msModifierPIN
                };
                ObjetFenetre.creerInstance(_ObjetFenetre_SaisieCodePIN, {
                    pere: aInstance,
                    evenement: function() {
                        aReject();
                    }
                }, {
                    titre: aVerifierPIN ? GTraductions.getValeur('DoubleAuth.RenforcerSecuTitre') : GTraductions.getValeur('DoubleAuth.TitreFiche'),
                    callbackPIN: function(aCodePIN) {
                        aResolve(aCodePIN);
                    }
                }).setDonnees(lOptionsPIN, {
                    mode: TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN
                });
            });
        }

        function _affecterChoix(aInstance, aGenreChoix) {
            var lParamsRequete = {};
            Promise.resolve().then(function() {
                if (aInstance.donnees.mode === TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN) {
                    return _ouvrirFenetrePIN_promise(aInstance, true).then(function(aCodePIN) {
                        lParamsRequete.ancienCodePin = aCodePIN;
                    });
                }
            }).then(function() {
                if (aGenreChoix === TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN) {
                    return _ouvrirFenetrePIN_promise(aInstance, false).then(function(aCodePIN) {
                        Object.assign(lParamsRequete, {
                            action: TypeCommandeSecurisationCompteHttp.csch_AffecterCodePIN,
                            codePin: aCodePIN
                        });
                    });
                }
                Object.assign(lParamsRequete, {
                    action: TypeCommandeSecurisationCompteHttp.csch_AffecterModeDoubleAuthentification,
                    mode: aGenreChoix
                });
            }).then(function() {
                return new ObjetRequeteSecurisationComptePreference(aInstance).lancerRequete(lParamsRequete);
            }).then(function() {
                aInstance.callback.appel({
                    actualiser: true
                });
            }, function() {});
        }
        module.exports = ObjetParamChoixStrategieSecurisation;

        function _ObjetFenetre_SaisieCodePIN() {
            this.inheritedCreate(arguments);
            this.setOptionsFenetre({
                avecTailleSelonContenu: true,
                hauteurEcran_mobile: false
            });
        }
        MethodesObjet.heritagePrototype(_ObjetFenetre_SaisieCodePIN, ObjetFenetre);
        _ObjetFenetre_SaisieCodePIN.prototype.ConstruireInstances = function() {
            this.identPIN = this.Add(ObjetSaisieCodePIN, function(aCodePIN) {
                if (aCodePIN) {
                    this.optionsFenetre.callbackPIN(aCodePIN);
                    this.Fermer();
                }
            });
        };
        _ObjetFenetre_SaisieCodePIN.prototype.ComposeContenu = function() {
            return ['<div id="', this.GetInstance(this.identPIN).GetNom(), '"></div>'].join('');
        };
        _ObjetFenetre_SaisieCodePIN.prototype.setDonnees = function(aOptions, aDonnees) {
            this.Afficher();
            this.GetInstance(this.identPIN).setOptions(aOptions).setDonnees(aDonnees);
        };
    },
    fn: "objetparamchoixstrategiesecurisation.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetDonneesListe = require('ObjetDonneesListe.js');
        var TypeFiltreAffichage = require('Enumere_DonneesPersonnelles.js').TypeFiltreAffichage;

        function DonneesListe_FiltreCompte() {
            this.inheritedCreate(arguments);
            this.setOptions({
                avecEvnt_ModificationSelection: true,
                avecEvnt_SelectionClick: true,
                hauteurMinCellule: 35,
                avecTri: false
            });
        }
        MethodesObjet.heritagePrototype(DonneesListe_FiltreCompte, ObjetDonneesListe);
        DonneesListe_FiltreCompte.getColonnes = function() {
            return [{
                id: '0',
                taille: '100%'
            }];
        };
        DonneesListe_FiltreCompte.prototype.GetValeur = function(I, D, aParams) {
            var lIcon = '';
            switch (aParams.article.GetGenre()) {
                case TypeFiltreAffichage.securisation:
                    lIcon = 'icon_lock';
                    break;
                case TypeFiltreAffichage.coords:
                    lIcon = 'icon_list_alt';
                    break;
                case TypeFiltreAffichage.communication:
                    lIcon = 'icon_fiche_cours_partage';
                    break;
                case TypeFiltreAffichage.notification:
                    lIcon = 'icon_star';
                    break;
                case TypeFiltreAffichage.droitImage:
                    lIcon = 'icon_user';
                    break;
                default:
                    ;
            }
            return ['<div style="display: flex; align-items: center">', '<div style="flex:none; width:2rem; margin-right:0.6rem; text-align: center">', '<i class="', lIcon, '" style="font-size:18px; "></i>', '</div>', aParams.article.GetLibelle(), '</div>'].join('');
        };
        DonneesListe_FiltreCompte.prototype.getClassCelluleConteneur = function() {
            return IE.estMobile ? 'with-action-simple' : '';
        };
        module.exports = DonneesListe_FiltreCompte;
    },
    fn: "donneesliste_filtrecompte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('mobile/css/PageCompte.css');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetRequeteSaisieNotifications = require('ObjetRequeteSaisieNotifications.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var ObjetRequetePageInfosPerso = require('ObjetRequetePageInfosPerso.js');
        var UtilitairePageDonneesPersonnelles = require('UtilitairePageDonneesPersonnelles.js');
        var GHtml = require('GHtml.js');
        var EGenreTypeContenu = require('Enumere_DonneesPersonnelles.js').EGenreTypeContenu;
        var EListeIds = require('Enumere_DonneesPersonnelles.js').EListeIds;
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var EGenreCryptage = require('Enumere_Cryptage.js');
        var GCryptage = require('ObjetCryptage.js');
        var GUID = require('GUID.js');
        var InterfaceParamListeSourcesConnexions = require('InterfaceParamListeSourcesConnexions.js');
        var ObjetParamChoixStrategieSecurisation = require('ObjetParamChoixStrategieSecurisation.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetListe = require('ObjetListe.js');
        var DonneesListe_FiltreCompte = require('DonneesListe_FiltreCompte.js');
        var TypeFiltreAffichage = require('Enumere_DonneesPersonnelles.js').TypeFiltreAffichage;
        var EGenreEvenementListe = require('Enumere_EvenementListe.js');
        MethodesObjet.heritagePrototype(ObjetPageCompte, ObjetIdentite_Mobile);

        function ObjetPageCompte() {
            this.inheritedCreate(arguments);
            this.IdZoneChk = '_zoneChk';
            var notificationPush = GEtatUtilisateur.Identification.ressource.notificationsPush;
            this.avecPush = notificationPush;
            this.idIntersticial = GUID.getId();
            this.idMainPage = GUID.getId();
            this.parametres = {
                largeurLibelleInput: 30,
                hauteurInput: 20,
                largeurEmail: 220,
                largeurIndicatif: 40,
                largeurTel: 115,
                maskMDP: '*********',
                avecInfosEntreprise: GEtatUtilisateur.GenreEspace === EGenreEspace.Entreprise,
                avecTelFixe: GEtatUtilisateur.GenreEspace === EGenreEspace.Entreprise,
                avecTelFax: GEtatUtilisateur.GenreEspace === EGenreEspace.Entreprise,
                avecNumeroINE: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Eleve, EGenreEspace.Mobile_Eleve]),
                avecInfosAutorisations: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_Administrateur]),
                avecInfosO365: GEtatUtilisateur.avecO365()
            };
            this.donnees = UtilitairePageDonneesPersonnelles.getDonneesDefaut();
            this.instanceListeFiltre = Identite.creerInstance(ObjetListe, {
                pere: this,
                evenement: function(aParametres) {
                    switch (aParametres.genreEvenement) {
                        case EGenreEvenementListe.SelectionClick:
                            this.selectionFiltreCourante = aParametres.article;
                            _selectionnerFiltre.call(this);
                            break;
                    }
                }
            });
            this.instanceSourcesConnexions = Identite.creerInstance(InterfaceParamListeSourcesConnexions, {
                pere: this,
                evenement: function(aParam) {
                    _evenementSecurisation.call(this, aParam);
                }
            });
            this.instanceChoixStratSecurisation = Identite.creerInstance(ObjetParamChoixStrategieSecurisation, {
                pere: this,
                evenement: function(aParam) {
                    _evenementSecurisation.call(this, aParam);
                }
            });
        }

        function _evenementSecurisation(aParam) {
            if (aParam && aParam.actualiser) {
                var lScrollTop = global.scrollY;
                _envoiRequetePage.call(this).then(_selectionnerFiltre.bind(this)).then(function() {
                    if (lScrollTop > 0) {
                        global.scroll(0, lScrollTop);
                    }
                });
            }
        }
        ObjetPageCompte.prototype.toggleNotifs = function(aCoche) {
            this.avecPush = !aCoche;
            new ObjetRequeteSaisieNotifications(this, this._evenementSurSaisieNotification).lancerRequete({
                avecPush: this.avecPush
            });
        };
        ObjetPageCompte.prototype._evenementSurSaisieNotification = function() {
            GEtatUtilisateur.Identification.ressource.notificationsPush = this.avecPush;
        };
        ObjetPageCompte.prototype.getControleur = function(aInstance) {
            return Object.assign({
                getNodeHeader: function() {
                    $(this.node).on('click', function() {
                        aInstance.closeNav();
                    });
                }
            }, UtilitairePageDonneesPersonnelles.getControleur());
        };

        function _selectionnerFiltre() {
            var H = [];
            H.push('<div class="navheader">');
            H.push('<button class="btn-flat waves-effect waves-light btn-floating" ie-node="getNodeHeader" style="margin-right:0.6rem;">' + '<i class="material-icons icon_angle_left"></i></button>');
            H.push(this.selectionFiltreCourante.GetLibelle());
            H.push('</div>');
            switch (this.selectionFiltreCourante.GetGenre()) {
                case TypeFiltreAffichage.securisation:
                    if (GEtatUtilisateur.derniereConnexion) {
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.DerniereConnexion'), EGenreTypeContenu.DerniereConnexion));
                    }
                    if (GApplication.droits.get(TypeDroits.compte.avecSaisieIdentifiant)) {
                        H.push('<div class="pc_traitSeparation"></div>');
                        var lAuthentifiant = GChaine.ajouterEntites(GCryptage.decrypter({
                            genreCryptage: EGenreCryptage.AES,
                            chaine: this.donnees.authentifiant,
                            cle: GApplication.getCommunication().cleAES,
                            iv: GApplication.getCommunication().ivAES
                        }));
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.Identifiant'), EGenreTypeContenu.Identifiant, {
                            chaine: lAuthentifiant
                        }));
                    }
                    if (GApplication.droits.get(TypeDroits.compte.avecSaisieMotDePasse)) {
                        H.push('<div class="pc_traitSeparation"></div>');
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.MotDePasse'), EGenreTypeContenu.MotDePasse, {
                            maskMdp: this.parametres.maskMDP
                        }));
                    }
                    if (this.donnees.securisation) {
                        H.push('<div class="pc_traitSeparation"></div>');
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('DoubleAuth.SecuriteRenforcee'), EGenreTypeContenu.sourcesConnexions, {
                            idSourcesConnexions: this.instanceChoixStratSecurisation.Nom
                        }));
                    }
                    if (this.donnees.securisation && this.donnees.securisation.listeSourcesConnexions) {
                        H.push('<div class="pc_traitSeparation"></div>');
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('DoubleAuth.AppareilsIdentifies'), EGenreTypeContenu.sourcesConnexions, {
                            idSourcesConnexions: this.instanceSourcesConnexions.Nom
                        }));
                    }
                    if (this.parametres.avecNumeroINE) {
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.NumeroINE'), EGenreTypeContenu.INE, {
                            numeroINE: this.donnees.Informations.numeroINE
                        }));
                    }
                    break;
                case TypeFiltreAffichage.coords:
                    if (GApplication.droits.get(TypeDroits.compte.avecInformationsPersonnelles)) {
                        var lParams = {
                            civilite: this.donnees.Informations.civilite,
                            nom: this.donnees.Informations.nom,
                            prenom: this.donnees.Informations.prenoms,
                            avecInfosEntreprise: this.parametres.avecInfosEntreprise,
                            entreprise: this.donnees.Informations.entreprise,
                            fonction: this.donnees.Informations.fonction,
                            adresse1: this.donnees.Informations.adresse1,
                            adresse2: this.donnees.Informations.adresse2,
                            adresse3: this.donnees.Informations.adresse3,
                            adresse4: this.donnees.Informations.adresse4,
                            codePostal: this.donnees.Informations.codePostal,
                            ville: this.donnees.Informations.ville,
                            province: this.donnees.Informations.province,
                            pays: this.donnees.Informations.pays,
                            eMail: this.donnees.Informations.eMail,
                            largeurLibelleInput: this.parametres.largeurLibelleInput,
                            largeurEmail: this.parametres.largeurEmail,
                            hauteurInput: this.parametres.hauteurInput,
                            largeurIndicatif: this.parametres.largeurIndicatif,
                            avecTelFixe: this.parametres.avecTelFixe,
                            avecTelFax: this.parametres.avecTelFax,
                            largeurTel: this.parametres.largeurTel
                        };
                        if (!MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Eleve, EGenreEspace.Mobile_Professeur, EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Administrateur])) {
                            var lParamsHorsEleve = {
                                avecSMS: this.donnees.Autorisations.SMSAutorise
                            };
                            $.extend(lParams, lParamsHorsEleve);
                        }
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.Coordonnees'), EGenreTypeContenu.Coordonnees, lParams));
                    }
                    break;
                case TypeFiltreAffichage.communication:
                    if (this.parametres.avecInfosAutorisations) {
                        var lAvecSaisie = GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoAutorisations);
                        lParams = {
                            avecSaisie: lAvecSaisie,
                            avecSMS: this.donnees.AvecSMS,
                            SMSAutorise: this.donnees.Autorisations.SMSAutorise,
                            SMSAutoriseDisabled: !lAvecSaisie || !this.donnees.Informations.telephonePortable,
                            emailAutorise: this.donnees.Autorisations.emailAutorise,
                            emailAutoriseDisabled: !lAvecSaisie || !this.donnees.Informations.eMail,
                            emailEtablissementAutorise: this.donnees.Autorisations.eMailEtablissementAutorise,
                            emailParentAutorise: this.donnees.Autorisations.eMailParentAutorise,
                            courrierPapierAutorise: this.donnees.Autorisations.courrierPapierAutorise,
                            msgParent: this.donnees.Autorisations.msgParent,
                            msgEleve: this.donnees.Autorisations.msgEleve,
                            estContactVS: this.donnees.Autorisations.estContactVS,
                            listeEleves: this.donnees.Autorisations.listeEleves,
                            estDestinataireInfosGenerales: this.donnees.Autorisations.estDestinataireInfosGenerales,
                            listeAutorisations: this.listeAutorisations,
                            construireAutorisationsSupp: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent]) ? _construireAutorisationsSupp.bind(this) : null,
                            avecSwitch: false
                        };
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PageCompte.Autorisations'), EGenreTypeContenu.Autorisations, lParams));
                    }
                    if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent]) && this.donnees.Autorisations.afficherCommunicationParents) {
                        lParams = {
                            estDestinataireInfosGenerales: this.donnees.Autorisations.estDestinataireInfosGenerales,
                            optionCommunicationActivationdiscussion: this.donnees.Autorisations.optionCommunicationActivationdiscussion,
                            optionCommunicationPublicationMail: this.donnees.Autorisations.optionCommunicationPublicationMail,
                            afficherOptionCommunicationPublicationEmail: this.donnees.Autorisations.afficherOptionCommunicationPublicationEmail,
                            delegueDesClasses: this.donnees.Autorisations.delegueDesClasses,
                            nbClasses: this.donnees.Autorisations.nbClasses,
                            estDelegue: this.donnees.Autorisations.estDelegue,
                            estMembreCA: this.donnees.Autorisations.estMembreCA
                        };
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('infosperso.communicationsParents'), EGenreTypeContenu.CommunicationParents, lParams));
                    }
                    break;
                case TypeFiltreAffichage.notification:
                    if (UtilitairePageDonneesPersonnelles.avecNotifications(this.donnees)) {
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('PreferencesNotifications.titreNotifications'), EGenreTypeContenu.Notifications, {
                            envoiMail: this.donnees.envoiMailActif,
                            notificationMail: this.donnees.notifications.notificationMail,
                            notificationTravaux: this.donnees.notifications.notificationMailTravaux
                        }));
                    }
                    break;
                case TypeFiltreAffichage.droitImage:
                    if (this.donnees.droitImage) {
                        H.push(UtilitairePageDonneesPersonnelles.construireZoneGenerique(GTraductions.getValeur('infosperso.droitImage'), EGenreTypeContenu.DroitImage, {
                            droitImage: !this.donnees.droitImage.autoriser
                        }));
                    }
                    break;
                default:
                    ;
            }
            GHtml.setDisplay(this.idMainPage, false);
            GHtml.setDisplay(this.idIntersticial, true);
            GHtml.setHtml(this.idIntersticial, H.join(''), {
                controleur: this.controleur
            });
            switch (this.selectionFiltreCourante.GetGenre()) {
                case TypeFiltreAffichage.securisation:
                    if (this.donnees.securisation) {
                        this.instanceChoixStratSecurisation.setDonnees(this.donnees.securisation);
                    }
                    if (this.donnees.securisation && this.donnees.securisation.listeSourcesConnexions) {
                        this.instanceSourcesConnexions.setDonnees(this.donnees.securisation);
                    }
                    break;
            }
            var lThis = this;
            $('#' + EListeIds.identifiant.escapeJQ()).on({
                mouseup: function() {
                    _callbackIdentifiant.call(lThis);
                }
            });
            $('#' + EListeIds.mdp.escapeJQ()).on({
                mouseup: function() {
                    _callbackMDP.call(lThis);
                }
            });
        }

        function _construireAutorisationsSupp() {
            var lHtml = [];
            if (this.donnees.Autorisations.listeEleves.GetNbrElements() > 0) {
                lHtml.push('<div class="Gras EspaceHaut" style="clear:both;">', GTraductions.getValeur('infosperso.titreRecevoir'), '</div>');
            }
            return lHtml.join('');
        }

        function _construirePage() {
            var lHtml = [];
            lHtml.push('<div class="PageCompte">');
            lHtml.push('<div id="', this.idIntersticial, '" style="display:none;"></div>');
            lHtml.push('<div id="', this.idMainPage, '" style="display:block;">');
            lHtml.push('<div id="', this.instanceListeFiltre.Nom, '"></div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        }
        ObjetPageCompte.prototype.closeNav = function() {
            GHtml.setDisplay(this.idIntersticial, false);
            GHtml.setDisplay(this.idMainPage, true);
            this.selectionFiltreCourante = null;
        };

        function _callbackMDP() {
            UtilitairePageDonneesPersonnelles.fenetreModificationMDP(this);
        }

        function _callbackIdentifiant() {
            UtilitairePageDonneesPersonnelles.fenetreModificationIdentifiant(this, this.RecupererDonnees.bind(this));
        }

        function _surReponseRequetePageInfosPerso(aDonnees) {
            $.extend(true, this.donnees, aDonnees);
            GHtml.setHtml(this.Nom, _construirePage.bind(this)(), {
                controleur: this.controleur
            });
            var lListe = UtilitairePageDonneesPersonnelles.getListeFiltresAff(this.donnees, this.parametres);
            this.instanceListeFiltre.Initialiser();
            this.instanceListeFiltre.setOptionsListe({
                colonnes: DonneesListe_FiltreCompte.getColonnes()
            }).SetDonnees(new DonneesListe_FiltreCompte(lListe).setOptions({
                avecSelection: false
            }));
        }

        function _envoiRequetePage() {
            return new ObjetRequetePageInfosPerso(this).lancerRequete().then(_surReponseRequetePageInfosPerso.bind(this));
        }
        ObjetPageCompte.prototype.RecupererDonnees = function() {
            _envoiRequetePage.call(this);
        };
        ObjetPageCompte.prototype.getStructurePourValidation = function(aStructure) {
            var lValeur;
            if (GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoCoordonnees)) {
                aStructure.informations = {};
                if (this.donnees.Informations.eMail !== null) {
                    lValeur = this.donnees.Informations.eMail;
                    aStructure.informations.eMail = lValeur;
                }
                aStructure.informations.telephoneFixe = this.donnees.Informations.telephoneFixe;
                aStructure.informations.indicatifFixe = this.donnees.Informations.indicatifFixe;
                aStructure.informations.telephonePortable = this.donnees.Informations.telephonePortable;
                aStructure.informations.indicatifTel = this.donnees.Informations.indicatifTel;
                aStructure.informations.fax = this.donnees.Informations.fax;
                aStructure.informations.indicatifFax = this.donnees.Informations.indicatifFax;
            }
            if (GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoAutorisations)) {
                aStructure.autorisations = {};
                if (this.donnees.Autorisations.SMSAutorise !== null) {
                    aStructure.autorisations.SMSAutorise = this.donnees.Autorisations.SMSAutorise;
                }
                if (this.donnees.Autorisations.emailAutorise !== null) {
                    aStructure.autorisations.emailAutorise = this.donnees.Autorisations.emailAutorise;
                }
                if (this.donnees.Autorisations.eMailEtablissementAutorise !== null) {
                    aStructure.autorisations.eMailEtablissementAutorise = this.donnees.Autorisations.eMailEtablissementAutorise;
                }
                if (this.donnees.Autorisations.eMailParentAutorise !== null) {
                    aStructure.autorisations.eMailParentAutorise = this.donnees.Autorisations.eMailParentAutorise;
                }
                if (this.donnees.Autorisations.courrierPapierAutorise !== null) {
                    aStructure.autorisations.courrierPapierAutorise = this.donnees.Autorisations.courrierPapierAutorise;
                }
                if (this.donnees.Autorisations.msgParent !== null) {
                    aStructure.autorisations.msgParent = this.donnees.Autorisations.msgParent;
                }
                if (this.donnees.Autorisations.msgEleve !== null) {
                    aStructure.autorisations.msgEleve = this.donnees.Autorisations.msgEleve;
                }
                if (this.donnees.Autorisations.estContactVS !== null) {
                    aStructure.autorisations.estContactVS = this.donnees.Autorisations.estContactVS;
                }
                aStructure.autorisations.discussionResponsables = this.donnees.Autorisations.optionCommunicationActivationdiscussion;
                aStructure.autorisations.publicationMail = this.donnees.Autorisations.optionCommunicationPublicationMail;
            }
            if (this.donnees.notifications) {
                aStructure.notifications = {};
                aStructure.notifications.notificationMail = this.donnees.notifications.notificationMail;
                aStructure.notifications.delaiNotification = this.donnees.notifications.delaiNotification;
                aStructure.notifications.notificationMailTravaux = this.donnees.notifications.notificationMailTravaux;
                aStructure.notifications.delaiNotificationTravaux = this.donnees.notifications.delaiNotificationTravaux;
            }
            if (this.donnees.droitImage) {
                aStructure.droitImage = {};
                aStructure.droitImage.avecAutorisation = !this.donnees.droitImage.autoriser;
            }
            if (GApplication.droits.get(TypeDroits.compte.avecSaisieInfosPersoAutorisations)) {
                if (this.donnees.Autorisations.estDestinataireInfosGenerales !== null) {
                    aStructure.autorisations.estDestinataireInfosGenerales = this.donnees.Autorisations.estDestinataireInfosGenerales;
                }
                if (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent) {
                    aStructure.autorisations.listeEleves = [];
                    var i, lEleve, lJSONEleve;
                    for (i = 0; i < this.donnees.Autorisations.listeEleves.GetNbrElements(); i++) {
                        lEleve = this.donnees.Autorisations.listeEleves.GetElement(i);
                        lJSONEleve = lEleve.toJSON();
                        aStructure.autorisations.listeEleves.push(lJSONEleve);
                        lJSONEleve.estDestinataireBulletin = lEleve.estDestinataireBulletin;
                        lJSONEleve.estDestinataireInfosEleve = lEleve.estDestinataireInfosEleve;
                        lJSONEleve.estDestinataireInfosProfesseur = lEleve.estDestinataireInfosProfesseur;
                    }
                }
            }
            return true;
        };
        module.exports = ObjetPageCompte;
    },
    fn: "mobile/script/pagecompte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieInformations() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieInformations', ObjetRequeteSaisieInformations, ObjetRequeteSaisie);
        ObjetRequeteSaisieInformations.prototype.lancerRequete = function(aDonnees) {
            $.extend(this.JSON, aDonnees);
            if (!!aDonnees.dossierMedical) {
                this.JSON.dossierMedical = aDonnees.dossierMedical.toJSONAll();
            }
            return this.appelAsynchrone();
        };
        ObjetRequeteSaisieInformations.prototype.actionApresRequete = function(aXml, aGenreReponse) {
            this.callbackReussite.appel(aXml, aGenreReponse, this.JSONRapportSaisie);
        };
        module.exports = ObjetRequeteSaisieInformations;
    },
    fn: "objetrequetesaisieinformations.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetPageCompte = require('mobile/script/PageCompte.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetRequeteSaisieInformations = require('ObjetRequeteSaisieInformations.js');

        function ObjetAffichagePageCompte_Mobile() {
            this.inheritedCreate(arguments);
        }
        MethodesObjet.heritagePrototype(ObjetAffichagePageCompte_Mobile, ObjetInterfacePage_Mobile);
        ObjetAffichagePageCompte_Mobile.prototype.ConstruireInstances = function() {
            this.identPage = this.Add(ObjetPageCompte, null, null);
        };
        ObjetAffichagePageCompte_Mobile.prototype.Valider = function() {
            var lStructure = {};
            if (this.GetInstance(this.identPage).getStructurePourValidation(lStructure)) {
                this.SetEtatSaisie(false);
                new ObjetRequeteSaisieInformations(this, this.ActionSurValidation).lancerRequete(lStructure);
            }
        };
        module.exports = ObjetAffichagePageCompte_Mobile;
    },
    fn: "mobile/script/interfacepagecompte.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var GStyle = require('GStyle.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GCache = require('Cache.js');
        var ObjetDeserialiser = require('ObjetDeserialiser.js');

        function ObjetRequetePageAgenda() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PageAgenda', ObjetRequetePageAgenda, ObjetRequeteConsultation);
        ObjetRequetePageAgenda.prototype.lancerRequete = function(aNumeroSemaine) {
            this.JSON = {
                NumeroSemaine: aNumeroSemaine,
                AvecListeClasses: GCache && !GCache.agenda.existeDonnee('listeClassesGroupes')
            };
            return this.appelAsynchrone();
        };
        ObjetRequetePageAgenda.prototype.actionApresRequete = function() {
            var lParam = {
                DomaineDePresence: this.JSONReponse.DomaineDePresence,
                ListeClassesGroupes: null,
                parametreExportICal: this.JSONReponse.ParametreExportiCal,
                avecExportICal: this.JSONReponse.AvecExportiCal
            };
            lParam.listeEvenements = new ObjetDeserialiser().getListeEvenements(this.JSONReponse.ListeEvenements);
            lParam.listeDestinatairesNonModif = this.JSONReponse.listeDestinatairesNonModif || new ObjetListeElements();
            lParam.listeFamilles = this.JSONReponse.listeFamilles || new ObjetListeElements();
            lParam.listeFamilles.parcourir(function(aElement) {
                var lLibelleHtml = [];
                lLibelleHtml.push('<span class="AlignementMilieuVertical InlineBlock" style="width: 12px; height: 12px;', GStyle.composeCouleurFond(aElement.couleur), '"></span>');
                lLibelleHtml.push('<span class="AlignementMilieuVertical EspaceGauche">', aElement.Libelle, '</span>');
                aElement.libelleHtml = lLibelleHtml.join('');
            });
            lParam.listeJourDansMois = this.JSONReponse.listeJourDansMois || new ObjetListeElements();
            if (GCache) {
                if (this.JSONReponse.ListeClassesGroupes) {
                    lParam.listeClassesGroupes = new ObjetListeElements().fromJSON(this.JSONReponse.ListeClassesGroupes, _ajouterClassesGroupes.bind(this));
                    GCache.agenda.setDonnee('listeClassesGroupes', lParam.listeClassesGroupes);
                } else if (GCache.agenda.existeDonnee('listeClassesGroupes')) {
                    lParam.listeClassesGroupes = GCache.agenda.getDonnee('listeClassesGroupes');
                }
            }
            this.callbackReussite.appel(lParam);
        };

        function _ajouterClassesGroupes(aJSON, aElement) {
            if (aJSON.niveau) {
                aElement.niveau = aJSON.niveau ? new ObjetElement().fromJSON(aJSON.niveau) : null;
            }
            if (aJSON.EPeda) {
                aElement.equipePedagogique = new ObjetListeElements().fromJSON(aJSON.EPeda);
            }
        }
        module.exports = ObjetRequetePageAgenda;
    },
    fn: "objetrequetepageagenda.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequetePageAgenda = require('ObjetRequetePageAgenda.js');
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var GDate = require('ObjetDate.js').GDate;
        var GTraductions = require('ObjetTraduction.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePageAgenda_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageAgenda_Mobile() {
            this.inheritedCreate(arguments);
            this.listeEvenements = null;
        }
        ObjetAffichagePageAgenda_Mobile.prototype.RecupererDonnees = function() {
            this.ActualiserDonnees();
        };
        ObjetAffichagePageAgenda_Mobile.prototype.ActualiserDonnees = function() {
            new ObjetRequetePageAgenda(this, _surRecupererDonneesAgenda.bind(this)).lancerRequete();
        };

        function _getDateCourante(aListeEvenements) {
            var N = aListeEvenements.GetNbrElements();
            for (var I = 0; I < N; I++) {
                var lEvenement = aListeEvenements.GetElement(I);
                if (GDate.GetJour(new Date()) >= GDate.GetJour(lEvenement.DateDebut)) {
                    return lEvenement.DateDebut;
                }
            }
            if (N > 0) {
                return aListeEvenements.GetElement(N - 1).DateDebut;
            }
        }

        function _surRecupererDonneesAgenda(aParam) {
            var H = [],
                lIdSelection = this.Nom + '_selec';
            this.listeEvenements = aParam.listeEvenements;
            if (!!aParam.listeEvenements) {
                if (aParam.listeEvenements.GetNbrElements() === 0) {
                    H.push(this.composeAucuneDonnee(GTraductions.getValeur('Agenda.AucunEvenementPublie')));
                } else {
                    H.push('<ul class="collection with-header" role="list">');
                    var lDate, lDateCumul;
                    var lDateCourante = _getDateCourante(aParam.listeEvenements);
                    for (var I = 0; I < aParam.listeEvenements.GetNbrElements(); I++) {
                        var lEvenement = aParam.listeEvenements.GetElement(I);
                        lDateCumul = lEvenement.DateDebut;
                        if (!GDate.estJourEgal(lDate, lDateCumul)) {
                            H.push('<li ', (lDateCourante && GDate.estJourEgal(lDateCourante, lDateCumul) ? ' id="' + lIdSelection + '"' : ''), ' class="collection-header">', GDate.FormatDate(lDateCumul, '[' + '%JJJJ %J %MMMM' + ']'), '</li>');
                        }
                        lDate = lDateCumul;
                        H.push('<li class="collection-item" data-numero="' + lEvenement.GetNumero() + '" data-genre="' + lEvenement.GetGenre() + '">');
                        H.push('<div style="padding-left: 5px; border-left: 5px solid ' + lEvenement.CouleurCellule + ';">');
                        if (lEvenement.listeEleves && lEvenement.listeEleves.length > 0) {
                            H.push('<div style="float: right;margin-left: 5px;color: #b3b3b3; max-width: 90px;">' + lEvenement.listeEleves.join(', ') + '</div>');
                        }
                        H.push('<div class="title">', lEvenement.GetLibelle(), '</div>');
                        var lArrayInformationsEvenement = aParam.listeEvenements._getLibelleEvenement({
                            evenement: lEvenement,
                            avecTitre: false,
                            avecDetailConseil: true,
                            avecDateDuJour: false
                        });
                        if (!!lArrayInformationsEvenement) {
                            for (var J = 0; J < lArrayInformationsEvenement.length; J++) {
                                if (lArrayInformationsEvenement[J]) {
                                    H.push('<div>', lArrayInformationsEvenement[J], '</div>');
                                }
                            }
                        }
                        if (!!lEvenement.listeDocJoints && lEvenement.listeDocJoints.GetNbrElements() > 0) {
                            H.push('<div>');
                            lEvenement.listeDocJoints.parcourir(function(aDocumentJoint) {
                                H.push(GChaine.composerUrlLienExterne({
                                    documentJoint: aDocumentJoint,
                                    genreRessource: EGenreRessource.DocJointEtablissement
                                }) + '<br />');
                            });
                            H.push('</div>');
                        }
                        H.push('</li>');
                    }
                    H.push('</ul>');
                }
            }
            GHtml.setHtml(this.Nom, H.join(''));
            var lJQSelection = $('#' + lIdSelection.escapeJQ());
            if (lJQSelection.length === 1) {
                if (document.getElementById(lIdSelection) && document.getElementById(lIdSelection).scrollIntoView) {
                    document.getElementById(lIdSelection).scrollIntoView(true);
                }
            }
            this.doForMobileApp();
        }
        ObjetAffichagePageAgenda_Mobile.prototype.doForMobileApp = function() {};
        module.exports = ObjetAffichagePageAgenda_Mobile;
    },
    fn: "mobile/script/interfacepageagenda.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GChaine = require('GChaine.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var UtilitaireBulletinEtReleve_Mobile = require('UtilitaireBulletinEtReleve_Mobile.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var ObjetElement = require('ObjetElement.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;
        MethodesObjet.heritagePrototype(ObjetDernieresNotes, ObjetIdentite_Mobile);

        function ObjetDernieresNotes() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
            this.triParMatiere = false;
        }
        ObjetDernieresNotes.prototype.SetDonnees = function(aListeDevoirs, aEstTriParMatiere, aAvecDetailService, aAvecDetailDevoir, aMoyenneGenerale) {
            if (aListeDevoirs) {
                this.donneesRecues = true;
                this.listeDevoirs = aListeDevoirs;
                this.avecDetailService = aAvecDetailService;
                this.avecDetailDevoir = aAvecDetailDevoir;
                this.triParMatiere = aEstTriParMatiere;
                this.message = false;
                this.moyenneGenerale = aMoyenneGenerale;
                this.Afficher();
            }
        };
        ObjetDernieresNotes.prototype.SetMessage = function(aMessage) {
            this.message = aMessage;
            this.Afficher();
        };
        ObjetDernieresNotes.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            if (!!this.message) {
                lHtml.push(this.composeAucuneDonnee(this.message));
            } else if (this.donneesRecues) {
                var lService, lNumService, lDevoir, lEstBaremeParDefaut, lNbDevoirs = this.listeDevoirs.GetNbrElements();
                if (!this.triParMatiere) {
                    lHtml.push('<ul class="collection">');
                    for (var i = 0; i < lNbDevoirs; i++) {
                        lDevoir = this.listeDevoirs.GetElement(i);
                        lEstBaremeParDefaut = lDevoir.bareme.getValeur() === lDevoir.baremeParDefaut.getValeur();
                        lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.evenementSurClickDevoir(event, \'', lDevoir.GetNumero(), '\')" style="padding: 3px 12px;">');
                        lHtml.push('<div style="padding: 10px 0px 10px 5px; border-left: 5px solid ' + (!!lDevoir.service.couleur && lDevoir.service.couleur !== "" ? lDevoir.service.couleur : '#D4D4D4') + ';">');
                        lHtml.push('<div class="title" style="margin-right: 45px;">', lDevoir.service.GetLibelle(), '</div>');
                        lHtml.push('<div class="AlignementHaut InlineBlock">', GDate.FormatDate(lDevoir.date, '[' + GTraductions.getValeur('Le') + ' %J %MMMM' + ']'), '&nbsp;', '</div>');
                        if (!!lDevoir.moyenne && lDevoir.moyenne.getNote() !== "") {
                            lHtml.push('<div class="AlignementHaut InlineBlock ">', '(', (lDevoir.estEnGroupe ? GTraductions.getValeur('accueil.moyGroupe') : GTraductions.getValeur('accueil.moyClasse')), '&nbsp;:&nbsp;', lDevoir.moyenne.getNote(), (lEstBaremeParDefaut ? '' : lDevoir.bareme.getBaremeEntier()), ')', '</div>');
                        }
                        lHtml.push('<div class="secondary-content">');
                        lHtml.push('<div class="Gras">', lDevoir.note.getNote(), '</div>', (lEstBaremeParDefaut ? '' : '<div class="right-align">' + lDevoir.bareme.getBaremeEntier() + '</div>'));
                        lHtml.push('</div>');
                        lHtml.push('<div class="EspaceHaut">');
                        var lDocumentJoint, lLien;
                        if (!!lDevoir.libelleCorrige) {
                            lDocumentJoint = new ObjetElement(lDevoir.libelleCorrige, lDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                            lLien = GChaine.composerUrlLienExterne({
                                documentJoint: lDocumentJoint,
                                genreRessource: TypeFichierExterneHttpSco.DevoirCorrige,
                                libelleEcran: GTraductions.getValeur('AfficherCorrige')
                            });
                            lHtml.push('<div class="right" style="padding-left: 10px;">', lLien, '</div>');
                        }
                        if (!!lDevoir.libelleSujet) {
                            lDocumentJoint = new ObjetElement(lDevoir.libelleSujet, lDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                            lLien = GChaine.composerUrlLienExterne({
                                documentJoint: lDocumentJoint,
                                genreRessource: TypeFichierExterneHttpSco.DevoirSujet,
                                libelleEcran: GTraductions.getValeur('AfficherSujet')
                            });
                            lHtml.push('<div class="right">', lLien, '</div>');
                        }
                        lHtml.push('<div class="clear"></div>');
                        lHtml.push('</div>');
                        lHtml.push('</div>');
                        lHtml.push('</li>');
                    }
                    lHtml.push('</ul>');
                } else {
                    var lListeServices = this.getListeServices();
                    var lNbrServices = lListeServices.GetNbrElements();
                    lHtml.push('<ul class="collection with-header">');
                    for (var j = 0; j < lNbrServices; j++) {
                        lService = lListeServices.GetElement(j), lNumService = lService.GetNumero();
                        lHtml.push('<li class="collection-header with-action" onclick="', this.Nom, '.evenementSurClickService(event, \'', lNumService, '\')" style="padding:3px 5px;">');
                        lHtml.push('<div style="padding: 10px 5px; border-left: 5px solid ' + (!!lService.couleur && lService.couleur !== "" ? lService.couleur : '#D4D4D4') + ';">');
                        lHtml.push('<div class="left">', lService.GetLibelle(), '</div>');
                        if (!!lService.moyEleve) {
                            lHtml.push('<div class="right">', lService.moyEleve.getNote(), '</div>');
                        }
                        lHtml.push('<div class="clear"></div>');
                        lHtml.push('</div>');
                        lHtml.push('</li>');
                        for (var k = 0; k < lNbDevoirs; k++) {
                            if (lNumService === this.listeDevoirs.GetElement(k).service.GetNumero()) {
                                lDevoir = this.listeDevoirs.GetElement(k);
                                lEstBaremeParDefaut = lDevoir.bareme.getValeur() === lDevoir.baremeParDefaut.getValeur();
                                lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.evenementSurClickDevoir(event, \'', lDevoir.GetNumero(), '\')">');
                                lHtml.push('<div class="left">');
                                lHtml.push('<div class="AlignementHaut InlineBlock">', GDate.FormatDate(lDevoir.date, '[' + GTraductions.getValeur('Le') + ' %J %MMMM' + ']'), '&nbsp;', '</div>');
                                if (!!lDevoir.moyenne) {
                                    lHtml.push('<div class="AlignementHaut InlineBlock">', '(', (lDevoir.estEnGroupe ? GTraductions.getValeur('accueil.moyGroupe') : GTraductions.getValeur('accueil.moyClasse')), '&nbsp;:&nbsp;', lDevoir.moyenne.getNote(), (lEstBaremeParDefaut ? '' : lDevoir.bareme.getBaremeEntier()), ')', '</div>');
                                }
                                lHtml.push('</div>');
                                lHtml.push('<div class="right">', '<div>', lDevoir.note.getNote(), '</div>', (lEstBaremeParDefaut ? '' : '<div class="right-align">' + lDevoir.bareme.getBaremeEntier() + '</div>'), '</div>');
                                lHtml.push('<div class="clear"></div>');
                                lHtml.push('<div class="EspaceHaut">');
                                if (!!lDevoir.libelleCorrige) {
                                    lDocumentJoint = new ObjetElement(lDevoir.libelleCorrige, lDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                                    lLien = GChaine.composerUrlLienExterne({
                                        documentJoint: lDocumentJoint,
                                        genreRessource: TypeFichierExterneHttpSco.DevoirCorrige,
                                        libelleEcran: GTraductions.getValeur('AfficherCorrige')
                                    });
                                    lHtml.push('<div class="right" style="padding-left: 10px;">', lLien, '</div>');
                                }
                                if (!!lDevoir.libelleSujet) {
                                    lDocumentJoint = new ObjetElement(lDevoir.libelleSujet, lDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                                    lLien = GChaine.composerUrlLienExterne({
                                        documentJoint: lDocumentJoint,
                                        genreRessource: TypeFichierExterneHttpSco.DevoirSujet,
                                        libelleEcran: GTraductions.getValeur('AfficherSujet')
                                    });
                                    lHtml.push('<div class="right">', lLien, '</div>');
                                }
                                lHtml.push('<div class="clear"></div>');
                                lHtml.push('</div>');
                                lHtml.push('</li>');
                            }
                        }
                    }
                    if (!!this.moyenneGenerale) {
                        if (!!this.moyenneGenerale.note && this.moyenneGenerale.note.getNote() !== "") {
                            lHtml.push('<li class="collection-item raised with-action">');
                            lHtml.push('<div class="left title" >' + GTraductions.getValeur('DernieresNotes.Moyenne_generale_eleve') + '</div>');
                            lHtml.push('<div class="right title">' + this.moyenneGenerale.note.getNote() + '</div>');
                            lHtml.push('<div class="clear"></div>');
                            lHtml.push('</li>');
                        }
                        if (!!this.moyenneGenerale.noteClasse && this.moyenneGenerale.noteClasse.getNote() !== "") {
                            lHtml.push('<li class="collection-item raised with-action">');
                            lHtml.push('<div class="left title" >' + GTraductions.getValeur('DernieresNotes.Moyenne_generale_classe') + '</div>');
                            lHtml.push('<div class="right title">' + this.moyenneGenerale.noteClasse.getNote() + '</div>');
                            lHtml.push('<div class="clear"></div>');
                            lHtml.push('</li>');
                        }
                    }
                    lHtml.push('</ul>');
                }
            }
            return lHtml.join('');
        };
        ObjetDernieresNotes.prototype.evenementSurClickService = function(aEvent, aNumeroService) {
            if ($(aEvent.target).parentsUntil(aEvent.currentTarget).addBack().filter('a').length === 0 && this.avecDetailService) {
                var lListeServices = this.getListeServices();
                var lService = lListeServices.GetElementParNumero(aNumeroService);
                GInterface.openPanel(this.composePanelService(lService));
            }
        };
        ObjetDernieresNotes.prototype.evenementSurClickDevoir = function(aEvent, aNumeroDevoir) {
            if ($(aEvent.target).parentsUntil(aEvent.currentTarget).addBack().filter('a').length === 0 && this.avecDetailDevoir) {
                var lDevoir = this.listeDevoirs.GetElementParNumero(aNumeroDevoir);
                GInterface.openPanel(this.composePanelDevoir(lDevoir));
            }
        };
        ObjetDernieresNotes.prototype.surClickProchainElement = function(aNumeroElement, aEstSuivant, aEstDevoir) {
            var lIndiceElementActuel, lIndiceProchainElement, lProchainElement;
            if (!!aEstDevoir) {
                lIndiceElementActuel = this.listeDevoirs.GetIndiceParNumeroEtGenre(aNumeroElement);
                if (!!aEstSuivant) {
                    lIndiceProchainElement = lIndiceElementActuel + 1 < this.listeDevoirs.GetNbrElements() ? lIndiceElementActuel + 1 : 0;
                } else {
                    lIndiceProchainElement = lIndiceElementActuel === 0 ? this.listeDevoirs.GetNbrElements() - 1 : lIndiceElementActuel - 1;
                }
                lProchainElement = this.listeDevoirs.GetElement(lIndiceProchainElement);
                GInterface.updatePanelContent(this.composePanelDevoir(lProchainElement));
            } else {
                if (this.avecDetailService) {
                    var lListeServices = this.getListeServices();
                    lIndiceElementActuel = lListeServices.GetIndiceParNumeroEtGenre(aNumeroElement);
                    if (!!aEstSuivant) {
                        lIndiceProchainElement = lIndiceElementActuel + 1 < lListeServices.GetNbrElements() ? lIndiceElementActuel + 1 : 0;
                    } else {
                        lIndiceProchainElement = lIndiceElementActuel === 0 ? lListeServices.GetNbrElements() - 1 : lIndiceElementActuel - 1;
                    }
                    lProchainElement = lListeServices.GetElement(lIndiceProchainElement);
                    GInterface.updatePanelContent(this.composePanelService(lProchainElement));
                }
            }
        };
        ObjetDernieresNotes.prototype.composePanelService = function(aService) {
            var lHtml = [];
            lHtml.push('<div class="navheader">');
            lHtml.push('<div class="right">');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
            lHtml.push('</div>');
            lHtml.push('<div class="left">');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aService.GetNumero(), '\',', false, ',', false, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aService.GetNumero(), '\',', true, ',', false, ')"><i class="material-icons icon_angle_right"></i></button>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('<div class="subheader">');
            lHtml.push('<div class="left-align InlineBlock AlignementHaut" style="width:84%; ">', aService.GetLibelle(), '</Div>');
            if (!!aService.moyEleve) {
                lHtml.push('<div class="right-align InlineBlock AlignementHaut" style="width:15%;">', aService.moyEleve.getNote(), '</div>');
            }
            lHtml.push('</div>');
            lHtml.push('<div class="Espace">');
            if (!!aService.moyClasse && aService.moyClasse.getNote() !== "") {
                var lLibelleMoyenne = aService.estServiceEnGroupe ? GTraductions.getValeur('DernieresNotes.Moyenne_groupe') : GTraductions.getValeur('DernieresNotes.Moyenne_classe');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(lLibelleMoyenne, aService.moyClasse.getNote()));
            }
            if (!!aService.moyMax && aService.moyMax.getNote() !== "") {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('DernieresNotes.Moyenne_max_service'), aService.moyMax.getNote()));
            }
            if (!!aService.moyMin && aService.moyMin.getNote() !== "") {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('DernieresNotes.Moyenne_min_service'), aService.moyMin.getNote()));
            }
            if (!!aService.nbDevoirs && aService.nbDevoirs !== "") {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('DernieresNotes.Nombre_notes'), aService.nbDevoirs));
            }
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetDernieresNotes.prototype.composePanelDevoir = function(aDevoir) {
            var lHtml = [];
            var lEstBaremeParDefaut = aDevoir.bareme.getValeur() === aDevoir.baremeParDefaut.getValeur();
            lHtml.push('<div class="navheader">');
            lHtml.push('<div class="right">');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
            lHtml.push('</div>');
            lHtml.push('<div class="left">');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aDevoir.GetNumero(), '\',', false, ',', true, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aDevoir.GetNumero(), '\',', true, ',', true, ')"><i class="material-icons icon_angle_right"></i></button>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('<div class="subheader">' + aDevoir.service.GetLibelle() + ' - ' + GTraductions.getValeur('DernieresNotes.Note_du', [GDate.FormatDate(aDevoir.date, '%JJ/%MM')]) + '</div>');
            if (!!aDevoir.commentaire) {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                    intituleDAppreciation: GTraductions.getValeur('Commentaire'),
                    contenuDAppreciation: aDevoir.commentaire,
                    styleBlockIntitule: 'color : #616161;',
                    styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                }));
            }
            lHtml.push('<div class="Espace">');
            if (!!aDevoir.note && aDevoir.note.getNote() !== "") {
                var lNoteEleve = '<span class="Gras InlineBlock" >' + aDevoir.note.getNote() + '</span>' + (lEstBaremeParDefaut ? '' : '<span class="InlineBlock small">' + aDevoir.bareme.getBaremeEntier() + '</span>');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('DernieresNotes.Note_eleve'), lNoteEleve));
            }
            if (!!aDevoir.moyenne && aDevoir.moyenne.getNote() !== "") {
                var lLibelleMoyenne = aDevoir.estEnGroupe ? GTraductions.getValeur('DernieresNotes.Moyenne_groupe') : GTraductions.getValeur('DernieresNotes.Moyenne_classe');
                var lMoyClasse = '<span class="Gras InlineBlock" >' + aDevoir.moyenne.getNote() + '</span>' + (lEstBaremeParDefaut ? '' : '<span class="InlineBlock small">' + aDevoir.bareme.getBaremeEntier() + '</span>');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(lLibelleMoyenne, lMoyClasse));
            }
            if (!!aDevoir.noteMax && aDevoir.noteMax.getNote() !== "") {
                var lMoySup = '<span class="Gras InlineBlock" >' + aDevoir.noteMax.getNote() + '</span>' + (lEstBaremeParDefaut ? '' : '<span class="InlineBlock small">' + aDevoir.bareme.getBaremeEntier() + '</span>');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('DernieresNotes.Note_max_devoir'), lMoySup));
            }
            if (!!aDevoir.noteMin && aDevoir.noteMin.getNote() !== "") {
                var noteMin = '<span class="Gras InlineBlock" >' + aDevoir.noteMin.getNote() + '</span>' + (lEstBaremeParDefaut ? '' : '<span class="InlineBlock small">' + aDevoir.bareme.getBaremeEntier() + '</span>');
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('DernieresNotes.Note_min_devoir'), noteMin));
            }
            if (aDevoir.coefficient !== undefined) {
                lHtml.push(UtilitaireBulletinEtReleve_Mobile.composePetitBlocDonnees(GTraductions.getValeur('BulletinEtReleve.Coeff'), aDevoir.coefficient));
            }
            lHtml.push('</div>');
            lHtml.push('<div>');
            var lDocumentJoint, lLien;
            if (aDevoir.libelleCorrige) {
                lDocumentJoint = new ObjetElement(aDevoir.libelleCorrige, aDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                lLien = GChaine.composerUrlLienExterne({
                    documentJoint: lDocumentJoint,
                    genreRessource: TypeFichierExterneHttpSco.DevoirCorrige,
                    libelleEcran: GTraductions.getValeur('AfficherCorrige')
                });
                lHtml.push('<div class="right">', lLien, '</div>');
            }
            if (aDevoir.libelleSujet) {
                lDocumentJoint = new ObjetElement(aDevoir.libelleSujet, aDevoir.GetNumero(), EGenreDocumentJoint.Fichier);
                lLien = GChaine.composerUrlLienExterne({
                    documentJoint: lDocumentJoint,
                    genreRessource: TypeFichierExterneHttpSco.DevoirSujet,
                    libelleEcran: GTraductions.getValeur('AfficherSujet')
                });
                lHtml.push('<div class="right">', lLien, '</div>');
            }
            lHtml.push('<div class="clear"></div>');
            lHtml.push('</div>');
            if (!!aDevoir.execKiosque) {
                lHtml.push('<div>', GChaine.composerUrlLienExterne({
                    documentJoint: aDevoir.execKiosque,
                    title: GTraductions.getValeur('AfficherCopieEleve'),
                    libelleEcran: GTraductions.getValeur('AfficherCopieEleve')
                }), '</div>');
            }
            return lHtml.join('');
        };
        ObjetDernieresNotes.prototype.getListeServices = function() {
            var lListeServices = new ObjetListeElements();
            this.listeDevoirs.parcourir(function(D) {
                var lServiceDeLaListeDevoirs = lListeServices.GetElementParNumero(D.service.GetNumero());
                if (!lServiceDeLaListeDevoirs) {
                    lServiceDeLaListeDevoirs = D.service;
                    lServiceDeLaListeDevoirs.nbDevoirs = 0;
                    lListeServices.AddElement(D.service);
                }
                lServiceDeLaListeDevoirs.nbDevoirs++;
            });
            return lListeServices;
        };
        module.exports = ObjetDernieresNotes;
    },
    fn: "pagedernieresnotes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;

        function ObjetRequeteDernieresNotes() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('DernieresNotes', ObjetRequeteDernieresNotes, ObjetRequeteConsultation);
        ObjetRequeteDernieresNotes.prototype.lancerRequete = function(aParams) {
            this.JSON.Periode = aParams.periode;
            return this.appelAsynchrone();
        };
        ObjetRequeteDernieresNotes.prototype.actionApresRequete = function() {
            if (!!this.JSONReponse.listeDevoirs) {
                this.JSONReponse.listeDevoirs.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant)]);
                this.JSONReponse.listeDevoirs.trier();
                if (!!this.JSONReponse.listeServices) {
                    var lListeServices = this.JSONReponse.listeServices;
                    this.JSONReponse.listeDevoirs.parcourir(function(D) {
                        if (!!D.service) {
                            D.service = lListeServices.GetElementParNumero(D.service.GetNumero());
                        }
                    });
                }
            }
            var lJSONResult = {
                listeDevoirs: this.JSONReponse.listeDevoirs
            };
            if (!!this.JSONReponse.moyGenerale && !this.JSONReponse.moyGenerale.estVide() && !!this.JSONReponse.moyGeneraleClasse && !this.JSONReponse.moyGeneraleClasse.estVide()) {
                lJSONResult.moyenneGenerale = {
                    note: this.JSONReponse.moyGenerale,
                    noteClasse: this.JSONReponse.moyGeneraleClasse,
                    bareme: this.JSONReponse.baremeMoyGenerale,
                    baremeParDefaut: this.JSONReponse.baremeMoyGeneraleParDefaut
                };
            }
            lJSONResult.avecDetailDevoir = this.JSONReponse.avecDetailDevoir;
            lJSONResult.avecDetailService = this.JSONReponse.avecDetailService;
            this.callbackReussite.appel(lJSONResult);
        };
        module.exports = ObjetRequeteDernieresNotes;
    },
    fn: "objetrequetedernieresnotes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetDernieresNotes = require('PageDernieresNotes.js');
        var MethodesObjet = require('MethodesObjet.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var ObjetTabs = require('ObjetTabs.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreMessage = require('Enumere_Message.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetRequeteDernieresNotes = require('ObjetRequeteDernieresNotes.js');
        MethodesObjet.heritagePrototype(ObjetAffichageDernieresNotes_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichageDernieresNotes_Mobile() {
            this.inheritedCreate(arguments);
            this.listePeriodes = new ObjetListeElements();
            this.periodeCourant = new ObjetElement();
            this.indiceParDefaut = 0;
            this.listeTabs = new ObjetListeElements();
        }
        ObjetAffichageDernieresNotes_Mobile.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, this.surSelectionPeriode);
            this.identTabs = this.Add(ObjetTabs, null, _initialiserObjetTabs);
            this.ObjetDernieresNotesParDate = this.Add(ObjetDernieresNotes);
            var lElementDate = new ObjetElement(GTraductions.getValeur('Date'), null, EGenreRessource.Date, null, false);
            lElementDate.idDiv = this.GetInstance(this.ObjetDernieresNotesParDate).GetNom();
            this.listeTabs.AddElement(lElementDate);
            this.ObjetDernieresNotesParMatiere = this.Add(ObjetDernieresNotes);
            var lElementMatiere = new ObjetElement(GTraductions.getValeur('Matiere'), null, EGenreRessource.Matiere, null, false);
            lElementMatiere.idDiv = this.GetInstance(this.ObjetDernieresNotesParMatiere).GetNom();
            this.listeTabs.AddElement(lElementMatiere);
            this.AddSurZone = [this.identSelection, this.identTabs];
        };
        ObjetAffichageDernieresNotes_Mobile.prototype.RecupererDonnees = function() {
            var lOngletInfosPeriodes = GEtatUtilisateur.getOngletInfosPeriodes();
            this.listePeriodes = lOngletInfosPeriodes.listePeriodes;
            if (!(this.listePeriodes && this.listePeriodes.GetNbrElements())) {
                return '';
            } else {
                var lNrPeriodeParDefaut = GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().periode ? GEtatUtilisateur.getPage().periode.GetNumero() : lOngletInfosPeriodes.periodeParDefaut.GetNumero();
                this.indiceParDefaut = this.listePeriodes.GetIndiceParNumeroEtGenre(lNrPeriodeParDefaut);
                if (!this.indiceParDefaut) {
                    this.indiceParDefaut = 0;
                }
                this.periodeCourant = this.listePeriodes.GetElement(this.indiceParDefaut);
                this.GetInstance(this.identSelection).SetDonnees(this.listePeriodes, this.indiceParDefaut);
            }
        };
        ObjetAffichageDernieresNotes_Mobile.prototype.ActionSurRecupererNotes = function(aListe) {
            if (!aListe.listeDevoirs.GetNbrElements()) {
                this.listeTabs.GetElementParGenre(EGenreRessource.Matiere).Actif = true;
                this.listeTabs.GetElementParGenre(EGenreRessource.Date).Actif = true;
                var LMessage = typeof(EGenreMessage.PasDeNotes) === 'number' ? GTraductions.getValeur('Message')[EGenreMessage.PasDeNotes] : EGenreMessage.PasDeNotes;
                this.GetInstance(this.ObjetDernieresNotesParDate).SetMessage(LMessage);
                this.GetInstance(this.ObjetDernieresNotesParMatiere).SetMessage(LMessage);
                this.GetInstance(this.identTabs).setDonnees(this.listeTabs);
                $('.tabs').css('display', 'none');
            } else {
                this.listeNotesParDate = aListe.listeDevoirs;
                this.listeNotesParDate.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant), ObjetTri.init('service.Libelle')]);
                this.listeNotesParDate.trier();
                this.listeNotesParMatiere = MethodesObjet.dupliquer(aListe.listeDevoirs);
                this.listeNotesParMatiere.setTri([ObjetTri.init('service.ordre')]);
                this.listeNotesParMatiere.trier();
                this.listeTabs.GetElementParGenre(EGenreRessource.Matiere).Actif = true;
                this.listeTabs.GetElementParGenre(EGenreRessource.Date).Actif = true;
                this.GetInstance(this.ObjetDernieresNotesParMatiere).SetDonnees(this.listeNotesParMatiere, true, aListe.avecDetailService, aListe.avecDetailDevoir, aListe.moyenneGenerale);
                this.GetInstance(this.ObjetDernieresNotesParDate).SetDonnees(this.listeNotesParDate, false, null, aListe.avecDetailDevoir, aListe.moyenneGenerale);
                this.GetInstance(this.identTabs).setDonnees(this.listeTabs);
            }
        };
        ObjetAffichageDernieresNotes_Mobile.prototype.RecupererDernieresNotes = function() {
            new ObjetRequeteDernieresNotes(this, this.ActionSurRecupererNotes).lancerRequete({
                periode: this.periodeCourant
            });
        };

        function _initialiserObjetTabs(aInstance) {
            aInstance.SetParametres({
                avecSwipe: false
            });
        }
        ObjetAffichageDernieresNotes_Mobile.prototype.surSelectionPeriode = function(aGenreEvenement, aParam) {
            this.periodeCourant = aParam.element;
            this.positionPeriodeCourant = this.listePeriodes.GetIndiceParElement(this.periodeCourant);
            this.RecupererDernieresNotes();
        };
        module.exports = ObjetAffichageDernieresNotes_Mobile;
    },
    fn: "mobile/script/interfacepagedernieresnotes.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var GChaine = require('GChaine.js');
        var ObjetElement = require('ObjetElement.js');
        var TypeFichierExterneHttpSco = require('TypeFichierExterneHttpSco.js').TypeFichierExterneHttpSco;

        function ObjetDernieresEvaluations() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
        }
        MethodesObjet.heritagePrototype(ObjetDernieresEvaluations, ObjetIdentite_Mobile);
        ObjetDernieresEvaluations.prototype.SetDonnees = function(aListeEvaluations, aEstAffichageParDate) {
            if (!!aListeEvaluations) {
                this.donneesRecues = true;
                this.listeEvaluations = aListeEvaluations;
                this.estAffichageParDate = aEstAffichageParDate;
                this.message = false;
                this.Afficher();
            }
        };
        ObjetDernieresEvaluations.prototype.SetMessage = function(aMessage) {
            this.message = aMessage;
            this.Afficher();
        };
        ObjetDernieresEvaluations.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            if (!!this.message) {
                lHtml.push(this.composeAucuneDonnee(this.message));
            } else if (this.donneesRecues) {
                lHtml.push(this.composeListeEvaluations());
            }
            return lHtml.join('');
        };
        ObjetDernieresEvaluations.prototype.composeListeEvaluations = function() {
            var lHtml = [];
            var i, lEvaluation, lNumeroServiceConcerne;
            var lNbrEvaluations = this.listeEvaluations.GetNbrElements();
            if (this.estAffichageParDate) {
                lHtml.push('<ul class="collection">');
                for (i = 0; i < lNbrEvaluations; i++) {
                    lEvaluation = this.listeEvaluations.GetElement(i);
                    lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.evenementSurClickEvaluation(\'', lEvaluation.GetNumero(), '\')" style="padding:3px 12px;">');
                    lHtml.push(this.composeEvaluation(lEvaluation, this.estAffichageParDate));
                    lHtml.push('</li>');
                }
                lHtml.push('</ul>');
            } else {
                lHtml.push('<ul class="collection with-header">');
                lEvaluation = this.listeEvaluations.GetElement(0);
                lNumeroServiceConcerne = lEvaluation.matiere.serviceConcerne.GetNumero();
                lHtml.push('<li class="collection-header" style="padding:3px 5px;"> <div style="padding: 10px 5px; border-left: 5px solid ' + (!!lEvaluation.matiere.couleur && lEvaluation.matiere.couleur !== "" ? lEvaluation.matiere.couleur : 'D4D4D4') + ';">' + lEvaluation.matiere.GetLibelle() + '</div></li>');
                lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.evenementSurClickEvaluation(\'', lEvaluation.GetNumero(), '\')" style="padding:3px 12px;">');
                lHtml.push(this.composeEvaluation(lEvaluation, this.estAffichageParDate));
                lHtml.push('</li>');
                for (i = 1; i < lNbrEvaluations; i++) {
                    lEvaluation = this.listeEvaluations.GetElement(i);
                    if (lNumeroServiceConcerne !== lEvaluation.matiere.serviceConcerne.GetNumero()) {
                        lHtml.push('<li class="collection-header" style="padding:3px 5px;"><div style="padding: 10px 5px; border-left: 5px solid ' + (!!lEvaluation.matiere.couleur && lEvaluation.matiere.couleur !== "" ? lEvaluation.matiere.couleur : 'D4D4D4') + ';">' + lEvaluation.matiere.GetLibelle() + '</div></li>');
                        lNumeroServiceConcerne = lEvaluation.matiere.serviceConcerne.GetNumero();
                    }
                    lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.evenementSurClickEvaluation(\'', lEvaluation.GetNumero(), '\')" style="padding:3px 12px;">');
                    lHtml.push(this.composeEvaluation(lEvaluation, this.estAffichageParDate));
                    lHtml.push('</li>');
                }
            }
            return lHtml.join('');
        };
        ObjetDernieresEvaluations.prototype.composeEvaluation = function(aEvaluation, aTriParDate) {
            var lHtml = [];
            var lNiveauDAcquisition;
            var lNbrNiveauxDAcquisitions = aEvaluation.listeNiveauxDAcquisitions.GetNbrElements();
            lHtml.push('<div style="padding: 10px 5px; border-left: 5px solid ' + (!!aEvaluation.matiere.couleur && aEvaluation.matiere.couleur !== "" && !!aTriParDate ? aEvaluation.matiere.couleur : 'D4D4D4') + ';">');
            lHtml.push('<div class="InlineBlock AlignementHaut" style="' + (!!aTriParDate ? 'width:64%;' : 'width:50%;') + '">');
            if (!!aTriParDate) {
                lHtml.push('<div class="Gras">', aEvaluation.matiere.GetLibelle(), '</div>');
            }
            lHtml.push('<div>', GDate.FormatDate(aEvaluation.date, '[' + GTraductions.getValeur('Le') + ' ' + ' %J %MMMM' + ']'), '</div>');
            lHtml.push('</div>');
            if (lNbrNiveauxDAcquisitions !== 0) {
                lHtml.push('<div class="InlineBlock AlignementHaut AlignementDroit" style="' + (!!aTriParDate ? 'width:35%;' : 'width:50%;') + '">');
                for (var i = 0; i < lNbrNiveauxDAcquisitions; i++) {
                    lNiveauDAcquisition = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(aEvaluation.listeNiveauxDAcquisitions.GetElement(i).GetGenre());
                    lHtml.push('<div class="InlineBlock" style="padding: 0rem 0.2rem;">', EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition), '</div>');
                }
                lHtml.push('</div>');
            }
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetDernieresEvaluations.prototype.evenementSurClickEvaluation = function(aNumero) {
            var lEvaluation = this.listeEvaluations.GetElementParNumero(aNumero);
            GInterface.openPanel(this.composePanelEvaluation(lEvaluation));
        };

        function _getLibelleNiveauDAcquisition(aNiveau) {
            var result = '';
            if (!!aNiveau.sousItem) {
                result = aNiveau.sousItem.GetLibelle();
            } else if (!!aNiveau.item) {
                result = aNiveau.item.GetLibelle();
            } else {
                result = aNiveau.domaine.GetLibelle();
            }
            return result;
        }
        ObjetDernieresEvaluations.prototype.composePanelEvaluation = function(aEvaluation) {
            var lHtml = [];
            lHtml.push('<div class="navheader">');
            lHtml.push('<div class="right">');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
            lHtml.push('</div>');
            lHtml.push('<div class="left">');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aEvaluation.GetNumero(), '\',', false, ')"><i class="material-icons icon_angle_left"></i></button>');
            lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', aEvaluation.GetNumero(), '\',', true, ')"><i class="material-icons icon_angle_right"></i></button>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('<div class="subheader"><div>' + aEvaluation.matiere.GetLibelle() + ' - ' + GTraductions.getValeur('evaluations.EvaluationDuDate', [GDate.FormatDate(aEvaluation.date, '%JJ/%MM')]) + '</div>');
            lHtml.push('</div>');
            lHtml.push('<div class="Gras Espace">');
            lHtml.push('<div class="InlineBlock" style="width: calc(100% - 60px);">' + aEvaluation.GetLibelle() + '</div>');
            lHtml.push('<div class="InlineBlock">' + GTraductions.getValeur('evaluations.CoefficientAbrege') + ' : ' + aEvaluation.coefficient + '</div>');
            lHtml.push('</div>');
            if (aEvaluation.descriptif !== "") {
                lHtml.push('<div style="margin: 0px 10px 10px 10px;">', '<div>', GTraductions.getValeur('Commentaire'), '</div>', '<div class="Espace" style="border: 1px solid #616161; background-color: #f1f1f1;">', aEvaluation.descriptif, '</div>', '</div>');
            }
            if (!!aEvaluation.listeNiveauxDAcquisitions && !!aEvaluation.listeNiveauxDAcquisitions.GetNbrElements()) {
                var listeNiveauxDAcquisitions = aEvaluation.listeNiveauxDAcquisitions,
                    lNbNiveauxAcquisition = listeNiveauxDAcquisitions.GetNbrElements(),
                    lNiveauDAcquisition;
                lHtml.push('<ul class="collection" style="overflow-y: auto;">');
                for (var j = 0; j < lNbNiveauxAcquisition; j++) {
                    lNiveauDAcquisition = listeNiveauxDAcquisitions.GetElement(j);
                    lHtml.push('<li class="collection-item">');
                    lHtml.push('<div class="InlineBlock" style="width:22px; vertical-align: top;">' + EGenreNiveauDAcquisition.getImage(GParametres.listeNiveauxDAcquisitions.GetElementParGenre(lNiveauDAcquisition.GetGenre())) + '</div>');
                    var lLibelleNiveauDAcquisition = _getLibelleNiveauDAcquisition(lNiveauDAcquisition);
                    lHtml.push('<div class="InlineBlock" style="width:calc(100% - 29px); margin-left:7px; vertical-align: top; line-height: 15px; text-align: left; padding-top:2px;">' + lLibelleNiveauDAcquisition + '</div>');
                    if (!!lNiveauDAcquisition.observation) {
                        lHtml.push('<div style="font-style:italic;">', lNiveauDAcquisition.observation, '</div>');
                    }
                    lHtml.push('<div style="text-align: right;">');
                    var lPilierStrPrefixes = (!!lNiveauDAcquisition.pilier && lNiveauDAcquisition.pilier.strPrefixes) ? lNiveauDAcquisition.pilier.strPrefixes : "";
                    lHtml.push('<span style="padding-right: 15px;">' + lPilierStrPrefixes + '</span>');
                    lHtml.push('</div>');
                    lHtml.push('</li>');
                }
                lHtml.push('</ul>');
            }
            if (!!aEvaluation.libelleSujet || !!aEvaluation.libelleCorrige) {
                lHtml.push('<div class="GrandEspaceHaut">');
                var lDocumentJoint, lLien;
                if (!!aEvaluation.libelleCorrige) {
                    lDocumentJoint = new ObjetElement(aEvaluation.libelleCorrige, aEvaluation.GetNumero(), EGenreDocumentJoint.Fichier);
                    lLien = GChaine.composerUrlLienExterne({
                        documentJoint: lDocumentJoint,
                        genreRessource: TypeFichierExterneHttpSco.EvaluationCorrige,
                        libelleEcran: GTraductions.getValeur('AfficherCorrige')
                    });
                    lHtml.push('<div class="right">', lLien, '</div>');
                }
                if (!!aEvaluation.libelleSujet) {
                    lDocumentJoint = new ObjetElement(aEvaluation.libelleSujet, aEvaluation.GetNumero(), EGenreDocumentJoint.Fichier);
                    lLien = GChaine.composerUrlLienExterne({
                        documentJoint: lDocumentJoint,
                        genreRessource: TypeFichierExterneHttpSco.EvaluationSujet,
                        libelleEcran: GTraductions.getValeur('AfficherSujet')
                    });
                    lHtml.push('<div class="right">', lLien, '</div>');
                }
                lHtml.push('<div class="clear"></div>');
                lHtml.push('</div>');
            }
            return lHtml.join('');
        };
        ObjetDernieresEvaluations.prototype.surClickProchainElement = function(aNumeroElement, aEstSuivant) {
            var lIndiceElementActuel, lIndiceProchainElement, lProchainElement;
            lIndiceElementActuel = this.listeEvaluations.GetIndiceParNumeroEtGenre(aNumeroElement);
            if (!!aEstSuivant) {
                lIndiceProchainElement = lIndiceElementActuel + 1 < this.listeEvaluations.GetNbrElements() ? lIndiceElementActuel + 1 : 0;
            } else {
                lIndiceProchainElement = lIndiceElementActuel === 0 ? this.listeEvaluations.GetNbrElements() - 1 : lIndiceElementActuel - 1;
            }
            lProchainElement = this.listeEvaluations.GetElement(lIndiceProchainElement);
            GInterface.updatePanelContent(this.composePanelEvaluation(lProchainElement));
        };
        module.exports = ObjetDernieresEvaluations;
    },
    fn: "mobile/script/pagedernieresevaluations.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;

        function ObjetRequeteDernieresEvaluations() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('DernieresEvaluations', ObjetRequeteDernieresEvaluations, ObjetRequeteConsultation);
        ObjetRequeteDernieresEvaluations.prototype.lancerRequete = function(aParametres) {
            $.extend(this.JSON, aParametres);
            return this.appelAsynchrone();
        };
        ObjetRequeteDernieresEvaluations.prototype.actionApresRequete = function() {
            if (!!this.JSONReponse.listeEvaluations) {
                this.JSONReponse.listeEvaluations.parcourir(function(D) {
                    if (!!D.listeNiveauxDAcquisitions) {
                        D.listeNiveauxDAcquisitions.setTri([ObjetTri.init('ordre')]);
                        D.listeNiveauxDAcquisitions.trier();
                    }
                });
            }
            this.callbackReussite.appel(this.JSONReponse.listeEvaluations);
        };
        module.exports = ObjetRequeteDernieresEvaluations;
    },
    fn: "objetrequetedernieresevaluations.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreRessource = require('Enumere_Ressource.js');
        var TypeGenreValidationCompetence = {
            tGVC_EvaluationEtItem: 0,
            tGVC_Competence: 1
        };
        module.exports.TypeGenreValidationCompetence = TypeGenreValidationCompetence;
        TypeGenreValidationCompetence.getGenreDeCompetence = function(aCompetence) {
            if (!aCompetence) {
                return this.tGVC_EvaluationEtItem;
            }
            switch (aCompetence.GetGenre()) {
                case EGenreRessource.Pilier:
                    return this.tGVC_Competence;
                case EGenreRessource.ElementPilier:
                case EGenreRessource.Competence:
                case EGenreRessource.SousItem:
                case EGenreRessource.Evaluation:
                    return this.tGVC_EvaluationEtItem;
            }
            return this.tGVC_EvaluationEtItem;
        };
    },
    fn: "typegenrevalidationcompetence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypePositionnement = {
            POS_Moyenne: 0,
            POS_Echelle: 1,
            POS_ObjApprentissage: 2
        };
        module.exports.TypePositionnement = TypePositionnement;
    },
    fn: "typepositionnement.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GUID = require('GUID.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        var TypeGenreValidationCompetence = require('TypeGenreValidationCompetence.js').TypeGenreValidationCompetence;
        var TypePositionnement = require('TypePositionnement.js').TypePositionnement;
        var FenetrePopUp_Mobile = require('FenetrePopUp_Mobile.js');
        var UtilitaireCompetences_Mobile = {
            id: GUID.getId()
        };
        UtilitaireCompetences_Mobile.openPopupDetailLegende = function(avecNiveauxPositionnements) {
            var lHtml = [],
                lNiveauDAcquisition, lLibelleNiveau, lImageNiveau, lNbrNiveauDAqcuisition = GParametres.listeNiveauxDAcquisitions.GetNbrElements();
            if (!!lNbrNiveauDAqcuisition) {
                lHtml.push('<div style="padding: 1rem;">');
                lHtml.push('<div>', GTraductions.getValeur('competences.niveauDeMaitrise'), '</div>');
                for (var i = 1; i < lNbrNiveauDAqcuisition; i++) {
                    if (GParametres.listeNiveauxDAcquisitions.GetElement(i).existeNumero() && GParametres.listeNiveauxDAcquisitions.GetElement(i).actifPour.contains(TypeGenreValidationCompetence.tGVC_EvaluationEtItem)) {
                        lNiveauDAcquisition = GParametres.listeNiveauxDAcquisitions.GetElement(i);
                        lLibelleNiveau = lNiveauDAcquisition.GetLibelle();
                        lImageNiveau = EGenreNiveauDAcquisition.getImage(lNiveauDAcquisition);
                        lHtml.push('<div style="padding-left: 1rem; padding-top: 0.5rem;">', '<span style="display: inline-block; width: 2rem; text-align: center;">', lImageNiveau, '</span>', '<span style="padding-left:', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? '2rem;' : '1.2rem;'), '">', lLibelleNiveau, '</span>', '</div>');
                    }
                }
                if (!!avecNiveauxPositionnements) {
                    lHtml.push('<div style="padding-top : 2rem;">', GTraductions.getValeur('competences.PositionnementLSU'), '</div>');
                    for (var j = 1; j < lNbrNiveauDAqcuisition; j++) {
                        lNiveauDAcquisition = GParametres.listeNiveauxDAcquisitions.GetElement(j);
                        if (lNiveauDAcquisition.existeNumero() && lNiveauDAcquisition.actifPour.contains(TypeGenreValidationCompetence.tGVC_Competence)) {
                            lLibelleNiveau = EGenreNiveauDAcquisition.getLibellePositionnement({
                                niveauDAcquisition: lNiveauDAcquisition,
                                genrePositionnement: TypePositionnement.POS_Echelle
                            });
                            lImageNiveau = EGenreNiveauDAcquisition.getImagePositionnement({
                                niveauDAcquisition: lNiveauDAcquisition,
                                genrePositionnement: TypePositionnement.POS_Echelle
                            });
                            lHtml.push('<div style="padding-left: 1rem; padding-top: 0.5rem;">', '<span style="display: inline-block; width: 2rem; text-align: center;">', lImageNiveau, '</span>', '<span style="padding-left:', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? '2rem;' : '1.2rem;'), '">', lLibelleNiveau, '</span>', '</div>');
                        }
                    }
                }
                lHtml.push('</div>');
            }
            var lModale = new FenetrePopUp_Mobile();
            lModale.openPopup({
                titre: '<h1>' + GTraductions.getValeur('competences.Legende') + '</h1>',
                contenu: lHtml.join('')
            });
        };
        module.exports = UtilitaireCompetences_Mobile;
    },
    fn: "utilitairecompetences_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetDernieresEvaluations = require('mobile/script/PageDernieresEvaluations.js');
        var MethodesObjet = require('MethodesObjet.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var ObjetTabs = require('ObjetTabs.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var ObjetRequeteDernieresEvaluations = require('ObjetRequeteDernieresEvaluations.js');
        var UtilitaireCompetences_Mobile = require('UtilitaireCompetences_Mobile.js');
        var ObjetBoutonFlottant = require('ObjetBoutonFlottant.js');
        MethodesObjet.heritagePrototype(ObjetAffichageDernieresEvaluations_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichageDernieresEvaluations_Mobile() {
            this.inheritedCreate(arguments);
            this.listePeriodes = new ObjetListeElements();
            this.periodeCourant = new ObjetElement();
            this.indiceParDefaut = 0;
            this.listeTabs = new ObjetListeElements();
            this.listeEvaluationsParDate = new ObjetListeElements();
            this.idWrapper = this.Nom + '_wrapper';
        }
        ObjetAffichageDernieresEvaluations_Mobile.prototype.getControleur = function(aInstance) {
            return {
                getIdentiteBouton: function() {
                    return {
                        class: ObjetBoutonFlottant,
                        pere: this,
                        init: function(aBtn) {
                            aInstance.btnFlottant = aBtn;
                            var lParam = {
                                listeBoutons: [{
                                    icone: 'icon_diffuser_information large',
                                    callback: aInstance.surClicLegende.bind(this, false)
                                }]
                            };
                            aBtn.setOptionsBouton(lParam);
                        }
                    };
                },
                nodePdf: function() {
                    $(this.node).on('click', function() {});
                }
            };
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.SetParametresGeneraux = function() {
            this.inherited('SetParametresGeneraux');
            this.GenreStructure = EStructureAffichage.Autre;
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, this.surSelectionPeriode);
            this.identTabs = this.Add(ObjetTabs, null, _initialiserObjetTabs);
            this.ObjetDernieresEvaluationsParDate = this.Add(ObjetDernieresEvaluations);
            var lElementParDate = new ObjetElement(GTraductions.getValeur('Date'));
            lElementParDate.idDiv = this.GetInstance(this.ObjetDernieresEvaluationsParDate).GetNom();
            this.listeTabs.AddElement(lElementParDate);
            this.ObjetDernieresEvaluationsParMatiere = this.Add(ObjetDernieresEvaluations);
            var lElementParMatiere = new ObjetElement(GTraductions.getValeur('Matiere'));
            lElementParMatiere.idDiv = this.GetInstance(this.ObjetDernieresEvaluationsParMatiere).GetNom();
            this.listeTabs.AddElement(lElementParMatiere);
            this.AddSurZone = [this.identSelection, this.identTabs];
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.ConstruireStructureAffichageAutre = function() {
            var lHtml = [];
            lHtml.push('<div id="' + this.idWrapper + '" class="has-float-btn-bottom" >', '<div id="', this.GetInstance(this.ObjetDernieresEvaluationsParDate).GetNom(), '"></div>', '<div id="', this.GetInstance(this.ObjetDernieresEvaluationsParMatiere).GetNom(), '"></div>', '</div>');
            if (!this.btnFlottant) {
                $("#" + GInterface.idZonePrincipale).IEHtmlAppend('<div class="is-sticky" ie-identite="getIdentiteBouton" ></div>', {
                    controleur: this.controleur,
                    avecCommentaireConstructeur: false
                });
            }
            return lHtml.join('');
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.surClicLegende = function(avecNiveauxPositionnements) {
            UtilitaireCompetences_Mobile.openPopupDetailLegende(avecNiveauxPositionnements);
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.RecupererDonnees = function() {
            var lOngletInfosPeriodes = GEtatUtilisateur.getOngletInfosPeriodes();
            this.listePeriodes = lOngletInfosPeriodes.listePeriodes;
            var lNrPeriodeParDefaut = GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().periode ? GEtatUtilisateur.getPage().periode.GetNumero() : lOngletInfosPeriodes.periodeParDefaut.GetNumero();
            this.indiceParDefaut = this.listePeriodes.GetIndiceParNumeroEtGenre(lNrPeriodeParDefaut);
            if (!this.indiceParDefaut) {
                this.indiceParDefaut = 0;
            }
            this.periodeCourant = this.listePeriodes.GetElement(this.indiceParDefaut);
            this.GetInstance(this.identSelection).SetDonnees(this.listePeriodes, this.indiceParDefaut, this.GetInstance(this.ObjetDernieresEvaluationsParDate).GetNom(), '');
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.ActionSurRecuperer = function(aListeEvaluations) {
            if (!!aListeEvaluations && !!aListeEvaluations.GetNbrElements()) {
                this.listeEvaluationsParDate = aListeEvaluations;
                this.listeEvaluationsParDate.setTri([ObjetTri.init('date', EGenreTriElement.Decroissant), ObjetTri.init('matiere.Libelle')]);
                this.listeEvaluationsParDate.trier();
                this.listeEvaluationsParMatiere = MethodesObjet.dupliquer(aListeEvaluations);
                this.listeEvaluationsParMatiere.setTri([ObjetTri.init('matiere.ordre'), ObjetTri.init('matiere.Libelle'), ObjetTri.init('matiere.serviceConcerne'), ObjetTri.init('date', EGenreTriElement.Decroissant)]);
                this.listeEvaluationsParMatiere.trier();
                this.listeTabs.parcourir(function(ele) {
                    ele.Actif = true;
                });
                this.GetInstance(this.ObjetDernieresEvaluationsParDate).SetDonnees(this.listeEvaluationsParDate, true);
                this.GetInstance(this.ObjetDernieresEvaluationsParMatiere).SetDonnees(this.listeEvaluationsParMatiere, false);
            } else {
                this.listeTabs.parcourir(function(ele, index) {
                    ele.Actif = index === 0;
                });
                this.GetInstance(this.ObjetDernieresEvaluationsParDate).SetMessage(GTraductions.getValeur('evaluations.AucuneEvaluationSurPeriode'));
                this.GetInstance(this.ObjetDernieresEvaluationsParMatiere).SetMessage(GTraductions.getValeur('evaluations.AucuneEvaluationSurPeriode'));
            }
            this.GetInstance(this.identTabs).setDonnees(this.listeTabs);
            var $wrapper = $('#' + this.idWrapper.escapeJQ());
            var $tailleLegende = 0;
            var $legende = $wrapper.siblings('footer');
            if ($legende.is(':visible')) {
                $tailleLegende = $legende.height();
            }
            $wrapper.css('margin-bottom', $tailleLegende + 'px');
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.RecupererDernieresEvaluations = function() {
            new ObjetRequeteDernieresEvaluations(this, this.ActionSurRecuperer).lancerRequete({
                periode: this.periodeCourant
            });
        };

        function _initialiserObjetTabs(aInstance) {
            aInstance.SetParametres({
                avecSwipe: false
            });
        }
        ObjetAffichageDernieresEvaluations_Mobile.prototype.surSelectionPeriode = function(aGenreEvenement, aParam) {
            this.periodeCourant = aParam.element;
            this.positionPeriodeCourant = this.listePeriodes.GetIndiceParElement(this.periodeCourant);
            this.RecupererDernieresEvaluations();
        };
        ObjetAffichageDernieresEvaluations_Mobile.prototype.free = function() {
            this.inherited('free', arguments);
            if (this.btnFlottant) {
                $('#' + this.btnFlottant.GetNom().escapeJQ()).remove();
            }
        };
        module.exports = ObjetAffichageDernieresEvaluations_Mobile;
    },
    fn: "mobile/script/interfacepagedernieresevaluations_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisie = require('ObjetRequeteJSON.js').ObjetRequeteSaisie;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteSaisieVieScolaire() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('SaisieVieScolaire', ObjetRequeteSaisieVieScolaire, ObjetRequeteSaisie);
        ObjetRequeteSaisieVieScolaire.prototype.lancerRequete = function(aListeAbsences) {
            aListeAbsences.setSerialisateurJSON({
                methodeSerialisation: _serialiserAbsences.bind(this)
            });
            this.JSON.listeAbsences = aListeAbsences;
            return this.appelAsynchrone();
        };
        ObjetRequeteSaisieVieScolaire.prototype.actionApresRequete = function() {
            this.callbackReussite.appel();
        };

        function _serialiserAbsences(aAbsence, aJSON) {
            if (!!aAbsence.documents) {
                aAbsence.documents.setSerialisateurJSON({
                    methodeSerialisation: _surValidation_Fichier.bind(this)
                });
                aJSON.documents = aAbsence.documents;
            }
            aJSON.estLue = aAbsence.estLue;
            aJSON.justification = aAbsence.justification;
            aJSON.motifParent = aAbsence.motifParent;
            aJSON.parentAAccuseDeReception = aAbsence.parentAAccuseDeReception;
        }

        function _surValidation_Fichier(aElement, aJSON) {
            var lIdFichier = aElement.idFichier !== undefined ? aElement.idFichier : (aElement.Fichier !== undefined ? aElement.Fichier.idFichier : null);
            if (lIdFichier !== null) {
                aJSON.idFichier = '' + lIdFichier;
            }
            aJSON.url = aElement.url;
        }
        module.exports = ObjetRequeteSaisieVieScolaire;
    },
    fn: "objetrequetesaisieviescolaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('espace/css/ObjetFichePresenceStyle.css');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GChaine = require('GChaine.js');
        var GHtml = require('GHtml.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var EGenreDocumentJoint = require('Enumere_DocumentJoint.js');
        var EGenreEtat = require('Enumere_Etat.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var Support = require('ObjetSupport.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var TypeGenreObservationVS = require('TypeGenreObservationVS.js').TypeGenreObservationVS;
        MethodesObjet.heritagePrototype(ObjetRecapVS, ObjetIdentite_Mobile);

        function ObjetRecapVS() {
            this.inheritedCreate(arguments);
            this.idTrombone = this.Nom + '_Trombone_';
            this.idNomFichierUpload = this.Nom + '_FichierUpload_';
            this.panelContent = this.Nom + '_PanelContent';
            this.avecPJ = Support.avecSupportFileUpload && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent]);
            this.listePJ = new ObjetListeElements();
            this.idPunition = this.Nom + "_punition";
            this.newMsg = {
                avecHtml: MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent]),
                objet: '',
                contenu: '',
                listeDestinataires: new ObjetListeElements(),
                listeFichiers: new ObjetListeElements(),
                listePublic: []
            };
            this.messagePourReponse = new ObjetElement();
        }(function() {
            ObjetRecapVS.prototype.getControleur = function(aInstance) {
                return {
                    tromboneSelecFile: {
                        getOptionsSelecFile: function() {
                            return {
                                maxSize: GApplication.droits.get(TypeDroits.tailleMaxDocJointEtablissement)
                            };
                        },
                        addFiles: function(aNumeroAbsence, aGenreRecap, aParams) {
                            aInstance.evenementSurSelecteurFichier(aParams.eltFichier);
                        },
                        getDisabled: function(aNumeroAbsence, aGenreRecap) {
                            var lAbsence = _getAbsenceDeNumeroEtGenreRecap.call(aInstance, aNumeroAbsence, aGenreRecap);
                            return !lAbsence || (lAbsence.documents && lAbsence.documents.GetNbrElements() > 0);
                        }
                    }
                };
            };
            ObjetRecapVS.prototype.ConstruireAffichage = function() {
                var lHtml = [];
                if (!!this.donnees) {
                    var lRecap, lGenre;
                    lHtml.push('<ul class="collection">');
                    if (this.donnees.autorisations) {
                        for (var i = 0, lNbr = this.donnees.listeRecapitulatifs.GetNbrElements(); i < lNbr; i++) {
                            lRecap = this.donnees.listeRecapitulatifs.GetElement(i);
                            lGenre = lRecap.GetGenre();
                            if (lGenre === EGenreRessource.ObservationProfesseurEleve && !!this.donnees.autorisations.observation) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.Absence && (!!this.donnees.autorisations.absence || !!this.donnees.autorisations.absenceRepas || !!this.donnees.autorisations.absenceInternat)) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.Infirmerie && !!this.donnees.autorisations.infirmerie) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.Retard && !!this.donnees.autorisations.retard) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.Incident && !!this.donnees.autorisations.incident) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.Punition && (!!this.donnees.autorisations.exclusion || !!this.donnees.autorisations.punition)) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.Sanction && !!this.donnees.autorisations.sanction) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            } else if (lGenre === EGenreRessource.MesureConservatoire && !!this.donnees.autorisations.mesureConservatoire) {
                                lHtml.push(this.composeRecapitulatif(lRecap));
                            }
                        }
                    }
                    if (this.donnees.autorisations.totalHeuresManquees) {
                        lHtml.push('<li class="collection-item raised">');
                        lHtml.push('<span class="title">', GTraductions.getValeur('RecapAbsenceEleve.TotalDesHeuresManquees'), '</span>');
                        lHtml.push('<div class="red-text text-darken-2 secondary-content">', this.getDureeTotal(this.donnees.totaux.total), '</div>');
                        lHtml.push('<div style="font-weight: normal;">', GTraductions.getValeur('RecapAbsenceEleve.TotalDesHeuresM_Info'), '</div>');
                        lHtml.push('</li>');
                        lHtml.push('</ul>');
                    }
                }
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.composeRecapitulatif = function(aRecap) {
                var lHtml = [],
                    lTitreRecap = this.getRecapitulatifLibelle(aRecap),
                    lImage = this.getImage(aRecap),
                    lAvecAction = aRecap.getNombre() > 0;
                var lGenreObservation = (aRecap.GetGenre() === EGenreRessource.ObservationProfesseurEleve ? aRecap.genreObservation : '');
                lHtml.push('<li class="collection-item', (lAvecAction ? ' with-action' : ''), '"', (lAvecAction ? ' onclick="' + this.Nom + '.ouvrirPanel(' + aRecap.GetGenre() + (lGenreObservation !== "" ? "," + lGenreObservation + "" : '') + ')"' : ''), '>');
                lHtml.push('<i class="material-icons ', lImage, '"></i>');
                lHtml.push('<span class="title">', lTitreRecap, '</span>');
                if (aRecap.GetGenre() === EGenreRessource.ObservationProfesseurEleve) {
                    lHtml.push(this.composeDetailObservation(aRecap));
                } else if (aRecap.GetGenre() === EGenreRessource.Absence) {
                    lHtml.push(this.composeDetailAbsence(aRecap));
                } else if ((aRecap.GetGenre() === EGenreRessource.Retard) && (aRecap.Nombre[0] > 0)) {
                    lHtml.push(this.composeDetailRetard(aRecap));
                } else if (aRecap.GetGenre() === EGenreRessource.Punition || aRecap.GetGenre() === EGenreRessource.Sanction || aRecap.GetGenre() === EGenreRessource.Incident) {
                    lHtml.push(this.composeDetailPunitionSanctionIncident(aRecap));
                } else {
                    lHtml.push('');
                }
                if (lAvecAction) {
                    lHtml.push('<div class="secondary-content Gras" style="color:#333;">', aRecap.getNombre(), '</div>');
                }
                lHtml.push('</li>');
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.composeDetailAbsence = function(aRecap) {
                var lHtml = [];
                if (aRecap.Nombre[0] > 0) {
                    lHtml.push('<div>', this.donnees.utilitaireAbsence.getXAbsencesNonJustifiees(aRecap.Nombre[0]).ucfirst(), '</div>');
                }
                lHtml.push('<div>', this.getHeuresCoursManquees(aRecap), '</div>');
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.composeDetailRetard = function(aRecap) {
                var lHtml = [];
                if (aRecap.Nombre[0] > 0) {
                    lHtml.push('<div>', this.donnees.utilitaireAbsence.getDontXRetardNonJustifies(aRecap.Nombre[0]), '</div>');
                }
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.composeDetailPunitionSanctionIncident = function(aRecap) {
                var lHTML = [];
                for (var j in aRecap.Nombre) {
                    var lLibelle = aRecap.libelles[j];
                    var lNombre = aRecap.Nombre[j];
                    if (lNombre > 0) {
                        lHTML.push('<div class="">');
                        lHTML.push('<div class="InlineBlock left-align" style="width:90%;">', lLibelle, '</div>');
                        lHTML.push('<div class="InlineBlock AlignementHaut right-align" style="width:10%;">', lNombre, '</div>');
                        lHTML.push('</div>');
                    }
                }
                return lHTML.join('');
            };
            ObjetRecapVS.prototype.composeDetailObservation = function(aRecap) {
                var lHtml = [];
                if (aRecap.Nombre[0] > 0) {
                    lHtml.push('<div>', this.donnees.utilitaireAbsence.getDontXObservationsNonLu(aRecap.Nombre[0]), '</div>');
                }
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.SetDonnees = function(aDonnees) {
                this.donnees = aDonnees;
                this.Afficher();
            };
            ObjetRecapVS.prototype.evenementObservation = function(aNumeroObservation, aGenreObservation) {
                var lRecap;
                for (var i = 0, lNbrElem = this.donnees.listeRecapitulatifs.GetNbrElements(); i < lNbrElem; i++) {
                    var lRecapitulatif = this.donnees.listeRecapitulatifs.GetElement(i);
                    if (lRecapitulatif.genreObservation === aGenreObservation) {
                        lRecap = lRecapitulatif;
                    }
                }
                var lDonnees = this.donnees.listeAbsences.getListeElements(function(aElement) {
                    var lTestGenre = aElement.GetGenre() === lRecap.GetGenre();
                    var lTestGenreObservation = (aElement.GetGenre() !== EGenreRessource.ObservationProfesseurEleve) || (aElement.genreObservation === lRecap.genreObservation);
                    var lTestProg = (aElement.GetGenre() !== EGenreRessource.Punition) || aElement.estProgrammation !== true;
                    return lTestGenre && lTestGenreObservation && lTestProg;
                });
                lDonnees.setTri([ObjetTri.init('dateDebut', EGenreTriElement.Decroissant)]);
                lDonnees.trier();
                var lObservation = lDonnees.GetElementParNumero(aNumeroObservation);
                lObservation.estLue = true;
                lObservation.SetEtat(EGenreEtat.Modification);
                this.evenementSaisiePage({
                    saisie: true
                });
                $('#' + this.idObservationLu.escapeJQ() + '_' + aNumeroObservation).inputDisabled(true).data('disable', true);
            };
            ObjetRecapVS.prototype.evenementPunition = function(aElement, aNumero) {
                var lPunition = this.donnees.listeAbsences.GetElementParNumero(aNumero);
                lPunition.parentAAccuseDeReception = true;
                lPunition.SetEtat(EGenreEtat.Modification);
                this.evenementSaisiePage({
                    saisie: true
                });
                $(aElement).inputDisabled(true).data('disable', true);
            };
            ObjetRecapVS.prototype.evenementSaisieMotifAbsenceCours = function(aNumeroAbsence, aGenreRecap) {
                var lRecap = this.donnees.listeRecapitulatifs.GetElementParGenre(aGenreRecap);
                var lDonnees = this.donnees.listeAbsences.getListeElements(function(aElement) {
                    var lTestGenre = aElement.GetGenre() === lRecap.GetGenre();
                    var lTestGenreObservation = (aElement.GetGenre() !== EGenreRessource.ObservationProfesseurEleve) || (aElement.genreObservation === lRecap.genreObservation);
                    var lTestProg = (aElement.GetGenre() !== EGenreRessource.Punition) || aElement.estProgrammation !== true;
                    return lTestGenre && lTestGenreObservation && lTestProg;
                });
                lDonnees.setTri([ObjetTri.init('dateDebut', EGenreTriElement.Decroissant)]);
                lDonnees.trier();
                var lAbsence = lDonnees.GetElementParNumero(aNumeroAbsence);
                var lListeMotifsAbsence, lNumeroMotif, lMotifParent;
                if (lAbsence.GetGenre() === EGenreRessource.Absence) {
                    lListeMotifsAbsence = GEtatUtilisateur.listeMotifsAbsences;
                    lNumeroMotif = $('#' + this.getIDElementListeDeroulanteMotifAbsence(aNumeroAbsence).escapeJQ()).val();
                    lMotifParent = lListeMotifsAbsence.GetElementParNumero(lNumeroMotif);
                } else {
                    lListeMotifsAbsence = GEtatUtilisateur.listeMotifsRetards;
                    lNumeroMotif = $('#' + this.getIDElementListeDeroulanteMotifRetard(aNumeroAbsence).escapeJQ()).val();
                    lMotifParent = lListeMotifsAbsence.GetElementParNumero(lNumeroMotif);
                }
                lAbsence.motifParent = lMotifParent;
                lAbsence.SetEtat(EGenreEtat.Modification);
                this.evenementSaisiePage({
                    saisie: true
                });
            };
            ObjetRecapVS.prototype.evenementSaisiePage = function(aParam) {
                this.callback.appel({
                    saisie: aParam.saisie,
                    listePJ: aParam.listePJ
                });
            };
            ObjetRecapVS.prototype.getRecapitulatifLibelle = function(aRecapitulatif) {
                var lResult = this.donnees.utilitaireAbsence.getChaineTraductionGenreAbsenceTitre({
                    genre: aRecapitulatif.Genre,
                    genreObservation: aRecapitulatif.genreObservation,
                    aucun: aRecapitulatif.getNombre() === 0,
                    genreNature: aRecapitulatif.genreNature,
                    libelle: aRecapitulatif.Genre !== EGenreRessource.Sanction ? aRecapitulatif.Genre !== EGenreRessource.MesureConservatoire ? undefined : aRecapitulatif.GetLibelle().toUpperCase() : aRecapitulatif.GetLibelle()
                });
                return lResult ? lResult.ucfirst() : '';
            };
            ObjetRecapVS.prototype.getImage = function(aRecap) {
                return EGenreRessource.getNomImageAbsence({
                    genre: aRecap.Genre,
                    genreObservation: aRecap.genreObservation,
                    genreNature: aRecap.nature ? aRecap.nature.Genre : undefined,
                    justifie: (aRecap.justifie === undefined ? true : aRecap.justifie),
                    estProgrammation: (aRecap.estProgrammation === undefined ? true : aRecap.estProgrammation),
                    estLue: (aRecap.estLue === undefined ? true : aRecap.estLue)
                });
            };
            ObjetRecapVS.prototype.getDureeTotal = function(aPlaces) {
                return aPlaces > 0 ? GDate.FormatDureeEnMillisecondes(aPlaces * 1000, '%hh%sh%mm') : '';
            };
            ObjetRecapVS.prototype.getHeuresCoursManquees = function(aElement, aSansSpan) {
                if (!aElement.nbrHeures || aElement.nbrHeures === '0h00') {
                    return '';
                }
                var lTrad = '';
                if (parseInt(aElement.nbrHeures.charAt(0)) < 2) {
                    lTrad = GTraductions.getValeur('AbsenceVS.heureCoursManque', [aElement.nbrHeures]);
                } else {
                    lTrad = GTraductions.getValeur('AbsenceVS.heuresCoursManquees', [aElement.nbrHeures]);
                }
                if (aSansSpan) {
                    return lTrad;
                }
                return '<span>' + lTrad + '</span><br>';
            };
            ObjetRecapVS.prototype.ouvrirPanel = function(aGenreRecap, aGenreObservation) {
                var lRecap;
                if (aGenreRecap === EGenreRessource.ObservationProfesseurEleve) {
                    for (var i = 0, lNbrElem = this.donnees.listeRecapitulatifs.GetNbrElements(); i < lNbrElem; i++) {
                        var lRecapitulatif = this.donnees.listeRecapitulatifs.GetElement(i);
                        if (lRecapitulatif.genreObservation === aGenreObservation) {
                            lRecap = lRecapitulatif;
                        }
                    }
                } else {
                    lRecap = this.donnees.listeRecapitulatifs.GetElementParGenre(aGenreRecap);
                }
                if (lRecap.Nombre.length !== 0) {
                    GInterface.openPanel(this.composePanel(lRecap), {
                        controleur: this.controleur
                    });
                    var text_area_selector = '.materialize-textarea';
                    $(text_area_selector).each(function() {
                        M.textareaAutoResize($(this));
                    });
                }
            };
            ObjetRecapVS.prototype.surClickProchainElement = function(aPosition, aEstSuivant) {
                var lIndiceRecapActuel, lIndiceProchainRecap, lProchainRecap, lExisteRecap = false;
                for (var i = 0, lNbrElem = this.donnees.listeRecapitulatifs.GetNbrElements(); i < lNbrElem; i++) {
                    if (this.donnees.listeRecapitulatifs.GetElement(i).Position === aPosition) {
                        lIndiceRecapActuel = i;
                    }
                }
                lIndiceProchainRecap = lIndiceRecapActuel;
                while (!lExisteRecap) {
                    if (!!aEstSuivant) {
                        lIndiceProchainRecap = lIndiceProchainRecap + 1 < this.donnees.listeRecapitulatifs.GetNbrElements() ? lIndiceProchainRecap + 1 : 0;
                    } else {
                        lIndiceProchainRecap = lIndiceProchainRecap === 0 ? this.donnees.listeRecapitulatifs.GetNbrElements() - 1 : lIndiceProchainRecap - 1;
                    }
                    lProchainRecap = this.donnees.listeRecapitulatifs.GetElement(lIndiceProchainRecap);
                    if (lProchainRecap.getNombre() > 0) {
                        GInterface.updatePanelContent(this.composePanel(lProchainRecap));
                        $('#' + this.panelContent.escapeJQ()).find('.collapsible').collapsible();
                        $('#' + this.panelContent.escapeJQ()).find('select').formSelect();
                        $('#' + this.panelContent.escapeJQ()).find('textarea').characterCounter();
                        lExisteRecap = true;
                        if (!!this.tableIdTrombone && this.tableIdTrombone.length !== 0) {
                            for (i = 0; i < this.tableIdTrombone.length; i++) {
                                GInterface.getInstanceInputFile().setDonnees({
                                    guid: this.Nom,
                                    conteneurGUID: this,
                                    genrePJ: EGenreDocumentJoint.Fichier,
                                    maxFiles: 1,
                                    maxSize: GApplication.droits.get(TypeDroits.tailleMaxDocJointEtablissement),
                                    elements: [{
                                        id: this.tableIdTrombone[i],
                                        redirect: ['click']
                                    }]
                                });
                            }
                        }
                    }
                }
            };
            ObjetRecapVS.prototype.composePanel = function(aRecap) {
                var lHtml = [],
                    lRecap = aRecap,
                    lGenreRecap = lRecap.GetGenre(),
                    lImage, lMotifLibelle;
                var i;
                var j;
                var lNb;
                var lDonnees = this.donnees.listeAbsences.getListeElements(function(aElement) {
                    var lTestGenre = aElement.GetGenre() === lRecap.GetGenre();
                    var lTestGenreObservation = (aElement.GetGenre() !== EGenreRessource.ObservationProfesseurEleve) || (aElement.genreObservation === lRecap.genreObservation);
                    var lTestProg = (aElement.GetGenre() !== EGenreRessource.Punition) || aElement.estProgrammation !== true;
                    return lTestGenre && lTestGenreObservation && lTestProg;
                });
                lDonnees.setTri([ObjetTri.init('dateDebut', EGenreTriElement.Decroissant)]);
                lDonnees.trier();
                lHtml.push('<div id="', this.panelContent, '">');
                lHtml.push('<div class="navheader">');
                lHtml.push('<div class="right">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="left">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(', lRecap.Position, ',', false, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(', lRecap.Position, ',', true, ')"><i class="material-icons icon_angle_right"></i></button>');
                lHtml.push('</div>');
                lHtml.push('</div>');
                lHtml.push('<div class="subheader">' + this.getRecapitulatifLibelle(lRecap) + '</div>');
                switch (lRecap.GetGenre()) {
                    case EGenreRessource.ObservationProfesseurEleve:
                        this.idObservationLu = this.Nom + '_ObservationLu';
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        var lNbr = lDonnees.GetNbrElements();
                        for (i = 0; i < lNbr; i++) {
                            var lObservation = lDonnees.GetElement(i);
                            lImage = this.getImage(lObservation);
                            lHtml.push('<li class="', (i === 0 ? ' active' : ''), '">');
                            lHtml.push('<div class="collapsible-header">', '<i class="', lImage, ' icon_right"></i>');
                            lHtml.push('<div>' + ((lRecap.genreObservation === TypeGenreObservationVS.OVS_Autres) && lObservation.rubrique ? lObservation.rubrique.GetLibelle() + ', ' : ''), this.donnees.utilitaireAbsence.getDate(lObservation) + '</div>');
                            lHtml.push('<div class="truncate" style="padding-right: 20px;">' + (lObservation.demandeur.GetLibelle()) + (lObservation.matiere && lObservation.matiere.GetLibelle() !== "" ? ' (' + lObservation.matiere.GetLibelle() + ')' : '') + '</div>');
                            lHtml.push('</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (lRecap.genreObservation === TypeGenreObservationVS.OVS_Autres && lObservation.GetLibelle() !== "") {
                                lHtml.push('<div class="EspaceTitreInfoVS">' + GChaine.ToHTML(lObservation.GetLibelle()) + '</div>');
                            }
                            if (lObservation.commentaire !== "") {
                                lHtml.push('<div class="EspaceTitreInfoVS">' + GChaine.ToHTML(lObservation.commentaire) + '</div>');
                            }
                            if ((GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent) && lObservation.avecARObservation) {
                                switch (lObservation.genreObservation) {
                                    case TypeGenreObservationVS.OVS_DefautCarnet:
                                        var lLabelGenreObservation = GTraductions.getValeur('AbsenceVS.titres.prisConnaissance');
                                        break;
                                    case TypeGenreObservationVS.OVS_Autres:
                                        if (lObservation.avecARObservation) {
                                            lLabelGenreObservation = GTraductions.getValeur('AbsenceVS.titres.prisConnaissance');
                                        } else {
                                            lLabelGenreObservation = '';
                                        }
                                        break;
                                    case TypeGenreObservationVS.OVS_ObservationParent:
                                        lLabelGenreObservation = GTraductions.getValeur('AbsenceVS.prisConnaissanceObservation');
                                        break;
                                    case TypeGenreObservationVS.OVS_Encouragement:
                                        lLabelGenreObservation = GTraductions.getValeur('AbsenceVS.prisConnaissanceEncouragement');
                                        break;
                                    default:
                                        lLabelGenreObservation = '';
                                }
                                lHtml.push('<div class="EspaceTitreInfoVS">', '<label>', '<input onclick="' + this.Nom + '.evenementObservation(\'', lObservation.GetNumero(), '\',', lRecap.genreObservation, ');" type="checkbox" id="' + this.idObservationLu + '_' + lObservation.GetNumero() + '" ' + (lObservation.estLue ? 'checked disabled' : '') + ' >', '<span>', lLabelGenreObservation, '</span>', '</label>', '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case EGenreRessource.Absence:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (i = 0, lNbr = lDonnees.GetNbrElements(); i < lNbr; i++) {
                            var lAbsenceAuCours = lDonnees.GetElement(i);
                            lImage = this.getImage(lAbsenceAuCours);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header', (lAbsenceAuCours.aRegulariser ? ' active' : ''), '">', '<i class="', lImage, ' icon_right"></i>', '<div style="padding-right: 20px;">' + GTraductions.getValeur(lAbsenceAuCours.justifie ? 'AbsenceVS.absenceCoursJust' : 'AbsenceVS.absenceCoursNonJust') + " " + this.donnees.utilitaireAbsence.getDate(lAbsenceAuCours) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            lHtml.push('<div class="EspaceTitreInfoVS">' + this.donnees.utilitaireAbsence.getHeuresCoursManquees(lAbsenceAuCours) + '</div>');
                            if (!!lAbsenceAuCours.avecSaisie) {
                                var lListeMotifsAbsence = GEtatUtilisateur.listeMotifsAbsences;
                                if ((MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent])) && this.donnees.autorisations && this.donnees.autorisations.saisieMotifAbsence && !!lListeMotifsAbsence.GetNbrElements()) {
                                    lHtml.push(this.composeListeDeroulanteMotifsAbsence(lGenreRecap, lAbsenceAuCours, lListeMotifsAbsence));
                                } else if (lAbsenceAuCours.motifParent) {
                                    lMotifLibelle = lAbsenceAuCours.motifParent.GetLibelle();
                                    if (lMotifLibelle !== "") {
                                        lHtml.push('<div class="EspaceTitreInfoVS">' + lMotifLibelle + '</div>');
                                    }
                                } else {
                                    lMotifLibelle = this.donnees.utilitaireAbsence.getMotifAbsence({
                                        donnee: lAbsenceAuCours,
                                        enListe: true,
                                        editable: false
                                    });
                                    if (lMotifLibelle !== "") {
                                        lHtml.push('<div class="EspaceTitreInfoVS">' + lMotifLibelle + '</div>');
                                    }
                                }
                                lHtml.push(this.composePieceJointe(lAbsenceAuCours, lGenreRecap));
                                lHtml.push(this.getCommentaireMotifAbsenceRetard({
                                    callback: this.Nom + '.surSaisieVS(\'' + lAbsenceAuCours.GetNumero() + '\',' + lGenreRecap + ')',
                                    donnee: lAbsenceAuCours,
                                    id: this.getIDElementCommentaireDAbsence(lAbsenceAuCours.GetNumero()),
                                    enListe: false
                                }));
                            } else {
                                lMotifLibelle = this.donnees.utilitaireAbsence.getMotifAbsence({
                                    donnee: lAbsenceAuCours,
                                    enListe: true,
                                    editable: false
                                });
                                if (lMotifLibelle !== "") {
                                    lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst() + ' :</div>');
                                    lHtml.push('<div>' + lMotifLibelle + '</div>');
                                }
                                lHtml.push(this.composePieceJointe(lAbsenceAuCours, lGenreRecap));
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case (EGenreRessource.AbsenceRepas):
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (i = 0, lNbr = lDonnees.GetNbrElements(); i < lNbr; i++) {
                            var lAbsenceRepas = lDonnees.GetElement(i);
                            lImage = this.getImage(lAbsenceRepas);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header', (!lAbsenceRepas.reglee ? ' active' : ''), '">', '<i class="', lImage, ' icon_right"></i>', '<div>' + this.donnees.utilitaireAbsence.getDate(lAbsenceRepas) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (lAbsenceRepas.listeMotifs && !!lAbsenceRepas.listeMotifs.GetNbrElements()) {
                                lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">', GTraductions.getValeur('AbsenceVS.titres.motif'), ' :</div>');
                                lHtml.push('<div>', GChaine.ToHTML(lAbsenceRepas.listeMotifs.getTableauLibelles().join(', ')), '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case (EGenreRessource.AbsenceInternat):
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (i = 0, lNbr = lDonnees.GetNbrElements(); i < lNbr; i++) {
                            var lAbsenceInternat = lDonnees.GetElement(i);
                            lImage = this.getImage(lAbsenceInternat);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header', (!lAbsenceInternat.reglee ? ' active' : ''), '">', '<i class="', lImage, ' icon_right"></i>', '<div>' + this.donnees.utilitaireAbsence.getDate(lAbsenceInternat) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (lAbsenceInternat.listeMotifs && !!lAbsenceInternat.listeMotifs.GetNbrElements()) {
                                lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">', GTraductions.getValeur('AbsenceVS.titres.motif'), ' :</div>');
                                lHtml.push('<div>', GChaine.ToHTML(lAbsenceInternat.listeMotifs.getTableauLibelles().join(', ')), '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case EGenreRessource.Infirmerie:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (i = 0, lNbr = lDonnees.GetNbrElements(); i < lNbr; i++) {
                            var lPasageInfirmerie = lDonnees.GetElement(i);
                            lImage = this.getImage(lPasageInfirmerie);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header active">', '<i class="', lImage, ' icon_right"></i>', '<div>' + this.donnees.utilitaireAbsence.getDate(lPasageInfirmerie) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (!!lPasageInfirmerie.symptomesMedicaux.GetNbrElements()) {
                                lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.symptMedicaux').ucfirst() + '</div>');
                                lHtml.push('<div>' + lPasageInfirmerie.symptomesMedicaux.getTableauLibelles().join(', ') + '</div>');
                            }
                            if (!!lPasageInfirmerie.actesMedicaux.GetNbrElements()) {
                                lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.actesMedicaux').ucfirst() + '</div>');
                                lHtml.push('<div >' + lPasageInfirmerie.actesMedicaux.getTableauLibelles().join(', ') + '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case EGenreRessource.Retard:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (i = 0, lNbr = lDonnees.GetNbrElements(); i < lNbr; i++) {
                            var lRetard = lDonnees.GetElement(i);
                            lImage = this.getImage(lRetard);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header', (lRetard.aRegulariser ? ' active' : ''), '">', '<i class="', lImage, ' icon_right"></i>', '<div>' + GTraductions.getValeur('Absence.Retard').ucfirst() + " " + this.donnees.utilitaireAbsence.getDate(lRetard) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            lHtml.push('<div class="EspaceTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.duree').ucfirst() + " : " + this.donnees.utilitaireAbsence.getDureeDAbsence(lRetard) + GTraductions.getValeur('Absence.minute') + '</div>');
                            if (!!lRetard.avecSaisie) {
                                var lListeMotifsRetard = GEtatUtilisateur.listeMotifsRetards;
                                if ((MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent])) && this.donnees.autorisations && this.donnees.autorisations.saisieMotifRetard && !!lListeMotifsRetard.GetNbrElements()) {
                                    if (!lRetard.motifParent || !lRetard.motifParent.existeNumero()) {
                                        lMotifLibelle = GTraductions.getValeur('AbsenceVS.aPreciser');
                                    } else {
                                        lMotifLibelle = lRetard.motifParent.GetLibelle();
                                    }
                                    lHtml.push(this.composeListeDeroulanteMotifsRetard(lGenreRecap, lRetard, lListeMotifsRetard));
                                } else if (!!lRetard.avecSaisie && lRetard.motifParent) {
                                    lMotifLibelle = lRetard.motifParent.GetLibelle();
                                    if (lMotifLibelle !== "") {
                                        lHtml.push('<div class="EspaceTitreInfoVS">' + lMotifLibelle + '</div>');
                                    }
                                } else {
                                    lMotifLibelle = this.donnees.utilitaireAbsence.getMotifAbsence({
                                        donnee: lRetard,
                                        enListe: true,
                                        editable: false
                                    });
                                    if (lMotifLibelle !== "") {
                                        lHtml.push('<div class="EspaceTitreInfoVS">' + lMotifLibelle + '</div>');
                                    }
                                }
                                lHtml.push(this.getCommentaireMotifAbsenceRetard({
                                    callback: this.Nom + '.surSaisieVS(\'' + lRetard.GetNumero() + '\',' + lGenreRecap + ')',
                                    donnee: lRetard,
                                    id: this.getIDElementCommentaireDuRetard(lRetard.GetNumero()),
                                    enListe: false
                                }));
                            } else {
                                lMotifLibelle = this.donnees.utilitaireAbsence.getMotifAbsence({
                                    donnee: lRetard,
                                    enListe: true,
                                    editable: false
                                });
                                if (lMotifLibelle !== "") {
                                    lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst() + '</div>');
                                    lHtml.push('<div>' + lMotifLibelle + '</div>');
                                }
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case EGenreRessource.Incident:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (j = 0, lNb = lDonnees.GetNbrElements(); j < lNb; j++) {
                            var lIncident = lDonnees.GetElement(j);
                            lImage = this.getImage(lIncident);
                            var lAuteur = this.donnees.utilitaireAbsence.getDemandeurDecideur(lIncident),
                                lDateDebut = GDate.FormatDate(lIncident.dateDebut, GTraductions.getValeur('Du') + ' ' + '%J %MMM'),
                                lHeureDebut = GDate.FormatDate(lIncident.dateDebut, '%xh%sh%mm');
                            lDateDebut += ' ' + GTraductions.getValeur('Dates.AHeure', [lHeureDebut]);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header active">', '<i class="', lImage, ' icon_right"></i>', '<div>' + GTraductions.getValeur('AbsenceVS.incident').ucfirst() + " " + lDateDebut + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (lAuteur !== "") {
                                lHtml.push('<div class="EspaceTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.signalePar', [lAuteur]).ucfirst() + '</div>');
                            }
                            lHtml.push(this.getMotifs(lIncident));
                            lHtml.push(this.getCirconstances(lIncident, true));
                            lHtml.push(this.getGravite(lIncident));
                            lHtml.push(this.getMesureDisciplinaire(lIncident));
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</li>');
                        break;
                    case EGenreRessource.Punition:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (j = 0, lNb = lDonnees.GetNbrElements(); j < lNb; j++) {
                            var lPunition = lDonnees.GetElement(j);
                            lImage = this.getImage(lPunition);
                            var lDecideur = this.donnees.utilitaireAbsence.getDemandeurDecideur(lPunition, true, true);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header active">', '<i class="', lImage, ' icon_right"></i>', '<div style="padding-right: 20px;">' + this.donnees.utilitaireAbsence.getModalitesPunitionSanction(lPunition) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (lDecideur !== "") {
                                lHtml.push('<div class="EspaceTitreInfoVS">', lDecideur, '</div>');
                            }
                            lHtml.push(this.getLibellePunitionSanctionDIncident(lPunition));
                            lHtml.push(this.getMotifs(lPunition));
                            lHtml.push(this.getCirconstances(lPunition));
                            lHtml.push(this.getLibelleTAF(lPunition));
                            if ((GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent) && !!lPunition.nature && !!lPunition.nature.estAvecARParent) {
                                var lEtatCheckbox = (lPunition.parentAAccuseDeReception ? 'checked disabled' : '');
                                lHtml.push('<div class="EspaceTitreInfoVS">', '<label>', '<input type="checkbox" onclick="' + this.Nom + '.evenementPunition(this, \'', lPunition.GetNumero(), '\')" ', lEtatCheckbox, '>', '<span>', GTraductions.getValeur('AbsenceVS.titres.prisConnaissance'), '</span>', '</label>', '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case EGenreRessource.MesureConservatoire:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (j = 0, lNb = lDonnees.GetNbrElements(); j < lNb; j++) {
                            var lMesureConservatoire = lDonnees.GetElement(j);
                            lImage = this.getImage(lMesureConservatoire);
                            lDecideur = this.donnees.utilitaireAbsence.getDemandeurDecideur(lMesureConservatoire, true, true);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header active">', '<i class="', lImage, ' icon_right"></i>', '<div>' + this.donnees.utilitaireAbsence.getDate(lMesureConservatoire) + '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            lHtml.push(this.getLibellePunitionSanctionDIncident(lMesureConservatoire));
                            lHtml.push(this.getMotifs(lMesureConservatoire));
                            lHtml.push(this.getCirconstances(lMesureConservatoire));
                            lHtml.push(this.getLibelleTAF(lMesureConservatoire));
                            lHtml.push(this.getLibellesInterdit(lMesureConservatoire));
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    case EGenreRessource.Sanction:
                        lHtml.push('<ul class="collapsible popout" data-collapsible="expandable">');
                        for (j = 0, lNb = lDonnees.GetNbrElements(); j < lNb; j++) {
                            var lSanction = lDonnees.GetElement(j);
                            lImage = this.getImage(lSanction);
                            lDecideur = this.donnees.utilitaireAbsence.getDemandeurDecideur(lSanction, true, true);
                            lHtml.push('<li>');
                            lHtml.push('<div class="collapsible-header active">', '<i class="', lImage, ' icon_right"></i>', '<div>', this.donnees.utilitaireAbsence.getModalitesPunitionSanction(lSanction), ' - ', this.donnees.utilitaireAbsence.getDate(lSanction), '</div>', '</div>');
                            lHtml.push('<div class="collapsible-body">');
                            lHtml.push('<div class="EspaceSectionInfoVS">');
                            if (lDecideur !== "") {
                                lHtml.push('<div class="EspaceTitreInfoVS">' + lDecideur + '</div>');
                            }
                            lHtml.push(this.getLibellePunitionSanctionDIncident(lSanction));
                            lHtml.push(this.getMotifs(lSanction));
                            lHtml.push(this.getCirconstances(lSanction));
                            lHtml.push(this.getLibelleTAF(lSanction));
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                        lHtml.push('</ul>');
                        break;
                    default:
                        ;
                }
                lHtml.push('</div>');
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.getLibellePunitionSanctionDIncident = function(aElement) {
                var lLibelle = '';
                var lModalite = this.donnees.utilitaireAbsence.getLibellePunitionSanctionDIncident(aElement);
                if (lModalite) {
                    lLibelle += '<span class="EspaceTitreInfoVS"><br>' + lModalite + '<br></span>';
                }
                return lLibelle;
            };
            ObjetRecapVS.prototype.getMotifs = function(aElement) {
                var lHtml = [];
                var lMotifAbs = this.donnees.utilitaireAbsence.getMotifAbsence({
                    donnee: aElement,
                    enListe: false,
                    traduction: ''
                });
                if (lMotifAbs !== '') {
                    lHtml.push('<div class="EspaceTitreInfoVS TexteTitreInfoVS">', GTraductions.getValeur('AbsenceVS.titres.motif').ucfirst(), '&nbsp;:</div>', '<div>', lMotifAbs, '</div>');
                }
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.getCirconstances = function(aElement, aEstIncident) {
                var lLibelle = aEstIncident ? aElement.GetLibelle() : this.donnees.utilitaireAbsence.getCirconstances(aElement);
                var lTraduction = aEstIncident ? GTraductions.getValeur('AbsenceVS.circonstancesDetaillees') : GTraductions.getValeur('AbsenceVS.titres.circonstances');
                if (!!lLibelle) {
                    lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + lTraduction.ucfirst() + '&nbsp;:</div><div>' + lLibelle + '<div>';
                }
                return lLibelle;
            };
            ObjetRecapVS.prototype.getGravite = function(aElement) {
                var lLibelle = aElement.gravite || '';
                if (!!lLibelle) {
                    lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.gravite').ucfirst() + '&nbsp;:</div>' + lLibelle;
                }
                return lLibelle;
            };
            ObjetRecapVS.prototype.getMesureDisciplinaire = function(aElement) {
                var lLibelle = !!aElement.mesure ? aElement.mesure.nature.GetLibelle() : '';
                if (!!lLibelle) {
                    lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.titres.mesureDisciplinaire').ucfirst() + '&nbsp;:</div>' + lLibelle;
                }
                return lLibelle;
            };
            ObjetRecapVS.prototype.getLibelleTAF = function(aElement) {
                var lLibelle = this.donnees.utilitaireAbsence.getTravailAFaire(aElement);
                if (!!lLibelle) {
                    lLibelle = '<div class="EspaceTitreInfoVS TexteTitreInfoVS">' + GTraductions.getValeur('AbsenceVS.travailAFaire').ucfirst() + '&nbsp;:</div>' + lLibelle;
                }
                return lLibelle;
            };
            ObjetRecapVS.prototype.getLibellesInterdit = function(aElement) {
                var lLibelle = this.donnees.utilitaireAbsence.getLibellesInterdit(aElement);
                if (!!lLibelle) {
                    lLibelle = '<div class="EspaceTitreInfoVS">' + lLibelle + '</div>';
                }
                return lLibelle;
            };
            ObjetRecapVS.prototype.getCommentaireMotifAbsenceRetard = function(aObjet) {
                var maxLengthCommentaire = 200;
                var lHtml = [];
                if (!MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent]) || !MethodesTableau.existe(aObjet.donnee.GetGenre(), [EGenreRessource.Absence, EGenreRessource.Retard])) {
                    return '';
                }
                if (aObjet.donnee.reglee || aObjet.donnee.listeMotifs.GetNbrElements() > 0) {
                    lHtml.push('<div class="PetitEspace">' + aObjet.donnee.justification + '</div>');
                    return lHtml.join('');
                }
                var lValue = '';
                if (!aObjet.enListe) {
                    lHtml.push('<div class="row">');
                    lHtml.push('<div class="input-field col s12 Gras" style="padding:0px;">');
                    if (aObjet.donnee.justification) {
                        lValue = aObjet.donnee.justification;
                    }
                    if (aObjet.editable !== false) {
                        lHtml.push('<textarea class="materialize-textarea" data-length="' + maxLengthCommentaire + '" maxlength="' + maxLengthCommentaire + '" id="' + aObjet.id + '" onfocus="$(this).one(\'mouseup\',function(){$(this).select();return false;}).select();" onchange="' + aObjet.callback + '" value="' + lValue + '" >' + lValue + '</textarea>');
                        lHtml.push('<label class="' + (lValue !== "" ? 'active' : '') + '" for="' + aObjet.id + '" style="left:0;">' + GTraductions.getValeur('AbsenceVS.saisissezCommentaire', [maxLengthCommentaire]).ucfirst() + '&nbsp;:</label>');
                        lHtml.push('</div>');
                    }
                    lHtml.push('</div>');
                }
                if (aObjet.donnee.message && MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent]) && !aObjet.enListe && !aObjet.donnee.reglee && aObjet.donnee.listeMotifs.GetNbrElements() === 0) {
                    lHtml.push('<div class="Texte10 Italique EspaceHaut">' + aObjet.donnee.message + '</div>');
                }
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.surSaisieVS = function(aNumeroAbsence, aGenreRecap) {
                var lRecap = this.donnees.listeRecapitulatifs.GetElementParGenre(aGenreRecap);
                var lDonnees = this.donnees.listeAbsences.getListeElements(function(aElement) {
                    var lTestGenre = aElement.GetGenre() === lRecap.GetGenre();
                    var lTestGenreObservation = (aElement.GetGenre() !== EGenreRessource.ObservationProfesseurEleve) || (aElement.genreObservation === lRecap.genreObservation);
                    var lTestProg = (aElement.GetGenre() !== EGenreRessource.Punition) || aElement.estProgrammation !== true;
                    return lTestGenre && lTestGenreObservation && lTestProg;
                });
                lDonnees.setTri([ObjetTri.init('dateDebut', EGenreTriElement.Decroissant)]);
                lDonnees.trier();
                var lAbsence = lDonnees.GetElementParNumero(aNumeroAbsence);
                var lInput = (lAbsence.GetGenre() === EGenreRessource.Absence ? $('#' + this.getIDElementCommentaireDAbsence(aNumeroAbsence).escapeJQ()).val() : $('#' + this.getIDElementCommentaireDuRetard(aNumeroAbsence).escapeJQ()).val());
                if (lInput === GTraductions.getValeur('AbsenceVS.saisissezCommentaire').ucfirst() || lInput === lAbsence.justification) {
                    return;
                }
                lAbsence.justification = lInput;
                lAbsence.SetEtat(EGenreEtat.Modification);
                if (lAbsence.avecSaisie) {
                    lAbsence.SetEtat(EGenreEtat.Modification);
                    this.evenementSaisiePage({
                        saisie: true
                    });
                }
            };
            ObjetRecapVS.prototype.getIDElementCommentaireDAbsence = function(aNumeroAbsence) {
                return this.Nom + '_commentaireDAbsenceParent_' + aNumeroAbsence;
            };
            ObjetRecapVS.prototype.getIDElementCommentaireDuRetard = function(aNumeroRetard) {
                return this.Nom + '_commentaireDuRetardParent_' + aNumeroRetard;
            };
            ObjetRecapVS.prototype.getIDElementListeDeroulanteMotifAbsence = function(aNumeroAbsence) {
                return this.Nom + '_motifAbsence_' + aNumeroAbsence;
            };
            ObjetRecapVS.prototype.getIDElementListeDeroulanteMotifRetard = function(aNumeroRetard) {
                return this.Nom + '_motifRetard_' + aNumeroRetard;
            };
            ObjetRecapVS.prototype.getIDElementTrombone = function(aNumero) {
                return this.idTrombone + aNumero;
            };
            ObjetRecapVS.prototype.getIDElementFichierUpload = function(aNumeroAbsence) {
                return this.idNomFichierUpload + aNumeroAbsence;
            };
            ObjetRecapVS.prototype.composeListeDeroulanteMotifsAbsence = function(aGenreRecap, aAbsence, aListeMotifsAbsence) {
                var lHtml = [];
                lHtml.push('<div class="input-field" style="margin:0px;">');
                lHtml.push('<select id="' + this.getIDElementListeDeroulanteMotifAbsence(aAbsence.GetNumero()) + '" onchange="' + this.Nom + '.evenementSaisieMotifAbsenceCours(\'', aAbsence.GetNumero(), '\',', aGenreRecap, ');"', (!aAbsence.motifParent || aAbsence.motifParent === undefined || !aAbsence.motifParent.existeNumero() ? ' placeholder="' + GTraductions.getValeur('AbsenceVS.aPreciser') + '"' : ''), '>');
                lHtml.push('<option value="" disabled selected>' + GTraductions.getValeur('AbsenceVS.aPreciser') + '</option>');
                for (var j = 0, lNb = aListeMotifsAbsence.GetNbrElements(); j < lNb; j++) {
                    var lMotif = aListeMotifsAbsence.GetElement(j);
                    lHtml.push('<option value="' + lMotif.GetNumero() + '"' + (aAbsence.motifParent && aAbsence.motifParent.GetNumero() === lMotif.GetNumero() ? ' selected="selected"' : '') + '>' + lMotif.GetLibelle() + '</option>');
                }
                lHtml.push('</select>');
                lHtml.push('</div>');
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.composeListeDeroulanteMotifsRetard = function(aGenreRecap, aRetard, aListeMotifsRetards) {
                var lHtml = [];
                lHtml.push('<div class="input-field" style="margin:0px;">');
                lHtml.push('<select id="' + this.getIDElementListeDeroulanteMotifRetard(aRetard.GetNumero()) + '" onchange="' + this.Nom + '.evenementSaisieMotifAbsenceCours(\'', aRetard.GetNumero(), '\',', aGenreRecap, ');" ', (!aRetard.motifParent || !aRetard.motifParent.existeNumero() ? ' placeholder="' + GTraductions.getValeur('AbsenceVS.aPreciser') + '"' : ''), '>');
                lHtml.push('<option value="" disabled>' + GTraductions.getValeur('AbsenceVS.aPreciser') + '</option>');
                for (var j = 0, lNb = aListeMotifsRetards.GetNbrElements(); j < lNb; j++) {
                    var lMotif = aListeMotifsRetards.GetElement(j);
                    lHtml.push('<option value="' + lMotif.GetNumero() + '"' + (aRetard.motifParent && aRetard.motifParent.GetNumero() === lMotif.GetNumero() ? ' selected="selected"' : '') + '>' + lMotif.GetLibelle() + '</option>');
                }
                lHtml.push('</select>');
                lHtml.push('</div>');
                return lHtml.join('');
            };
            ObjetRecapVS.prototype.composePieceJointe = function(aAbsence, aNumeroRecap) {
                var lHtml = [],
                    lPieceJointe, I;
                if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent])) {
                    if (!!aAbsence.documents && aAbsence.documents.GetNbrElements()) {
                        for (I = 0; I < aAbsence.documents.GetNbrElements(); I++) {
                            lPieceJointe = aAbsence.documents.GetElement(I);
                            lHtml.push('<div class="row valign-wrapper" style="margin:0px;">', '<div class="left" style="font-style: italic;color:#9e9e9e;">' + GTraductions.getValeur('AbsenceVS.TelechargerUnJustifcatif') + '</div>', '<div class=" left Image_Trombone_Mobile"></div>', '</div>', '<div class="row" style="overflow:hidden; margin-top: 0px; margin-bottom: 20px; border: 1px solid #9e9e9e;">', GChaine.composerUrlLienExterne({
                                documentJoint: lPieceJointe,
                                genreRessource: EGenreRessource.DocJointEleve
                            }), '</div>');
                        }
                    } else if (!!aAbsence.avecSaisie && this.avecPJ) {
                        lHtml.push('<div class="row valign-wrapper" style="margin:0px;">');
                        lHtml.push('<div class="left" style="font-style: italic;color:#9e9e9e;">' + GTraductions.getValeur('AbsenceVS.TelechargerUnJustifcatif') + '</div>');
                        lHtml.push('<div ', GHtml.composeAttr('ie-model', 'tromboneSelecFile', [aAbsence.GetNumero(), aNumeroRecap]), ' ie-selecfile id="' + this.idTrombone + aAbsence.GetNumero() + '" class="Image_Trombone_Mobile"  onclick="' + this.Nom + '.surCklickTrombine(\'' + aAbsence.GetNumero() + '\',' + aNumeroRecap + ');"></div>');
                        lHtml.push('</div>');
                        lHtml.push('<div id="' + this.idNomFichierUpload + aAbsence.GetNumero() + '" class="Texte10 row"></div>');
                    }
                } else if (GEtatUtilisateur.estEspaceEleve() && !!aAbsence.documents && aAbsence.documents.GetNbrElements()) {
                    for (I = 0; I < aAbsence.documents.GetNbrElements(); I++) {
                        lPieceJointe = aAbsence.documents.GetElement(I);
                        lHtml.push('<div class="row valign-wrapper" style="margin:0px;">', '<div class="left" style="font-style: italic;color:#9e9e9e;">' + GTraductions.getValeur('AbsenceVS.TelechargerUnJustifcatif') + '</div>', '<div class=" left Image_Trombone_Mobile"></div>', '</div>', '<div class="row" style="overflow:hidden; margin-top: 0px; margin-bottom: 20px; border: 1px solid #9e9e9e;">', GChaine.composerUrlLienExterne({
                            documentJoint: lPieceJointe,
                            genreRessource: EGenreRessource.DocJointEleve
                        }), '</div>');
                    }
                }
                return lHtml.join('');
            };

            function _getAbsenceDeNumeroEtGenreRecap(aNumeroAbsence, aGenreRecap) {
                var lRecap = this.donnees.listeRecapitulatifs.GetElementParGenre(aGenreRecap);
                var lDonnees = this.donnees.listeAbsences.getListeElements(function(aElement) {
                    var lTestGenre = aElement.GetGenre() === lRecap.GetGenre();
                    var lTestGenreObservation = (aElement.GetGenre() !== EGenreRessource.ObservationProfesseurEleve) || (aElement.genreObservation === lRecap.genreObservation);
                    var lTestProg = (aElement.GetGenre() !== EGenreRessource.Punition) || aElement.estProgrammation !== true;
                    return lTestGenre && lTestGenreObservation && lTestProg;
                });
                return lDonnees.GetElementParNumero(aNumeroAbsence);
            }
            ObjetRecapVS.prototype.evenementSurSelecteurFichier = function(aFichier) {
                if (!this.avecPJ) {
                    return;
                }
                if (MethodesTableau.existe(aFichier && aFichier.GetLibelle(), this.listePJ.getTableauLibelles())) {
                    GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Information,
                        message: GTraductions.getValeur('inputFile.msgEchecLibelleFichier')
                    });
                } else {
                    this.newMsg.listeFichiers.GetNbrElements() ? this.newMsg.listeFichiers.vider() : '';
                    this.newMsg.listeFichiers.AddElement(aFichier);
                    this.listePJ.AddElement(aFichier);
                    var lAbsence = _getAbsenceDeNumeroEtGenreRecap.call(this, this.numeroAbsence, this.genreRecap);
                    if (!!lAbsence) {
                        lAbsence.documents = this.newMsg.listeFichiers;
                        lAbsence.SetEtat(EGenreEtat.Modification);
                        this.evenementSaisiePage({
                            saisie: true,
                            listePJ: this.newMsg.listeFichiers
                        });
                        $('#' + this.getIDElementTrombone(this.numeroAbsence).escapeJQ()).off('mousemove.inputfile mouseenter.inputfile mouseleave.inputfile touchstart.inputfile pointerenter.inputfile focus.inputfile destroyed.inputfile iedown.inputfile');
                        $('#' + this.getIDElementFichierUpload(this.numeroAbsence).escapeJQ()).html(this.actualiserListePJ());
                    }
                }
            };
            ObjetRecapVS.prototype.getIdNomFichierUpload = function(aNumero) {
                return this.idNomFichierUpload + '_' + aNumero;
            };
            ObjetRecapVS.prototype.actualiserListePJ = function() {
                if (!this.avecPJ) {
                    return '';
                }
                return this.newMsg.listeFichiers ? this.newMsg.listeFichiers.getTableauLibelles().join(', ') : '';
            };
            ObjetRecapVS.prototype.surCklickTrombine = function(aNumeroAbsence, aGenreRecap) {
                this.genreRecap = aGenreRecap;
                this.numeroAbsence = aNumeroAbsence;
            };
            ObjetRecapVS.prototype.composeDemandeLePar = function(aElement, aAuteur) {
                var lResultat = '';
                var lDate = '';
                var lPlace = aElement.placeDemande;
                if (aElement.horsCours) {
                    lPlace = null;
                }
                var lDateDebut = GDate.FormatDate(aElement.dateDemande, '[' + '%J %MMM' + ']');
                if ((lPlace !== null && lPlace !== undefined)) {
                    lDate = GDate.PlaceAnnuelleEnDate(lPlace);
                    if (lDate && GDate.estDateValide(lDate) && GDate.estJourEgal(lDate, aElement.dateDemande)) {
                        lDate = GTraductions.getValeur('Dates.DateDebutAHeureDebut', [lDateDebut, GDate.FormatDate(lDate, '%xh%sh%mm')]) + ' ';
                    } else {
                        lDate = lDateDebut;
                    }
                } else {
                    lDate = lDateDebut;
                }
                lResultat += (aElement.GetGenre() === EGenreRessource.Punition ? GTraductions.getValeur('AbsenceVS.demandeLePar', [lDate, aAuteur]) : GTraductions.getValeur('AbsenceVS.decideLePar', [lDate, aAuteur]));
                return lResultat;
            };
        })();
        module.exports = ObjetRecapVS;
    },
    fn: "pagerecapitulatifvs.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var MethodesTableau = require('MethodesTableau.js');
        var Requetes = require('CollectionRequetes.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetDeserialiser = require('ObjetDeserialiser.js');
        var TypeGenreObservationVS = require('TypeGenreObservationVS.js').TypeGenreObservationVS;

        function ObjetRequetePageVieScolaire() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('PagePresence', ObjetRequetePageVieScolaire, ObjetRequeteConsultation);
        ObjetRequetePageVieScolaire.prototype.lancerRequete = function(aDateDebut, aDateFin, aPeriode) {
            this.JSON = {
                DateDebut: aDateDebut,
                DateFin: aDateFin,
                periode: aPeriode
            };
            return this.appelAsynchrone();
        };
        ObjetRequetePageVieScolaire.prototype.actionApresRequete = function() {
            this.recap = new ObjetListeElements();
            this.listeAbsences = new ObjetListeElements();
            this.autorisations = this.JSONReponse.autorisations;
            var lMessage = this.JSONReponse.message;
            var lTotaux = {
                suivi: 0,
                absence: 0,
                excluCours: 0,
                excluEtab: 0,
                infirmerie: 0,
                total: 0
            };
            var lListeMatieres = new ObjetListeElements();
            if (!lMessage) {
                this.listeAbsences = new ObjetDeserialiser().listeEvenementsVS(this.JSONReponse.listeAbsences, false);
                this.recap = this.initialiserRecapitulatif(this.JSONReponse.listeRecapitulatifs, this.JSONReponse.listeSanctionUtilisateur);
                this.listeAbsences.parcourir(_enrichirAbsence.bind(this));
                this.recap.setTri([ObjetTri.init('Position'), ObjetTri.init('Libelle')]);
                this.recap.trier();
                if (this.JSONReponse.Matieres) {
                    lListeMatieres = this.JSONReponse.Matieres;
                    lListeMatieres.parcourir(_deserialiserDuree.bind(this, lTotaux));
                }
            }
            this.callbackReussite.appel({
                listeRecapitulatifs: this.recap,
                listeAbsences: this.listeAbsences,
                autorisations: this.autorisations,
                totaux: lTotaux,
                listeMatieres: lListeMatieres,
                message: lMessage
            });
        };
        ObjetRequetePageVieScolaire.prototype.creerElementRecapitulatifAbsences = function(aObjet) {
            var lElement = new ObjetElement('', aObjet.numero, aObjet.genre, aObjet.position, true);
            lElement.genreObservation = aObjet.genreObservation;
            lElement.genreNature = aObjet.genreNature;
            lElement.Nombre = [];
            lElement.genresNaturesAR = [];
            lElement.getNombre = function(aGenre) {
                var lResult = 0;
                var i;
                if (!aGenre) {
                    for (i in this.Nombre) {
                        lResult += this.Nombre[i];
                    }
                } else {
                    lResult = this.Nombre[aGenre];
                }
                return lResult;
            }.bind(lElement);
            lElement.aNouvelInfo = function() {
                var lResult = false;
                if (!MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Parent, EGenreEspace.PrimParent])) {
                    return false;
                }
                var i;
                switch (this.Genre) {
                    case EGenreRessource.ObservationProfesseurEleve:
                    case EGenreRessource.Absence:
                    case EGenreRessource.Retard:
                    case EGenreRessource.Punition:
                        for (i in this.genresNaturesAR) {
                            if (this.Nombre[i] > 0) {
                                return true;
                            }
                        }
                        break;
                    default:
                        return false;
                }
                return lResult;
            }.bind(lElement);
            if (aObjet.genre === EGenreRessource.Absence) {
                lElement.nombreDemiJournees = aObjet.nombreDemiJournees;
                lElement.nombreDemiJourneesNonJustifies = aObjet.nombreDemiJourneesNonJustifies;
                lElement.nbrHeures = aObjet.nbrHeures;
            }
            return lElement;
        };
        ObjetRequetePageVieScolaire.prototype.initialiserRecapitulatif = function(aListeRecapitulatifs) {
            var lObjet, i;
            var lListeRecapitulatifs = new ObjetListeElements();
            if (this.autorisations.observation) {
                if (GEtatUtilisateur.GenreEspace === EGenreEspace.Parent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Parent) {
                    lObjet = {
                        genre: EGenreRessource.ObservationProfesseurEleve,
                        genreObservation: TypeGenreObservationVS.OVS_ObservationParent
                    };
                    lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                    lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
                }
                lObjet = {
                    genre: EGenreRessource.ObservationProfesseurEleve,
                    genreObservation: TypeGenreObservationVS.OVS_Encouragement
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
                lObjet = {
                    genre: EGenreRessource.ObservationProfesseurEleve,
                    genreObservation: TypeGenreObservationVS.OVS_DefautCarnet
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
                lObjet = {
                    genre: EGenreRessource.ObservationProfesseurEleve,
                    genreObservation: TypeGenreObservationVS.OVS_Autres
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.absence) {
                lObjet = {
                    genre: EGenreRessource.Absence
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                for (i = 0; i < aListeRecapitulatifs.GetNbrElements(); i++) {
                    var lElement = aListeRecapitulatifs.GetElement(i);
                    lObjet.nombreDemiJournees = lElement.NombreTotal;
                    lObjet.nombreDemiJourneesNonJustifies = lElement.NombreNonJustifie;
                    lObjet.nbrHeures = lElement.NbrHeures;
                }
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.absenceRepas) {
                lObjet = {
                    genre: EGenreRessource.AbsenceRepas
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.absenceInternat) {
                lObjet = {
                    genre: EGenreRessource.AbsenceInternat
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.infirmerie) {
                lObjet = {
                    genre: EGenreRessource.Infirmerie
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.retard) {
                lObjet = {
                    genre: EGenreRessource.Retard
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.incident) {
                lObjet = {
                    genre: EGenreRessource.Incident
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.punition || this.autorisations.exclusion) {
                lObjet = {
                    genre: EGenreRessource.Punition
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.mesureConservatoire) {
                lObjet = {
                    genre: EGenreRessource.MesureConservatoire
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            if (this.autorisations.sanction) {
                lObjet = {
                    genre: EGenreRessource.Sanction
                };
                lObjet.position = EGenreRessource.getPositionAbsence(lObjet);
                lListeRecapitulatifs.AddElement(this.creerElementRecapitulatifAbsences(lObjet));
            }
            lListeRecapitulatifs.trier();
            lListeRecapitulatifs.getRecapitultatifDeGenre = _getRecapitultatifDeGenre.bind(lListeRecapitulatifs);
            return lListeRecapitulatifs;
        };

        function _getRecapitultatifDeGenre(aParams) {
            var lPosition = EGenreRessource.getPositionAbsence(aParams);
            var lIndice = this.getIndiceElementParFiltre(function(aElement) {
                return aElement.Position === lPosition;
            });
            var lRecap;
            if (lIndice > -1) {
                lRecap = this.GetElement(lIndice);
            }
            return lRecap;
        }

        function _filtreRecapitulatif(aAbsence, aElement) {
            var lObj = {
                genre: aAbsence.GetGenre(),
                genreObservation: aAbsence.genreObservation
            };
            if (aAbsence.GetGenre() === EGenreRessource.Punition) {
                lObj.genreNature = aAbsence.nature.GetGenre();
            }
            var lPosition = EGenreRessource.getPositionAbsence(lObj);
            return aElement.Position === lPosition;
        }
        ObjetRequetePageVieScolaire.prototype.ajoutSurRecapitulatifSelonAbsence = function(aListeRecapitulatifs, aAbsence) {
            var lIndice = aListeRecapitulatifs.getIndiceElementParFiltre(_filtreRecapitulatif.bind(this, aAbsence));
            var lElement = aListeRecapitulatifs.GetElement(lIndice);
            if (!!lElement) {
                var lIx = 0;
                if ((aAbsence.GetGenre() === EGenreRessource.Absence || aAbsence.GetGenre() === EGenreRessource.Retard)) {
                    if (!aAbsence.justifie &&
                        aAbsence.avecSaisie && (!aAbsence.motifParent || !aAbsence.motifParent.existeNumero()) &&
                        !MethodesTableau.existe(lIx, lElement.genresNaturesAR)) {
                        lElement.genresNaturesAR.push(lIx);
                    }
                    if (aAbsence.justifie) {
                        lIx = 1;
                    }
                }
                if (aAbsence.GetGenre() === EGenreRessource.ObservationProfesseurEleve) {
                    if (!aAbsence.estLue &&
                        aAbsence.avecARObservation &&
                        !MethodesTableau.existe(lIx, lElement.genresNaturesAR)) {
                        lElement.genresNaturesAR.push(lIx);
                    }
                    if (aAbsence.estLue || !aAbsence.avecARObservation) {
                        lIx = 1;
                    }
                }
                if (aAbsence.GetGenre() === EGenreRessource.Punition || aAbsence.GetGenre() === EGenreRessource.Sanction || aAbsence.GetGenre() === EGenreRessource.Incident) {
                    if (aAbsence.GetGenre() === EGenreRessource.Incident) {
                        lIx = !!aAbsence.mesure ? aAbsence.mesure.GetGenre() : EGenreRessource.Aucune;
                    } else {
                        lIx = aAbsence.nature.GetGenre();
                        if ((aAbsence.GetGenre() === EGenreRessource.Punition) && aAbsence.nature.estAvecARParent && !aAbsence.parentAAccuseDeReception && !MethodesTableau.existe(lIx, lElement.genresNaturesAR)) {
                            lElement.genresNaturesAR.push(lIx);
                        }
                    }
                }
                if (lElement.Nombre[lIx] === undefined || lElement.Nombre[lIx] === null) {
                    lElement.Nombre[lIx] = 0;
                }
                if (aAbsence.GetGenre() === EGenreRessource.Punition || aAbsence.GetGenre() === EGenreRessource.Sanction || aAbsence.GetGenre() === EGenreRessource.Incident) {
                    if (!lElement.libelles) {
                        lElement.libelles = [];
                    }
                    if (!lElement.libelles[lIx] && !aAbsence.estProgrammation) {
                        if (aAbsence.GetGenre() === EGenreRessource.Incident) {
                            lElement.libelles[lIx] = _getTraductionMesure(lIx);
                        } else {
                            lElement.libelles[lIx] = aAbsence.nature.GetLibelle();
                        }
                    }
                }
                if (!aAbsence.estProgrammation) {
                    lElement.Nombre[lIx]++;
                }
            }
        };

        function _getTraductionMesure(aGenre) {
            switch (aGenre) {
                case EGenreRessource.Punition:
                    return GTraductions.getValeur('AbsenceVS.LieAPunition');
                case EGenreRessource.Sanction:
                    return GTraductions.getValeur('AbsenceVS.LieASanction');
                case EGenreRessource.MesureConservatoire:
                    return GTraductions.getValeur('AbsenceVS.LieAMesureConservatoire');
                case EGenreRessource.Aucune:
                    return GTraductions.getValeur('AbsenceVS.SansMesureDiciplinaire');
                default:
                    ;
                    return '';
            }
        }

        function _enrichirAbsence(aElement) {
            this.ajoutSurRecapitulatifSelonAbsence(this.recap, aElement);
        }

        function _deserialiserDuree(aTotaux, aElement, aIndex, aListeOrigin) {
            if (aElement.regroupement > 0) {
                aElement.estUnDeploiement = true;
                aElement.estDeploye = true;
            }
            var lDansRegroupement = aElement.dansRegroupement;
            if (lDansRegroupement > 0) {
                var lIdxPere = aListeOrigin.getIndiceElementParFiltre(function(aElmOrigin) {
                    return aElmOrigin.regroupement === lDansRegroupement;
                });
                if (lIdxPere > -1) {
                    aElement.pere = aListeOrigin.GetElement(lIdxPere);
                }
            }
            aElement.total = aElement.absence + aElement.excluCours + aElement.excluEtab;
            if (!aElement.estUnDeploiement) {
                aTotaux.suivi += aElement.suivi;
                aTotaux.absence += aElement.absence;
                aTotaux.excluCours += aElement.excluCours;
                aTotaux.excluEtab += aElement.excluEtab;
                aTotaux.infirmerie += aElement.infirmerie;
                aTotaux.total += aElement.total;
            }
        }
        module.exports = ObjetRequetePageVieScolaire;
    },
    fn: "objetrequetepageviescolaire.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteSaisieVieScolaire = require('ObjetRequeteSaisieVieScolaire.js');
        var ObjetRecapVS = require('PageRecapitulatifVS.js');
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetRequetePageVieScolaire = require('ObjetRequetePageVieScolaire.js');
        var ObjetUtilitaireAbsence = require('ObjetUtilitaireAbsence.js');
        MethodesObjet.heritagePrototype(ObjetAffichagePagePresenceRecap_Mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePagePresenceRecap_Mobile() {
            this.inheritedCreate(arguments);
            this.listePeriodes = new ObjetListeElements();
            this.periodeCourant = new ObjetElement();
            this.donnees = {
                listeRecapitulatifs: new ObjetListeElements(),
                listeAbsences: new ObjetListeElements(),
                totaux: {},
                listeMatieres: new ObjetListeElements(),
                apresValidation: false,
                elementSelection: null
            };
            this.utilitaireAbsence = new ObjetUtilitaireAbsence();
            this.indiceParDefaut = 0;
        }
        ObjetAffichagePagePresenceRecap_Mobile.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, this.evenementSelection);
            this.identPage = this.Add(ObjetRecapVS, this.evenementPage);
            this.AddSurZone = [this.identSelection];
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.RecupererDonnees = function() {
            var lOngletInfosPeriodes = GEtatUtilisateur.getOngletInfosPeriodes();
            var lNrPeriodeParDefaut;
            if (lOngletInfosPeriodes.message) {
                this.GetInstance(this.identPage).SetMessage(lOngletInfosPeriodes.message);
            } else {
                this.listePeriodes = lOngletInfosPeriodes.listePeriodes;
                lNrPeriodeParDefaut = GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().periode ? GEtatUtilisateur.getPage().periode.GetNumero() : lOngletInfosPeriodes.periodeParDefaut.GetNumero();
                this.indiceParDefaut = this.listePeriodes.GetIndiceParNumeroEtGenre(lNrPeriodeParDefaut);
                if (!this.indiceParDefaut) {
                    this.indiceParDefaut = 0;
                }
                this.periodeCourant = this.listePeriodes.GetElement(this.indiceParDefaut);
                this.GetInstance(this.identSelection).SetDonnees(this.listePeriodes, this.indiceParDefaut, null, '');
            }
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.RecupererDonneesRecapVS = function() {
            if (this.periodeCourant.existeNumero()) {
                this.periodeCourant = GParametres.listePeriodes.GetElementParNumero(this.periodeCourant.GetNumero());
                this.DateDebut = this.periodeCourant.dates.debut;
                this.DateFin = this.periodeCourant.dates.fin;
            } else {
                this.DateDebut = GParametres.PremiereDate;
                this.DateFin = GParametres.DerniereDate;
            }
            new ObjetRequetePageVieScolaire(this, this.actionSurRecupererDonneesRecapVS).lancerRequete(this.DateDebut, this.DateFin, this.periodeCourant);
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.actionSurRecupererDonneesRecapVS = function(aObjet) {
            $.extend(this.donnees, aObjet);
            if (!!this.donnees.listeRecapitulatifs.GetNbrElements()) {
                var lObjDonnees = {
                    listeRecapitulatifs: this.donnees.listeRecapitulatifs,
                    totaux: this.donnees.totaux,
                    listeAbsences: this.donnees.listeAbsences,
                    utilitaireAbsence: this.utilitaireAbsence,
                    autorisations: this.donnees.autorisations
                };
                this.GetInstance(this.identPage).SetDonnees(lObjDonnees);
            }
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.evenementSelection = function(aGenreEvenement, aParam) {
            this.periodeCourant = aParam.element;
            this.positionPeriodeCourant = this.listePeriodes.GetIndiceParElement(this.periodeCourant);
            this.RecupererDonneesRecapVS();
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.evenementPage = function(aParam) {
            if (aParam.saisie) {
                if (aParam.listePJ) {
                    this.Valider(aParam.listePJ);
                } else {
                    this.Valider();
                }
            } else {
                this.callback.appel({
                    genreOnglet: EGenreOnglet.VieScolaire_Recapitulatif,
                    genreOngletDest: aParam.genreOngletDest
                });
            }
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.Valider = function(aListePJs) {
            var lRequete = new ObjetRequeteSaisieVieScolaire(this, this.ActionSurValidation);
            if (aListePJs && aListePJs.GetNbrElements() > 0) {
                lRequete.addUpload({
                    listeFichiers: aListePJs
                });
            }
            lRequete.lancerRequete(this.donnees.listeAbsences);
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.ActionSurValidation = function() {
            this.SetEtatSaisie(false);
            new ObjetRequetePageVieScolaire(this, this.actionSurRecupererDonneesApresValidation).lancerRequete(this.DateDebut, this.DateFin);
        };
        ObjetAffichagePagePresenceRecap_Mobile.prototype.actionSurRecupererDonneesApresValidation = function(aObjet) {
            aObjet.apresValidation = true;
            this.actionSurRecupererDonneesRecapVS(aObjet);
        };
        module.exports = ObjetAffichagePagePresenceRecap_Mobile;
    },
    fn: "interfacepagepresencerecap_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteDetailEvaluationsCompetences() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('DetailEvaluationsCompetences', ObjetRequeteDetailEvaluationsCompetences, ObjetRequeteConsultation);
        ObjetRequeteDetailEvaluationsCompetences.prototype.lancerRequete = function(aParam) {
            this.JSON = {
                eleve: aParam.eleve,
                pilier: aParam.pilier,
                relationsESI: aParam.numRelESI,
                resultatSansLigneDeCumul: aParam.resultatSansLigneDeCumul,
                avecEdition: aParam.avecEdition
            };
            return this.appelAsynchrone();
        };
        ObjetRequeteDetailEvaluationsCompetences.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequeteDetailEvaluationsCompetences;
    },
    fn: "objetrequetedetailevaluationscompetences.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreColonneBulletinCompetence = {
            tCBdC_Services: 0,
            tCBdC_EltPilier: 1,
            tCBdC_EltProg: 2,
            tCBdC_Jauge: 3,
            tCBdC_Pourcentage: 4,
            tCBdC_PosLSUP1: 5,
            tCBdC_PosLSUP2: 6,
            tCBdC_PosLSU: 7,
            tCBdC_Note: 8,
            tCBdC_MoyenneClasse: 9,
            tCBdC_AppreciationA: 10,
            tCBdC_AppreciationB: 11,
            tCBdC_AppreciationC: 12
        };
        module.exports.TypeGenreColonneBulletinCompetence = TypeGenreColonneBulletinCompetence;
    },
    fn: "typegenrecolonnebulletincompetence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreElementBulletinCompetence = {
            tEBPM_SurMatiere: 0,
            tEBPM_Service: 1,
            tEBPM_EltPilier: 2,
            tEBPM_Competence: 3,
            tEBPM_SousItem: 4
        };
        module.exports.TypeGenreElementBulletinCompetence = TypeGenreElementBulletinCompetence;
    },
    fn: "typegenreelementbulletincompetence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeJaugeEvaluationBulletinCompetence = {
            tJBC_Chronologique: 0,
            tJBC_ParNiveau: 1
        };
        module.exports.TypeJaugeEvaluationBulletinCompetence = TypeJaugeEvaluationBulletinCompetence;
    },
    fn: "typejaugeevaluationbulletincompetence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var GHtml = require('GHtml.js');
        var Identite = require('ObjetIdentite.js');
        var ObjetIdentite_Mobile = require('ObjetIdentite_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var GTraductions = require('ObjetTraduction.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var UtilitaireBulletinEtReleve_Mobile = require('UtilitaireBulletinEtReleve_Mobile.js');
        var EGenreNiveauDAcquisition = require('Enumere_NiveauDAcquisition.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var UtilitaireDeserialiserPiedBulletin = require('UtilitaireDeserialiserPiedBulletin.js');
        var ObjetRequeteDetailEvaluationsCompetences = require('ObjetRequeteDetailEvaluationsCompetences.js');
        var TypeGenreColonneBulletinCompetence = require('TypeGenreColonneBulletinCompetence.js').TypeGenreColonneBulletinCompetence;
        var TypeGenreElementBulletinCompetence = require('TypeGenreElementBulletinCompetence.js').TypeGenreElementBulletinCompetence;
        var TypeJaugeEvaluationBulletinCompetence = require('TypeJaugeEvaluationBulletinCompetence.js').TypeJaugeEvaluationBulletinCompetence;
        var TypePositionnement = require('TypePositionnement.js').TypePositionnement;
        var FenetrePopUp_Mobile = require('FenetrePopUp_Mobile.js');
        var PiedDeBulletinMobile = require('PiedDeBulletinMobile.js');
        var TypeContexteBulletin = require('TypeContexteBulletin.js');
        var TypeReleveBulletin = require('TypeReleveBulletin.js');
        MethodesObjet.heritagePrototype(ObjetBulletinCompetences, ObjetIdentite_Mobile);

        function ObjetBulletinCompetences() {
            this.inheritedCreate(arguments);
            this.donneesRecues = false;
            this.estBilanParMatiere = false;
            this.listeElementsCompetence = new ObjetListeElements();
            var lToutesLesCompetences = new ObjetElement(GTraductions.getValeur('competences.ToutesLesCompetences'), '2', null, null, null);
            var lPositionementGeneral = new ObjetElement(GTraductions.getValeur('competences.PositionnementGeneral'), '1', null, null, null);
            this.listeElementsCompetence.AddElement(lToutesLesCompetences);
            this.listeElementsCompetence.AddElement(lPositionementGeneral);
            this.btnCombo = this.Nom + "_boutonCombo";
            this.modaleCombo = this.Nom + '_modaleZoneCombo';
            this.corpsDePage = this.Nom + '_corpsDePage';
            this.listeEvaluations = this.Nom + "_listeEvaluations";
            this.piedDePage = this.Nom + "_piedDeBulletin";
            this.eltProg = this.Nom + "_elementsDuProgramme";
            this.instancePiedDeBulletin = Identite.creerInstance(PiedDeBulletinMobile, {
                pere: this,
                evenement: null
            });
            this.instancePiedDeBulletin.setDonneesContexte({
                typeContexteBulletin: TypeContexteBulletin.CB_Eleve,
                avecSaisie: false,
                typeReleveBulletin: TypeReleveBulletin.BulletinCompetences
            });
        }
        ObjetBulletinCompetences.prototype.SetDonnees = function(aDonneesCorpsDePage, aEstBilanParMatiere) {
            if (!!aDonneesCorpsDePage.maquette) {
                this.donnees = aDonneesCorpsDePage;
                this.listeServices = new ObjetListeElements();
                this.estBilanParMatiere = aEstBilanParMatiere;
                this.donneesRecues = true;
                this.message = false;
            } else {
                this.donnees = false;
                this.estBilanParMatiere = false;
                this.donneesRecues = false;
                this.message = false;
            }
            this.Afficher();
            var lDonneesPiedDeBulletin = new UtilitaireDeserialiserPiedBulletin().creerPiedDePage(this.donnees);
            var lDonneesAbsences = new UtilitaireDeserialiserPiedBulletin().creerAbsences(this.donnees);
            this.instancePiedDeBulletin.setDonneesPiedDeBulletin(lDonneesPiedDeBulletin, lDonneesAbsences);
            this.instancePiedDeBulletin.Afficher();
        };
        ObjetBulletinCompetences.prototype.Afficher = function(aHtml, aDirectionSlide) {
            this.inherited('Afficher', aHtml, aDirectionSlide);
            if (!this.estBilanParMatiere) {
                this.setTitreBoutonCombo(this.listeElementsCompetence.GetElement(0).GetNumero());
            }
        };
        ObjetBulletinCompetences.prototype.SetMessage = function(aMessage) {
            this.message = aMessage;
            this.Afficher();
        };
        ObjetBulletinCompetences.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            if (!!this.message) {
                lHtml.push(this.composeAucuneDonnee(this.message));
            } else if (this.donneesRecues) {
                this.formaterListes();
                if (!!this.estBilanParMatiere) {
                    lHtml.push(this.composeCorpsDePage(this.estBilanParMatiere));
                } else {
                    lHtml.push(this.composeCombo());
                    lHtml.push('<div id="', this.corpsDePage, '">' + this.composeCorpsDePage(this.estBilanParMatiere, "2") + '</div>');
                }
                lHtml.push('<div id="', this.instancePiedDeBulletin.GetNom(), '"></div>');
            }
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype._getInstanceModale = function() {
            var $objetModaleCombo = $("#" + this.modaleCombo.escapeJQ());
            var lInstanceObjetModaleCombo = M.Modal.getInstance($objetModaleCombo);
            if (!lInstanceObjetModaleCombo) {
                M.Modal.init($objetModaleCombo, {});
                lInstanceObjetModaleCombo = M.Modal.getInstance($objetModaleCombo);
            }
            return lInstanceObjetModaleCombo;
        };
        ObjetBulletinCompetences.prototype.afficherModale = function() {
            this._getInstanceModale().open();
        };
        ObjetBulletinCompetences.prototype.fermerModaleListe = function() {
            var lInstanceModale = this._getInstanceModale();
            if (lInstanceModale.isOpen) {
                lInstanceModale.close();
            }
        };
        ObjetBulletinCompetences.prototype.formaterListes = function() {
            var lRegroupement = null;
            if (!!this.donnees && this.donnees.listeLignes.GetNbrElements()) {
                this.donnees.listeLignes.parcourir(function(D) {
                    if (D.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_SurMatiere) {
                        D.estUnDeploiement = true;
                        D.estDeploye = true;
                        lRegroupement = D;
                    } else {
                        if (D.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_EltPilier || (D.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && D.estDansRegroupement)) {
                            D.pere = lRegroupement;
                        } else {
                            lRegroupement = null;
                        }
                    }
                });
            }
        };
        ObjetBulletinCompetences.prototype.composeCorpsDePage = function(aEstBilanParMatiere, aNumero) {
            var lHtml = [],
                lGenrePositionnement, lElem = null,
                lExisteRegroupement = false;
            var i;
            var lNbrElem;
            var lIdListeEvaluations = this.listeEvaluations + (!!aEstBilanParMatiere ? '_BilanParMatiere' : '_BilanTransversal_' + aNumero);
            if (!!this.donnees && !!this.donnees.listeLignes && this.donnees.listeLignes.GetNbrElements()) {
                if (!!aEstBilanParMatiere || (!aEstBilanParMatiere && aNumero === "1")) {
                    lHtml.push('<ul id="', lIdListeEvaluations, '"class="collection with-header">');
                    for (i = 0, lNbrElem = this.donnees.listeLignes.GetNbrElements(); i < lNbrElem; i++) {
                        lElem = this.donnees.listeLignes.GetElement(i);
                        if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_SurMatiere) {
                            lHtml.push('<li class="collection-header collection-group with-action">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            lHtml.push('</li>');
                            lExisteRegroupement = true;
                        } else if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && !!lElem.estDansRegroupement) {
                            lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.ouvrirPanel(\'', lElem.GetNumero(), '\',', aEstBilanParMatiere, ')" style="padding:3px 12px;">');
                            lHtml.push('<div style="border-left: 5px solid ' + (!!lElem.couleur && lElem.couleur !== "" ? lElem.couleur : 'D4D4D4') + '; padding: 10px 5px;">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            if ((!!aEstBilanParMatiere && !!this.donnees.maquette.avecNiveauxPositionnements) || (!aEstBilanParMatiere && !!this.donnees.maquette.avecNiveauxPositionnements)) {
                                lGenrePositionnement = this.donnees.typePositionnement || TypePositionnement.POS_Echelle;
                                lHtml.push('<div class="secondary-content">' + (lElem.posLSUNiveau ? EGenreNiveauDAcquisition.getImagePositionnement({
                                    niveauDAcquisition: lElem.posLSUNiveau,
                                    genrePositionnement: lGenrePositionnement
                                }) : (lElem.posLSUNote ? lElem.posLSUNote.getValeur() : '')) + '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                            this.listeServices.AddElement(lElem);
                        } else if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && !lElem.estDansRegroupement) {
                            lHtml.push('<li class="collection-item with-action ', (!!lExisteRegroupement ? ' break-group' : ''), '" onclick="', this.Nom, '.ouvrirPanel(\'', lElem.GetNumero(), '\',', aEstBilanParMatiere, ')" style="padding: 3px 16px;">');
                            lHtml.push('<div style="border-left: 5px solid ' + (!!lElem.couleur && lElem.couleurb !== "" ? lElem.couleur : 'D4D4D4') + '; padding: 10px 5px;">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            if ((!!aEstBilanParMatiere && !!this.donnees.maquette.avecNiveauxPositionnements) || (!aEstBilanParMatiere && !!this.donnees.maquette.avecNiveauxPositionnements)) {
                                lGenrePositionnement = this.donnees.typePositionnement || TypePositionnement.POS_Echelle;
                                lHtml.push('<div class="secondary-content">' + (lElem.posLSUNiveau ? EGenreNiveauDAcquisition.getImagePositionnement({
                                    niveauDAcquisition: lElem.posLSUNiveau,
                                    genrePositionnement: lGenrePositionnement
                                }) : (lElem.posLSUNote ? lElem.posLSUNote.getValeur() : '')) + '</div>');
                            }
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                            this.listeServices.AddElement(lElem);
                        }
                    }
                    lHtml.push('</ul>');
                } else if (!aEstBilanParMatiere && aNumero === "2") {
                    lHtml.push('<ul id="', lIdListeEvaluations, '" class="collection with-header">');
                    for (i = 0, lNbrElem = this.donnees.listeLignes.GetNbrElements(); i < lNbrElem; i++) {
                        lElem = this.donnees.listeLignes.GetElement(i);
                        if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_SurMatiere) {
                            lHtml.push('<li class="collection-header collection-group with-action">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            lHtml.push('</li>');
                            lExisteRegroupement = true;
                        } else if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && !!lElem.estDansRegroupement) {
                            lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.ouvrirPanel(\'', lElem.GetNumero(), '\',', aEstBilanParMatiere, ')" style="padding:3px 12px;">');
                            lHtml.push(this.composeListeNiveauDAqcuisitions(lElem));
                            lHtml.push('</li>');
                            this.listeServices.AddElement(lElem);
                        } else if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && !lElem.estDansRegroupement) {
                            lHtml.push('<li class="collection-item with-action ', (!!lExisteRegroupement ? ' break-group' : ''), '" onclick="', this.Nom, '.ouvrirPanel(\'', lElem.GetNumero(), '\',', aEstBilanParMatiere, ')" style="padding:3px 16px;">');
                            lHtml.push(this.composeListeNiveauDAqcuisitions(lElem));
                            lHtml.push('</li>');
                            this.listeServices.AddElement(lElem);
                        }
                    }
                    lHtml.push('</ul>');
                } else {
                    lHtml.push('<ul id="', lIdListeEvaluations, '"class="collection with-header">');
                    for (i = 0, lNbrElem = this.donnees.listeLignes.GetNbrElements(); i < lNbrElem; i++) {
                        lElem = this.donnees.listeLignes.GetElement(i);
                        if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_SurMatiere) {
                            lHtml.push('<li class="collection-header collection-group with-action">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            lHtml.push('</li>');
                            lExisteRegroupement = true;
                        } else if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && !!lElem.estDansRegroupement) {
                            lHtml.push('<li class="collection-item with-action" onclick="', this.Nom, '.ouvrirPanel(\'', lElem.GetNumero(), '\',', aEstBilanParMatiere, ')" style="padding:3px 12px;">');
                            lHtml.push('<div style="border-left: 5px solid ' + (!!lElem.couleur && lElem.couleur !== "" ? lElem.couleur : 'D4D4D4') + '; padding: 10px 5px;">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            lHtml.push(this.getImagePastille(lElem, aNumero));
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                            this.listeServices.AddElement(lElem);
                        } else if (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service && !lElem.estDansRegroupement) {
                            lHtml.push('<li class="collection-item with-action ', (!!lExisteRegroupement ? ' break-group' : ''), '" onclick="', this.Nom, '.ouvrirPanel(\'', lElem.GetNumero(), '\',', aEstBilanParMatiere, ')" style="padding:3px 16px;">');
                            lHtml.push('<div style="border-left: 5px solid ' + (!!lElem.couleur && lElem.couleur !== "" ? lElem.couleur : 'D4D4D4') + '; padding: 10px 5px;">');
                            lHtml.push('<div>' + lElem.strServiceEtProf + '</div>');
                            lHtml.push(this.getImagePastille(lElem, aNumero));
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                            this.listeServices.AddElement(lElem);
                        }
                    }
                    lHtml.push('</ul>');
                }
            }
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype.composeCombo = function() {
            var lHtml = [];
            lHtml.push('<div style="background-color: #f1f1f1;">');
            lHtml.push('<div class="right">');
            lHtml.push('<button id="', this.btnCombo, '" class="btn-flat triangleGrey" onclick="' + this.Nom + '.afficherModale();">&nbsp;</button>');
            lHtml.push('</div>');
            lHtml.push('<div class="clear"></div>');
            lHtml.push('</div>');
            lHtml.push('<div id="', this.modaleCombo, '" class="modal">');
            var lToutesLesCompetences = this.listeElementsCompetence.GetElement(0);
            lHtml.push('<ul class="collection" style="min-width:130px;">');
            lHtml.push('<li class="collection-item with-action" onclick="' + this.Nom + '.surClickElemDropDown(\'', lToutesLesCompetences.GetNumero(), '\')">', lToutesLesCompetences.GetLibelle() + '</li>');
            if (!!this.donnees.maquette.avecNiveauxPositionnements) {
                var lPositionnementGeneral = this.listeElementsCompetence.GetElement(1);
                lHtml.push('<li class="collection-item with-action" onclick="' + this.Nom + '.surClickElemDropDown(\'', lPositionnementGeneral.GetNumero(), '\')">', lPositionnementGeneral.GetLibelle() + '</li>');
            }
            if (!!this.donnees.listeLignes && this.donnees.listeLignes.GetNbrElements()) {
                var lElement = false,
                    lNbrEleme = this.donnees.listeLignes.GetNbrElements(),
                    i = 0;
                while (!lElement & i < lNbrEleme) {
                    if (this.donnees.listeLignes.GetGenre(i) === TypeGenreColonneBulletinCompetence.tCBdC_EltPilier) {
                        lElement = this.donnees.listeLignes.GetElement(i);
                    }
                    i++;
                }
                if (!!lElement && !!lElement.listeColonnesTransv && lElement.listeColonnesTransv.GetNbrElements()) {
                    var lThis = this;
                    lElement.listeColonnesTransv.parcourir(function(aElementCompetence) {
                        lThis.listeElementsCompetence.AddElement(aElementCompetence);
                        lHtml.push('<li class="collection-item with-action" onclick="' + lThis.Nom + '.surClickElemDropDown(\'', aElementCompetence.GetNumero(), '\')">' + aElementCompetence.GetLibelle() + '</li>');
                    });
                }
            }
            lHtml.push('</ul>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype.ouvrirPanel = function(aNumeroService, aEstBilanParMatiere) {
            GInterface.openPanel(this.composePanel(aNumeroService, aEstBilanParMatiere));
            $('#' + this.eltProg.escapeJQ()).children('ul').addClass("browser-default");
        };
        ObjetBulletinCompetences.prototype.composePanel = function(aNumeroElement, aEstBilanParMatiere) {
            var lHtml = [],
                lElemParent, lElem;
            if (!!aEstBilanParMatiere) {
                var lListeElement = new ObjetListeElements();
                for (var i = 0, lNbrServices = this.donnees.listeLignes.GetNbrElements(); i < lNbrServices; i++) {
                    lElem = this.donnees.listeLignes.GetElement(i);
                    if (lElem.GetNumero() === aNumeroElement && (lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Competence || lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_EltPilier)) {
                        lListeElement.AddElement(lElem);
                    } else if (lElem.GetNumero() === aNumeroElement && lElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_Service) {
                        lHtml.push('<div class="navheader">');
                        lHtml.push('<div class="right">');
                        lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
                        lHtml.push('</div>');
                        lHtml.push('<div class="left">');
                        lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', lElem.GetNumero(), '\',', false, ',', aEstBilanParMatiere, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
                        lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', lElem.GetNumero(), '\',', true, ',', aEstBilanParMatiere, ')"><i class="material-icons icon_angle_right"></i></button>');
                        lHtml.push('</div>');
                        lHtml.push('<div class="clear"></div>');
                        lHtml.push('</div>');
                        lHtml.push(this.composeBandeauService(lElem));
                        lElemParent = lElem;
                    }
                }
                lHtml.push(this.composeListeCompetencesEvaluees(lListeElement, lElemParent, aEstBilanParMatiere));
                if (!!lElemParent) {
                    if ((!!lElemParent.strEltProg && lElemParent.hintEltProg !== "") || (!!lElemParent.strEltProg && lElemParent.strEltProg !== "")) {
                        lHtml.push('<div style="padding:10px 5px 5px 5px;">');
                        var lColonneEltProg = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_EltProg);
                        var lLibellelColonneEltProg = !!lColonneEltProg && lColonneEltProg.GetLibelle() !== "" ? lColonneEltProg.GetLibelle() : "";
                        lHtml.push('<div class="left-align color : #616161;">' + lLibellelColonneEltProg + '</div>');
                        lHtml.push('<div id="' + this.eltProg + '" class="Espace">');
                        if (!!lElemParent.strEltProg && lElemParent.strEltProg !== "") {
                            lHtml.push(lElemParent.strEltProg);
                        }
                        if (!!lElemParent.hintEltProg && lElemParent.hintEltProg !== "") {
                            lHtml.push(lElemParent.hintEltProg);
                        }
                        lHtml.push('</div>');
                        lHtml.push('</div>');
                    }
                    if (!!lElemParent.appreciationA && lElemParent.appreciationA !== "") {
                        var lColonneAppreciationsParMatiere = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_AppreciationA);
                        var lLibelleAppreciationsParMatiere = !!lColonneAppreciationsParMatiere && lColonneAppreciationsParMatiere.GetLibelle() !== "" ? lColonneAppreciationsParMatiere.GetLibelle() : "";
                        lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                            intituleDAppreciation: lLibelleAppreciationsParMatiere,
                            contenuDAppreciation: lElemParent.appreciationA,
                            styleBlockIntitule: 'color : #616161;',
                            styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                        }));
                    }
                    if (!!lElemParent.appreciationB && lElemParent.appreciationB !== "") {
                        var lColonneProgressionParMatiere = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_AppreciationB);
                        var lLibelleProgressionParMatiere = !!lColonneProgressionParMatiere && lColonneProgressionParMatiere.GetLibelle() !== "" ? lColonneProgressionParMatiere.GetLibelle() : "";
                        lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                            intituleDAppreciation: lLibelleProgressionParMatiere,
                            contenuDAppreciation: lElemParent.appreciationB,
                            styleBlockIntitule: 'color : #616161;',
                            styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                        }));
                    }
                    if (!!lElemParent.appreciationC && lElemParent.appreciationC !== "") {
                        var lColonneConseilParMatiere = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_AppreciationC);
                        var lLibelleConseilParMatiere = !!lColonneConseilParMatiere && lColonneConseilParMatiere.GetLibelle() !== "" ? lColonneConseilParMatiere.GetLibelle() : "";
                        lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                            intituleDAppreciation: lLibelleConseilParMatiere,
                            contenuDAppreciation: lElemParent.appreciationC,
                            styleBlockIntitule: 'color : #616161;',
                            styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                        }));
                    }
                }
            } else {
                lElem = this.donnees.listeLignes.GetElementParNumero(aNumeroElement);
                lHtml.push('<div class="navheader">');
                lHtml.push('<div class="right">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="' + GInterface.GetNom() + '.closePanel();">' + '<i class="material-icons icon_remove"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="left">');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', lElem.GetNumero(), '\',', false, ',', aEstBilanParMatiere, ')">' + '<i class="material-icons icon_angle_left"></i></button>');
                lHtml.push('<button class="btn-flat waves-effect waves-light btn-floating" onclick="', this.Nom, '.surClickProchainElement(\'', lElem.GetNumero(), '\',', true, ',', aEstBilanParMatiere, ')"><i class="material-icons icon_angle_right"></i></button>');
                lHtml.push('</div>');
                lHtml.push('<div class="clear"></div>');
                lHtml.push('</div>');
                lHtml.push(this.composeBandeauService(lElem));
                if (!!lElem.listeColonnesTransv && lElem.listeColonnesTransv.GetNbrElements()) {
                    lHtml.push(this.composeListeCompetencesEvaluees(lElem.listeColonnesTransv, null, aEstBilanParMatiere));
                }
                if (!!lElem && !!lElem.appreciationA && lElem.appreciationA !== "") {
                    var lColonneAppreciationsTabTransv = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_AppreciationA);
                    var lLibelleAppreciationsTabTransv = !!lColonneAppreciationsTabTransv && lColonneAppreciationsTabTransv.GetLibelle() !== "" ? lColonneAppreciationsTabTransv.GetLibelle() : "";
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                        intituleDAppreciation: lLibelleAppreciationsTabTransv,
                        contenuDAppreciation: lElem.appreciationA,
                        styleBlockIntitule: 'color : #616161;',
                        styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                    }));
                }
                if (!!lElem && !!lElem.appreciationB && lElem.appreciationB !== "") {
                    var lColonneProgressionTabTransv = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_AppreciationB);
                    var lLibelleProgressionTabTransv = !!lColonneProgressionTabTransv && lColonneProgressionTabTransv.GetLibelle() !== "" ? lColonneProgressionTabTransv.GetLibelle() : "";
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                        intituleDAppreciation: lLibelleProgressionTabTransv,
                        contenuDAppreciation: lElem.appreciationB,
                        styleBlockIntitule: 'color : #616161;',
                        styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                    }));
                }
                if (!!lElem && !!lElem.appreciationC && lElem.appreciationC !== "") {
                    var lColonneConseilTabTransv = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_AppreciationC);
                    var lLibelleConseilTabTransv = !!lColonneConseilTabTransv && lColonneConseilTabTransv.GetLibelle() !== "" ? lColonneConseilTabTransv.GetLibelle() : "";
                    lHtml.push(UtilitaireBulletinEtReleve_Mobile.composeAppreciation({
                        intituleDAppreciation: lLibelleConseilTabTransv,
                        contenuDAppreciation: lElem.appreciationC,
                        styleBlockIntitule: 'color : #616161;',
                        styleBlockContenu: 'border:1px solid #616161; background-color: #F1F1F1;'
                    }));
                }
            }
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype.composeBandeauService = function(aService) {
            var lHtml = [];
            var lPourcentageReussite = this.donnees.listeColonnes.GetElementParGenre(TypeGenreColonneBulletinCompetence.tCBdC_Pourcentage);
            lHtml.push('<div class="subheader">');
            lHtml.push('<div>');
            lHtml.push('<div class="InlineBlock left-align truncate" style="width:50%; vertical-align:top;" >' + aService.strServiceEtProf + '</div>');
            lHtml.push('<div class="InlineBlock left-align" style="width:50%; vertical-align:top;">');
            if (!!aService.pourcentage && aService.pourcentage !== "" && !!lPourcentageReussite && lPourcentageReussite.GetLibelle() !== "") {
                lHtml.push('<div style="padding-right:2.5rem;font-weight:normal; line-height:18px;">' + GTraductions.getValeur('competences.TauxDeReussite') + " " + aService.pourcentage + "%" + '</div>');
            }
            if (!!aService.posLSUNiveau) {
                lHtml.push('<div style="top: 0.3rem; position: absolute;right: 0.7rem;">' +
                    EGenreNiveauDAcquisition.getImagePositionnement({
                        niveauDAcquisition: aService.posLSUNiveau,
                        genrePositionnement: this.donnees.typePositionnement || TypePositionnement.POS_Echelle
                    }) + '</div>');
            }
            if (!!aService.posLSUNote) {
                lHtml.push('<div style="top:2rem; position: absolute;right: 0.9rem;">' + aService.posLSUNote.getNote() + '</div>');
            }
            lHtml.push('</div>');
            lHtml.push('</div>');
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype.composeListeCompetencesEvaluees = function(aListeCompetencesEvaluees, aElementParent, aEstBilanParMatiere) {
            var lHtml = [];
            var lCompetence;
            var i;
            var lNbrCompetencesEvaluees;
            if ((!!aListeCompetencesEvaluees && aListeCompetencesEvaluees.GetNbrElements()) || !!aElementParent) {
                lHtml.push('<ul class="collection with-header" style="overflow-Y:auto;">');
                if (!!aEstBilanParMatiere) {
                    if (!!aElementParent) {
                        lHtml.push(this.composeBarreNiveauxDAcquisitions(aElementParent));
                    }
                    if (!!aListeCompetencesEvaluees && aListeCompetencesEvaluees.GetNbrElements()) {
                        for (i = 0, lNbrCompetencesEvaluees = aListeCompetencesEvaluees.GetNbrElements(); i < lNbrCompetencesEvaluees; i++) {
                            lCompetence = aListeCompetencesEvaluees.GetElement(i);
                            var lPourChronologique = this._estJaugeChronologique();
                            var listeNiveaux = lPourChronologique ? lCompetence.listeNiveauxChronologique : lCompetence.listeNiveaux;
                            lHtml.push('<li class="collection-item ', (!!listeNiveaux ? 'with-action' : ''), '" style="padding-left:4px; padding-right:4px;" onclick="' + (!!listeNiveaux ? this.Nom + '.surClicJaugeEvaluations(' + lCompetence.Position + ')' : ''), '">');
                            lHtml.push('<div>');
                            lHtml.push('<div class="InlineBlock AlignementHaut" style="width:64%;">', lCompetence.strElmtCompetence, '</div>');
                            lHtml.push('<div class="InlineBlock AlignementHaut right-align" style="width:35%; padding-right:', (!lPourChronologique ? '0.5rem;' : '0.7rem;'), '">');
                            if (!!listeNiveaux && listeNiveaux.GetNbrElements()) {
                                for (var j = 0, lNbrNiveau = listeNiveaux.GetNbrElements(); j < lNbrNiveau; j++) {
                                    var lNbr = listeNiveaux.GetElement(j).nbr;
                                    if (lNbr !== 0) {
                                        var lNiveau = GParametres.listeNiveauxDAcquisitions.GetElementParElement(listeNiveaux.GetElement(j));
                                        lHtml.push('<div class="InlineBlock" style="margin-left:10px">');
                                        lHtml.push('<div class="InlineBlock" style="width:50%; vertical-align:middle;">', lNbr, '</div>');
                                        lHtml.push('<div class="InlineBlock" style="width:50%; vertical-align:middle">', EGenreNiveauDAcquisition.getImage(lNiveau), '</div>');
                                        lHtml.push('</div>');
                                    }
                                }
                            }
                            lHtml.push('</div>');
                            lHtml.push('</div>');
                            lHtml.push('</li>');
                        }
                    }
                } else {
                    for (i = 0, lNbrCompetencesEvaluees = aListeCompetencesEvaluees.GetNbrElements(); i < lNbrCompetencesEvaluees; i++) {
                        lCompetence = aListeCompetencesEvaluees.GetElement(i);
                        var lExisteUnNiveauAcqui = (!!lCompetence.niveauAcqui),
                            lAUnNiveauAcquiSaisi = lExisteUnNiveauAcqui && lCompetence.niveauAcqui.existeNumero(),
                            lAUnNiveauAcquiCalcule = (!!lCompetence.niveauAcquiCalc && lCompetence.niveauAcquiCalc.existeNumero());
                        lHtml.push('<li class="collection-item" style="padding-left:4px; padding-right:4px;">');
                        lHtml.push('<div>', lCompetence.GetLibelle(), '</div>');
                        if (lExisteUnNiveauAcqui && lAUnNiveauAcquiCalcule) {
                            if (lAUnNiveauAcquiSaisi) {
                                lHtml.push('<div class="secondary-content">', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcqui), '</div>');
                            }
                            lHtml.push('<div class="secondary-content">', ' (', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcquiCalc), ')', '</div>');
                        } else if (lAUnNiveauAcquiSaisi || lAUnNiveauAcquiCalcule) {
                            if (lAUnNiveauAcquiSaisi) {
                                lHtml.push('<div class="secondary-content">', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcqui), '</div>');
                            } else {
                                lHtml.push('<div class="secondary-content"', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcquiCalc), '</div>');
                            }
                        }
                        lHtml.push('</li>');
                    }
                }
                lHtml.push('</ul>');
            }
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype.composeListeNiveauDAqcuisitions = function(aElem) {
            var lHtml = [];
            lHtml.push('<div style="border-left: 5px solid ' + (!!aElem.couleur && aElem.couleur !== "" ? aElem.couleur : 'D4D4D4') + '; padding: 10px 5px;">');
            lHtml.push('<div class="InlineBlock AlignementHaut" style="width:64%;">' + aElem.strServiceEtProf + '</div>');
            if (!!aElem.listeColonnesTransv && aElem.listeColonnesTransv.GetNbrElements()) {
                lHtml.push('<div class="InlineBlock AlignementHaut right-align" style="width:35%;">');
                for (var j = 0, lNbrElement = aElem.listeColonnesTransv.GetNbrElements(); j < lNbrElement; j++) {
                    var lObjetElementColonneTransv = aElem.listeColonnesTransv.GetElement(j),
                        lExisteUnNiveauAcqui = (!!lObjetElementColonneTransv.niveauAcqui),
                        lAUnNiveauAcquiSaisi = lExisteUnNiveauAcqui && lObjetElementColonneTransv.niveauAcqui.existeNumero(),
                        lAUnNiveauAcquiCalcule = (!!lObjetElementColonneTransv.niveauAcquiCalc && lObjetElementColonneTransv.niveauAcquiCalc.existeNumero());
                    if (lExisteUnNiveauAcqui && lAUnNiveauAcquiCalcule) {
                        if (lAUnNiveauAcquiSaisi) {
                            lHtml.push('<div class="InlineBlock" style="', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? 'padding:0rem 0.2rem;' : ''), '">', EGenreNiveauDAcquisition.getImage(lObjetElementColonneTransv.niveauAcqui), '</div>');
                        } else {
                            lHtml.push('<div class="InlineBlock" style="width:16px;">&nbsp;</div>');
                        }
                        lHtml.push('<div class="InlineBlock"  style="', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? 'padding:0rem 0.2rem;' : ''), '">', ' (', EGenreNiveauDAcquisition.getImage(lObjetElementColonneTransv.niveauAcquiCalc), ')', '</div>');
                    } else if (lAUnNiveauAcquiSaisi || lAUnNiveauAcquiCalcule) {
                        if (lAUnNiveauAcquiSaisi) {
                            lHtml.push('<div class="InlineBlock"  style="', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? 'padding:0rem 0.2rem;' : ''), '">', EGenreNiveauDAcquisition.getImage(lObjetElementColonneTransv.niveauAcqui), '</div>');
                        } else {
                            lHtml.push('<div class="InlineBlock"  style="', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? 'padding:0rem 0.2rem;' : ''), '">', EGenreNiveauDAcquisition.getImage(lObjetElementColonneTransv.niveauAcquiCalc), '</div>');
                        }
                    }
                }
                lHtml.push('</div>');
            }
            lHtml.push('</div>');
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype.composeBarreNiveauxDAcquisitions = function(aElem) {
            var lHtml = [];
            var lInfos = [];
            var i, lTotal = 0,
                lElt;
            var lListeNiveauxDAcquisitions = MethodesObjet.dupliquer(GParametres.listeNiveauxDAcquisitions);
            var lNiveau, lGenre, lCouleur, lImage, lNombre, n = lListeNiveauxDAcquisitions.GetNbrElements();
            var lPourChronologique = this._estJaugeChronologique();
            var listeNiveaux = lPourChronologique ? aElem.listeNiveauxChronologique : aElem.listeNiveaux;
            var avecAbsent = (!lPourChronologique && aElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_EltPilier);
            var hint = aElem.hintNiveaux;
            var pourPastille = aElem.GetGenre() === TypeGenreElementBulletinCompetence.tEBPM_EltPilier;
            if (!!lPourChronologique && listeNiveaux && listeNiveaux.GetNbrElements()) {
                lHtml.push('<li class="collection-header white valign-wrapper', (!!listeNiveaux ? ' with-action' : ''), '" style="padding: 0.6rem 0.0rem 0.6rem 0.3rem;" onclick="' + (!!listeNiveaux ? this.Nom + '.surClicJaugeEvaluations(' + aElem.Position + ')' : ''), '">');
                var lSeparateur = '';
                for (i = 0; i < listeNiveaux.GetNbrElements(); i++) {
                    lNiveau = lListeNiveauxDAcquisitions.GetElementParGenre(listeNiveaux.GetGenre(i));
                    lCouleur = EGenreNiveauDAcquisition.getCouleur(lNiveau);
                    lHtml.push('<div class="InlineBlock" style="width:2rem; height:2rem; border: 1px solid #343434; background-color:', lCouleur, '">&nbsp;</div>');
                }
                lHtml.push('</li>');
                return lHtml.join(lSeparateur);
            }
            lListeNiveauxDAcquisitions.setTri([
                ObjetTri.init('positionJauge')
            ]);
            lListeNiveauxDAcquisitions.trier();
            for (i = 0; i < n; i++) {
                lNiveau = lListeNiveauxDAcquisitions.GetElement(i);
                if (lNiveau.existeNumero()) {
                    lGenre = lNiveau.GetGenre();
                    if (avecAbsent || (lGenre !== EGenreNiveauDAcquisition.Absent && lGenre !== EGenreNiveauDAcquisition.NonEvalue)) {
                        lCouleur = EGenreNiveauDAcquisition.getCouleur(lNiveau);
                        lImage = EGenreNiveauDAcquisition.getImage(lNiveau, {
                            avecTitle: !hint
                        });
                        lNombre = listeNiveaux && listeNiveaux.GetElementParGenre(lGenre) ? listeNiveaux.GetElementParGenre(lGenre).nbr : 0;
                        lTotal += lNombre;
                        if (lNombre !== 0) {
                            lInfos.push({
                                nombre: lNombre,
                                couleur: lCouleur,
                                image: lImage
                            });
                        }
                    }
                }
            }
            if (lInfos.length) {
                lHtml.push('<li class="collection-header with-action white" style="padding:0.6rem 0.3rem 0.0rem 0.3rem; line-height:2.5rem;" onclick="' + this.Nom + '.surClicJaugeEvaluations(', aElem.Position, ')">');
                for (i = 0; i < lInfos.length; i++) {
                    lElt = lInfos[i];
                    if (pourPastille) {
                        lHtml.push('<div class="AlignementDroit EspaceDroit" style="width:', 100 / (n - 2), '%;" >');
                        if (!!lElt.nombre) {
                            lHtml.push('<div class="InlineBlock" style="margin-right: 5px;">', lElt.nombre, '</div><div class="InlineBlock">', lElt.image, '</div></div>');
                        } else {
                            lHtml.push('&nbsp;');
                        }
                        lHtml.push('</div>');
                    } else {
                        if (!!lElt.nombre) {
                            lHtml.push('<div class="InlineBlock" style="border:1px solid #343434; background-color:', lElt.couleur, '; width:', lElt.nombre * 100 / lTotal, '%; height: 2rem">&nbsp;</div>');
                        }
                    }
                }
                lHtml.push('</li>');
            }
            return lHtml.join('');
        };
        ObjetBulletinCompetences.prototype._estJaugeChronologique = function() {
            return this.donnees.maquette.genreJauge === TypeJaugeEvaluationBulletinCompetence.tJBC_Chronologique;
        };
        ObjetBulletinCompetences.prototype.surClickProchainElement = function(aNumeroElement, aEstSuivant, aEstBilanParMatiere) {
            var lIndiceElementActuel, lIndiceProchainElement, lNumeroProchainElement;
            for (var i = 0, lNbrElem = this.listeServices.GetNbrElements(); i < lNbrElem; i++) {
                if (aNumeroElement === this.listeServices.GetNumero(i)) {
                    lIndiceElementActuel = i;
                    if (!!aEstSuivant) {
                        lIndiceProchainElement = lIndiceElementActuel + 1 < this.listeServices.GetNbrElements() ? lIndiceElementActuel + 1 : 0;
                        lNumeroProchainElement = this.listeServices.GetNumero(lIndiceProchainElement);
                    } else {
                        lIndiceProchainElement = lIndiceElementActuel === 0 ? this.listeServices.GetNbrElements() - 1 : lIndiceElementActuel - 1;
                        lNumeroProchainElement = this.listeServices.GetNumero(lIndiceProchainElement);
                    }
                }
            }
            if (!!lNumeroProchainElement) {
                GInterface.updatePanelContent(this.composePanel(lNumeroProchainElement, aEstBilanParMatiere));
                $('#' + this.eltProg.escapeJQ()).children('ul').addClass("browser-default");
            }
        };
        ObjetBulletinCompetences.prototype.getImagePastille = function(aElement, aNumero) {
            if (!!aElement.listeColonnesTransv && aElement.listeColonnesTransv.GetNbrElements()) {
                var lHtml = [];
                var lCompetence = aElement.listeColonnesTransv.GetElementParNumero(aNumero),
                    lExisteUnNiveauAcqui = (!!lCompetence.niveauAcqui),
                    lAUnNiveauAcquiSaisi = lExisteUnNiveauAcqui && lCompetence.niveauAcqui.existeNumero(),
                    lAUnNiveauAcquiCalcule = (!!lCompetence.niveauAcquiCalc && lCompetence.niveauAcquiCalc.existeNumero());
                if (lExisteUnNiveauAcqui && lAUnNiveauAcquiCalcule) {
                    if (lAUnNiveauAcquiSaisi) {
                        lHtml.push('<div class="secondary-content">', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcqui), '</div>');
                    }
                    lHtml.push('<div class="secondary-content">', ' (', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcquiCalc), ')', '</div>');
                } else if (lAUnNiveauAcquiSaisi || lAUnNiveauAcquiCalcule) {
                    if (lAUnNiveauAcquiSaisi) {
                        lHtml.push('<div class="secondary-content">', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcqui), '</div>');
                    } else {
                        lHtml.push('<div class="secondary-content"', EGenreNiveauDAcquisition.getImage(lCompetence.niveauAcquiCalc), '</div>');
                    }
                }
                return lHtml.join('');
            } else {
                return false;
            }
        };
        ObjetBulletinCompetences.prototype.surClickElemDropDown = function(aNumOption) {
            $('#' + this.corpsDePage.escapeJQ()).html(this.composeCorpsDePage(this.estBilanParMatiere, aNumOption));
            this.setTitreBoutonCombo(aNumOption);
            this.fermerModaleListe();
        };
        ObjetBulletinCompetences.prototype.setTitreBoutonCombo = function(aNumOption) {
            var lHtml = [];
            var lTitreBouton = this.listeElementsCompetence.GetElementParNumero(aNumOption).Libelle;
            lHtml.push('<span>', lTitreBouton, '</span>');
            GHtml.setHtml(this.btnCombo, lHtml.join(''));
        };
        ObjetBulletinCompetences.prototype.surClicJaugeEvaluations = function(aPositionElement) {
            var lElement;
            for (var i = 0, lNbrElem = this.donnees.listeLignes.GetNbrElements(); i < lNbrElem; i++) {
                if (this.donnees.listeLignes.GetElement(i).Position === aPositionElement) {
                    lElement = this.donnees.listeLignes.GetElement(i);
                }
            }
            if (!!lElement && !!lElement.relationsESI && !!lElement.relationsESI.length) {
                new ObjetRequeteDetailEvaluationsCompetences(this, _surReponseRequeteDetailEvaluations.bind(null, lElement)).lancerRequete({
                    eleve: GEtatUtilisateur.getMembre(),
                    numRelESI: lElement.relationsESI
                });
            }
        };

        function _surReponseRequeteDetailEvaluations(aLigne, aJSON) {
            if (!!aLigne && !!aJSON) {
                var lHtml = [];
                lHtml.push('<ul class="collection with-header">');
                for (var i = 0, lNbrElem = aJSON.listeLignes.GetNbrElements(); i < lNbrElem; i++) {
                    var lElement = aJSON.listeLignes.GetElement(i);
                    if (lElement.GetGenre() === EGenreRessource.Aucune) {
                        lHtml.push('<li class="collection-header" style="border-bottom-color:#d1d1d1; background-color: #FFFFFF;">');
                        lHtml.push('<div class="InlineBlock left-align" style="width:80%; vertical-align:top;">', lElement.GetLibelle(), '</div>');
                        if (!!lElement.strCoef) {
                            lHtml.push('<div class="InlineBlock right-align" style="width:19%; vertical-align:top; padding-right:2px;">' + GTraductions.getValeur('competences.colonne.coef') + ' ' + lElement.strCoef, '</div>');
                        }
                        lHtml.push('</li>');
                    } else {
                        var lNiveauAcqui = lElement.niveauAcqu;
                        var lNiveauAcquiGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(lNiveauAcqui.GetGenre());
                        lHtml.push('<li class="collection-item">', '<div style="padding-right: 2.5rem;">', lElement.GetLibelle(), (!!lNiveauAcqui && !!lNiveauAcqui.observation ? ('<br/><span style="font-style: italic;">' + lNiveauAcqui.observation + '</span>') : ''), '</div>', '<div class="secondary-content" style="width: 2rem; text-align: center;', (!!GParametres.afficherAbbreviationNiveauDAcquisition ? 'right:0.9rem' : ''), '" >', EGenreNiveauDAcquisition.getImage(lNiveauAcquiGlobal), '</div>', '</li>');
                    }
                }
                lHtml.push('</ul>');
                var lModale = new FenetrePopUp_Mobile();
                lModale.openPopup({
                    titre: '<h1>' + aLigne.GetLibelle() + '</h1>',
                    contenu: lHtml.join('')
                });
            }
        }
        module.exports = ObjetBulletinCompetences;
    },
    fn: "pagebulletincompetences.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteBulletinCompetences() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('BulletinCompetences', ObjetRequeteBulletinCompetences, ObjetRequeteConsultation);
        ObjetRequeteBulletinCompetences.prototype.lancerRequete = function(aParam) {
            this.JSON = {
                classe: aParam.classe,
                periode: aParam.periode,
                eleve: aParam.eleve,
                bulletin: aParam.bulletin
            };
            return this.appelAsynchrone();
        };
        ObjetRequeteBulletinCompetences.prototype.actionApresRequete = function() {
            var posLSUNiveauGlobal;
            var lListeLignes = this.JSONReponse.listeLignes;
            if (lListeLignes) {
                lListeLignes.parcourir(function(aLigne) {
                    if (!!aLigne.posLSUNiveauP1) {
                        posLSUNiveauGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(aLigne.posLSUNiveauP1.GetGenre());
                        Object.assign(aLigne.posLSUNiveauP1, posLSUNiveauGlobal);
                    }
                    if (!!aLigne.posLSUNiveauP2) {
                        posLSUNiveauGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(aLigne.posLSUNiveauP2.GetGenre());
                        Object.assign(aLigne.posLSUNiveauP2, posLSUNiveauGlobal);
                    }
                    if (!!aLigne.posLSUNiveau) {
                        posLSUNiveauGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(aLigne.posLSUNiveau.GetGenre());
                        Object.assign(aLigne.posLSUNiveau, posLSUNiveauGlobal);
                    }
                    if (aLigne.listeColonnesTransv) {
                        var lNiveauGlobal;
                        aLigne.listeColonnesTransv.parcourir(function(aElementColonneTransv) {
                            if (!!aElementColonneTransv.niveauAcqui && aElementColonneTransv.niveauAcqui.existeNumero()) {
                                lNiveauGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(aElementColonneTransv.niveauAcqui.GetGenre());
                                Object.assign(aElementColonneTransv.niveauAcqui, lNiveauGlobal);
                            }
                            if (!!aElementColonneTransv.niveauAcquiCalc && aElementColonneTransv.niveauAcquiCalc.existeNumero()) {
                                lNiveauGlobal = GParametres.listeNiveauxDAcquisitions.GetElementParGenre(aElementColonneTransv.niveauAcquiCalc.GetGenre());
                                Object.assign(aElementColonneTransv.niveauAcquiCalc, lNiveauGlobal);
                            }
                        });
                    }
                });
            }
            this.callbackReussite.appel(this.JSONReponse);
        };
        module.exports = ObjetRequeteBulletinCompetences;
    },
    fn: "objetrequetebulletincompetences.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var TypeGenreBulletinCompetence = {
            tGBC_ParMatiere: 0,
            tGBC_Transversal: 1
        };
        module.exports.TypeGenreBulletinCompetence = TypeGenreBulletinCompetence;
    },
    fn: "typegenrebulletincompetence.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetBulletinCompetences = require('PageBulletinCompetences.js');
        var ObjetRequeteBulletinCompetences = require('ObjetRequeteBulletinCompetences.js');
        var MethodesObjet = require('MethodesObjet.js');
        var Identite = require('ObjetIdentite.js');
        var EStructureAffichage = require('Enumere_StructureAffichage.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreRessource = require('Enumere_Ressource.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var ObjetTabs = require('ObjetTabs.js');
        var GTraductions = require('ObjetTraduction.js');
        var TypeGenreBulletinCompetence = require('TypeGenreBulletinCompetence.js').TypeGenreBulletinCompetence;
        var UtilitaireCompetences_Mobile = require('UtilitaireCompetences_Mobile.js');
        var ObjetRequeteSaisieBulletinCompetences = require('ObjetRequeteSaisieBulletinCompetences.js');
        var ObjetBoutonFlottant = require('ObjetBoutonFlottant.js');
        var GenerationPDF = require('utilitairegenerationpdf.js');
        var OptionsPdf = require('OptionsPDFSco.js');
        var TypeHttpGenerationPDFSco = require('TypeHttpGenerationPDFSco.js').TypeHttpGenerationPDFSco;
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        MethodesObjet.heritagePrototype(ObjetAffichagePageBulletinCompetences_mobile, ObjetInterfacePage_Mobile);

        function ObjetAffichagePageBulletinCompetences_mobile() {
            this.inheritedCreate(arguments);
            this.listePeriodes = new ObjetListeElements();
            this.periodeCourant = new ObjetElement();
            this.indiceParDefaut = 0;
            this.idWrapper = this.Nom + '_wrapper';
            this.listeTabs = new ObjetListeElements();
            this.GenreStructure = EStructureAffichage.Autre;
            this.identBtnFlottant = null;
            this.avecGestionAccuseReception = (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent);
        }
        ObjetAffichagePageBulletinCompetences_mobile.prototype.getControleur = function(aInstance) {
            return {
                getIdentiteBouton: function() {
                    return {
                        class: ObjetBoutonFlottant,
                        pere: this,
                        init: function(aBtn) {
                            aInstance.identBtnFlottant = aBtn;
                            var lListeBtn = [];
                            if (GApplication.droits.get(TypeDroits.autoriserImpression)) {
                                lListeBtn.push({
                                    primaire: true,
                                    icone: "icon_pdf",
                                    callback: _genererPdf.bind(this)
                                });
                            }
                            lListeBtn.push({
                                icone: 'icon_diffuser_information large',
                                callback: aInstance.surClicLegende.bind(this, true)
                            });
                            aBtn.setOptionsBouton({
                                listeBoutons: lListeBtn
                            });
                        }
                    };
                }
            };
        };

        function _genererPdf() {
            var lParametrageAffichage = {
                genreGenerationPDF: TypeHttpGenerationPDFSco.BulletinDeCompetences,
                periode: GEtatUtilisateur.Navigation.GetRessource(EGenreRessource.Periode)
            };
            GenerationPDF.genererPDF({
                paramPDF: lParametrageAffichage,
                optionsPDF: OptionsPdf.BulletinDeCompetences
            });
        }
        ObjetAffichagePageBulletinCompetences_mobile.prototype.ConstruireInstances = function() {
            this.identSelection = this.Add(ObjetSelection, this.surSelectionPeriode);
            if (this.avecGestionAccuseReception) {
                this.identCbAccuseReception = this.Add(ObjetCheckBox, _surEvenementAccuseReception.bind(this));
            }
            this.identTabs = this.Add(ObjetTabs, null, _initialiserObjetTabs);
            this.identPageBilanParMatiere = this.Add(ObjetBulletinCompetences);
            var lObjElementParMatiere = new ObjetElement(GTraductions.getValeur('competences.BilanParMatiere'), null, TypeGenreBulletinCompetence.tGBC_ParMatiere);
            lObjElementParMatiere.Actif = false;
            lObjElementParMatiere.idDiv = this.GetInstance(this.identPageBilanParMatiere).GetNom();
            this.listeTabs.AddElement(lObjElementParMatiere);
            this.identPageBilanTransversal = this.Add(ObjetBulletinCompetences);
            var lObjElementBilanTransv = new ObjetElement(GTraductions.getValeur('competences.BilanTransversal'), null, TypeGenreBulletinCompetence.tGBC_Transversal);
            lObjElementBilanTransv.Actif = false;
            lObjElementBilanTransv.idDiv = this.GetInstance(this.identPageBilanTransversal).GetNom();
            this.listeTabs.AddElement(lObjElementBilanTransv);
            this.AddSurZone = [];
            this.AddSurZone.push(this.identSelection);
            if (!!this.identCbAccuseReception) {
                this.AddSurZone.push(this.identCbAccuseReception);
            }
            this.AddSurZone.push(this.identTabs);
        };
        ObjetAffichagePageBulletinCompetences_mobile.prototype.ConstruireStructureAffichageAutre = function() {
            var lHtml = [];
            lHtml.push('<div class="has-float-btn-bottom" id="', this.idWrapper, '">', '<div id="', this.GetInstance(this.identPageBilanParMatiere).GetNom(), '"></div>', '<div id="', this.GetInstance(this.identPageBilanTransversal).GetNom(), '"></div>', '</div>');
            if (!this.identBtnFlottant) {
                $("#" + GInterface.idZonePrincipale).IEHtmlAppend('<div class="is-sticky" ie-identite="getIdentiteBouton" ></div>', {
                    controleur: this.controleur,
                    avecCommentaireConstructeur: false
                });
            }
            return lHtml.join('');
        };
        ObjetAffichagePageBulletinCompetences_mobile.prototype.surClicLegende = function(avecNiveauxPositionnements) {
            UtilitaireCompetences_Mobile.openPopupDetailLegende(avecNiveauxPositionnements);
        };
        ObjetAffichagePageBulletinCompetences_mobile.prototype.RecupererDonnees = function() {
            var lOngletInfosPeriodes = GEtatUtilisateur.getOngletInfosPeriodes();
            this.listePeriodes = lOngletInfosPeriodes.listePeriodes;
            if (!(this.listePeriodes && this.listePeriodes.GetNbrElements())) {
                return '';
            } else {
                var lNrPeriodeParDefaut = GEtatUtilisateur.getPage() && GEtatUtilisateur.getPage().periode ? GEtatUtilisateur.getPage().periode.GetNumero() : lOngletInfosPeriodes.periodeParDefaut.GetNumero();
                this.indiceParDefaut = this.listePeriodes.GetIndiceParNumeroEtGenre(lNrPeriodeParDefaut);
                if (!this.indiceParDefaut) {
                    this.indiceParDefaut = 0;
                }
                this.periodeCourant = this.listePeriodes.GetElement(this.indiceParDefaut);
                this.GetInstance(this.identSelection).SetDonnees(this.listePeriodes, this.indiceParDefaut, null, '');
            }
        };
        ObjetAffichagePageBulletinCompetences_mobile.prototype.ActionSurRecupererDonnees = function(aIndiceBulletin, aParams) {
            this.maquetteBulletin = aParams.maquette;
            if (!this.maquetteBulletin) {
                this.listeTabs.GetElementParGenre(TypeGenreBulletinCompetence.tGBC_ParMatiere).Actif = true;
                this.listeTabs.GetElementParGenre(TypeGenreBulletinCompetence.tGBC_Transversal).Actif = false;
                this.GetInstance(this.identPageBilanParMatiere).SetMessage(aParams.Message);
                if (!!this.identCbAccuseReception) {
                    this.GetInstance(this.identCbAccuseReception).SetVisible(false);
                }
                this.identBtnFlottant.SetVisible(false);
            } else {
                var lBulletin = this.maquetteBulletin.listeBulletins.GetElement(aIndiceBulletin || 0);
                if (lBulletin && lBulletin.GetGenre() === TypeGenreBulletinCompetence.tGBC_ParMatiere) {
                    this.GetInstance(this.identPageBilanParMatiere).SetDonnees(aParams, true);
                    this.listeTabs.GetElementParGenre(TypeGenreBulletinCompetence.tGBC_ParMatiere).Actif = true;
                } else if (lBulletin && lBulletin.GetGenre() === TypeGenreBulletinCompetence.tGBC_Transversal) {
                    this.GetInstance(this.identPageBilanTransversal).SetDonnees(aParams, false);
                    this.listeTabs.GetElementParGenre(TypeGenreBulletinCompetence.tGBC_Transversal).Actif = true;
                    if (aIndiceBulletin === 0) {
                        this.listeTabs.GetElementParGenre(TypeGenreBulletinCompetence.tGBC_ParMatiere).Actif = false;
                    }
                }
                if (aIndiceBulletin < this.maquetteBulletin.listeBulletins.GetNbrElements() - 1) {
                    this.lancerRequete(++aIndiceBulletin);
                    return;
                }
                if (!!this.identCbAccuseReception) {
                    this.GetInstance(this.identCbAccuseReception).SetVisible(true);
                    var lCbAccuseReceptionValeur = false;
                    if (!!aParams.listeAccusesReception && aParams.listeAccusesReception.GetNbrElements() > 0) {
                        var lReponsableAccuseReception = aParams.listeAccusesReception.GetPremierElement();
                        if (!!lReponsableAccuseReception) {
                            lCbAccuseReceptionValeur = lReponsableAccuseReception.aPrisConnaissance;
                        }
                    }
                    this.GetInstance(this.identCbAccuseReception).SetDonnees(lCbAccuseReceptionValeur);
                }
                this.identBtnFlottant.SetVisible(true);
            }
            this.GetInstance(this.identTabs).setDonnees(this.listeTabs);
            var $wrapper = $('#' + this.idWrapper.escapeJQ());
            var $tailleLegende = 0;
            var $legende = $wrapper.siblings('footer');
            if ($legende.is(':visible')) {
                $tailleLegende = $legende.height();
            }
            $wrapper.css('margin-bottom', $tailleLegende + 'px');
        };
        ObjetAffichagePageBulletinCompetences_mobile.prototype.lancerRequete = function(aIndiceBulletin) {
            new ObjetRequeteBulletinCompetences(this, this.ActionSurRecupererDonnees.bind(this, aIndiceBulletin)).lancerRequete({
                classe: GEtatUtilisateur.getMembre().Classe,
                periode: this.periodeCourant,
                eleve: GEtatUtilisateur.getMembre(),
                bulletin: this.maquetteBulletin ? this.maquetteBulletin.listeBulletins.GetElement(aIndiceBulletin) : undefined
            });
        };
        ObjetAffichagePageBulletinCompetences_mobile.prototype.free = function() {
            this.inherited('free', arguments);
            if (this.identBtnFlottant) {
                $('#' + this.identBtnFlottant.GetNom().escapeJQ()).remove();
            }
        };

        function _surEvenementAccuseReception(aPrisConnaissance) {
            new ObjetRequeteSaisieBulletinCompetences(this).lancerRequete({
                aPrisConnaissance: aPrisConnaissance
            });
        }

        function _initialiserObjetTabs(aInstance) {
            aInstance.SetParametres({
                avecSwipe: false
            });
        }
        ObjetAffichagePageBulletinCompetences_mobile.prototype.surSelectionPeriode = function(aGenreEvenement, aParam) {
            this.periodeCourant = aParam.element;
            GEtatUtilisateur.Navigation.SetRessource(EGenreRessource.Periode, aParam.element);
            this.lancerRequete(TypeGenreBulletinCompetence.tGBC_ParMatiere);
        };
        MethodesObjet.heritagePrototype(ObjetCheckBox, Identite);

        function ObjetCheckBox() {
            this.inheritedCreate(arguments);
            this.estActif = false;
        }
        ObjetCheckBox.prototype.getControleur = function(aInstance) {
            return {
                cbAccuseReception: {
                    getValue: function() {
                        return aInstance.estActif;
                    },
                    setValue: function(aValue) {
                        aInstance.estActif = aValue;
                        aInstance.callback.appel(aInstance.estActif);
                    },
                    getDisabled: function() {
                        return aInstance.estActif;
                    }
                }
            };
        };
        ObjetCheckBox.prototype.SetDonnees = function(aEstActif) {
            this.estActif = aEstActif;
        };
        ObjetCheckBox.prototype.ConstruireAffichage = function() {
            var lHtml = [];
            lHtml.push('<div style="padding: 0.5rem;">', '<ie-checkbox ie-textright class="AlignementMilieuVertical" ie-model="cbAccuseReception">', GTraductions.getValeur('BulletinEtReleve.JAiPrisConnaissanceDuBilanPeriodique'), '</ie-checkbox>', '</div>');
            return lHtml.join('');
        };
        module.exports = ObjetAffichagePageBulletinCompetences_mobile;
    },
    fn: "mobile/script/interfacepagebulletincompetences.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreDocTelechargement = {
            certificat: 1,
            bulletin: 2,
            attestation: 3,
            documents: 4
        };
        module.exports = EGenreDocTelechargement;
    },
    fn: "enumere_doctelechargement.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var EGenreTriElement = require('Enumere_TriElement.js');
        var ObjetElement = require('ObjetElement.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var GenerationPDF = require('UtilitaireGenerationPDF.js');
        var TypeHttpGenerationPDFSco = require('TypeHttpGenerationPDFSco.js').TypeHttpGenerationPDFSco;
        var EGenreDocTelechargement = require('Enumere_DocTelechargement.js');

        function ObjetRequeteDocumentsATelecharger() {
            this.inheritedCreate.apply(this, arguments);
        }
        Requetes.inscrire('DocumentsATelecharger', ObjetRequeteDocumentsATelecharger, ObjetRequeteConsultation);
        ObjetRequeteDocumentsATelecharger.prototype.lancerRequete = function(aParam) {
            this.JSON = Object.assign({
                avecNotes: false,
                avecCompetences: false,
                listeElevesBIA: undefined
            }, aParam);
            if (this.JSON.listeElevesBIA && this.JSON.listeElevesBIA.setSerialisateurJSON) {
                this.JSON.listeElevesBIA.setSerialisateurJSON({
                    ignorerEtatsElements: true
                });
            }
            return this.appelAsynchrone();
        };
        ObjetRequeteDocumentsATelecharger.prototype.actionApresRequete = function() {
            var lListe = new ObjetListeElements(),
                lElement;
            if (this.JSONReponse.listeDocuments && this.JSONReponse.listeDocuments.GetNbrElements() > 0) {
                this.JSONReponse.listeDocuments.parcourir(function(aDocument) {
                    var lElement = new ObjetElement(aDocument.Libelle, aDocument.Numero);
                    lElement.annee = GParametres.PremiereDate.getFullYear();
                    lElement.typeDocument = EGenreDocTelechargement.documents;
                    lElement.event = function() {
                        GenerationPDF.genererPDF({
                            paramPDF: {
                                genreGenerationPDF: TypeHttpGenerationPDFSco.DocumentTelechargeable,
                                document: aDocument.toJSON()
                            }
                        });
                    };
                    lListe.AddElement(lElement);
                });
            }
            if (this.JSONReponse.listeDocumentsMembre && this.JSONReponse.listeDocumentsMembre.GetNbrElements() > 0) {
                this.JSONReponse.listeDocumentsMembre.parcourir(function(aDocument) {
                    var lElement = new ObjetElement(aDocument.Libelle, aDocument.Numero);
                    lElement.annee = GParametres.PremiereDate.getFullYear();
                    lElement.typeDocument = EGenreDocTelechargement.documents;
                    lElement.event = function() {
                        GenerationPDF.genererPDF({
                            paramPDF: {
                                genreGenerationPDF: TypeHttpGenerationPDFSco.DocumentTelechargeableMembre,
                                document: aDocument.toJSON()
                            }
                        });
                    };
                    lListe.AddElement(lElement);
                });
            }
            if (this.JSONReponse.listeBulletinsBIA && this.JSONReponse.listeBulletinsBIA.GetNbrElements() > 0) {
                this.JSONReponse.listeBulletinsBIA.parcourir(function(aBulletin) {
                    lElement = new ObjetElement();
                    lElement.typeDocument = EGenreDocTelechargement.bulletin;
                    lElement.bulletin = aBulletin;
                    lElement.annee = aBulletin.annee;
                    lElement.event = function() {
                        GenerationPDF.genererPDF({
                            paramPDF: {
                                genreGenerationPDF: TypeHttpGenerationPDFSco.BulletinBIA,
                                nomFichier: aBulletin.nomFichier,
                                ident: aBulletin.ident
                            }
                        });
                    };
                    lListe.AddElement(lElement);
                });
            }
            if (this.JSONReponse.listeAttestations && this.JSONReponse.listeAttestations.GetNbrElements() > 0) {
                this.JSONReponse.listeAttestations.parcourir(function(aAttestation) {
                    lElement = new ObjetElement();
                    lElement.typeDocument = EGenreDocTelechargement.attestation;
                    lElement.abbreviation = aAttestation.abbreviation;
                    if (aAttestation.date) {
                        lElement.date = aAttestation.date;
                        lElement.annee = aAttestation.date.getFullYear();
                        lElement.event = function() {
                            GenerationPDF.genererPDF({
                                paramPDF: {
                                    genreGenerationPDF: TypeHttpGenerationPDFSco.Attestation,
                                    attestation: aAttestation
                                }
                            });
                        };
                        lListe.AddElement(lElement);
                    }
                });
            }
            lListe.setTri([
                ObjetTri.init('annee', EGenreTriElement.Decroissant), ObjetTri.init('debutPeriodeNotation'), ObjetTri.init('libelleClasse'), ObjetTri.init('Libelle')
            ]).trier();
            this.callbackReussite.appel({
                liste: lListe
            });
        };
        module.exports = ObjetRequeteDocumentsATelecharger;
    },
    fn: "objetrequetedocumentsatelecharger.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var ObjetInterfacePage_Mobile = require('InterfacePage_Mobile.js');
        var GTraductions = require('ObjetTraduction.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var ObjetRequeteDocumentsATelecharger = require('ObjetRequeteDocumentsATelecharger.js');
        var EGenreDocTelechargement = require('Enumere_DocTelechargement.js');
        var GDate = require('ObjetDate.js').GDate;
        var ObjetSelection = require('ObjetSelection.js').ObjetSelection;
        var EGenreEspace = require('Enumere_Espace.js');
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');
        var ObjetTri = require('ObjetTri.js').ObjetTri;
        var ObjetDonneesListe = require('ObjetDonneesListe.js');
        var EGenreEvenementListe = require('Enumere_EvenementListe.js');
        var ObjetListeElements = require('ObjetListeElements.js');
        Requetes.inscrire('ListeElevesBIA', ObjetRequeteConsultation);

        function InterfaceDocumentsATelecharger_Mobile() {
            this.inheritedCreate(arguments);
            this.avecSelecteurEleve = GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Professeur;
        }
        MethodesObjet.heritagePrototype(InterfaceDocumentsATelecharger_Mobile, ObjetInterfacePage_Mobile);
        InterfaceDocumentsATelecharger_Mobile.prototype.ConstruireInstances = function() {
            if (this.avecSelecteurEleve) {
                this.identSelection = this.Add(ObjetSelection, _evenementSelection);
                this.AddSurZone = [this.identSelection];
            }
            this.identListe = this.Add(require('ObjetListe.js'), function(aParametres) {
                if (aParametres.genreEvenement === EGenreEvenementListe.SelectionClick && aParametres.article.event) {
                    aParametres.article.event();
                }
            }, function(aInstance) {
                aInstance.setOptionsListe({
                    colonnes: [{
                        taille: '100%'
                    }]
                });
            });
        };

        function _evenementSelection(aGenreEvenement, aParam) {
            _requeteDocuments.call(this, aParam.element.listeElevesBIA);
        }
        InterfaceDocumentsATelecharger_Mobile.prototype.ConstruireAffichage = function() {
            if (this.listeDocs) {
                return '<div id="' + this.GetInstance(this.identListe).Nom + '"></div>';
            }
            return '';
        };

        function _requeteDocuments(aListeElevesBIA) {
            this.listeDocs = null;
            return new ObjetRequeteDocumentsATelecharger(this).lancerRequete({
                avecNotes: MethodesTableau.existe(GEtatUtilisateur.getGenreOnglet(), [EGenreOnglet.BulletinAnneesPrec_Note, EGenreOnglet.DocumentsATelecharger]),
                avecCompetences: MethodesTableau.existe(GEtatUtilisateur.getGenreOnglet(), [EGenreOnglet.BulletinAnneesPrec_Competence, EGenreOnglet.DocumentsATelecharger]),
                listeElevesBIA: aListeElevesBIA
            }).then(function(aDonnees) {
                this.listeDocs = aDonnees.liste;
            }.bind(this)).catch(function() {}).then(function() {
                this.Afficher();
                if (this.listeDocs && this.listeDocs.GetNbrElements() === 0) {
                    this.GetInstance(this.identListe).Afficher(this.composeAucuneDonnee(GTraductions.getValeur('DocumentsATelecharger.Aucun')));
                } else {
                    this.GetInstance(this.identListe).SetDonnees(new DonneesListe_DocumentsATelechargerMobile(this.listeDocs));
                }
            }.bind(this));
        }
        InterfaceDocumentsATelecharger_Mobile.prototype.RecupererDonnees = function() {
            this.listeDocs = null;
            if (this.GetInstance(this.identSelection)) {
                return Requetes('ListeElevesBIA', this).lancerRequete().then(function(aJSON) {
                    var lListe = aJSON.liste || new ObjetListeElements();
                    lListe.parcourir(function(aEleve) {
                        aEleve.Libelle = aEleve.nom + ' ' + aEleve.prenom;
                    }).setTri([
                        ObjetTri.init('nom'), ObjetTri.init('prenom')
                    ]).trier();
                    this.GetInstance(this.identSelection).SetVisible(lListe.GetNbrElements() > 0);
                    if (lListe.GetNbrElements() === 0) {
                        this.GetInstance(this.identListe).Afficher(this.composeAucuneDonnee(GTraductions.getValeur('DocumentsATelecharger.Aucun')));
                    } else {
                        this.GetInstance(this.identSelection).SetDonnees(lListe, 0, '', '');
                    }
                }.bind(this));
            } else {
                return _requeteDocuments.call(this);
            }
        };

        function DonneesListe_DocumentsATelechargerMobile(aDonnees) {
            this.inheritedCreate(aDonnees);
            this.setOptions({
                avecEvnt_SelectionClick: true
            });
        }
        MethodesObjet.heritagePrototype(DonneesListe_DocumentsATelechargerMobile, ObjetDonneesListe);
        DonneesListe_DocumentsATelechargerMobile.prototype.GetValeur = function(I, D, aParams) {
            var H = ['<div class="InlineBlock Image_IconePdf"></div>', '<div class="InlineBlock GrandEspaceGauche">'];
            var lTitre1 = '';
            var lTitre2 = '';
            switch (aParams.article.typeDocument) {
                case EGenreDocTelechargement.documents:
                    lTitre1 = aParams.article.Libelle;
                    lTitre2 = aParams.article.annee + ' - ' + (aParams.article.annee + 1);
                    break;
                case EGenreDocTelechargement.bulletin:
                    lTitre1 = aParams.article.bulletin.libelle + ' - ' + aParams.article.bulletin.libellePeriodeNotation + ' - ' + aParams.article.bulletin.libelleClasse;
                    lTitre2 = aParams.article.annee + ' - ' + (aParams.article.annee + 1);
                    break;
                case EGenreDocTelechargement.attestation:
                    lTitre1 = aParams.article.abbreviation + ' - ' + GDate.FormatDate(aParams.article.date, "%JJ/%MM/%AAAA");
                    lTitre2 = aParams.article.annee + ' - ' + (aParams.article.annee + 1);
                    break;
                default:
                    ;
            }
            H.push('<div>', lTitre1 || '', '</div>', '<div>', lTitre2 || '', '</div>', '</div>');
            return H.join('');
        };
        DonneesListe_DocumentsATelechargerMobile.prototype.GetCouleurCellule = function() {
            return ObjetDonneesListe.ECouleurCellule.Blanc;
        };
        module.exports = InterfaceDocumentsATelecharger_Mobile;
    },
    fn: "interfacedocumentsatelecharger_mobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var DeclarationOngletsMobile = {};
        DeclarationOngletsMobile.getClassOnglet = function(aGenreOnglet) {
            switch (aGenreOnglet) {
                case EGenreOnglet.Accueil:
                    return require('mobile/script/InterfacePageAccueil.js');
                case EGenreOnglet.MenuOnglets:
                    return require('InterfacePageMenuOnglets.js');
                case EGenreOnglet.EmploiDuTemps:
                case EGenreOnglet.EmploiDuTempsEleve:
                case EGenreOnglet.EmploiDuTempsClasse:
                    return require('InterfacePageEmploiDuTemps_Mobile.js');
                case EGenreOnglet.CDT_TAF:
                    return GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimEleve || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimParent || GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimAccompagnant ? require('InterfacePageCahierDeTextePP_Mobile.js') : require('InterfacePageCahierDeTexte_Mobile.js');
                case EGenreOnglet.CDT_Contenu:
                    return require('InterfacePageCahierDeTexte_Mobile.js');
                case EGenreOnglet.ManuelsNumeriques:
                    return require('InterfaceManuelsNumeriques_Mobile.js');
                case EGenreOnglet.Bulletins:
                    return require('InterfacePageBulletin.js');
                case EGenreOnglet.EquipePedagogique:
                    return require('mobile/script/InterfacePageEquipePedagogique.js');
                case EGenreOnglet.Releve:
                    return require('InterfacePageReleveDeNotes.js');
                case EGenreOnglet.Menus:
                    return require('InterfacePageMenus_Mobile.js');
                case EGenreOnglet.SaisieAbsences_AppelEtSuivi:
                    return require('InterfacePageFeuilleAppel.js');
                case EGenreOnglet.QCM_Reponse:
                    return require('InterfacePageQCM.js');
                case EGenreOnglet.Informations:
                    return require('mobile/script/InterfacePageActualites.js');
                case EGenreOnglet.Messagerie:
                    return require('mobile/script/InterfacePageMessagerie.js');
                case EGenreOnglet.ListeEleves:
                    return require('mobile/script/InterfaceTrombi_Mobile.js');
                case EGenreOnglet.ParametresUtilisateur:
                    return require('mobile/script/InterfacePageParametres.js');
                case EGenreOnglet.CompteEleve:
                    return require('mobile/script/InterfacePageParametresEnfants.js');
                case EGenreOnglet.InfosPerso:
                    return require('mobile/script/InterfacePageCompte.js');
                case EGenreOnglet.Agenda:
                    return require('mobile/script/InterfacePageAgenda.js');
                case EGenreOnglet.Rencontre:
                    return require('mobile/script/InterfacePageRencontres.js');
                case EGenreOnglet.DernieresNotes:
                    return require('mobile/script/InterfacePageDernieresNotes.js');
                case EGenreOnglet.DernieresEvaluations:
                    return require('mobile/script/InterfacePageDernieresEvaluations_Mobile.js');
                case EGenreOnglet.VieScolaire_Recapitulatif:
                    return require('InterfacePagePresenceRecap_Mobile.js');
                case EGenreOnglet.ReleveDeCompetences:
                case EGenreOnglet.BulletinCompetences:
                    return require('mobile/script/InterfacePageBulletinCompetences.js');
                case EGenreOnglet.BulletinAnneesPrec_Note:
                case EGenreOnglet.BulletinAnneesPrec_Competence:
                case EGenreOnglet.DocumentsATelecharger:
                    return require('InterfaceDocumentsATelecharger_Mobile.js');
                case EGenreOnglet.Incidents:
                    return require('mobile/script/InterfacePageIncidents_Mobile.js');
                case EGenreOnglet.TableauDeBord:
                    return require('mobile/script/InterfaceTableauDeBordMobile.js');
                case EGenreOnglet.SaisieNotes:
                    return require('mobile/script/InterfacePageNotes.js');
                case EGenreOnglet.SaisieOrientation:
                    return require('mobile/script/InterfacePageOrientation.js');
                case EGenreOnglet.SaisieCahierDeTextes:
                    return require('mobile/script/InterfacePageSaisieCahierDeTextes.js');
                default:
                    ;
                    return null;
            }
        };
        module.exports = DeclarationOngletsMobile;
    },
    fn: "declarationongletsmobile.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var ObjetIdentite = require('ObjetIdentite.js');
        var GTraductions = require('ObjetTraduction.js');
        var IELocalStorage = require('LocalStorage.js');
        require('espace/css/ObjetBandeauPied.css');
        var lCleLocalStorage = "etatAffichageFooter";
        MethodesObjet.heritagePrototype(_ObjetAffichageBandeauPied, ObjetIdentite);

        function _ObjetAffichageBandeauPied() {
            this.inheritedCreate(arguments);
            this.hauteur = 20;
            this.genreCommande = {
                twitter: 'twitter',
                aide: 'aide',
                forum: 'forum',
                videos: 'videos',
                profil: 'pageprofil'
            };
            this.options = {};
        }
        _ObjetAffichageBandeauPied.prototype.ConstruireInstances = function() {
            this.identCommande = this.Add(this.getObjetCommande(), this.EvenementBouton);
        };
        _ObjetAffichageBandeauPied.prototype.avecAide = function() {};
        _ObjetAffichageBandeauPied.prototype.getObjetCommande = function() {};
        _ObjetAffichageBandeauPied.prototype.getCommande = function() {};
        _ObjetAffichageBandeauPied.prototype.getControleur = function(aInstance) {
            return {
                btnPied: {
                    event: function(aGenre) {
                        this.instance.EvenementBouton({
                            genreCmd: aGenre
                        });
                    }
                },
                nodePied: function(aGenre) {
                    $(this.node).on({
                        click: function() {
                            aInstance.EvenementBouton({
                                genreCmd: aGenre
                            });
                        }
                    });
                },
                showPied: function() {
                    $(this.node).on({
                        click: function() {
                            aInstance.masquerFooter = !aInstance.masquerFooter;
                            IELocalStorage.setItem(lCleLocalStorage + "_" + GEtatUtilisateur.GenreEspace, aInstance.masquerFooter);
                            _showHideFooter.call(this, aInstance.masquerFooter);
                        }
                    });
                }
            };
        };
        _ObjetAffichageBandeauPied.prototype.avecTwitter = function() {
            return false;
        };
        _ObjetAffichageBandeauPied.prototype.avecBoutonAideContextuelle = function() {
            return false;
        };
        _ObjetAffichageBandeauPied.prototype.avecBoutonAccesProfil = function() {
            return false;
        };
        _ObjetAffichageBandeauPied.prototype.avecBoutonPersonnaliseProduit = function() {
            return false;
        };
        _ObjetAffichageBandeauPied.prototype.espacesISO27001 = function() {
            return false;
        };
        _ObjetAffichageBandeauPied.prototype.composeBoutonPersonnaliseProduit = function() {};
        _ObjetAffichageBandeauPied.prototype.EvenementBouton = function(aParam, aGenreBouton) {
            if (aGenreBouton !== 1) {
                this.callback.appel(aParam);
            }
        };
        _ObjetAffichageBandeauPied.prototype.SetDonnees = function(aParam) {
            if (!!aParam) {
                this.setOptions(aParam);
            }
            this.Afficher(this.ComposePage());
        };

        function _composeAffichage() {
            var H = [];
            H.push('<footer role="contentinfo" class="ObjetBandeauPied ' + (this.avecBoutonPersonnaliseProduit() ? ' bpp-canope' : '') + '">', '<div class="footer-toggler icon_angle_down" ie-node="showPied()"></div>');
            if (!!this.options.logoDepartementImage) {
                H.push('<div class="ibp-logo-conteneur">', '<a ', (this.options.logoDepartementLien ? 'href="' + this.options.logoDepartementLien + '"' : ''), ' target="_blank" tabindex="-1" class="ibp-logo">', '<img src="', this.options.logoDepartementImage, '" alt="" onerror="$(this).parent().remove();" />', '</a>', '<hr />', '</div>');
            }
            var lAvecLibelleHeberge = this.options.siteIndex && this.options.estHebergeEnFrance;
            H.push('<div class="ibp-bloc-left' + (!lAvecLibelleHeberge ? ' bloc-unique' : '') + '">');
            if (this.avecTwitter()) {
                H.push('<ie-btnimage ie-model="btnPied(' + this.getCommande(this.genreCommande.twitter) + ')" class="icon_twitter btnImageIcon ibp-command" title="' + GTraductions.getValeur('Commande.SuivrePronoteTwitter.Actif') + '">' + '</ie-btnimage>', '<hr />');
            }
            if (this.options.mention) {
                H.push('<a class="ibp-command" href="', this.options.mention, '" target="_blank">', GTraductions.getValeur('mentionsLegales'), '</a>');
                if (lAvecLibelleHeberge) {
                    H.push('<hr />');
                }
            }
            H.push('</div>');
            if (lAvecLibelleHeberge) {
                H.push('<div role="img" tabIndex="0" class="host-france-container ibp-command" onclick="window.open (\'', this.options.siteIndex, '\');"  aria-label="', GTraductions.getValeur('PiedPage.hebergementDonneesFrance') + ' ' + GTraductions.getValeur('PiedPage.certifISO27001'), '">', '<span class="host-text">', GTraductions.getValeur('PiedPage.hebergementDonneesFrance'), '</span>', '<span class="logo-index-inverse"></span>', (this.espacesISO27001() ? '<span class="certif-27001">' + GTraductions.getValeur('PiedPage.certifISO27001') + '</span>' : ''), '</div>');
            }
            H.push('<div class="knowledge-container">');
            if (this.avecBoutonPersonnaliseProduit()) {
                H.push(this.composeBoutonPersonnaliseProduit());
            }
            if (this.avecBoutonAccesProfil()) {
                H.push('<div class="ibp-pill icon_light_bulb" role="button" tabIndex="0" ie-node="nodePied(' + this.getCommande(this.genreCommande.profil) + ')" ie-hint="', GTraductions.getValeur('PiedPage.toutSavoirPronote'), ' : ', GTraductions.getValeur('PiedPage.tutosForumQCM'), '">', '<div class="kb-conteneur">', '<p class="as-title">', GTraductions.getValeur('PiedPage.toutSavoirPronote'), '</p>', '<p>', GTraductions.getValeur('PiedPage.tutosForumQCM'), '</p>', '</div>', '</div>');
            }
            if (this.avecBoutonAideContextuelle()) {
                H.push('<div class="ibp-pill icon_question" role="button" tabIndex="0" ie-node="nodePied(' + this.getCommande(this.genreCommande.aide) + ')"  ie-hint="', GTraductions.getValeur('Commande.Aide.Actif'), '"><p class="help-text">', GTraductions.getValeur('Commande.Aide.Actif'), '</p></div>');
            }
            H.push('</div>');
            H.push('</footer>');
            return H.join('');
        }
        _ObjetAffichageBandeauPied.prototype.ComposePage = function() {
            var lHtml = [];
            this.masquerFooter = this.MasquerBandeauPied();
            lHtml.push(_composeAffichage.call(this));
            return lHtml.join('');
        };

        function _showHideFooter(aMasquerPied) {
            var lParentContainer = $(this).closest('.interface_affV');
            var lFooterWrapper = lParentContainer.find('.footer-wrapper');
            if (aMasquerPied) {
                lFooterWrapper.toggleClass('opened closed');
                lParentContainer.removeClass('with-footer').addClass('no-footer');
            } else {
                lFooterWrapper.toggleClass('closed opened');
                lParentContainer.removeClass('no-footer').addClass('with-footer');
            }
            $(window).resize();
        }
        _ObjetAffichageBandeauPied.prototype.MasquerBandeauPied = function() {
            return (IELocalStorage.getItem(lCleLocalStorage + "_" + GEtatUtilisateur.GenreEspace) === 'true');
        };
        module.exports = _ObjetAffichageBandeauPied;
    },
    fn: "_interfacebandeaupied.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var GTraductions = require('ObjetTraduction.js');
        var EGenreCommande = {
            ChangerRessource: 0,
            Impression: 1,
            Validation: 2,
            Aide: 4,
            Communication: 5,
            ChangerOnglet: 6,
            AccesMobile: 7,
            O365_OWA: 8,
            O365_OneDrive: 9,
            Accueil: 12,
            Tutoriel: 14,
            Twitter: 16,
            CompteEnfant: 19,
            O365_Portail: 21,
            O365_Word: 22,
            O365_Excel: 23,
            O365_Ppt: 24,
            O365_Tutoriel: 26,
            O365_Tuto_Office: 27,
            O365_Tuto_OneDrive: 28,
            O365_Partages: 29,
            Forum: 30,
            CloudIndex: 31,
            Videos: 32,
            Profil: 33
        };
        EGenreCommande.getLibelle = function(aGenre) {
            var lClef;
            switch (aGenre) {
                case this.O365_Portail:
                    lClef = 'Commande.O365_Portail';
                    break;
                case this.O365_OWA:
                    lClef = 'Commande.O365_OWA';
                    break;
                case this.O365_OneDrive:
                    lClef = 'Commande.O365_OneDrive';
                    break;
                case this.O365_Word:
                    lClef = 'Commande.O365_Word';
                    break;
                case this.O365_Ppt:
                    lClef = 'Commande.O365_Ppt';
                    break;
                case this.O365_Excel:
                    lClef = 'Commande.O365_Excel';
                    break;
                case this.O365_Tutoriel:
                    lClef = 'Commande.O365_Tutoriel';
                    break;
                case this.O365_Tuto_Office:
                    lClef = 'Commande.O365_tuto_office';
                    break;
                case this.O365_Tuto_OneDrive:
                    lClef = 'Commande.O365_tuto_onedrive';
                    break;
                case this.O365_Partages:
                    lClef = 'Commande.O365_Partages';
                    break;
                default:
                    return '';
            }
            return GTraductions.getValeur(lClef);
        };
        EGenreCommande.estCmdO365 = function(aGenre) {
            switch (aGenre) {
                case this.O365_Portail:
                case this.O365_OWA:
                case this.O365_OneDrive:
                case this.O365_Word:
                case this.O365_Ppt:
                case this.O365_Excel:
                    return true;
                default:
                    return false;
            }
        };
        EGenreCommande.getServiceO365 = function(aGenre) {
            switch (aGenre) {
                case this.O365_Portail:
                    return 'O365_PORTAIL';
                case this.O365_OWA:
                    return 'O365_OWA';
                case this.O365_OneDrive:
                    return 'O365_ONEDRIVE';
                case this.O365_Word:
                    return 'O365_WORD';
                case this.O365_Ppt:
                    return 'O365_PPT';
                case this.O365_Excel:
                    return 'O365_EXCEL';
                default:
                    return 'O365_PORTAIL';
            }
        };
        EGenreCommande.estLienO365 = function(aGenre) {
            switch (aGenre) {
                case this.O365_Tutoriel:
                case this.O365_Tuto_Office:
                case this.O365_Tuto_OneDrive:
                    return true;
                default:
                    return false;
            }
        };
        EGenreCommande.estPartageO365 = function(aGenre) {
            switch (aGenre) {
                case this.O365_Partages:
                    return true;
                default:
                    return false;
            }
        };
        module.exports = EGenreCommande;
    },
    fn: "enumere_commande.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var MethodesObjet = require('MethodesObjet.js');
        var _ObjetAffichageBandeauPied = require('_InterfaceBandeauPied.js');
        var EGenreCommande = require('Enumere_Commande.js');
        var TypeDroits = require('ObjetDroitsPN.js').TypeDroits;
        var EGenreEspace = require('Enumere_Espace.js');
        var GTraductions = require('ObjetTraduction.js');
        var MethodesTableau = require('MethodesTableau.js');
        MethodesObjet.heritagePrototype(ObjetAffichageBandeauPied, _ObjetAffichageBandeauPied);

        function ObjetAffichageBandeauPied() {
            this.inheritedCreate(arguments);
            this.options = {
                mention: GParametres.lienMentions,
                siteIndex: GParametres.urlSiteIndexEducation || 'https://www.index-education.com',
                logoProduitCss: GParametres.logoProduitCss || '',
                logoDepartementImage: GParametres.logoDepartementImage,
                logoDepartementLien: GParametres.logoDepartementLien,
                estHebergeEnFrance: GParametres.estHebergeEnFrance
            };
        }
        ObjetAffichageBandeauPied.prototype.getControleur = function() {
            return {
                nodeCanope: function() {
                    $(this.node).on({
                        click: function() {
                            window.open(GParametres.urlCanope);
                        }
                    });
                }
            };
        };
        ObjetAffichageBandeauPied.prototype.getCommande = function(aGenreCommande) {
            switch (aGenreCommande) {
                case this.genreCommande.aide:
                    return EGenreCommande.Aide;
                case this.genreCommande.forum:
                    return EGenreCommande.Forum;
                case this.genreCommande.twitter:
                    return EGenreCommande.Twitter;
                case this.genreCommande.videos:
                    return EGenreCommande.Videos;
                case this.genreCommande.profil:
                    return EGenreCommande.Profil;
                case this.genreCommande.communication:
                    return EGenreCommande.Communication;
                default:
                    return false;
            }
        };
        ObjetAffichageBandeauPied.prototype.getObjetCommande = function() {
            return true;
        };
        ObjetAffichageBandeauPied.prototype.EvenementBouton = function(aParam) {
            if (aParam.genreCmd === this.getCommande(this.genreCommande.twitter)) {
                if (!!GParametres.urlAccesTwitter) {
                    window.open(GParametres.urlAccesTwitter);
                }
                return;
            }
            return this.inherited('EvenementBouton', arguments);
        };
        ObjetAffichageBandeauPied.prototype.avecTwitter = function() {
            return GApplication.droits.get(TypeDroits.fonctionnalites.gestionTwitter) && !!GParametres.urlAccesTwitter;
        };
        ObjetAffichageBandeauPied.prototype.avecBoutonAideContextuelle = function() {
            return !IE.estMobile && !GEtatUtilisateur.pourPrimaire();
        };
        ObjetAffichageBandeauPied.prototype.avecBoutonAccesProfil = function() {
            return true;
        };
        _ObjetAffichageBandeauPied.prototype.avecBoutonPersonnaliseProduit = function() {
            return (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Professeur, EGenreEspace.Mobile_Professeur, EGenreEspace.PrimProfesseur, EGenreEspace.Mobile_PrimProfesseur])) && GParametres.estHebergeEnFrance && !!GParametres.urlCanope;
        };
        _ObjetAffichageBandeauPied.prototype.composeBoutonPersonnaliseProduit = function() {
            var H = [];
            H.push('<div class="ibp-pill partenaire-canope" ie-node="nodeCanope" ie-hint="', GTraductions.getValeur('PiedPage.Canope'), '"><ie-btnimage class="btnImageIcon Image_Partenaire_Canope" role="button" aria-label="', GTraductions.getValeur('PiedPage.Canope'), '"></ie-btnimage></div>');
            return H.join('');
        };
        _ObjetAffichageBandeauPied.prototype.espacesISO27001 = function() {
            return !GEtatUtilisateur.pourPrimaire();
        };
        module.exports = ObjetAffichageBandeauPied;
    },
    fn: "interfacebandeaupied.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        var ObjetRequeteConsultation = require('ObjetRequeteJSON.js').ObjetRequeteConsultation;
        var Requetes = require('CollectionRequetes.js');

        function ObjetRequeteAccesSecurisePageProfil() {
            this.inheritedCreate(arguments);
        }
        Requetes.inscrire('AccesSecurisePageProfil', ObjetRequeteAccesSecurisePageProfil, ObjetRequeteConsultation);
        ObjetRequeteAccesSecurisePageProfil.prototype.lancerRequete = function(aParam) {
            this.JSON = aParam;
            return this.appelAsynchrone();
        };
        ObjetRequeteAccesSecurisePageProfil.prototype.actionApresRequete = function() {
            this.callbackReussite.appel(this.JSONReponse.titre, this.JSONReponse.message, this.JSONReponse.url);
        };
        module.exports = ObjetRequeteAccesSecurisePageProfil;
    },
    fn: "objetrequeteaccessecurisepageprofil.js"
});;
IE.fModule({
    f: function(exports, require, module, global) {
        require('mobile/script/ObjetEntete.js');
        require('UtilitaireQCM_Mobile.js');
        require('IEHtml.SelecFile.js');
        require('IEHtml.Combo.js');
        var MethodesObjet = require('MethodesObjet.js');
        var MethodesTableau = require('MethodesTableau.js');
        var GTraductions = require('ObjetTraduction.js');
        var _ObjetInterfaceMobile = require('_InterfaceMobile.js');
        var EGenreCommandeMobile = require('_ObjetEntete.js').EGenreCommandeMobile;
        var GDate = require('ObjetDate.js').GDate;
        var ObjetListeElements = require('ObjetListeElements.js');
        var EGenreEspace = require('Enumere_Espace.js');
        var EGenreOnglet = require('Enumere_Onglet.js');
        var UtilitaireContactVieScolaire_Mobile = require('UtilitaireContactVieScolaire_Mobile.js');
        var GThemesPrimaire = require('ThemesPrimaire.js').GThemesPrimaire;
        var ControleSaisieEvenement = require('ControleSaisieEvenement.js');
        var DeclarationOngletsMobile = require('DeclarationOngletsMobile.js');
        var TypeEtatExecutionQCMPourRepondant = require('TypeEtatExecutionQCMPourRepondant.js').TypeEtatExecutionQCMPourRepondant;
        var InterfaceBandeauPied = require('InterfaceBandeauPied.js');
        var EGenreCommande = require('Enumere_Commande.js');
        var EGenreBoiteMessage = require('Enumere_BoiteMessage.js');
        var TUtilitairePartenaire = require('UtilitairePartenaire.js');
        MethodesObjet.heritagePrototype(ObjetInterfaceMobile, _ObjetInterfaceMobile);

        function ObjetInterfaceMobile() {
            this.inheritedCreate(arguments);
            this.GenreOnglet = EGenreOnglet.Accueil;
            this.genreOngletPrecedent = null;
            this.OngletsAvecRessourceParent = [EGenreOnglet.Accueil, EGenreOnglet.EmploiDuTemps, EGenreOnglet.ListeEleves, EGenreOnglet.CDT_Contenu, EGenreOnglet.CDT_TAF, EGenreOnglet.Releve, EGenreOnglet.Rencontre, EGenreOnglet.Messagerie, EGenreOnglet.Bulletins, EGenreOnglet.EquipePedagogique, EGenreOnglet.DernieresNotes, EGenreOnglet.VieScolaire_Recapitulatif, EGenreOnglet.DocumentsATelecharger, EGenreOnglet.BulletinCompetences, EGenreOnglet.ReleveDeCompetences, EGenreOnglet.BulletinAnneesPrec_Note, EGenreOnglet.BulletinAnneesPrec_Competence, EGenreOnglet.DernieresEvaluations, EGenreOnglet.SaisieOrientation];
            this.OngletsAvecRessourceEtablissement = [EGenreOnglet.EmploiDuTempsClasse, EGenreOnglet.ListeEleves];
        }(function() {
            ObjetInterfaceMobile.prototype.ouvrirPremierOngletPublie = function() {
                var LGenreActif = [],
                    lOngletTest = null,
                    lOnglet = null;
                var i;
                for (i = 0; i < GEtatUtilisateur.listeOnglets.GetNbrElements(); i++) {
                    lOngletTest = GEtatUtilisateur.listeOnglets.GetElement(i);
                    if (!MethodesTableau.existe(lOngletTest.GetGenre(), GEtatUtilisateur.listeOngletsInvisibles) && lOngletTest.GetGenre() !== EGenreOnglet.Accueil) {
                        LGenreActif.push(lOngletTest.GetGenre());
                        if (lOngletTest.onglet && $.isNumeric(lOngletTest.onglet.GetGenre()) && $.inArray(lOngletTest.onglet.GetGenre(), LGenreActif) > -1) {
                            LGenreActif.splice($.inArray(lOngletTest.onglet.GetGenre(), LGenreActif), 1);
                        }
                    }
                }
                for (i = 0; i < LGenreActif.length; i++) {
                    if (!MethodesTableau.existe(LGenreActif[i], GEtatUtilisateur.listeOngletsInvisibles) && LGenreActif[i] !== EGenreOnglet.Accueil) {
                        lOnglet = GEtatUtilisateur.listeOnglets.GetElementParGenre(LGenreActif[i]);
                        break;
                    }
                }
                if ((lOnglet !== null && lOnglet !== undefined)) {
                    this.evenementSurOnglet(lOnglet.GetGenre(), true, true);
                } else {
                    this.GetInstance(this.identPageMobile).effacer();
                    this.Instances[this.identEnteteMobile].actualiserTitre();
                    this.Instances[this.idMenuOnglets].actualiserTitre();
                }
            };
            ObjetInterfaceMobile.prototype.SetDonnees = function() {
                if (!GEtatUtilisateur.avecPageAccueil()) {
                    this.ouvrirPremierOngletPublie();
                }
                if (UtilitaireContactVieScolaire_Mobile) {
                    UtilitaireContactVieScolaire_Mobile.declarer();
                }
                GApplication.donneesCentraleNotifications.afficherMessagesDemarrage();
                if (!!this.IdentBandeauPied) {
                    this.GetInstance(this.IdentBandeauPied).SetDonnees();
                }
            };
            ObjetInterfaceMobile.prototype.ConstruireInstances = function() {
                this._construireInstances();
            };
            ObjetInterfaceMobile.prototype.changementRessource = function(aIndex) {
                var lElement = this.getListeRessources().GetElement(aIndex);
                if (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Etablissement) {
                    GEtatUtilisateur.setClasse(lElement);
                } else if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant])) {
                    GEtatUtilisateur.SetNumeroEleve(lElement.GetNumero());
                    if (this.GetInstance(this.idMenuOnglets)) {
                        this.GetInstance(this.idMenuOnglets).Initialiser();
                    }
                }
                this.evenementSurOnglet(GEtatUtilisateur.getGenreOnglet(), true, false, GEtatUtilisateur.getGenreAffichage());
                this.Instances[this.idMenuOnglets].actualiserPhoto();
            };
            ObjetInterfaceMobile.prototype.avecChangementRessource = function() {
                return MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Etablissement, EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]) && GEtatUtilisateur.Identification.ListeRessources.GetNbrElements() > 1;
            };
            ObjetInterfaceMobile.prototype.getListeRessources = function() {
                var result;
                if (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_Etablissement) {
                    result = GEtatUtilisateur.getListeClasses({
                        avecClasse: true,
                        uniquementClasseEnseignee: true
                    });
                } else if (GEtatUtilisateur.GenreEspace === EGenreEspace.Mobile_PrimProfesseur) {
                    result = GEtatUtilisateur.getListeClasses({
                        avecClasse: true,
                        avecGroupe: true,
                        sansClasseDeRegroupement: true
                    });
                } else if (MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant])) {
                    result = GEtatUtilisateur.Identification.ListeRessources;
                } else {
                    result = new ObjetListeElements();
                }
                return result;
            };
            ObjetInterfaceMobile.prototype.getGenreOnglet = function() {
                return EGenreOnglet;
            };
            ObjetInterfaceMobile.prototype.getGenreOngletAccueil = function() {
                return EGenreOnglet.Accueil;
            };
            ObjetInterfaceMobile.prototype.evenementPageMobile = function(aParam) {
                var lQCMrevision;
                var lEspaceQCMConsult;
                switch (aParam.genreOnglet) {
                    case EGenreOnglet.Accueil:
                        if (aParam.executionQCM) {
                            lQCMrevision = !aParam.executionQCM.estLieADevoir && !aParam.executionQCM.estLieAEvaluation && !aParam.executionQCM.estUnTAF;
                            lEspaceQCMConsult = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]);
                            if (lEspaceQCMConsult && (aParam.executionQCM.etatCloture === undefined || aParam.executionQCM.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_EnCours) && !lQCMrevision) {
                                GApplication.getMessage().afficher({
                                    message: GTraductions.getValeur('ExecutionQCM.DepuisEspaceEleve')
                                });
                            } else {
                                this.evenementSurOnglet(EGenreOnglet.QCM_Reponse);
                                this.Instances[this.identPageMobile].setDonnees(aParam, aParam.genreOnglet);
                            }
                        } else {
                            this.evenementSurOnglet(aParam.genreOngletDest);
                        }
                        break;
                    case EGenreOnglet.SaisieAbsences_AppelEtSuivi:
                        ControleSaisieEvenement(aParam.callback);
                        break;
                    case EGenreOnglet.CDT_TAF:
                    case EGenreOnglet.CDT_Contenu:
                    case EGenreOnglet.EmploiDuTemps:
                        if (aParam.executionQCM) {
                            lQCMrevision = !aParam.executionQCM.estLieADevoir && !aParam.executionQCM.estLieAEvaluation && !aParam.executionQCM.estUnTAF;
                            lEspaceQCMConsult = MethodesTableau.existe(GEtatUtilisateur.GenreEspace, [EGenreEspace.Mobile_Parent, EGenreEspace.Mobile_PrimParent, EGenreEspace.Mobile_Accompagnant, EGenreEspace.Mobile_PrimAccompagnant]);
                            if (lEspaceQCMConsult && (aParam.executionQCM.etatCloture === undefined || aParam.executionQCM.etatCloture === TypeEtatExecutionQCMPourRepondant.EQR_EnCours) && !lQCMrevision) {
                                GApplication.getMessage().afficher({
                                    message: GTraductions.getValeur('ExecutionQCM.DepuisEspaceEleve')
                                });
                            } else {
                                this.evenementSurOnglet(EGenreOnglet.QCM_Reponse);
                                this.Instances[this.identPageMobile].setDonnees(aParam, aParam.genreOnglet);
                            }
                        }
                        break;
                    case EGenreOnglet.QCM_Reponse:
                        this.evenementSurOnglet(aParam.genreOngletPrec, true, false);
                        break;
                }
            };
            ObjetInterfaceMobile.prototype.evenementEnteteMobile = function(aGenreBoutonMobile) {
                switch (aGenreBoutonMobile) {
                    case EGenreCommandeMobile.SeDeconnecter: {
                        break;
                    }
                    case EGenreCommandeMobile.Valider: {
                        var lInstanceAffichage = this.GetInstance(this.identPageMobile);
                        if (lInstanceAffichage && lInstanceAffichage.Valider) {
                            lInstanceAffichage.Valider(true);
                        }
                        break;
                    }
                    case EGenreCommandeMobile.Retour: {
                        ControleSaisieEvenement(this.traiterEvenementRetour.bind(this));
                        break;
                    }
                    case EGenreCommandeMobile.Accueil:
                        if (GEtatUtilisateur.avecPageAccueil()) {
                            this.evenementAvantAffichageOnglet(EGenreOnglet.Accueil);
                            this.GetInstance(this.idMenuOnglets).surClickAccueil();
                        }
                        break;
                    case EGenreCommandeMobile.MenuOnglets:
                        this.ouvrirMenuOnglet();
                        break;
                    default:
                        break;
                }
            };
            ObjetInterfaceMobile.prototype.evenementAvantAffichageOnglet = function(aGenreOnglet) {
                if (GEtatUtilisateur.pourThemePrimaire()) {
                    if (aGenreOnglet === EGenreOnglet.Accueil) {
                        $('#' + GApplication.getIdConteneur()).addClass(GThemesPrimaire.getTheme());
                    } else {
                        $('#' + GApplication.getIdConteneur()).removeClass(GThemesPrimaire.getTheme());
                    }
                }
            };
            ObjetInterfaceMobile.prototype.traiterEvenementRetour = function() {
                if (!this.Instances[this.identPageMobile].retourSurAffichage || !this.Instances[this.identPageMobile].retourSurAffichage()) {
                    this.Instances[this.identEnteteMobile].actualiserTitre();
                    this.Instances[this.idMenuOnglets].actualiserTitre();
                    var lOnglet = this.genreOngletPrecedent === null || this.genreOngletPrecedent === undefined ? GEtatUtilisateur.avecPageAccueil() ? EGenreOnglet.Accueil : EGenreOnglet.MenuOnglets : this.genreOngletPrecedent;
                    this._ajouterHistorique(lOnglet);
                    if (lOnglet === EGenreOnglet.Accueil) {
                        this.GetInstance(this.idMenuOnglets).surClickAccueil();
                    } else {
                        this.evenementSurOnglet(lOnglet);
                    }
                }
            };
            ObjetInterfaceMobile.prototype.rafraichirOnglet = function() {
                if (!this.getEtatSaisie() && MethodesTableau.existe(this.GenreOnglet, [EGenreOnglet.Accueil])) {
                    this.actionSurEvenementOnglet();
                }
            };
            ObjetInterfaceMobile.prototype.actionSurRecupererDonnees = function() {
                if (!!this.GetInstance(this.idMenuOnglets)) {
                    $('#' + this.GetInstance(this.idMenuOnglets).GetNom().escapeJQ()).sidenav({
                        edge: 'right',
                        draggable: true,
                        onOpenEnd: (function() {
                            this.GetInstance(this.idMenuOnglets).focusTitre();
                        }).bind(this)
                    });
                }
                this.evenementEnteteMobile(EGenreCommandeMobile.Accueil);
                this.SetEtatSaisie(false);
                $('.objetInterfaceMobile_identPage').on('touchstart', function(event) {
                    event.stopImmediatePropagation();
                });
                GEtatUtilisateur.setDerniereDate(GApplication.getDateDemo() ? GApplication.getDateDemo() : GDate.getDateCourante());
            };
            ObjetInterfaceMobile.prototype._getConstructeurOnglet = function(aGenreOnglet) {
                return DeclarationOngletsMobile.getClassOnglet(aGenreOnglet);
            };
            ObjetInterfaceMobile.prototype.AjouterBandeauPied = function() {
                return this.Add(InterfaceBandeauPied, this.evenementCommande);
            };
            ObjetInterfaceMobile.prototype.evenementCommande = function(aParam) {
                switch (aParam.genreCmd) {
                    case EGenreCommande.Profil: {
                        this.EvenementSurAccesProfil();
                        break;
                    }
                }
            };
            ObjetInterfaceMobile.prototype.EvenementSurAccesProfil = function() {
                var ObjetRequeteAccesProfil = require('ObjetRequeteAccesSecurisePageProfil.js');
                TUtilitairePartenaire.ouvrirPatience();
                if (ObjetRequeteAccesProfil) {
                    new ObjetRequeteAccesProfil(this, this.actionSurRequetePageProfil).lancerRequete();
                }
            };
            ObjetInterfaceMobile.prototype.actionSurRequetePageProfil = function(aTitre, aMessage, aUrl) {
                if (aMessage) {
                    TUtilitairePartenaire.fermerPatience();
                    GApplication.getMessage().afficher({
                        type: EGenreBoiteMessage.Information,
                        titre: aTitre,
                        message: aMessage
                    });
                } else if (aUrl) {
                    TUtilitairePartenaire.ouvrirUrl(aUrl);
                } else {
                    TUtilitairePartenaire.fermerPatience();
                }
            };
        })();
        module.exports = ObjetInterfaceMobile;
    },
    fn: "interfacemobile.js"
});;
